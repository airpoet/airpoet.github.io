<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>A.Pçš„æ–‡è‰ºæ‚è°ˆ</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://airpoet.github.io/"/>
  <updated>2018-07-13T08:26:55.123Z</updated>
  <id>https://airpoet.github.io/</id>
  
  <author>
    <name>airpoet</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Sparkä¸­Bugé›†é”¦</title>
    <link href="https://airpoet.github.io/2018/07/13/Spark/Spark%E4%B8%ADBug%E9%9B%86%E9%94%A6/"/>
    <id>https://airpoet.github.io/2018/07/13/Spark/Sparkä¸­Bugé›†é”¦/</id>
    <published>2018-07-13T06:22:08.652Z</published>
    <updated>2018-07-13T08:26:55.123Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-åˆ›å»º-SparkContext-æ—¶-é‡åˆ°çš„é—®é¢˜"><a href="#1-åˆ›å»º-SparkContext-æ—¶-é‡åˆ°çš„é—®é¢˜" class="headerlink" title="1.åˆ›å»º SparkContext æ—¶, é‡åˆ°çš„é—®é¢˜"></a>1.åˆ›å»º SparkContext æ—¶, é‡åˆ°çš„é—®é¢˜</h4><p><strong>é”™è¯¯æè¿°:</strong> <code>A master URL must be set in your configuration</code></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»º spark é…ç½®å¯¹è±¡</span></span><br><span class="line"><span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>()</span><br><span class="line">conf.setAppName(<span class="string">"MyWordCount_Scala"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½® master å±æ€§</span></span><br><span class="line">conf.setMaster(<span class="string">"local"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡ conf åˆ›å»º sc (æ³¨æ„, è¿™é‡Œä¸€å®šè¦ä¼ å…¥ conf, å¦åˆ™å°±ä¼šæŠ¥ä¸‹é¢è¿™ä¸ªé”™è¯¯)</span></span><br><span class="line"><span class="comment">// A master URL must be set in your configuration</span></span><br><span class="line"><span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(conf)</span><br></pre></td></tr></table></figure><h4 id="2-é…ç½®-Spark-ç‹¬ç«‹æ¨¡å¼æ—¶-æ‰¾ä¸åˆ°-JAVA-HOME"><a href="#2-é…ç½®-Spark-ç‹¬ç«‹æ¨¡å¼æ—¶-æ‰¾ä¸åˆ°-JAVA-HOME" class="headerlink" title="2. é…ç½® Spark ç‹¬ç«‹æ¨¡å¼æ—¶, æ‰¾ä¸åˆ° JAVA_HOME"></a>2. é…ç½® Spark ç‹¬ç«‹æ¨¡å¼æ—¶, æ‰¾ä¸åˆ° JAVA_HOME</h4><p><strong>é”™è¯¯æè¿°: <code>JAVA_HOME is not set</code></strong></p><p><em>è§£å†³æ–¹æ³•</em>: </p><ul><li><strong>åœ¨ <code>sbin</code>ç›®å½•ä¸­,  åœ¨<code>spark-config.sh</code>ä¸­åŠ ä¸Š</strong> <strong><code>export JAVA_HOME=...</code></strong></li><li>åˆ†å‘åˆ°å…¶å®ƒä¸»æœº</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;1-åˆ›å»º-SparkContext-æ—¶-é‡åˆ°çš„é—®é¢˜&quot;&gt;&lt;a href=&quot;#1-åˆ›å»º-SparkContext-æ—¶-é‡åˆ°çš„é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;1.åˆ›å»º SparkContext æ—¶, é‡åˆ°çš„é—®é¢˜&quot;&gt;&lt;/a&gt;1.åˆ›å»º Spark
      
    
    </summary>
    
      <category term="Spark" scheme="https://airpoet.github.io/categories/Spark/"/>
    
    
      <category term="åŸåˆ›" scheme="https://airpoet.github.io/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Spark" scheme="https://airpoet.github.io/tags/Spark/"/>
    
  </entry>
  
  <entry>
    <title>i-Scala</title>
    <link href="https://airpoet.github.io/2018/07/12/Hadoop/12_Scala/i-Scala/"/>
    <id>https://airpoet.github.io/2018/07/12/Hadoop/12_Scala/i-Scala/</id>
    <published>2018-07-12T02:05:03.898Z</published>
    <updated>2018-07-16T02:09:46.163Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸€-æ¦‚è§ˆ"><a href="#ä¸€-æ¦‚è§ˆ" class="headerlink" title="ä¸€. æ¦‚è§ˆ"></a>ä¸€. <strong>æ¦‚è§ˆ</strong></h1><p><strong>scala</strong> : javaè¯­è¨€çš„è„šæœ¬åŒ–ã€‚          </p><p><strong>Scala çš„ç±»å…³ç³»å›¾</strong></p><p><img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-12-061916.png" alt="image-20180712141916222"></p><p><strong>æ•°æ®ç±»å‹æ³¨æ„ç‚¹</strong></p><p>1ã€ Any æ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ï¼ŒåŒ…æ‹¬å€¼ç±»å‹ AnyValï¼Œå’Œå¼•ç”¨ç±»å‹ AnyRef<br>2ã€ AnyVal æ˜¯æ‰€æœ‰å€¼ç±»å‹çš„çˆ¶ç±»ï¼ŒåŒ…æ‹¬ Intï¼ŒDoubleï¼ŒBooleanï¼ŒUnit ç­‰ç­‰<br>3ã€ AnyRef æ˜¯æ‰€æœ‰å¼•ç”¨ç±»å‹çš„çˆ¶ç±»ï¼ŒåŒ…æ‹¬ Null<br>4ã€ Null æ˜¯æ‰€æœ‰å¼•ç”¨ç±»å‹çš„å­ç±»<br>5ã€ Nothing æ˜¯æ‰€æœ‰ç±»çš„å­ç±»<br>6ã€ Unit ç±»å‹åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œæ˜¯()ï¼Œç›¸å½“äº java ä¸­çš„ voidï¼Œæ²¡æœ‰ä»»ä½•çš„å®è´¨æ„ä¹‰<br>7ã€ Null ä¹Ÿåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œæ˜¯ nullï¼Œç›¸å½“äº java ä¸­çš„ nullï¼Œèƒ½èµ‹å€¼ç»™ä»»ä½•å¼•ç”¨ç±»å‹å˜é‡ï¼Œä¸<br>èƒ½èµ‹å€¼ç»™å€¼ç±»å‹å˜é‡</p><p><strong>æ–¹æ³•çš„è¿”å›å€¼:</strong> </p><ul><li>å¦‚æœæ²¡æœ‰æ˜¾ç¤ºå®šä¹‰è¿”å›å€¼, ä¼šè¿”å› <strong>æœ‰å¯èƒ½è¿”å› çš„ å€¼</strong> <strong>çš„</strong>å…±åŒç±»å‹(<strong>çˆ¶ç±»</strong>)</li></ul><p><strong>å®šä¹‰æ–¹æ³•</strong></p><p><img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-12-081734.png" alt="image-20180712161733886"></p><p><strong>å®šä¹‰å‡½æ•°</strong></p><p><img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-12-152103.png" alt="image-20180712232102657"></p><h4 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h4> <figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å˜é‡</span></span><br><span class="line">scala&gt;<span class="keyword">var</span> a = <span class="number">100</span>            <span class="comment">//å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¸¸é‡</span></span><br><span class="line">scala&gt;<span class="keyword">val</span> a = <span class="number">100</span>            <span class="comment">//å¸¸é‡ï¼Œä¸èƒ½é‡æ–°èµ‹å€¼ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰ç±»å‹  //val å¸¸é‡, ä¸èƒ½å†é‡æ–°èµ‹å€¼</span></span><br><span class="line">scala&gt;<span class="keyword">val</span> a:<span class="type">String</span> = <span class="string">"hello"</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ“ä½œç¬¦é‡è½½ </span></span><br><span class="line">    scala&gt;<span class="number">1</span> + <span class="number">2</span></span><br><span class="line">    scala&gt;<span class="number">1.</span>+(<span class="number">2</span>)          </span><br><span class="line"></span><br><span class="line"><span class="comment">//scalaæ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨</span></span><br><span class="line">    scala&gt;<span class="keyword">import</span> scala.math._        <span class="comment">//_ ===&gt; * ä¸‹åˆ’çº¿æ˜¯é€šé…çš„æ„æ€</span></span><br><span class="line">    scala&gt;min(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//apply</span></span><br><span class="line">    scala&gt;<span class="string">"hello"</span>.apply(<span class="number">1</span>)            <span class="comment">//ç­‰ä»·äºxxx.apply()</span></span><br><span class="line">    scala&gt;<span class="string">"hello"</span>(<span class="number">1</span>)                 </span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¡ä»¶è¡¨è¾¾å¼,scalaçš„è¡¨è¾¾å¼æœ‰å€¼,æ˜¯æœ€åä¸€æ¡è¯­å¥çš„å€¼ã€‚</span></span><br><span class="line">    scala&gt;<span class="keyword">val</span> x = <span class="number">1</span> ;</span><br><span class="line">scala&gt;<span class="keyword">val</span> b = <span class="keyword">if</span> x &gt; <span class="number">0</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">-1</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Any æ˜¯Intå’ŒStringçš„è¶…ç±»ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç±»å‹è½¬æ¢</span></span><br><span class="line">    scala&gt;<span class="number">1.</span>toString()</span><br><span class="line">    scala&gt;<span class="string">"100"</span>.toInt()                <span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç©ºå€¼   </span></span><br><span class="line">   scala&gt; <span class="keyword">val</span> y = ()  <span class="comment">//y:Unit= ()ç±»ä¼¼äºjava void.</span></span><br><span class="line">   y: <span class="type">Unit</span> = ()</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç²˜è´´å¤åˆ¶</span></span><br><span class="line">    <span class="comment">// æœ‰å·¦å¤§æ‹¬å·çš„è¯, å›è½¦ä¼šç›´æ¥æ¢è¡Œ</span></span><br><span class="line"><span class="comment">// è¿›å…¥ paste æ¨¡å¼</span></span><br><span class="line">    scala&gt;:paste</span><br><span class="line">            ....</span><br><span class="line">    ctrl + d                    <span class="comment">//ç»“æŸç²˜è´´æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// scala çš„ç¼–è¯‘</span></span><br><span class="line">    javac               java</span><br><span class="line">    *.java --------&gt; *.<span class="keyword">class</span>  --------&gt;ç¨‹åº</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡º</span></span><br><span class="line">    scala&gt;print(<span class="string">"hello"</span>)</span><br><span class="line">    scala&gt;println(<span class="string">"hello"</span>)</span><br><span class="line">    scala&gt;printf(<span class="string">"name is %s , age is %d"</span>, <span class="string">"tom"</span>,<span class="number">12</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯»è¡Œ</span></span><br><span class="line">    scala&gt;<span class="keyword">val</span> password = readLine(<span class="string">"è¯·è¾“å…¥å¯†ç  : "</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥çœ‹å¸®åŠ©</span></span><br><span class="line">    scala&gt;:help</span><br></pre></td></tr></table></figure><hr><h1 id="äºŒ-å¾ªç¯"><a href="#äºŒ-å¾ªç¯" class="headerlink" title="äºŒ. å¾ªç¯"></a>äºŒ. å¾ªç¯</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ™®é€šå¾ªç¯</span></span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; <span class="number">10</span> )&#123;</span><br><span class="line">        println(i) ;</span><br><span class="line">        i += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line"><span class="comment">// 99è¡¨æ ¼</span></span><br><span class="line">    <span class="keyword">var</span> row = <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">while</span>(row &lt;= <span class="number">9</span> )&#123;</span><br><span class="line">        <span class="keyword">var</span> col = <span class="number">1</span> ; </span><br><span class="line">        <span class="keyword">while</span>(col &lt;= row)&#123;</span><br><span class="line">            printf(<span class="string">"%d x %d = %d\t"</span>,col,row,(row * col)) ;</span><br><span class="line">            col += <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        println();</span><br><span class="line">        row += <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line"><span class="comment">// ç™¾é’±ä¹°ç™¾é¸¡é—®é¢˜</span></span><br><span class="line">    <span class="comment">// 100å—é’±èƒ½å„ä¹°3ç§ğŸ“, å„ä¹°å¤šå°‘ç§</span></span><br><span class="line">    <span class="comment">// å…¬é¸¡:5å—/åª</span></span><br><span class="line">    <span class="comment">// æ¯é¸¡:3å—/åª</span></span><br><span class="line">    <span class="comment">// å°é¸¡:1å—/3åª</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å…¬é¸¡</span></span><br><span class="line"><span class="keyword">var</span> cock = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">while</span>(cock &lt;= <span class="number">20</span>)&#123;</span><br><span class="line">    <span class="comment">//æ¯é¸¡</span></span><br><span class="line">    <span class="keyword">var</span> hen = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span>(hen &lt;= <span class="number">100</span>/<span class="number">3</span>)&#123;</span><br><span class="line">        <span class="comment">// å°é¸¡ğŸ¥</span></span><br><span class="line">        <span class="keyword">var</span> chicken = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span>(chicken &lt;= <span class="number">100</span>)&#123;</span><br><span class="line">            <span class="comment">// é’±æ•°</span></span><br><span class="line">            <span class="keyword">var</span> money = cock * <span class="number">5</span> + hen * <span class="number">3</span> + chicken / <span class="number">3</span> ;</span><br><span class="line">            <span class="comment">// ä¸ªæ•°</span></span><br><span class="line">            <span class="keyword">var</span> mount = cock + hen + chicken ;</span><br><span class="line">            <span class="keyword">if</span>(money == <span class="number">100</span> &amp;&amp; mount == <span class="number">100</span>)&#123;</span><br><span class="line">                printf(<span class="string">"cock : %d , hen : %d , chicken : %d\n"</span>,cock,hen,chicken) ;</span><br><span class="line">            &#125;</span><br><span class="line">            chicken += <span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        hen += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cock += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line"><span class="comment">//forå¾ªç¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// to </span></span><br><span class="line"><span class="comment">// æ³¨æ„:  &lt;- æ˜¯å†™åœ¨ä¸€èµ·çš„ </span></span><br><span class="line">scala&gt; <span class="keyword">for</span> (x  &lt;-  <span class="number">1</span> to <span class="number">10</span>)&#123;</span><br><span class="line">    println(x) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-------------------------------------</span><br><span class="line"><span class="comment">// until   [1,...10)</span></span><br><span class="line"><span class="comment">// å·¦é—­å³å¼€ </span></span><br><span class="line"><span class="keyword">for</span> (x &lt;- <span class="number">1</span> until <span class="number">10</span>)&#123;</span><br><span class="line">    println(x) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// step ä¸º2 </span></span><br><span class="line"><span class="keyword">for</span> (x &lt;- <span class="number">1</span> until (<span class="number">10</span>,<span class="number">2</span>))&#123;</span><br><span class="line">    println(x) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å€’åºæ‰“å°</span></span><br><span class="line"><span class="keyword">for</span> (str &lt;- (<span class="number">1</span> to <span class="number">10</span>).reverse)&#123;</span><br><span class="line">println(str)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨æ•°ç»„ä¸‹æ ‡çš„æ–¹å¼è¿›è¡Œæ‰“å°</span></span><br><span class="line"><span class="keyword">for</span> (i &lt;- <span class="number">0</span> to arr.length - <span class="number">1</span>)&#123;</span><br><span class="line">println(arr(i))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-------------------------------------</span><br><span class="line"><span class="comment">//scalaæ²¡æœ‰break continueè¯­å¥ã€‚å¯ä»¥ä½¿ç”¨Breakså¯¹è±¡çš„break()æ–¹æ³•ã€‚</span></span><br><span class="line">scala&gt; <span class="keyword">import</span> scala.util.control.<span class="type">Breaks</span>._</span><br><span class="line">scala&gt; <span class="keyword">for</span>(x &lt;- <span class="number">1</span> to <span class="number">10</span>) &#123;<span class="keyword">if</span> (x&gt;<span class="number">8</span>) <span class="keyword">break</span>() ; print(x)&#125; ;</span><br><span class="line">eg: scala&gt; <span class="keyword">for</span>(x &lt;- <span class="number">1</span> to <span class="number">10</span>) &#123; println(x); <span class="keyword">if</span>(x == <span class="number">5</span>)<span class="keyword">break</span>;&#125;  </span><br><span class="line"><span class="number">12345</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line"><span class="comment">//forå¾ªç¯é«˜çº§</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åŒå¾ªç¯,å®ˆå«æ¡ä»¶</span></span><br><span class="line">scala&gt; <span class="keyword">for</span>(i &lt;- <span class="number">1</span> to <span class="number">3</span> ; j &lt;- <span class="number">1</span> to <span class="number">4</span> <span class="keyword">if</span> i != j ) &#123;printf(<span class="string">"i = %d, j = %d , res = %d \n"</span>,i,j,i*j);&#125; ;    </span><br><span class="line"></span><br><span class="line">-------------------------------------</span><br><span class="line"><span class="comment">//yieldï¼Œæ˜¯å¾ªç¯ä¸­å¤„ç†æ¯ä¸ªå…ƒç´ ï¼Œäº§ç”Ÿæ–°é›†åˆ</span></span><br><span class="line">scala&gt;<span class="keyword">for</span> (x &lt;- <span class="number">1</span> to <span class="number">10</span> ) <span class="keyword">yield</span> x % <span class="number">2</span> ;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰-å®šä¹‰å‡½æ•°"><a href="#ä¸‰-å®šä¹‰å‡½æ•°" class="headerlink" title="ä¸‰. å®šä¹‰å‡½æ•°"></a>ä¸‰. å®šä¹‰å‡½æ•°</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹å¼1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(a:<span class="type">Int</span>,b:<span class="type">Int</span>):<span class="type">Int</span> = &#123;</span><br><span class="line">    <span class="keyword">var</span> c = a + b  ;</span><br><span class="line">    <span class="keyword">return</span> c  ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼2</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(a:<span class="type">Int</span>,b:<span class="type">Int</span>):<span class="type">Int</span> =  a + b</span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line"></span><br><span class="line"><span class="comment">//scalaå®ç°é€’å½’</span></span><br><span class="line"></span><br><span class="line">æ ¸å¿ƒ:  n! = n * (n - <span class="number">1</span>)!  <span class="comment">// n çš„é˜¶ä¹˜ = n-1çš„é˜¶ä¹˜, å¹¶ä¸” å‡ºå£æ˜¯ n=1</span></span><br><span class="line"><span class="number">4</span>!  = <span class="number">4</span> x <span class="number">3</span>!</span><br><span class="line"><span class="number">4</span>!  = <span class="number">4</span> x <span class="number">3</span> x <span class="number">2</span>!</span><br><span class="line"><span class="number">4</span>!  = <span class="number">4</span> x <span class="number">3</span> x <span class="number">2</span> x <span class="number">1</span>!</span><br><span class="line"></span><br><span class="line"><span class="comment">//é€’å½’å‡½æ•°å¿…é¡»æ˜¾å¼å®šä¹‰è¿”å›ç±»å‹</span></span><br><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">fac</span></span>(n:<span class="type">Int</span>):<span class="type">Int</span> = <span class="keyword">if</span>(n == <span class="number">1</span>) <span class="number">1</span> <span class="keyword">else</span> n * fac(n<span class="number">-1</span>) ;</span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line"><span class="comment">//å‡½æ•°çš„é»˜è®¤å€¼å’Œå‘½åå‚æ•°</span></span><br><span class="line">scala&gt;<span class="function"><span class="keyword">def</span> <span class="title">decorate</span></span>(prefix:<span class="type">String</span> = <span class="string">"[["</span>,str:<span class="type">String</span>,suffix:<span class="type">String</span> = <span class="string">"]]"</span>) = &#123;</span><br><span class="line">        prefix + str + suffix </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœéƒ½æŒ‡å®šäº†é»˜è®¤å€¼, è°ƒç”¨çš„æ—¶å€™ å¯ä»¥ä¸ä¼ å‚æ•°</span></span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥ä¸æŒ‡å®šå‚æ•°å ä¼ ä»»æ„ä¸ªæ•° çš„å‚æ•°, ä¼šä»ç¬¬ä¸€ä¸ªå¼€å§‹åŒ¹é…</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorate</span></span>(prefix:<span class="type">String</span>=<span class="string">"[["</span>, str:<span class="type">String</span>=<span class="string">"ğŸ‘Œ"</span>, suffix:<span class="type">String</span>=<span class="string">"]]"</span>)=&#123;</span><br><span class="line">    prefix + str + suffix</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">----è°ƒç”¨</span><br><span class="line">scala&gt;decorate(str=<span class="string">"hello"</span>)</span><br><span class="line">scala&gt;decorate(str=<span class="string">"hello"</span>,prefix=<span class="string">"&lt;&lt;"</span>)</span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line"></span><br><span class="line"><span class="comment">//å˜é•¿å‚æ•° (å°±ç›¸å½“äºå¯ä»¥ä¼ å¤šä¸ªå€¼)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(a:<span class="type">Int</span>*) = &#123;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(x &lt;- a) s += x;</span><br><span class="line">    s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sum(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">sum (<span class="number">1</span> to <span class="number">4</span>:_*)  <span class="comment">// å°†1 to 4å½“åšåºåˆ—å¤„ç†</span></span><br><span class="line"><span class="comment">// ä¸¤è€…æ˜¯ä¸€æ ·çš„æ•ˆæœ</span></span><br><span class="line"></span><br><span class="line">sum(<span class="number">1</span> to <span class="number">4</span>) <span class="comment">// wrong, è¿™æ ·æ˜¯é”™è¯¯çš„</span></span><br><span class="line"></span><br><span class="line">------------------------------------------------</span><br><span class="line"><span class="comment">// é€’å½’ç›¸åŠ (è·Ÿä¸Šé¢å˜é•¿å‚æ•°å¾ªç¯éå†çš„æ•ˆæœä¸€æ ·)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(args:<span class="type">Int</span>*):<span class="type">Int</span> = &#123;<span class="keyword">if</span> (args.length == <span class="number">0</span>) <span class="number">0</span> <span class="keyword">else</span> args.head + sum(args.tail:_*)&#125;</span><br><span class="line">----è°ƒç”¨</span><br><span class="line">sum (<span class="number">1</span> to <span class="number">4</span>:_*) </span><br><span class="line">===================================================================</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿‡ç¨‹ (æ²¡æœ‰è¿”å›å€¼ï¼Œæ²¡æœ‰=å·)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">out</span></span>(a:<span class="type">Int</span>)&#123;println(a)&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">out</span></span>(a:<span class="type">Int</span>)=&#123;println(a)&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">out</span></span>(a:<span class="type">Int</span>):<span class="type">Unit</span> = &#123;println(a)&#125;</span><br><span class="line"></span><br><span class="line">&gt;&gt; ä»¥ä¸Š<span class="number">3</span>ç§æ–¹å¼ç­‰ä»·</span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line"><span class="comment">//lazyå»¶è¿Ÿè®¡ç®—</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">lazy</span> <span class="keyword">val</span> x = scala.io.<span class="type">Source</span>.fromFile(<span class="string">"/Users/shixuanji/Documents/IDEs/iTerm2/scala/buyChicked.scala"</span>).mkString</span><br><span class="line">x: <span class="type">String</span> = &lt;<span class="keyword">lazy</span>&gt;</span><br><span class="line">scala&gt; x  </span><br><span class="line">res63: <span class="type">String</span> = <span class="string">"...è¿™é‡Œå°±æ˜¯åŠ è½½å‡ºæ¥çš„çš„æ–‡ä»¶å†…å®¹"</span></span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line"><span class="comment">//å¼‚å¸¸</span></span><br><span class="line">scala&gt;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">          <span class="string">"hello"</span>.toInt;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>&#123;                    <span class="comment">//äº¤ç»™</span></span><br><span class="line">            <span class="keyword">case</span> _:<span class="type">Exception</span>    =&gt; print(<span class="string">"xxxx"</span>) ;</span><br><span class="line">            <span class="keyword">case</span> ex:java.io.<span class="type">IOException</span> =&gt; print(ex)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">-----&gt; æœ€ç®€å•çš„å¼‚å¸¸</span><br><span class="line">scala&gt; <span class="keyword">try</span> &#123; <span class="number">1</span>/<span class="number">0</span> &#125; <span class="keyword">catch</span> &#123; <span class="keyword">case</span> _: <span class="type">Exception</span> =&gt; println(<span class="string">"é”™å•¦....."</span>) &#125;</span><br><span class="line">é”™å•¦.....</span><br><span class="line">res76: <span class="type">AnyVal</span> = ()</span><br><span class="line"></span><br><span class="line"><span class="comment">// _ çš„æ„ä¹‰</span></span><br><span class="line"><span class="number">1</span>&gt; é€šé…ç›¸å½“äº*</span><br><span class="line"><span class="number">2</span>&gt; <span class="number">1</span> to <span class="number">10</span> :_*    ,è½¬æˆåºåˆ—</span><br><span class="line"><span class="number">3</span>&gt; <span class="keyword">case</span> _:<span class="type">Exception</span>    =&gt; print(<span class="string">"xxxx"</span>) ;</span><br></pre></td></tr></table></figure><hr><h1 id="å››-æ•°ç»„"><a href="#å››-æ•°ç»„" class="headerlink" title="å››. æ•°ç»„"></a>å››. æ•°ç»„</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šé•¿</span></span><br><span class="line">---------------</span><br><span class="line">    java&gt; int[] arr = int int[<span class="number">4</span>] ;</span><br><span class="line">    scala&gt;<span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="type">Array</span>[<span class="type">Int</span>](<span class="number">10</span>);            <span class="comment">//apply(10)</span></span><br><span class="line">    scala&gt;<span class="keyword">var</span> arr = <span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);                <span class="comment">//æ¨æ–­</span></span><br><span class="line">    scala&gt;arr(<span class="number">0</span>)                                   <span class="comment">//æŒ‰ç…§ä¸‹æ ‡è®¿é—®å…ƒç´ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ +: æ·»åŠ å…ƒç´ , ä½¿ç”¨ ++: æ·»åŠ æ•°ç»„, ç»“æœæ˜¯ä¸€ä¸ªæ–°æ•°ç»„</span></span><br><span class="line">scala&gt; <span class="keyword">val</span> arr = <span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">arr: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">var</span> arr2 = arr :+ <span class="number">2</span></span><br><span class="line">arr2: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; arr2</span><br><span class="line">res2: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; arr</span><br><span class="line">    res3: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å˜é•¿æ•°ç»„</span></span><br><span class="line">-------------------</span><br><span class="line">    scala&gt;<span class="keyword">import</span> scala.collection.mutable.<span class="type">ArrayBuffer</span></span><br><span class="line">    scala&gt;<span class="keyword">val</span> buf = <span class="type">ArrayBuffer</span>[<span class="type">Int</span>]();            <span class="comment">//åˆ›å»ºæ•°ç»„ç¼“å†²åŒºå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//+=åœ¨æœ«å°¾è¿½åŠ </span></span><br><span class="line">-------------------</span><br><span class="line">    scala&gt; buf += <span class="number">3</span></span><br><span class="line">    res156: buf.<span class="keyword">type</span> = <span class="type">ArrayBuffer</span>(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; buf .+= (<span class="number">23</span>)</span><br><span class="line">    res157: buf.<span class="keyword">type</span> = <span class="type">ArrayBuffer</span>(<span class="number">3</span>, <span class="number">23</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; buf ++= <span class="type">Array</span>(<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line">    res158: buf.<span class="keyword">type</span> = <span class="type">ArrayBuffer</span>(<span class="number">3</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//trimEnd,ä»æœ«å°¾ç§»é™¤å…ƒç´ </span></span><br><span class="line">-------------------</span><br><span class="line">    scala&gt;buf.trimStart(<span class="number">2</span>)</span><br><span class="line">    scala&gt;buf.trimEnd(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//removeæŒ‰ç…§ç´¢å¼•ç§»é™¤</span></span><br><span class="line">-------------------</span><br><span class="line">    scala&gt;buf.remove(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//insert,åœ¨0å…ƒç´ ä½ç½®æ’å…¥åç»­æ•°æ®</span></span><br><span class="line">-------------------</span><br><span class="line">    scala&gt;buf.insert(<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//toArray</span></span><br><span class="line">-------------------</span><br><span class="line">    scala&gt;buf.toArray</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">=================================æ•°ç»„æ“ä½œ==================================</span><br><span class="line"><span class="comment">//æ•°ç»„æ“ä½œ</span></span><br><span class="line">  <span class="comment">// éœ€æ±‚: æ„é€ å‡º20ä»¥å†…, 4çš„å€æ•°çš„æ•°ç»„</span></span><br><span class="line"><span class="comment">// æ–¹å¼1</span></span><br><span class="line">    scala&gt; (<span class="keyword">for</span>(x &lt;- <span class="number">1</span> to <span class="number">10</span> <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">0</span>) <span class="keyword">yield</span> x * <span class="number">2</span>).toArray</span><br><span class="line">    res107: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼2</span></span><br><span class="line">    scala&gt; <span class="type">Array</span>(<span class="number">1</span> to <span class="number">10</span>:_*).filter(_ % <span class="number">2</span> == <span class="number">0</span>).map(_ * <span class="number">2</span>)</span><br><span class="line">    res109: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line"><span class="comment">// mapå‡½æ•°, å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°, å‡½æ•°çš„å‚æ•°å¿…é¡»ä¸è°ƒç”¨è€…çš„å‚æ•°æ„æˆä¸€è‡´</span></span><br><span class="line"><span class="comment">// æ¯æ¬¡æ‹¿å‡ºä¸€ä¸ªå‚æ•°å‡ºæ¥ç®—</span></span><br><span class="line"><span class="symbol">'ma</span>p':    æŠŠä¸€æ‰¹å…ƒç´ ç»è¿‡æ“ä½œä»¥åæ˜ å°„å‡ºå¦ä¸€æ‰¹å…ƒç´ , kv è¿›, kv å‡º </span><br><span class="line"><span class="comment">// filter å‡½æ•°, åŒä¸Š</span></span><br><span class="line"><span class="symbol">'filte</span>r': è¿‡æ»¤, æŠŠä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ è¿‡æ»¤æ‰</span><br><span class="line">==========================================</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------</span><br><span class="line"><span class="comment">//æ•°ç»„å¸¸ç”¨æ–¹æ³•</span></span><br><span class="line">--------------------</span><br><span class="line">    scala&gt;arr.sum</span><br><span class="line">    scala&gt;arr.min</span><br><span class="line">    scala&gt;arr.max</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ’åº</span></span><br><span class="line">--------------------</span><br><span class="line">    scala&gt;<span class="keyword">import</span> scala.util.<span class="type">Sorting</span>._</span><br><span class="line">    scala&gt;<span class="keyword">val</span> arr = <span class="type">Array</span>(<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">    scala&gt;quickSort(arr)                <span class="comment">//arræœ‰åº</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Array.mkString =&gt; array è½¬ä¸º string</span></span><br><span class="line">--------------------</span><br><span class="line">    scala&gt; <span class="keyword">val</span> arr = <span class="type">Array</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">21</span>)</span><br><span class="line">    arr: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">21</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; arr</span><br><span class="line">    res164: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">21</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; arr.mkString(<span class="string">"&lt;&lt;"</span>,<span class="string">","</span>,<span class="string">"&gt;&gt;"</span>)</span><br><span class="line">    res165: <span class="type">String</span> = &lt;&lt;<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">21</span>&gt;&gt;</span><br><span class="line">===================================================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤šç»´æ•°ç»„</span></span><br><span class="line">--------------------</span><br><span class="line"><span class="comment">// å®šä¹‰æ–¹å¼1</span></span><br><span class="line">    scala&gt; <span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="type">Array</span>[<span class="type">Array</span>[<span class="type">Int</span>]](<span class="number">4</span>)</span><br><span class="line">    arr: <span class="type">Array</span>[<span class="type">Array</span>[<span class="type">Int</span>]] = <span class="type">Array</span>(<span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>)</span><br><span class="line">    scala&gt; arr(<span class="number">0</span>) = <span class="type">Array</span>(<span class="number">1</span>)</span><br><span class="line">    scala&gt; arr(<span class="number">1</span>) = <span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">    scala&gt; arr(<span class="number">2</span>) = <span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">    scala&gt; arr(<span class="number">3</span>) = <span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; arr</span><br><span class="line">    res128: <span class="type">Array</span>[<span class="type">Array</span>[<span class="type">Int</span>]] = <span class="type">Array</span>(<span class="type">Array</span>(<span class="number">1</span>), <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>), <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æ–¹å¼2</span></span><br><span class="line">    <span class="comment">//äºŒç»´æ•°ç»„,3è¡Œ4åˆ—</span></span><br><span class="line">    scala&gt;<span class="keyword">val</span> arr = <span class="type">Array</span>.ofDim[<span class="type">Int</span>](<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    <span class="comment">//ä¸‹æ ‡è®¿é—®æ•°ç»„å…ƒç´ </span></span><br><span class="line">    scala&gt;arr(<span class="number">0</span>)(<span class="number">1</span>)</span><br><span class="line">    scala&gt;arr.length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ•°ç»„çš„éå†</span></span><br><span class="line">--------------------</span><br><span class="line">    scala&gt; a</span><br><span class="line">    res178: <span class="type">String</span> = hello</span><br><span class="line"></span><br><span class="line">    scala&gt; <span class="keyword">for</span>(i &lt;- <span class="number">0</span> until a.length) println(i+<span class="string">":"</span>+a(i))</span><br><span class="line">    <span class="number">0</span>:h</span><br><span class="line">    <span class="number">1</span>:e</span><br><span class="line">    <span class="number">2</span>:l</span><br><span class="line">    <span class="number">3</span>:l</span><br><span class="line">    <span class="number">4</span>:o</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹¿åˆ°æ¯ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ (è·Ÿä¸Šé¢çš„éå†ç»“æœä¸€æ ·)</span></span><br><span class="line">--------------------</span><br><span class="line">    scala&gt; arr</span><br><span class="line">    res179: <span class="type">Array</span>[<span class="type">Array</span>[<span class="type">Int</span>]] = <span class="type">Array</span>(<span class="type">Array</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="type">Array</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="type">Array</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">    scala&gt; <span class="keyword">for</span>(i &lt;- <span class="number">0</span> until arr.length) println(i+<span class="string">":"</span>+arr(i))</span><br><span class="line">    <span class="number">0</span>:[<span class="type">I</span>@<span class="number">36081062</span></span><br><span class="line">    <span class="number">1</span>:[<span class="type">I</span>@<span class="number">70</span>c6f11a</span><br><span class="line">    <span class="number">2</span>:[<span class="type">I</span>@<span class="number">378953</span>bd</span><br><span class="line">     </span><br><span class="line"><span class="comment">//å’Œjavaå¯¹è±¡äº¤äº’ï¼Œå¯¼å…¥è½¬æ¢ç±»å‹,ä½¿ç”¨çš„éšå¼è½¬æ¢</span></span><br><span class="line">--------------------</span><br><span class="line"><span class="keyword">import</span> scala.collection.<span class="type">JavaConversions</span>.bufferAsJavaList</span><br><span class="line"><span class="keyword">val</span> buf = <span class="type">ArrayBuffer</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">val</span> list:java.util.<span class="type">List</span>[<span class="type">Int</span>] = buf ; <span class="comment">// scala è¯­æ³•ä¸­, æ³›å‹æ—¶åœ¨ ä¸­æ‹¬å·ä¸­</span></span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line"><span class="comment">// æ‰“å°å¼•ç”¨ç±»å‹</span></span><br><span class="line">println(result.toBuffer)<span class="comment">// æ‰“å°å¼•ç”¨ç±»å‹çš„å€¼</span></span><br><span class="line">println(result.mkString(<span class="string">","</span>))<span class="comment">// ä»¥',' åˆ†éš”ç¬¦æ‰“å°</span></span><br><span class="line">println(arr2.mkString(<span class="string">"&lt;"</span>,<span class="string">":"</span>,<span class="string">"&gt;"</span>))      <span class="comment">// å‰åç¼€ å’Œ åˆ†éš”ç¬¦ æ‰“å°</span></span><br><span class="line">       </span><br><span class="line">println(foreach(println))<span class="comment">// å¾ªç¯æ‰“å°</span></span><br></pre></td></tr></table></figure><hr><h1 id="äº”-Map-æ˜ å°„"><a href="#äº”-Map-æ˜ å°„" class="headerlink" title="äº”. Map æ˜ å°„"></a>äº”. Map æ˜ å°„</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// ä¸å¯å˜ immutable</span></span><br><span class="line">=============================================================================</span><br><span class="line">    <span class="comment">//scala.collection.immutable.Map[Int,String] =&gt;ä¸å¯å˜é›†åˆ</span></span><br><span class="line">scala&gt;<span class="keyword">val</span> map = <span class="type">Map</span>(<span class="number">100</span>-&gt;<span class="string">"tom"</span>,<span class="number">200</span>-&gt;<span class="string">"tomas"</span>,<span class="number">300</span>-&gt;<span class="string">"tomasLee"</span>)</span><br><span class="line">map: scala.collection.immutable.<span class="type">Map</span>[<span class="type">Int</span>,<span class="type">String</span>] = <span class="type">Map</span>(<span class="number">100</span> -&gt; tom, <span class="number">200</span> -&gt; tomas, <span class="number">300</span> -&gt; tomasLee)</span><br><span class="line">    <span class="comment">//é€šè¿‡keyè®¿é—®value</span></span><br><span class="line">    scala&gt;map(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">æ³¨æ„:</span><br><span class="line">    <span class="number">1</span>) å¦‚æœæ˜¯ immutable çš„ map çš„ <span class="keyword">val</span> è¦æ”¹å˜, åªèƒ½èµ‹å€¼ç»™æ–°çš„ <span class="keyword">val</span> , æ·»åŠ åªèƒ½ç”¨ + å·</span><br><span class="line">    <span class="number">2</span>) å¦‚æœæ˜¯ immutable çš„ map çš„ <span class="keyword">var</span> å¯ä»¥ç›´æ¥ä½¿ç”¨ +=, -= </span><br><span class="line">      <span class="keyword">val</span> newmap = map + (<span class="number">4</span>-&gt;<span class="string">"ttt"</span>)</span><br><span class="line">  </span><br><span class="line"><span class="comment">// å¯å˜ mutable</span></span><br><span class="line">=============================================================================</span><br><span class="line"><span class="comment">// ç›´æ¥å®šä¹‰ hashMap å¹¶èµ‹å€¼</span></span><br><span class="line">---------------------------------------------</span><br><span class="line">    <span class="keyword">import</span> scala.collection.mutable.<span class="type">HashMap</span></span><br><span class="line">    <span class="keyword">var</span> map1 = <span class="type">HashMap</span>(<span class="number">1</span>-&gt;<span class="number">22</span>, <span class="string">"dd"</span>-&gt;<span class="number">33</span>)<span class="comment">//æ³¨æ„, è¿™é‡Œå­—ç¬¦ä¸²åªèƒ½ä½¿ç”¨ åŒå¼•å· </span></span><br><span class="line">    $scala&gt; map1</span><br><span class="line">    res145: scala.collection.mutable.<span class="type">HashMap</span>[<span class="type">Int</span>,<span class="type">Int</span>] = <span class="type">Map</span>(<span class="number">2</span> -&gt; <span class="number">33</span>, <span class="number">1</span> -&gt; <span class="number">22</span>)</span><br><span class="line">    scala&gt; map1(<span class="string">"dd"</span>)</span><br><span class="line">    res197: <span class="type">Int</span> = <span class="number">33</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…ˆå®šä¹‰ç©ºhashmap</span></span><br><span class="line">---------------------------------------------</span><br><span class="line">    scala&gt; <span class="keyword">var</span> map2 = <span class="keyword">new</span> <span class="type">HashMap</span>[<span class="type">Int</span>,<span class="type">Int</span>]</span><br><span class="line">    map2: scala.collection.mutable.<span class="type">HashMap</span>[<span class="type">Int</span>,<span class="type">Int</span>] = <span class="type">Map</span>()</span><br><span class="line"></span><br><span class="line">    scala&gt; <span class="keyword">var</span> map3 = <span class="type">HashMap</span>[<span class="type">Int</span>,<span class="type">Int</span>]()  <span class="comment">// è¿™é‡Œå…¶å®å°±æ˜¯è°ƒç”¨äº† apply()</span></span><br><span class="line">    map3: scala.collection.mutable.<span class="type">HashMap</span>[<span class="type">Int</span>,<span class="type">Int</span>] = <span class="type">Map</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// hashMap èµ‹å€¼</span></span><br><span class="line">---------------------------------------------</span><br><span class="line">æ³¨æ„: += / -= ä¼šæ”¹å˜åŸå€¼,  + / - ä¸ä¼šæ”¹å˜åŸå€¼,åªä¼šæ”¹å˜å½“æ¬¡è¿”å›å€¼</span><br><span class="line">---------------------------------------------</span><br><span class="line"><span class="comment">///æ·»åŠ å…ƒç´ : += (k-&gt;v) æ³¨æ„: è¦ä¸å®šä¹‰æ—¶ç±»å‹ä¸€è‡´</span></span><br><span class="line">    scala&gt; map2 += (<span class="number">1</span>-&gt;<span class="number">100</span>,<span class="number">2</span>-&gt;<span class="number">200</span>)</span><br><span class="line">    res150: scala.collection.mutable.<span class="type">HashMap</span>[<span class="type">Int</span>,<span class="type">Int</span>] = <span class="type">Map</span>(<span class="number">2</span> -&gt; <span class="number">200</span>, <span class="number">1</span> -&gt; <span class="number">100</span>)</span><br><span class="line">    ====&gt; æ³¨æ„: æ­¤æ—¶ mutable de  <span class="keyword">var</span> çš„  '+=' å’Œ '+', æ•ˆæœæ˜¯ä¸€æ ·çš„</span><br><span class="line">    =====&gt; map2 = map2 + (<span class="number">1</span>-&gt;<span class="number">100</span>,<span class="number">2</span>-&gt;<span class="number">200</span>)  <span class="comment">// è¿™ä¸ªå†™æ³•æ˜¯é”™è¯¯çš„, è¦ä¹ˆç”¨+, è¦ä¹ˆç”¨+=</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///åˆ é™¤å…ƒç´ : -= k</span></span><br><span class="line">    scala&gt; map2 -= <span class="number">1</span></span><br><span class="line">    res151: scala.collection.mutable.<span class="type">HashMap</span>[<span class="type">Int</span>,<span class="type">Int</span>] = <span class="type">Map</span>(<span class="number">2</span> -&gt; <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">==&gt;  æ³¨æ„: å¦‚æœkey ä¸€æ ·, ä¼šè¦†ç›–æ‰å‰é¢çš„èµ‹å€¼, ç›¸å½“äºä¿®æ”¹</span><br><span class="line">==&gt;  å½“ç„¶, ä¹Ÿå¯ä»¥è¿™æ ·ä¿®æ”¹: &gt;&gt;&gt;  map2(<span class="number">1</span>) = <span class="number">500</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿­ä»£map</span></span><br><span class="line">---------------------------------------------</span><br><span class="line">scala&gt;<span class="keyword">for</span> ((k,v) &lt;- map) println(k + <span class="string">":::"</span> + v);</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">for</span> ((k,v) &lt;- map) println(k +<span class="string">":::::"</span> + v)</span><br><span class="line"><span class="number">1</span>:::::<span class="number">33</span></span><br><span class="line"><span class="number">2</span>:::::<span class="number">44</span></span><br><span class="line"><span class="number">3</span>:::::<span class="number">55</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨yieldæ“ä½œè¿›è¡Œå€’æ’åº(kvå¯¹è°ƒ)</span></span><br><span class="line">---------------------------------------------</span><br><span class="line">scala&gt; <span class="keyword">for</span> ((k,v) &lt;- map) <span class="keyword">yield</span> (v,k)</span><br><span class="line">res210: scala.collection.immutable.<span class="type">Map</span>[<span class="type">Int</span>,<span class="type">Int</span>] = <span class="type">Map</span>(<span class="number">33</span> -&gt; <span class="number">1</span>, <span class="number">44</span> -&gt; <span class="number">2</span>, <span class="number">55</span> -&gt; <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// mapæ–¹æ³•:</span></span><br><span class="line">æ­¤æ–¹æ³•åªèƒ½æ¥å—ä¸€ä¸ªå‚æ•°, è¿™ä¸ªå‚æ•°æ˜¯å‡½æ•°</span><br><span class="line">æ­¤å‚æ•°å‡½æ•°, ä¹Ÿåªèƒ½æ¥å—ä¸€ä¸ªå‚æ•°, æ­¤å‚æ•°çš„ç±»å‹, å’Œæ•°ç»„ä¸­çš„å…ƒç´ ç±»å‹ä¸€è‡´</span><br><span class="line">æ­¤å‚æ•°å‡½æ•°æœ€ç»ˆä¼šè¿”å›ä¸€ä¸ªå€¼, å€¼çš„ç±»å‹å¯ä»¥è‡ªå®šä¹‰</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> add1 = (x : <span class="type">Int</span>) =&gt; x+<span class="number">1</span> </span><br><span class="line">arr.map(add1)</span><br><span class="line"></span><br><span class="line">arr.map( (x : <span class="type">Int</span>) =&gt; x+<span class="number">1</span> )</span><br><span class="line">arr. map(x =&gt; x +<span class="number">1</span>)</span><br><span class="line">arr.map(_ + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å–å€¼</span></span><br><span class="line">map.get(<span class="string">"xx"</span>)      <span class="comment">//æ²¡æœ‰çš„è¯å°±è¿”å›ç©º</span></span><br><span class="line">scala&gt; m.getOrElse(<span class="number">0</span>,<span class="string">"no"</span>)   <span class="comment">// æ²¡æœ‰çš„è¯å°±è¿”å›åé¢æŒ‡å®šçš„å…ƒç´ </span></span><br></pre></td></tr></table></figure><hr><h1 id="å…­-å…ƒç»„tuple-æœ€å¤§Tuple22"><a href="#å…­-å…ƒç»„tuple-æœ€å¤§Tuple22" class="headerlink" title="å…­. å…ƒç»„tuple, æœ€å¤§Tuple22"></a>å…­. å…ƒç»„tuple, æœ€å¤§Tuple22</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äºŒå…ƒå…ƒç¥– å« å¯¹å¶</span></span><br><span class="line">---------------------------------------------</span><br><span class="line">å…ƒç»„çš„å®šä¹‰: ç”¨å°æ‹¬å·åŒ…èµ·æ¥</span><br><span class="line">---------------------------------------------</span><br><span class="line">    scala&gt; <span class="keyword">val</span> t = (<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>) ;</span><br><span class="line">    scala&gt; t</span><br><span class="line">    res216: (<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>) = (<span class="number">1</span>,tom,<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; <span class="keyword">val</span> t = (<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>)</span><br><span class="line">    t: (<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>, <span class="type">Int</span>) = (<span class="number">1</span>,tom,<span class="number">12</span>,<span class="number">1</span>,tom,<span class="number">12</span>,<span class="number">1</span>,tom,<span class="number">12</span>,<span class="number">1</span>,tom,<span class="number">12</span>,<span class="number">1</span>,tom,<span class="number">12</span>,<span class="number">1</span>,tom,<span class="number">12</span>,<span class="number">1</span>,tom,<span class="number">12</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; <span class="keyword">val</span> t = (<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">    &lt;console&gt;:<span class="number">1</span>: error: too many elements <span class="keyword">for</span> tuple: <span class="number">23</span>, allowed: <span class="number">22</span></span><br><span class="line">           <span class="keyword">val</span> t = (<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">"tom"</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">æ³¨æ„: error: too many elements <span class="keyword">for</span> tuple: <span class="number">23</span>, allowed: <span class="number">22</span>  å…ƒç¥–æœ€å¤š<span class="number">22</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—®å…ƒç»„æŒ‡å®šå…ƒ</span></span><br><span class="line">---------------------------------------------</span><br><span class="line">==&gt; æ³¨æ„: å…ƒç¥–åºåˆ—ä» <span class="number">1</span> å¼€å§‹</span><br><span class="line">scala&gt; <span class="keyword">val</span> t = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>) ;        <span class="comment">//å…ƒç»„</span></span><br><span class="line">scala&gt;t._2</span><br><span class="line">scala&gt;t _2 (ä¸æ¨è)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> (a,b,c) = t</span><br><span class="line">==&gt; ç›¸å½“äºä¸€ä¸‹å£°æ˜äº†<span class="number">3</span>ä¸ªå˜é‡, a,b,c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç›´æ¥å–å‡ºå…ƒç»„ä¸­çš„å„åˆ†é‡</span></span><br><span class="line">---------------------------------------------</span><br><span class="line">scala&gt; <span class="keyword">val</span> t = (<span class="number">132</span>,<span class="string">"d4"</span>,<span class="number">3</span>)</span><br><span class="line">t: (<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>) = (<span class="number">132</span>,d4,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">æ³¨æ„: å‰åçš„å…ƒæ•°å¿…é¡»ç›¸ç­‰</span><br><span class="line">scala&gt; <span class="keyword">val</span> (a,b,c) = t</span><br><span class="line">a: <span class="type">Int</span> = <span class="number">132</span></span><br><span class="line">b: <span class="type">String</span> = d4</span><br><span class="line">c: <span class="type">Int</span> = <span class="number">3</span></span><br><span class="line">==&gt; è¿™é‡Œå°±ç›¸å½“äºç›´æ¥å®šä¹‰äº† a,b,c ä¸‰ä¸ªå˜é‡</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ•°ç»„çš„zip</span></span><br><span class="line">---------------------------------------------</span><br><span class="line"><span class="comment">//è¥¿é—¨åº† -&gt; æ½˜é‡‘è²  ç‰›éƒ -&gt; ä¾„å¥³  ,</span></span><br><span class="line">scala&gt; <span class="keyword">val</span> hus = <span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">hus: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> wife = <span class="type">Array</span>(<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>)</span><br><span class="line">wife: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; hus.zip(wife)</span><br><span class="line">res226: <span class="type">Array</span>[(<span class="type">Int</span>, <span class="type">Int</span>)] = <span class="type">Array</span>((<span class="number">1</span>,<span class="number">4</span>), (<span class="number">2</span>,<span class="number">5</span>), (<span class="number">3</span>,<span class="number">6</span>))</span><br><span class="line"></span><br><span class="line">æ³¨æ„: ä¸ªæ•°å¯¹ä¸ä¸Šçš„å°±ç æ‰äº†</span><br></pre></td></tr></table></figure><hr><h1 id="ä¸ƒ-OOP"><a href="#ä¸ƒ-OOP" class="headerlink" title="ä¸ƒ. OOP"></a>ä¸ƒ. OOP</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ç±» &amp; åŸºæœ¬æ“ä½œ</span></span><br><span class="line">===============================================================</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰å˜é‡, ç§æœ‰ç±»å‹, å¿…é¡»åˆå§‹åŒ–</span></span><br><span class="line">    <span class="comment">// .class ä¸­ç§æœ‰æ–¹æ³•æŸ¥çœ‹: javap -private xxx.class</span></span><br><span class="line">    <span class="comment">// getter/setter ä¹Ÿç§æœ‰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> id = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// p.name  =&gt; getter</span></span><br><span class="line">    <span class="comment">// p.name_=(xx) =&gt; setter </span></span><br><span class="line">    <span class="comment">// p.name = xx  =&gt; setter</span></span><br><span class="line">    <span class="comment">// ç”Ÿæˆç§æœ‰å±æ€§, å’Œå…±æœ‰çš„ getter/setter æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">"tom"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// val åªæœ‰ getter, æ²¡æœ‰setter, å®šä¹‰çš„æ˜¯ val å¸¸é‡</span></span><br><span class="line">    <span class="keyword">val</span> age = <span class="number">100</span>; </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">incre</span></span>(a:<span class="type">Int</span>) = &#123;id += a&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¦‚æœå®šä¹‰æ—¶ï¼Œæ²¡æœ‰(),è°ƒç”¨å°±ä¸èƒ½åŠ ()</span></span><br><span class="line">    <span class="comment">// æœ‰çš„è¯, è°ƒç”¨çš„æ—¶å€™å°±å¯åŠ å¯ä¸åŠ </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">current</span></span>() = id</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">-&gt;è°ƒç”¨</span><br><span class="line"></span><br><span class="line">    scala&gt;<span class="keyword">var</span> p = <span class="keyword">new</span> <span class="type">Person</span>();</span><br><span class="line">    scala&gt;p.current()</span><br><span class="line">    scala&gt;p.current</span><br><span class="line">    scala&gt;p.incr(<span class="number">100</span>)</span><br><span class="line">    scala&gt;p.name</span><br><span class="line">    scala&gt;p.name_=(<span class="string">"kkkk"</span>)</span><br><span class="line">    scala&gt;p.name = <span class="string">"kkkk"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// private[this]ä½œç”¨,æ§åˆ¶æˆå‘˜åªèƒ½åœ¨è‡ªå·±çš„å¯¹è±¡ä¸­è®¿é—®ã€‚ (å¯¹è±¡ç§æœ‰)</span></span><br><span class="line">===============================================================</span><br><span class="line"><span class="number">1</span>) <span class="type">Scala</span>ä¸­(<span class="type">Java</span>å’Œ <span class="type">C</span>++ ä¹Ÿä¸€æ ·), æ–¹æ³•å¯ä»¥è®¿é—®è¯¥ç±»çš„æ‰€æœ‰å¯¹è±¡çš„ç§æœ‰å­—æ®µ</span><br><span class="line"><span class="number">2</span>) <span class="keyword">private</span>[<span class="keyword">this</span>], æ˜¯ <span class="type">Counter</span> ç±»çš„æ–¹æ³•, åªèƒ½è®¿é—®åˆ°å½“å‰å¯¹è±¡çš„ value æ–¹æ³•, è€Œä¸èƒ½è®¿é—®åŒæ ·æ˜¯ <span class="type">Counter</span> ç±»å‹çš„å…¶ä»–å¯¹è±¡çš„è¯¥å­—æ®µ.</span><br><span class="line"><span class="number">3</span>) è¿™æ ·çš„è®¿é—®è¢«ç§°ä¸º å¯¹è±¡ç§æœ‰çš„</span><br><span class="line"><span class="number">4</span>) å¯¹äºç±»ç§æœ‰çš„å­—æ®µ, <span class="type">Scala</span> ç”Ÿæˆç§æœ‰çš„ getter å’Œ setter æ–¹æ³•;</span><br><span class="line">    ä½†å¯¹äºå¯¹è±¡ç§æœ‰çš„å­—æ®µ, <span class="type">Scala</span> æ ¹æœ¬ä¸ä¼šç”Ÿæˆ getter å’Œ setter æ–¹æ³•</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Counter</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">var</span> value =  <span class="number">0</span> ;</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">incre</span></span>(n:<span class="type">Int</span>)&#123;value += n&#125;</span><br><span class="line">        <span class="comment">// ç±»ä¼šå®šä¹‰å¤±è´¥, ä¸‹é¢è¿™å¥ä¸èƒ½è®¿é—®åˆ«ç±»å¯¹è±¡çš„ value</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">isLess</span></span>(other:<span class="type">Counter</span>) = value &lt; other.value ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰BeanPropertyæ³¨è§£ :TODO</span></span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">===============================================================</span><br><span class="line">&gt; è¾…åŠ©æ„é€ </span><br><span class="line">----------------------</span><br><span class="line">&gt;&gt; å®šä¹‰</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">        <span class="keyword">var</span> id = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">var</span> name = <span class="string">"tom"</span> ;</span><br><span class="line">        <span class="keyword">var</span> age = <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸€ä¸ªè¾…åŠ©æ„é€ å™¨</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">this</span></span>(name:<span class="type">String</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>();  <span class="comment">// è°ƒç”¨ä¸»æ„é€ å™¨</span></span><br><span class="line">            <span class="keyword">this</span>.name = name ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å¦ä¸€ä¸ªè¾…åŠ©æ„é€ </span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">this</span></span>(name:<span class="type">String</span>,age:<span class="type">Int</span>)&#123;</span><br><span class="line">            <span class="comment">//è°ƒç”¨å‰ä¸€ä¸ªè¾…åŠ©æ„é€ å™¨</span></span><br><span class="line">            <span class="keyword">this</span>(name) ;</span><br><span class="line">            <span class="keyword">this</span>.age = age ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&gt;&gt; ä½¿ç”¨</span><br><span class="line">scala&gt; <span class="keyword">var</span> p = <span class="keyword">new</span> <span class="type">Person</span>(<span class="string">"tm"</span>)</span><br><span class="line">p: <span class="type">Person</span> = <span class="type">Person</span>@<span class="number">2492</span>f6fb</span><br><span class="line"></span><br><span class="line">scala&gt; p.name</span><br><span class="line">res9: <span class="type">String</span> = tm</span><br><span class="line"></span><br><span class="line">scala&gt; p = <span class="keyword">new</span> <span class="type">Person</span>(<span class="string">"jr"</span>,<span class="number">23</span>)   <span class="comment">// æ³¨æ„: æ­¤ p éä¸Šé¢çš„ p äº†</span></span><br><span class="line">p: <span class="type">Person</span> = <span class="type">Person</span>@<span class="number">2536</span>edc3</span><br><span class="line"></span><br><span class="line">scala&gt; p.name</span><br><span class="line">res11: <span class="type">String</span> = jr</span><br><span class="line"></span><br><span class="line">scala&gt; p.age</span><br><span class="line">res12: <span class="type">Int</span> = <span class="number">23</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt; ä¸»æ„é€ å‡½æ•°</span><br><span class="line">---------------------------------------------</span><br><span class="line">    <span class="comment">//val ===&gt; åªè¯»</span></span><br><span class="line">    <span class="comment">//var ==&gt; get/set</span></span><br><span class="line">    <span class="comment">//none ==&gt; none</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„:  id å‰é¢æ²¡æœ‰ä¿®é¥°çš„è¯, åªæœ‰åœ¨è°ƒç”¨åæ‰å‡çº§ä¸ºæˆå‘˜å˜é‡, å¦åˆ™åœ¨ .class æ–‡ä»¶ä¸­ä¸ä¼šå‡ºç°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">val name:<span class="type">String</span>, var age:<span class="type">Int</span>, id :<span class="type">Int</span></span>)</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span></span>() = println(id)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&gt;&gt;ç¼–è¯‘åç”Ÿæˆçš„æ–‡ä»¶</span><br><span class="line">javap -<span class="keyword">private</span> <span class="type">Person</span>.<span class="keyword">class</span> -&gt; æ˜¾ç¤ºç¼–è¯‘åçš„ <span class="keyword">private</span> æˆå‘˜</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;                <span class="comment">// id è°ƒç”¨åæ‰å‡çº§ä¸ºæˆå‘˜å˜é‡</span></span><br><span class="line">  <span class="keyword">private</span> int age;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> int id;              </span><br><span class="line">  public java.lang.<span class="type">String</span> name();    <span class="comment">// getter</span></span><br><span class="line">  public int age();                  <span class="comment">// getter</span></span><br><span class="line">  public void age_$eq(int);          <span class="comment">// setter</span></span><br><span class="line">  public void hello();               </span><br><span class="line">  public <span class="type">Person</span>(java.lang.<span class="type">String</span>, int, int);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// object</span></span><br><span class="line">===============================================================</span><br><span class="line">è¯´æ˜ï¼šscalaæ²¡æœ‰é™æ€çš„æ¦‚å¿µï¼Œ'å¦‚æœéœ€è¦å®šä¹‰é™æ€æˆå‘˜ï¼Œå¯ä»¥é€šè¿‡<span class="class"><span class="keyword">object</span><span class="title">å®ç°ã€‚</span>'</span></span><br><span class="line"><span class="class">   <span class="title">ç¼–è¯‘å®Œæˆåï¼Œä¼šç”Ÿæˆå¯¹åº”çš„ç±»ï¼Œæ–¹æ³•éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œéé™æ€æˆå‘˜å¯¹åº”åˆ°å•ä¾‹ç±»ä¸­</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">//</span> <span class="title">å•ä¾‹ç±»ä»¥Util$ä½œä¸ºç±»åç§°ã€‚</span>   </span></span><br><span class="line"><span class="class"><span class="title">//</span> <span class="title">é™æ€æ–¹æ³•ç±»</span> <span class="title">ä»¥</span> <span class="title">Util</span> <span class="title">ä¸ºç±»åç§°</span>.</span></span><br><span class="line"><span class="class">    <span class="title">scala&gt;object</span> <span class="title">Util</span></span>&#123;</span><br><span class="line">        <span class="comment">//è¢«ç¼–è¯‘ä¸ºå•ä¾‹ç±»ä¸­.(Util$)</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> brand = <span class="string">"benz"</span> ;</span><br><span class="line">        <span class="comment">//è¢«ç¼–è¯‘ä¸º å•ç‹¬Util ç±»ä¸­çš„ é™æ€æ–¹æ³• </span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">hello</span></span>() = println(<span class="string">"hello world"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">âœ  scala javap -<span class="keyword">private</span> <span class="type">Util</span></span><br><span class="line"><span class="type">Compiled</span> from <span class="string">"util.scala"</span></span><br><span class="line">public <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Util</span> </span>&#123;</span><br><span class="line">  public static void hello();</span><br><span class="line">&#125;</span><br><span class="line">âœ  scala javap -<span class="keyword">private</span> <span class="type">Util</span>$</span><br><span class="line"><span class="type">Compiled</span> from <span class="string">"util.scala"</span></span><br><span class="line">public <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Util$</span> </span>&#123;</span><br><span class="line">  public static <span class="type">Util</span>$ <span class="type">MODULE</span>$;</span><br><span class="line">  <span class="keyword">private</span> java.lang.<span class="type">String</span> brand;</span><br><span class="line">  public static &#123;&#125;;</span><br><span class="line">  <span class="keyword">private</span> java.lang.<span class="type">String</span> brand();</span><br><span class="line">  <span class="keyword">private</span> void brand_$eq(java.lang.<span class="type">String</span>);</span><br><span class="line">  public void hello();</span><br><span class="line">  <span class="keyword">private</span> <span class="type">Util</span>$();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼´ç”Ÿå¯¹è±¡(companions object)</span></span><br><span class="line">------------------------------------------------------------------</span><br><span class="line"><span class="number">1.</span> ç±»åå’Œ<span class="class"><span class="keyword">object</span><span class="title">åç§°ç›¸åŒï¼Œè€Œä¸”å¿…é¡»åœ¨ä¸€ä¸ªscalaæ–‡ä»¶ä¸­å®šä¹‰ã€‚</span></span></span><br><span class="line"><span class="class">2. <span class="title">ç¼–è¯‘å</span>, <span class="title">ä¼šäº§ç”Ÿ2ä¸ªæ–‡ä»¶</span>, <span class="title">Car</span>.<span class="title">class</span> <span class="title">å’Œ</span> <span class="title">Car$</span>.<span class="title">class</span></span></span><br><span class="line"><span class="class">3. <span class="title">é™æ€æ–¹æ³•ä¼šè¢«ç¼–è¯‘åˆ°</span> <span class="title">Car</span>.<span class="title">class</span> <span class="title">ä¸­å»</span>, <span class="title">é™æ€æ–¹å¼å¯ç›´æ¥ç”¨ç±»è°ƒç”¨</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">Car</span></span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">stop</span></span>() = println(<span class="string">"stop...."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Car</span></span>&#123;   <span class="comment">// ä¼´ç”Ÿå¯¹è±¡, ç›®çš„å°±æ˜¯ä¸ºäº†äº§ç”Ÿé™æ€æ–¹æ³•</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">run</span></span>() = println(<span class="string">"run..."</span>)</span><br><span class="line">&#125;</span><br><span class="line">------------</span><br><span class="line">&gt; ç¼–è¯‘å</span><br><span class="line">âœ  scala javap -<span class="keyword">private</span> <span class="type">Car</span></span><br><span class="line"><span class="type">Compiled</span> from <span class="string">"companionsObject.scala"</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">  public static void run();</span><br><span class="line">  public void stop();</span><br><span class="line">  public <span class="type">Car</span>();</span><br><span class="line">&#125;</span><br><span class="line">âœ  scala javap -<span class="keyword">private</span> <span class="type">Car</span>$</span><br><span class="line"><span class="type">Compiled</span> from <span class="string">"companionsObject.scala"</span></span><br><span class="line">public <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Car$</span> </span>&#123;</span><br><span class="line">  public static <span class="type">Car</span>$ <span class="type">MODULE</span>$;</span><br><span class="line">  public static &#123;&#125;;</span><br><span class="line">  public void run();</span><br><span class="line">  <span class="keyword">private</span> <span class="type">Car</span>$();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> å› ä¸º main å‡½æ•°æ˜¯é™æ€æ–¹æ³•, æ‰€ä»¥å†™åœ¨ä¼´ç”Ÿå¯¹è±¡ä¸­</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">val name:<span class="type">String</span>, var age:<span class="type">Int</span>, id : <span class="type">Int</span></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span></span>() = println(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args:<span class="type">Array</span>[<span class="type">String</span>]) = println(<span class="string">"hello world"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">âœ  scala scala main.scala  <span class="comment">// ç›´æ¥ scala xx.scala ä¼šå…ˆç¼–è¯‘å†è¿è¡Œ</span></span><br><span class="line">hello world</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ½è±¡ &amp; é™æ€ </span></span><br><span class="line">===============================================================</span><br><span class="line">âœ æŠ½è±¡ &amp; é™æ€ test</span><br><span class="line"></span><br><span class="line">âœå®šä¹‰ç±»</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ½è±¡ç±»</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">a</span></span>():<span class="type">Unit</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// objectç­‰ä»·äºjavaä¸­çš„é™æ€ã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Jing8</span> <span class="keyword">extends</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é‡å†™æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">a</span></span>():<span class="type">Unit</span>= println(<span class="string">"hello"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Zangao</span> <span class="keyword">extends</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">a</span></span>():<span class="type">Unit</span> = println(<span class="string">"è€å­æ˜¯ä¸ªğŸ¶??"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">âœ è°ƒç”¨</span><br><span class="line">scala&gt; <span class="type">Jing8</span>.a            <span class="comment">// é™æ€æ–¹æ³•è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="type">Jing8</span>.a</span><br><span class="line">hello</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">var</span> za = <span class="keyword">new</span> <span class="type">Zangao</span>()  <span class="comment">// ç±»åˆ›å»ºå¯¹è±¡è°ƒç”¨</span></span><br><span class="line">za: <span class="type">Zangao</span> = <span class="type">Zangao</span>@<span class="number">77505</span>c0e</span><br><span class="line"></span><br><span class="line">scala&gt; za.a</span><br><span class="line">è€å­æ˜¯ä¸ªğŸ¶??</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// apply</span></span><br><span class="line">===============================================================</span><br><span class="line"><span class="number">1</span>) ä½¿ç”¨</span><br><span class="line"><span class="comment">// å®šä¹‰: </span></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Util</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(s:<span class="type">String</span>) = println(s) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è°ƒç”¨: ä¸‹é¢2è€…æ˜¯ä¸€ä¸ªæ„æ€</span></span><br><span class="line"><span class="type">Util</span>(<span class="string">"hello world"</span>);</span><br><span class="line"><span class="type">Util</span>.apply(<span class="string">"hello world"</span>);</span><br><span class="line">&gt; è¿è¡Œç»“æœ: hello world</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>) æ³¨æ„ç‚¹</span><br><span class="line"><span class="comment">// æ³¨æ„ä¸€ä¸‹2è€…çš„åŒºåˆ«</span></span><br><span class="line">scala&gt; <span class="keyword">var</span> arr = <span class="type">Array</span>(<span class="number">10</span>)</span><br><span class="line">arr: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; arr</span><br><span class="line">res18: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="type">Array</span>(<span class="number">10</span>)</span><br><span class="line">arr: <span class="type">Array</span>[<span class="type">Nothing</span>] = <span class="type">Array</span>(<span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»ˆç«¯ç¼–è¯‘è¿è¡Œ scalaæ–‡ä»¶</span></span><br><span class="line">===============================================================</span><br><span class="line">scalacç¼–è¯‘scalaæ–‡ä»¶ï¼Œäº§ç”Ÿ<span class="class"><span class="keyword">class</span><span class="title">æ–‡ä»¶ã€‚</span></span></span><br><span class="line"><span class="class"><span class="title">------------------------------------</span></span></span><br><span class="line"><span class="class">    <span class="title">cmd&gt;scalac</span> <span class="title">xxxx</span>.<span class="title">scala</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">è¿è¡Œclassç¨‹åº</span></span></span><br><span class="line"><span class="class"><span class="title">--------------------</span></span></span><br><span class="line"><span class="class">    <span class="title">cmd&gt;scala</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">ä¸€æ­¥åˆ°ä½</span></span></span><br><span class="line"><span class="class"><span class="title">-------------------</span></span></span><br><span class="line"><span class="class">    <span class="title">cmd&gt;scala</span> <span class="title">Person</span>.<span class="title">scala</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">//</span> <span class="title">trait</span>  (<span class="params">ç±»ä¼¼äº <span class="type">Java</span> ä¸­çš„ interface </span>)</span></span><br><span class="line"><span class="class"><span class="title">===============================================================</span></span></span><br><span class="line"><span class="class">    <span class="title">traint</span> <span class="title">HelloService</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åŒ…å¯¹è±¡ï¼Œç¼–è¯‘å®Œä¹‹åç”Ÿæˆä»¥ /a/a1/aa1/people/xxx.class..., ä¸€å±‚ä¸€å±‚æ–‡ä»¶å¤¹</span></span><br><span class="line">===============================================================</span><br><span class="line"><span class="keyword">package</span> a.a1.aa1;</span><br><span class="line"><span class="keyword">package</span> <span class="class"><span class="keyword">object</span> <span class="title">people</span> </span>&#123;</span><br><span class="line">    <span class="keyword">val</span> name = <span class="string">"hello world"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//çº¦æŸå¯è§æ€§ã€‚</span></span><br><span class="line">-----------------------</span><br><span class="line"><span class="keyword">private</span>[<span class="keyword">package</span>|<span class="keyword">this</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒ…çš„å¯¼å…¥</span></span><br><span class="line">--------------</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">Exception</span></span><br><span class="line"><span class="keyword">import</span> java.io.&#123;<span class="type">A</span>,<span class="type">B</span>,<span class="type">C</span>&#125;            <span class="comment">//åŒä¸€åŒ…ä¸‹çš„ä¸åŒç±», å¯ä»¥ç”¨å¤§æ‹¬å·åŒ…èµ·æ¥</span></span><br><span class="line"><span class="keyword">import</span> java.io.&#123;<span class="type">A</span> =&gt; <span class="type">A0</span>&#125;        <span class="comment">//åˆ«å</span></span><br></pre></td></tr></table></figure><hr><h1 id="å…«-ç»§æ‰¿-inheritance"><a href="#å…«-ç»§æ‰¿-inheritance" class="headerlink" title="å…«. ç»§æ‰¿ inheritance"></a>å…«. ç»§æ‰¿ inheritance</h1><p><strong>extends</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">ç»§æ‰¿/æ‰©å±•</span><br><span class="line">-------------------------------</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line">        <span class="comment">//é‡å†™,è¦†ç›–</span></span><br><span class="line">        <span class="comment">//overload</span></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">run</span></span>()=&#123;...&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç»§æ‰¿å®ä¾‹</span><br><span class="line">------------------------------</span><br><span class="line">$scala&gt;<span class="class"><span class="keyword">class</span> <span class="title">Animal</span>(<span class="params">val name:<span class="type">String</span></span>)</span>&#123;&#125;</span><br><span class="line">$scala&gt;<span class="class"><span class="keyword">class</span> <span class="title">Dog</span>(<span class="params">name:<span class="type">String</span>,val age:<span class="type">Int</span></span>) <span class="keyword">extends</span> <span class="title">Animal</span>(<span class="params">name</span>)</span>&#123;&#125;</span><br><span class="line">$scala&gt;<span class="class"><span class="keyword">class</span> <span class="title">Duck</span>(<span class="params">override val name:<span class="type">String</span>, val age:<span class="type">Int</span></span>) <span class="keyword">extends</span> <span class="title">Animal</span>(<span class="params">name:<span class="type">String</span></span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">æ³¨æ„</span></span>: å¦‚æœåœ¨æ„é€ é‡Œä¸ºç»§æ‰¿çš„çˆ¶ç±»ä¼ å‚, åˆ›å»ºçš„å­ç±»å¯¹è±¡ç›´æ¥ä¼šæœ‰å€¼</span><br><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">Duck</span>(<span class="params">name:<span class="type">String</span>, val age:<span class="type">Int</span></span>) <span class="keyword">extends</span> <span class="title">Animal</span>(<span class="params">"aa"</span>)</span></span><br><span class="line"><span class="class"><span class="title">defined</span> <span class="title">class</span> <span class="title">Duck</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">var</span> <span class="title">dd</span> </span>= <span class="keyword">new</span> <span class="type">Duck</span>(<span class="string">"cc"</span>,<span class="number">32</span>)</span><br><span class="line">dd: <span class="type">Duck</span> = <span class="type">Duck</span>@<span class="number">12</span>a63c27</span><br><span class="line"></span><br><span class="line">scala&gt; dd.name</span><br><span class="line">res33: <span class="type">String</span> = aa</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç±»å‹æ£€æŸ¥å’Œè½¬æ¢</span><br><span class="line">------------------------------</span><br><span class="line">    $scala&gt;<span class="class"><span class="keyword">class</span> <span class="title">Animal</span></span>&#123;&#125;</span><br><span class="line">    $scala&gt;<span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span></span>&#123;&#125;</span><br><span class="line">    $scala&gt;<span class="keyword">val</span> d = <span class="keyword">new</span> <span class="type">Dog</span>();</span><br><span class="line">    $scala&gt;d.isInstanceOf[<span class="type">Animal</span>]            <span class="comment">//true,===&gt; instanceOf</span></span><br><span class="line">    $scala&gt;<span class="keyword">val</span> a = d.asInstanceOf[<span class="type">Animal</span>]    <span class="comment">//å¼ºè½¬,===&gt; (Animal)d</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¾—åˆ°å¯¹è±¡çš„ç±» å¯¹è±¡ç±»å‹ å¾—åˆ°ç±»å‹</span></span><br><span class="line">    $scala&gt;d.getClass                        <span class="comment">//d.getClass(); è·å–å¯¹è±¡ç±»å‹</span></span><br><span class="line">    $scala&gt;d.getClass == classOf[<span class="type">Dog</span>]        <span class="comment">//ç²¾ç¡®åŒ¹é…</span></span><br></pre></td></tr></table></figure><hr><h1 id="ä¹-abstract-trait-file-apply-æ“ä½œç¬¦"><a href="#ä¹-abstract-trait-file-apply-æ“ä½œç¬¦" class="headerlink" title="ä¹. abstract , trait, file, apply, æ“ä½œç¬¦"></a>ä¹. abstract , trait, file, apply, æ“ä½œç¬¦</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//æŠ½è±¡ç±» abstract </span></span><br><span class="line">================================================</span><br><span class="line">$scala&gt;<span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span>(<span class="params">val name:<span class="type">String</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//æŠ½è±¡å­—æ®µï¼Œæ²¡æœ‰åˆå§‹åŒ–ã€‚</span></span><br><span class="line">    <span class="keyword">val</span> id:<span class="type">Int</span>  ;</span><br><span class="line">    <span class="comment">//æŠ½è±¡æ–¹æ³•ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼Œä¸éœ€è¦æŠ½è±¡å…³é”®å­—ä¿®é¥°ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span></span>() ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// scalaç±»å‹æ ‘  :TODO</span></span><br><span class="line">================================================</span><br><span class="line">    <span class="type">Any</span></span><br><span class="line">     |</span><br><span class="line">    /|\</span><br><span class="line">     |------------<span class="type">AnyVal</span> &lt;|------<span class="type">Int</span>|<span class="type">Boolean</span>|...|<span class="type">Unit</span></span><br><span class="line">     |------------<span class="type">AnyRef</span> &lt;|------<span class="class"><span class="keyword">class</span> ...</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">//</span> <span class="title">è¯»å–æ–‡ä»¶</span> <span class="title">file</span></span></span><br><span class="line"><span class="class"><span class="title">================================================</span></span></span><br><span class="line"><span class="class"><span class="title">-----------in</span> <span class="title">idea</span></span></span><br><span class="line"><span class="class">    <span class="title">import</span> <span class="title">scala</span>.<span class="title">io</span>.<span class="title">Source</span> </span>;</span><br><span class="line">    <span class="class"><span class="keyword">object</span> <span class="title">FileDemo</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">            <span class="keyword">val</span> s = <span class="type">Source</span>.fromFile(<span class="string">"d:/hello.txt"</span>) ;</span><br><span class="line">            <span class="keyword">val</span> lines = s.getLines();</span><br><span class="line">            <span class="keyword">for</span>(line &lt;- lines)&#123;</span><br><span class="line">                println(line)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---------in terminal</span><br><span class="line">    scala&gt; scala.io.<span class="type">Source</span>.fromFile(<span class="string">"/Users/shixuanji/Documents/IDEs/iTerm2/scala/util.scala"</span>).mkString</span><br><span class="line"><span class="comment">// ä¸‹é¢æ˜¯ä¸Šé¢æ‰§è¡Œçš„ç»“æœ</span></span><br><span class="line">    res34: <span class="type">String</span> =</span><br><span class="line">    <span class="class"><span class="keyword">object</span> <span class="title">Util</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> brand = <span class="string">"benz"</span>;</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">hello</span></span>() = println(<span class="string">"hello world"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//é€šè¿‡æ­£åˆ™ (å…·ä½“çš„æŸ¥çœ‹ dash çš„ jdk)</span></span><br><span class="line">\s : ç©ºç™½å­—ç¬¦ï¼š[ \t\n\x0B\f\r]</span><br><span class="line">\<span class="type">S</span> : éç©ºç™½å­—ç¬¦ï¼š[^\s]</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> str = <span class="type">Source</span>.fromFile(<span class="string">"/hello.txt"</span>).mkString</span><br><span class="line"><span class="keyword">val</span> it = str.split(<span class="string">"\\s+"</span>)     <span class="comment">// è¿‡æ»¤æ‰æ‰€æœ‰ä¸å¯è§å­—ç¬¦åˆ†å‰²</span></span><br><span class="line"><span class="keyword">for</span>(i &lt;- it)&#123;</span><br><span class="line">    println(i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// trait æ¥å£</span></span><br><span class="line">================================================</span><br><span class="line">&gt;  javaä¸­, å®ç°æ¥å£, ç”¨implement ,  scala ä¸­ç”¨ <span class="keyword">extends</span></span><br><span class="line">&gt;  å¦‚æœåªæœ‰ä¸€ä¸ª<span class="class"><span class="keyword">trait</span><span class="title">ä½¿ç”¨extendsè¿›è¡Œæ‰©å±•ï¼Œå¦‚æœå¤šä¸ªï¼Œä½¿ç”¨withå¯¹å‰©ä½™çš„traitè¿›è¡Œæ‰©å±•ã€‚</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">    <span class="title">trait</span> <span class="title">logger1</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">log1</span></span>() = println(<span class="string">"hello log1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">trait</span> <span class="title">logger2</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">log2</span></span>() = println(<span class="string">"hello log2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&gt;  <span class="class"><span class="keyword">trait</span>(<span class="params">æ¥å£</span>)<span class="title">ä¹‹é—´ä¹Ÿå¯ä»¥å­˜åœ¨æ‰©å±•ã€‚</span>     </span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">logger1</span> <span class="keyword">with</span> <span class="title">logger2</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªèº«ç±»å‹ :TODO  è¿˜ä¸æ˜ç™½æ˜¯å•¥æ„æ€, æœ‰ç©ºçœ‹çœ‹  ä¹¦ : 10.13 Self Types &amp; 18.10</span></span><br><span class="line">================================================</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">trait</span> <span class="title">logger</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>:<span class="type">Dog</span> =&gt; </span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">run</span></span>() = println(<span class="string">"run...."</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">trait</span> <span class="title">Dog</span> </span>&#123;&#125;</span><br><span class="line">    <span class="class"><span class="keyword">trait</span> <span class="title">Jing8</span> <span class="keyword">extends</span> <span class="title">Dog</span> <span class="keyword">with</span> <span class="title">logger</span></span>&#123;&#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">logger</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ“ä½œç¬¦</span></span><br><span class="line">================================================</span><br><span class="line">    <span class="comment">//ä¸­ç½®æ“ä½œç¬¦</span></span><br><span class="line">    scala&gt; <span class="number">1</span> + <span class="number">2</span>            <span class="comment">//</span></span><br><span class="line">    scala&gt; <span class="number">1.</span>+(<span class="number">2</span>)            <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å•å…ƒæ“ä½œç¬¦</span></span><br><span class="line">    scala&gt; <span class="number">1</span> toString        <span class="comment">//+: -:å–å !:booleanå–å ~:æŒ‰ä½å–å</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//èµ‹å€¼æ“ä½œç¬¦ </span></span><br><span class="line">    $scala&gt;+= , -= , *=,  /=</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//:è¡¨ç¤ºå³ç»“åˆ,åªæœ‰:ç»“å°¾çš„æ“ä½œç¬¦æ˜¯å³ç»“åˆ,ä¼˜å…ˆçº§ä»å³ä¾§å¼€å§‹</span></span><br><span class="line">----&gt; ç”¨äºæ„é€ åˆ—è¡¨çš„æ“ä½œç¬¦ :: æ˜¯å³ç»“åˆçš„</span><br><span class="line">    scala&gt;<span class="keyword">val</span> l = <span class="type">Nil</span>        <span class="comment">//æ„é€ ç©ºé›†åˆ.</span></span><br><span class="line">    scala&gt;<span class="number">1</span>::<span class="number">2</span>::<span class="type">Nil</span>            <span class="comment">//1::(2::Nil), å…ˆåˆ›å»ºåŒ…å«2çš„åˆ—è¡¨, è¿™ä¸ªåˆ—è¡¨åˆè¢«ä½œä¸ºä¸ºå˜›é¢‘é“ä»¥1ä¸ºå¤´éƒ¨çš„åˆ—è¡¨ä¸­</span></span><br><span class="line">    scala&gt;<span class="type">Nil</span>.::(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// apply()/update()   --&gt; å…¶å®å°±æ˜¯åœ¨ç­‰å·ä¸¤ä¾§çš„é—®é¢˜</span></span><br><span class="line">================================================</span><br><span class="line">    <span class="keyword">var</span> arr = <span class="type">Array</span>(<span class="number">100</span>)            <span class="comment">//Array.apply(100);</span></span><br><span class="line">    arr(<span class="number">0</span>) = <span class="number">200</span>            <span class="comment">//arr.update(0,1234)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//unapply(),æ˜¯applyçš„é€†å‘è¿‡ç¨‹ :TODO  æ²¡æ‡‚</span></span><br><span class="line">    <span class="comment">//å®šä¹‰ç±»</span></span><br><span class="line">------------</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fraction</span>(<span class="params">val n:<span class="type">Int</span>,val d:<span class="type">Int</span></span>)</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Fraction</span></span>&#123;</span><br><span class="line">    <span class="comment">//é€šè¿‡</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(n : <span class="type">Int</span>,d:<span class="type">Int</span>)= <span class="keyword">new</span> <span class="type">Fraction</span>(n,d) </span><br><span class="line">    <span class="comment">//é€†å‘è¿‡ç¨‹</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unapply</span></span>(f:<span class="type">Fraction</span>) = <span class="type">Some</span>(f.n,f.d)</span><br><span class="line">&#125;</span><br><span class="line">-------------</span><br><span class="line"><span class="comment">// å› ä¸ºå®šä¹‰äº† apply, æ‰€ä»¥ç›´æ¥è°ƒç”¨  Fraction(1,2) å°±ä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">    scala&gt; <span class="keyword">val</span> f = <span class="type">Fraction</span>(<span class="number">1</span>,<span class="number">2</span>)            <span class="comment">//apply(...)</span></span><br><span class="line">&gt; æ‰§è¡Œç»“æœ</span><br><span class="line">    scala&gt; f</span><br><span class="line">    res254: <span class="type">Fraction</span> = <span class="type">Fraction</span>@<span class="number">30</span>d2895e</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠå®šä¹‰çš„å‡½æ•° è¿˜åŸæˆ Fraction, æ­¤æ—¶, å°±ç›¸å½“äºå®šä¹‰äº† a,b</span></span><br><span class="line">    scala&gt; <span class="keyword">val</span> <span class="type">Fraction</span>(a,b) = f            <span class="comment">//unapply(...)</span></span><br><span class="line">&gt; æ‰§è¡Œç»“æœ</span><br><span class="line">    a: <span class="type">Int</span> = <span class="number">1</span></span><br><span class="line">    b: <span class="type">Int</span> = <span class="number">2</span></span><br></pre></td></tr></table></figure><hr><h1 id="å-é«˜é˜¶å‡½æ•°"><a href="#å-é«˜é˜¶å‡½æ•°" class="headerlink" title="å. é«˜é˜¶å‡½æ•°"></a>å. é«˜é˜¶å‡½æ•°</h1><p><a href="https://www.jianshu.com/p/d5ce4c683703" target="_blank" rel="noopener">â€”&gt; å‡½æ•° Function å’Œ  æ–¹æ³• Method çš„åŒºåˆ«, è§è¿™é‡Œ</a></p><p><strong>æŸ¥çœ‹å‡½æ•°</strong>: ç›´æ¥è¾“å…¥å‡½æ•°å</p><p><strong>æŸ¥çœ‹æ–¹æ³•</strong>: è¾“å…¥æ–¹æ³•åä¹‹å, æŒ‰ tab é”®æç¤º, ä¹Ÿä¼šå±•ç¤ºæ–¹æ³•</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line">åŸºæœ¬å‡½æ•°å®šä¹‰</span><br><span class="line">           å‚æ•°&amp;ç±»å‹       =&gt; å®ç°</span><br><span class="line"><span class="keyword">val</span> f1 = (x: <span class="type">Int</span>, y: <span class="type">Int</span>) =&gt; x + y</span><br><span class="line"><span class="keyword">val</span> f2 = (a:<span class="type">Double</span>)=&gt;a*a</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰é«˜é˜¶å‡½æ•° ä¾‹å­1</span></span><br><span class="line">================================================================</span><br><span class="line">    <span class="comment">// f æŒ‡å‚æ•°, fçš„ç±»å‹æ˜¯ (Double)=&gt;Double å‡½æ•°</span></span><br><span class="line">   <span class="comment">//  è¿™é‡Œçš„å‚æ•° f å¯ä»¥æ˜¯ä»»ä½•æ¥å— Double å¹¶è¿”å› Double çš„å‡½æ•°, valueAtOneQuarter å‡½æ•°, å°†è®¡ç®—é‚£ä¸ªå‡½æ•°åœ¨ 0.25ä½ç½®çš„å€¼</span></span><br><span class="line"><span class="comment">// æ³¨æ„: è¿™é‡Œåªæ¥å—ä¸€ä¸ª Double å‚æ•°</span></span><br><span class="line"><span class="keyword">import</span> scala.math._  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">valueAtOneQuarter</span></span>(f:<span class="type">Double</span>=&gt;<span class="type">Double</span>) = f(<span class="number">0.25</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨</span></span><br><span class="line">    <span class="comment">// å¾€å•å‡½æ•°å‚æ•°çš„å‡½æ•° çš„ å‚æ•°ä¸­, ä¼ ä¸€ä¸ªå‡½æ•°, æ­¤å‡½æ•°ç¬¦åˆ (Double)=&gt;Double) çš„ç‰¹å¾, ç„¶åå¾€æ­¤å‡½æ•°ä¸­, ä¼ å€¼ 0.25</span></span><br><span class="line"><span class="keyword">val</span> f2 = (a:<span class="type">Double</span>)=&gt;a*</span><br><span class="line">valueAtOneQuarter(f2)   <span class="comment">// æ‰§è¡Œæ—¶, ä¼šæŠŠåé¢çš„ 0.25ä¼ å…¥åˆ°</span></span><br><span class="line">valueAtOneQuarter(cail _)<span class="comment">// cail å‡½æ•°: å¤§äºä¼ å…¥å€¼çš„æœ€å°æ•´æ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// é«˜é˜¶å‡½æ•°ä¾‹å­2</span></span><br><span class="line">================================================================</span><br><span class="line">    <span class="comment">//              å‚æ•°       =  å‡½æ•°ä½“(å‡½æ•°) </span></span><br><span class="line"><span class="comment">//    å‚æ•°      =&gt;  è¿”å›å€¼  </span></span><br><span class="line"><span class="comment">// æ–¹æ³•çš„å®ç°æ˜¯ä¸€ä¸ªå‡½æ•°, æ­¤å‡½æ•°æœ‰è‡ªå·±å®šä¹‰çš„å‚æ•°, æœ‰ä»æ–¹æ³•ä½“ä¸­ä¼ æ¥çš„å‚æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mulby</span></span>(factor : <span class="type">Double</span>) = (x:<span class="type">Double</span>) =&gt; x * factor</span><br><span class="line">    mulby(<span class="number">2</span>)</span><br><span class="line">    scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">mulby</span></span>(factor : <span class="type">Double</span>) = (x:<span class="type">Double</span>) =&gt; x * factor</span><br><span class="line">    mulby: (factor: <span class="type">Double</span>)<span class="type">Double</span> =&gt; <span class="type">Double</span></span><br><span class="line"></span><br><span class="line">    scala&gt; mulby(<span class="number">2</span>)</span><br><span class="line">    res9: <span class="type">Double</span> =&gt; <span class="type">Double</span> = $$<span class="type">Lambda</span>$<span class="number">1165</span>/<span class="number">745462106</span>@<span class="number">3</span>d3e9163</span><br><span class="line"></span><br><span class="line">    scala&gt; mulby(<span class="number">2</span>)(<span class="number">2</span>)</span><br><span class="line">    res10: <span class="type">Double</span> = <span class="number">4.0</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; æ¥ä¸‹æ¥æŠŠæ¬¡mulby æ–¹æ³•, è½¬æˆå‡½æ•°è¯•è¯•</span><br><span class="line">    scala&gt; <span class="keyword">val</span> f_mulby = mulby _</span><br><span class="line">    f_mulby: <span class="type">Double</span> =&gt; (<span class="type">Double</span> =&gt; <span class="type">Double</span>) = $$<span class="type">Lambda</span>$<span class="number">1364</span>/<span class="number">1154393787</span>@<span class="number">6307382</span></span><br><span class="line">&gt;&gt;&gt; è°ƒç”¨æ–¹å¼è¿˜æ˜¯ä¸€æ ·çš„</span><br><span class="line">f_mulby(<span class="number">2</span>)(<span class="number">2</span>)</span><br><span class="line">-------------------------</span><br><span class="line">    scala&gt;<span class="function"><span class="keyword">def</span> <span class="title">multi</span></span>(n:<span class="type">Int</span>) = n * <span class="number">2</span></span><br><span class="line">    scala&gt;<span class="function"><span class="keyword">def</span> <span class="title">f</span> </span>= multi _                <span class="comment">// _ è¡¨ç¤º:æŠŠmulti è½¬ä¸ºå‡½æ•°</span></span><br><span class="line">    scala&gt;<span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>).map(f)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŒ¿åå‡½æ•°</span></span><br><span class="line">    scala&gt;(n:<span class="type">Double</span>)=&gt;<span class="number">3</span> * n                <span class="comment">// åŒ¿åå‡½æ•°</span></span><br><span class="line">    scala&gt;<span class="keyword">val</span> f = (n:<span class="type">Double</span>)=&gt;<span class="number">3</span> * n     <span class="comment">// å˜é‡å¼•ç”¨åŒ¿åå‡½æ•°</span></span><br><span class="line">    scala&gt;<span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>).map( (x) =&gt; x * <span class="number">3</span> );    <span class="comment">//æŠŠåŒ¿åå‡½æ•°ä¼ é€’ç»™ map æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ </span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰é«˜é˜¶å‡½æ•° ä¾‹å­3</span></span><br><span class="line">==============================================================================</span><br><span class="line"><span class="comment">// å®šä¹‰ call æ–¹æ³•, å…¶ä¸­2ä¸ªå‚æ•°ä¹Ÿä¸ºå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">call</span></span>(a:<span class="type">Int</span>, b:<span class="type">Int</span>, f1:(<span class="type">Int</span>,<span class="type">Int</span>)=&gt; <span class="type">Int</span>, f2:(<span class="type">Int</span>,<span class="type">Int</span>)=&gt; <span class="type">Int</span>) = &#123;</span><br><span class="line">    <span class="keyword">if</span>(a &gt; <span class="number">0</span>)  f1(a,b);</span><br><span class="line">    <span class="keyword">else</span>       f2(a,b);</span><br><span class="line">&#125;</span><br><span class="line">&gt;&gt;&gt;&gt; call: (a: <span class="type">Int</span>, b: <span class="type">Int</span>, f1: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span>, f2: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span>)<span class="type">Int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// -------&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  å®šä¹‰æ–¹æ³•, å†æŠŠæ–¹æ³•è½¬ä¸ºå‡½æ•°</span></span><br><span class="line"><span class="comment">// å®šä¹‰2ä¸ªå‚æ•°çš„æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(a:<span class="type">Int</span>,b:<span class="type">Int</span>) = a+b</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub</span></span>(a:<span class="type">Int</span>,b:<span class="type">Int</span>) = a-b</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•è½¬ä¸º f1, f2  (å½“ç„¶, ä¹Ÿå¯ä»¥ç›´æ¥å®šä¹‰å‡½æ•°)</span></span><br><span class="line"><span class="keyword">val</span> f1 = add _</span><br><span class="line"><span class="keyword">val</span> f2 = sub _</span><br><span class="line"></span><br><span class="line"><span class="comment">// -------&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  ç›´æ¥å®šä¹‰å‡½æ•°</span></span><br><span class="line">scala&gt; <span class="keyword">val</span> f1 = (a : <span class="type">Int</span>, b : <span class="type">Int</span>) =&gt; &#123; a + b &#125;</span><br><span class="line">f1: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span> = $$<span class="type">Lambda</span>$<span class="number">1388</span>/<span class="number">1164150759</span>@<span class="number">4</span>d41b630</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> f2 = (a : <span class="type">Int</span>, b : <span class="type">Int</span>) =&gt; &#123; a - b &#125;</span><br><span class="line">f2: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span> = $$<span class="type">Lambda</span>$<span class="number">1389</span>/<span class="number">1260221930</span>@<span class="number">37</span>dc38cc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨, å¯ä»¥ç”¨f1,f2,  ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨æ–¹æ³•åè°ƒç”¨, ä¼šé»˜è®¤è½¬ä¸ºå‡½æ•° :TODO äº†è§£åŸç†</span></span><br><span class="line">call(<span class="number">-1</span>,<span class="number">2</span>,f1,f2)</span><br><span class="line">call(<span class="number">1</span>,<span class="number">2</span>,add _, sub _)</span><br><span class="line">call(<span class="number">1</span>,<span class="number">2</span>,add,sub)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// call å‡½æ•°æå‡</span></span><br><span class="line">============================================================</span><br><span class="line">éœ€æ±‚: ä»¥ call å‡½æ•°çš„è¿”å›å€¼<span class="number">3</span>ä¸ºç³»æ•°, ç„¶åä¼ å¦ä¸€ä¸ªæ•° x åˆ°  å‡½æ•°y = <span class="number">3</span> * x ä¸­, å¾—åˆ° y</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">    <span class="keyword">val</span> f = call(<span class="number">1</span>,<span class="number">2</span>,f1,f2)</span><br><span class="line">    f(<span class="number">100</span>) = <span class="number">300</span> ;</span><br><span class="line">    call(<span class="number">1</span>,<span class="number">2</span>,add _,sub _)(<span class="number">100</span>) = <span class="number">300</span></span><br><span class="line"></span><br><span class="line">--&gt;&gt; å®šä¹‰</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span></span>(a:<span class="type">Int</span>,b:<span class="type">Int</span>,f1:(<span class="type">Int</span>,<span class="type">Int</span>)=&gt;<span class="type">Int</span>,f2:(<span class="type">Int</span>,<span class="type">Int</span>)=&gt;<span class="type">Int</span>)= &#123;</span><br><span class="line">        <span class="keyword">var</span> n = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span>(a &gt; <span class="number">0</span>) n = f1(a,b) ;</span><br><span class="line">        <span class="keyword">else</span>      n = f2(a,b) ;</span><br><span class="line">        <span class="comment">// å®šä¹‰æ–¹æ³•</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">multi</span></span>(x:<span class="type">Int</span>) = x * n ;</span><br><span class="line">        <span class="comment">// è½¬ä¸ºå‡½æ•°</span></span><br><span class="line">        multi _</span><br><span class="line">    &#125;</span><br><span class="line">âœ </span><br><span class="line">call: (a: <span class="type">Int</span>, b: <span class="type">Int</span>, f1: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span>, f2: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span>)<span class="type">Int</span> =&gt; <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">âœ è°ƒç”¨</span><br><span class="line">    scala&gt; call(<span class="number">1</span>,<span class="number">2</span>,add _, sub _)(<span class="number">100</span>)</span><br><span class="line">    res4: <span class="type">Int</span> = <span class="number">300</span></span><br><span class="line"></span><br><span class="line">âœ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œç›´æ¥è°ƒç”¨å‡½æ•°, ä¼ çš„æ˜¯å‡½æ•°çš„å®å‚, å‡½æ•°çš„å®ç°:</span><br><span class="line"><span class="comment">// f1 çš„å®ç°æ˜¯ a+b, f2 çš„å®ç°æ˜¯ a-b, è€Œè°ƒç”¨f1æˆ–f2 åœ¨ call æ–¹æ³•å®šä¹‰çš„æ—¶å€™</span></span><br><span class="line"><span class="comment">// å°±å·²ç»æŒ‡å®šäº†, è€Œå‚æ•°ä¹Ÿç”±å‰é¢çš„ a, b ä¼ è¿›æ¥, æ‰€ä»¥è¿™é‡Œå°±å¯ä»¥ç›´æ¥è°ƒç”¨äº†.</span></span><br><span class="line"><span class="comment">// æ­¤callæ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°, æ­¤å‡½æ•°éœ€è¦2ä¸ªå‚æ•°, ä¸€ä¸ªæ˜¯å‰é¢çš„æ‰§è¡Œç»“æœ</span></span><br><span class="line"><span class="comment">// ä¸€ä¸ªæ˜¯éœ€è¦è°ƒç”¨è€…ä¼ è¿›æ¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™é‡Œä¹Ÿå¯ä»¥æŠŠ callæ–¹æ³• çš„è¿”å›å€¼èµ‹å€¼ç»™ä¸€ä¸ª å‡½æ•°å˜é‡, å†ç»™è¿™ä¸ªå‡½æ•°å˜é‡ä¼ å€¼</span></span><br><span class="line"><span class="keyword">val</span> f = call(<span class="number">1</span>,<span class="number">2</span>,(a:<span class="type">Int</span>,b:<span class="type">Int</span>) =&gt; a+b,(a:<span class="type">Int</span>,b:<span class="type">Int</span>) =&gt; a-b)</span><br><span class="line">scala&gt; f(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥ç›´æ¥åœ¨åé¢æ¥ä¸Š <span class="number">100</span>, ç›´æ¥ä¼ å‚</span><br><span class="line">call(<span class="number">1</span>,<span class="number">2</span>,(a:<span class="type">Int</span>,b:<span class="type">Int</span>) =&gt; a+b,(a:<span class="type">Int</span>,b:<span class="type">Int</span>) =&gt; a-b)(<span class="number">100</span>)</span><br><span class="line">res7: <span class="type">Int</span> = <span class="number">300</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»å‹å‚æ•°å¯ä»¥å»æ‰, å› ä¸ºä½¿ç”¨çš„å‚æ•°å¯ä»¥è‡ªåŠ¨æ¨å¯¼å‡ºå‚æ•°çš„ç±»å‹</span></span><br><span class="line">    call(<span class="number">1</span>,<span class="number">2</span>,(a:<span class="type">Int</span>,b:<span class="type">Int</span>)=&gt;a + b , (a:<span class="type">Int</span>,b:<span class="type">Int</span>)=&gt; a- b)(<span class="number">100</span>)</span><br><span class="line"><span class="comment">// ç²¾ç®€è¿‡å</span></span><br><span class="line">    call(<span class="number">1</span>,<span class="number">2</span>,(a,b)=&gt;a + b , (a,b)=&gt; a- b)(<span class="number">100</span>)            </span><br><span class="line"></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ âœâœâœâœâœâœâœâœâœâœâœâœâœâœ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡½æ•°æ¨æ–­</span></span><br><span class="line"><span class="comment">// å¾ˆæ˜¾ç„¶, æ­¤æ–¹æ³•å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°, å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°, å‚æ•°\è¿”å›å€¼éƒ½æ˜¯ Double ç±»å‹</span></span><br><span class="line"><span class="comment">// æ³¨æ„: é‡Œé¢çš„å‡½æ•°æ˜¯ å½¢å‚, ä¹Ÿå°±æ˜¯è¯´ åªæ˜¯é¡¶ä¸€ä¸ªä¸€ä¸ª f å‡½æ•°, å‚æ•°&amp;è¿”å›å€¼ç±»å‹ä¸º Double, å¹¶æ²¡æœ‰å®šä¹‰å®ç°, åœ¨ä¼ å‡½æ•°çš„æ—¶å€™, è¦ç»™å‡ºå®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">valueAt</span></span>(f:(<span class="type">Double</span>)=&gt;<span class="type">Double</span>) = f(<span class="number">0.25</span>)</span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line">    valueAt((x:<span class="type">Double</span>)=&gt;x * <span class="number">3</span>)                <span class="comment">//å®šä¹‰ç±»å‹</span></span><br><span class="line">    valueAt((x)=&gt;x * <span class="number">3</span>)                       <span class="comment">//æ¨æ–­ç±»å‹</span></span><br><span class="line">    valueAt(x=&gt;x * <span class="number">3</span>)                         <span class="comment">//çœç•¥()</span></span><br><span class="line">    valueAt(<span class="number">3</span> * _)                            <span class="comment">//å‚æ•°åœ¨å³ä¾§å‡ºç°1æ¬¡ï¼Œå°±å¯ä»¥ä½¿ç”¨_ä»£æ›¿ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//é«˜çº§å‡½æ•°</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line">    scala&gt; <span class="keyword">val</span> arr = <span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    scala&gt; arr.map(<span class="number">2</span> * _);                    <span class="comment">//æ¯ä¸ªå…ƒç´ x2</span></span><br><span class="line">    scala&gt; arr.map((e:<span class="type">Int</span>)=&gt; e * <span class="number">2</span>);           <span class="comment">//æ¯ä¸ªå…ƒç´ x2</span></span><br><span class="line">    scala&gt; arr.map(_ * <span class="number">2</span>);                    <span class="comment">//æ¯ä¸ªå…ƒç´ x2</span></span><br><span class="line">scala&gt; arr.filter(_ % <span class="number">2</span> == <span class="number">0</span>)<span class="comment">// è¿‡æ»¤å‡ºé›†åˆä¸­çš„å¶æ•°</span></span><br><span class="line">res55: scala.collection.immutable.<span class="type">IndexedSeq</span>[<span class="type">Int</span>] = <span class="type">Vector</span>(<span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¶å®ƒçš„ç®€å•åº”ç”¨</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line"><span class="comment">// åœ¨å…ƒç´  * 3å‰å…ˆæ‰“å°</span></span><br><span class="line">    scala&gt; <span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>).map(e =&gt; &#123;println(e); e * <span class="number">3</span>&#125;)</span><br><span class="line">    <span class="number">1</span></span><br><span class="line">    <span class="number">2</span></span><br><span class="line">    <span class="number">3</span></span><br><span class="line">res56: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// filter è¿‡æ»¤</span></span><br><span class="line">    scala&gt; <span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>).filter(e =&gt; e%<span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">    res14: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1-10 å…ˆæ‰©å¤§3å€, å†è¿‡æ»¤å‡ºå¶æ•°</span></span><br><span class="line">    scala&gt; <span class="type">Array</span>(<span class="number">1</span> to <span class="number">10</span>:_*).map(<span class="number">3</span> * _).filter(_ % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">    res16: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">6</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡ºä¸‰è§’å½¢ foreach å‡½æ•°</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line">    scala&gt;(<span class="number">1</span> to <span class="number">9</span>).map(<span class="string">"*"</span> * _).foreach(println)</span><br><span class="line">    scala&gt;(<span class="number">1</span> to <span class="number">9</span>).map(<span class="string">"*"</span> * _).foreach(println _)</span><br><span class="line">    scala&gt;(<span class="number">1</span> to <span class="number">9</span>).map(<span class="string">"*"</span> * _).foreach(println (_))</span><br><span class="line">    scala&gt; <span class="type">Array</span>(<span class="number">1</span> to <span class="number">9</span>:_*).map(<span class="string">"*"</span> * _).foreach(println _)</span><br><span class="line"></span><br><span class="line"><span class="comment">// reduceLeft / reduceRight å‡½æ•°</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line"><span class="comment">//reduceLeft,ç”±å·¦è‡³å³, æ¯æ¬¡è¿›2ä¸ªå‚æ•°</span></span><br><span class="line">    <span class="keyword">val</span> r = (<span class="number">1</span> to <span class="number">10</span>)</span><br><span class="line">    scala&gt; r.reduceLeft(_ + _)</span><br><span class="line">    scala&gt; r.reduceLeft(_ - _)</span><br><span class="line">...</span><br><span class="line">â†’ æ‰§è¡Œæµç¨‹</span><br><span class="line"><span class="comment">//1,2,3 ==&gt; (1 - 2) -3)    = -4</span></span><br><span class="line"></span><br><span class="line"><span class="type">MR</span>:<span class="type">MapTask</span> + reduceTask,æ˜ å°„åŒ–ç®€.</span><br><span class="line"></span><br><span class="line"><span class="comment">//reduceRight,ç”±å³è‡³å·¦</span></span><br><span class="line">scala&gt; r.reduceRight(_-_)</span><br><span class="line">...</span><br><span class="line">â†’ æ‰§è¡Œæµç¨‹</span><br><span class="line">    <span class="comment">//1,2,3 ==&gt;1 - (2 - 3)= 2</span></span><br><span class="line">    <span class="comment">//1,2,3,4 ==&gt; 1 - (2 - (3 - 4)) = -2</span></span><br><span class="line">    <span class="comment">//1,2,3,4 ==&gt; 1 - (2 - (3 - 4)) = -2</span></span><br></pre></td></tr></table></figure><hr><h1 id="åä¸€-æŸ¯é‡ŒåŒ–"><a href="#åä¸€-æŸ¯é‡ŒåŒ–" class="headerlink" title="åä¸€. æŸ¯é‡ŒåŒ–"></a>åä¸€. æŸ¯é‡ŒåŒ–</h1><p><strong>æ¦‚å¿µ:</strong>  ä»¥é€»è¾‘å­¦å®¶ Haskell Brooks Curry çš„åå­—å‘½å </p><p><strong>å°†åŸæ¥æ¥å—2ä¸ªå‚æ•°çš„å‡½æ•°, å˜æˆæ–°çš„æ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•°çš„è¿‡ç¨‹.</strong> </p><p><strong>æ–°çš„å‡½æ•°è¿”å›ä¸€ä¸ªä»¥åŸæœ‰ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°</strong> </p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">â†’ åŸå‡½æ•°</span><br><span class="line">scala&gt;<span class="function"><span class="keyword">def</span> <span class="title">mul</span></span>(a:<span class="type">Int</span>,b:<span class="type">Int</span>) = a  * b;</span><br><span class="line">scala&gt;mul(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">â†’ æŸ¯é‡ŒåŒ–</span><br><span class="line">scala&gt;<span class="function"><span class="keyword">def</span> <span class="title">mulone</span></span>(a:<span class="type">Int</span>) = &#123;(x:<span class="type">Int</span>) =&gt; a * x ;&#125;</span><br><span class="line">scala&gt;mulone(<span class="number">1</span>)(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">â†’â†’â†’â†’â†’â†’â†’ æŸ¯é‡ŒåŒ–æµ‹è¯•</span><br><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">mulone</span></span>(a:<span class="type">Int</span>) = &#123;(x:<span class="type">Int</span>) =&gt; a * x&#125;</span><br><span class="line">mulone: (a: <span class="type">Int</span>)<span class="type">Int</span> =&gt; <span class="type">Int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é¦–å…ˆä¼ å…¥ä¸€ä¸ªå‚æ•°, å¾—åˆ°çš„æ˜¯å¦ä¸€å‡½æ•° x:Int =&gt; x * 2 (ä¹Ÿå°±æ˜¯åŸæ–¹æ³•çš„æ–¹æ³•ä½“)</span></span><br><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">f</span> </span>= mulone(<span class="number">2</span>)</span><br><span class="line">f: <span class="type">Int</span> =&gt; <span class="type">Int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤æ—¶æ¥ç€å†ä¼ å…¥å‚æ•° 4, å¾—åˆ° 4*2 =&gt; 8 </span></span><br><span class="line">scala&gt; f(<span class="number">4</span>)</span><br><span class="line">res33: <span class="type">Int</span> = <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥ä¼ å…¥2ä¸ªå‚æ•°å¯ç›´æ¥è°ƒç”¨æ­¤æ–¹æ³•, è¿”å›ç»“æœ</span></span><br><span class="line">scala&gt; mulone(<span class="number">2</span>)(<span class="number">4</span>)</span><br><span class="line">res34: <span class="type">Int</span> = <span class="number">8</span></span><br></pre></td></tr></table></figure><p><strong>ä¸æŸ¯é‡ŒåŒ–ç›¸å…³çš„çŸ¥è¯†ç‚¹(æ–¹æ³•å‘å‡½æ•°çš„è½¬æ¢)</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>) å¤šä¸ªå‚æ•°çš„æ–¹æ³•å¯ä»¥è½¬æ¢ä¸ºå¤šå…ƒå‡½æ•°</span><br><span class="line">-------------------</span><br><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">plus</span></span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>): <span class="type">Int</span> = x + y</span><br><span class="line">plus: (x: <span class="type">Int</span>, y: <span class="type">Int</span>)<span class="type">Int</span></span><br><span class="line"></span><br><span class="line">scala&gt; plus _</span><br><span class="line">res63: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span> = $$<span class="type">Lambda</span>$<span class="number">1495</span>/<span class="number">772136419</span>@<span class="number">16</span>b54416</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>) å¤šä¸ªå‚æ•°çš„æ–¹æ³•å˜æˆæŸ¯é‡Œå‡½æ•° ---&gt;  æ–¹æ³•å®šä¹‰çš„æ—¶å€™, ä¸åŒçš„å‚æ•°ç”¨ '()' åˆ†å¼€</span><br><span class="line">---------------------</span><br><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">plus</span></span>(x: <span class="type">Int</span>)(y: <span class="type">Int</span>): <span class="type">Int</span> = x + y</span><br><span class="line">plus: (x: <span class="type">Int</span>)(y: <span class="type">Int</span>)<span class="type">Int</span></span><br><span class="line"></span><br><span class="line">scala&gt; plus _</span><br><span class="line">res64: <span class="type">Int</span> =&gt; (<span class="type">Int</span> =&gt; <span class="type">Int</span>) = $$<span class="type">Lambda</span>$<span class="number">1496</span>/<span class="number">662093445</span>@<span class="number">51927988</span></span><br></pre></td></tr></table></figure><hr><h1 id="åäºŒ-æ§åˆ¶æŠ½è±¡"><a href="#åäºŒ-æ§åˆ¶æŠ½è±¡" class="headerlink" title="åäºŒ. æ§åˆ¶æŠ½è±¡"></a>åäºŒ. æ§åˆ¶æŠ½è±¡</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç±»ä¼¼äº OC ä¸­çš„ block, æ­¤ block æ— å‚æ•°æ— è¿”å›å€¼ :TODO æ˜¯æ§åˆ¶</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line"><span class="number">1</span>) å®šä¹‰è¿‡ç¨‹ï¼Œå¯åŠ¨åˆ†çº¿ç¨‹æ‰§è¡Œblockä»£ç . æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ª block æ— å‚æ— è¿”å‡½æ•°</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">newThread</span></span>(block: () =&gt; <span class="type">Unit</span>) &#123;</span><br><span class="line">      <span class="keyword">new</span> <span class="type">Thread</span>() &#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">run</span></span>() &#123;</span><br><span class="line">          block();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;.start();</span><br><span class="line">    &#125;</span><br><span class="line">-----------------</span><br><span class="line"><span class="number">2</span>) è°ƒç”¨ newThreadæ–¹æ³•, å¹¶ç»™ block ä¼ å€¼ <span class="symbol">'newThread</span>(()=&gt;&#123;...&#125;)'</span><br><span class="line">    newThread(() =&gt; &#123;</span><br><span class="line">      (<span class="number">1</span> to <span class="number">10</span>).foreach(e =&gt; &#123;</span><br><span class="line">        <span class="keyword">val</span> tname = <span class="type">Thread</span>.currentThread.getName();</span><br><span class="line">        println(tname + <span class="string">" : "</span> + e);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    );</span><br><span class="line">-------æ‰“å°ç»“æœ----------</span><br><span class="line">scala&gt; <span class="type">Thread</span><span class="number">-3</span> : <span class="number">1</span></span><br><span class="line"><span class="type">Thread</span><span class="number">-3</span> : <span class="number">2</span></span><br><span class="line"><span class="type">Thread</span><span class="number">-3</span> : <span class="number">3</span></span><br><span class="line"><span class="type">Thread</span><span class="number">-3</span> : <span class="number">4</span></span><br><span class="line"><span class="type">Thread</span><span class="number">-3</span> : <span class="number">5</span></span><br><span class="line"><span class="type">Thread</span><span class="number">-3</span> : <span class="number">6</span></span><br><span class="line"><span class="type">Thread</span><span class="number">-3</span> : <span class="number">7</span></span><br><span class="line"><span class="type">Thread</span><span class="number">-3</span> : <span class="number">8</span></span><br><span class="line"><span class="type">Thread</span><span class="number">-3</span> : <span class="number">9</span></span><br><span class="line"><span class="type">Thread</span><span class="number">-3</span> : <span class="number">10</span></span><br><span class="line"></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœ </span><br><span class="line"><span class="type">PS</span>: åœ¨ å®šä¹‰æ–¹æ³•çš„æ—¶å€™, å¯çœç•¥<span class="symbol">'newThread</span>(()=&gt;&#123;...&#125;)'å‰é¢çš„æ‹¬å·, å› ä¸ºæ²¡æœ‰å‚æ•°</span><br><span class="line">   åœ¨è°ƒç”¨æ–¹æ³•, å†™ block ä¸­çš„å†…å®¹æ—¶ <span class="symbol">'newThread</span>(() =&gt; &#123;&#125;)', å¯ä»¥ç›´æ¥å†™å¤§æ‹¬å·&#123;&#125;ä¸­çš„ä»£ç é€»è¾‘, å…¶å®è¿™ç©æ„å„¿å°±æ˜¯ è¯­æ³•ç³–</span><br></pre></td></tr></table></figure><hr><h1 id="åä¸‰-é›†åˆ"><a href="#åä¸‰-é›†åˆ" class="headerlink" title="åä¸‰. é›†åˆ"></a>åä¸‰. é›†åˆ</h1><h4 id="List-é›†åˆ"><a href="#List-é›†åˆ" class="headerlink" title="List é›†åˆ"></a>List é›†åˆ</h4><p><strong>List åœ¨æ·»åŠ å…ƒç´ æ—¶æ³¨æ„ç‚¹,è¯¦ç»†ä»£ç è§ä¸‹é¢:</strong> </p><ul><li>ä½¿ç”¨ <code>+:</code>  æˆ–<code>:=</code>æ·»åŠ å•ä¸ªå…ƒç´ æ—¶,  <code>:</code>å¿…é¡»é ç€ list ä¸€ä¾§, <code>+</code> å¿…é¡»é ç€ å•ä¸ªå…ƒç´  </li><li>å¦‚æœ2è¾¹éƒ½æ˜¯ list é›†åˆ, å¿…é¡»ç”¨  <code>++:</code>æˆ–è€… <code>:::</code>  æˆ–è€… <code>++</code></li><li>ä¸ç®¡æ˜¯ <code>+: , :+ ,  ++:</code>,  éƒ½ä¸ä¼šæ”¹å˜åŸ list çš„å€¼ </li><li>è¦æ·»åŠ çš„ <code>å…ƒç´  / list</code> åœ¨åŸ list çš„å“ªè¾¹, å°±æ·»åŠ åˆ° list çš„ é‚£è¾¹</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Nil (Listç©ºé›†åˆ)</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ </span><br><span class="line">scala&gt; <span class="number">1</span>::<span class="number">2</span>::<span class="type">Nil</span></span><br><span class="line">res71: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">var</span> l1 = <span class="number">1</span>::<span class="number">2</span>::<span class="type">Nil</span></span><br><span class="line">l1: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; l1</span><br><span class="line">res72: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="number">9</span>::l1</span><br><span class="line">res73: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">9</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// List æ±‚å’Œ</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ </span><br><span class="line">æ–¹å¼<span class="number">1</span>-é€’å½’</span><br><span class="line">-----------</span><br><span class="line">å®šä¹‰&gt;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(list:<span class="type">List</span>[<span class="type">Int</span>]) : <span class="type">Int</span> = &#123;</span><br><span class="line">        <span class="keyword">if</span>(list == <span class="type">Nil</span>) <span class="number">0</span> <span class="keyword">else</span> list.head + sum(list.tail)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">sum: (list: <span class="type">List</span>[<span class="type">Int</span>])<span class="type">Int</span></span><br><span class="line"></span><br><span class="line">è°ƒç”¨&gt;</span><br><span class="line">    scala&gt; <span class="keyword">val</span> list = <span class="number">1</span>::<span class="number">2</span>::<span class="number">3</span>::<span class="number">4</span>::<span class="type">Nil</span></span><br><span class="line">    list: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; sum(list)</span><br><span class="line">res41: <span class="type">Int</span> = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">æ–¹å¼<span class="number">2</span>-æ¨¡å¼åŒ¹é…</span><br><span class="line">-----------</span><br><span class="line">å…¶å®æœ¬è´¨ä¸Šä¹Ÿæ˜¯é€’å½’</span><br><span class="line">å®šä¹‰&gt;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(list:<span class="type">List</span>[<span class="type">Int</span>]) : <span class="type">Int</span> = list <span class="keyword">match</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Nil</span> =&gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">case</span> a::b =&gt; a + sum(b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">æ³¨æ„: ::å°†åˆ—è¡¨ ææ„ æˆå¤´éƒ¨å’Œå°¾éƒ¨</span><br><span class="line">é€’å½’ä¹‹æ‰€ä»¥é‚£ä¹ˆè‡ªç„¶, å› ä¸ºåˆ—è¡¨çš„å°¾éƒ¨æ­£å¥½åˆæ˜¯ä¸€ä¸ªåˆ—è¡¨</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">scala ç±»åº“çš„ sum</span><br><span class="line"><span class="type">List</span>(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>).sum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// List æ·»åŠ å…ƒç´ </span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ </span><br><span class="line">æ³¨æ„ç‚¹: <span class="number">1</span>) ä½¿ç”¨ +:  æˆ– := æ·»åŠ å•ä¸ªå…ƒç´ æ—¶,  : å¿…é¡»é ç€ list ä¸€ä¾§, + å¿…é¡»é ç€ å•ä¸ªå…ƒç´ </span><br><span class="line">        <span class="number">2</span>) å¦‚æœ<span class="number">2</span>è¾¹éƒ½æ˜¯ list, å¿…é¡»ç”¨  ++: </span><br><span class="line">        <span class="number">3</span>) ä¸ç®¡æ˜¯ +:  :+   ++:,  éƒ½ä¸ä¼šæ”¹å˜åŸ list çš„å€¼</span><br><span class="line">    <span class="number">4</span>) è¦æ·»åŠ çš„ å…ƒç´  / list åœ¨å“ªè¾¹, å°±æ·»åŠ åˆ°æ•°ç»„çš„å“ªè¾¹</span><br><span class="line">    scala&gt; <span class="keyword">var</span> list2 = <span class="number">1</span>::<span class="number">2</span>::<span class="number">3</span>::<span class="number">5</span>::<span class="number">4</span>::<span class="type">Nil</span></span><br><span class="line">    list2: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; list2</span><br><span class="line">    res46: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; list2 :+ <span class="number">3</span></span><br><span class="line">    res81: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; <span class="number">3</span> +: list2</span><br><span class="line">    res82: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; list2</span><br><span class="line">    res88: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; list2 ++: <span class="type">List</span>(<span class="number">99</span>)</span><br><span class="line">    res86: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">99</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt; <span class="type">List</span>(<span class="number">78</span>) ++: list2</span><br><span class="line">    res87: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">78</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ++ æ·»åŠ  å®ç°2é›†åˆåˆå¹¶</span></span><br><span class="line">    scala&gt;<span class="keyword">val</span> l1 = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">    scala&gt;<span class="keyword">val</span> l2 = <span class="type">List</span>(<span class="number">3</span>,<span class="number">4</span>)  </span><br><span class="line">    scala&gt;l1 ++ l2               ++  ä¸          :: æ•ˆæœç›¸åŒ     <span class="comment">// æ˜¯åœ¨l1çš„åé¢åŠ ä¸Šl2</span></span><br><span class="line">    scala&gt;l1 ++: l2              ++: ä¸ :::  æ•ˆæœç›¸åŒ          <span class="comment">// æ˜¯åœ¨ l2çš„å‰é¢åŠ ä¸Šl1</span></span><br></pre></td></tr></table></figure><h4 id="Set-é›†åˆ"><a href="#Set-é›†åˆ" class="headerlink" title="Set é›†åˆ"></a>Set é›†åˆ</h4><p><strong>æ³¨æ„:</strong> </p><ul><li><strong>ä¸å¯å˜ Set</strong> æ·»åŠ çš„æ˜¯ <strong>å…ƒç¥–</strong>, ä½¿ç”¨<code>+=</code>  äº§ç”Ÿæ–°é›†åˆ, <strong>è‡ªèº«æ— æ³•æ”¹å˜</strong>, å¯ä»¥èµ‹å€¼ç»™æ–°çš„å¸¸é‡ val</li><li><strong>å¯å˜ Set ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>+=</code> æ·»åŠ  å…ƒç¥–</strong>, <strong>æ”¹å˜è‡ªèº«</strong>,  è¿˜å¯ä»¥<strong>ä½¿ç”¨ <code>++=</code> æ·»åŠ å…¶ä»–é›†åˆ, æ¯”å¦‚ List, Array, Range(1 to 10) ç­‰â€¦</strong></li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Set å¯å˜é›†åˆçš„æ“ä½œ(é»˜è®¤)</span></span><br><span class="line">------------------------------------------------------------</span><br><span class="line"><span class="comment">// Set æ·»åŠ æˆå‘˜(å…ƒç¥–, ä¼šè‡ªåŠ¨å»é‡, æ— åº)</span></span><br><span class="line">    scala&gt;<span class="keyword">val</span> set = <span class="type">Set</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">    scala&gt;set + (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">    scala&gt;set - (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    scala&gt;<span class="keyword">val</span> s1 = <span class="type">Set</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">    scala&gt;<span class="keyword">val</span> s2 = <span class="type">Set</span>(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    scala&gt;s1 | s2                   <span class="comment">//å¹¶é›†</span></span><br><span class="line">    scala&gt;s1 &amp; s2                  <span class="comment">//äº¤é›†</span></span><br><span class="line">    scala&gt;s1 &amp;~ s2                <span class="comment">//å·®é›†(1,2,3) - (2,3,4) = (1)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Set ä¸å¯å˜é›†åˆçš„æ“ä½œ</span></span><br><span class="line">------------------------------------------------------------</span><br><span class="line"># å¯¼åŒ…</span><br><span class="line">scala&gt;<span class="keyword">import</span> scala.collection.mutable.&#123;<span class="type">Set</span> =&gt; <span class="type">MSet</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ += æ·»åŠ å…ƒç¥–</span></span><br><span class="line">scala&gt; mset += <span class="number">3</span></span><br><span class="line">res129: mset.<span class="keyword">type</span> = <span class="type">Set</span>(<span class="number">0</span>, <span class="number">9</span>, <span class="number">45</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">98</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">43</span>, ğŸ˜</span><br><span class="line"></span><br><span class="line">scala&gt; mset += (<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>)</span><br><span class="line">res132: mset.<span class="keyword">type</span> = <span class="type">Set</span>(<span class="number">0</span>, <span class="number">9</span>, <span class="number">45</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">24</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">25</span>, <span class="number">4</span>, <span class="number">98</span>, <span class="number">26</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">21</span>, <span class="number">7</span>, <span class="number">43</span>, ğŸ˜</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ ++= æ·»åŠ  Array, List, Range...</span></span><br><span class="line">scala&gt; mset ++= <span class="type">Array</span>(<span class="number">3</span>,<span class="number">45</span>)</span><br><span class="line">res125: mset.<span class="keyword">type</span> = <span class="type">Set</span>(<span class="number">0</span>, <span class="number">9</span>, <span class="number">45</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">4</span>, ğŸ˜</span><br><span class="line"></span><br><span class="line">scala&gt; mset ++= <span class="type">List</span>(<span class="number">43</span>,<span class="number">98</span>)</span><br><span class="line">res128: mset.<span class="keyword">type</span> = <span class="type">Set</span>(<span class="number">0</span>, <span class="number">9</span>, <span class="number">45</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">98</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">43</span>, ğŸ˜</span><br><span class="line"></span><br><span class="line">scala&gt; mset ++= (<span class="number">0</span> to <span class="number">10</span>)</span><br><span class="line">res123: mset.<span class="keyword">type</span> = <span class="type">Set</span>(<span class="number">0</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">4</span>, ğŸ˜</span><br></pre></td></tr></table></figure><h4 id="å…¶ä»–çš„ä¸€äº›æ“ä½œ"><a href="#å…¶ä»–çš„ä¸€äº›æ“ä½œ" class="headerlink" title="å…¶ä»–çš„ä¸€äº›æ“ä½œ"></a>å…¶ä»–çš„ä¸€äº›æ“ä½œ</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸»è¦æ˜¯ ArrayBufferçš„</span></span><br><span class="line">------------------------------------------------------------</span><br><span class="line">scala&gt; <span class="keyword">import</span> scala.collection.mutable._</span><br><span class="line"><span class="keyword">import</span> scala.collection.mutable._</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> buf = <span class="type">ArrayBuffer</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">buf: scala.collection.mutable.<span class="type">ArrayBuffer</span>[<span class="type">Int</span>] = <span class="type">ArrayBuffer</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="number">2</span> +=: buf</span><br><span class="line">res138: buf.<span class="keyword">type</span> = <span class="type">ArrayBuffer</span>(<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æå–å‰2ä¸ªå…ƒç´ , buf æœ¬èº«ä¸å˜</span></span><br><span class="line">scala&gt; buf.take(<span class="number">2</span>)</span><br><span class="line">res139: scala.collection.mutable.<span class="type">ArrayBuffer</span>[<span class="type">Int</span>] = <span class="type">ArrayBuffer</span>(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤å‰2ä¸ªå…ƒç´ , buf æœ¬èº«ä¸å˜</span></span><br><span class="line">scala&gt; buf.drop(<span class="number">2</span>)</span><br><span class="line">res141: scala.collection.mutable.<span class="type">ArrayBuffer</span>[<span class="type">Int</span>] = <span class="type">ArrayBuffer</span>(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; buf</span><br><span class="line">res142: scala.collection.mutable.<span class="type">ArrayBuffer</span>[<span class="type">Int</span>] = <span class="type">ArrayBuffer</span>(<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨æŒ‡å®šä½ç½®è¿›è¡Œåˆ‡å‰²ï¼Œå½¢æˆä¸¤ä¸ªæ–°é›†åˆã€‚</span></span><br><span class="line">scala&gt; buf.splitAt(<span class="number">2</span>)</span><br><span class="line">res143: (scala.collection.mutable.<span class="type">ArrayBuffer</span>[<span class="type">Int</span>], scala.collection.mutable.<span class="type">ArrayBuffer</span>[<span class="type">Int</span>]) = (<span class="type">ArrayBuffer</span>(<span class="number">2</span>, <span class="number">1</span>),<span class="type">ArrayBuffer</span>(<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> b1 = <span class="type">ArrayBuffer</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">scala&gt; <span class="keyword">val</span> b2 = <span class="type">ArrayBuffer</span>(<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// èˆå¼ƒæ‰å°‘çš„</span></span><br><span class="line">scala&gt; b1.zip(b2)</span><br><span class="line">res145: scala.collection.mutable.<span class="type">ArrayBuffer</span>[(<span class="type">Int</span>, <span class="type">Int</span>)] = <span class="type">ArrayBuffer</span>((<span class="number">1</span>,<span class="number">3</span>), (<span class="number">2</span>,<span class="number">4</span>), (<span class="number">3</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//  b1ä¸å¤Ÿ, ç”¨-1è¡¥, b2ä¸å¤Ÿ, ç”¨-2è¡¥</span></span><br><span class="line">scala&gt; b1.zipAll(b2,<span class="number">-1</span>,<span class="number">-2</span>)</span><br><span class="line">res146: scala.collection.mutable.<span class="type">ArrayBuffer</span>[(<span class="type">Int</span>, <span class="type">Int</span>)] = <span class="type">ArrayBuffer</span>((<span class="number">1</span>,<span class="number">3</span>), (<span class="number">2</span>,<span class="number">4</span>), (<span class="number">3</span>,<span class="number">5</span>), (<span class="number">-1</span>,<span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…ƒç´ å’Œè‡ªå·±çš„ç´¢å¼•å½¢æˆtuple.,å…ƒç´ åœ¨å‰, ç´¢å¼•åœ¨å</span></span><br><span class="line">scala&gt; b1.zipWithIndex</span><br><span class="line">res147: scala.collection.mutable.<span class="type">ArrayBuffer</span>[(<span class="type">Int</span>, <span class="type">Int</span>)] = <span class="type">ArrayBuffer</span>((<span class="number">1</span>,<span class="number">0</span>), (<span class="number">2</span>,<span class="number">1</span>), (<span class="number">3</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">scala&gt; b1.zip(b2).zipWithIndex</span><br><span class="line">res148: scala.collection.mutable.<span class="type">ArrayBuffer</span>[((<span class="type">Int</span>, <span class="type">Int</span>), <span class="type">Int</span>)] = <span class="type">ArrayBuffer</span>(((<span class="number">1</span>,<span class="number">3</span>),<span class="number">0</span>), ((<span class="number">2</span>,<span class="number">4</span>),<span class="number">1</span>), ((<span class="number">3</span>,<span class="number">5</span>),<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å·¦å³æŠ˜å </span></span><br><span class="line">------------------------------------------------------------</span><br><span class="line"><span class="comment">//å·¦æŠ˜å </span></span><br><span class="line">scala&gt; <span class="type">List</span>(<span class="number">1</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">9</span>).foldLeft(<span class="number">0</span>)(_-_)</span><br><span class="line">res87: <span class="type">Int</span> = <span class="number">-19</span></span><br><span class="line">    (<span class="number">0</span> - <span class="number">1</span>) - <span class="number">7</span> - <span class="number">2</span> - <span class="number">9</span>            <span class="comment">//-19</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">//å³æŠ˜å </span></span><br><span class="line">scala&gt; <span class="type">List</span>(<span class="number">1</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">9</span>).foldRight(<span class="number">0</span>)(_-_)</span><br><span class="line">res88: <span class="type">Int</span> = <span class="number">-13</span></span><br><span class="line">    <span class="number">1</span>  - (<span class="number">7</span> - (<span class="number">2</span> - (<span class="number">9</span> - <span class="number">0</span>))_    <span class="comment">//-13</span></span><br></pre></td></tr></table></figure><hr><h1 id="åå››-æ¨¡å¼åŒ¹é…-amp-åå‡½æ•°"><a href="#åå››-æ¨¡å¼åŒ¹é…-amp-åå‡½æ•°" class="headerlink" title="åå››. æ¨¡å¼åŒ¹é… &amp; åå‡½æ•°"></a>åå››. æ¨¡å¼åŒ¹é… &amp; åå‡½æ•°</h1><h4 id="1-å­—ç¬¦ä¸²åŒ¹é…"><a href="#1-å­—ç¬¦ä¸²åŒ¹é…" class="headerlink" title="1. å­—ç¬¦ä¸²åŒ¹é…"></a>1. å­—ç¬¦ä¸²åŒ¹é…</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> x = '<span class="number">9</span>'</span><br><span class="line">x: <span class="type">Char</span> = <span class="number">9</span></span><br><span class="line"></span><br><span class="line">scala&gt; x <span class="keyword">match</span>&#123;</span><br><span class="line">     |   <span class="keyword">case</span> '+' =&gt; print(<span class="string">"++++"</span>)</span><br><span class="line">     |   <span class="keyword">case</span> '_' =&gt; print(<span class="string">"-----"</span>)</span><br><span class="line">     |   <span class="keyword">case</span> _ <span class="keyword">if</span> <span class="type">Character</span>.isDigit(x) =&gt; print(<span class="string">"is number!"</span>)</span><br><span class="line">     |   <span class="keyword">case</span> _ =&gt; print(<span class="string">"..."</span>)</span><br><span class="line">     | &#125;</span><br><span class="line">&gt; is number!</span><br></pre></td></tr></table></figure><h4 id="2-åŒ¹é…ç±»å‹-xç±»å‹å®šä¹‰æˆåˆ¤æ–­ç±»å‹çš„å…±åŒè¶…ç±»ã€‚"><a href="#2-åŒ¹é…ç±»å‹-xç±»å‹å®šä¹‰æˆåˆ¤æ–­ç±»å‹çš„å…±åŒè¶…ç±»ã€‚" class="headerlink" title="2. åŒ¹é…ç±»å‹,xç±»å‹å®šä¹‰æˆåˆ¤æ–­ç±»å‹çš„å…±åŒè¶…ç±»ã€‚"></a>2. åŒ¹é…ç±»å‹,xç±»å‹å®šä¹‰æˆåˆ¤æ–­ç±»å‹çš„å…±åŒè¶…ç±»ã€‚</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scala&gt;    <span class="keyword">val</span> x:<span class="type">Any</span> = <span class="string">"123"</span></span><br><span class="line">x: <span class="type">Any</span> = <span class="number">123</span></span><br><span class="line"></span><br><span class="line">scala&gt; x <span class="keyword">match</span>&#123;</span><br><span class="line">     |   <span class="keyword">case</span> b:<span class="type">Int</span> =&gt; print(<span class="string">"is Int"</span>) ;</span><br><span class="line">     |   <span class="keyword">case</span> a:<span class="type">String</span> =&gt; print(<span class="string">"is String"</span>) ;</span><br><span class="line">     |   <span class="keyword">case</span> _ =&gt; print(<span class="string">"is Int"</span>) ;</span><br><span class="line">     | &#125;</span><br><span class="line">is <span class="type">String</span></span><br></pre></td></tr></table></figure><h4 id="3-åŒ¹é…æ•°ç»„æ•°æ®"><a href="#3-åŒ¹é…æ•°ç»„æ•°æ®" class="headerlink" title="3. åŒ¹é…æ•°ç»„æ•°æ®"></a>3. åŒ¹é…æ•°ç»„æ•°æ®</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> arr = <span class="type">Array</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">arr: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; arr <span class="keyword">match</span>&#123;</span><br><span class="line">     |     <span class="comment">//åŒ¹é…arrä¸­åªæœ‰ 0 </span></span><br><span class="line">     |     <span class="keyword">case</span> <span class="type">Array</span>(<span class="number">0</span>) =&gt; println(<span class="string">"arr ä¸­åªå«æœ‰0"</span>)</span><br><span class="line">     |     <span class="comment">//åŒ¹é…æ˜¯å¦ä¸¤ä¸ªå…ƒç´ </span></span><br><span class="line">     |     <span class="keyword">case</span> <span class="type">Array</span>(x,y) =&gt; println(<span class="string">"æœ‰ä¸¤ä¸ªå…ƒç´ "</span>)</span><br><span class="line">     |     <span class="comment">//æ˜¯å¦ä»0å¼€å§‹</span></span><br><span class="line">     |     <span class="keyword">case</span> <span class="type">Array</span>(<span class="number">0</span>,_*) =&gt; println(<span class="string">"ä»0å¼€å§‹"</span>)</span><br><span class="line">     |     <span class="keyword">case</span> _ =&gt; println(<span class="string">"æœ‰0"</span>)</span><br></pre></td></tr></table></figure><h4 id="4-åå‡½æ•°"><a href="#4-åå‡½æ•°" class="headerlink" title="4. åå‡½æ•°"></a>4. åå‡½æ•°</h4><p><strong>æŠŠæ¨¡å¼åŒ¹é…æŠ½å‡ºæ¥å˜æˆå‡½æ•°äº†</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> ---å®šä¹‰</span><br><span class="line"><span class="keyword">val</span> f : <span class="type">PartialFunction</span>[<span class="type">Char</span>, <span class="type">Int</span>] = &#123;</span><br><span class="line">        <span class="keyword">case</span> '+' =&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> '-' =&gt; <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">case</span> _ =&gt; <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">---æµ‹è¯•</span><br><span class="line">    scala&gt; f('x')</span><br><span class="line">    res106: <span class="type">Int</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    scala&gt; f('+')</span><br><span class="line">    res107: <span class="type">Int</span> = <span class="number">1</span></span><br></pre></td></tr></table></figure><hr><h1 id="åäº”-æ ·ä¾‹ç±»"><a href="#åäº”-æ ·ä¾‹ç±»" class="headerlink" title="åäº”. æ ·ä¾‹ç±»"></a>åäº”. æ ·ä¾‹ç±»</h1><p><strong>å…³é”®å­— : case</strong></p><p>ä¸»è¦ç”¨äºæ¨¡å¼åŒ¹é….  </p><p><strong>å†…ç½®äº†applyå’Œunapplyæ–¹æ³•ï¼Œè¿˜æœ‰ä¸²è¡ŒåŒ–ç­‰æ¥å£ã€‚</strong> </p><p>åˆ›å»ºå¯¹è±¡æ—¶ä¸éœ€è¦ä½¿ç”¨new. </p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// åˆ›å»ºæ ·ä¾‹ç±»</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span>&#123;&#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Jing8</span>(<span class="params">name:<span class="type">String</span></span>) <span class="keyword">extends</span> <span class="title">Dog</span></span>&#123;&#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Shapi</span>(<span class="params">age:<span class="type">Int</span></span>) <span class="keyword">extends</span> <span class="title">Dog</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    scala&gt; <span class="keyword">val</span> d = <span class="type">Jing8</span>(<span class="string">"tom"</span>)<span class="comment">// å¯ä»¥ç›´æ¥åˆ›å»º, å› ä¸ºå†…ç½®äº† apply</span></span><br><span class="line"></span><br><span class="line">    d <span class="keyword">match</span>&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">Jing8</span>(name) =&gt; print(<span class="string">"æ˜¯Jing8 : "</span> + name);</span><br><span class="line">        <span class="keyword">case</span> <span class="type">Shapi</span>(age) =&gt; print(<span class="string">"æ˜¯Shapi : "</span> + age);</span><br><span class="line">        <span class="keyword">case</span> _ =&gt; print(<span class="string">"aishiuihsui"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">--&gt; è¿è¡Œç»“æœ:</span><br><span class="line">æ˜¯ <span class="type">Jing8</span>: tom</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥çœ‹ .class æ–‡ä»¶</span></span><br><span class="line"><span class="comment">// å‘ç°æœ‰ apply, unapply, implements scala.Serializable ç­‰</span></span><br><span class="line">--------------------------------------------------</span><br><span class="line">âœ  scala javap -<span class="keyword">private</span> <span class="type">Jing8</span>$.<span class="keyword">class</span></span><br><span class="line"><span class="type">Compiled</span> from <span class="string">"dog.scala"</span></span><br><span class="line">public <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Jing8$</span> <span class="keyword">extends</span> <span class="title">scala</span>.<span class="title">runtime</span>.<span class="title">AbstractFunction1&lt;java</span>.<span class="title">lang</span>.<span class="title">String</span>, <span class="title">Jing8&gt;</span> <span class="title">implements</span> <span class="title">scala</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  public static <span class="type">Jing8</span>$ <span class="type">MODULE</span>$;</span><br><span class="line">  public static &#123;&#125;;</span><br><span class="line">  public <span class="keyword">final</span> java.lang.<span class="type">String</span> toString();</span><br><span class="line">  public <span class="type">Jing8</span> apply(java.lang.<span class="type">String</span>);</span><br><span class="line">  public scala.<span class="type">Option</span>&lt;java.lang.<span class="type">String</span>&gt; unapply(<span class="type">Jing8</span>);</span><br><span class="line">  <span class="keyword">private</span> java.lang.<span class="type">Object</span> readResolve();</span><br><span class="line">  public java.lang.<span class="type">Object</span> apply(java.lang.<span class="type">Object</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="type">Jing8</span>$();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯†å°æ ·ä¾‹ç±»</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line"> å­ç±»å’Œçˆ¶ç±»å¿…é¡»å®šä¹‰åœ¨åŒä¸€æ–‡ä»¶ä¸­ã€‚</span><br><span class="line">    <span class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span>&#123;&#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Jing8</span>(<span class="params">name:<span class="type">String</span></span>) <span class="keyword">extends</span> <span class="title">Dog</span></span>&#123;&#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Shapi</span>(<span class="params">age:<span class="type">Int</span></span>) <span class="keyword">extends</span> <span class="title">Dog</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure><h1 id="åå…­-æ³›å‹"><a href="#åå…­-æ³›å‹" class="headerlink" title="åå…­. æ³›å‹"></a>åå…­. æ³›å‹</h1><h4 id="1-æ³›å‹çš„å®šä¹‰-amp-ä¸Šä¸‹ç•Œ"><a href="#1-æ³›å‹çš„å®šä¹‰-amp-ä¸Šä¸‹ç•Œ" class="headerlink" title="1. æ³›å‹çš„å®šä¹‰ &amp; ä¸Šä¸‹ç•Œ"></a>1. æ³›å‹çš„å®šä¹‰ &amp; ä¸Šä¸‹ç•Œ</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Java ä¸­å¸¸ç”¨çš„æ³›å‹</span></span><br><span class="line">    <span class="type">List</span>&lt;<span class="type">String</span>&gt;            </span><br><span class="line">    <span class="type">Map</span>&lt;<span class="type">String</span>,<span class="type">String</span>&gt;      </span><br><span class="line"></span><br><span class="line"><span class="comment">// Scala ä¸­çš„æ³›å‹</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç±»çš„æ³›å‹,å®šä¹‰æ³›å‹ç±»</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Pair</span>[<span class="type">T</span>,<span class="type">S</span>](<span class="params">one:<span class="type">T</span>,second:<span class="type">S</span></span>)</span>;        <span class="comment">//å®šä¹‰æ³›å‹ç±»</span></span><br><span class="line">    <span class="keyword">val</span> p = <span class="keyword">new</span> <span class="type">Pair</span>[<span class="type">String</span>,<span class="type">Int</span>](<span class="string">"tom"</span>,<span class="number">12</span>);    <span class="comment">// åˆ›å»ºæ³›å‹å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">val</span> p = <span class="keyword">new</span> <span class="type">Pair</span>(<span class="string">"tom"</span>,<span class="number">12</span>);                <span class="comment">//ç±»å‹æ¨æ–­</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹æ³•æ³›å‹</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMiddle</span></span>[<span class="type">T</span>](arr:<span class="type">Array</span>[<span class="type">T</span>]) = arr(arr.length / <span class="number">2</span>);</span><br><span class="line">-&gt; å¯ä»¥ä¼ å…¥ä»»æ„ç±»å‹çš„ <span class="type">Array</span></span><br><span class="line"></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line"><span class="comment">//æ³›å‹çš„ä¸Šç•Œ,Tå¿…é¡»æ˜¯Dogçš„å­ç±»ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span></span>[<span class="type">T</span> &lt;: <span class="type">Dog</span>](d:<span class="type">T</span>) = println(<span class="string">"hello"</span>)</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸‹ç•Œ,Tå¿…é¡»æ˜¯shapiçš„çˆ¶ç±»ã€‚æœ‰é—®é¢˜: æµ‹è¯•æ˜¯é€šé…çš„, ä¼ å•¥éƒ½å¯ä»¥ :TODO</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run2</span></span>[<span class="type">T</span> &gt;: <span class="type">Shapi</span>](d:<span class="type">T</span>) = println(<span class="string">"hello"</span>)  </span><br><span class="line"></span><br><span class="line">    &lt;:            <span class="comment">//ä¸Šç•Œï¼Œå­ç±»</span></span><br><span class="line">    &gt;:            <span class="comment">//ä¸‹ç•Œï¼Œçˆ¶ç±» ???</span></span><br><span class="line">    &lt;%            <span class="comment">// A &lt;% B,Aèƒ½å¤Ÿéšå¼è½¬æ¢æˆB</span></span><br><span class="line"><span class="type">T</span> &lt;:<span class="type">Dog</span> &gt;:<span class="type">Cat</span>        <span class="comment">//çº¦æŸå¤šä¸ªæ¡ä»¶ã€‚</span></span><br></pre></td></tr></table></figure><h4 id="2-æ³›å‹çš„å‹å˜-TODO-ä¸æ‡‚"><a href="#2-æ³›å‹çš„å‹å˜-TODO-ä¸æ‡‚" class="headerlink" title="2. æ³›å‹çš„å‹å˜ :TODO ä¸æ‡‚"></a>2. æ³›å‹çš„å‹å˜ :TODO ä¸æ‡‚</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Friend</span>[+<span class="type">Dog</span>]            <span class="comment">//å‹å˜</span></span><br><span class="line"><span class="type">Friend</span>[-<span class="type">Dog</span>]            <span class="comment">//é€†å˜</span></span><br><span class="line"></span><br><span class="line"><span class="type">Friend</span>[-<span class="type">Dog</span>]    <span class="comment">// å½“é‡‡ç”¨ -å· çº¦æŸæ—¶, åŸæœ¬ Friend[NafangShapi] ä¸º   Friend[Shapi] çš„å­ç±»çš„, ç°åœ¨å˜æˆçˆ¶ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="type">Friend</span>[<span class="type">Shapi</span>]</span><br><span class="line"><span class="type">Friend</span>[<span class="type">NafangShapi</span>]</span><br></pre></td></tr></table></figure><hr><h1 id="åä¸ƒ-éšå¼è½¬æ¢-implicit"><a href="#åä¸ƒ-éšå¼è½¬æ¢-implicit" class="headerlink" title="åä¸ƒ. éšå¼è½¬æ¢ implicit"></a>åä¸ƒ. éšå¼è½¬æ¢ <strong>implicit</strong></h1><pre><code>éšå¼è½¬æ¢å‡½æ•°:ä½¿ç”¨ **implicit** ä¿®é¥°çš„å…·æœ‰ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ã€‚ </code></pre><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰éšå¼è½¬æ¢å‡½æ•°</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line">   <span class="comment">// å®šä¹‰äº†ä¹‹å, è°ƒç”¨ run(100) , æ­¤100ä¼šè‡ªåŠ¨éšå¼çš„è½¬ä¸º dog å¯¹è±¡</span></span><br><span class="line">   <span class="comment">// éœ€è¦å½“å‰ä»£ç ä¸Šä¸‹æ–‡å¯è§</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">implicit</span> <span class="function"><span class="keyword">def</span> <span class="title">int2Dog</span></span>(n:<span class="type">Int</span>) = <span class="type">Shapi</span>(n);   <span class="comment">//å®šä¹‰</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span></span>(d:<span class="type">Dog</span>) = print(<span class="string">"hello world"</span>);</span><br><span class="line"> </span><br><span class="line">    run(<span class="number">100</span>) ;      <span class="comment">//è°ƒç”¨run æ–¹æ³•, ä¼šç›´æ¥è°ƒç”¨éšå¼è½¬æ¢å‡½æ•°ã€‚ æŠŠ100ä½œä¸ºå‚æ•°, åˆ›å»º Shapi å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰éšå¼å•ä¾‹å¯¹è±¡</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line">    <span class="class"><span class="keyword">object</span> <span class="title">DogUtil</span></span>&#123;</span><br><span class="line">        <span class="comment">//å®šä¹‰éšå¼è½¬æ¢å‡½æ•°</span></span><br><span class="line">        <span class="keyword">implicit</span> <span class="function"><span class="keyword">def</span> <span class="title">str2Dog</span></span>(s:<span class="type">String</span>) = <span class="type">Jing8</span>(s) ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">--- ä½¿ç”¨</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run3</span></span>(d:<span class="type">Dog</span>) = println(<span class="string">"hello world"</span>);</span><br><span class="line">    <span class="keyword">import</span> <span class="type">DogUtil</span><span class="comment">// </span></span><br><span class="line">    run3(<span class="string">"tom"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å‚æ•°é»˜è®¤å€¼</span></span><br><span class="line">---------------------------------------------</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorate</span></span>(prefix:<span class="type">String</span> = <span class="string">"[[["</span>,c:<span class="type">String</span>,suffix:<span class="type">String</span>=<span class="string">"]]]"</span>) = ...</span><br><span class="line">    decorate(c= <span class="string">"hello world"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// éšå¼å‚æ•°(é»˜è®¤å‚æ•°)</span></span><br><span class="line">âœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœâœ</span><br><span class="line">    <span class="class"><span class="keyword">object</span> <span class="title">DogUtil2</span></span>&#123;</span><br><span class="line">        <span class="keyword">implicit</span> <span class="keyword">val</span> dog = <span class="type">Jing8</span>(<span class="string">"tomas"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">import</span> <span class="type">DogUtil2</span>._</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run4</span></span>(<span class="keyword">implicit</span> dog:<span class="type">Jing8</span>) = println(<span class="string">"hello : "</span>) ;</span><br><span class="line"></span><br><span class="line">    run4;    <span class="comment">// æ³¨æ„, å¦‚æœä¸æƒ³ä¼ å‚æ•°, æƒ³è¦è°ƒç”¨éšå¼çš„é»˜è®¤å€¼, åé¢ä¸éœ€è¦åŠ  (). æˆ–è€…é‡Œé¢ä¼  null, run4(null)</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ä¸€-æ¦‚è§ˆ&quot;&gt;&lt;a href=&quot;#ä¸€-æ¦‚è§ˆ&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. æ¦‚è§ˆ&quot;&gt;&lt;/a&gt;ä¸€. &lt;strong&gt;æ¦‚è§ˆ&lt;/strong&gt;&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;scala&lt;/strong&gt; : javaè¯­è¨€çš„è„šæœ¬åŒ–ã€‚       
      
    
    </summary>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/categories/Hadoop/"/>
    
      <category term="Scala" scheme="https://airpoet.github.io/categories/Hadoop/Scala/"/>
    
    
      <category term="åŸåˆ›" scheme="https://airpoet.github.io/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/tags/Hadoop/"/>
    
      <category term="Scala" scheme="https://airpoet.github.io/tags/Scala/"/>
    
  </entry>
  
  <entry>
    <title>æ•°æ®ç»“æ„ &amp; ç®—æ³•</title>
    <link href="https://airpoet.github.io/2018/07/11/Hadoop/10_%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84&amp;%E7%AE%97%E6%B3%95/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-&amp;-%E7%AE%97%E6%B3%95/"/>
    <id>https://airpoet.github.io/2018/07/11/Hadoop/10_æ•°æ®ç»“æ„&amp;ç®—æ³•/æ•°æ®ç»“æ„-&amp;-ç®—æ³•/</id>
    <published>2018-07-11T15:21:45.174Z</published>
    <updated>2018-07-11T16:20:12.824Z</updated>
    
    <content type="html"><![CDATA[<p><br></p><h2 id="å‚è€ƒ-PDF-æ–‡æ¡£"><a href="#å‚è€ƒ-PDF-æ–‡æ¡£" class="headerlink" title="å‚è€ƒ PDF æ–‡æ¡£"></a>å‚è€ƒ PDF æ–‡æ¡£</h2><p><a href="https://app.yinxiang.com/shard/s37/nl/7399077/02c256fa-61c7-4ffb-b956-5159389373a0/" target="_blank" rel="noopener">æ•°æ®ç»“æ„å‚è€ƒPDF</a></p><p><a href="https://app.yinxiang.com/shard/s37/nl/7399077/2a72211a-8ead-4e30-989f-256b7f15bc83/" target="_blank" rel="noopener">ç®—æ³•åŸºç¡€å‚è€ƒPDF</a></p><p><br></p><h2 id="å‚è€ƒå¤§ç‰›ç¬”è®°"><a href="#å‚è€ƒå¤§ç‰›ç¬”è®°" class="headerlink" title="å‚è€ƒå¤§ç‰›ç¬”è®°"></a>å‚è€ƒå¤§ç‰›ç¬”è®°</h2><p><a href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E7%AE%97%E6%B3%95/">ç®—æ³•ç»¼è¿°åŠä»£ç å®ç°</a></p><p><a href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/Leetcode%20%E9%A2%98%E8%A7%A3/">Leetcodeè§£é¢˜</a></p><p><a href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E5%89%91%E6%8C%87%20offer%20%E9%A2%98%E8%A7%A3/">å‰‘æŒ‡ Offer è§£é¢˜</a></p><p>å…¶å®ƒçš„è‡ªè¡ŒæŸ¥çœ‹</p><p><br></p><h2 id="å‚è€ƒè‡ªå·±ä»£ç "><a href="#å‚è€ƒè‡ªå·±ä»£ç " class="headerlink" title="å‚è€ƒè‡ªå·±ä»£ç "></a>å‚è€ƒè‡ªå·±ä»£ç </h2><p><a href="https://github.com/airpoet/bigdata/tree/master/Arithmetic_Project" target="_blank" rel="noopener">mygithub</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;h2 id=&quot;å‚è€ƒ-PDF-æ–‡æ¡£&quot;&gt;&lt;a href=&quot;#å‚è€ƒ-PDF-æ–‡æ¡£&quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒ PDF æ–‡æ¡£&quot;&gt;&lt;/a&gt;å‚è€ƒ PDF æ–‡æ¡£&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://app.yinxiang.
      
    
    </summary>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/categories/Hadoop/"/>
    
      <category term="æ•°æ®ç»“æ„&amp;ç®—æ³•" scheme="https://airpoet.github.io/categories/Hadoop/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="åŸåˆ›" scheme="https://airpoet.github.io/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/tags/Hadoop/"/>
    
      <category term="æ•°æ®ç»“æ„" scheme="https://airpoet.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="ç®—æ³•" scheme="https://airpoet.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Python &amp; ç®€å•çˆ¬è™«</title>
    <link href="https://airpoet.github.io/2018/07/11/Hadoop/9_Python&amp;%E7%88%AC%E8%99%AB/Python-&amp;-%E7%AE%80%E5%8D%95%E7%88%AC%E8%99%AB/"/>
    <id>https://airpoet.github.io/2018/07/11/Hadoop/9_Python&amp;çˆ¬è™«/Python-&amp;-ç®€å•çˆ¬è™«/</id>
    <published>2018-07-11T15:16:45.209Z</published>
    <updated>2018-07-11T15:20:43.858Z</updated>
    
    <content type="html"><![CDATA[<p><br></p><p><a href="https://github.com/airpoet/bigdata/tree/master/Python_Project" target="_blank" rel="noopener">å…·ä½“ä»£ç è§æˆ‘çš„github</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/airpoet/bigdata/tree/master/Python_Project&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å…·ä½“ä»£ç è§æˆ‘çš„github&lt;/a&gt;&lt;/p&gt;

      
    
    </summary>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/categories/Hadoop/"/>
    
      <category term="Python" scheme="https://airpoet.github.io/categories/Hadoop/Python/"/>
    
    
      <category term="åŸåˆ›" scheme="https://airpoet.github.io/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Python" scheme="https://airpoet.github.io/tags/Python/"/>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/tags/Hadoop/"/>
    
      <category term="çˆ¬è™«" scheme="https://airpoet.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>i-NIO</title>
    <link href="https://airpoet.github.io/2018/07/11/Hadoop/11_NIO/NIO/"/>
    <id>https://airpoet.github.io/2018/07/11/Hadoop/11_NIO/NIO/</id>
    <published>2018-07-11T03:38:15.042Z</published>
    <updated>2018-07-12T01:03:01.212Z</updated>
    
    <content type="html"><![CDATA[<!-- GFM-TOC --><h1 id="ä¸€-åŒæ­¥-å¼‚æ­¥-amp-é˜»å¡-éé˜»å¡"><a href="#ä¸€-åŒæ­¥-å¼‚æ­¥-amp-é˜»å¡-éé˜»å¡" class="headerlink" title="ä¸€.  åŒæ­¥, å¼‚æ­¥ &amp; é˜»å¡, éé˜»å¡"></a>ä¸€.  åŒæ­¥, å¼‚æ­¥ &amp; é˜»å¡, éé˜»å¡</h1><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p><strong>åŒæ­¥å’Œå¼‚æ­¥å…¶å®æŒ‡çš„æ˜¯ï¼Œè¯·æ±‚å‘èµ·æ–¹å¯¹æ¶ˆæ¯ç»“æœçš„è·å–æ˜¯ä¸»åŠ¨å‘èµ·çš„ï¼Œè¿˜æ˜¯ç­‰è¢«åŠ¨é€šçŸ¥çš„</strong>ã€‚</p><ul><li>å¦‚æœæ˜¯è¯·æ±‚æ–¹ä¸»åŠ¨å‘èµ·çš„ï¼Œ<strong>ä¸€ç›´åœ¨ç­‰å¾…åº”ç­”ç»“æœï¼ˆåŒæ­¥é˜»å¡ï¼‰</strong></li><li>å¦‚æœæ˜¯<strong>ç»“æœç”±æœåŠ¡æ–¹é€šçŸ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯·æ±‚æ–¹å‘å‡ºè¯·æ±‚åï¼Œè¦ä¹ˆåœ¨ä¸€ç›´ç­‰å¾…é€šçŸ¥ï¼ˆå¼‚æ­¥é˜»å¡ï¼‰, è¦ä¹ˆå°±å…ˆå»å¹²è‡ªå·±çš„äº‹äº†ï¼ˆå¼‚æ­¥éé˜»å¡)</strong></li></ul><p><strong>è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ä¹‹åï¼Œåœ¨ç­‰å¾…è¿™ä¸ªå‡½æ•°è¿”å›ç»“æœä¹‹å‰ï¼Œå½“å‰çš„çº¿ç¨‹æ˜¯å¤„äºæŒ‚èµ·çŠ¶æ€ï¼Œè¿˜æ˜¯è¿è¡ŒçŠ¶æ€ï¼š</strong></p><ul><li>å¦‚æœæ˜¯æŒ‚èµ·çŠ¶æ€ï¼Œå°±æ„å‘³ç€<strong>å½“å‰çº¿ç¨‹ä»€ä¹ˆéƒ½ä¸èƒ½å¹²</strong>ï¼Œå°±ç­‰ç€è·å–ç»“æœï¼Œè¿™å°±å«<strong>åŒæ­¥é˜»å¡</strong>ï¼Œ</li><li>å¦‚æœä»ç„¶æ˜¯è¿è¡ŒçŠ¶æ€ï¼Œå°±æ„å‘³<strong>å½“å‰çº¿ç¨‹æ˜¯å¯ä»¥çš„ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œä½†è¦æ—¶ä¸æ—¶çš„å»çœ‹ä¸‹æ˜¯å¦æœ‰ç»“æœäº†ï¼Œè¿™å°±æ˜¯åŒæ­¥éé˜»å¡</strong>ã€‚</li></ul><h2 id="å½¢è±¡çš„ä¾‹å­"><a href="#å½¢è±¡çš„ä¾‹å­" class="headerlink" title="å½¢è±¡çš„ä¾‹å­"></a>å½¢è±¡çš„ä¾‹å­</h2><p>æ•…äº‹ï¼šè€ç‹çƒ§å¼€æ°´ã€‚</p><p>å‡ºåœºäººç‰©ï¼šè€ç‹ï¼Œæ°´å£¶ä¸¤æŠŠï¼ˆæ™®é€šæ°´å£¶ï¼Œç®€ç§°æ°´å£¶ï¼›ä¼šå“çš„æ°´å£¶ï¼Œç®€ç§°å“æ°´å£¶ï¼‰ã€‚</p><p>è€ç‹æƒ³äº†æƒ³ï¼Œæœ‰å¥½å‡ ç§ç­‰å¾…æ–¹å¼<br>1ã€è€ç‹ç”¨æ°´å£¶ç…®æ°´ï¼Œå¹¶ä¸”ç«™åœ¨é‚£é‡Œï¼Œä¸ç®¡æ°´å¼€æ²¡å¼€ï¼Œæ¯éš”ä¸€å®šæ—¶é—´çœ‹çœ‹æ°´å¼€äº†æ²¡    â€”â€”â€”-åŒæ­¥é˜»å¡<br>è€ç‹æƒ³äº†æƒ³ï¼Œè¿™ç§æ–¹æ³•ä¸å¤Ÿèªæ˜ã€‚</p><p>2ã€è€ç‹è¿˜æ˜¯ç”¨æ°´å£¶ç…®æ°´ï¼Œä¸å†å‚»å‚»çš„ç«™åœ¨é‚£é‡Œçœ‹æ°´å¼€ï¼Œè·‘å»å¯å®¤ä¸Šç½‘ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šæ¯éš”ä¸€æ®µæ—¶é—´è¿‡æ¥çœ‹çœ‹æ°´å¼€äº†æ²¡æœ‰ï¼Œæ°´æ²¡æœ‰å¼€å°±èµ°äººã€‚    â€”â€”â€”-åŒæ­¥éé˜»å¡<br>è€ç‹æƒ³äº†æƒ³ï¼Œç°åœ¨çš„æ–¹æ³•èªæ˜äº†äº›ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸å¤Ÿå¥½ã€‚</p><p>3ã€è€ç‹è¿™æ¬¡ä½¿ç”¨é«˜å¤§ä¸Šçš„å“æ°´å£¶æ¥ç…®æ°´ï¼Œç«™åœ¨é‚£é‡Œï¼Œä½†æ˜¯ä¸ä¼šå†æ¯éš”ä¸€æ®µæ—¶é—´å»çœ‹æ°´å¼€ï¼Œè€Œæ˜¯ç­‰æ°´å¼€äº†ï¼Œæ°´å£¶ä¼šè‡ªåŠ¨çš„é€šçŸ¥ä»–ã€‚    â€”â€”â€”-å¼‚æ­¥é˜»å¡<br>è€ç‹æƒ³äº†æƒ³ï¼Œä¸ä¼šå‘€ï¼Œæ—¢ç„¶æ°´å£¶å¯ä»¥é€šçŸ¥æˆ‘ï¼Œé‚£æˆ‘ä¸ºä»€ä¹ˆè¿˜è¦å‚»å‚»çš„ç«™åœ¨é‚£é‡Œç­‰å‘¢ï¼Œå—¯ï¼Œå¾—æ¢ä¸ªæ–¹æ³•ã€‚</p><p>4ã€è€ç‹è¿˜æ˜¯ä½¿ç”¨å“æ°´å£¶ç…®æ°´ï¼Œè·‘åˆ°å®¢å…ä¸Šç½‘å»ï¼Œç­‰ç€å“æ°´å£¶è‡ªå·±æŠŠæ°´ç…®ç†Ÿäº†ä»¥åé€šçŸ¥ä»–ã€‚    â€”â€”â€”-å¼‚æ­¥éé˜»å¡</p><p>è€ç‹è±ç„¶ï¼Œè¿™ä¸‹æ„Ÿè§‰è½»æ¾äº†å¾ˆå¤šã€‚</p><hr><h1 id="äºŒ-NIO-ä¸­ä¸€äº›é‡è¦æ¦‚å¿µ"><a href="#äºŒ-NIO-ä¸­ä¸€äº›é‡è¦æ¦‚å¿µ" class="headerlink" title="äºŒ. NIO ä¸­ä¸€äº›é‡è¦æ¦‚å¿µ"></a>äºŒ. NIO ä¸­ä¸€äº›é‡è¦æ¦‚å¿µ</h1><h2 id="Java-IO-æ¨¡å‹"><a href="#Java-IO-æ¨¡å‹" class="headerlink" title="Java IO æ¨¡å‹"></a>Java IO æ¨¡å‹</h2><p><strong>BIOâ€“åŒæ­¥é˜»å¡ï¼š</strong></p><p>JDK1.4 ä»¥å‰æˆ‘ä»¬ä½¿ç”¨çš„éƒ½æ˜¯ BIO</p><p>é˜»å¡åˆ°æˆ‘ä»¬çš„è¯»å†™æ–¹æ³•ï¼Œé˜»å¡åˆ°çº¿ç¨‹æ¥æé«˜å¹¶å‘æ€§èƒ½ï¼Œä½†æ˜¯æ•ˆæœä¸æ˜¯å¾ˆå¥½</p><p><strong>NIOâ€“åŒæ­¥éé˜»å¡ï¼š</strong>(New IO)</p><p>JDK1.4 Linux å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼ˆselect æ¨¡å¼ï¼‰å®ç° IO äº‹ä»¶çš„è½®è¯¢æ–¹å¼ï¼šåŒæ­¥ éé˜»å¡çš„æ¨¡å¼ï¼Œè¿™ç§æ–¹å¼ç›®å‰æ˜¯ä¸»æµçš„ç½‘ç»œé€šä¿¡æ¨¡å¼</p><p>Mina å’Œ Netty</p><p>â€“ ç½‘ç»œé€šä¿¡æ¡†æ¶ï¼Œæ¯”è‡ªå·±å†™ NIO è¦å®¹æ˜“äº›ï¼Œå¹¶ä¸”ä»£ç å¯è¯»æ€§æ›´å¥½</p><p><strong>AIOâ€“å¼‚æ­¥éé˜»å¡ IOï¼š</strong></p><p>JDK1.7ï¼ˆNIO2ï¼‰çœŸæ­£çš„å¼‚æ­¥éé˜»å¡ IO(åŸºäº linux çš„ epoll æ¨¡å¼ï¼‰AIO ç›® å‰ä½¿ç”¨çš„è¿˜æ¯”è¾ƒå°‘</p><h2 id="é€šé“-channel-amp-ç¼“å†²åŒº-buffer"><a href="#é€šé“-channel-amp-ç¼“å†²åŒº-buffer" class="headerlink" title="é€šé“ channel &amp; ç¼“å†²åŒº buffer"></a>é€šé“ channel &amp; ç¼“å†²åŒº buffer</h2><h4 id="1-é€šé“-channel"><a href="#1-é€šé“-channel" class="headerlink" title="1. é€šé“ channel"></a>1. é€šé“ channel</h4><p><strong>å…³é”®è¯:</strong> æ¨¡æ‹Ÿæµ,  æ‰“å¼€çš„è¿æ¥, åŒå‘å¯è¯»å†™, çº¿ç¨‹å®‰å…¨,  åªèƒ½é€šè¿‡ç¼“å†²åŒºæ“ä½œ</p><p><strong>ç±»å‹</strong></p><ul><li>FileChannelï¼šä»æ–‡ä»¶ä¸­è¯»å†™æ•°æ®ï¼›</li><li>DatagramChannelï¼šé€šè¿‡ UDP è¯»å†™ç½‘ç»œä¸­æ•°æ®ï¼›</li><li><strong>SocketChannel</strong>ï¼šé€šè¿‡ TCP è¯»å†™ç½‘ç»œä¸­æ•°æ®ï¼›</li><li><strong>ServerSocketChannel</strong>ï¼šå¯ä»¥ç›‘å¬æ–°è¿›æ¥çš„ TCP è¿æ¥ï¼Œå¯¹æ¯ä¸€ä¸ªæ–°è¿›æ¥çš„è¿æ¥éƒ½ä¼šåˆ›å»ºä¸€ä¸ª SocketChannelã€‚</li></ul><h4 id="2-ç¼“å†²åŒº-buffer"><a href="#2-ç¼“å†²åŒº-buffer" class="headerlink" title="2. ç¼“å†²åŒº buffer"></a>2. ç¼“å†²åŒº buffer</h4><p>ä¸èƒ½ç›´æ¥å¯¹é€šé“è¿›è¡Œè¯»å†™æ•°æ®ï¼Œè€Œæ˜¯è¦å…ˆç»è¿‡ç¼“å†²åŒºã€‚</p><p>ç¼“å†²åŒºå®è´¨ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„, æä¾›äº†å¯¹æ•°æ®çš„ç»“æ„åŒ–è®¿é—®ã€‚</p><p><strong>ç±»å‹:</strong> </p><ul><li><strong>ByteBuffer</strong></li><li>CharBuffer</li><li>ShortBuffer</li><li>IntBuffer</li><li>LongBuffer</li><li>FloatBuffer</li><li>DoubleBuffer</li></ul><p><strong>å…³é”®è¯:</strong> </p><ul><li>capacityï¼šæœ€å¤§å®¹é‡ï¼›</li><li>positionï¼šå½“å‰å·²ç»è¯»å†™çš„å­—èŠ‚æ•°ï¼›</li><li>limitï¼šè¿˜å¯ä»¥è¯»å†™çš„å­—èŠ‚æ•°ã€‚</li></ul><p><a href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/Java%20IO/#%E4%B8%83nio">å…¶å®ƒè¯¦æƒ…å¯è§ Java IO</a> </p><hr><h1 id="ä¸‰-ä»£ç å®ä¾‹"><a href="#ä¸‰-ä»£ç å®ä¾‹" class="headerlink" title="ä¸‰. ä»£ç å®ä¾‹"></a>ä¸‰. ä»£ç å®ä¾‹</h1><h2 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rox.nio;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetSocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.nio.channels.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ³¨æ„: selectoræŒ‘é€‰å™¨, ç»´æŠ¤è‹¥å¹²é›†åˆ</span></span><br><span class="line"><span class="comment"> * selectionKeys : æ³¨å†Œçš„key</span></span><br><span class="line"><span class="comment"> * selectedKeys  : æŒ‘é€‰å‡ºæ¥çš„key -- æœ‰äº‹ä»¶çš„ key</span></span><br><span class="line"><span class="comment"> * å®¢æˆ·ç«¯ &amp; æœåŠ¡ç«¯å¯¹åº”çš„å®¢æˆ·ç«¯ SocketChannel(å¥—æ¥å­—é€šé“), ä¸€èˆ¬æ¥è®², åªéœ€è¦å¯¹ read æ„Ÿå…´è¶£</span></span><br><span class="line"><span class="comment"> * ä¹Ÿå°±æ˜¯æ‹¦æˆª read æ¶ˆæ¯, write çš„è¯éšæ—¶éƒ½å¯ä»¥ write</span></span><br><span class="line"><span class="comment"> * sc æ˜¯å¯è¯»å¯å†™çš„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ†é…ç¼“å†²åŒºbufå†…å­˜</span></span><br><span class="line">        ByteBuffer buf = ByteBuffer.allocate(<span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¼€å¯æŒ‘é€‰å™¨</span></span><br><span class="line">        Selector sel = Selector.open();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¼€å¯ ServerSocket é€šé“</span></span><br><span class="line">        ServerSocketChannel ssc = ServerSocketChannel.open();</span><br><span class="line">        <span class="comment">// ç»‘å®šç«¯å£</span></span><br><span class="line">        ssc.socket().bind(<span class="keyword">new</span> InetSocketAddress(<span class="string">"localhost"</span>, <span class="number">8888</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®éé˜»å¡</span></span><br><span class="line">        ssc.configureBlocking(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">           <span class="comment">// åœ¨æŒ‘é€‰å™¨ä¸­æ³¨å†Œé€šé“(æœåŠ¡å™¨é€šé“, å’Œæ„Ÿå…´è¶£çš„äº‹ä»¶ - OP_ACCEPT)</span></span><br><span class="line">        ssc.register(sel, SelectionKey.OP_ACCEPT);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–å¯é€‰æ‹©é€šé“å¯¹è±¡(ä¸º ServerSocketChannel &amp; SocketChannel çš„å…±åŒçˆ¶ç±»)</span></span><br><span class="line">        SelectableChannel sc = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">// æŒ‘é€‰å™¨å¼€å§‹é€‰æ‹©(é˜»å¡çš„)</span></span><br><span class="line">            <span class="comment">// å¦‚æœä¹ˆæœ‰æ¥æ”¶åˆ° æ„Ÿå…´è¶£äº‹ä»¶, å°±å¡åœ¨è¿™é‡Œ</span></span><br><span class="line">            sel.select();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// èƒ½èµ°åˆ°è¿™ä¸€æ­¥, å°±æ˜¯å·²ç»æ¥æ”¶åˆ°äº† accept äº‹ä»¶</span></span><br><span class="line">            <span class="comment">// è¿­ä»£æŒ‘é€‰å‡ºæ¥çš„ key çš„é›†åˆ</span></span><br><span class="line">            Iterator&lt;SelectionKey&gt; it = sel.selectedKeys().iterator();</span><br><span class="line">            <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">                SelectionKey key = it.next();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœæ³¨å†Œçš„ keyæ˜¯å¯æ¥å—çš„, å°±ä¸€å®šæ˜¯æœåŠ¡å™¨é€šé“</span></span><br><span class="line">                    <span class="keyword">if</span> (key.isAcceptable()) &#123;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// å–å‡ºè¯¥é€šé“, è¿”å›ä¸€ä¸ª SelectableChannel çš„è¶…ç±»å¯¹è±¡</span></span><br><span class="line">                        sc = key.channel();</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// å› ä¸ºæ‹¿åˆ°çš„ key æ˜¯ isAcceptable, æ‰€ä»¥å¯ä»¥åˆ¤æ–­æ˜¯ ssc å¯¹è±¡, å¼ºè½¬</span></span><br><span class="line">                        <span class="comment">// å¹¶é€šè¿‡ accept()æ–¹æ³•, è¿”å›ä¸€ä¸ª sc å¯¹è±¡(ç±»ä¼¼äºå¥—æ¥å­—, ä¸å®¢æˆ·ç«¯çš„ sc å¯¹åº”, è´Ÿè´£è·Ÿå®¢æˆ·ç«¯çš„ sc é€šä¿¡)</span></span><br><span class="line">                        SocketChannel sc0 = ((ServerSocketChannel) sc).accept();</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// è®¾ç½® sc0 ä¸ºéé˜»å¡</span></span><br><span class="line">                        sc0.configureBlocking(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// ä¸ºæ¥æ”¶åˆ°çš„è¿™ä¸ª sc åœ¨é€‰æ‹©å™¨ä¸­, æ³¨å†Œè¯»äº‹ä»¶</span></span><br><span class="line">                        sc0.register(sel, SelectionKey.OP_READ);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// ä¸‹ä¸€æ¬¡è½®è¯¢, å‘ç°æ˜¯æ¥è‡ª è¯»äº‹ä»¶ çš„key</span></span><br><span class="line">                    <span class="keyword">if</span> (key.isReadable()) &#123;</span><br><span class="line">                        <span class="comment">// å–å‡º channel, ç›´æ¥å¼ºè½¬ä¸º SocketChannel</span></span><br><span class="line">                        SocketChannel sc1 = (SocketChannel) key.channel();</span><br><span class="line"></span><br><span class="line">                        <span class="comment">/// å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯, å‰é¢åŠ ä¸ªå¤´'hello', ç„¶åå†å†™å›å»</span></span><br><span class="line">                        <span class="comment">// åˆ›å»ºæ¶ˆæ¯å­—èŠ‚æ•°ç»„</span></span><br><span class="line">                        <span class="keyword">byte</span>[] helloBytes = <span class="string">"hello: "</span>.getBytes();</span><br><span class="line">                        <span class="comment">// æŠŠå­—èŠ‚æ•°ç»„æ”¾å…¥ buf</span></span><br><span class="line">                        buf.put(helloBytes, <span class="number">0</span>, helloBytes.length);</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// è¯»å–æ¶ˆæ¯</span></span><br><span class="line">                        <span class="comment">// ä¸å­˜åœ¨è¯»å®Œ, åªè¦ä¸ä¸º0, å°±ä¸€ç›´è½®è¯¢è¯»</span></span><br><span class="line">                        <span class="comment">// ä»é€šé“é‡Œè¯»å‡ºæ¥,æ”¾åˆ°ç¼“å†²åŒºé‡Œ</span></span><br><span class="line">                        <span class="keyword">while</span> (sc1.read(buf) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="comment">// æ‹æ¿, å®šç¨¿, &gt; 0è¯´æ˜æœ‰æ•°æ®</span></span><br><span class="line">                            <span class="comment">// position å½’0, limit ç½®åœ¨ å·²å†™å…ƒç´  çš„åé¢ä¸€æ ¼, æ­¤æ—¶ä¸æ¥å—å…¶å®ƒå†™å…¥äº†</span></span><br><span class="line">                            buf.flip();</span><br><span class="line">                            <span class="comment">// æŒæœ‰çš„ sc å¯¹è±¡å†™å…¥åˆ°channel</span></span><br><span class="line">                            sc1.write(buf);</span><br><span class="line">                            <span class="comment">// å†™å®Œå æ¸…ç©º, position å½’0, limit æœ€å¤§</span></span><br><span class="line">                            buf.clear();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœå¤±è´¥, ç§»é™¤æœ¬æ¬¡æ¥æ”¶åˆ°çš„ keys</span></span><br><span class="line">                    sel.keys().remove(key);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æœ¬æ¬¡é€‰æ‹©å™¨äº‹ä»¶å¤„ç†å®Œäº†ä¹‹å</span></span><br><span class="line">            <span class="comment">// ç§»é™¤æ‰€æœ‰é€‰æ‹©å‡ºæ¥çš„ key</span></span><br><span class="line">            sel.selectedKeys().clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rox.nio;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetSocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.net.SocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.nio.channels.SelectionKey;</span><br><span class="line"><span class="keyword">import</span> java.nio.channels.Selector;</span><br><span class="line"><span class="keyword">import</span> java.nio.channels.SocketChannel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// buf</span></span><br><span class="line">        ByteBuffer buf = ByteBuffer.allocate(<span class="number">1024</span> * <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¼€ä¸€ä¸ª selector</span></span><br><span class="line">        Selector sel = Selector.open();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¼€ä¸€ä¸ªå¥—æ¥å­—é€šé“</span></span><br><span class="line">        SocketChannel sc = SocketChannel.open();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸‹é¢2ç§è¿æ¥æ²¡åŒºåˆ«</span></span><br><span class="line">        sc.socket().connect(<span class="keyword">new</span> InetSocketAddress(<span class="string">"localhost"</span>, <span class="number">8888</span>));</span><br><span class="line"><span class="comment">//        sc.connect(new InetSocketAddress("localhost", 8888));</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// é…ç½®æ˜¯å¦é˜»å¡</span></span><br><span class="line">        sc.configureBlocking(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨å†Œ sel å¯¹è±¡åŠ å…³æ³¨çš„ key</span></span><br><span class="line">        sc.register(sel, SelectionKey.OP_READ);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¾€ buf ä¸­ put è¿›æ•°æ®(ä¸€æ¬¡)</span></span><br><span class="line"><span class="comment">//        buf.put("tom".getBytes());</span></span><br><span class="line"><span class="comment">//        buf.flip();</span></span><br><span class="line"><span class="comment">//        sc.write(buf);</span></span><br><span class="line"><span class="comment">//        buf.clear();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæƒ³è¦æŒç»­ä¸æ–­çš„é€šä¿¡, å¯ä»¥å¼€ä¸ªåˆ†çº¿ç¨‹ (æŒç»­æ”¶å‘æ¶ˆæ¯)</span></span><br><span class="line">        <span class="comment">// ç¨‹åºæ˜¯ä»ä¸Šå¾€ä¸‹è¿è¡Œçš„, è¿è¡Œåˆ°ä¸‹é¢æ²¡æœ‰æ¥å—åˆ°æ¶ˆæ¯çš„è¯ä¼šå¡ä½</span></span><br><span class="line">        <span class="comment">// ä¸€æ—¦å¡ä½äº†, ä¹Ÿå°±æ— æ³•ç»§ç»­åŒæœåŠ¡ç«¯é€šä¿¡äº†</span></span><br><span class="line">        <span class="keyword">new</span> Thread()&#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">int</span> i = <span class="number">0</span> ;</span><br><span class="line">                <span class="comment">// è¿™é‡Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç¼“å†²åŒºä¸“ç”¨</span></span><br><span class="line">                ByteBuffer buf2 = ByteBuffer.allocate(<span class="number">1024</span> * <span class="number">8</span>);</span><br><span class="line">                <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        buf2.put((<span class="string">"Tom"</span> +  (i ++)).getBytes());</span><br><span class="line">                        buf2.flip();   <span class="comment">//åˆ‡æ¢è¯»å†™</span></span><br><span class="line">                        sc.write(buf2);</span><br><span class="line">                        buf2.clear();</span><br><span class="line">                        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">// é€‰æ‹©å™¨é€‰æ‹©, æ¥å— æœåŠ¡ç«¯è¿”å›çš„ key</span></span><br><span class="line">            sel.select();</span><br><span class="line"></span><br><span class="line">            ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä»é€šé“è¯»å–åˆ°ç¼“å†²åŒº</span></span><br><span class="line">            <span class="keyword">while</span> (sc.read(buf) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// è¯»åˆ°äº†æ•°æ®, å°±æ‹ä¸€ä¸‹æ¿</span></span><br><span class="line">                buf.flip();</span><br><span class="line">                <span class="comment">// ä»ç¼“å†²åŒº buf å†™å…¥åˆ° ByteArrayOutputStream æµ</span></span><br><span class="line">                baos.write(buf.array(), <span class="number">0</span>, buf.limit());</span><br><span class="line">                <span class="comment">// å†™å®Œäº†å°±æ¸…ç©º ç¼“å†²åŒºbuf</span></span><br><span class="line">                buf.clear();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ‰“å°æ¥å—åˆ°çš„æ•°æ®</span></span><br><span class="line">            System.out.println(<span class="keyword">new</span> String(baos.toByteArray()));</span><br><span class="line">            baos.close();</span><br><span class="line">            <span class="comment">// æ¸…ç©º selectedKeysçš„ set</span></span><br><span class="line">            sel.selectedKeys().clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å…¶å®ƒçš„ä»£ç å‚è€ƒæˆ‘çš„-Github"><a href="#å…¶å®ƒçš„ä»£ç å‚è€ƒæˆ‘çš„-Github" class="headerlink" title="å…¶å®ƒçš„ä»£ç å‚è€ƒæˆ‘çš„ Github"></a>å…¶å®ƒçš„ä»£ç å‚è€ƒæˆ‘çš„ Github</h2><p><a href="https://github.com/airpoet/bigdata/tree/master/Java_Project/NIO" target="_blank" rel="noopener">mygithub</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- GFM-TOC --&gt;
&lt;h1 id=&quot;ä¸€-åŒæ­¥-å¼‚æ­¥-amp-é˜»å¡-éé˜»å¡&quot;&gt;&lt;a href=&quot;#ä¸€-åŒæ­¥-å¼‚æ­¥-amp-é˜»å¡-éé˜»å¡&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.  åŒæ­¥, å¼‚æ­¥ &amp;amp; é˜»å¡, éé˜»å¡&quot;&gt;&lt;/a&gt;ä¸€.  åŒæ­¥, å¼‚
      
    
    </summary>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/categories/Hadoop/"/>
    
      <category term="NIO" scheme="https://airpoet.github.io/categories/Hadoop/NIO/"/>
    
    
      <category term="åŸåˆ›" scheme="https://airpoet.github.io/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/tags/Hadoop/"/>
    
      <category term="NIO" scheme="https://airpoet.github.io/tags/NIO/"/>
    
  </entry>
  
  <entry>
    <title>newObject</title>
    <link href="https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/newObject/"/>
    <id>https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/newObject/</id>
    <published>2018-07-09T03:26:48.528Z</published>
    <updated>2018-07-09T07:22:23.926Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¯¹è±¡çš„åˆ›å»ºä¸å†…å­˜åˆ†é…"><a href="#å¯¹è±¡çš„åˆ›å»ºä¸å†…å­˜åˆ†é…" class="headerlink" title="å¯¹è±¡çš„åˆ›å»ºä¸å†…å­˜åˆ†é…"></a>å¯¹è±¡çš„åˆ›å»ºä¸å†…å­˜åˆ†é…</h1><h2 id="åˆ›å»ºå¯¹è±¡"><a href="#åˆ›å»ºå¯¹è±¡" class="headerlink" title="åˆ›å»ºå¯¹è±¡"></a>åˆ›å»ºå¯¹è±¡</h2><p>å½“ <code>JVM</code> æ”¶åˆ°ä¸€ä¸ª <code>new</code> æŒ‡ä»¤æ—¶ï¼Œä¼šæ£€æŸ¥æŒ‡ä»¤ä¸­çš„å‚æ•°åœ¨å¸¸é‡æ± æ˜¯å¦æœ‰è¿™ä¸ªç¬¦å·çš„å¼•ç”¨ï¼Œè¿˜ä¼šæ£€æŸ¥è¯¥ç±»æ˜¯å¦å·²ç»è¢«<a href="https://github.com/crossoverJie/Java-Interview/blob/master/MD/ClassLoad.md" target="_blank" rel="noopener">åŠ è½½</a>è¿‡äº†ï¼Œå¦‚æœæ²¡æœ‰çš„è¯åˆ™è¦è¿›è¡Œä¸€æ¬¡ç±»åŠ è½½ã€‚</p><p>æ¥ç€å°±æ˜¯åˆ†é…å†…å­˜äº†ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>æŒ‡é’ˆç¢°æ’</li><li>ç©ºé—²åˆ—è¡¨</li></ul><p>ä½¿ç”¨æŒ‡é’ˆç¢°æ’çš„å‰ææ˜¯å †å†…å­˜æ˜¯<strong>å®Œå…¨å·¥æ•´</strong>çš„ï¼Œç”¨è¿‡çš„å†…å­˜å’Œæ²¡ç”¨çš„å†…å­˜å„åœ¨ä¸€è¾¹æ¯æ¬¡åˆ†é…çš„æ—¶å€™åªéœ€è¦å°†æŒ‡é’ˆå‘ç©ºé—²å†…å­˜ä¸€æ–¹ç§»åŠ¨ä¸€æ®µå’Œå†…å­˜å¤§å°ç›¸ç­‰åŒºåŸŸå³å¯ã€‚</p><p>å½“å †ä¸­å·²ç»ä½¿ç”¨çš„å†…å­˜å’Œæœªä½¿ç”¨çš„å†…å­˜<strong>äº’ç›¸äº¤é”™</strong>æ—¶ï¼ŒæŒ‡é’ˆç¢°æ’çš„æ–¹å¼å°±è¡Œä¸é€šäº†ï¼Œè¿™æ—¶å°±éœ€è¦é‡‡ç”¨ç©ºé—²åˆ—è¡¨çš„æ–¹å¼ã€‚è™šæ‹Ÿæœºä¼šç»´æŠ¤ä¸€ä¸ªç©ºé—²çš„åˆ—è¡¨ï¼Œç”¨äºè®°å½•å“ªäº›å†…å­˜æ˜¯å¯ä»¥è¿›è¡Œåˆ†é…çš„ï¼Œåˆ†é…æ—¶ç›´æ¥ä»å¯ç”¨å†…å­˜ä¸­ç›´æ¥åˆ†é…å³å¯ã€‚</p><p>å †ä¸­çš„å†…å­˜æ˜¯å¦å·¥æ•´æ˜¯æœ‰<strong>åƒåœ¾æ”¶é›†å™¨</strong>æ¥å†³å®šçš„ï¼Œå¦‚æœå¸¦æœ‰å‹ç¼©åŠŸèƒ½çš„åƒåœ¾æ”¶é›†å™¨å°±æ˜¯é‡‡ç”¨æŒ‡é’ˆç¢°æ’çš„æ–¹å¼æ¥è¿›è¡Œå†…å­˜åˆ†é…çš„ã€‚</p><p>åˆ†é…å†…å­˜æ—¶ä¹Ÿä¼šå‡ºç°å¹¶å‘é—®é¢˜:</p><p>è¿™æ ·å¯ä»¥åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ä½¿ç”¨ <code>CAS</code> è¿™æ ·çš„ä¹è§‚é”æ¥ä¿è¯ã€‚</p><p>ä¹Ÿå¯ä»¥å°†å†…å­˜åˆ†é…å®‰æ’åœ¨æ¯ä¸ªçº¿ç¨‹ç‹¬æœ‰çš„ç©ºé—´è¿›è¡Œï¼Œæ¯ä¸ªçº¿ç¨‹é¦–å…ˆåœ¨å †å†…å­˜ä¸­åˆ†é…ä¸€å°å—å†…å­˜ï¼Œç§°ä¸ºæœ¬åœ°åˆ†é…ç¼“å­˜(<code>TLAB : Thread Local Allocation Buffer</code>)ã€‚</p><p>åˆ†é…å†…å­˜æ—¶ï¼Œåªéœ€è¦åœ¨è‡ªå·±çš„åˆ†é…ç¼“å­˜ä¸­åˆ†é…å³å¯ï¼Œç”±äºè¿™ä¸ªå†…å­˜åŒºåŸŸæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°å¹¶å‘é—®é¢˜ã€‚</p><p>å¯ä»¥ä½¿ç”¨ <code>-XX:+/-UseTLAB</code> å‚æ•°æ¥è®¾å®š <code>JVM</code> æ˜¯å¦å¼€å¯ <code>TLAB</code> ã€‚</p><p>å†…å­˜åˆ†é…ä¹‹åéœ€è¦å¯¹è¯¥å¯¹è±¡è¿›è¡Œè®¾ç½®ï¼Œå¦‚å¯¹è±¡å¤´ã€‚å¯¹è±¡å¤´çš„ä¸€äº›åº”ç”¨å¯ä»¥æŸ¥çœ‹ <a href="https://github.com/crossoverJie/Java-Interview/blob/master/MD/Synchronize.md" target="_blank" rel="noopener">Synchronize å…³é”®å­—åŸç†</a>ã€‚</p><h3 id="å¯¹è±¡è®¿é—®"><a href="#å¯¹è±¡è®¿é—®" class="headerlink" title="å¯¹è±¡è®¿é—®"></a>å¯¹è±¡è®¿é—®</h3><p>ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºä¹‹åè‡ªç„¶æ˜¯ä¸ºäº†ä½¿ç”¨ï¼Œåœ¨ <code>Java</code> ä¸­æ˜¯é€šè¿‡æ ˆæ¥å¼•ç”¨å †å†…å­˜ä¸­çš„å¯¹è±¡æ¥è¿›è¡Œæ“ä½œçš„ã€‚</p><p>å¯¹äºæˆ‘ä»¬å¸¸ç”¨çš„ <code>HotSpot</code> è™šæ‹Ÿæœºæ¥è¯´ï¼Œè¿™æ ·å¼•ç”¨å…³ç³»æ˜¯é€šè¿‡ç›´æ¥æŒ‡é’ˆæ¥å…³è”çš„ã€‚</p><p>å¦‚å›¾:</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcly1fnkmy0bvu3j30o60heaaq.jpg" alt=""></p><p>è¿™æ ·çš„å¥½å¤„å°±æ˜¯ï¼šåœ¨ Java é‡Œè¿›è¡Œé¢‘ç¹çš„å¯¹è±¡è®¿é—®å¯ä»¥æå‡è®¿é—®é€Ÿåº¦(ç›¸å¯¹äºä½¿ç”¨å¥æŸ„æ± æ¥è¯´)ã€‚</p><h2 id="å†…å­˜åˆ†é…"><a href="#å†…å­˜åˆ†é…" class="headerlink" title="å†…å­˜åˆ†é…"></a>å†…å­˜åˆ†é…</h2><h3 id="Eden-åŒºåˆ†é…"><a href="#Eden-åŒºåˆ†é…" class="headerlink" title="Eden åŒºåˆ†é…"></a>Eden åŒºåˆ†é…</h3><p>ç®€å•çš„æ¥è¯´å¯¹è±¡éƒ½æ˜¯åœ¨å †å†…å­˜ä¸­åˆ†é…çš„ï¼Œå¾€ç»†ä¸€ç‚¹çœ‹åˆ™æ˜¯ä¼˜å…ˆåœ¨ <code>Eden</code> åŒºåˆ†é…ã€‚</p><p>è¿™é‡Œå°±æ¶‰åŠåˆ°å †å†…å­˜çš„åˆ’åˆ†äº†ï¼Œä¸ºäº†æ–¹ä¾¿åƒåœ¾å›æ”¶ï¼ŒJVM å°†å †å†…å­˜åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚</p><p>è€Œæ–°ç”Ÿä»£ä¸­åˆä¼šåˆ’åˆ†ä¸º <code>Eden</code> åŒºï¼Œ<code>from Survivorã€to Survivor</code> åŒºã€‚</p><p>å…¶ä¸­ <code>Eden</code> å’Œ <code>Survivor</code> åŒºçš„æ¯”ä¾‹é»˜è®¤æ˜¯ <code>8:1:1</code>ï¼Œå½“ç„¶ä¹Ÿæ”¯æŒå‚æ•°è°ƒæ•´ <code>-XX:SurvivorRatio=8</code>ã€‚</p><p>å½“åœ¨ <code>Eden</code> åŒºåˆ†é…å†…å­˜ä¸è¶³æ—¶ï¼Œåˆ™ä¼šå‘ç”Ÿ <code>minorGC</code> ï¼Œç”±äº <code>Java</code> å¯¹è±¡å¤šæ•°æ˜¯<strong>æœç”Ÿå¤•ç­</strong>çš„ç‰¹æ€§ï¼Œæ‰€ä»¥ <code>minorGC</code> é€šå¸¸ä¼šæ¯”è¾ƒé¢‘ç¹ï¼Œæ•ˆç‡ä¹Ÿæ¯”è¾ƒé«˜ã€‚</p><p>å½“å‘ç”Ÿ <code>minorGC</code> æ—¶ï¼ŒJVM ä¼šæ ¹æ®<a href="https://github.com/crossoverJie/Java-Interview/blob/master/MD/GarbageCollection.md#%E5%A4%8D%E5%88%B6%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">å¤åˆ¶ç®—æ³•</a>å°†å­˜æ´»çš„å¯¹è±¡æ‹·è´åˆ°å¦ä¸€ä¸ªæœªä½¿ç”¨çš„ <code>Survivor</code> åŒºï¼Œå¦‚æœ <code>Survivor</code> åŒºå†…å­˜ä¸è¶³æ—¶ï¼Œåˆ™ä¼šä½¿ç”¨åˆ†é…æ‹…ä¿ç­–ç•¥å°†å¯¹è±¡ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚</p><p>è°ˆåˆ° <code>minorGC</code> æ—¶ï¼Œå°±ä¸å¾—ä¸æåˆ° <code>fullGC(majorGC)</code> ï¼Œè¿™æ˜¯æŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„ <code>GC</code> ï¼Œä¸è®ºæ˜¯æ•ˆç‡è¿˜æ˜¯é€Ÿåº¦éƒ½æ¯” <code>minorGC</code> æ…¢çš„å¤šï¼Œå›æ”¶æ—¶è¿˜ä¼šå‘ç”Ÿ <code>stop the world</code> ä½¿ç¨‹åºå‘ç”Ÿåœé¡¿ï¼Œæ‰€ä»¥åº”å½“å°½é‡é¿å…å‘ç”Ÿ <code>fullGC</code> ã€‚</p><h3 id="è€å¹´ä»£åˆ†é…"><a href="#è€å¹´ä»£åˆ†é…" class="headerlink" title="è€å¹´ä»£åˆ†é…"></a>è€å¹´ä»£åˆ†é…</h3><p>ä¹Ÿæœ‰ä¸€äº›æƒ…å†µä¼šå¯¼è‡´å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ï¼Œæ¯”å¦‚å½“åˆ†é…ä¸€ä¸ªå¤§å¯¹è±¡æ—¶(å¤§çš„æ•°ç»„ï¼Œå¾ˆé•¿çš„å­—ç¬¦ä¸²)ï¼Œç”±äº <code>Eden</code> åŒºæ²¡æœ‰è¶³å¤Ÿå¤§çš„è¿ç»­ç©ºé—´æ¥åˆ†é…æ—¶ï¼Œä¼šå¯¼è‡´æå‰è§¦å‘ä¸€æ¬¡ <code>GC</code>ï¼Œæ‰€ä»¥å°½é‡åˆ«é¢‘ç¹çš„åˆ›å»ºå¤§å¯¹è±¡ã€‚</p><p>å› æ­¤ <code>JVM</code> ä¼šæ ¹æ®ä¸€ä¸ªé˜ˆå€¼æ¥åˆ¤æ–­å¤§äºè¯¥é˜ˆå€¼å¯¹è±¡ç›´æ¥åˆ†é…åˆ°è€å¹´ä»£ï¼Œè¿™æ ·å¯ä»¥é¿å…åœ¨æ–°ç”Ÿä»£é¢‘ç¹çš„å‘ç”Ÿ <code>GC</code>ã€‚</p><p>å¯¹äºä¸€äº›åœ¨æ–°ç”Ÿä»£çš„è€å¯¹è±¡ <code>JVM</code> ä¹Ÿä¼šæ ¹æ®æŸç§æœºåˆ¶ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚</p><p>JVM æ˜¯æ ¹æ®è®°å½•å¯¹è±¡å¹´é¾„çš„æ–¹å¼æ¥åˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦åº”è¯¥ç§»åŠ¨åˆ°è€å¹´ä»£ï¼Œæ ¹æ®æ–°ç”Ÿä»£çš„å¤åˆ¶ç®—æ³•ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è¢«ç§»åŠ¨åˆ° <code>Survivor</code> åŒºä¹‹å JVM å°±ç»™è¯¥å¯¹è±¡çš„å¹´é¾„è®°ä¸º1ï¼Œæ¯å½“ç†¬è¿‡ä¸€æ¬¡ <code>minorGC</code> åå¯¹è±¡çš„å¹´é¾„å°± +1 ï¼Œç›´åˆ°è¾¾åˆ°é˜ˆå€¼(é»˜è®¤ä¸º15)å°±ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚</p><blockquote><p>å¯ä»¥ä½¿ç”¨ <code>-XX:MaxTenuringThreshold=15</code> æ¥é…ç½®è¿™ä¸ªé˜ˆå€¼ã€‚</p></blockquote><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è™½è¯´è¿™äº›å†…å®¹ç•¥æ˜¾æ¯ç‡¥ï¼Œä½†å½“åº”ç”¨å‘ç”Ÿä¸æ­£å¸¸çš„ <code>GC</code> æ—¶ï¼Œå¯ä»¥æ–¹ä¾¿æ›´å¿«çš„å®šä½é—®é¢˜ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å¯¹è±¡çš„åˆ›å»ºä¸å†…å­˜åˆ†é…&quot;&gt;&lt;a href=&quot;#å¯¹è±¡çš„åˆ›å»ºä¸å†…å­˜åˆ†é…&quot; class=&quot;headerlink&quot; title=&quot;å¯¹è±¡çš„åˆ›å»ºä¸å†…å­˜åˆ†é…&quot;&gt;&lt;/a&gt;å¯¹è±¡çš„åˆ›å»ºä¸å†…å­˜åˆ†é…&lt;/h1&gt;&lt;h2 id=&quot;åˆ›å»ºå¯¹è±¡&quot;&gt;&lt;a href=&quot;#åˆ›å»ºå¯¹è±¡&quot; class=&quot;head
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Java-Interview" scheme="https://airpoet.github.io/categories/Github/Java-Interview/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>LinkedHashMap</title>
    <link href="https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/collection/LinkedHashMap/"/>
    <id>https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/collection/LinkedHashMap/</id>
    <published>2018-07-09T03:26:48.526Z</published>
    <updated>2018-07-09T07:16:53.075Z</updated>
    
    <content type="html"><![CDATA[<h1 id="LinkedHashMap-åº•å±‚åˆ†æ"><a href="#LinkedHashMap-åº•å±‚åˆ†æ" class="headerlink" title="LinkedHashMap åº•å±‚åˆ†æ"></a>LinkedHashMap åº•å±‚åˆ†æ</h1><p>ä¼—æ‰€å‘¨çŸ¥ <a href="https://github.com/crossoverJie/Java-Interview/blob/master/MD/HashMap.md" target="_blank" rel="noopener">HashMap</a> æ˜¯ä¸€ä¸ªæ— åºçš„ <code>Map</code>ï¼Œå› ä¸ºæ¯æ¬¡æ ¹æ® <code>key</code> çš„ <code>hashcode</code> æ˜ å°„åˆ° <code>Entry</code> æ•°ç»„ä¸Šï¼Œæ‰€ä»¥éå†å‡ºæ¥çš„é¡ºåºå¹¶ä¸æ˜¯å†™å…¥çš„é¡ºåºã€‚</p><p>å› æ­¤ JDK æ¨å‡ºä¸€ä¸ªåŸºäº <code>HashMap</code> ä½†å…·æœ‰é¡ºåºçš„ <code>LinkedHashMap</code> æ¥è§£å†³æœ‰æ’åºéœ€æ±‚çš„åœºæ™¯ã€‚</p><p>å®ƒçš„åº•å±‚æ˜¯ç»§æ‰¿äº <code>HashMap</code> å®ç°çš„ï¼Œç”±ä¸€ä¸ªåŒå‘é“¾è¡¨æ‰€æ„æˆã€‚</p><p><code>LinkedHashMap</code> çš„æ’åºæ–¹å¼æœ‰ä¸¤ç§ï¼š</p><ul><li>æ ¹æ®å†™å…¥é¡ºåºæ’åºã€‚</li><li>æ ¹æ®è®¿é—®é¡ºåºæ’åºã€‚</li></ul><p>å…¶ä¸­æ ¹æ®è®¿é—®é¡ºåºæ’åºæ—¶ï¼Œæ¯æ¬¡ <code>get</code> éƒ½ä¼šå°†è®¿é—®çš„å€¼ç§»åŠ¨åˆ°é“¾è¡¨æœ«å°¾ï¼Œè¿™æ ·é‡å¤æ“ä½œå°±èƒ½å¾—åˆ°ä¸€ä¸ªæŒ‰ç…§è®¿é—®é¡ºåºæ’åºçš„é“¾è¡¨ã€‚</p><h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">Map&lt;String, Integer&gt; map = <span class="keyword">new</span> LinkedHashMap&lt;String, Integer&gt;();</span><br><span class="line">map.put(<span class="string">"1"</span>,<span class="number">1</span>) ;</span><br><span class="line">map.put(<span class="string">"2"</span>,<span class="number">2</span>) ;</span><br><span class="line">map.put(<span class="string">"3"</span>,<span class="number">3</span>) ;</span><br><span class="line">map.put(<span class="string">"4"</span>,<span class="number">4</span>) ;</span><br><span class="line">map.put(<span class="string">"5"</span>,<span class="number">5</span>) ;</span><br><span class="line">System.out.println(map.toString());</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒè¯•å¯ä»¥çœ‹åˆ° <code>map</code> çš„ç»„æˆï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcly1fo6l9xp91lj319m0s4tgi.jpg" alt=""></p><p>æ‰“å¼€æºç å¯ä»¥çœ‹åˆ°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The head of the doubly linked list.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">transient</span> Entry&lt;K,V&gt; header;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The iteration ordering method for this linked hash map: &lt;tt&gt;true&lt;/tt&gt;</span></span><br><span class="line"><span class="comment"> * for access-order, &lt;tt&gt;false&lt;/tt&gt; for insertion-order.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@serial</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">boolean</span> accessOrder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">HashMap</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// These fields comprise the doubly linked list used for iteration.</span></span><br><span class="line">    Entry&lt;K,V&gt; before, after;</span><br><span class="line"></span><br><span class="line">    Entry(<span class="keyword">int</span> hash, K key, V value, HashMap.Entry&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="keyword">super</span>(hash, key, value, next);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>Entry</code> ç»§æ‰¿äº <code>HashMap</code> çš„ <code>Entry</code>ï¼Œå¹¶æ–°å¢äº†ä¸Šä¸‹èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä¹Ÿå°±å½¢æˆäº†åŒå‘é“¾è¡¨ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ª <code>header</code> çš„æˆå‘˜å˜é‡ï¼Œæ˜¯è¿™ä¸ªåŒå‘é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚ </p><p>ä¸Šè¾¹çš„ demo æ€»ç»“æˆä¸€å¼ å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fodggwc523j30za0n4wgj.jpg" alt=""></p><p>ç¬¬ä¸€ä¸ªç±»ä¼¼äº <code>HashMap</code> çš„ç»“æ„ï¼Œåˆ©ç”¨ <code>Entry</code> ä¸­çš„ <code>next</code> æŒ‡é’ˆè¿›è¡Œå…³è”ã€‚</p><p>ä¸‹è¾¹åˆ™æ˜¯ <code>LinkedHashMap</code> å¦‚ä½•è¾¾åˆ°æœ‰åºçš„å…³é”®ã€‚</p><p>å°±æ˜¯åˆ©ç”¨äº†å¤´èŠ‚ç‚¹å’Œå…¶ä½™çš„å„ä¸ªèŠ‚ç‚¹ä¹‹é—´é€šè¿‡ <code>Entry</code> ä¸­çš„ <code>after</code> å’Œ <code>before</code> æŒ‡é’ˆè¿›è¡Œå…³è”ã€‚</p><p>å…¶ä¸­è¿˜æœ‰ä¸€ä¸ª <code>accessOrder</code> æˆå‘˜å˜é‡ï¼Œé»˜è®¤æ˜¯ <code>false</code>ï¼Œé»˜è®¤æŒ‰ç…§æ’å…¥é¡ºåºæ’åºï¼Œä¸º <code>true</code> æ—¶æŒ‰ç…§è®¿é—®é¡ºåºæ’åºï¼Œä¹Ÿå¯ä»¥è°ƒç”¨:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public LinkedHashMap(int initialCapacity,</span><br><span class="line">                     float loadFactor,</span><br><span class="line">                     boolean accessOrder) &#123;</span><br><span class="line">    super(initialCapacity, loadFactor);</span><br><span class="line">    this.accessOrder = accessOrder;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ„é€ æ–¹æ³•å¯ä»¥æ˜¾ç¤ºçš„ä¼ å…¥ <code>accessOrder</code>ã€‚</p><h2 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h2><p><code>LinkedHashMap</code> çš„æ„é€ æ–¹æ³•:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    accessOrder = <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®å°±æ˜¯è°ƒç”¨çš„ <code>HashMap</code> çš„æ„é€ æ–¹æ³•:</p><p><code>HashMap</code> å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal initial capacity: "</span> +</span><br><span class="line">                                           initialCapacity);</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">        initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">    <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal load factor: "</span> +</span><br><span class="line">                                           loadFactor);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.loadFactor = loadFactor;</span><br><span class="line">    threshold = initialCapacity;</span><br><span class="line">    <span class="comment">//HashMap åªæ˜¯å®šä¹‰äº†æ”¹æ–¹æ³•ï¼Œå…·ä½“å®ç°äº¤ç»™äº† LinkedHashMap</span></span><br><span class="line">    init();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ªç©ºçš„ <code>init()</code>ï¼Œå…·ä½“æ˜¯ç”± <code>LinkedHashMap</code> æ¥å®ç°çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    header = <span class="keyword">new</span> Entry&lt;&gt;(-<span class="number">1</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">    header.before = header.after = header;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®ä¹Ÿå°±æ˜¯å¯¹ <code>header</code> è¿›è¡Œäº†åˆå§‹åŒ–ã€‚</p><h2 id="put-æ–¹æ³•"><a href="#put-æ–¹æ³•" class="headerlink" title="put() æ–¹æ³•"></a>put() æ–¹æ³•</h2><p>çœ‹ <code>LinkedHashMap</code> çš„ <code>put()</code> æ–¹æ³•ä¹‹å‰å…ˆçœ‹çœ‹ <code>HashMap</code> çš„ <code>put</code> æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">public V put(K key, V value) &#123;</span><br><span class="line">    if (table == EMPTY_TABLE) &#123;</span><br><span class="line">        inflateTable(threshold);</span><br><span class="line">    &#125;</span><br><span class="line">    if (key == null)</span><br><span class="line">        return putForNullKey(value);</span><br><span class="line">    int hash = hash(key);</span><br><span class="line">    int i = indexFor(hash, table.length);</span><br><span class="line">    for (Entry&lt;K,V&gt; e = table[i]; e != null; e = e.next) &#123;</span><br><span class="line">        Object k;</span><br><span class="line">        if (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) &#123;</span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            e.value = value;</span><br><span class="line">            //ç©ºå®ç°ï¼Œäº¤ç»™ LinkedHashMap è‡ªå·±å®ç°</span><br><span class="line">            e.recordAccess(this);</span><br><span class="line">            return oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modCount++;</span><br><span class="line">    // LinkedHashMap å¯¹å…¶é‡å†™</span><br><span class="line">    addEntry(hash, key, value, i);</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// LinkedHashMap å¯¹å…¶é‡å†™</span><br><span class="line">void addEntry(int hash, K key, V value, int bucketIndex) &#123;</span><br><span class="line">    if ((size &gt;= threshold) &amp;&amp; (null != table[bucketIndex])) &#123;</span><br><span class="line">        resize(2 * table.length);</span><br><span class="line">        hash = (null != key) ? hash(key) : 0;</span><br><span class="line">        bucketIndex = indexFor(hash, table.length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    createEntry(hash, key, value, bucketIndex);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// LinkedHashMap å¯¹å…¶é‡å†™</span><br><span class="line">void createEntry(int hash, K key, V value, int bucketIndex) &#123;</span><br><span class="line">    Entry&lt;K,V&gt; e = table[bucketIndex];</span><br><span class="line">    table[bucketIndex] = new Entry&lt;&gt;(hash, key, value, e);</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»ä½“çš„å®ç°éƒ½æ˜¯å€ŸåŠ©äº <code>HashMap</code> æ¥å®Œæˆçš„ï¼Œåªæ˜¯å¯¹å…¶ä¸­çš„ <code>recordAccess(), addEntry(), createEntry()</code> è¿›è¡Œäº†é‡å†™ã€‚</p><p><code>LinkedHashMap</code> çš„å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//å°±æ˜¯åˆ¤æ–­æ˜¯å¦æ˜¯æ ¹æ®è®¿é—®é¡ºåºæ’åºï¼Œå¦‚æœæ˜¯åˆ™éœ€è¦å°†å½“å‰è¿™ä¸ª Entry ç§»åŠ¨åˆ°é“¾è¡¨çš„æœ«å°¾</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">recordAccess</span><span class="params">(HashMap&lt;K,V&gt; m)</span> </span>&#123;</span><br><span class="line">        LinkedHashMap&lt;K,V&gt; lm = (LinkedHashMap&lt;K,V&gt;)m;</span><br><span class="line">        <span class="keyword">if</span> (lm.accessOrder) &#123;</span><br><span class="line">            lm.modCount++;</span><br><span class="line">            remove();</span><br><span class="line">            addBefore(lm.header);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">//è°ƒç”¨äº† HashMap çš„å®ç°ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ é™¤æœ€å°‘ä½¿ç”¨çš„ Entry(é»˜è®¤ä¸åˆ é™¤)    </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> bucketIndex)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.addEntry(hash, key, value, bucketIndex);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove eldest entry if instructed</span></span><br><span class="line">    Entry&lt;K,V&gt; eldest = header.after;</span><br><span class="line">    <span class="keyword">if</span> (removeEldestEntry(eldest)) &#123;</span><br><span class="line">        removeEntryForKey(eldest.key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> bucketIndex)</span> </span>&#123;</span><br><span class="line">    HashMap.Entry&lt;K,V&gt; old = table[bucketIndex];</span><br><span class="line">    Entry&lt;K,V&gt; e = <span class="keyword">new</span> Entry&lt;&gt;(hash, key, value, old);</span><br><span class="line">    <span class="comment">//å°±å¤šäº†è¿™ä¸€æ­¥ï¼Œå°†æ–°å¢çš„ Entry åŠ å…¥åˆ° header åŒå‘é“¾è¡¨ä¸­</span></span><br><span class="line">    table[bucketIndex] = e;</span><br><span class="line">    e.addBefore(header);</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å†™å…¥åˆ°åŒå‘é“¾è¡¨ä¸­</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addBefore</span><span class="params">(Entry&lt;K,V&gt; existingEntry)</span> </span>&#123;</span><br><span class="line">        after  = existingEntry;</span><br><span class="line">        before = existingEntry.before;</span><br><span class="line">        before.after = <span class="keyword">this</span>;</span><br><span class="line">        after.before = <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="get-æ–¹æ³•"><a href="#get-æ–¹æ³•" class="headerlink" title="get æ–¹æ³•"></a>get æ–¹æ³•</h2><p>LinkedHashMap çš„ <code>get()</code> æ–¹æ³•ä¹Ÿé‡å†™äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Entry&lt;K,V&gt; e = (Entry&lt;K,V&gt;)getEntry(key);</span><br><span class="line">    <span class="keyword">if</span> (e == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">//å¤šäº†ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦æ˜¯æŒ‰ç…§è®¿é—®é¡ºåºæ’åºï¼Œæ˜¯åˆ™å°†å½“å‰çš„ Entry ç§»åŠ¨åˆ°é“¾è¡¨å¤´éƒ¨ã€‚   </span></span><br><span class="line">    e.recordAccess(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">return</span> e.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">recordAccess</span><span class="params">(HashMap&lt;K,V&gt; m)</span> </span>&#123;</span><br><span class="line">    LinkedHashMap&lt;K,V&gt; lm = (LinkedHashMap&lt;K,V&gt;)m;</span><br><span class="line">    <span class="keyword">if</span> (lm.accessOrder) &#123;</span><br><span class="line">        lm.modCount++;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//åˆ é™¤</span></span><br><span class="line">        remove();</span><br><span class="line">        <span class="comment">//æ·»åŠ åˆ°å¤´éƒ¨</span></span><br><span class="line">        addBefore(lm.header);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>clear()</code> æ¸…ç©ºå°±è¦æ¯”è¾ƒç®€å•äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åªéœ€è¦æŠŠæŒ‡é’ˆéƒ½æŒ‡å‘è‡ªå·±å³å¯ï¼ŒåŸæœ¬é‚£äº› Entry æ²¡æœ‰å¼•ç”¨ä¹‹åå°±ä¼šè¢« JVM è‡ªåŠ¨å›æ”¶ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.clear();</span><br><span class="line">    header.before = header.after = header;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥è¯´ <code>LinkedHashMap</code> å…¶å®å°±æ˜¯å¯¹ <code>HashMap</code> è¿›è¡Œäº†æ‹“å±•ï¼Œä½¿ç”¨äº†åŒå‘é“¾è¡¨æ¥ä¿è¯äº†é¡ºåºæ€§ã€‚</p><p>å› ä¸ºæ˜¯ç»§æ‰¿ä¸ <code>HashMap</code> çš„ï¼Œæ‰€ä»¥ä¸€äº› <code>HashMap</code> å­˜åœ¨çš„é—®é¢˜ <code>LinkedHashMap</code> ä¹Ÿä¼šå­˜åœ¨ï¼Œæ¯”å¦‚ä¸æ”¯æŒå¹¶å‘ç­‰ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;LinkedHashMap-åº•å±‚åˆ†æ&quot;&gt;&lt;a href=&quot;#LinkedHashMap-åº•å±‚åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;LinkedHashMap åº•å±‚åˆ†æ&quot;&gt;&lt;/a&gt;LinkedHashMap åº•å±‚åˆ†æ&lt;/h1&gt;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ &lt;
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Java-Interview" scheme="https://airpoet.github.io/categories/Github/Java-Interview/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>Thread-common-problem</title>
    <link href="https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/Thread-common-problem/"/>
    <id>https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/Thread-common-problem/</id>
    <published>2018-07-09T03:26:48.524Z</published>
    <updated>2018-07-09T07:24:19.160Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java-å¤šçº¿ç¨‹å¸¸è§é—®é¢˜"><a href="#Java-å¤šçº¿ç¨‹å¸¸è§é—®é¢˜" class="headerlink" title="Java å¤šçº¿ç¨‹å¸¸è§é—®é¢˜"></a>Java å¤šçº¿ç¨‹å¸¸è§é—®é¢˜</h1><h2 id="ä¸Šä¸‹æ–‡åˆ‡æ¢"><a href="#ä¸Šä¸‹æ–‡åˆ‡æ¢" class="headerlink" title="ä¸Šä¸‹æ–‡åˆ‡æ¢"></a>ä¸Šä¸‹æ–‡åˆ‡æ¢</h2><p>å¤šçº¿ç¨‹å¹¶ä¸ä¸€å®šæ˜¯è¦åœ¨å¤šæ ¸å¤„ç†å™¨æ‰æ”¯æŒçš„ï¼Œå°±ç®—æ˜¯å•æ ¸ä¹Ÿæ˜¯å¯ä»¥æ”¯æŒå¤šçº¿ç¨‹çš„ã€‚<br>CPU é€šè¿‡ç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€å®šçš„æ—¶é—´ç‰‡ï¼Œç”±äºæ—¶é—´éå¸¸çŸ­é€šå¸¸æ˜¯å‡ åæ¯«ç§’ï¼Œæ‰€ä»¥ CPU å¯ä»¥ä¸åœçš„åˆ‡æ¢çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ä»è€Œè¾¾åˆ°äº†å¤šçº¿ç¨‹çš„æ•ˆæœã€‚</p><p>ä½†æ˜¯ç”±äºåœ¨çº¿ç¨‹åˆ‡æ¢çš„æ—¶å€™éœ€è¦ä¿å­˜æœ¬æ¬¡æ‰§è¡Œçš„ä¿¡æ¯(<a href="https://github.com/crossoverJie/Java-Interview/blob/master/MD/MemoryAllocation.md#%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8" target="_blank" rel="noopener">è¯¦è§</a>)ï¼Œåœ¨è¯¥çº¿ç¨‹è¢« CPU å‰¥å¤ºæ—¶é—´ç‰‡ååˆå†æ¬¡è¿è¡Œæ¢å¤ä¸Šæ¬¡æ‰€ä¿å­˜çš„ä¿¡æ¯çš„è¿‡ç¨‹å°±æˆä¸ºä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><blockquote><p>ä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯éå¸¸è€—æ•ˆç‡çš„ã€‚</p></blockquote><p>é€šå¸¸æœ‰ä»¥ä¸‹è§£å†³æ–¹æ¡ˆ:</p><ul><li>é‡‡ç”¨æ— é”ç¼–ç¨‹ï¼Œæ¯”å¦‚å°†æ•°æ®æŒ‰ç…§ <code>Hash(id)</code> è¿›è¡Œå–æ¨¡åˆ†æ®µï¼Œæ¯ä¸ªçº¿ç¨‹å¤„ç†å„è‡ªåˆ†æ®µçš„æ•°æ®ï¼Œä»è€Œé¿å…ä½¿ç”¨é”ã€‚</li><li>é‡‡ç”¨ CAS(compare and swap) ç®—æ³•ï¼Œå¦‚ <code>Atomic</code> åŒ…å°±æ˜¯é‡‡ç”¨ CAS ç®—æ³•(<a href="https://github.com/crossoverJie/Java-Interview/blob/master/Threadcore.md#%E5%8E%9F%E5%AD%90%E6%80%A7" target="_blank" rel="noopener">è¯¦è§</a>)ã€‚</li><li>åˆç†çš„åˆ›å»ºçº¿ç¨‹ï¼Œé¿å…åˆ›å»ºäº†ä¸€äº›çº¿ç¨‹ä½†å…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯å‡ºäº <code>waiting</code> çŠ¶æ€ï¼Œå› ä¸ºæ¯å½“ä» <code>waiting</code> çŠ¶æ€åˆ‡æ¢åˆ° <code>running</code> çŠ¶æ€éƒ½æ˜¯ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</li></ul><h2 id="æ­»é”"><a href="#æ­»é”" class="headerlink" title="æ­»é”"></a>æ­»é”</h2><p>æ­»é”çš„åœºæ™¯ä¸€èˆ¬æ˜¯ï¼šçº¿ç¨‹ A å’Œçº¿ç¨‹ B éƒ½åœ¨äº’ç›¸ç­‰å¾…å¯¹æ–¹é‡Šæ”¾é”ï¼Œæˆ–è€…æ˜¯å…¶ä¸­æŸä¸ªçº¿ç¨‹åœ¨é‡Šæ”¾é”çš„æ—¶å€™å‡ºç°å¼‚å¸¸å¦‚æ­»å¾ªç¯ä¹‹ç±»çš„ã€‚è¿™æ—¶å°±ä¼šå¯¼è‡´ç³»ç»Ÿä¸å¯ç”¨ã€‚</p><p>å¸¸ç”¨çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p><ul><li>å°½é‡ä¸€ä¸ªçº¿ç¨‹åªè·å–ä¸€ä¸ªé”ã€‚</li><li>ä¸€ä¸ªçº¿ç¨‹åªå ç”¨ä¸€ä¸ªèµ„æºã€‚</li><li>å°è¯•ä½¿ç”¨å®šæ—¶é”ï¼Œè‡³å°‘èƒ½ä¿è¯é”æœ€ç»ˆä¼šè¢«é‡Šæ”¾ã€‚</li></ul><h2 id="èµ„æºé™åˆ¶"><a href="#èµ„æºé™åˆ¶" class="headerlink" title="èµ„æºé™åˆ¶"></a>èµ„æºé™åˆ¶</h2><p>å½“åœ¨å¸¦å®½æœ‰é™çš„æƒ…å†µä¸‹ä¸€ä¸ªçº¿ç¨‹ä¸‹è½½æŸä¸ªèµ„æºéœ€è¦ <code>1M/S</code>,å½“å¼€ 10 ä¸ªçº¿ç¨‹æ—¶é€Ÿåº¦å¹¶ä¸ä¼šä¹˜ 10 å€ï¼Œåè€Œè¿˜ä¼šå¢åŠ æ—¶é—´ï¼Œæ¯•ç«Ÿä¸Šä¸‹æ–‡åˆ‡æ¢æ¯”è¾ƒè€—æ—¶ã€‚</p><p>å¦‚æœæ˜¯å—é™äºèµ„æºçš„è¯å¯ä»¥é‡‡ç”¨é›†ç¾¤æ¥å¤„ç†ä»»åŠ¡ï¼Œä¸åŒçš„æœºå™¨æ¥å¤„ç†ä¸åŒçš„æ•°æ®ï¼Œå°±ç±»ä¼¼äºå¼€å§‹æåˆ°çš„æ— é”ç¼–ç¨‹ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Java-å¤šçº¿ç¨‹å¸¸è§é—®é¢˜&quot;&gt;&lt;a href=&quot;#Java-å¤šçº¿ç¨‹å¸¸è§é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;Java å¤šçº¿ç¨‹å¸¸è§é—®é¢˜&quot;&gt;&lt;/a&gt;Java å¤šçº¿ç¨‹å¸¸è§é—®é¢˜&lt;/h1&gt;&lt;h2 id=&quot;ä¸Šä¸‹æ–‡åˆ‡æ¢&quot;&gt;&lt;a href=&quot;#ä¸Šä¸‹æ–‡åˆ‡æ¢&quot; c
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Java-Interview" scheme="https://airpoet.github.io/categories/Github/Java-Interview/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>HashMap</title>
    <link href="https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/HashMap/"/>
    <id>https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/HashMap/</id>
    <published>2018-07-09T03:26:48.519Z</published>
    <updated>2018-07-09T07:20:35.760Z</updated>
    
    <content type="html"><![CDATA[<h1 id="HashMap-åº•å±‚åˆ†æ"><a href="#HashMap-åº•å±‚åˆ†æ" class="headerlink" title="HashMap åº•å±‚åˆ†æ"></a>HashMap åº•å±‚åˆ†æ</h1><blockquote><p>ä»¥ä¸‹åŸºäº JDK1.7 åˆ†æã€‚</p></blockquote><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fn84b0ftj4j30eb0560sv.jpg" alt=""></p><p>å¦‚å›¾æ‰€ç¤ºï¼ŒHashMap åº•å±‚æ˜¯åŸºäºæ•°ç»„å’Œé“¾è¡¨å®ç°çš„ã€‚å…¶ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„å‚æ•°ï¼š</p><ul><li>å®¹é‡</li><li>è´Ÿè½½å› å­</li></ul><p>å®¹é‡çš„é»˜è®¤å¤§å°æ˜¯ 16ï¼Œè´Ÿè½½å› å­æ˜¯ 0.75ï¼Œå½“ <code>HashMap</code> çš„ <code>size &gt; 16*0.75</code> æ—¶å°±ä¼šå‘ç”Ÿæ‰©å®¹(å®¹é‡å’Œè´Ÿè½½å› å­éƒ½å¯ä»¥è‡ªç”±è°ƒæ•´)ã€‚</p><h2 id="put-æ–¹æ³•"><a href="#put-æ–¹æ³•" class="headerlink" title="put æ–¹æ³•"></a>put æ–¹æ³•</h2><p>é¦–å…ˆä¼šå°†ä¼ å…¥çš„ Key åš <code>hash</code> è¿ç®—è®¡ç®—å‡º hashcode,ç„¶åæ ¹æ®æ•°ç»„é•¿åº¦å–æ¨¡è®¡ç®—å‡ºåœ¨æ•°ç»„ä¸­çš„ index ä¸‹æ ‡ã€‚</p><p>ç”±äºåœ¨è®¡ç®—ä¸­ä½è¿ç®—æ¯”å–æ¨¡è¿ç®—æ•ˆç‡é«˜çš„å¤šï¼Œæ‰€ä»¥ HashMap è§„å®šæ•°ç»„çš„é•¿åº¦ä¸º <code>2&lt;sup&gt;n</code> ã€‚è¿™æ ·ç”¨ <code>2&lt;/sup&gt;n - 1</code> åšä½è¿ç®—ä¸å–æ¨¡æ•ˆæœä¸€è‡´ï¼Œå¹¶ä¸”æ•ˆç‡è¿˜è¦é«˜å‡ºè®¸å¤šã€‚</p><p>ç”±äºæ•°ç»„çš„é•¿åº¦æœ‰é™ï¼Œæ‰€ä»¥éš¾å…ä¼šå‡ºç°ä¸åŒçš„ Key é€šè¿‡è¿ç®—å¾—åˆ°çš„ index ç›¸åŒï¼Œè¿™ç§æƒ…å†µå¯ä»¥åˆ©ç”¨é“¾è¡¨æ¥è§£å†³ï¼ŒHashMap ä¼šåœ¨ <code>table[index]</code>å¤„å½¢æˆé“¾è¡¨ï¼Œé‡‡ç”¨å¤´æ’æ³•å°†æ•°æ®æ’å…¥åˆ°é“¾è¡¨ä¸­ã€‚</p><h2 id="get-æ–¹æ³•"><a href="#get-æ–¹æ³•" class="headerlink" title="get æ–¹æ³•"></a>get æ–¹æ³•</h2><p>get å’Œ put ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å°†ä¼ å…¥çš„ Key è®¡ç®—å‡º index ï¼Œå¦‚æœè¯¥ä½ç½®ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨å°±éœ€è¦éå†æ•´ä¸ªé“¾è¡¨ï¼Œé€šè¿‡ <code>key.equals(k)</code> æ¥æ‰¾åˆ°å¯¹åº”çš„å…ƒç´ ã€‚</p><h2 id="éå†æ–¹å¼"><a href="#éå†æ–¹å¼" class="headerlink" title="éå†æ–¹å¼"></a>éå†æ–¹å¼</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Iterator&lt;Map.Entry&lt;String, Integer&gt;&gt; entryIterator = map.entrySet().iterator();</span><br><span class="line">       <span class="keyword">while</span> (entryIterator.hasNext()) &#123;</span><br><span class="line">           Map.Entry&lt;String, Integer&gt; next = entryIterator.next();</span><br><span class="line">           System.out.println(<span class="string">"key="</span> + next.getKey() + <span class="string">" value="</span> + next.getValue());</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Iterator&lt;String&gt; iterator = map.keySet().iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">            String key = iterator.next();</span><br><span class="line">            System.out.println(<span class="string">"key="</span> + key + <span class="string">" value="</span> + map.get(key));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">map.forEach((key,value)-&gt;&#123;</span><br><span class="line">    System.out.println(<span class="string">"key="</span> + key + <span class="string">" value="</span> + value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>å¼ºçƒˆå»ºè®®</strong>ä½¿ç”¨ç¬¬ä¸€ç§ EntrySet è¿›è¡Œéå†ã€‚</p><p>ç¬¬ä¸€ç§å¯ä»¥æŠŠ key value åŒæ—¶å–å‡ºï¼Œç¬¬äºŒç§è¿˜å¾—éœ€è¦é€šè¿‡ key å–ä¸€æ¬¡ valueï¼Œæ•ˆç‡è¾ƒä½, ç¬¬ä¸‰ç§éœ€è¦ <code>JDK1.8</code> ä»¥ä¸Šï¼Œé€šè¿‡å¤–å±‚éå† tableï¼Œå†…å±‚éå†é“¾è¡¨æˆ–çº¢é»‘æ ‘ã€‚ </p><h2 id="notice"><a href="#notice" class="headerlink" title="notice"></a>notice</h2><p>åœ¨å¹¶å‘ç¯å¢ƒä¸‹ä½¿ç”¨ <code>HashMap</code> å®¹æ˜“å‡ºç°æ­»å¾ªç¯ã€‚</p><p>å¹¶å‘åœºæ™¯å‘ç”Ÿæ‰©å®¹ï¼Œè°ƒç”¨ <code>resize()</code> æ–¹æ³•é‡Œçš„ <code>rehash()</code> æ—¶ï¼Œå®¹æ˜“å‡ºç°ç¯å½¢é“¾è¡¨ã€‚è¿™æ ·å½“è·å–ä¸€ä¸ªä¸å­˜åœ¨çš„ <code>key</code> æ—¶ï¼Œè®¡ç®—å‡ºçš„ <code>index</code> æ­£å¥½æ˜¯ç¯å½¢é“¾è¡¨çš„ä¸‹æ ‡æ—¶å°±ä¼šå‡ºç°æ­»å¾ªç¯ã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fn85u0a0d9j30n20ii0tp.jpg" alt=""></p><blockquote><p>æ‰€ä»¥ HashMap åªèƒ½åœ¨å•çº¿ç¨‹ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”å°½é‡çš„é¢„è®¾å®¹é‡ï¼Œå°½å¯èƒ½çš„å‡å°‘æ‰©å®¹ã€‚</p></blockquote><p>åœ¨ <code>JDK1.8</code> ä¸­å¯¹ <code>HashMap</code> è¿›è¡Œäº†ä¼˜åŒ–ï¼š<br>å½“ <code>hash</code> ç¢°æ’ä¹‹åå†™å…¥é“¾è¡¨çš„é•¿åº¦è¶…è¿‡äº†é˜ˆå€¼(é»˜è®¤ä¸º8)ï¼Œé“¾è¡¨å°†ä¼šè½¬æ¢ä¸º<strong>çº¢é»‘æ ‘</strong>ã€‚</p><p>å‡è®¾ <code>hash</code> å†²çªéå¸¸ä¸¥é‡ï¼Œä¸€ä¸ªæ•°ç»„åé¢æ¥äº†å¾ˆé•¿çš„é“¾è¡¨ï¼Œæ­¤æ—¶é‡æ–°çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ <code>O(n)</code> ã€‚</p><p>å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œæ—¶é—´å¤æ‚åº¦å°±æ˜¯ <code>O(logn)</code> ã€‚</p><p>å¤§å¤§æé«˜äº†æŸ¥è¯¢æ•ˆç‡ã€‚</p><p>å¤šçº¿ç¨‹åœºæ™¯ä¸‹æ¨èä½¿ç”¨ <a href="https://github.com/crossoverJie/Java-Interview/blob/master/MD/ConcurrentHashMap.md" target="_blank" rel="noopener">ConcurrentHashMap</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;HashMap-åº•å±‚åˆ†æ&quot;&gt;&lt;a href=&quot;#HashMap-åº•å±‚åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;HashMap åº•å±‚åˆ†æ&quot;&gt;&lt;/a&gt;HashMap åº•å±‚åˆ†æ&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹åŸºäº JDK1.7 åˆ†æã€‚&lt;/
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Java-Interview" scheme="https://airpoet.github.io/categories/Github/Java-Interview/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>ConcurrentHashMap</title>
    <link href="https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/ConcurrentHashMap/"/>
    <id>https://airpoet.github.io/2018/07/09/Java/Interview/Java-Interview/ConcurrentHashMap/</id>
    <published>2018-07-09T03:26:48.516Z</published>
    <updated>2018-07-09T07:19:20.903Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ConcurrentHashMap-å®ç°åŸç†"><a href="#ConcurrentHashMap-å®ç°åŸç†" class="headerlink" title="ConcurrentHashMap å®ç°åŸç†"></a>ConcurrentHashMap å®ç°åŸç†</h1><p>ç”±äº <code>HashMap</code> æ˜¯ä¸€ä¸ªçº¿ç¨‹ä¸å®‰å…¨çš„å®¹å™¨ï¼Œä¸»è¦ä½“ç°åœ¨å®¹é‡å¤§äº<code>æ€»é‡*è´Ÿè½½å› å­</code>å‘ç”Ÿæ‰©å®¹æ—¶ä¼šå‡ºç°ç¯å½¢é“¾è¡¨ä»è€Œå¯¼è‡´æ­»å¾ªç¯ã€‚</p><p>å› æ­¤éœ€è¦æ”¯æŒçº¿ç¨‹å®‰å…¨çš„å¹¶å‘å®¹å™¨ <code>ConcurrentHashMap</code> ã€‚</p><h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fn2f5pgxinj30dw0730t7.jpg" alt=""></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œæ˜¯ç”± <code>Segment</code> æ•°ç»„ã€<code>HashEntry</code> æ•°ç»„ç»„æˆï¼Œå’Œ <code>HashMap</code> ä¸€æ ·ï¼Œä»ç„¶æ˜¯æ•°ç»„åŠ é“¾è¡¨ç»„æˆã€‚</p><p><code>ConcurrentHashMap</code> é‡‡ç”¨äº†åˆ†æ®µé”æŠ€æœ¯ï¼Œå…¶ä¸­ <code>Segment</code> ç»§æ‰¿äº <code>ReentrantLock</code>ã€‚ä¸ä¼šåƒ <code>HashTable</code> é‚£æ ·ä¸ç®¡æ˜¯ <code>put</code> è¿˜æ˜¯ <code>get</code> æ“ä½œéƒ½éœ€è¦åšåŒæ­¥å¤„ç†ï¼Œç†è®ºä¸Š ConcurrentHashMap æ”¯æŒ <code>CurrencyLevel</code> (Segment æ•°ç»„æ•°é‡)çš„çº¿ç¨‹å¹¶å‘ã€‚æ¯å½“ä¸€ä¸ªçº¿ç¨‹å ç”¨é”è®¿é—®ä¸€ä¸ª <code>Segment</code> æ—¶ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„ <code>Segment</code>ã€‚</p><h2 id="get-æ–¹æ³•"><a href="#get-æ–¹æ³•" class="headerlink" title="get æ–¹æ³•"></a>get æ–¹æ³•</h2><p><code>ConcurrentHashMap</code> çš„ <code>get</code> æ–¹æ³•æ˜¯éå¸¸é«˜æ•ˆçš„ï¼Œå› ä¸ºæ•´ä¸ªè¿‡ç¨‹éƒ½ä¸éœ€è¦åŠ é”ã€‚</p><p>åªéœ€è¦å°† <code>Key</code> é€šè¿‡ <code>Hash</code> ä¹‹åå®šä½åˆ°å…·ä½“çš„ <code>Segment</code> ï¼Œå†é€šè¿‡ä¸€æ¬¡ <code>Hash</code> å®šä½åˆ°å…·ä½“çš„å…ƒç´ ä¸Šã€‚ç”±äº <code>HashEntry</code> ä¸­çš„ <code>value</code> å±æ€§æ˜¯ç”¨ <code>volatile</code> å…³é”®è¯ä¿®é¥°çš„ï¼Œä¿è¯äº†å†…å­˜å¯è§æ€§ï¼Œæ‰€ä»¥æ¯æ¬¡è·å–æ—¶éƒ½æ˜¯æœ€æ–°å€¼(<a href="https://github.com/crossoverJie/Java-Interview/blob/master/MD/Threadcore.md#%E5%8F%AF%E8%A7%81%E6%80%A7" target="_blank" rel="noopener">volatile ç›¸å…³çŸ¥è¯†ç‚¹</a>)ã€‚</p><h2 id="put-æ–¹æ³•"><a href="#put-æ–¹æ³•" class="headerlink" title="put æ–¹æ³•"></a>put æ–¹æ³•</h2><p>å†…éƒ¨ <code>HashEntry</code> ç±» ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">HashEntry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;</span><br><span class="line">    <span class="keyword">final</span> K key;</span><br><span class="line">    <span class="keyword">volatile</span> V value;</span><br><span class="line">    <span class="keyword">volatile</span> HashEntry&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line">    HashEntry(<span class="keyword">int</span> hash, K key, V value, HashEntry&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è™½ç„¶ HashEntry ä¸­çš„ value æ˜¯ç”¨ <code>volatile</code> å…³é”®è¯ä¿®é¥°çš„ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¿è¯å¹¶å‘çš„åŸå­æ€§ï¼Œæ‰€ä»¥ put æ“ä½œæ—¶ä»ç„¶éœ€è¦åŠ é”å¤„ç†ã€‚</p><p>é¦–å…ˆä¹Ÿæ˜¯é€šè¿‡ Key çš„ Hash å®šä½åˆ°å…·ä½“çš„ Segmentï¼Œåœ¨ put ä¹‹å‰ä¼šè¿›è¡Œä¸€æ¬¡æ‰©å®¹æ ¡éªŒã€‚è¿™é‡Œæ¯” HashMap è¦å¥½çš„ä¸€ç‚¹æ˜¯ï¼šHashMap æ˜¯æ’å…¥å…ƒç´ ä¹‹åå†çœ‹æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œæœ‰å¯èƒ½æ‰©å®¹ä¹‹ååç»­å°±æ²¡æœ‰æ’å…¥å°±æµªè´¹äº†æœ¬æ¬¡æ‰©å®¹(æ‰©å®¹éå¸¸æ¶ˆè€—æ€§èƒ½)ã€‚</p><p>è€Œ ConcurrentHashMap ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯å…ˆå°†æ•°æ®æ’å…¥ä¹‹åå†æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œä¹‹åå†åšæ’å…¥ã€‚</p><h2 id="size-æ–¹æ³•"><a href="#size-æ–¹æ³•" class="headerlink" title="size æ–¹æ³•"></a>size æ–¹æ³•</h2><p>æ¯ä¸ª <code>Segment</code> éƒ½æœ‰ä¸€ä¸ª <code>volatile</code> ä¿®é¥°çš„å…¨å±€å˜é‡ <code>count</code> ,æ±‚æ•´ä¸ª <code>ConcurrentHashMap</code> çš„ <code>size</code> æ—¶å¾ˆæ˜æ˜¾å°±æ˜¯å°†æ‰€æœ‰çš„ <code>count</code> ç´¯åŠ å³å¯ã€‚ä½†æ˜¯ <code>volatile</code> ä¿®é¥°çš„å˜é‡å´ä¸èƒ½ä¿è¯å¤šçº¿ç¨‹çš„åŸå­æ€§ï¼Œæ‰€æœ‰ç›´æ¥ç´¯åŠ å¾ˆå®¹æ˜“å‡ºç°å¹¶å‘é—®é¢˜ã€‚</p><p>ä½†å¦‚æœæ¯æ¬¡è°ƒç”¨ <code>size</code> æ–¹æ³•å°†å…¶ä½™çš„ä¿®æ”¹æ“ä½œåŠ é”æ•ˆç‡ä¹Ÿå¾ˆä½ã€‚æ‰€ä»¥åšæ³•æ˜¯å…ˆå°è¯•ä¸¤æ¬¡å°† <code>count</code> ç´¯åŠ ï¼Œå¦‚æœå®¹å™¨çš„ <code>count</code> å‘ç”Ÿäº†å˜åŒ–å†åŠ é”æ¥ç»Ÿè®¡ <code>size</code>ã€‚</p><p>è‡³äº <code>ConcurrentHashMap</code> æ˜¯å¦‚ä½•çŸ¥é“åœ¨ç»Ÿè®¡æ—¶å¤§å°å‘ç”Ÿäº†å˜åŒ–å‘¢ï¼Œæ¯ä¸ª <code>Segment</code> éƒ½æœ‰ä¸€ä¸ª <code>modCount</code> å˜é‡ï¼Œæ¯å½“è¿›è¡Œä¸€æ¬¡ <code>put remove</code> ç­‰æ“ä½œï¼Œ<code>modCount</code> å°†ä¼š +1ã€‚åªè¦ <code>modCount</code> å‘ç”Ÿäº†å˜åŒ–å°±è®¤ä¸ºå®¹å™¨çš„å¤§å°ä¹Ÿåœ¨å‘ç”Ÿå˜åŒ–ã€‚</p><blockquote><p>ä»¥ä¸Šå†…å®¹ base JDK1.7ï¼Œ1.8 çš„å®ç°æ›´åŠ å¤æ‚ä½†æ˜¯åŸç†ç±»ä¼¼ï¼Œå»ºè®®åœ¨ 1.7 çš„åŸºç¡€ä¸ŠæŸ¥çœ‹æºç ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ConcurrentHashMap-å®ç°åŸç†&quot;&gt;&lt;a href=&quot;#ConcurrentHashMap-å®ç°åŸç†&quot; class=&quot;headerlink&quot; title=&quot;ConcurrentHashMap å®ç°åŸç†&quot;&gt;&lt;/a&gt;ConcurrentHashMap å®ç°
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Java-Interview" scheme="https://airpoet.github.io/categories/Github/Java-Interview/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>çˆ¬è™«çš„ç®€å•å…¥é—¨</title>
    <link href="https://airpoet.github.io/2018/07/06/Python/%E7%88%AC%E8%99%AB%E7%9A%84%E7%AE%80%E5%8D%95%E5%85%A5%E9%97%A8/"/>
    <id>https://airpoet.github.io/2018/07/06/Python/çˆ¬è™«çš„ç®€å•å…¥é—¨/</id>
    <published>2018-07-06T01:29:54.058Z</published>
    <updated>2018-07-06T17:24:12.215Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æ•°æ®æ¥æº"><a href="#1-æ•°æ®æ¥æº" class="headerlink" title="1.æ•°æ®æ¥æº"></a>1.æ•°æ®æ¥æº</h2><ul><li>ä¸šåŠ¡åº“</li><li>æ—¥å¿—æ•°æ®</li><li>å…¬å…±æ•°æ®</li><li>è´­ä¹° â€“ å€’å– â€“ æœ‰æ³•å¾‹é£é™©</li></ul><h2 id="2-çˆ¬è™«å·¥ç¨‹å¸ˆæŠ€èƒ½æ¸…å•"><a href="#2-çˆ¬è™«å·¥ç¨‹å¸ˆæŠ€èƒ½æ¸…å•" class="headerlink" title="2.çˆ¬è™«å·¥ç¨‹å¸ˆæŠ€èƒ½æ¸…å•"></a>2.çˆ¬è™«å·¥ç¨‹å¸ˆæŠ€èƒ½æ¸…å•</h2><ol><li>pythonç¼–ç¨‹è¯­è¨€åŸºç¡€</li><li>HTTPåè®®</li><li>html,css,javascriptåŸºæœ¬webæŠ€èƒ½</li><li>mysql/mongodb/redisç­‰å­˜å‚¨ç³»ç»Ÿ</li><li>scrapy/pyspider/django</li><li>æŠ“åŒ…å·¥å…·å’Œç½‘é¡µåˆ†æå·¥å…·(æ­£åˆ™ï¼Œbs4ï¼Œxpathï¼Œselenuim)</li><li>json/csv/db</li></ol><h2 id="3-Python3åŸºç¡€å†…å®¹"><a href="#3-Python3åŸºç¡€å†…å®¹" class="headerlink" title="3.Python3åŸºç¡€å†…å®¹"></a>3.Python3åŸºç¡€å†…å®¹</h2><p><a href="http://www.liaoxuefeng.com/" target="_blank" rel="noopener">å»–é›ªå³°Python3æ•™ç¨‹(æ–‡æ¡£)</a><br><a href="http://www.runoob.com/python3/python3-tutorial.html" target="_blank" rel="noopener">èœé¸Ÿæ•™ç¨‹Python3æ•™ç¨‹(æ–‡æ¡£)</a></p><p>pythonç¼–ç¨‹è¯­è¨€ç®€å•ä»‹ç»ï¼ˆäº§ç”ŸèƒŒæ™¯ï¼Œä¼˜ç¼ºç‚¹ï¼Œæµè¡Œåº¦ï¼‰<br>pythonçš„å¼€å‘ç¯å¢ƒæ­å»ºï¼ˆlinuxï¼Œwindowsï¼Œpythonï¼Œpycharmï¼‰<br>pythonçš„hello world<br>pythonå…³é”®å­—æŸ¥çœ‹<br>pythonçš„å˜é‡å®šä¹‰<br>pythonçš„æ•°æ®ç±»å‹ï¼ˆNumber String List Tuple Set Dictï¼‰<br>pythonçš„æ³¨é‡Šï¼ˆå•è¡Œå’Œæ®µè½ï¼‰<br>pythonçš„è¾“å…¥è¾“å‡ºï¼ˆprint å’Œ inputï¼‰<br>pythonæ•°æ®ç±»å‹è½¬æ¢/å¸¸ç”¨æ•°å€¼è¿ç®—/ç±»å‹åˆ¤æ–­<br>pythonçš„é›†åˆï¼Œåˆ—è¡¨ï¼Œå…ƒç»„ï¼Œå­—å…¸<br>pythonçš„æµç¨‹æ§åˆ¶forå’Œwhileå’Œifï¼ˆbreakï¼Œ continueï¼Œ passï¼‰<br>pythonçš„åˆ‡ç‰‡<br>pythonçš„ä»£ç ç¼©è¿›ï¼ˆæ¢è¡Œï¼Œæ®µè½ï¼‰<br>pythonå‡½æ•°ï¼ˆè‡ªå®šä¹‰å‡½æ•°ï¼Œå¸¸ç”¨å†…ç½®æ¨¡å—ï¼Œå¸¸ç”¨å‡½æ•°ï¼Œå‡½æ•°è°ƒç”¨ï¼‰<br>pythonå¼‚å¸¸<br>pythonæ¨¡å—ï¼ˆå†…ç½®æ¨¡å—ï¼Œå¯¼å…¥æ¨¡å—ï¼Œè‡ªå®šä¹‰æ¨¡å—ï¼‰<br>pythonè¿­ä»£å™¨å’Œç”Ÿæˆå™¨<br>pythoné¢å‘å¯¹è±¡<br>pythonè¯»å†™æ–‡ä»¶IO<br>pythonæ•°æ®åº“å’ŒJSONå’ŒCSV</p><h4 id="3-1-åŸºæœ¬è¯­æ³•è®°å½•"><a href="#3-1-åŸºæœ¬è¯­æ³•è®°å½•" class="headerlink" title="3.1 åŸºæœ¬è¯­æ³•è®°å½•"></a>3.1 åŸºæœ¬è¯­æ³•è®°å½•</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŒæ—¶éå†2ä¸ªé•¿åº¦ç›¸åŒçš„ list</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(companys)):</span><br><span class="line">    print(companys[i] + <span class="string">","</span> + fincs[i])</span><br><span class="line">    </span><br><span class="line">jobs <span class="comment"># å·¥ä½œå²—ä½</span></span><br><span class="line">companys <span class="comment">#å…¬å¸å</span></span><br><span class="line">m</span><br><span class="line">moneys <span class="comment"># è–ªèµ„</span></span><br><span class="line">edus <span class="comment"># å­¦å†</span></span><br><span class="line">exps <span class="comment"># ç»éªŒ</span></span><br><span class="line">cmptypes <span class="comment"># å…¬å¸ç±»å‹</span></span><br><span class="line">fincs  <span class="comment"># èèµ„çŠ¶æ€</span></span><br><span class="line">true_tags <span class="comment">#job æ ‡ç­¾</span></span><br><span class="line">c_b_s  <span class="comment"># å…¬å¸ä¼˜åŠ¿</span></span><br></pre></td></tr></table></figure><h2 id="4-æœç´¢å¼•æ“åŸºæœ¬å·¥ä½œåŸç†"><a href="#4-æœç´¢å¼•æ“åŸºæœ¬å·¥ä½œåŸç†" class="headerlink" title="4.æœç´¢å¼•æ“åŸºæœ¬å·¥ä½œåŸç†"></a>4.æœç´¢å¼•æ“åŸºæœ¬å·¥ä½œåŸç†</h2><p><img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-06-023330.png" alt="image-20180706103329915"></p><p>5.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-æ•°æ®æ¥æº&quot;&gt;&lt;a href=&quot;#1-æ•°æ®æ¥æº&quot; class=&quot;headerlink&quot; title=&quot;1.æ•°æ®æ¥æº&quot;&gt;&lt;/a&gt;1.æ•°æ®æ¥æº&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ä¸šåŠ¡åº“&lt;/li&gt;
&lt;li&gt;æ—¥å¿—æ•°æ®&lt;/li&gt;
&lt;li&gt;å…¬å…±æ•°æ®&lt;/li&gt;
&lt;li&gt;è´­ä¹° â€“ å€’å–
      
    
    </summary>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/categories/Hadoop/"/>
    
      <category term="çˆ¬è™«" scheme="https://airpoet.github.io/categories/Hadoop/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="åŸåˆ›" scheme="https://airpoet.github.io/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Hadoop" scheme="https://airpoet.github.io/tags/Hadoop/"/>
    
      <category term="çˆ¬è™«" scheme="https://airpoet.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>CentOS6.xä¸‹Python3çš„å®‰è£…</title>
    <link href="https://airpoet.github.io/2018/07/05/Python/CentOS6.x%E4%B8%8BPython3%E7%9A%84%E5%AE%89%E8%A3%85/"/>
    <id>https://airpoet.github.io/2018/07/05/Python/CentOS6.xä¸‹Python3çš„å®‰è£…/</id>
    <published>2018-07-05T06:03:43.250Z</published>
    <updated>2018-07-05T06:06:10.115Z</updated>
    
    <content type="html"><![CDATA[<h3 id="python-3-6-4åœ¨centos-6-7å®‰è£…ï¼š"><a href="#python-3-6-4åœ¨centos-6-7å®‰è£…ï¼š" class="headerlink" title="python-3.6.4åœ¨centos-6.7å®‰è£…ï¼š"></a><strong>python-3.6.4åœ¨centos-6.7å®‰è£…ï¼š</strong></h3><blockquote><p>è¯¦ç»†æ­¥éª¤ï¼š</p></blockquote><p><strong>1ã€å®‰è£…ä¸€äº›ä¾èµ–çš„è½¯ä»¶åŒ…</strong><br>yum -y groupinstall â€œDevelopment toolsâ€<br>yum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel<br>yum -y install yum-plugin-remove-with-leaves</p><p><strong>2ã€ä¸‹è½½Python3.6çš„æºç åŒ…å¹¶ç¼–è¯‘ï¼ˆåœ¨/usr/localç›®å½•ä¸‹ï¼‰</strong><br>wget <a href="https://www.python.org/ftp/python/3.6.4/Python-3.6.4.tgz" target="_blank" rel="noopener">https://www.python.org/ftp/python/3.6.4/Python-3.6.4.tgz</a><br>tar -vxf Python-3.6.4.tgz -C ~/apps<br>cd Python-3.6.4<br>mkdir /usr/local/python3<br>./configure â€“prefix=/usr/local/python3 â€“enable-shared â€“enable-optimizations<br>make<br>make install</p><p><strong>3ã€æŠŠæ–°å®‰è£…çš„python3.6æ‹·è´åˆ°/usr/bin/ç›®å½•ä¸‹</strong><br>cp /usr/local/python3/bin/python3.6 /usr/bin/python3.6<br>ç„¶åæ–°å»ºå¿«æ·æ–¹å¼ï¼š<br>ln -s /usr/bin/python3.6 /usr/bin/python3</p><p><strong>4ã€ä¸€æ­¥æ“ä½œï¼š</strong><br>echo /usr/local/python3/lib/ &gt;&gt; /etc/ld.so.conf.d/local.conf<br>ldconfig</p><p><strong>5ã€éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ</strong><br>/usr/bin/python3 â€“version</p><p><strong>6ã€é…ç½®ç¯å¢ƒå˜é‡</strong><br>vim /etc/profile<br>export PYTHON_HOME=/usr/local/python3<br>export PATH=$PATH:$PYTHON_HOME/bin<br>source /etc/profile</p><p><strong>7ã€å°è¯•å®‰è£…ä¸€ä¸ªæ¨¡å—</strong><br>pip3 install beautifulsoup4</p><p><strong>8ã€ä¿®æ”¹pipæºï¼š</strong><br>mkdir ~/.pip<br>cd ~/.pip<br>vi pip.conf<br>[global]<br>trusted-host =  pypi.douban.com<br>index-url = <a href="http://pypi.douban.com/simple" target="_blank" rel="noopener">http://pypi.douban.com/simple</a></p><p><strong>9ã€å®‰è£…numpy</strong><br>pip3 install numpy</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;python-3-6-4åœ¨centos-6-7å®‰è£…ï¼š&quot;&gt;&lt;a href=&quot;#python-3-6-4åœ¨centos-6-7å®‰è£…ï¼š&quot; class=&quot;headerlink&quot; title=&quot;python-3.6.4åœ¨centos-6.7å®‰è£…ï¼š&quot;&gt;&lt;/a&gt;&lt;strong&gt;
      
    
    </summary>
    
      <category term="Python" scheme="https://airpoet.github.io/categories/Python/"/>
    
    
      <category term="åŸåˆ›" scheme="https://airpoet.github.io/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Python" scheme="https://airpoet.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>é¢å‘å¯¹è±¡æ€æƒ³</title>
    <link href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E6%80%9D%E6%83%B3/"/>
    <id>https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/é¢å‘å¯¹è±¡æ€æƒ³/</id>
    <published>2018-07-04T13:51:06.371Z</published>
    <updated>2018-07-09T07:05:30.312Z</updated>
    
    <content type="html"><![CDATA[<!-- GFM-TOC --><ul><li><a href="#ä¸€ä¸‰å¤§ç‰¹æ€§">ä¸€ã€ä¸‰å¤§ç‰¹æ€§</a><ul><li><a href="#å°è£…">å°è£…</a></li><li><a href="#ç»§æ‰¿">ç»§æ‰¿</a></li><li><a href="#å¤šæ€">å¤šæ€</a></li></ul></li><li><a href="#äºŒç±»å›¾">äºŒã€ç±»å›¾</a><ul><li><a href="#æ³›åŒ–å…³ç³»-generalization">æ³›åŒ–å…³ç³» (Generalization)</a></li><li><a href="#å®ç°å…³ç³»-realization">å®ç°å…³ç³» (Realization)</a></li><li><a href="#èšåˆå…³ç³»-aggregation">èšåˆå…³ç³» (Aggregation)</a></li><li><a href="#ç»„åˆå…³ç³»-composition">ç»„åˆå…³ç³» (Composition)</a></li><li><a href="#å…³è”å…³ç³»-association">å…³è”å…³ç³» (Association)</a></li><li><a href="#ä¾èµ–å…³ç³»-dependency">ä¾èµ–å…³ç³» (Dependency)</a></li></ul></li><li><a href="#ä¸‰è®¾è®¡åŸåˆ™">ä¸‰ã€è®¾è®¡åŸåˆ™</a><ul><li><a href="#solid">S.O.L.I.D</a></li><li><a href="#å…¶ä»–å¸¸è§åŸåˆ™">å…¶ä»–å¸¸è§åŸåˆ™</a></li></ul></li><li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a><!-- GFM-TOC --></li></ul><h1 id="ä¸€ã€ä¸‰å¤§ç‰¹æ€§"><a href="#ä¸€ã€ä¸‰å¤§ç‰¹æ€§" class="headerlink" title="ä¸€ã€ä¸‰å¤§ç‰¹æ€§"></a>ä¸€ã€ä¸‰å¤§ç‰¹æ€§</h1><h2 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h2><p>åˆ©ç”¨æŠ½è±¡æ•°æ®ç±»å‹å°†æ•°æ®å’ŒåŸºäºæ•°æ®çš„æ“ä½œå°è£…åœ¨ä¸€èµ·ï¼Œä½¿å…¶æ„æˆä¸€ä¸ªä¸å¯åˆ†å‰²çš„ç‹¬ç«‹å®ä½“ã€‚æ•°æ®è¢«ä¿æŠ¤åœ¨æŠ½è±¡æ•°æ®ç±»å‹çš„å†…éƒ¨ï¼Œå°½å¯èƒ½åœ°éšè—å†…éƒ¨çš„ç»†èŠ‚ï¼Œåªä¿ç•™ä¸€äº›å¯¹å¤–æ¥å£ä½¿ä¹‹ä¸å¤–éƒ¨å‘ç”Ÿè”ç³»ã€‚ç”¨æˆ·æ— éœ€çŸ¥é“å¯¹è±¡å†…éƒ¨çš„ç»†èŠ‚ï¼Œä½†å¯ä»¥é€šè¿‡å¯¹è±¡å¯¹å¤–æä¾›çš„æ¥å£æ¥è®¿é—®è¯¥å¯¹è±¡ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>å‡å°‘è€¦åˆï¼šå¯ä»¥ç‹¬ç«‹åœ°å¼€å‘ã€æµ‹è¯•ã€ä¼˜åŒ–ã€ä½¿ç”¨ã€ç†è§£å’Œä¿®æ”¹</li><li>å‡è½»ç»´æŠ¤çš„è´Ÿæ‹…ï¼šå¯ä»¥æ›´å®¹æ˜“è¢«ç¨‹åºå‘˜ç†è§£ï¼Œå¹¶ä¸”åœ¨è°ƒè¯•çš„æ—¶å€™å¯ä»¥ä¸å½±å“å…¶ä»–æ¨¡å—</li><li>æœ‰æ•ˆåœ°è°ƒèŠ‚æ€§èƒ½ï¼šå¯ä»¥é€šè¿‡å‰–æç¡®å®šå“ªäº›æ¨¡å—å½±å“äº†ç³»ç»Ÿçš„æ€§èƒ½</li><li>æé«˜è½¯ä»¶çš„å¯é‡ç”¨æ€§</li><li>é™ä½äº†æ„å»ºå¤§å‹ç³»ç»Ÿçš„é£é™©ï¼šå³ä½¿æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ï¼Œä½†æ˜¯è¿™äº›ç‹¬ç«‹çš„æ¨¡å—å´æœ‰å¯èƒ½æ˜¯å¯ç”¨çš„</li></ul><p>ä»¥ä¸‹ Person ç±»å°è£… nameã€genderã€age ç­‰å±æ€§ï¼Œå¤–ç•Œåªèƒ½é€šè¿‡ get() æ–¹æ³•è·å–ä¸€ä¸ª Person å¯¹è±¡çš„ name å±æ€§å’Œ gender å±æ€§ï¼Œè€Œæ— æ³•è·å– age å±æ€§ï¼Œä½†æ˜¯ age å±æ€§å¯ä»¥ä¾› work() æ–¹æ³•ä½¿ç”¨ã€‚</p><p>æ³¨æ„åˆ° gender å±æ€§ä½¿ç”¨ int æ•°æ®ç±»å‹è¿›è¡Œå­˜å‚¨ï¼Œå°è£…ä½¿å¾—ç”¨æˆ·æ³¨æ„ä¸åˆ°è¿™ç§å®ç°ç»†èŠ‚ã€‚å¹¶ä¸”åœ¨éœ€è¦ä¿®æ”¹ gender å±æ€§ä½¿ç”¨çš„æ•°æ®ç±»å‹æ—¶ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸å½±å“å®¢æˆ·ç«¯ä»£ç çš„æƒ…å†µä¸‹è¿›è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> gender;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getGender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> gender == <span class="number">0</span> ? <span class="string">"man"</span> : <span class="string">"woman"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">18</span> &lt;= age &amp;&amp; age &lt;= <span class="number">50</span>) &#123;</span><br><span class="line">            System.out.println(name + <span class="string">" is working very hard!"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(name + <span class="string">" can't work any more!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><p>ç»§æ‰¿å®ç°äº†  <strong>IS-A</strong>  å…³ç³»ï¼Œä¾‹å¦‚ Cat å’Œ Animal å°±æ˜¯ä¸€ç§ IS-A å…³ç³»ï¼Œå› æ­¤ Cat å¯ä»¥ç»§æ‰¿è‡ª Animalï¼Œä»è€Œè·å¾— Animal é private çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><p>Cat å¯ä»¥å½“åš Animal æ¥ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä½¿ç”¨ Animal å¼•ç”¨ Cat å¯¹è±¡ã€‚çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ç§°ä¸º  <strong>å‘ä¸Šè½¬å‹</strong> ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Animal animal = <span class="keyword">new</span> Cat();</span><br></pre></td></tr></table></figure><p>ç»§æ‰¿åº”è¯¥éµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œå­ç±»å¯¹è±¡å¿…é¡»èƒ½å¤Ÿæ›¿æ¢æ‰æ‰€æœ‰çˆ¶ç±»å¯¹è±¡ã€‚</p><h2 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h2><p>å¤šæ€åˆ†ä¸ºç¼–è¯‘æ—¶å¤šæ€å’Œè¿è¡Œæ—¶å¤šæ€ã€‚ç¼–è¯‘æ—¶å¤šæ€ä¸»è¦æŒ‡æ–¹æ³•çš„é‡è½½ï¼Œè¿è¡Œæ—¶å¤šæ€æŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¯¹è±¡å¼•ç”¨æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹åœ¨è¿è¡ŒæœŸé—´æ‰ç¡®å®šã€‚</p><p>è¿è¡Œæ—¶å¤šæ€æœ‰ä¸‰ä¸ªæ¡ä»¶ï¼š</p><ul><li>ç»§æ‰¿</li><li>è¦†ç›–ï¼ˆé‡å†™ï¼‰</li><li>å‘ä¸Šè½¬å‹</li></ul><p>ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä¹å™¨ç±»ï¼ˆInstrumentï¼‰æœ‰ä¸¤ä¸ªå­ç±»ï¼šWind å’Œ Percussionï¼Œå®ƒä»¬éƒ½è¦†ç›–äº†çˆ¶ç±»çš„ play() æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ main() æ–¹æ³•ä¸­ä½¿ç”¨çˆ¶ç±» Instrument æ¥å¼•ç”¨ Wind å’Œ Percussion å¯¹è±¡ã€‚åœ¨ Instrument å¼•ç”¨è°ƒç”¨ play() æ–¹æ³•æ—¶ï¼Œä¼šæ‰§è¡Œå®é™…å¼•ç”¨å¯¹è±¡æ‰€åœ¨ç±»çš„ play() æ–¹æ³•ï¼Œè€Œä¸æ˜¯ Instrument ç±»çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Instrument</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Instument is playing..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Wind</span> <span class="keyword">extends</span> <span class="title">Instrument</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Wind is playing..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Percussion</span> <span class="keyword">extends</span> <span class="title">Instrument</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Percussion is playing..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Music</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;Instrument&gt; instruments = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        instruments.add(<span class="keyword">new</span> Wind());</span><br><span class="line">        instruments.add(<span class="keyword">new</span> Percussion());</span><br><span class="line">        <span class="keyword">for</span>(Instrument instrument : instruments) &#123;</span><br><span class="line">            instrument.play();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="äºŒã€ç±»å›¾"><a href="#äºŒã€ç±»å›¾" class="headerlink" title="äºŒã€ç±»å›¾"></a>äºŒã€ç±»å›¾</h1><p>ä»¥ä¸‹ç±»å›¾ä½¿ç”¨ <a href="https://www.planttext.com/" target="_blank" rel="noopener">PlantUML</a> ç»˜åˆ¶ï¼Œæ›´å¤šè¯­æ³•åŠä½¿ç”¨è¯·å‚è€ƒï¼š<a href="http://plantuml.com/" target="_blank" rel="noopener">http://plantuml.com/</a></p><h2 id="æ³›åŒ–å…³ç³»-Generalization"><a href="#æ³›åŒ–å…³ç³»-Generalization" class="headerlink" title="æ³›åŒ–å…³ç³» (Generalization)"></a>æ³›åŒ–å…³ç³» (Generalization)</h2><p>ç”¨æ¥æè¿°ç»§æ‰¿å…³ç³»ï¼Œåœ¨ Java ä¸­ä½¿ç”¨ extends å…³é”®å­—ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061030.png"> </div><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@startuml</span><br><span class="line"></span><br><span class="line">title Generalization</span><br><span class="line"></span><br><span class="line">class Vihical</span><br><span class="line">class Car</span><br><span class="line">class Trunck</span><br><span class="line"></span><br><span class="line">Vihical &lt;|-- Car</span><br><span class="line">Vihical &lt;|-- Trunck</span><br><span class="line"></span><br><span class="line">@enduml</span><br></pre></td></tr></table></figure><h2 id="å®ç°å…³ç³»-Realization"><a href="#å®ç°å…³ç³»-Realization" class="headerlink" title="å®ç°å…³ç³» (Realization)"></a>å®ç°å…³ç³» (Realization)</h2><p>ç”¨æ¥å®ç°ä¸€ä¸ªæ¥å£ï¼Œåœ¨ Java ä¸­ä½¿ç”¨ implement å…³é”®å­—ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061039.png"> </div><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@startuml</span><br><span class="line"></span><br><span class="line">title Realization</span><br><span class="line"></span><br><span class="line">interface MoveBehavior</span><br><span class="line">class Fly</span><br><span class="line">class Run</span><br><span class="line"></span><br><span class="line">MoveBehavior &lt;|.. Fly</span><br><span class="line">MoveBehavior &lt;|.. Run</span><br><span class="line"></span><br><span class="line">@enduml</span><br></pre></td></tr></table></figure><h2 id="èšåˆå…³ç³»-Aggregation"><a href="#èšåˆå…³ç³»-Aggregation" class="headerlink" title="èšåˆå…³ç³» (Aggregation)"></a>èšåˆå…³ç³» (Aggregation)</h2><p>è¡¨ç¤ºæ•´ä½“ç”±éƒ¨åˆ†ç»„æˆï¼Œä½†æ˜¯æ•´ä½“å’Œéƒ¨åˆ†ä¸æ˜¯å¼ºä¾èµ–çš„ï¼Œæ•´ä½“ä¸å­˜åœ¨äº†éƒ¨åˆ†è¿˜æ˜¯ä¼šå­˜åœ¨ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061043.png"> </div><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@startuml</span><br><span class="line"></span><br><span class="line">title Aggregation</span><br><span class="line"></span><br><span class="line">class Computer</span><br><span class="line">class Keyboard</span><br><span class="line">class Mouse</span><br><span class="line">class Screen</span><br><span class="line"></span><br><span class="line">Computer o-- Keyboard</span><br><span class="line">Computer o-- Mouse</span><br><span class="line">Computer o-- Screen</span><br><span class="line"></span><br><span class="line">@enduml</span><br></pre></td></tr></table></figure><h2 id="ç»„åˆå…³ç³»-Composition"><a href="#ç»„åˆå…³ç³»-Composition" class="headerlink" title="ç»„åˆå…³ç³» (Composition)"></a>ç»„åˆå…³ç³» (Composition)</h2><p>å’Œèšåˆä¸åŒï¼Œç»„åˆä¸­æ•´ä½“å’Œéƒ¨åˆ†æ˜¯å¼ºä¾èµ–çš„ï¼Œæ•´ä½“ä¸å­˜åœ¨äº†éƒ¨åˆ†ä¹Ÿä¸å­˜åœ¨äº†ã€‚æ¯”å¦‚å…¬å¸å’Œéƒ¨é—¨ï¼Œå…¬å¸æ²¡äº†éƒ¨é—¨å°±ä¸å­˜åœ¨äº†ã€‚ä½†æ˜¯å…¬å¸å’Œå‘˜å·¥å°±å±äºèšåˆå…³ç³»äº†ï¼Œå› ä¸ºå…¬å¸æ²¡äº†å‘˜å·¥è¿˜åœ¨ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061053.png"> </div><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@startuml</span><br><span class="line"></span><br><span class="line">title Composition</span><br><span class="line"></span><br><span class="line">class Company</span><br><span class="line">class DepartmentA</span><br><span class="line">class DepartmentB</span><br><span class="line"></span><br><span class="line">Company *-- DepartmentA</span><br><span class="line">Company *-- DepartmentB</span><br><span class="line"></span><br><span class="line">@enduml</span><br></pre></td></tr></table></figure><h2 id="å…³è”å…³ç³»-Association"><a href="#å…³è”å…³ç³»-Association" class="headerlink" title="å…³è”å…³ç³» (Association)"></a>å…³è”å…³ç³» (Association)</h2><p>è¡¨ç¤ºä¸åŒç±»å¯¹è±¡ä¹‹é—´æœ‰å…³è”ï¼Œè¿™æ˜¯ä¸€ç§é™æ€å…³ç³»ï¼Œä¸è¿è¡Œè¿‡ç¨‹çš„çŠ¶æ€æ— å…³ï¼Œåœ¨æœ€å¼€å§‹å°±å¯ä»¥ç¡®å®šã€‚å› æ­¤ä¹Ÿå¯ä»¥ç”¨ 1 å¯¹ 1ã€å¤šå¯¹ 1ã€å¤šå¯¹å¤šè¿™ç§å…³è”å…³ç³»æ¥è¡¨ç¤ºã€‚æ¯”å¦‚å­¦ç”Ÿå’Œå­¦æ ¡å°±æ˜¯ä¸€ç§å…³è”å…³ç³»ï¼Œä¸€ä¸ªå­¦æ ¡å¯ä»¥æœ‰å¾ˆå¤šå­¦ç”Ÿï¼Œä½†æ˜¯ä¸€ä¸ªå­¦ç”Ÿåªå±äºä¸€ä¸ªå­¦æ ¡ï¼Œå› æ­¤è¿™æ˜¯ä¸€ç§å¤šå¯¹ä¸€çš„å…³ç³»ï¼Œåœ¨è¿è¡Œå¼€å§‹ä¹‹å‰å°±å¯ä»¥ç¡®å®šã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061058.png"> </div><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@startuml</span><br><span class="line"></span><br><span class="line">title Association</span><br><span class="line"></span><br><span class="line">class School</span><br><span class="line">class Student</span><br><span class="line"></span><br><span class="line">School &quot;1&quot; - &quot;n&quot; Student</span><br><span class="line"></span><br><span class="line">@enduml</span><br></pre></td></tr></table></figure><h2 id="ä¾èµ–å…³ç³»-Dependency"><a href="#ä¾èµ–å…³ç³»-Dependency" class="headerlink" title="ä¾èµ–å…³ç³» (Dependency)"></a>ä¾èµ–å…³ç³» (Dependency)</h2><p>å’Œå…³è”å…³ç³»ä¸åŒçš„æ˜¯ï¼Œä¾èµ–å…³ç³»æ˜¯åœ¨è¿è¡Œè¿‡ç¨‹ä¸­èµ·ä½œç”¨çš„ã€‚A ç±»å’Œ B ç±»æ˜¯ä¾èµ–å…³ç³»ä¸»è¦æœ‰ä¸‰ç§å½¢å¼ï¼š</p><ul><li>A ç±»æ˜¯ B ç±»ä¸­çš„ï¼ˆæŸä¸­æ–¹æ³•çš„ï¼‰å±€éƒ¨å˜é‡ï¼›</li><li>A ç±»æ˜¯ B ç±»æ–¹æ³•å½“ä¸­çš„ä¸€ä¸ªå‚æ•°ï¼›</li><li>A ç±»å‘ B ç±»å‘é€æ¶ˆæ¯ï¼Œä»è€Œå½±å“ B ç±»å‘ç”Ÿå˜åŒ–ï¼›</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061101.png"> </div><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@startuml</span><br><span class="line"></span><br><span class="line">title Dependency</span><br><span class="line"></span><br><span class="line">class Vihicle &#123;</span><br><span class="line">    move(MoveBehavior)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface MoveBehavior &#123;</span><br><span class="line">    move()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">note &quot;MoveBehavior.move()&quot; as N</span><br><span class="line"></span><br><span class="line">Vihicle ..&gt; MoveBehavior</span><br><span class="line"></span><br><span class="line">Vihicle .. N</span><br><span class="line"></span><br><span class="line">@enduml</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€è®¾è®¡åŸåˆ™"><a href="#ä¸‰ã€è®¾è®¡åŸåˆ™" class="headerlink" title="ä¸‰ã€è®¾è®¡åŸåˆ™"></a>ä¸‰ã€è®¾è®¡åŸåˆ™</h1><h2 id="S-O-L-I-D"><a href="#S-O-L-I-D" class="headerlink" title="S.O.L.I.D"></a>S.O.L.I.D</h2><table><thead><tr><th style="text-align:center">ç®€å†™</th><th style="text-align:center">å…¨æ‹¼</th><th style="text-align:center">ä¸­æ–‡ç¿»è¯‘</th></tr></thead><tbody><tr><td style="text-align:center">SRP</td><td style="text-align:center">The Single Responsibility Principle</td><td style="text-align:center">å•ä¸€è´£ä»»åŸåˆ™</td></tr><tr><td style="text-align:center">OCP</td><td style="text-align:center">The Open Closed Principle</td><td style="text-align:center">å¼€æ”¾å°é—­åŸåˆ™</td></tr><tr><td style="text-align:center">LSP</td><td style="text-align:center">The Liskov Substitution Principle</td><td style="text-align:center">é‡Œæ°æ›¿æ¢åŸåˆ™</td></tr><tr><td style="text-align:center">ISP</td><td style="text-align:center">The Interface Segregation Principle</td><td style="text-align:center">æ¥å£åˆ†ç¦»åŸåˆ™</td></tr><tr><td style="text-align:center">DIP</td><td style="text-align:center">The Dependency Inversion Principle</td><td style="text-align:center">ä¾èµ–å€’ç½®åŸåˆ™</td></tr></tbody></table><h3 id="1-å•ä¸€è´£ä»»åŸåˆ™"><a href="#1-å•ä¸€è´£ä»»åŸåˆ™" class="headerlink" title="1. å•ä¸€è´£ä»»åŸåˆ™"></a>1. å•ä¸€è´£ä»»åŸåˆ™</h3><blockquote><p>ä¿®æ”¹ä¸€ä¸ªç±»çš„åŸå› åº”è¯¥åªæœ‰ä¸€ä¸ªã€‚</p></blockquote><p>æ¢å¥è¯è¯´å°±æ˜¯è®©ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä»¶äº‹ï¼Œå½“è¿™ä¸ªç±»éœ€è¦åšè¿‡å¤šäº‹æƒ…çš„æ—¶å€™ï¼Œå°±éœ€è¦åˆ†è§£è¿™ä¸ªç±»ã€‚</p><p>å¦‚æœä¸€ä¸ªç±»æ‰¿æ‹…çš„èŒè´£è¿‡å¤šï¼Œå°±ç­‰äºæŠŠè¿™äº›èŒè´£è€¦åˆåœ¨äº†ä¸€èµ·ï¼Œä¸€ä¸ªèŒè´£çš„å˜åŒ–å¯èƒ½ä¼šå‰Šå¼±è¿™ä¸ªç±»å®Œæˆå…¶å®ƒèŒè´£çš„èƒ½åŠ›ã€‚</p><h3 id="2-å¼€æ”¾å°é—­åŸåˆ™"><a href="#2-å¼€æ”¾å°é—­åŸåˆ™" class="headerlink" title="2. å¼€æ”¾å°é—­åŸåˆ™"></a>2. å¼€æ”¾å°é—­åŸåˆ™</h3><blockquote><p>ç±»åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</p></blockquote><p>æ‰©å±•å°±æ˜¯æ·»åŠ æ–°åŠŸèƒ½çš„æ„æ€ï¼Œå› æ­¤è¯¥åŸåˆ™è¦æ±‚åœ¨æ·»åŠ æ–°åŠŸèƒ½æ—¶ä¸éœ€è¦ä¿®æ”¹ä»£ç ã€‚</p><p>ç¬¦åˆå¼€é—­åŸåˆ™æœ€å…¸å‹çš„è®¾è®¡æ¨¡å¼æ˜¯è£…é¥°è€…æ¨¡å¼ï¼Œå®ƒå¯ä»¥åŠ¨æ€åœ°å°†è´£ä»»é™„åŠ åˆ°å¯¹è±¡ä¸Šï¼Œè€Œä¸ç”¨å»ä¿®æ”¹ç±»çš„ä»£ç ã€‚</p><h3 id="3-é‡Œæ°æ›¿æ¢åŸåˆ™"><a href="#3-é‡Œæ°æ›¿æ¢åŸåˆ™" class="headerlink" title="3. é‡Œæ°æ›¿æ¢åŸåˆ™"></a>3. é‡Œæ°æ›¿æ¢åŸåˆ™</h3><blockquote><p>å­ç±»å¯¹è±¡å¿…é¡»èƒ½å¤Ÿæ›¿æ¢æ‰æ‰€æœ‰çˆ¶ç±»å¯¹è±¡ã€‚</p></blockquote><p>ç»§æ‰¿æ˜¯ä¸€ç§ IS-A å…³ç³»ï¼Œå­ç±»éœ€è¦èƒ½å¤Ÿå½“æˆçˆ¶ç±»æ¥ä½¿ç”¨ï¼Œå¹¶ä¸”éœ€è¦æ¯”çˆ¶ç±»æ›´ç‰¹æ®Šã€‚</p><p>å¦‚æœä¸æ»¡è¶³è¿™ä¸ªåŸåˆ™ï¼Œé‚£ä¹ˆå„ä¸ªå­ç±»çš„è¡Œä¸ºä¸Šå°±ä¼šæœ‰å¾ˆå¤§å·®å¼‚ï¼Œå¢åŠ ç»§æ‰¿ä½“ç³»çš„å¤æ‚åº¦ã€‚</p><h3 id="4-æ¥å£åˆ†ç¦»åŸåˆ™"><a href="#4-æ¥å£åˆ†ç¦»åŸåˆ™" class="headerlink" title="4. æ¥å£åˆ†ç¦»åŸåˆ™"></a>4. æ¥å£åˆ†ç¦»åŸåˆ™</h3><blockquote><p>ä¸åº”è¯¥å¼ºè¿«å®¢æˆ·ä¾èµ–äºå®ƒä»¬ä¸ç”¨çš„æ–¹æ³•ã€‚</p></blockquote><p>å› æ­¤ä½¿ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£æ¯”ä½¿ç”¨å•ä¸€çš„æ€»æ¥å£è¦å¥½ã€‚</p><h3 id="5-ä¾èµ–å€’ç½®åŸåˆ™"><a href="#5-ä¾èµ–å€’ç½®åŸåˆ™" class="headerlink" title="5. ä¾èµ–å€’ç½®åŸåˆ™"></a>5. ä¾èµ–å€’ç½®åŸåˆ™</h3><blockquote><p>é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ï¼›<br>æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</p></blockquote><p>é«˜å±‚æ¨¡å—åŒ…å«ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­é‡è¦çš„ç­–ç•¥é€‰æ‹©å’Œä¸šåŠ¡æ¨¡å—ï¼Œå¦‚æœé«˜å±‚æ¨¡å—ä¾èµ–äºä½å±‚æ¨¡å—ï¼Œé‚£ä¹ˆä½å±‚æ¨¡å—çš„æ”¹åŠ¨å°±ä¼šç›´æ¥å½±å“åˆ°é«˜å±‚æ¨¡å—ï¼Œä»è€Œè¿«ä½¿é«˜å±‚æ¨¡å—ä¹Ÿéœ€è¦æ”¹åŠ¨ã€‚</p><p>ä¾èµ–äºæŠ½è±¡æ„å‘³ç€ï¼š</p><ul><li>ä»»ä½•å˜é‡éƒ½ä¸åº”è¯¥æŒæœ‰ä¸€ä¸ªæŒ‡å‘å…·ä½“ç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼›</li><li>ä»»ä½•ç±»éƒ½ä¸åº”è¯¥ä»å…·ä½“ç±»æ´¾ç”Ÿï¼›</li><li>ä»»ä½•æ–¹æ³•éƒ½ä¸åº”è¯¥è¦†å†™å®ƒçš„ä»»ä½•åŸºç±»ä¸­çš„å·²ç»å®ç°çš„æ–¹æ³•ã€‚</li></ul><h2 id="å…¶ä»–å¸¸è§åŸåˆ™"><a href="#å…¶ä»–å¸¸è§åŸåˆ™" class="headerlink" title="å…¶ä»–å¸¸è§åŸåˆ™"></a>å…¶ä»–å¸¸è§åŸåˆ™</h2><p>é™¤äº†ä¸Šè¿°çš„ç»å…¸åŸåˆ™ï¼Œåœ¨å®é™…å¼€å‘ä¸­è¿˜æœ‰ä¸‹é¢è¿™äº›å¸¸è§çš„è®¾è®¡åŸåˆ™ã€‚</p><table><thead><tr><th style="text-align:center">ç®€å†™</th><th style="text-align:center">å…¨æ‹¼</th><th style="text-align:center">ä¸­æ–‡ç¿»è¯‘</th></tr></thead><tbody><tr><td style="text-align:center">LOD</td><td style="text-align:center">The Law of Demeter</td><td style="text-align:center">è¿ªç±³ç‰¹æ³•åˆ™</td></tr><tr><td style="text-align:center">CRP</td><td style="text-align:center">The Composite Reuse Principle</td><td style="text-align:center">åˆæˆå¤ç”¨åŸåˆ™</td></tr><tr><td style="text-align:center">CCP</td><td style="text-align:center">The Common Closure Principle</td><td style="text-align:center">å…±åŒå°é—­åŸåˆ™</td></tr><tr><td style="text-align:center">SAP</td><td style="text-align:center">The Stable Abstractions Principle</td><td style="text-align:center">ç¨³å®šæŠ½è±¡åŸåˆ™</td></tr><tr><td style="text-align:center">SDP</td><td style="text-align:center">The Stable Dependencies Principle</td><td style="text-align:center">ç¨³å®šä¾èµ–åŸåˆ™</td></tr></tbody></table><h3 id="1-è¿ªç±³ç‰¹æ³•åˆ™"><a href="#1-è¿ªç±³ç‰¹æ³•åˆ™" class="headerlink" title="1. è¿ªç±³ç‰¹æ³•åˆ™"></a>1. è¿ªç±³ç‰¹æ³•åˆ™</h3><p>è¿ªç±³ç‰¹æ³•åˆ™åˆå«ä½œæœ€å°‘çŸ¥è¯†åŸåˆ™ï¼ˆLeast Knowledge Principleï¼Œç®€å†™ LKPï¼‰ï¼Œå°±æ˜¯è¯´ä¸€ä¸ªå¯¹è±¡åº”å½“å¯¹å…¶ä»–å¯¹è±¡æœ‰å°½å¯èƒ½å°‘çš„äº†è§£ï¼Œä¸å’Œé™Œç”Ÿäººè¯´è¯ã€‚</p><h3 id="2-åˆæˆå¤ç”¨åŸåˆ™"><a href="#2-åˆæˆå¤ç”¨åŸåˆ™" class="headerlink" title="2. åˆæˆå¤ç”¨åŸåˆ™"></a>2. åˆæˆå¤ç”¨åŸåˆ™</h3><p>å°½é‡ä½¿ç”¨å¯¹è±¡ç»„åˆï¼Œè€Œä¸æ˜¯ç»§æ‰¿æ¥è¾¾åˆ°å¤ç”¨çš„ç›®çš„ã€‚</p><h3 id="3-å…±åŒå°é—­åŸåˆ™"><a href="#3-å…±åŒå°é—­åŸåˆ™" class="headerlink" title="3. å…±åŒå°é—­åŸåˆ™"></a>3. å…±åŒå°é—­åŸåˆ™</h3><p>ä¸€èµ·ä¿®æ”¹çš„ç±»ï¼Œåº”è¯¥ç»„åˆåœ¨ä¸€èµ·ï¼ˆåŒä¸€ä¸ªåŒ…é‡Œï¼‰ã€‚å¦‚æœå¿…é¡»ä¿®æ”¹åº”ç”¨ç¨‹åºé‡Œçš„ä»£ç ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰€æœ‰çš„ä¿®æ”¹éƒ½å‘ç”Ÿåœ¨ä¸€ä¸ªåŒ…é‡Œï¼ˆä¿®æ”¹å…³é—­ï¼‰ï¼Œè€Œä¸æ˜¯éå¸ƒåœ¨å¾ˆå¤šåŒ…é‡Œã€‚</p><h3 id="4-ç¨³å®šæŠ½è±¡åŸåˆ™"><a href="#4-ç¨³å®šæŠ½è±¡åŸåˆ™" class="headerlink" title="4. ç¨³å®šæŠ½è±¡åŸåˆ™"></a>4. ç¨³å®šæŠ½è±¡åŸåˆ™</h3><p>æœ€ç¨³å®šçš„åŒ…åº”è¯¥æ˜¯æœ€æŠ½è±¡çš„åŒ…ï¼Œä¸ç¨³å®šçš„åŒ…åº”è¯¥æ˜¯å…·ä½“çš„åŒ…ï¼Œå³åŒ…çš„æŠ½è±¡ç¨‹åº¦è·Ÿå®ƒçš„ç¨³å®šæ€§æˆæ­£æ¯”ã€‚</p><h3 id="5-ç¨³å®šä¾èµ–åŸåˆ™"><a href="#5-ç¨³å®šä¾èµ–åŸåˆ™" class="headerlink" title="5. ç¨³å®šä¾èµ–åŸåˆ™"></a>5. ç¨³å®šä¾èµ–åŸåˆ™</h3><p>åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»éƒ½åº”è¯¥æ˜¯ç¨³å®šæ–¹å‘ä¾èµ–çš„ï¼ŒåŒ…è¦ä¾èµ–çš„åŒ…è¦æ¯”è‡ªå·±æ›´å…·æœ‰ç¨³å®šæ€§ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>Java ç¼–ç¨‹æ€æƒ³</li><li>æ•æ·è½¯ä»¶å¼€å‘ï¼šåŸåˆ™ã€æ¨¡å¼ä¸å®è·µ</li><li><a href="http://www.cnblogs.com/shanyou/archive/2009/09/21/1570716.html" target="_blank" rel="noopener">é¢å‘å¯¹è±¡è®¾è®¡çš„ SOLID åŸåˆ™</a></li><li><a href="http://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html#generalization" target="_blank" rel="noopener">çœ‹æ‡‚ UML ç±»å›¾å’Œæ—¶åºå›¾</a></li><li><a href="http://www.cnblogs.com/wolf-sun/p/UML-Sequence-diagram.html" target="_blank" rel="noopener">UML ç³»åˆ—â€”â€”æ—¶åºå›¾ï¼ˆé¡ºåºå›¾ï¼‰sequence diagram</a></li><li><a href="http://blog.csdn.net/jianyuerensheng/article/details/51602015" target="_blank" rel="noopener">é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸‰å¤§ç‰¹æ€§ â€”â€” å°è£…ã€ç»§æ‰¿ã€å¤šæ€</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- GFM-TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸€ä¸‰å¤§ç‰¹æ€§&quot;&gt;ä¸€ã€ä¸‰å¤§ç‰¹æ€§&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#å°è£…&quot;&gt;å°è£…&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ç»§æ‰¿&quot;&gt;ç»§æ‰¿&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#å¤šæ€&quot;&gt;å¤šæ€&lt;/
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Interview-Notebook" scheme="https://airpoet.github.io/categories/Github/Interview-Notebook/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>é‡æ„</title>
    <link href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E9%87%8D%E6%9E%84/"/>
    <id>https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/é‡æ„/</id>
    <published>2018-07-04T13:51:06.369Z</published>
    <updated>2018-07-09T07:07:53.426Z</updated>
    
    <content type="html"><![CDATA[<!-- GFM-TOC --><ul><li><a href="#ä¸€ç¬¬ä¸€ä¸ªæ¡ˆä¾‹">ä¸€ã€ç¬¬ä¸€ä¸ªæ¡ˆä¾‹</a></li><li><a href="#äºŒé‡æ„åŸåˆ™">äºŒã€é‡æ„åŸåˆ™</a><ul><li><a href="#å®šä¹‰">å®šä¹‰</a></li><li><a href="#ä¸ºä½•é‡æ„">ä¸ºä½•é‡æ„</a></li><li><a href="#ä¸‰æ¬¡æ³•åˆ™">ä¸‰æ¬¡æ³•åˆ™</a></li><li><a href="#é—´æ¥å±‚ä¸é‡æ„">é—´æ¥å±‚ä¸é‡æ„</a></li><li><a href="#ä¿®æ”¹æ¥å£">ä¿®æ”¹æ¥å£</a></li><li><a href="#ä½•æ—¶ä¸è¯¥é‡æ„">ä½•æ—¶ä¸è¯¥é‡æ„</a></li><li><a href="#é‡æ„ä¸è®¾è®¡">é‡æ„ä¸è®¾è®¡</a></li><li><a href="#é‡æ„ä¸æ€§èƒ½">é‡æ„ä¸æ€§èƒ½</a></li></ul></li><li><a href="#ä¸‰ä»£ç çš„åå‘³é“">ä¸‰ã€ä»£ç çš„åå‘³é“</a><ul><li><a href="#1-é‡å¤ä»£ç ">1. é‡å¤ä»£ç </a></li><li><a href="#2-è¿‡é•¿å‡½æ•°">2. è¿‡é•¿å‡½æ•°</a></li><li><a href="#3-è¿‡å¤§çš„ç±»">3. è¿‡å¤§çš„ç±»</a></li><li><a href="#4-è¿‡é•¿çš„å‚æ•°åˆ—è¡¨">4. è¿‡é•¿çš„å‚æ•°åˆ—è¡¨</a></li><li><a href="#5-å‘æ•£å¼å˜åŒ–">5. å‘æ•£å¼å˜åŒ–</a></li><li><a href="#6-æ•£å¼¹å¼ä¿®æ”¹">6. æ•£å¼¹å¼ä¿®æ”¹</a></li><li><a href="#7-ä¾æ‹æƒ…ç»“">7. ä¾æ‹æƒ…ç»“</a></li><li><a href="#8-æ•°æ®æ³¥å›¢">8. æ•°æ®æ³¥å›¢</a></li><li><a href="#9-åŸºæœ¬ç±»å‹åæ‰§">9. åŸºæœ¬ç±»å‹åæ‰§</a></li><li><a href="#10-switch-æƒŠæ‚šç°èº«">10. switch æƒŠæ‚šç°èº«</a></li><li><a href="#11-å¹³è¡Œç»§æ‰¿ä½“ç³»">11. å¹³è¡Œç»§æ‰¿ä½“ç³»</a></li><li><a href="#12-å†—ä½™ç±»">12. å†—ä½™ç±»</a></li><li><a href="#13-å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§">13. å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§</a></li><li><a href="#14-ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ">14. ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ</a></li><li><a href="#15-è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾">15. è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾</a></li><li><a href="#16-ä¸­é—´äºº">16. ä¸­é—´äºº</a></li><li><a href="#17-ç‹æ˜µå…³ç³»">17. ç‹æ˜µå…³ç³»</a></li><li><a href="#18-å¼‚æ›²åŒå·¥çš„ç±»">18. å¼‚æ›²åŒå·¥çš„ç±»</a></li><li><a href="#19-ä¸å®Œç¾çš„ç±»åº“">19. ä¸å®Œç¾çš„ç±»åº“</a></li><li><a href="#20-å¹¼ç¨šçš„æ•°æ®ç±»">20. å¹¼ç¨šçš„æ•°æ®ç±»</a></li><li><a href="#21-è¢«æ‹’ç»çš„é¦ˆèµ ">21. è¢«æ‹’ç»çš„é¦ˆèµ </a></li><li><a href="#22-è¿‡å¤šçš„æ³¨é‡Š">22. è¿‡å¤šçš„æ³¨é‡Š</a></li></ul></li><li><a href="#å››æ„ç­‘æµ‹è¯•ä½“ç³»">å››ã€æ„ç­‘æµ‹è¯•ä½“ç³»</a></li><li><a href="#äº”é‡æ–°ç»„ç»‡å‡½æ•°">äº”ã€é‡æ–°ç»„ç»‡å‡½æ•°</a><ul><li><a href="#1-æç‚¼å‡½æ•°">1. æç‚¼å‡½æ•°</a></li><li><a href="#2-å†…è”å‡½æ•°">2. å†…è”å‡½æ•°</a></li><li><a href="#3-å†…è”ä¸´æ—¶å˜é‡">3. å†…è”ä¸´æ—¶å˜é‡</a></li><li><a href="#4-ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡">4. ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡</a></li><li><a href="#5-å¼•èµ·è§£é‡Šå˜é‡">5. å¼•èµ·è§£é‡Šå˜é‡</a></li><li><a href="#6-åˆ†è§£ä¸´æ—¶å˜é‡">6. åˆ†è§£ä¸´æ—¶å˜é‡</a></li><li><a href="#7-ç§»é™¤å¯¹å‚æ•°çš„èµ‹å€¼">7. ç§»é™¤å¯¹å‚æ•°çš„èµ‹å€¼</a></li><li><a href="#8-ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°">8. ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°</a></li><li><a href="#9-æ›¿æ¢ç®—æ³•">9. æ›¿æ¢ç®—æ³•</a></li></ul></li><li><a href="#å…­åœ¨å¯¹è±¡ä¹‹é—´æ¬ç§»ç‰¹æ€§">å…­ã€åœ¨å¯¹è±¡ä¹‹é—´æ¬ç§»ç‰¹æ€§</a><ul><li><a href="#1-æ¬ç§»å‡½æ•°">1. æ¬ç§»å‡½æ•°</a></li><li><a href="#2-æ¬ç§»å­—æ®µ">2. æ¬ç§»å­—æ®µ</a></li><li><a href="#3-æç‚¼ç±»">3. æç‚¼ç±»</a></li><li><a href="#4-å°†ç±»å†…è”åŒ–">4. å°†ç±»å†…è”åŒ–</a></li><li><a href="#5-éšè—å§”æ‰˜å…³ç³»">5. éšè—å§”æ‰˜å…³ç³»</a></li><li><a href="#6-ç§»é™¤ä¸­é—´äºº">6. ç§»é™¤ä¸­é—´äºº</a></li><li><a href="#7-å¼•å…¥å¤–åŠ å‡½æ•°">7. å¼•å…¥å¤–åŠ å‡½æ•°</a></li><li><a href="#8-å¼•å…¥æœ¬åœ°æ‰©å±•">8. å¼•å…¥æœ¬åœ°æ‰©å±•</a></li></ul></li><li><a href="#ä¸ƒé‡æ–°ç»„ç»‡æ•°æ®">ä¸ƒã€é‡æ–°ç»„ç»‡æ•°æ®</a><ul><li><a href="#1-è‡ªå°è£…å­—æ®µ">1. è‡ªå°è£…å­—æ®µ</a></li><li><a href="#2-ä»¥å¯¹è±¡å–ä»£æ•°æ®å€¼">2. ä»¥å¯¹è±¡å–ä»£æ•°æ®å€¼</a></li><li><a href="#3-å°†å€¼å¯¹è±¡æ”¹æˆå¼•ç”¨å¯¹è±¡">3. å°†å€¼å¯¹è±¡æ”¹æˆå¼•ç”¨å¯¹è±¡</a></li><li><a href="#4-å°†å¼•ç”¨å¯¹è±¡æ”¹ä¸ºå€¼å¯¹è±¡">4. å°†å¼•ç”¨å¯¹è±¡æ”¹ä¸ºå€¼å¯¹è±¡</a></li><li><a href="#5-ä»¥å¯¹è±¡å–ä»£æ•°ç»„">5. ä»¥å¯¹è±¡å–ä»£æ•°ç»„</a></li><li><a href="#6-èµ‹å€¼è¢«ç›‘è§†æ•°æ®">6. èµ‹å€¼è¢«ç›‘è§†æ•°æ®</a></li><li><a href="#7-å°†å•å‘å…³è”æ”¹ä¸ºåŒå‘å…³è”">7. å°†å•å‘å…³è”æ”¹ä¸ºåŒå‘å…³è”</a></li><li><a href="#8-å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”">8. å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”</a></li><li><a href="#9-ä»¥å­—é¢å¸¸é‡å–ä»£é­”æ³•æ•°">9. ä»¥å­—é¢å¸¸é‡å–ä»£é­”æ³•æ•°</a></li><li><a href="#10-å°è£…å­—æ®µ">10. å°è£…å­—æ®µ</a></li><li><a href="#11-å°è£…é›†åˆ">11. å°è£…é›†åˆ</a></li><li><a href="#12-ä»¥æ•°æ®ç±»å–ä»£è®°å½•">12. ä»¥æ•°æ®ç±»å–ä»£è®°å½•</a></li><li><a href="#13-ä»¥ç±»å–ä»£ç±»å‹ç ">13. ä»¥ç±»å–ä»£ç±»å‹ç </a></li><li><a href="#14-ä»¥å­ç±»å–ä»£ç±»å‹ç ">14. ä»¥å­ç±»å–ä»£ç±»å‹ç </a></li><li><a href="#15-ä»¥-statestrategy-å–ä»£ç±»å‹ç ">15. ä»¥ State/Strategy å–ä»£ç±»å‹ç </a></li><li><a href="#16-ä»¥å­—æ®µå–ä»£å­ç±»">16. ä»¥å­—æ®µå–ä»£å­ç±»</a></li></ul></li><li><a href="#å…«ç®€åŒ–æ¡ä»¶è¡¨è¾¾å¼">å…«ã€ç®€åŒ–æ¡ä»¶è¡¨è¾¾å¼</a><ul><li><a href="#1-åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼">1. åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼</a></li><li><a href="#2-åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼">2. åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼</a></li><li><a href="#3-åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ">3. åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ</a></li><li><a href="#4-ç§»é™¤æ§åˆ¶æ ‡è®°">4. ç§»é™¤æ§åˆ¶æ ‡è®°</a></li><li><a href="#5-ä»¥å«è¯­å¥å–ä»£åµŒå¥—æ¡ä»¶è¡¨è¾¾å¼">5. ä»¥å«è¯­å¥å–ä»£åµŒå¥—æ¡ä»¶è¡¨è¾¾å¼</a></li><li><a href="#6-ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼">6. ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼</a></li><li><a href="#7-å¼•å…¥-null-å¯¹è±¡">7. å¼•å…¥ Null å¯¹è±¡</a></li><li><a href="#8-å¼•å…¥æ–­è¨€">8. å¼•å…¥æ–­è¨€</a></li></ul></li><li><a href="#ä¹ç®€åŒ–å‡½æ•°è°ƒç”¨">ä¹ã€ç®€åŒ–å‡½æ•°è°ƒç”¨</a><ul><li><a href="#1-å‡½æ•°æ”¹å">1. å‡½æ•°æ”¹å</a></li><li><a href="#2-æ·»åŠ å‚æ•°">2. æ·»åŠ å‚æ•°</a></li><li><a href="#3-ç§»é™¤å‚æ•°">3. ç§»é™¤å‚æ•°</a></li><li><a href="#4-å°†æŸ¥è¯¢å‡½æ•°å’Œä¿®æ”¹å‡½æ•°åˆ†ç¦»">4. å°†æŸ¥è¯¢å‡½æ•°å’Œä¿®æ”¹å‡½æ•°åˆ†ç¦»</a></li><li><a href="#5-ä»¤å‡½æ•°æºå¸¦å‚æ•°">5. ä»¤å‡½æ•°æºå¸¦å‚æ•°</a></li><li><a href="#6-ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°">6. ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°</a></li><li><a href="#7-ä¿æŒå¯¹è±¡å®Œæ•´">7. ä¿æŒå¯¹è±¡å®Œæ•´</a></li><li><a href="#8-ä»¥å‡½æ•°å–ä»£å‚æ•°">8. ä»¥å‡½æ•°å–ä»£å‚æ•°</a></li><li><a href="#9-å¼•å…¥å‚æ•°å¯¹è±¡">9. å¼•å…¥å‚æ•°å¯¹è±¡</a></li><li><a href="#10-ç§»é™¤è®¾å€¼å‡½æ•°">10. ç§»é™¤è®¾å€¼å‡½æ•°</a></li><li><a href="#11-éšè—å‡½æ•°">11. éšè—å‡½æ•°</a></li><li><a href="#12-ä»¥å·¥å‚å‡½æ•°å–ä»£æ„é€ å‡½æ•°">12. ä»¥å·¥å‚å‡½æ•°å–ä»£æ„é€ å‡½æ•°</a></li><li><a href="#13-å°è£…å‘ä¸‹è½¬å‹">13. å°è£…å‘ä¸‹è½¬å‹</a></li><li><a href="#14-ä»¥å¼‚å¸¸å–ä»£é”™è¯¯ç ">14. ä»¥å¼‚å¸¸å–ä»£é”™è¯¯ç </a></li><li><a href="#15-ä»¥æµ‹è¯•å–ä»£å¼‚å¸¸">15. ä»¥æµ‹è¯•å–ä»£å¼‚å¸¸</a></li></ul></li><li><a href="#åå¤„ç†æ¦‚æ‹¬å…³ç³»">åã€å¤„ç†æ¦‚æ‹¬å…³ç³»</a><ul><li><a href="#1-å­—æ®µä¸Šç§»">1. å­—æ®µä¸Šç§»</a></li><li><a href="#2-å‡½æ•°ä¸Šç§»">2. å‡½æ•°ä¸Šç§»</a></li><li><a href="#3-æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»">3. æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»</a></li><li><a href="#4-å‡½æ•°ä¸‹ç§»">4. å‡½æ•°ä¸‹ç§»</a></li><li><a href="#5-å­—æ®µä¸‹ç§»">5. å­—æ®µä¸‹ç§»</a></li><li><a href="#6-æç‚¼å­ç±»">6. æç‚¼å­ç±»</a></li><li><a href="#7-æç‚¼è¶…ç±»">7. æç‚¼è¶…ç±»</a></li><li><a href="#8-æç‚¼æ¥å£">8. æç‚¼æ¥å£</a></li><li><a href="#9-æŠ˜å ç»§æ‰¿ä½“ç³»">9. æŠ˜å ç»§æ‰¿ä½“ç³»</a></li><li><a href="#10-å¡‘é€ æ¨¡æ¿å‡½æ•°">10. å¡‘é€ æ¨¡æ¿å‡½æ•°</a></li><li><a href="#11-ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿">11. ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿</a></li><li><a href="#12-ä»¥ç»§æ‰¿å–ä»£å§”æ‰˜">12. ä»¥ç»§æ‰¿å–ä»£å§”æ‰˜</a></li></ul></li><li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a><!-- GFM-TOC --></li></ul><h1 id="ä¸€ã€ç¬¬ä¸€ä¸ªæ¡ˆä¾‹"><a href="#ä¸€ã€ç¬¬ä¸€ä¸ªæ¡ˆä¾‹" class="headerlink" title="ä¸€ã€ç¬¬ä¸€ä¸ªæ¡ˆä¾‹"></a>ä¸€ã€ç¬¬ä¸€ä¸ªæ¡ˆä¾‹</h1><p>å¦‚æœä½ å‘ç°è‡ªå·±éœ€è¦ä¸ºç¨‹åºæ·»åŠ ä¸€ä¸ªç‰¹æ€§ï¼Œè€Œä»£ç ç»“æ„ä½¿ä½ æ— æ³•å¾ˆæ–¹ä¾¿åœ°è¾¾æˆç›®çš„ï¼Œé‚£å°±å…ˆé‡æ„è¿™ä¸ªç¨‹åºã€‚</p><p>åœ¨é‡æ„å‰ï¼Œéœ€è¦å…ˆæ„å»ºå¥½å¯é çš„æµ‹è¯•ç¯å¢ƒï¼Œç¡®ä¿å®‰å…¨åœ°é‡æ„ã€‚</p><p>é‡æ„éœ€è¦ä»¥å¾®å°çš„æ­¥ä¼ä¿®æ”¹ç¨‹åºï¼Œå¦‚æœé‡æ„è¿‡ç¨‹å‘ç”Ÿé”™è¯¯ï¼Œå¾ˆå®¹æ˜“å°±èƒ½å‘ç°é”™è¯¯ã€‚</p><p><strong>æ¡ˆä¾‹åˆ†æ</strong> </p><p>å½±ç‰‡å‡ºç§Ÿåº—åº”ç”¨ç¨‹åºï¼Œéœ€è¦è®¡ç®—æ¯ä½é¡¾å®¢çš„æ¶ˆè´¹é‡‘é¢ã€‚</p><p>åŒ…æ‹¬ä¸‰ä¸ªç±»ï¼šMovieã€Rental å’Œ Customerã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062517.png"> </div><br></p><p>æœ€å¼€å§‹çš„å®ç°æ˜¯æŠŠæ‰€æœ‰çš„è®¡è´¹ä»£ç éƒ½æ”¾åœ¨ Customer ç±»ä¸­ã€‚å¯ä»¥å‘ç°ï¼Œè¯¥ä»£ç æ²¡æœ‰ä½¿ç”¨ Customer ç±»ä¸­çš„ä»»ä½•ä¿¡æ¯ï¼Œæ›´å¤šçš„æ˜¯ä½¿ç”¨ Rental ç±»çš„ä¿¡æ¯ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªå¯ä»¥é‡æ„çš„ç‚¹å°±æ˜¯æŠŠå…·ä½“è®¡è´¹çš„ä»£ç ç§»åˆ° Rental ç±»ä¸­ï¼Œç„¶å Customer ç±»çš„ getTotalCharge() æ–¹æ³•åªéœ€è¦è°ƒç”¨ Rental ç±»ä¸­çš„è®¡è´¹æ–¹æ³•å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Rental&gt; rentals = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addRental</span><span class="params">(Rental rental)</span> </span>&#123;</span><br><span class="line">        rentals.add(rental);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getTotalCharge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> totalCharge = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Rental rental : rentals) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (rental.getMovie().getMovieType()) &#123;</span><br><span class="line">                <span class="keyword">case</span> Movie.Type1:</span><br><span class="line">                    totalCharge += rental.getDaysRented();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Movie.Type2:</span><br><span class="line">                    totalCharge += rental.getDaysRented() * <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Movie.Type3:</span><br><span class="line">                    totalCharge += rental.getDaysRented() * <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> totalCharge;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rental</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> daysRented;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Movie movie;</span><br><span class="line"></span><br><span class="line">    Rental(<span class="keyword">int</span> daysRented, Movie movie) &#123;</span><br><span class="line">        <span class="keyword">this</span>.daysRented = daysRented;</span><br><span class="line">        <span class="keyword">this</span>.movie = movie;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Movie <span class="title">getMovie</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> movie;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getDaysRented</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> daysRented;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Movie</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> Type1 = <span class="number">0</span>, Type2 = <span class="number">1</span>, Type3 = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> type;</span><br><span class="line"></span><br><span class="line">    Movie(<span class="keyword">int</span> type) &#123;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getMovieType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Customer customer = <span class="keyword">new</span> Customer();</span><br><span class="line">        Rental rental1 = <span class="keyword">new</span> Rental(<span class="number">1</span>, <span class="keyword">new</span> Movie(Movie.Type1));</span><br><span class="line">        Rental rental2 = <span class="keyword">new</span> Rental(<span class="number">2</span>, <span class="keyword">new</span> Movie(Movie.Type2));</span><br><span class="line">        customer.addRental(rental1);</span><br><span class="line">        customer.addRental(rental2);</span><br><span class="line">        System.out.println(customer.getTotalCharge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ switch çš„å‡†åˆ™æ˜¯ï¼šåªä½¿ç”¨ switch æ‰€åœ¨ç±»çš„æ•°æ®ã€‚è§£é‡Šå¦‚ä¸‹ï¼šswitch ä½¿ç”¨çš„æ•°æ®é€šå¸¸æ˜¯ä¸€ç»„ç›¸å…³çš„æ•°æ®ï¼Œä¾‹å¦‚ getTotalCharge() ä»£ç ä½¿ç”¨äº† Movie çš„å¤šç§ç±»åˆ«æ•°æ®ã€‚å½“è¿™ç»„ç±»åˆ«çš„æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¾‹å¦‚å¢åŠ  Movie çš„ç±»åˆ«æˆ–è€…ä¿®æ”¹ä¸€ç§ Movie ç±»åˆ«çš„è®¡è´¹æ–¹æ³•ï¼Œå°±éœ€è¦ä¿®æ”¹ switch ä»£ç ã€‚å¦‚æœè¿åäº†å‡†åˆ™ï¼Œå°±ä¼šæœ‰å¤šä¸ªåœ°æ–¹çš„ switch ä½¿ç”¨äº†è¿™éƒ¨åˆ†çš„æ•°æ®ï¼Œé‚£ä¹ˆè¿™äº› swtich éƒ½éœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œè¿™äº›ä»£ç å¯èƒ½éå¸ƒåœ¨å„ä¸ªåœ°æ–¹ï¼Œä¿®æ”¹å·¥ä½œå¾€å¾€ä¼šå¾ˆéš¾è¿›è¡Œã€‚ä¸Šé¢çš„å®ç°è¿åäº†è¿™ä¸€å‡†åˆ™ï¼Œå› æ­¤éœ€è¦é‡æ„ã€‚</p><p>ä»¥ä¸‹æ˜¯ç»§æ‰¿ Movie çš„å¤šæ€è§£å†³æ–¹æ¡ˆï¼Œè¿™ç§æ–¹æ¡ˆå¯ä»¥è§£å†³ä¸Šè¿°çš„ switch é—®é¢˜ï¼Œå› ä¸ºæ¯ç§ç”µå½±ç±»åˆ«çš„è®¡è´¹æ–¹å¼éƒ½è¢«æ”¾åˆ°äº†å¯¹åº” Movie å­ç±»ä¸­ï¼Œå½“å˜åŒ–å‘ç”Ÿæ—¶ï¼Œåªéœ€è¦å»ä¿®æ”¹å¯¹åº”å­ç±»ä¸­çš„ä»£ç å³å¯ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062523.png"> </div><br></p><p>æœ‰ä¸€æ¡è®¾è®¡åŸåˆ™æŒ‡ç¤ºåº”è¯¥å¤šç”¨ç»„åˆå°‘ç”¨ç»§æ‰¿ï¼Œè¿™æ˜¯å› ä¸ºç»„åˆæ¯”ç»§æ‰¿å…·æœ‰æ›´é«˜çš„çµæ´»æ€§ã€‚ä¾‹å¦‚ä¸Šé¢çš„ç»§æ‰¿æ–¹æ¡ˆï¼Œä¸€éƒ¨ç”µå½±è¦æ”¹å˜å®ƒçš„è®¡è´¹æ–¹å¼ï¼Œå°±è¦æ”¹å˜å®ƒæ‰€å±çš„ç±»ï¼Œä½†æ˜¯å¯¹è±¡æ‰€å±çš„ç±»åœ¨ç¼–è¯‘æ—¶æœŸå°±ç¡®å®šäº†ï¼Œæ— æ³•åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ”¹å˜ã€‚ï¼ˆè¿è¡Œæ—¶å¤šæ€å¯ä»¥åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ”¹å˜ä¸€ä¸ªçˆ¶ç±»å¼•ç”¨æŒ‡å‘çš„å­ç±»å¯¹è±¡ï¼Œä½†æ˜¯æ— æ³•æ”¹å˜ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ã€‚ï¼‰</p><p>ç­–ç•¥æ¨¡å¼å°±æ˜¯ä½¿ç”¨ç»„åˆæ›¿ä»£ç»§æ‰¿çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚å¼•å…¥ Price ç±»ï¼Œå®ƒæœ‰å¤šç§å®ç°ã€‚Movie ç»„åˆäº†ä¸€ä¸ª Price å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨è¿è¡Œæ—¶å¯ä»¥æ”¹å˜ç»„åˆçš„ Price å¯¹è±¡ï¼Œä»è€Œä½¿å¾—å®ƒçš„è®¡è´¹æ–¹å¼å‘ç”Ÿæ”¹å˜ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062525.png"> </div><br></p><p>é‡æ„åæ•´ä½“çš„ç±»å›¾å’Œæ—¶åºå›¾å¦‚ä¸‹ï¼š</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062531.png"> </div><br></p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062535.png"> </div><br></p><p>é‡æ„åçš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Rental&gt; rentals = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addRental</span><span class="params">(Rental rental)</span> </span>&#123;</span><br><span class="line">        rentals.add(rental);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getTotalCharge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> totalCharge = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Rental rental : rentals) &#123;</span><br><span class="line">            totalCharge += rental.getCharge();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> totalCharge;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rental</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> daysRented;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Movie movie;</span><br><span class="line"></span><br><span class="line">    Rental(<span class="keyword">int</span> daysRented, Movie movie) &#123;</span><br><span class="line">        <span class="keyword">this</span>.daysRented = daysRented;</span><br><span class="line">        <span class="keyword">this</span>.movie = movie;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getCharge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> daysRented * movie.getCharge();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Price</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getCharge</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Price1</span> <span class="keyword">implements</span> <span class="title">Price</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getCharge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Price2</span> <span class="keyword">implements</span> <span class="title">Price</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getCharge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> imp2;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Price3</span> <span class="keyword">implements</span> <span class="title">Price</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getCharge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Movie</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Price price;</span><br><span class="line"></span><br><span class="line">    Movie(Price price) &#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getCharge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price.getCharge();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Customer customer = <span class="keyword">new</span> Customer();</span><br><span class="line">        Rental rental1 = <span class="keyword">new</span> Rental(<span class="number">1</span>, <span class="keyword">new</span> Movie(<span class="keyword">new</span> Price1()));</span><br><span class="line">        Rental rental2 = <span class="keyword">new</span> Rental(<span class="number">2</span>, <span class="keyword">new</span> Movie(<span class="keyword">new</span> Price2()));</span><br><span class="line">        customer.addRental(rental1);</span><br><span class="line">        customer.addRental(rental2);</span><br><span class="line">        System.out.println(customer.getTotalCharge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="äºŒã€é‡æ„åŸåˆ™"><a href="#äºŒã€é‡æ„åŸåˆ™" class="headerlink" title="äºŒã€é‡æ„åŸåˆ™"></a>äºŒã€é‡æ„åŸåˆ™</h1><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>é‡æ„æ˜¯å¯¹è½¯ä»¶å†…éƒ¨ç»“æ„çš„ä¸€ç§è°ƒæ•´ï¼Œç›®çš„æ˜¯åœ¨ä¸æ”¹å˜è½¯ä»¶å¯è§‚å¯Ÿè¡Œä¸ºçš„å‰æä¸‹ï¼Œæé«˜å…¶å¯ç†è§£æ€§ï¼Œé™ä½å…¶ä¿®æ”¹æˆæœ¬ã€‚</p><h2 id="ä¸ºä½•é‡æ„"><a href="#ä¸ºä½•é‡æ„" class="headerlink" title="ä¸ºä½•é‡æ„"></a>ä¸ºä½•é‡æ„</h2><ul><li>æ”¹è¿›è½¯ä»¶è®¾è®¡</li><li>ä½¿è½¯ä»¶æ›´å®¹æ˜“ç†è§£</li><li>å¸®åŠ©æ‰¾åˆ° Bug</li><li>æé«˜ç¼–ç¨‹é€Ÿåº¦</li></ul><h2 id="ä¸‰æ¬¡æ³•åˆ™"><a href="#ä¸‰æ¬¡æ³•åˆ™" class="headerlink" title="ä¸‰æ¬¡æ³•åˆ™"></a>ä¸‰æ¬¡æ³•åˆ™</h2><p>ç¬¬ä¸€æ¬¡åšæŸä»¶äº‹æ—¶åªç®¡å»åšï¼›ç¬¬äºŒæ¬¡åšç±»ä¼¼äº‹æƒ…æ—¶å¯ä»¥å»åšï¼›ç¬¬ä¸‰æ¬¡å†åšç±»ä¼¼çš„äº‹ï¼Œå°±åº”è¯¥é‡æ„ã€‚</p><h2 id="é—´æ¥å±‚ä¸é‡æ„"><a href="#é—´æ¥å±‚ä¸é‡æ„" class="headerlink" title="é—´æ¥å±‚ä¸é‡æ„"></a>é—´æ¥å±‚ä¸é‡æ„</h2><p>è®¡ç®—æœºç§‘å­¦ä¸­çš„å¾ˆå¤šé—®é¢˜å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªé—´æ¥å±‚æ¥è§£å†³ï¼Œé—´æ¥å±‚å…·æœ‰ä»¥ä¸‹ä»·å€¼ï¼š</p><ul><li>å…è®¸é€»è¾‘å…±äº«</li><li>åˆ†å¼€è§£é‡Šæ„å›¾å’Œå®ç°</li><li>éš”ç¦»å˜åŒ–</li><li>å°è£…æ¡ä»¶é€»è¾‘</li></ul><p>é‡æ„å¯ä»¥ç†è§£ä¸ºåœ¨é€‚å½“çš„ä½ç½®æ’å…¥é—´æ¥å±‚ä»¥åŠåœ¨ä¸éœ€è¦æ—¶ç§»é™¤é—´æ¥å±‚ã€‚</p><h2 id="ä¿®æ”¹æ¥å£"><a href="#ä¿®æ”¹æ¥å£" class="headerlink" title="ä¿®æ”¹æ¥å£"></a>ä¿®æ”¹æ¥å£</h2><p>å¦‚æœé‡æ„æ‰‹æ³•æ”¹å˜äº†å·²å‘å¸ƒçš„æ¥å£ï¼Œå°±å¿…é¡»ç»´æŠ¤æ–°æ—§ä¸¤ä¸ªæ¥å£ã€‚å¯ä»¥ä¿ç•™æ—§æ¥å£ï¼Œè®©æ—§æ¥å£å»è°ƒç”¨æ–°æ¥å£ï¼Œå¹¶ä¸”ä½¿ç”¨ Java æä¾›çš„ @deprecation å°†æ—§æ¥å£æ ‡è®°ä¸ºå¼ƒç”¨ã€‚</p><p>å¯è§ä¿®æ”¹æ¥å£ç‰¹åˆ«éº»çƒ¦ï¼Œå› æ­¤é™¤éçœŸæœ‰å¿…è¦ï¼Œå¦åˆ™ä¸è¦å‘å¸ƒæ¥å£ï¼Œå¹¶ä¸”ä¸è¦è¿‡æ—©å‘å¸ƒæ¥å£ã€‚</p><h2 id="ä½•æ—¶ä¸è¯¥é‡æ„"><a href="#ä½•æ—¶ä¸è¯¥é‡æ„" class="headerlink" title="ä½•æ—¶ä¸è¯¥é‡æ„"></a>ä½•æ—¶ä¸è¯¥é‡æ„</h2><p>å½“ç°æœ‰ä»£ç è¿‡äºæ··ä¹±æ—¶ï¼Œåº”å½“é‡å†™è€Œä¸æ˜¯é‡æ„ã€‚</p><p>ä¸€ä¸ªæŠ˜ä¸­çš„åŠæ³•æ˜¯ï¼Œå°†ä»£ç å°è£…æˆä¸€ä¸ªä¸ªç»„ä»¶ï¼Œç„¶åå¯¹å„ä¸ªç»„ä»¶åšé‡å†™æˆ–è€…é‡æ„çš„å†³å®šã€‚</p><h2 id="é‡æ„ä¸è®¾è®¡"><a href="#é‡æ„ä¸è®¾è®¡" class="headerlink" title="é‡æ„ä¸è®¾è®¡"></a>é‡æ„ä¸è®¾è®¡</h2><p>è½¯ä»¶å¼€å‘æ— æ³•é¢„å…ˆè®¾è®¡ï¼Œå› ä¸ºå¼€å‘è¿‡ç¨‹æœ‰å¾ˆå¤šå˜åŒ–å‘ç”Ÿï¼Œåœ¨æœ€å¼€å§‹ä¸å¯èƒ½éƒ½æŠŠæ‰€æœ‰æƒ…å†µè€ƒè™‘è¿›å»ã€‚</p><p>é‡æ„å¯ä»¥ç®€åŒ–è®¾è®¡ï¼Œé‡æ„åœ¨ä¸€ä¸ªç®€å•çš„è®¾è®¡ä¸Šè¿›è¡Œä¿®ä¿®æ”¹æ”¹ï¼Œå½“å˜åŒ–å‘ç”Ÿæ—¶ï¼Œä»¥ä¸€ç§çµæ´»çš„æ–¹å¼å»åº”å¯¹å˜åŒ–ï¼Œè¿›è€Œå¸¦æ¥æ›´å¥½çš„è®¾è®¡ã€‚</p><h2 id="é‡æ„ä¸æ€§èƒ½"><a href="#é‡æ„ä¸æ€§èƒ½" class="headerlink" title="é‡æ„ä¸æ€§èƒ½"></a>é‡æ„ä¸æ€§èƒ½</h2><p>ä¸ºäº†è½¯ä»£ç æ›´å®¹æ˜“ç†è§£ï¼Œé‡æ„å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½å‡ä½ã€‚</p><p>åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œä¸ç”¨å¯¹æ€§èƒ½è¿‡å¤šå…³æ³¨ï¼Œåªæœ‰åœ¨æœ€åæ€§èƒ½ä¼˜åŒ–é˜¶æ®µå†è€ƒè™‘æ€§èƒ½é—®é¢˜ã€‚</p><p>åº”å½“åªå…³æ³¨å…³é”®ä»£ç çš„æ€§èƒ½ï¼Œå¹¶ä¸”åªæœ‰ä¸€å°éƒ¨åˆ†çš„ä»£ç æ˜¯å…³é”®ä»£ç ã€‚</p><h1 id="ä¸‰ã€ä»£ç çš„åå‘³é“"><a href="#ä¸‰ã€ä»£ç çš„åå‘³é“" class="headerlink" title="ä¸‰ã€ä»£ç çš„åå‘³é“"></a>ä¸‰ã€ä»£ç çš„åå‘³é“</h1><p>æœ¬ç« ä¸»è¦ä»‹ç»ä¸€äº›ä¸å¥½çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›ä»£ç åº”è¯¥è¢«é‡æ„ã€‚</p><h2 id="1-é‡å¤ä»£ç "><a href="#1-é‡å¤ä»£ç " class="headerlink" title="1. é‡å¤ä»£ç "></a>1. é‡å¤ä»£ç </h2><blockquote><p>Duplicated Code</p></blockquote><p>åŒä¸€ä¸ªç±»çš„ä¸¤ä¸ªå‡½æ•°æœ‰ç›¸åŒè¡¨è¾¾å¼ï¼Œåˆ™ç”¨ Extract Method æå–å‡ºé‡å¤ä»£ç ï¼›</p><p>ä¸¤ä¸ªäº’ä¸ºå…„å¼Ÿçš„å­ç±»å«æœ‰ç›¸åŒçš„è¡¨è¾¾å¼ï¼Œå…ˆä½¿ç”¨ Extract Methodï¼Œç„¶åæŠŠæå–å‡ºæ¥çš„å‡½æ•° Pull Up Method æ¨å…¥è¶…ç±»ã€‚</p><p>å¦‚æœåªæ˜¯éƒ¨åˆ†ç›¸åŒï¼Œç”¨ Extract Method åˆ†ç¦»å‡ºç›¸ä¼¼éƒ¨åˆ†å’Œå·®å¼‚éƒ¨åˆ†ï¼Œç„¶åä½¿ç”¨ Form Template Method è¿™ç§æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ã€‚</p><p>å¦‚æœä¸¤ä¸ªæ¯«ä¸ç›¸å…³çš„ç±»å‡ºç°é‡å¤ä»£ç ï¼Œåˆ™ä½¿ç”¨ Extract Class æ–¹æ³•å°†é‡å¤ä»£ç æå–åˆ°ä¸€ä¸ªç‹¬ç«‹ç±»ä¸­ã€‚</p><h2 id="2-è¿‡é•¿å‡½æ•°"><a href="#2-è¿‡é•¿å‡½æ•°" class="headerlink" title="2. è¿‡é•¿å‡½æ•°"></a>2. è¿‡é•¿å‡½æ•°</h2><blockquote><p>Long Method</p></blockquote><p>å‡½æ•°åº”è¯¥å°½å¯èƒ½å°ï¼Œå› ä¸ºå°å‡½æ•°å…·æœ‰è§£é‡Šèƒ½åŠ›ã€å…±äº«èƒ½åŠ›ã€é€‰æ‹©èƒ½åŠ›ã€‚</p><p>åˆ†è§£é•¿å‡½æ•°çš„åŸåˆ™ï¼šå½“éœ€è¦ç”¨æ³¨é‡Šæ¥è¯´æ˜ä¸€æ®µä»£ç æ—¶ï¼Œå°±éœ€è¦æŠŠè¿™éƒ¨åˆ†ä»£ç å†™å…¥ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ä¸­ã€‚</p><p>Extract Method ä¼šæŠŠå¾ˆå¤šå‚æ•°å’Œä¸´æ—¶å˜é‡éƒ½å½“åšå‚æ•°ï¼Œå¯ä»¥ç”¨ Replace Temp with Query æ¶ˆé™¤ä¸´æ—¶å˜é‡ï¼ŒIntroduce Parameter Object å’Œ Preserve Whole Object å¯ä»¥å°†è¿‡é•¿çš„å‚æ•°åˆ—å˜å¾—æ›´ç®€æ´ã€‚</p><p>æ¡ä»¶å’Œå¾ªç¯è¯­å¥å¾€å¾€ä¹Ÿéœ€è¦æå–åˆ°æ–°çš„å‡½æ•°ä¸­ã€‚</p><h2 id="3-è¿‡å¤§çš„ç±»"><a href="#3-è¿‡å¤§çš„ç±»" class="headerlink" title="3. è¿‡å¤§çš„ç±»"></a>3. è¿‡å¤§çš„ç±»</h2><blockquote><p>Large Class</p></blockquote><p>åº”è¯¥å°½å¯èƒ½è®©ä¸€ä¸ªç±»åªåšä¸€ä»¶äº‹ï¼Œè€Œè¿‡å¤§çš„ç±»åšäº†è¿‡å¤šäº‹æƒ…ï¼Œéœ€è¦ä½¿ç”¨ Extract Class æˆ– Extract Subclassã€‚</p><p>å…ˆç¡®å®šå®¢æˆ·ç«¯å¦‚ä½•ä½¿ç”¨è¯¥ç±»ï¼Œç„¶åè¿ç”¨ Extract Interface ä¸ºæ¯ä¸€ç§ä½¿ç”¨æ–¹å¼æå–å‡ºä¸€ä¸ªæ¥å£ã€‚</p><h2 id="4-è¿‡é•¿çš„å‚æ•°åˆ—è¡¨"><a href="#4-è¿‡é•¿çš„å‚æ•°åˆ—è¡¨" class="headerlink" title="4. è¿‡é•¿çš„å‚æ•°åˆ—è¡¨"></a>4. è¿‡é•¿çš„å‚æ•°åˆ—è¡¨</h2><blockquote><p>Long Parameter List</p></blockquote><p>å¤ªé•¿çš„å‚æ•°åˆ—è¡¨å¾€å¾€ä¼šé€ æˆå‰åä¸ä¸€è‡´ï¼Œä¸æ˜“ä½¿ç”¨ã€‚</p><p>é¢å‘å¯¹è±¡ç¨‹åºä¸­ï¼Œå‡½æ•°æ‰€éœ€è¦çš„æ•°æ®é€šå¸¸èƒ½åœ¨å®¿ä¸»ç±»ä¸­æ‰¾åˆ°ã€‚</p><h2 id="5-å‘æ•£å¼å˜åŒ–"><a href="#5-å‘æ•£å¼å˜åŒ–" class="headerlink" title="5. å‘æ•£å¼å˜åŒ–"></a>5. å‘æ•£å¼å˜åŒ–</h2><blockquote><p>Divergent Change</p></blockquote><p>è®¾è®¡åŸåˆ™ï¼šä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·æ”¹å˜çš„åŸå› ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé’ˆå¯¹æŸä¸€å¤–ç•Œå˜åŒ–æ‰€æœ‰ç›¸åº”çš„ä¿®æ”¹ï¼Œéƒ½åªåº”è¯¥å‘ç”Ÿåœ¨å•ä¸€ç±»ä¸­ã€‚</p><p>é’ˆå¯¹æŸç§åŸå› çš„å˜åŒ–ï¼Œä½¿ç”¨ Extract Class å°†å®ƒæç‚¼åˆ°ä¸€ä¸ªç±»ä¸­ã€‚</p><h2 id="6-æ•£å¼¹å¼ä¿®æ”¹"><a href="#6-æ•£å¼¹å¼ä¿®æ”¹" class="headerlink" title="6. æ•£å¼¹å¼ä¿®æ”¹"></a>6. æ•£å¼¹å¼ä¿®æ”¹</h2><blockquote><p>Shotgun Surgery</p></blockquote><p>ä¸€ä¸ªå˜åŒ–å¼•èµ·å¤šä¸ªç±»ä¿®æ”¹ã€‚</p><p>ä½¿ç”¨ Move Method å’Œ Move Field æŠŠæ‰€æœ‰éœ€è¦ä¿®æ”¹çš„ä»£ç æ”¾åˆ°åŒä¸€ä¸ªç±»ä¸­ã€‚</p><h2 id="7-ä¾æ‹æƒ…ç»“"><a href="#7-ä¾æ‹æƒ…ç»“" class="headerlink" title="7. ä¾æ‹æƒ…ç»“"></a>7. ä¾æ‹æƒ…ç»“</h2><blockquote><p>Feature Envy</p></blockquote><p>ä¸€ä¸ªå‡½æ•°å¯¹æŸä¸ªç±»çš„å…´è¶£é«˜äºå¯¹è‡ªå·±æ‰€å¤„ç±»çš„å…´è¶£ï¼Œé€šå¸¸æ˜¯è¿‡å¤šè®¿é—®å…¶å®ƒç±»çš„æ•°æ®ï¼Œ</p><p>ä½¿ç”¨ Move Method å°†å®ƒç§»åˆ°è¯¥å»çš„åœ°æ–¹ï¼Œå¦‚æœå¯¹å¤šä¸ªç±»éƒ½æœ‰ Feature Envyï¼Œå…ˆç”¨ Extract Method æå–å‡ºå¤šä¸ªå‡½æ•°ã€‚</p><h2 id="8-æ•°æ®æ³¥å›¢"><a href="#8-æ•°æ®æ³¥å›¢" class="headerlink" title="8. æ•°æ®æ³¥å›¢"></a>8. æ•°æ®æ³¥å›¢</h2><blockquote><p>Data Clumps</p></blockquote><p>æœ‰äº›æ•°æ®ç»å¸¸ä¸€èµ·å‡ºç°ï¼Œæ¯”å¦‚ä¸¤ä¸ªç±»å…·æœ‰ç›¸åŒçš„å­—æ®µã€è®¸å¤šå‡½æ•°æœ‰ç›¸åŒçš„å‚æ•°ï¼Œè¿™äº›ç»‘å®šåœ¨ä¸€èµ·å‡ºç°çš„æ•°æ®åº”è¯¥æ‹¥æœ‰å±äºå®ƒä»¬è‡ªå·±çš„å¯¹è±¡ã€‚</p><p>ä½¿ç”¨ Extract Class å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·ã€‚</p><h2 id="9-åŸºæœ¬ç±»å‹åæ‰§"><a href="#9-åŸºæœ¬ç±»å‹åæ‰§" class="headerlink" title="9. åŸºæœ¬ç±»å‹åæ‰§"></a>9. åŸºæœ¬ç±»å‹åæ‰§</h2><blockquote><p>Primitive Obsession</p></blockquote><p>ä½¿ç”¨ç±»å¾€å¾€æ¯”ä½¿ç”¨åŸºæœ¬ç±»å‹æ›´å¥½ï¼Œä½¿ç”¨ Replace Data Value with Object å°†æ•°æ®å€¼æ›¿æ¢ä¸ºå¯¹è±¡ã€‚</p><h2 id="10-switch-æƒŠæ‚šç°èº«"><a href="#10-switch-æƒŠæ‚šç°èº«" class="headerlink" title="10. switch æƒŠæ‚šç°èº«"></a>10. switch æƒŠæ‚šç°èº«</h2><blockquote><p>Switch Statements</p></blockquote><p>å…·ä½“å‚è§ç¬¬ä¸€ç« çš„æ¡ˆä¾‹ã€‚</p><h2 id="11-å¹³è¡Œç»§æ‰¿ä½“ç³»"><a href="#11-å¹³è¡Œç»§æ‰¿ä½“ç³»" class="headerlink" title="11. å¹³è¡Œç»§æ‰¿ä½“ç³»"></a>11. å¹³è¡Œç»§æ‰¿ä½“ç³»</h2><blockquote><p>Parallel Inheritance Hierarchies</p></blockquote><p>æ¯å½“ä¸ºæŸä¸ªç±»å¢åŠ ä¸€ä¸ªå­ç±»ï¼Œå¿…é¡»ä¹Ÿä¸ºå¦ä¸€ä¸ªç±»ç›¸åº”å¢åŠ ä¸€ä¸ªå­ç±»ã€‚</p><p>è¿™ç§ç»“æœä¼šå¸¦æ¥ä¸€äº›é‡å¤æ€§ï¼Œæ¶ˆé™¤é‡å¤æ€§çš„ä¸€èˆ¬ç­–ç•¥ï¼šè®©ä¸€ä¸ªç»§æ‰¿ä½“ç³»çš„å®ä¾‹å¼•ç”¨å¦ä¸€ä¸ªç»§æ‰¿ä½“ç³»çš„å®ä¾‹ã€‚</p><h2 id="12-å†—ä½™ç±»"><a href="#12-å†—ä½™ç±»" class="headerlink" title="12. å†—ä½™ç±»"></a>12. å†—ä½™ç±»</h2><blockquote><p>Lazy Class</p></blockquote><p>å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰åšè¶³å¤Ÿå¤šçš„å·¥ä½œï¼Œå°±åº”è¯¥æ¶ˆå¤±ã€‚</p><h2 id="13-å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§"><a href="#13-å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§" class="headerlink" title="13. å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§"></a>13. å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§</h2><blockquote><p>Speculative Generality</p></blockquote><p>æœ‰äº›å†…å®¹æ˜¯ç”¨æ¥å¤„ç†æœªæ¥å¯èƒ½å‘ç”Ÿçš„å˜åŒ–ï¼Œä½†æ˜¯å¾€å¾€ä¼šé€ æˆç³»ç»Ÿéš¾ä»¥ç†è§£å’Œç»´æŠ¤ï¼Œå¹¶ä¸”é¢„æµ‹æœªæ¥å¯èƒ½å‘ç”Ÿçš„æ”¹å˜å¾ˆå¯èƒ½å’Œæœ€å¼€å§‹çš„è®¾æƒ³ç›¸åã€‚å› æ­¤ï¼Œå¦‚æœä¸æ˜¯å¿…è¦ï¼Œå°±ä¸è¦è¿™ä¹ˆåšã€‚</p><h2 id="14-ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ"><a href="#14-ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ" class="headerlink" title="14. ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ"></a>14. ä»¤äººè¿·æƒ‘çš„æš‚æ—¶å­—æ®µ</h2><blockquote><p>Temporary Field</p></blockquote><p>æŸä¸ªå­—æ®µä»…ä¸ºæŸç§ç‰¹å®šæƒ…å†µè€Œè®¾ï¼Œè¿™æ ·çš„ä»£ç ä¸æ˜“ç†è§£ï¼Œå› ä¸ºé€šå¸¸è®¤ä¸ºå¯¹è±¡åœ¨æ‰€æœ‰æ—¶å€™éƒ½éœ€è¦å®ƒçš„æ‰€æœ‰å­—æ®µã€‚</p><p>æŠŠè¿™ç§å­—æ®µå’Œç‰¹å®šæƒ…å†µçš„å¤„ç†æ“ä½œä½¿ç”¨ Extract Class æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹ç±»ä¸­ã€‚</p><h2 id="15-è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾"><a href="#15-è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾" class="headerlink" title="15. è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾"></a>15. è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾</h2><blockquote><p>Message Chains</p></blockquote><p>ä¸€ä¸ªå¯¹è±¡è¯·æ±‚å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå†å‘åè€…è¯·æ±‚å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åâ€¦ï¼Œè¿™å°±æ˜¯æ¶ˆæ¯é“¾ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œæ„å‘³ç€å®¢æˆ·ä»£ç å°†ä¸å¯¹è±¡é—´çš„å…³ç³»ç´§å¯†è€¦åˆã€‚</p><p>æ”¹ç”¨å‡½æ•°é“¾ï¼Œç”¨å‡½æ•°å§”æ‰˜å¦ä¸€ä¸ªå¯¹è±¡æ¥å¤„ç†ã€‚</p><h2 id="16-ä¸­é—´äºº"><a href="#16-ä¸­é—´äºº" class="headerlink" title="16. ä¸­é—´äºº"></a>16. ä¸­é—´äºº</h2><blockquote><p> Middle Man</p></blockquote><p>ä¸­é—´äººè´Ÿè´£å¤„ç†å§”æ‰˜ç»™å®ƒçš„æ“ä½œï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­æœ‰è¿‡å¤šçš„å‡½æ•°éƒ½å§”æ‰˜ç»™å…¶å®ƒç±»ï¼Œé‚£å°±æ˜¯è¿‡åº¦è¿ç”¨å§”æ‰˜ï¼Œåº”å½“ Remove Middle Manï¼Œç›´æ¥ä¸è´Ÿè´£çš„å¯¹è±¡æ‰“äº¤é“ã€‚</p><h2 id="17-ç‹æ˜µå…³ç³»"><a href="#17-ç‹æ˜µå…³ç³»" class="headerlink" title="17. ç‹æ˜µå…³ç³»"></a>17. ç‹æ˜µå…³ç³»</h2><blockquote><p>Inappropriate Intimacy</p></blockquote><p>ä¸¤ä¸ªç±»å¤šäºäº²å¯†ï¼ŒèŠ±è´¹å¤ªå¤šæ—¶é—´å»æ¢è®¨å½¼æ­¤çš„ private æˆåˆ†ã€‚</p><h2 id="18-å¼‚æ›²åŒå·¥çš„ç±»"><a href="#18-å¼‚æ›²åŒå·¥çš„ç±»" class="headerlink" title="18. å¼‚æ›²åŒå·¥çš„ç±»"></a>18. å¼‚æ›²åŒå·¥çš„ç±»</h2><blockquote><p>Alernative Classes with Different Interfaces</p></blockquote><p>ä¸¤ä¸ªå‡½æ•°åšåŒä¸€ä»¶äº‹ï¼Œå´æœ‰ç€ä¸åŒçš„ç­¾åã€‚</p><p>ä½¿ç”¨ Rename Method æ ¹æ®å®ƒä»¬çš„ç”¨é€”é‡æ–°å‘½åã€‚</p><h2 id="19-ä¸å®Œç¾çš„ç±»åº“"><a href="#19-ä¸å®Œç¾çš„ç±»åº“" class="headerlink" title="19. ä¸å®Œç¾çš„ç±»åº“"></a>19. ä¸å®Œç¾çš„ç±»åº“</h2><blockquote><p>Incomplete Library Class</p></blockquote><p>ç±»åº“çš„è®¾è®¡è€…ä¸å¯èƒ½è®¾è®¡å‡ºå®Œç¾çš„ç±»åº“ï¼Œå½“æˆ‘ä»¬éœ€è¦å¯¹ç±»åº“è¿›è¡Œä¸€äº›ä¿®æ”¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼šå¦‚æœåªæ˜¯ä¿®æ”¹ä¸€ä¸¤ä¸ªå‡½æ•°ï¼Œä½¿ç”¨ Introduce Foreign Methodï¼›å¦‚æœè¦æ·»åŠ ä¸€å¤§å †é¢å¤–è¡Œä¸ºï¼Œä½¿ç”¨ Introduce Local Extensionã€‚</p><h2 id="20-å¹¼ç¨šçš„æ•°æ®ç±»"><a href="#20-å¹¼ç¨šçš„æ•°æ®ç±»" class="headerlink" title="20. å¹¼ç¨šçš„æ•°æ®ç±»"></a>20. å¹¼ç¨šçš„æ•°æ®ç±»</h2><blockquote><p>Data Class</p></blockquote><p>å®ƒåªæ‹¥æœ‰ä¸€äº›æ•°æ®å­—æ®µï¼Œä»¥åŠç”¨äºè®¿é—®è¿™äº›å­—æ®µçš„å‡½æ•°ï¼Œé™¤æ­¤ä¹‹å¤–ä¸€æ— é•¿ç‰©ã€‚</p><p>æ‰¾å‡ºå­—æ®µä½¿ç”¨çš„åœ°æ–¹ï¼Œç„¶åæŠŠç›¸åº”çš„æ“ä½œç§»åˆ° Data Class ä¸­ã€‚</p><h2 id="21-è¢«æ‹’ç»çš„é¦ˆèµ "><a href="#21-è¢«æ‹’ç»çš„é¦ˆèµ " class="headerlink" title="21. è¢«æ‹’ç»çš„é¦ˆèµ "></a>21. è¢«æ‹’ç»çš„é¦ˆèµ </h2><blockquote><p>Refused Bequest</p></blockquote><p>å­ç±»ä¸æƒ³ç»§æ‰¿è¶…ç±»çš„æ‰€æœ‰å‡½æ•°å’Œæ•°æ®ã€‚</p><p>ä¸ºå­ç±»æ–°å»ºä¸€ä¸ªå…„å¼Ÿç±»ï¼Œä¸éœ€è¦çš„å‡½æ•°æˆ–æ•°æ®ä½¿ç”¨ Push Down Method å’Œ Push Down Field ä¸‹æ¨ç»™é‚£ä¸ªå…„å¼Ÿã€‚</p><h2 id="22-è¿‡å¤šçš„æ³¨é‡Š"><a href="#22-è¿‡å¤šçš„æ³¨é‡Š" class="headerlink" title="22. è¿‡å¤šçš„æ³¨é‡Š"></a>22. è¿‡å¤šçš„æ³¨é‡Š</h2><blockquote><p>Comments</p></blockquote><p>ä½¿ç”¨ Extract Method æç‚¼å‡ºéœ€è¦æ³¨é‡Šçš„éƒ¨åˆ†ï¼Œç„¶åç”¨å‡½æ•°åæ¥è§£é‡Šå‡½æ•°çš„è¡Œä¸ºã€‚</p><h1 id="å››ã€æ„ç­‘æµ‹è¯•ä½“ç³»"><a href="#å››ã€æ„ç­‘æµ‹è¯•ä½“ç³»" class="headerlink" title="å››ã€æ„ç­‘æµ‹è¯•ä½“ç³»"></a>å››ã€æ„ç­‘æµ‹è¯•ä½“ç³»</h1><p>Java å¯ä»¥ä½¿ç”¨ Junit è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚</p><p>æµ‹è¯•åº”è¯¥èƒ½å¤Ÿå®Œå…¨è‡ªåŠ¨åŒ–ï¼Œå¹¶èƒ½æ£€æŸ¥æµ‹è¯•çš„ç»“æœã€‚</p><p>å°æ­¥ä¿®æ”¹ï¼Œé¢‘ç¹æµ‹è¯•ã€‚</p><p>å•å…ƒæµ‹è¯•çš„å¯¹è±¡æ˜¯ç±»çš„æ–¹æ³•ï¼Œè€ŒåŠŸèƒ½æµ‹æ˜¯ä»¥å®¢æˆ·çš„è§’åº¦ä¿è¯è½¯ä»¶æ­£å¸¸è¿è¡Œã€‚</p><p>åº”å½“é›†ä¸­æµ‹è¯•å¯èƒ½å‡ºé”™çš„è¾¹ç•Œæ¡ä»¶ã€‚</p><h1 id="äº”ã€é‡æ–°ç»„ç»‡å‡½æ•°"><a href="#äº”ã€é‡æ–°ç»„ç»‡å‡½æ•°" class="headerlink" title="äº”ã€é‡æ–°ç»„ç»‡å‡½æ•°"></a>äº”ã€é‡æ–°ç»„ç»‡å‡½æ•°</h1><h2 id="1-æç‚¼å‡½æ•°"><a href="#1-æç‚¼å‡½æ•°" class="headerlink" title="1. æç‚¼å‡½æ•°"></a>1. æç‚¼å‡½æ•°</h2><blockquote><p>Extract Method</p></blockquote><p>å°†è¿™æ®µä»£ç æ”¾è¿›ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå¹¶è®©å‡½æ•°åç§°è§£é‡Šè¯¥å‡½æ•°çš„ç”¨é€”ã€‚</p><h2 id="2-å†…è”å‡½æ•°"><a href="#2-å†…è”å‡½æ•°" class="headerlink" title="2. å†…è”å‡½æ•°"></a>2. å†…è”å‡½æ•°</h2><blockquote><p>Inline Method</p></blockquote><p>ä¸€ä¸ªå‡½æ•°çš„æœ¬ä½“ä¸åç§°åŒæ ·æ¸…æ¥šæ˜“æ‡‚ã€‚</p><p>åœ¨å‡½æ•°è°ƒç”¨ç‚¹æ’å…¥å‡½æ•°æœ¬ä½“ï¼Œç„¶åç§»é™¤è¯¥å‡½æ•°ã€‚</p><h2 id="3-å†…è”ä¸´æ—¶å˜é‡"><a href="#3-å†…è”ä¸´æ—¶å˜é‡" class="headerlink" title="3. å†…è”ä¸´æ—¶å˜é‡"></a>3. å†…è”ä¸´æ—¶å˜é‡</h2><blockquote><p>Inline Temp</p></blockquote><p>ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œåªè¢«ç®€å•è¡¨è¾¾å¼èµ‹å€¼ä¸€æ¬¡ï¼Œè€Œå®ƒå¦¨ç¢äº†å…¶å®ƒé‡æ„æ‰‹æ³•ã€‚</p><p>å°†æ‰€æœ‰å¯¹è¯¥å˜é‡çš„å¼•ç”¨æ›¿æ¢ä¸ºå¯¹å®ƒèµ‹å€¼çš„é‚£ä¸ªè¡¨è¾¾å¼è‡ªèº«ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> basePrice = anOrder.basePrice();</span><br><span class="line"><span class="keyword">return</span> basePrice &gt; <span class="number">1000</span>;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> anOrder.basePrice() &gt; <span class="number">1000</span>;</span><br></pre></td></tr></table></figure><h2 id="4-ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡"><a href="#4-ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡" class="headerlink" title="4. ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡"></a>4. ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡</h2><blockquote><p>Replace Temp with Query</p></blockquote><p>ä»¥ä¸´æ—¶å˜é‡ä¿å­˜æŸä¸€è¡¨è¾¾å¼çš„è¿ç®—ç»“æœï¼Œå°†è¿™ä¸ªè¡¨è¾¾å¼æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå°†æ‰€æœ‰å¯¹ä¸´æ—¶å˜é‡çš„å¼•ç”¨ç‚¹æ›¿æ¢ä¸ºå¯¹æ–°å‡½æ•°çš„è°ƒç”¨ã€‚</p><p>Replace Temp with Query å¾€å¾€æ˜¯ Extract Method ä¹‹å‰å¿…ä¸å¯å°‘çš„ä¸€ä¸ªæ­¥éª¤ï¼Œå› ä¸ºå±€éƒ¨å˜é‡ä¼šä½¿ä»£ç éš¾ä»¥æç‚¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> basePrice = quantity * itemPrice;</span><br><span class="line"><span class="keyword">if</span> (basePrice &gt; <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> basePrice * <span class="number">0.95</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> basePrice * <span class="number">0.98</span>;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (basePrice() &gt; <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> basePrice() * <span class="number">0.95</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> basePrice() * <span class="number">0.98</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">basePrice</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> quantity * itemPrice;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-å¼•èµ·è§£é‡Šå˜é‡"><a href="#5-å¼•èµ·è§£é‡Šå˜é‡" class="headerlink" title="5. å¼•èµ·è§£é‡Šå˜é‡"></a>5. å¼•èµ·è§£é‡Šå˜é‡</h2><blockquote><p>Introduce Explaining Variable</p></blockquote><p>å°†å¤æ‚è¡¨è¾¾å¼ï¼ˆæˆ–å…¶ä¸­ä¸€éƒ¨åˆ†ï¼‰çš„ç»“æœæ”¾è¿›ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œ ä»¥æ­¤å˜é‡åç§°æ¥è§£é‡Šè¡¨è¾¾å¼ç”¨é€”ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((platform.toUpperCase().indexOf(<span class="string">"MAC"</span>) &gt; -<span class="number">1</span>) &amp;&amp;</span><br><span class="line">  (browser.toUpperCase().indexOf(<span class="string">"IE"</span>) &gt; -<span class="number">1</span>) &amp;&amp;</span><br><span class="line">  wasInitialized() &amp;&amp; resize &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">boolean</span> isMacOS = platform.toUpperCase().indexOf(<span class="string">"MAC"</span>) &gt; -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">final</span> <span class="keyword">boolean</span> isIEBrower = browser.toUpperCase().indexOf(<span class="string">"IE"</span>) &gt; -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">final</span> <span class="keyword">boolean</span> wasResized = resize &gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (isMacOS &amp;&amp; isIEBrower &amp;&amp; wasInitialized() &amp;&amp; wasResized) &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-åˆ†è§£ä¸´æ—¶å˜é‡"><a href="#6-åˆ†è§£ä¸´æ—¶å˜é‡" class="headerlink" title="6. åˆ†è§£ä¸´æ—¶å˜é‡"></a>6. åˆ†è§£ä¸´æ—¶å˜é‡</h2><blockquote><p>Split Temporary Variable</p></blockquote><p>æŸä¸ªä¸´æ—¶å˜é‡è¢«èµ‹å€¼è¶…è¿‡ä¸€æ¬¡ï¼Œå®ƒæ—¢ä¸æ˜¯å¾ªç¯å˜é‡ï¼Œä¹Ÿä¸æ˜¯ç”¨äºæ”¶é›†è®¡ç®—ç»“æœã€‚</p><p>é’ˆå¯¹æ¯æ¬¡èµ‹å€¼ï¼Œåˆ›é€ ä¸€ä¸ªç‹¬ç«‹ã€å¯¹åº”çš„ä¸´æ—¶å˜é‡ï¼Œæ¯ä¸ªä¸´æ—¶å˜é‡åªæ‰¿æ‹…ä¸€ä¸ªè´£ä»»ã€‚</p><h2 id="7-ç§»é™¤å¯¹å‚æ•°çš„èµ‹å€¼"><a href="#7-ç§»é™¤å¯¹å‚æ•°çš„èµ‹å€¼" class="headerlink" title="7. ç§»é™¤å¯¹å‚æ•°çš„èµ‹å€¼"></a>7. ç§»é™¤å¯¹å‚æ•°çš„èµ‹å€¼</h2><blockquote><p> Remove Assigments to Parameters</p></blockquote><p>ä»¥ä¸€ä¸ªä¸´æ—¶å˜é‡å–ä»£å¯¹è¯¥å‚æ•°çš„èµ‹å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">discount</span> <span class="params">(<span class="keyword">int</span> inputVal, <span class="keyword">int</span> quentity, <span class="keyword">int</span> yearToDate)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (inputVal &gt; <span class="number">50</span>) inputVal -= <span class="number">2</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">discount</span> <span class="params">(<span class="keyword">int</span> inputVal, <span class="keyword">int</span> quentity, <span class="keyword">int</span> yearToDate)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = inputVal;</span><br><span class="line">    <span class="keyword">if</span> (inputVal &gt; <span class="number">50</span>) result -= <span class="number">2</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°"><a href="#8-ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°" class="headerlink" title="8. ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°"></a>8. ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°</h2><blockquote><p>Replace Method with Method Object</p></blockquote><p>å½“å¯¹ä¸€ä¸ªå¤§å‹å‡½æ•°é‡‡ç”¨ Extract Method æ—¶ï¼Œç”±äºåŒ…å«äº†å±€éƒ¨å˜é‡ä½¿å¾—å¾ˆéš¾è¿›è¡Œè¯¥æ“ä½œã€‚</p><p>å°†è¿™ä¸ªå‡½æ•°æ”¾è¿›ä¸€ä¸ªå•ç‹¬å¯¹è±¡ä¸­ï¼Œå¦‚æ­¤ä¸€æ¥å±€éƒ¨å˜é‡å°±æˆäº†å¯¹è±¡å†…çš„å­—æ®µã€‚ç„¶åå¯ä»¥åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸­å°†è¿™ä¸ªå¤§å‹å‡½æ•°åˆ†è§£ä¸ºå¤šä¸ªå°å‹å‡½æ•°ã€‚</p><h2 id="9-æ›¿æ¢ç®—æ³•"><a href="#9-æ›¿æ¢ç®—æ³•" class="headerlink" title="9. æ›¿æ¢ç®—æ³•"></a>9. æ›¿æ¢ç®—æ³•</h2><blockquote><p>Subsititute Algorithn</p></blockquote><h1 id="å…­ã€åœ¨å¯¹è±¡ä¹‹é—´æ¬ç§»ç‰¹æ€§"><a href="#å…­ã€åœ¨å¯¹è±¡ä¹‹é—´æ¬ç§»ç‰¹æ€§" class="headerlink" title="å…­ã€åœ¨å¯¹è±¡ä¹‹é—´æ¬ç§»ç‰¹æ€§"></a>å…­ã€åœ¨å¯¹è±¡ä¹‹é—´æ¬ç§»ç‰¹æ€§</h1><h2 id="1-æ¬ç§»å‡½æ•°"><a href="#1-æ¬ç§»å‡½æ•°" class="headerlink" title="1. æ¬ç§»å‡½æ•°"></a>1. æ¬ç§»å‡½æ•°</h2><blockquote><p>Move Method</p></blockquote><p>ç±»ä¸­çš„æŸä¸ªå‡½æ•°ä¸å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…æˆ–è€…è¢«åè€…è°ƒç”¨ã€‚</p><p>å°†è¿™ä¸ªå‡½æ•°æ¬ç§»åˆ°å¦ä¸€ä¸ªç±»ä¸­ã€‚</p><h2 id="2-æ¬ç§»å­—æ®µ"><a href="#2-æ¬ç§»å­—æ®µ" class="headerlink" title="2. æ¬ç§»å­—æ®µ"></a>2. æ¬ç§»å­—æ®µ</h2><blockquote><p>Move Field</p></blockquote><p>ç±»ä¸­çš„æŸä¸ªå­—æ®µè¢«å¦ä¸€ä¸ªç±»æ›´å¤šåœ°ç”¨åˆ°ï¼Œè¿™é‡Œçš„ç”¨åˆ°æ˜¯æŒ‡è°ƒç”¨å–å€¼è®¾å€¼å‡½æ•°ï¼Œåº”å½“æŠŠè¯¥å­—æ®µç§»åˆ°å¦ä¸€ä¸ªç±»ä¸­ã€‚</p><h2 id="3-æç‚¼ç±»"><a href="#3-æç‚¼ç±»" class="headerlink" title="3. æç‚¼ç±»"></a>3. æç‚¼ç±»</h2><blockquote><p>Extract Class</p></blockquote><p>æŸä¸ªç±»åšäº†åº”å½“ç”±ä¸¤ä¸ªç±»åšçš„äº‹ã€‚</p><p>åº”å½“å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p><h2 id="4-å°†ç±»å†…è”åŒ–"><a href="#4-å°†ç±»å†…è”åŒ–" class="headerlink" title="4. å°†ç±»å†…è”åŒ–"></a>4. å°†ç±»å†…è”åŒ–</h2><blockquote><p>Inline Class</p></blockquote><p>ä¸ Extract Class ç›¸åã€‚</p><h2 id="5-éšè—å§”æ‰˜å…³ç³»"><a href="#5-éšè—å§”æ‰˜å…³ç³»" class="headerlink" title="5. éšè—å§”æ‰˜å…³ç³»"></a>5. éšè—å§”æ‰˜å…³ç³»</h2><blockquote><p>Hide Delegate</p></blockquote><p>å»ºç«‹æ‰€éœ€çš„å‡½æ•°ï¼Œéšè—å§”æ‰˜å…³ç³»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    Department department;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Department <span class="title">getDepartment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> department;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Department</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Person manager;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">getManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> manager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœå®¢æˆ·å¸Œæœ›çŸ¥é“æŸäººçš„ç»ç†æ˜¯è°ï¼Œå¿…é¡»è·å¾— Department å¯¹è±¡ï¼Œè¿™æ ·å°±å¯¹å®¢æˆ·æ­éœ²äº† Department çš„å·¥ä½œåŸç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person manager = john.getDepartment().getManager();</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸º Peron å»ºç«‹ä¸€ä¸ªå‡½æ•°æ¥éšè—è¿™ç§å§”æ‰˜å…³ç³»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Person <span class="title">getManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> department.getManager();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-ç§»é™¤ä¸­é—´äºº"><a href="#6-ç§»é™¤ä¸­é—´äºº" class="headerlink" title="6. ç§»é™¤ä¸­é—´äºº"></a>6. ç§»é™¤ä¸­é—´äºº</h2><blockquote><p>Remove Middle Man</p></blockquote><p>ä¸ Hide Delegate ç›¸åï¼Œæœ¬æ–¹æ³•éœ€è¦ç§»é™¤å§”æ‰˜å‡½æ•°ï¼Œè®©å®¢æˆ·ç›´æ¥è°ƒç”¨å§”æ‰˜ç±»ã€‚</p><p>Hide Delegate æœ‰å¾ˆå¤§å¥½å¤„ï¼Œä½†æ˜¯å®ƒçš„ä»£ä»·æ˜¯ï¼šæ¯å½“å®¢æˆ·è¦ä½¿ç”¨å—æ‰˜ç±»çš„æ–°ç‰¹æ€§æ—¶ï¼Œå°±å¿…é¡»åœ¨æœåŠ¡å™¨ç«¯æ·»åŠ ä¸€ä¸ªç®€å•çš„å§”æ‰˜å‡½æ•°ã€‚éšç€å—å§”æ‰˜çš„ç‰¹æ€§è¶Šæ¥è¶Šå¤šï¼ŒæœåŠ¡å™¨ç±»å®Œå…¨å˜æˆäº†ä¸€ä¸ªâ€œä¸­é—´äººâ€ã€‚</p><h2 id="7-å¼•å…¥å¤–åŠ å‡½æ•°"><a href="#7-å¼•å…¥å¤–åŠ å‡½æ•°" class="headerlink" title="7. å¼•å…¥å¤–åŠ å‡½æ•°"></a>7. å¼•å…¥å¤–åŠ å‡½æ•°</h2><blockquote><p>Introduce Foreign Method</p></blockquote><p>éœ€è¦ä¸ºæä¾›æœåŠ¡çš„ç±»æ·»åŠ ä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯æ— æ³•ä¿®æ”¹è¿™ä¸ªç±»ã€‚</p><p>å¯ä»¥åœ¨å®¢æˆ·ç±»ä¸­å»ºç«‹ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä»¥ç¬¬ä¸€å‚æ•°å½¢å¼ä¼ å…¥ä¸€ä¸ªæœåŠ¡ç±»çš„å®ä¾‹ï¼Œè®©å®¢æˆ·ç±»ç»„åˆæœåŠ¡å™¨å®ä¾‹ã€‚</p><h2 id="8-å¼•å…¥æœ¬åœ°æ‰©å±•"><a href="#8-å¼•å…¥æœ¬åœ°æ‰©å±•" class="headerlink" title="8. å¼•å…¥æœ¬åœ°æ‰©å±•"></a>8. å¼•å…¥æœ¬åœ°æ‰©å±•</h2><blockquote><p>Introduce Local Extension</p></blockquote><p>å’Œ Introduce Foreign Method ç›®çš„ä¸€æ ·ï¼Œä½†æ˜¯ Introduce Local Extension é€šè¿‡å»ºç«‹æ–°çš„ç±»æ¥å®ç°ã€‚æœ‰ä¸¤ç§æ–¹å¼ï¼šå­ç±»æˆ–è€…åŒ…è£…ç±»ï¼Œå­ç±»å°±æ˜¯é€šè¿‡ç»§æ‰¿å®ç°ï¼ŒåŒ…è£…ç±»å°±æ˜¯é€šè¿‡ç»„åˆå®ç°ã€‚</p><h1 id="ä¸ƒã€é‡æ–°ç»„ç»‡æ•°æ®"><a href="#ä¸ƒã€é‡æ–°ç»„ç»‡æ•°æ®" class="headerlink" title="ä¸ƒã€é‡æ–°ç»„ç»‡æ•°æ®"></a>ä¸ƒã€é‡æ–°ç»„ç»‡æ•°æ®</h1><h2 id="1-è‡ªå°è£…å­—æ®µ"><a href="#1-è‡ªå°è£…å­—æ®µ" class="headerlink" title="1. è‡ªå°è£…å­—æ®µ"></a>1. è‡ªå°è£…å­—æ®µ</h2><blockquote><p>Self Encapsulate Field</p></blockquote><p>ä¸ºå­—æ®µå»ºç«‹å–å€¼/è®¾å€¼å‡½æ•°ï¼Œå¹¶ç”¨è¿™äº›å‡½æ•°æ¥è®¿é—®å­—æ®µã€‚åªæœ‰å½“å­ç±»æƒ³è®¿é—®è¶…ç±»çš„ä¸€ä¸ªå­—æ®µï¼Œåˆæƒ³åœ¨å­ç±»ä¸­å°†å¯¹è¿™ä¸ªå­—æ®µè®¿é—®æ”¹ä¸ºä¸€ä¸ªè®¡ç®—åçš„å€¼ï¼Œæ‰ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå¦åˆ™ç›´æ¥è®¿é—®å­—æ®µçš„æ–¹å¼ç®€æ´æ˜äº†ã€‚</p><h2 id="2-ä»¥å¯¹è±¡å–ä»£æ•°æ®å€¼"><a href="#2-ä»¥å¯¹è±¡å–ä»£æ•°æ®å€¼" class="headerlink" title="2. ä»¥å¯¹è±¡å–ä»£æ•°æ®å€¼"></a>2. ä»¥å¯¹è±¡å–ä»£æ•°æ®å€¼</h2><blockquote><p>Replace Data Value with Object</p></blockquote><p>åœ¨å¼€å‘åˆæœŸï¼Œå¾€å¾€ä¼šç”¨ç®€å•çš„æ•°æ®é¡¹è¡¨ç¤ºç®€å•çš„æƒ…å†µï¼Œä½†æ˜¯éšç€å¼€å‘çš„è¿›è¡Œï¼Œä¸€äº›ç®€å•æ•°æ®é¡¹ä¼šå…·æœ‰ä¸€äº›ç‰¹æ®Šè¡Œä¸ºã€‚æ¯”å¦‚ä¸€å¼€å§‹ä¼šæŠŠç”µè¯å·ç å­˜æˆå­—ç¬¦ä¸²ï¼Œä½†æ˜¯éšåå‘ç°ç”µè¯å·ç éœ€è¦â€œæ ¼å¼åŒ–â€ã€â€œæŠ½å–åŒºå·â€ä¹‹ç±»çš„ç‰¹æ®Šè¡Œä¸ºã€‚</p><h2 id="3-å°†å€¼å¯¹è±¡æ”¹æˆå¼•ç”¨å¯¹è±¡"><a href="#3-å°†å€¼å¯¹è±¡æ”¹æˆå¼•ç”¨å¯¹è±¡" class="headerlink" title="3. å°†å€¼å¯¹è±¡æ”¹æˆå¼•ç”¨å¯¹è±¡"></a>3. å°†å€¼å¯¹è±¡æ”¹æˆå¼•ç”¨å¯¹è±¡</h2><blockquote><p>Change Value to Reference</p></blockquote><p>å°†å½¼æ­¤ç›¸ç­‰çš„å®ä¾‹æ›¿æ¢ä¸ºåŒä¸€ä¸ªå¯¹è±¡ã€‚è¿™å°±è¦ç”¨ä¸€ä¸ªå·¥å‚æ¥åˆ›å»ºè¿™ç§å”¯ä¸€å¯¹è±¡ï¼Œå·¥å‚ç±»ä¸­éœ€è¦ä¿ç•™ä¸€ä»½å·²ç»åˆ›å»ºå¯¹è±¡çš„åˆ—è¡¨ï¼Œå½“è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå…ˆæŸ¥æ‰¾è¿™ä»½åˆ—è¡¨ä¸­æ˜¯å¦å·²ç»å­˜åœ¨è¯¥å¯¹è±¡ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›åˆ—è¡¨ä¸­çš„è¿™ä¸ªå¯¹è±¡ï¼›å¦åˆ™ï¼Œæ–°å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼Œå¹¶è¿”å›è¯¥å¯¹è±¡ã€‚</p><h2 id="4-å°†å¼•ç”¨å¯¹è±¡æ”¹ä¸ºå€¼å¯¹è±¡"><a href="#4-å°†å¼•ç”¨å¯¹è±¡æ”¹ä¸ºå€¼å¯¹è±¡" class="headerlink" title="4. å°†å¼•ç”¨å¯¹è±¡æ”¹ä¸ºå€¼å¯¹è±¡"></a>4. å°†å¼•ç”¨å¯¹è±¡æ”¹ä¸ºå€¼å¯¹è±¡</h2><blockquote><p>Change Reference to value</p></blockquote><p>ä»¥ Change Value to Reference ç›¸åã€‚å€¼å¯¹è±¡æœ‰ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ï¼šå®ƒæ˜¯ä¸å¯å˜çš„ï¼Œä¸å¯å˜è¡¨ç¤ºå¦‚æœè¦æ”¹å˜è¿™ä¸ªå¯¹è±¡ï¼Œå¿…é¡»ç”¨ä¸€ä¸ªæ–°çš„å¯¹è±¡æ¥æ›¿æ¢æ—§å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¿®æ”¹æ—§å¯¹è±¡ã€‚</p><p>éœ€è¦ä¸ºå€¼å¯¹è±¡å®ç° equals() å’Œ hashCode() æ–¹æ³•ã€‚</p><h2 id="5-ä»¥å¯¹è±¡å–ä»£æ•°ç»„"><a href="#5-ä»¥å¯¹è±¡å–ä»£æ•°ç»„" class="headerlink" title="5. ä»¥å¯¹è±¡å–ä»£æ•°ç»„"></a>5. ä»¥å¯¹è±¡å–ä»£æ•°ç»„</h2><blockquote><p>Replace Array with Object</p></blockquote><p>æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­çš„å…ƒç´ å„è‡ªä»£è¡¨ä¸åŒçš„ä¸œè¥¿ã€‚</p><p>ä»¥å¯¹è±¡æ›¿æ¢æ•°ç»„ï¼Œå¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œä»¥ä¸€ä¸ªå­—æ®µæ¥è¡¨ç¤ºï¼Œè¿™æ ·æ–¹ä¾¿æ“ä½œï¼Œä¹Ÿæ›´å®¹æ˜“ç†è§£ã€‚</p><h2 id="6-èµ‹å€¼è¢«ç›‘è§†æ•°æ®"><a href="#6-èµ‹å€¼è¢«ç›‘è§†æ•°æ®" class="headerlink" title="6. èµ‹å€¼è¢«ç›‘è§†æ•°æ®"></a>6. èµ‹å€¼è¢«ç›‘è§†æ•°æ®</h2><blockquote><p>Duplicate Observed Data</p></blockquote><p>ä¸€äº›é¢†åŸŸæ•°æ®ç½®èº«äº GUI æ§ä»¶ä¸­ï¼Œè€Œé¢†åŸŸå‡½æ•°éœ€è¦è®¿é—®è¿™äº›æ•°æ®ã€‚</p><p>å°†è¯¥æ•°æ®èµ‹å€¼åˆ°ä¸€ä¸ªé¢†åŸŸå¯¹è±¡ä¸­ï¼Œå»ºç«‹ä¸€ä¸ª Oberver æ¨¡å¼ï¼Œç”¨äºåŒæ­¥é¢†åŸŸå¯¹è±¡å’Œ GUI å¯¹è±¡å†…çš„é‡å¤æ•°æ®ã€‚</p><p><div align="center"> <img src="../pics/e024bd7e-fb4e-4239-9451-9a6227f50b00.jpg" width=""> </div><br></p><h2 id="7-å°†å•å‘å…³è”æ”¹ä¸ºåŒå‘å…³è”"><a href="#7-å°†å•å‘å…³è”æ”¹ä¸ºåŒå‘å…³è”" class="headerlink" title="7. å°†å•å‘å…³è”æ”¹ä¸ºåŒå‘å…³è”"></a>7. å°†å•å‘å…³è”æ”¹ä¸ºåŒå‘å…³è”</h2><blockquote><p>Change Unidirectional Association to Bidirectional</p></blockquote><p>å½“ä¸¤ä¸ªç±»éƒ½éœ€è¦å¯¹æ–¹çš„ç‰¹æ€§æ—¶ï¼Œå¯ä»¥ä½¿ç”¨åŒå‘å…³è”ã€‚</p><p>æœ‰ä¸¤ä¸ªç±»ï¼Œåˆ†åˆ«ä¸ºè®¢å• Order å’Œå®¢æˆ· Customerï¼ŒOrder å¼•ç”¨äº† Customerï¼ŒCustomer ä¹Ÿéœ€è¦å¼•ç”¨ Order æ¥æŸ¥çœ‹å…¶æ‰€æœ‰è®¢å•è¯¦æƒ…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Customer customer;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCustomer</span><span class="params">(Customer customer)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.customer != <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">this</span>.customer.removeOrder(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">this</span>.customer = customer;</span><br><span class="line">        <span class="keyword">this</span>.customer.add(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Curstomer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;Order&gt; orders = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeOrder</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">        orders.remove(order);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addOrder</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">        orders.add(order);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°ï¼Œè¿™é‡Œè®© Curstomer ç±»æ¥æ§åˆ¶å…³è”å…³ç³»ã€‚æœ‰ä»¥ä¸‹åŸåˆ™æ¥å†³å®šå“ªä¸ªç±»æ¥æ§åˆ¶å…³è”å…³ç³»ï¼šå¦‚æœæŸä¸ªå¯¹è±¡æ˜¯ç»„æˆå¦ä¸€ä¸ªå¯¹è±¡çš„éƒ¨ä»¶ï¼Œé‚£ä¹ˆç”±åè€…è´Ÿè´£æ§åˆ¶å…³è”å…³ç³»ï¼›å¦‚æœæ˜¯ä¸€å¯¹å¤šå…³ç³»ï¼Œåˆ™ç”±å•ä¸€å¼•ç”¨é‚£ä¸€æ–¹æ¥æ§åˆ¶å…³è”å…³ç³»ã€‚</p><h2 id="8-å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”"><a href="#8-å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”" class="headerlink" title="8. å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”"></a>8. å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”</h2><blockquote><p>Change Bidirectional Association to Unidirectional</p></blockquote><p>å’Œ Change Unidirectional Association to Bidirectiona ä¸ºåæ“ä½œã€‚</p><p>åŒå‘å…³è”ç»´æŠ¤æˆæœ¬é«˜ï¼Œå¹¶ä¸”ä¹Ÿä¸æ˜“äºç†è§£ã€‚å¤§é‡çš„åŒå‘è¿æ¥å¾ˆå®¹æ˜“é€ æˆâ€œåƒµå°¸å¯¹è±¡â€ï¼šæŸä¸ªå¯¹è±¡æœ¬èº«å·²ç»æ­»äº¡äº†ï¼Œå´ä¿ç•™åœ¨ç³»ç»Ÿä¸­ï¼Œå› ä¸ºå®ƒçš„å¼•ç”¨è¿˜æ²¡æœ‰å…¨éƒ¨å®Œå…¨æ¸…é™¤ã€‚</p><h2 id="9-ä»¥å­—é¢å¸¸é‡å–ä»£é­”æ³•æ•°"><a href="#9-ä»¥å­—é¢å¸¸é‡å–ä»£é­”æ³•æ•°" class="headerlink" title="9. ä»¥å­—é¢å¸¸é‡å–ä»£é­”æ³•æ•°"></a>9. ä»¥å­—é¢å¸¸é‡å–ä»£é­”æ³•æ•°</h2><blockquote><p>Replace Magic Number with Symbolic Constant</p></blockquote><p>åˆ›å»ºä¸€ä¸ªå¸¸é‡ï¼Œæ ¹æ®å…¶æ„ä¹‰ä¸ºå®ƒå‘½åï¼Œå¹¶å°†å­—é¢å¸¸é‡æ¢ä¸ºè¿™ä¸ªå¸¸é‡ã€‚</p><h2 id="10-å°è£…å­—æ®µ"><a href="#10-å°è£…å­—æ®µ" class="headerlink" title="10. å°è£…å­—æ®µ"></a>10. å°è£…å­—æ®µ</h2><blockquote><p>Encapsulate Field</p></blockquote><p>public å­—æ®µåº”å½“æ”¹ä¸º privateï¼Œå¹¶æä¾›ç›¸åº”çš„è®¿é—®å‡½æ•°ã€‚</p><h2 id="11-å°è£…é›†åˆ"><a href="#11-å°è£…é›†åˆ" class="headerlink" title="11. å°è£…é›†åˆ"></a>11. å°è£…é›†åˆ</h2><blockquote><p>Encapsulate Collection</p></blockquote><p>å‡½æ•°è¿”å›é›†åˆçš„ä¸€ä¸ªåªè¯»å‰¯æœ¬ï¼Œå¹¶åœ¨è¿™ä¸ªç±»ä¸­æä¾›æ·»åŠ /ç§»é™¤é›†åˆå…ƒç´ çš„å‡½æ•°ã€‚å¦‚æœå‡½æ•°è¿”å›é›†åˆè‡ªèº«ï¼Œä¼šè®©ç”¨æˆ·å¾—ä»¥ä¿®æ”¹é›†åˆå†…å®¹è€Œé›†åˆæ‹¥æœ‰è€…å´ä¸€æ— æ‰€çŸ¥ã€‚</p><h2 id="12-ä»¥æ•°æ®ç±»å–ä»£è®°å½•"><a href="#12-ä»¥æ•°æ®ç±»å–ä»£è®°å½•" class="headerlink" title="12. ä»¥æ•°æ®ç±»å–ä»£è®°å½•"></a>12. ä»¥æ•°æ®ç±»å–ä»£è®°å½•</h2><blockquote><p>Replace Record with Data Class</p></blockquote><h2 id="13-ä»¥ç±»å–ä»£ç±»å‹ç "><a href="#13-ä»¥ç±»å–ä»£ç±»å‹ç " class="headerlink" title="13. ä»¥ç±»å–ä»£ç±»å‹ç "></a>13. ä»¥ç±»å–ä»£ç±»å‹ç </h2><blockquote><p>Replace Type Code with Class</p></blockquote><p>ç±»ä¸­æœ‰ä¸€ä¸ªæ•°å€¼ç±»å‹ç ï¼Œä½†å®ƒå¹¶ä¸å½±å“ç±»çš„è¡Œä¸ºï¼Œå°±ç”¨ä¸€ä¸ªæ–°ç±»æ›¿æ¢è¯¥æ•°å€¼ç±»å‹ç ã€‚å¦‚æœç±»å‹ç å‡ºç°åœ¨ switch è¯­å¥ä¸­ï¼Œéœ€è¦ä½¿ç”¨ Replace Conditional with Polymorphism å»æ‰ switchï¼Œé¦–å…ˆå¿…é¡»è¿ç”¨ Replace Type Code with Subcalss æˆ– Replace Type Code with State/Strategy å»æ‰ç±»å‹ç ã€‚</p><p><div align="center"> <img src="../pics/27c2e0b3-8f95-453d-bedc-6398a8566ce9.jpg" width="500"> </div><br></p><h2 id="14-ä»¥å­ç±»å–ä»£ç±»å‹ç "><a href="#14-ä»¥å­ç±»å–ä»£ç±»å‹ç " class="headerlink" title="14. ä»¥å­ç±»å–ä»£ç±»å‹ç "></a>14. ä»¥å­ç±»å–ä»£ç±»å‹ç </h2><blockquote><p>Replace Type Code with Subcalsses</p></blockquote><p>æœ‰ä¸€ä¸ªä¸å¯å˜çš„ç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºï¼Œä»¥å­ç±»å–ä»£è¿™ä¸ªç±»å‹ç ã€‚</p><p><div align="center"> <img src="../pics/c41d3977-e0e7-4ee4-93e1-d84f1ae3e20e.jpg" width="500"> </div><br></p><h2 id="15-ä»¥-State-Strategy-å–ä»£ç±»å‹ç "><a href="#15-ä»¥-State-Strategy-å–ä»£ç±»å‹ç " class="headerlink" title="15. ä»¥ State/Strategy å–ä»£ç±»å‹ç "></a>15. ä»¥ State/Strategy å–ä»£ç±»å‹ç </h2><blockquote><p>Replace Type Code with State/Strategy</p></blockquote><p>æœ‰ä¸€ä¸ªå¯å˜çš„ç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºï¼Œä»¥çŠ¶æ€å¯¹è±¡å–ä»£ç±»å‹ç ã€‚</p><p>å’Œ Replace Type Code with Subcalsses çš„åŒºåˆ«æ˜¯ Replace Type Code with State/Strategy çš„ç±»å‹ç æ˜¯åŠ¨æ€å¯å˜çš„ï¼Œå‰è€…é€šè¿‡ç»§æ‰¿çš„æ–¹å¼æ¥å®ç°ï¼Œåè€…é€šè¿‡ç»„åˆçš„æ–¹å¼æ¥å®ç°ã€‚å› ä¸ºç±»å‹ç å¯å˜ï¼Œå¦‚æœé€šè¿‡ç»§æ‰¿çš„æ–¹å¼ï¼Œä¸€æ—¦ä¸€ä¸ªå¯¹è±¡çš„ç±»å‹ç æ”¹å˜ï¼Œé‚£ä¹ˆå°±è¦æ”¹å˜ç”¨æ–°çš„å¯¹è±¡æ¥å–ä»£æ—§å¯¹è±¡ï¼Œè€Œå®¢æˆ·ç«¯éš¾ä»¥æ”¹å˜æ–°çš„å¯¹è±¡ã€‚ä½†æ˜¯é€šè¿‡ç»„åˆçš„æ–¹å¼ï¼Œæ”¹å˜å¼•ç”¨çš„çŠ¶æ€ç±»æ˜¯å¾ˆå®¹æ˜“çš„ã€‚</p><p><div align="center"> <img src="../pics/81fd1d6f-a3b2-4160-9a0a-1f7cb50ba440.jpg" width="800"> </div><br></p><h2 id="16-ä»¥å­—æ®µå–ä»£å­ç±»"><a href="#16-ä»¥å­—æ®µå–ä»£å­ç±»" class="headerlink" title="16. ä»¥å­—æ®µå–ä»£å­ç±»"></a>16. ä»¥å­—æ®µå–ä»£å­ç±»</h2><blockquote><p>Replace Subclass with Fields</p></blockquote><p>å„ä¸ªå­ç±»çš„å”¯ä¸€å·®åˆ«åªåœ¨â€œè¿”å›å¸¸é‡æ•°æ®â€çš„å‡½æ•°ä¸Šã€‚</p><p><div align="center"> <img src="../pics/f2e0cee9-ecdc-4a96-853f-d9f6a1ad6ad1.jpg" width="600"> </div><br></p><h1 id="å…«ã€ç®€åŒ–æ¡ä»¶è¡¨è¾¾å¼"><a href="#å…«ã€ç®€åŒ–æ¡ä»¶è¡¨è¾¾å¼" class="headerlink" title="å…«ã€ç®€åŒ–æ¡ä»¶è¡¨è¾¾å¼"></a>å…«ã€ç®€åŒ–æ¡ä»¶è¡¨è¾¾å¼</h1><h2 id="1-åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼"><a href="#1-åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼" class="headerlink" title="1. åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼"></a>1. åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼</h2><blockquote><p>Decompose Conditional</p></blockquote><p>å¯¹äºä¸€ä¸ªå¤æ‚çš„æ¡ä»¶è¯­å¥ï¼Œå¯ä»¥ä» ifã€thenã€else ä¸‰ä¸ªæ®µè½ä¸­åˆ†åˆ«æç‚¼å‡ºç‹¬ç«‹å‡½æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (data.befor(SUMMER_START) || data.after(SUMMER_END))</span><br><span class="line">    charge = quantity * winterRate + winterServiceCharge;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    charge = quantity * summerRate;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (notSummer(date))</span><br><span class="line">    charge = winterCharge(quantity);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    charge = summerCharge(quantity);</span><br></pre></td></tr></table></figure><h2 id="2-åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼"><a href="#2-åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼" class="headerlink" title="2. åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼"></a>2. åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼</h2><blockquote><p>Consolidate Conditional Expression</p></blockquote><p>æœ‰ä¸€ç³»åˆ—æ¡ä»¶æµ‹è¯•ï¼Œéƒ½å¾—åˆ°ç›¸åŒç»“æœã€‚</p><p>å°†è¿™äº›æµ‹è¯•åˆå¹¶ä¸ºä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼Œå¹¶å°†è¿™ä¸ªæ¡ä»¶è¡¨è¾¾å¼æç‚¼æˆä¸ºä¸€ä¸ªç‹¬ç«‹å‡½æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">disabilityAmount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (seniority &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (monthsDisabled &gt; <span class="number">12</span> ) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (isPartTime) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">disabilityAmount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isNotEligibleForDisability()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ"><a href="#3-åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ" class="headerlink" title="3. åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ"></a>3. åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ</h2><blockquote><p>Consolidate Duplicate Conditional Fragments</p></blockquote><p>åœ¨æ¡ä»¶è¡¨è¾¾å¼çš„æ¯ä¸ªåˆ†æ”¯ä¸Šæœ‰ç€ç›¸åŒçš„ä¸€æ®µä»£ç ã€‚</p><p>å°†è¿™æ®µé‡å¤ä»£ç æ¬ç§»åˆ°æ¡ä»¶è¡¨è¾¾å¼ä¹‹å¤–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSpecialDeal()) &#123;</span><br><span class="line">    total = price * <span class="number">0.95</span>;</span><br><span class="line">    send();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    total = price * <span class="number">0.98</span>;</span><br><span class="line">    send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSpecialDeal()) &#123;</span><br><span class="line">    total = price * <span class="number">0.95</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    total = price * <span class="number">0.98</span>;</span><br><span class="line">&#125;</span><br><span class="line">send();</span><br></pre></td></tr></table></figure><h2 id="4-ç§»é™¤æ§åˆ¶æ ‡è®°"><a href="#4-ç§»é™¤æ§åˆ¶æ ‡è®°" class="headerlink" title="4. ç§»é™¤æ§åˆ¶æ ‡è®°"></a>4. ç§»é™¤æ§åˆ¶æ ‡è®°</h2><blockquote><p>Remove Control Flag</p></blockquote><p>åœ¨ä¸€ç³»åˆ—å¸ƒå°”è¡¨è¾¾å¼ä¸­ï¼ŒæŸä¸ªå˜é‡å¸¦æœ‰â€œæ§åˆ¶æ ‡è®°â€çš„ä½œç”¨ã€‚</p><p>ç”¨ break è¯­å¥æˆ– return è¯­å¥æ¥å–ä»£æ§åˆ¶æ ‡è®°ã€‚</p><h2 id="5-ä»¥å«è¯­å¥å–ä»£åµŒå¥—æ¡ä»¶è¡¨è¾¾å¼"><a href="#5-ä»¥å«è¯­å¥å–ä»£åµŒå¥—æ¡ä»¶è¡¨è¾¾å¼" class="headerlink" title="5. ä»¥å«è¯­å¥å–ä»£åµŒå¥—æ¡ä»¶è¡¨è¾¾å¼"></a>5. ä»¥å«è¯­å¥å–ä»£åµŒå¥—æ¡ä»¶è¡¨è¾¾å¼</h2><blockquote><p>Replace Nested Conditional with Guard Clauses</p></blockquote><p>å¦‚æœæŸä¸ªæ¡ä»¶æå…¶ç½•è§ï¼Œå°±åº”è¯¥å•ç‹¬æ£€æŸ¥è¯¥æ¡ä»¶ï¼Œå¹¶åœ¨è¯¥æ¡ä»¶ä¸ºçœŸæ—¶ç«‹åˆ»ä»å‡½æ•°ä¸­è¿”å›ï¼Œè¿™æ ·çš„å•ç‹¬æ£€æŸ¥å¸¸å¸¸è¢«ç§°ä¸ºâ€œå«è¯­å¥â€ï¼ˆguard clausesï¼‰ã€‚</p><p>æ¡ä»¶è¡¨è¾¾å¼é€šå¸¸æœ‰ä¸¤ç§è¡¨ç°å½¢å¼ã€‚ç¬¬ä¸€ç§å½¢å¼æ˜¯ï¼šæ‰€æœ‰åˆ†æ”¯éƒ½å±äºæ­£å¸¸è¡Œä¸ºã€‚ç¬¬äºŒç§å½¢å¼åˆ™æ˜¯ï¼šæ¡ä»¶è¡¨è¾¾å¼æä¾›çš„ç­”æ¡ˆä¸­åªæœ‰ä¸€ç§æ˜¯æ­£å¸¸è¡Œä¸ºï¼Œå…¶ä»–éƒ½æ˜¯ä¸å¸¸è§çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨å«è¯­å¥è¡¨ç°æ‰€æœ‰ç‰¹æ®Šæƒ…å†µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getPayAmount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> result;</span><br><span class="line">    <span class="keyword">if</span> (isDead) result = deadAmount();</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isSeparated) result = separatedAmount();</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isRetired) result = retiredAmount();</span><br><span class="line">            <span class="keyword">else</span> result = normalPayAmount();</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getPayAmount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isDead) <span class="keyword">return</span> deadAmount();</span><br><span class="line">    <span class="keyword">if</span> (isSeparated) <span class="keyword">return</span> separatedAmount();</span><br><span class="line">    <span class="keyword">if</span> (isRetired) <span class="keyword">return</span> retiredAmount();</span><br><span class="line">    <span class="keyword">return</span> normalPayAmount();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="6-ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼"><a href="#6-ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼" class="headerlink" title="6. ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼"></a>6. ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼</h2><blockquote><p>Replace Conditional with Polymorphism</p></blockquote><p>å°†è¿™ä¸ªæ¡ä»¶è¡¨è¾¾å¼çš„æ¯ä¸ªåˆ†æ”¯æ”¾è¿›ä¸€ä¸ªå­ç±»å†…çš„è¦†å†™å‡½æ•°ä¸­ï¼Œç„¶åå°†åŸå§‹å‡½æ•°å£°æ˜ä¸ºæŠ½è±¡å‡½æ•°ã€‚éœ€è¦å…ˆä½¿ç”¨ Replace Type Code with Subclass æˆ– Replace Type Code with State/Strategy æ¥å»ºç«‹ç»§æ‰¿ç»“æœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">        <span class="keyword">case</span> EUROPEAN:</span><br><span class="line">            <span class="keyword">return</span> getBaseSpeed();</span><br><span class="line">        <span class="keyword">case</span> AFRICAN:</span><br><span class="line">            <span class="keyword">return</span> getBaseSpeed()- getLoadFactor()* numberOfCoconuts;</span><br><span class="line">        <span class="keyword">case</span> NORWEGIAN_BLUE:</span><br><span class="line">            <span class="keyword">return</span> isNailed ? <span class="number">0</span> : getBaseSpeed(voltage);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Should be unreachable"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><div align="center"> <img src="../pics/1c8432c8-2552-457f-b117-1da36c697221.jpg" width="500"> </div><br></p><h2 id="7-å¼•å…¥-Null-å¯¹è±¡"><a href="#7-å¼•å…¥-Null-å¯¹è±¡" class="headerlink" title="7. å¼•å…¥ Null å¯¹è±¡"></a>7. å¼•å…¥ Null å¯¹è±¡</h2><blockquote><p>Introduce Null Object</p></blockquote><p>å°† null å€¼æ›¿æ¢ä¸º null å¯¹è±¡ã€‚è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼Œä¸éœ€è¦è¯¢é—®å¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼Œç›´æ¥è°ƒç”¨å°±è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (customer == <span class="keyword">null</span>) plan = BillingPlan.basic();</span><br><span class="line"><span class="keyword">else</span> plan = customer.getPlan();</span><br></pre></td></tr></table></figure><h2 id="8-å¼•å…¥æ–­è¨€"><a href="#8-å¼•å…¥æ–­è¨€" class="headerlink" title="8. å¼•å…¥æ–­è¨€"></a>8. å¼•å…¥æ–­è¨€</h2><blockquote><p>Introduce Assertion</p></blockquote><p>ä»¥æ–­è¨€æ˜ç¡®è¡¨ç°æŸç§å‡è®¾ã€‚æ–­è¨€åªèƒ½ç”¨äºå¼€å‘è¿‡ç¨‹ä¸­ï¼Œäº§å“ä»£ç ä¸­ä¸ä¼šæœ‰æ–­è¨€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getExpenseLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// should have either expense limit or a primary project</span></span><br><span class="line">    <span class="keyword">return</span> (expenseLimit != NULL_EXPENSE) ? expenseLimit :  primaryProject.getMemberExpenseLimit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getExpenseLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Assert.isTrue (expenseLimit != NULL_EXPENSE || primaryProject != <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">return</span> (expenseLimit != NULL_EXPENSE) ? expenseLimit :  primaryProject.getMemberExpenseLimit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¹ã€ç®€åŒ–å‡½æ•°è°ƒç”¨"><a href="#ä¹ã€ç®€åŒ–å‡½æ•°è°ƒç”¨" class="headerlink" title="ä¹ã€ç®€åŒ–å‡½æ•°è°ƒç”¨"></a>ä¹ã€ç®€åŒ–å‡½æ•°è°ƒç”¨</h1><h2 id="1-å‡½æ•°æ”¹å"><a href="#1-å‡½æ•°æ”¹å" class="headerlink" title="1. å‡½æ•°æ”¹å"></a>1. å‡½æ•°æ”¹å</h2><blockquote><p>Rename Method</p></blockquote><p>ä½¿å‡½æ•°åèƒ½è§£é‡Šå‡½æ•°çš„ç”¨é€”ã€‚</p><h2 id="2-æ·»åŠ å‚æ•°"><a href="#2-æ·»åŠ å‚æ•°" class="headerlink" title="2. æ·»åŠ å‚æ•°"></a>2. æ·»åŠ å‚æ•°</h2><blockquote><p>Add Parameter</p></blockquote><p>ä½¿å‡½æ•°ä¸éœ€è¦é€šè¿‡è°ƒç”¨è·å¾—æŸä¸ªä¿¡æ¯ã€‚</p><h2 id="3-ç§»é™¤å‚æ•°"><a href="#3-ç§»é™¤å‚æ•°" class="headerlink" title="3. ç§»é™¤å‚æ•°"></a>3. ç§»é™¤å‚æ•°</h2><blockquote><p>Remove Parameter</p></blockquote><p>ä¸ Add Parameter ç›¸åï¼Œæ”¹ç”¨è°ƒç”¨çš„æ–¹å¼æ¥è·å¾—æŸä¸ªä¿¡æ¯ã€‚</p><h2 id="4-å°†æŸ¥è¯¢å‡½æ•°å’Œä¿®æ”¹å‡½æ•°åˆ†ç¦»"><a href="#4-å°†æŸ¥è¯¢å‡½æ•°å’Œä¿®æ”¹å‡½æ•°åˆ†ç¦»" class="headerlink" title="4. å°†æŸ¥è¯¢å‡½æ•°å’Œä¿®æ”¹å‡½æ•°åˆ†ç¦»"></a>4. å°†æŸ¥è¯¢å‡½æ•°å’Œä¿®æ”¹å‡½æ•°åˆ†ç¦»</h2><blockquote><p>Separate Query from Modifier</p></blockquote><p>æŸä¸ªå‡½æ•°å³è¿”å›å¯¹è±¡çŠ¶æ€å€¼ï¼Œåˆä¿®æ”¹å¯¹è±¡çŠ¶æ€ã€‚</p><p>åº”å½“å»ºç«‹ä¸¤ä¸ªä¸åŒçš„å‡½æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªè´Ÿè´£æŸ¥è¯¢ï¼Œå¦ä¸€ä¸ªè´Ÿè´£ä¿®æ”¹ã€‚ä»»ä½•æœ‰è¿”å›å€¼çš„å‡½æ•°ï¼Œéƒ½ä¸åº”è¯¥æœ‰çœ‹å¾—åˆ°çš„å‰¯ä½œç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getTotalOutstandingAndSetReadyForSummaries();</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getTotalOutstanding();</span><br><span class="line">setReadyForSummaries();</span><br></pre></td></tr></table></figure><h2 id="5-ä»¤å‡½æ•°æºå¸¦å‚æ•°"><a href="#5-ä»¤å‡½æ•°æºå¸¦å‚æ•°" class="headerlink" title="5. ä»¤å‡½æ•°æºå¸¦å‚æ•°"></a>5. ä»¤å‡½æ•°æºå¸¦å‚æ•°</h2><blockquote><p>Parameterize Method</p></blockquote><p>è‹¥å¹²å‡½æ•°åšäº†ç±»ä¼¼çš„å·¥ä½œï¼Œä½†åœ¨å‡½æ•°æœ¬ä½“ä¸­å´åŒ…å«äº†ä¸åŒçš„å€¼ã€‚</p><p>å»ºç«‹å•ä¸€å‡½æ•°ï¼Œä»¥å‚æ•°è¡¨è¾¾é‚£äº›ä¸åŒçš„å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fivePercentRaise();</span><br><span class="line">tenPercentRaise();</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">raise(percentage);</span><br></pre></td></tr></table></figure><h2 id="6-ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°"><a href="#6-ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°" class="headerlink" title="6. ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°"></a>6. ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°</h2><blockquote><p>Replace Parameter with Explicit Methods</p></blockquote><p>æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®Œå…¨å–å†³äºå‚æ•°å€¼è€Œé‡‡å–ä¸åŒè¡Œä¸ºã€‚</p><p>é’ˆå¯¹è¯¥å‚æ•°çš„æ¯ä¸€ä¸ªå¯èƒ½å€¼ï¼Œå»ºç«‹ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setValue</span><span class="params">(String name, <span class="keyword">int</span> value)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (name.equals(<span class="string">"height"</span>))&#123;</span><br><span class="line">        height = value;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (name.equals(<span class="string">"width"</span>))&#123;</span><br><span class="line">        width = value;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Assert.shouldNeverReachHere();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> arg)</span></span>&#123;</span><br><span class="line">    height = arg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> arg)</span></span>&#123;</span><br><span class="line">    width = arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-ä¿æŒå¯¹è±¡å®Œæ•´"><a href="#7-ä¿æŒå¯¹è±¡å®Œæ•´" class="headerlink" title="7. ä¿æŒå¯¹è±¡å®Œæ•´"></a>7. ä¿æŒå¯¹è±¡å®Œæ•´</h2><blockquote><p>Preserve Whole Object</p></blockquote><p>ä»æŸä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºæŸä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚</p><p>æ”¹ä¸ºä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> low = daysTempRange().getLow();</span><br><span class="line"><span class="keyword">int</span> high = daysTempRange().getHigh();</span><br><span class="line">withinPlan = plan.withinRange(low, high);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">withinPlan = plan.withinRange(daysTempRange());</span><br></pre></td></tr></table></figure><h2 id="8-ä»¥å‡½æ•°å–ä»£å‚æ•°"><a href="#8-ä»¥å‡½æ•°å–ä»£å‚æ•°" class="headerlink" title="8. ä»¥å‡½æ•°å–ä»£å‚æ•°"></a>8. ä»¥å‡½æ•°å–ä»£å‚æ•°</h2><blockquote><p>Replace Parameter with Methods</p></blockquote><p>å¯¹è±¡è°ƒç”¨æŸä¸ªå‡½æ•°ï¼Œå¹¶å°†æ‰€å¾—ç»“æœä½œä¸ºå‚æ•°ï¼Œä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ã€‚è€Œæ¥å—è¯¥å‚æ•°çš„å‡½æ•°æœ¬èº«ä¹Ÿèƒ½å¤Ÿè°ƒç”¨å‰ä¸€ä¸ªå‡½æ•°ã€‚</p><p>è®©å‚æ•°æ¥æ”¶è€…å»é™¤è¯¥é¡¹å‚æ•°ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨å‰ä¸€ä¸ªå‡½æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> basePrice = _quantity * _itemPrice;</span><br><span class="line">discountLevel = getDiscountLevel();</span><br><span class="line"><span class="keyword">double</span> finalPrice = discountedPrice (basePrice, discountLevel);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> basePrice = _quantity * _itemPrice;</span><br><span class="line"><span class="keyword">double</span> finalPrice = discountedPrice (basePrice);</span><br></pre></td></tr></table></figure><h2 id="9-å¼•å…¥å‚æ•°å¯¹è±¡"><a href="#9-å¼•å…¥å‚æ•°å¯¹è±¡" class="headerlink" title="9. å¼•å…¥å‚æ•°å¯¹è±¡"></a>9. å¼•å…¥å‚æ•°å¯¹è±¡</h2><blockquote><p>Introduce Parameter Object</p></blockquote><p>æŸäº›å‚æ•°æ€»æ˜¯å¾ˆè‡ªç„¶åœ°åŒæ—¶å‡ºç°ï¼Œè¿™äº›å‚æ•°å°±æ˜¯ Data Clumpsã€‚</p><p>ä»¥ä¸€ä¸ªå¯¹è±¡å–ä»£è¿™äº›å‚æ•°ã€‚</p><p><div align="center"> <img src="../pics/08738dd0-ae8e-404a-ba78-a6b1b7d225b3.jpg" width="600"> </div><br></p><h2 id="10-ç§»é™¤è®¾å€¼å‡½æ•°"><a href="#10-ç§»é™¤è®¾å€¼å‡½æ•°" class="headerlink" title="10. ç§»é™¤è®¾å€¼å‡½æ•°"></a>10. ç§»é™¤è®¾å€¼å‡½æ•°</h2><blockquote><p>Remove Setting Method</p></blockquote><p>ç±»ä¸­çš„æŸä¸ªå­—æ®µåº”è¯¥åœ¨å¯¹è±¡åˆ›å»ºæ—¶è¢«è®¾å€¼ï¼Œç„¶åå°±ä¸å†æ”¹å˜ã€‚</p><p>å»æ‰è¯¥å­—æ®µçš„æ‰€æœ‰è®¾å€¼å‡½æ•°ï¼Œå¹¶å°†è¯¥å­—æ®µè®¾ä¸º finalã€‚</p><h2 id="11-éšè—å‡½æ•°"><a href="#11-éšè—å‡½æ•°" class="headerlink" title="11. éšè—å‡½æ•°"></a>11. éšè—å‡½æ•°</h2><blockquote><p>Hide Method</p></blockquote><p>æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œä»æ¥æ²¡æœ‰è¢«å…¶ä»–ä»»ä½•ç±»ç”¨åˆ°ã€‚</p><p>å°†è¿™ä¸ªå‡½æ•°ä¿®æ”¹ä¸º privateã€‚</p><h2 id="12-ä»¥å·¥å‚å‡½æ•°å–ä»£æ„é€ å‡½æ•°"><a href="#12-ä»¥å·¥å‚å‡½æ•°å–ä»£æ„é€ å‡½æ•°" class="headerlink" title="12. ä»¥å·¥å‚å‡½æ•°å–ä»£æ„é€ å‡½æ•°"></a>12. ä»¥å·¥å‚å‡½æ•°å–ä»£æ„é€ å‡½æ•°</h2><blockquote><p>Replace Constructor with Factory Method</p></blockquote><p>å¸Œæœ›åœ¨åˆ›å»ºå¯¹è±¡æ—¶ä¸ä»…ä»…æ˜¯åšç®€å•çš„å»ºæ„åŠ¨ä½œã€‚</p><p>å°†æ„é€ å‡½æ•°æ›¿æ¢ä¸ºå·¥å‚å‡½æ•°ã€‚</p><h2 id="13-å°è£…å‘ä¸‹è½¬å‹"><a href="#13-å°è£…å‘ä¸‹è½¬å‹" class="headerlink" title="13. å°è£…å‘ä¸‹è½¬å‹"></a>13. å°è£…å‘ä¸‹è½¬å‹</h2><blockquote><p>Encapsulate Downcast</p></blockquote><p>æŸä¸ªå‡½æ•°è¿”å›çš„å¯¹è±¡ï¼Œéœ€è¦ç”±å‡½æ•°è°ƒç”¨è€…æ‰§è¡Œå‘ä¸‹è½¬å‹ï¼ˆdowncastï¼‰ã€‚</p><p>å°†å‘ä¸‹è½¬å‹åŠ¨ä½œç§»åˆ°å‡½æ•°ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Object <span class="title">lastReading</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> readings.lastElement();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Reading <span class="title">lastReading</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (Reading)readings.lastElement();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="14-ä»¥å¼‚å¸¸å–ä»£é”™è¯¯ç "><a href="#14-ä»¥å¼‚å¸¸å–ä»£é”™è¯¯ç " class="headerlink" title="14. ä»¥å¼‚å¸¸å–ä»£é”™è¯¯ç "></a>14. ä»¥å¼‚å¸¸å–ä»£é”™è¯¯ç </h2><blockquote><p>Replace Error Code with Exception</p></blockquote><p>æŸä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªç‰¹å®šçš„ä»£ç ï¼Œç”¨ä»¥è¡¨ç¤ºæŸç§é”™è¯¯æƒ…å†µã€‚</p><p>æ”¹ç”¨å¼‚å¸¸ï¼Œå¼‚å¸¸å°†æ™®é€šç¨‹åºå’Œé”™è¯¯å¤„ç†åˆ†å¼€ï¼Œä½¿ä»£ç æ›´å®¹æ˜“ç†è§£ã€‚</p><h2 id="15-ä»¥æµ‹è¯•å–ä»£å¼‚å¸¸"><a href="#15-ä»¥æµ‹è¯•å–ä»£å¼‚å¸¸" class="headerlink" title="15. ä»¥æµ‹è¯•å–ä»£å¼‚å¸¸"></a>15. ä»¥æµ‹è¯•å–ä»£å¼‚å¸¸</h2><blockquote><p>Replace Exception with Test</p></blockquote><p>é¢å¯¹ä¸€ä¸ªè°ƒç”¨è€…å¯ä»¥é¢„å…ˆæ£€æŸ¥çš„æ¡ä»¶ï¼Œä½ æŠ›å‡ºäº†ä¸€ä¸ªå¼‚å¸¸ã€‚</p><p>ä¿®æ”¹è°ƒç”¨è€…ï¼Œä½¿å®ƒåœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰å…ˆåšæ£€æŸ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getValueForPeriod</span><span class="params">(<span class="keyword">int</span> periodNumber)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> values[periodNumber];</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ArrayIndexOutOfBoundsException e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getValueForPeriod</span><span class="params">(<span class="keyword">int</span> periodNumber)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (periodNumber &gt;= values.length) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> values[periodNumber];</span><br></pre></td></tr></table></figure><h1 id="åã€å¤„ç†æ¦‚æ‹¬å…³ç³»"><a href="#åã€å¤„ç†æ¦‚æ‹¬å…³ç³»" class="headerlink" title="åã€å¤„ç†æ¦‚æ‹¬å…³ç³»"></a>åã€å¤„ç†æ¦‚æ‹¬å…³ç³»</h1><h2 id="1-å­—æ®µä¸Šç§»"><a href="#1-å­—æ®µä¸Šç§»" class="headerlink" title="1. å­—æ®µä¸Šç§»"></a>1. å­—æ®µä¸Šç§»</h2><blockquote><p>Pull Up Field</p></blockquote><p>ä¸¤ä¸ªå­ç±»æ‹¥æœ‰ç›¸åŒçš„å­—æ®µã€‚</p><p>å°†è¯¥å­—æ®µç§»è‡³è¶…ç±»ã€‚</p><h2 id="2-å‡½æ•°ä¸Šç§»"><a href="#2-å‡½æ•°ä¸Šç§»" class="headerlink" title="2. å‡½æ•°ä¸Šç§»"></a>2. å‡½æ•°ä¸Šç§»</h2><blockquote><p>Pull Up Method</p></blockquote><p>æœ‰äº›å‡½æ•°ï¼Œåœ¨å„ä¸ªå­ç±»ä¸­äº§ç”Ÿå®Œå…¨ç›¸åŒçš„ç»“æœã€‚</p><p>å°†è¯¥å‡½æ•°ç§»è‡³è¶…ç±»ã€‚</p><h2 id="3-æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»"><a href="#3-æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»" class="headerlink" title="3. æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»"></a>3. æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»</h2><blockquote><p>Pull Up Constructor Body</p></blockquote><p>ä½ åœ¨å„ä¸ªå­ç±»ä¸­æ‹¥æœ‰ä¸€äº›æ„é€ å‡½æ•°ï¼Œå®ƒä»¬çš„æœ¬ä½“å‡ ä¹å®Œå…¨ä¸€è‡´ã€‚</p><p>åœ¨è¶…ç±»ä¸­æ–°å»ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¹¶åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨å®ƒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Employee</span>...</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">Manager</span>(<span class="title">String</span> <span class="title">name</span>, <span class="title">String</span> <span class="title">id</span>, <span class="title">int</span> <span class="title">grade</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">    <span class="keyword">this</span>.grade = grade;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Manager</span><span class="params">(String name, String id, <span class="keyword">int</span> grade)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(name, id);</span><br><span class="line">    <span class="keyword">this</span>.grade = grade;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-å‡½æ•°ä¸‹ç§»"><a href="#4-å‡½æ•°ä¸‹ç§»" class="headerlink" title="4. å‡½æ•°ä¸‹ç§»"></a>4. å‡½æ•°ä¸‹ç§»</h2><blockquote><p>Push Down Method</p></blockquote><p>è¶…ç±»ä¸­çš„æŸä¸ªå‡½æ•°åªä¸éƒ¨åˆ†å­ç±»æœ‰å…³ã€‚</p><p>å°†è¿™ä¸ªå‡½æ•°ç§»åˆ°ç›¸å…³çš„é‚£äº›å­ç±»å»ã€‚</p><h2 id="5-å­—æ®µä¸‹ç§»"><a href="#5-å­—æ®µä¸‹ç§»" class="headerlink" title="5. å­—æ®µä¸‹ç§»"></a>5. å­—æ®µä¸‹ç§»</h2><blockquote><p>Push Down Field</p></blockquote><p>è¶…ç±»ä¸­çš„æŸä¸ªå­—æ®µåªè¢«éƒ¨åˆ†å­ç±»ç”¨åˆ°ã€‚</p><p>å°†è¿™ä¸ªå­—æ®µç§»åˆ°éœ€è¦å®ƒçš„é‚£äº›å­ç±»å»ã€‚</p><h2 id="6-æç‚¼å­ç±»"><a href="#6-æç‚¼å­ç±»" class="headerlink" title="6. æç‚¼å­ç±»"></a>6. æç‚¼å­ç±»</h2><blockquote><p>Extract Subclass</p></blockquote><p>ç±»ä¸­çš„æŸäº›ç‰¹æ€§åªè¢«æŸäº›å®ä¾‹ç”¨åˆ°ã€‚</p><p>æ–°å»ºä¸€ä¸ªå­ç±»ï¼Œå°†ä¸Šé¢æ‰€è¯´çš„é‚£ä¸€éƒ¨åˆ†ç‰¹æ€§ç§»åˆ°å­ç±»ä¸­ã€‚</p><h2 id="7-æç‚¼è¶…ç±»"><a href="#7-æç‚¼è¶…ç±»" class="headerlink" title="7. æç‚¼è¶…ç±»"></a>7. æç‚¼è¶…ç±»</h2><blockquote><p>Extract Superclass</p></blockquote><p>ä¸¤ä¸ªç±»æœ‰ç›¸ä¼¼ç‰¹æ€§ã€‚</p><p>ä¸ºè¿™ä¸¤ä¸ªç±»å»ºç«‹ä¸€ä¸ªè¶…ç±»ï¼Œå°†ç›¸åŒç‰¹æ€§ç§»è‡³è¶…ç±»ã€‚</p><h2 id="8-æç‚¼æ¥å£"><a href="#8-æç‚¼æ¥å£" class="headerlink" title="8. æç‚¼æ¥å£"></a>8. æç‚¼æ¥å£</h2><blockquote><p>Extract Interface</p></blockquote><p>è‹¥å¹²å®¢æˆ·ä½¿ç”¨ç±»æ¥å£ä¸­çš„åŒä¸€å­é›†ï¼Œæˆ–è€…ä¸¤ä¸ªç±»çš„æ¥å£æœ‰éƒ¨åˆ†ç›¸åŒã€‚</p><p>å°†ç›¸åŒçš„å­é›†æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹æ¥å£ä¸­ã€‚</p><h2 id="9-æŠ˜å ç»§æ‰¿ä½“ç³»"><a href="#9-æŠ˜å ç»§æ‰¿ä½“ç³»" class="headerlink" title="9. æŠ˜å ç»§æ‰¿ä½“ç³»"></a>9. æŠ˜å ç»§æ‰¿ä½“ç³»</h2><blockquote><p>Collapse Hierarchy</p></blockquote><p>è¶…ç±»å’Œå­ç±»ä¹‹é—´æ— å¤ªå¤§åŒºåˆ«ã€‚</p><p>å°†å®ƒä»¬åˆä¸ºä¸€ä½“ã€‚</p><h2 id="10-å¡‘é€ æ¨¡æ¿å‡½æ•°"><a href="#10-å¡‘é€ æ¨¡æ¿å‡½æ•°" class="headerlink" title="10. å¡‘é€ æ¨¡æ¿å‡½æ•°"></a>10. å¡‘é€ æ¨¡æ¿å‡½æ•°</h2><blockquote><p>Form Template Method</p></blockquote><p>ä½ æœ‰ä¸€äº›å­ç±»ï¼Œå…¶ä¸­ç›¸åº”çš„æŸäº›å‡½æ•°ä»¥ç›¸åŒé¡ºåºæ‰§è¡Œç±»ä¼¼çš„æ“ä½œï¼Œä½†å„ä¸ªæ“ä½œçš„ç»†èŠ‚ä¸Šæœ‰æ‰€ä¸åŒã€‚</p><p>å°†è¿™äº›æ“ä½œåˆ†åˆ«æ”¾è¿›ç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå¹¶ä¿æŒå®ƒä»¬éƒ½æœ‰ç›¸åŒçš„ç­¾åï¼Œäºæ˜¯åŸå‡½æ•°ä¹Ÿå°±å˜å¾—ç›¸åŒäº†ã€‚ç„¶åå°†åŸå‡½æ•°ä¸Šç§»è‡³è¶…ç±»ã€‚(æ¨¡æ¿æ–¹æ³•æ¨¡å¼)</p><h2 id="11-ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿"><a href="#11-ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿" class="headerlink" title="11. ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿"></a>11. ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿</h2><blockquote><p>Replace Inheritance with Delegation</p></blockquote><p>æŸä¸ªå­ç±»åªä½¿ç”¨è¶…ç±»æ¥å£ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–æ˜¯æ ¹æœ¬ä¸éœ€è¦ç»§æ‰¿è€Œæ¥çš„æ•°æ®ã€‚</p><p>åœ¨å­ç±»ä¸­æ–°å»ºä¸€ä¸ªå­—æ®µç”¨ä»¥ä¿å­˜è¶…ç±»ï¼Œè°ƒæ•´å­ç±»å‡½æ•°ï¼Œä»¤å®ƒæ”¹è€Œå§”æ‰˜è¶…ç±»ï¼Œç„¶åå»æ‰ä¸¤è€…ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚</p><h2 id="12-ä»¥ç»§æ‰¿å–ä»£å§”æ‰˜"><a href="#12-ä»¥ç»§æ‰¿å–ä»£å§”æ‰˜" class="headerlink" title="12. ä»¥ç»§æ‰¿å–ä»£å§”æ‰˜"></a>12. ä»¥ç»§æ‰¿å–ä»£å§”æ‰˜</h2><blockquote><p>Replace Delegation with Inheritance</p></blockquote><p>ä½ åœ¨ä¸¤ä¸ªç±»ä¹‹é—´ä½¿ç”¨å§”æ‰˜å…³ç³»ï¼Œå¹¶ç»å¸¸ä¸ºæ•´ä¸ªæ¥å£ç¼–å†™è®¸å¤šæç®€å•çš„å§”æ‰˜å‡½æ•°ã€‚</p><p>è®©å§”æ‰˜ç±»ç»§æ‰¿å—æ‰˜ç±»ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>MartinFowler, ç¦å‹’, è´å…‹, ç­‰. é‡æ„: æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ [M]. ç”µå­å·¥ä¸šå‡ºç‰ˆç¤¾, 2011.</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- GFM-TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸€ç¬¬ä¸€ä¸ªæ¡ˆä¾‹&quot;&gt;ä¸€ã€ç¬¬ä¸€ä¸ªæ¡ˆä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#äºŒé‡æ„åŸåˆ™&quot;&gt;äºŒã€é‡æ„åŸåˆ™&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#å®šä¹‰&quot;&gt;å®šä¹‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Interview-Notebook" scheme="https://airpoet.github.io/categories/Github/Interview-Notebook/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼</title>
    <link href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    <id>https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/è®¾è®¡æ¨¡å¼/</id>
    <published>2018-07-04T13:51:06.367Z</published>
    <updated>2018-07-09T07:06:09.880Z</updated>
    
    <content type="html"><![CDATA[<!-- GFM-TOC --><ul><li><a href="#ä¸€æ¦‚è¿°">ä¸€ã€æ¦‚è¿°</a></li><li><a href="#äºŒåˆ›å»ºå‹">äºŒã€åˆ›å»ºå‹</a><ul><li><a href="#1-å•ä¾‹singleton">1. å•ä¾‹ï¼ˆSingletonï¼‰</a></li><li><a href="#2-ç®€å•å·¥å‚simple-factory">2. ç®€å•å·¥å‚ï¼ˆSimple Factoryï¼‰</a></li><li><a href="#3-å·¥å‚æ–¹æ³•factory-method">3. å·¥å‚æ–¹æ³•ï¼ˆFactory Methodï¼‰</a></li><li><a href="#4-æŠ½è±¡å·¥å‚abstract-factory">4. æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰</a></li><li><a href="#5-ç”Ÿæˆå™¨builder">5. ç”Ÿæˆå™¨ï¼ˆBuilderï¼‰</a></li><li><a href="#6-åŸå‹æ¨¡å¼prototype">6. åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰</a></li></ul></li><li><a href="#ä¸‰è¡Œä¸ºå‹">ä¸‰ã€è¡Œä¸ºå‹</a><ul><li><a href="#1-è´£ä»»é“¾chain-of-responsibility">1. è´£ä»»é“¾ï¼ˆChain Of Responsibilityï¼‰</a></li><li><a href="#2-å‘½ä»¤command">2. å‘½ä»¤ï¼ˆCommandï¼‰</a></li><li><a href="#3-è§£é‡Šå™¨interpreter">3. è§£é‡Šå™¨ï¼ˆInterpreterï¼‰</a></li><li><a href="#4-è¿­ä»£å™¨iterator">4. è¿­ä»£å™¨ï¼ˆIteratorï¼‰</a></li><li><a href="#5-ä¸­ä»‹è€…mediator">5. ä¸­ä»‹è€…ï¼ˆMediatorï¼‰</a></li><li><a href="#6-å¤‡å¿˜å½•memento">6. å¤‡å¿˜å½•ï¼ˆMementoï¼‰</a></li><li><a href="#7-è§‚å¯Ÿè€…observer">7. è§‚å¯Ÿè€…ï¼ˆObserverï¼‰</a></li><li><a href="#8-çŠ¶æ€state">8. çŠ¶æ€ï¼ˆStateï¼‰</a></li><li><a href="#9-ç­–ç•¥strategy">9. ç­–ç•¥ï¼ˆStrategyï¼‰</a></li><li><a href="#10-æ¨¡æ¿æ–¹æ³•template-method">10. æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰</a></li><li><a href="#11-è®¿é—®è€…visitor">11. è®¿é—®è€…ï¼ˆVisitorï¼‰</a></li><li><a href="#12-ç©ºå¯¹è±¡null">12. ç©ºå¯¹è±¡ï¼ˆNullï¼‰</a></li></ul></li><li><a href="#å››ç»“æ„å‹">å››ã€ç»“æ„å‹</a><ul><li><a href="#1-é€‚é…å™¨adapter">1. é€‚é…å™¨ï¼ˆAdapterï¼‰</a></li><li><a href="#2-æ¡¥æ¥bridge">2. æ¡¥æ¥ï¼ˆBridgeï¼‰</a></li><li><a href="#3-ç»„åˆcomposite">3. ç»„åˆï¼ˆCompositeï¼‰</a></li><li><a href="#4-è£…é¥°decorator">4. è£…é¥°ï¼ˆDecoratorï¼‰</a></li><li><a href="#5-å¤–è§‚facade">5. å¤–è§‚ï¼ˆFacadeï¼‰</a></li><li><a href="#6-äº«å…ƒflyweight">6. äº«å…ƒï¼ˆFlyweightï¼‰</a></li><li><a href="#7-ä»£ç†proxy">7. ä»£ç†ï¼ˆProxyï¼‰</a></li></ul></li><li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></li></ul><h1 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h1><p>è®¾è®¡æ¨¡å¼æ˜¯è§£å†³é—®é¢˜çš„æ–¹æ¡ˆï¼Œå­¦ä¹ ç°æœ‰çš„è®¾è®¡æ¨¡å¼å¯ä»¥åšåˆ°ç»éªŒå¤ç”¨ã€‚</p><p>æ‹¥æœ‰è®¾è®¡æ¨¡å¼è¯æ±‡ï¼Œåœ¨æ²Ÿé€šæ—¶å°±èƒ½ç”¨æ›´å°‘çš„è¯æ±‡æ¥è®¨è®ºï¼Œå¹¶ä¸”ä¸éœ€è¦äº†è§£åº•å±‚ç»†èŠ‚ã€‚</p><p><a href="https://github.com/CyC2018/Design-Pattern-Java" target="_blank" rel="noopener">æºç ä»¥åŠ UML å›¾</a></p><h1 id="äºŒã€åˆ›å»ºå‹"><a href="#äºŒã€åˆ›å»ºå‹" class="headerlink" title="äºŒã€åˆ›å»ºå‹"></a>äºŒã€åˆ›å»ºå‹</h1><h2 id="1-å•ä¾‹ï¼ˆSingletonï¼‰"><a href="#1-å•ä¾‹ï¼ˆSingletonï¼‰" class="headerlink" title="1. å•ä¾‹ï¼ˆSingletonï¼‰"></a>1. å•ä¾‹ï¼ˆSingletonï¼‰</h2><h3 id="æ„å›¾"><a href="#æ„å›¾" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›è¯¥å®ä¾‹çš„å…¨å±€è®¿é—®ç‚¹ã€‚</p><h3 id="ç±»å›¾"><a href="#ç±»å›¾" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p>ä½¿ç”¨ä¸€ä¸ªç§æœ‰æ„é€ å‡½æ•°ã€ä¸€ä¸ªç§æœ‰é™æ€å˜é‡ä»¥åŠä¸€ä¸ªå…¬æœ‰é™æ€å‡½æ•°æ¥å®ç°ã€‚</p><p>ç§æœ‰æ„é€ å‡½æ•°ä¿è¯äº†ä¸èƒ½é€šè¿‡æ„é€ å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼Œåªèƒ½é€šè¿‡å…¬æœ‰é™æ€å‡½æ•°è¿”å›å”¯ä¸€çš„ç§æœ‰é™æ€å˜é‡ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061140.png"> </div><br></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>ï¼ˆä¸€ï¼‰æ‡’æ±‰å¼-çº¿ç¨‹ä¸å®‰å…¨</p><p>ä»¥ä¸‹å®ç°ä¸­ï¼Œç§æœ‰é™æ€å˜é‡ uniqueInstance è¢«å»¶è¿ŸåŒ–å®ä¾‹åŒ–ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°è¯¥ç±»ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå®ä¾‹åŒ– uniqueInstanceï¼Œä»è€ŒèŠ‚çº¦èµ„æºã€‚</p><p>è¿™ä¸ªå®ç°åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹èƒ½å¤ŸåŒæ—¶è¿›å…¥ <code>if (uniqueInstance == null)</code> ï¼Œå¹¶ä¸”æ­¤æ—¶ uniqueInstance ä¸º nullï¼Œé‚£ä¹ˆå¤šä¸ªçº¿ç¨‹ä¼šæ‰§è¡Œ <code>uniqueInstance = new Singleton();</code> è¯­å¥ï¼Œè¿™å°†å¯¼è‡´å¤šæ¬¡å®ä¾‹åŒ– uniqueInstanceã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton uniqueInstance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getUniqueInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (uniqueInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆäºŒï¼‰æ‡’æ±‰å¼-çº¿ç¨‹å®‰å…¨</p><p>åªéœ€è¦å¯¹ getUniqueInstance() æ–¹æ³•åŠ é”ï¼Œé‚£ä¹ˆåœ¨ä¸€ä¸ªæ—¶é—´ç‚¹åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè¿›å…¥è¯¥æ–¹æ³•ï¼Œä»è€Œé¿å…äº†å¯¹ uniqueInstance è¿›è¡Œå¤šæ¬¡å®ä¾‹åŒ–çš„é—®é¢˜ã€‚</p><p>ä½†æ˜¯è¿™æ ·æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¯¥æ–¹æ³•ä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹è¯•å›¾è¿›å…¥è¯¥æ–¹æ³•éƒ½å¿…é¡»ç­‰å¾…ï¼Œå› æ­¤æ€§èƒ½ä¸Šæœ‰ä¸€å®šçš„æŸè€—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getUniqueInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (uniqueInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">        uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆä¸‰ï¼‰é¥¿æ±‰å¼-çº¿ç¨‹å®‰å…¨</p><p>çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ä¸»è¦æ˜¯ç”±äº uniqueInstance è¢«å®ä¾‹åŒ–äº†å¤šæ¬¡ï¼Œå¦‚æœ uniqueInstance é‡‡ç”¨ç›´æ¥å®ä¾‹åŒ–çš„è¯ï¼Œå°±ä¸ä¼šè¢«å®ä¾‹åŒ–å¤šæ¬¡ï¼Œä¹Ÿå°±ä¸ä¼šäº§ç”Ÿçº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ã€‚ä½†æ˜¯ç›´æ¥å®ä¾‹åŒ–çš„æ–¹å¼ä¹Ÿä¸¢å¤±äº†å»¶è¿Ÿå®ä¾‹åŒ–å¸¦æ¥çš„èŠ‚çº¦èµ„æºçš„ä¼˜åŠ¿ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Singleton uniqueInstance = <span class="keyword">new</span> Singleton();</span><br></pre></td></tr></table></figure><p>ï¼ˆå››ï¼‰åŒé‡æ ¡éªŒé”-çº¿ç¨‹å®‰å…¨</p><p>uniqueInstance åªéœ€è¦è¢«å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œä¹‹åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ã€‚åŠ é”æ“ä½œåªéœ€è¦å¯¹å®ä¾‹åŒ–é‚£éƒ¨åˆ†çš„ä»£ç è¿›è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰å½“ uniqueInstance æ²¡æœ‰è¢«å®ä¾‹åŒ–æ—¶ï¼Œæ‰éœ€è¦è¿›è¡ŒåŠ é”ã€‚</p><p>åŒé‡æ ¡éªŒé”å…ˆåˆ¤æ–­ uniqueInstance æ˜¯å¦å·²ç»è¢«å®ä¾‹åŒ–ï¼Œå¦‚æœæ²¡æœ‰è¢«å®ä¾‹åŒ–ï¼Œé‚£ä¹ˆæ‰å¯¹å®ä¾‹åŒ–è¯­å¥è¿›è¡ŒåŠ é”ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton uniqueInstance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getUniqueInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (uniqueInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (uniqueInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ƒè™‘ä¸‹é¢çš„å®ç°ï¼Œä¹Ÿå°±æ˜¯åªä½¿ç”¨äº†ä¸€ä¸ª if è¯­å¥ã€‚åœ¨ uniqueInstance == null çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œ if è¯­å¥ï¼Œé‚£ä¹ˆä¸¤ä¸ªçº¿ç¨‹å°±ä¼šåŒæ—¶è¿›å…¥ if è¯­å¥å—å†…ã€‚è™½ç„¶åœ¨ if è¯­å¥å—å†…æœ‰åŠ é”æ“ä½œï¼Œä½†æ˜¯ä¸¤ä¸ªçº¿ç¨‹éƒ½ä¼šæ‰§è¡Œ <code>uniqueInstance = new Singleton();</code> è¿™æ¡è¯­å¥ï¼Œåªæ˜¯å…ˆåçš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šè¿›è¡Œä¸¤æ¬¡å®ä¾‹åŒ–ï¼Œä»è€Œäº§ç”Ÿäº†ä¸¤ä¸ªå®ä¾‹ã€‚å› æ­¤å¿…é¡»ä½¿ç”¨åŒé‡æ ¡éªŒé”ï¼Œä¹Ÿå°±æ˜¯éœ€è¦ä½¿ç”¨ä¸¤ä¸ª if è¯­å¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (uniqueInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">        uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>uniqueInstance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚<code>uniqueInstance = new Singleton();</code> è¿™æ®µä»£ç å…¶å®æ˜¯åˆ†ä¸ºä¸‰æ­¥æ‰§è¡Œã€‚</p><ol><li>åˆ†é…å†…å­˜ç©ºé—´</li><li>åˆå§‹åŒ–å¯¹è±¡</li><li>å°† uniqueInstance æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€</li></ol><p>ä½†æ˜¯ç”±äº JVM å…·æœ‰æŒ‡ä»¤é‡æ’çš„ç‰¹æ€§ï¼Œæœ‰å¯èƒ½æ‰§è¡Œé¡ºåºå˜ä¸ºäº† 1&gt;3&gt;2ï¼Œè¿™åœ¨å•çº¿ç¨‹æƒ…å†µä¸‹è‡ªç„¶æ˜¯æ²¡æœ‰é—®é¢˜ã€‚ä½†å¦‚æœæ˜¯å¤šçº¿ç¨‹ä¸‹ï¼Œæœ‰å¯èƒ½è·å¾—æ˜¯ä¸€ä¸ªè¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–çš„å®ä¾‹ï¼Œä»¥è‡´äºç¨‹åºå‡ºé”™ã€‚</p><p>ä½¿ç”¨ volatile å¯ä»¥ç¦æ­¢ JVM çš„æŒ‡ä»¤é‡æ’ï¼Œä¿è¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œã€‚</p><p>ï¼ˆäº”ï¼‰æšä¸¾å®ç°</p><p>è¿™æ˜¯å•ä¾‹æ¨¡å¼çš„æœ€ä½³å®è·µï¼Œå®ƒå®ç°ç®€å•ï¼Œå¹¶ä¸”åœ¨é¢å¯¹å¤æ‚çš„åºåˆ—åŒ–æˆ–è€…åå°„æ”»å‡»çš„æ—¶å€™ï¼Œèƒ½å¤Ÿé˜²æ­¢å®ä¾‹åŒ–å¤šæ¬¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> Singleton &#123;</span><br><span class="line">    uniqueInstance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ƒè™‘ä»¥ä¸‹å•ä¾‹æ¨¡å¼çš„å®ç°ï¼Œè¯¥ Singleton åœ¨æ¯æ¬¡åºåˆ—åŒ–çš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œä¸ºäº†ä¿è¯åªåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¿…é¡»å£°æ˜æ‰€æœ‰å­—æ®µéƒ½æ˜¯ transientï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ª readResolve() æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton uniqueInstance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getUniqueInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (uniqueInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸ä½¿ç”¨æšä¸¾æ¥å®ç°å•ä¾‹æ¨¡å¼ï¼Œä¼šå‡ºç°åå°„æ”»å‡»ï¼Œå› ä¸ºé€šè¿‡ setAccessible() æ–¹æ³•å¯ä»¥å°†ç§æœ‰æ„é€ å‡½æ•°çš„è®¿é—®çº§åˆ«è®¾ç½®ä¸º publicï¼Œç„¶åè°ƒç”¨æ„é€ å‡½æ•°ä»è€Œå®ä¾‹åŒ–å¯¹è±¡ã€‚å¦‚æœè¦é˜²æ­¢è¿™ç§æ”»å‡»ï¼Œéœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­æ·»åŠ é˜²æ­¢å®ä¾‹åŒ–ç¬¬äºŒä¸ªå¯¹è±¡çš„ä»£ç ã€‚</p><p>ä»ä¸Šé¢çš„è®¨è®ºå¯ä»¥çœ‹å‡ºï¼Œè§£å†³åºåˆ—åŒ–å’Œåå°„æ”»å‡»å¾ˆéº»çƒ¦ï¼Œè€Œæšä¸¾å®ç°ä¸ä¼šå‡ºç°è¿™ä¸¤ç§é—®é¢˜ï¼Œæ‰€ä»¥è¯´æšä¸¾å®ç°å•ä¾‹æ¨¡å¼æ˜¯æœ€ä½³å®è·µã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li>Logger Classes</li><li>Configuration Classes</li><li>Accesing resources in shared mode</li><li>Factories implemented as Singletons</li></ul><h3 id="JDK"><a href="#JDK" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Runtime.html#getRuntime%28%29" target="_blank" rel="noopener">java.lang.Runtime#getRuntime()</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/awt/Desktop.html#getDesktop--" target="_blank" rel="noopener">java.awt.Desktop#getDesktop()</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/System.html#getSecurityManager--" target="_blank" rel="noopener">java.lang.System#getSecurityManager()</a></li></ul><h2 id="2-ç®€å•å·¥å‚ï¼ˆSimple-Factoryï¼‰"><a href="#2-ç®€å•å·¥å‚ï¼ˆSimple-Factoryï¼‰" class="headerlink" title="2. ç®€å•å·¥å‚ï¼ˆSimple Factoryï¼‰"></a>2. ç®€å•å·¥å‚ï¼ˆSimple Factoryï¼‰</h2><h3 id="æ„å›¾-1"><a href="#æ„å›¾-1" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ä¸å‘å®¢æˆ·æš´éœ²å†…éƒ¨ç»†èŠ‚ï¼Œå¹¶æä¾›ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„é€šç”¨æ¥å£ã€‚</p><h3 id="ç±»å›¾-1"><a href="#ç±»å›¾-1" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p>ç®€å•å·¥å‚ä¸æ˜¯è®¾è®¡æ¨¡å¼ï¼Œæ›´åƒæ˜¯ä¸€ç§ç¼–ç¨‹ä¹ æƒ¯ã€‚å®ƒæŠŠå®ä¾‹åŒ–çš„æ“ä½œå•ç‹¬æ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œè¿™ä¸ªç±»å°±æˆä¸ºç®€å•å·¥å‚ç±»ï¼Œè®©ç®€å•å·¥å‚ç±»æ¥å†³å®šåº”è¯¥ç”¨å“ªä¸ªå…·ä½“å­ç±»æ¥å®ä¾‹åŒ–ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061155.png"> </div><br></p><p>è¿™æ ·åšèƒ½æŠŠå®¢æˆ·ç±»å’Œå…·ä½“å­ç±»çš„å®ç°è§£è€¦ï¼Œå®¢æˆ·ç±»ä¸å†éœ€è¦çŸ¥é“æœ‰å“ªäº›å­ç±»ä»¥åŠåº”å½“å®ä¾‹åŒ–å“ªä¸ªå­ç±»ã€‚å› ä¸ºå®¢æˆ·ç±»å¾€å¾€æœ‰å¤šä¸ªï¼Œå¦‚æœä¸ä½¿ç”¨ç®€å•å·¥å‚ï¼Œæ‰€æœ‰çš„å®¢æˆ·ç±»éƒ½è¦çŸ¥é“æ‰€æœ‰å­ç±»çš„ç»†èŠ‚ã€‚è€Œä¸”ä¸€æ—¦å­ç±»å‘ç”Ÿæ”¹å˜ï¼Œä¾‹å¦‚å¢åŠ å­ç±»ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å®¢æˆ·ç±»éƒ½è¦è¿›è¡Œä¿®æ”¹ã€‚</p><p>å¦‚æœå­˜åœ¨ä¸‹é¢è¿™ç§ä»£ç ï¼Œå°±éœ€è¦ä½¿ç”¨ç®€å•å·¥å‚å°†å¯¹è±¡å®ä¾‹åŒ–çš„éƒ¨åˆ†æ”¾åˆ°ç®€å•å·¥å‚ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> type = <span class="number">1</span>;</span><br><span class="line">        Product product;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">1</span>) &#123;</span><br><span class="line">            product = <span class="keyword">new</span> ConcreteProduct1();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">2</span>) &#123;</span><br><span class="line">            product = <span class="keyword">new</span> ConcreteProduct2();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            product = <span class="keyword">new</span> ConcreteProduct();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®ç°-1"><a href="#å®ç°-1" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteProduct</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteProduct1</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteProduct2</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">createProduct</span><span class="params">(<span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct1();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct2();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SimpleFactory simpleFactory = <span class="keyword">new</span> SimpleFactory();</span><br><span class="line">        Product product = simpleFactory.createProduct(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-å·¥å‚æ–¹æ³•ï¼ˆFactory-Methodï¼‰"><a href="#3-å·¥å‚æ–¹æ³•ï¼ˆFactory-Methodï¼‰" class="headerlink" title="3. å·¥å‚æ–¹æ³•ï¼ˆFactory Methodï¼‰"></a>3. å·¥å‚æ–¹æ³•ï¼ˆFactory Methodï¼‰</h2><h3 id="æ„å›¾-2"><a href="#æ„å›¾-2" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œä½†ç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–å“ªä¸ªç±»ã€‚å·¥å‚æ–¹æ³•æŠŠå®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»ã€‚</p><h3 id="ç±»å›¾-2"><a href="#ç±»å›¾-2" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p>åœ¨ç®€å•å·¥å‚ä¸­ï¼Œåˆ›å»ºå¯¹è±¡çš„æ˜¯å¦ä¸€ä¸ªç±»ï¼Œè€Œåœ¨å·¥å‚æ–¹æ³•ä¸­ï¼Œæ˜¯ç”±å­ç±»æ¥åˆ›å»ºå¯¹è±¡ã€‚</p><p>ä¸‹å›¾ä¸­ï¼ŒFactory æœ‰ä¸€ä¸ª doSomething() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦ç”¨åˆ°ä¸€ä¸ªäº§å“å¯¹è±¡ï¼Œè¿™ä¸ªäº§å“å¯¹è±¡ç”± factoryMethod() æ–¹æ³•åˆ›å»ºã€‚è¯¥æ–¹æ³•æ˜¯æŠ½è±¡çš„ï¼Œéœ€è¦ç”±å­ç±»å»å®ç°ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061703.png"> </div><br></p><h3 id="å®ç°-2"><a href="#å®ç°-2" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> Product <span class="title">factoryMethod</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Product product = factoryMethod();</span><br><span class="line">        <span class="comment">// do something with the product</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteFactory</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">factoryMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteFactory1</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">factoryMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteFactory2</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">factoryMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JDK-1"><a href="#JDK-1" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/Calendar.html#getInstance--" target="_blank" rel="noopener">java.util.Calendar</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/ResourceBundle.html#getBundle-java.lang.String-" target="_blank" rel="noopener">java.util.ResourceBundle</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/text/NumberFormat.html#getInstance--" target="_blank" rel="noopener">java.text.NumberFormat</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/nio/charset/Charset.html#forName-java.lang.String-" target="_blank" rel="noopener">java.nio.charset.Charset</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/net/URLStreamHandlerFactory.html#createURLStreamHandler-java.lang.String-" target="_blank" rel="noopener">java.net.URLStreamHandlerFactory</a></li><li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/EnumSet.html#of-E-" target="_blank" rel="noopener">java.util.EnumSet</a></li><li><a href="https://docs.oracle.com/javase/8/docs/api/javax/xml/bind/JAXBContext.html#createMarshaller--" target="_blank" rel="noopener">javax.xml.bind.JAXBContext</a></li></ul><h2 id="4-æŠ½è±¡å·¥å‚ï¼ˆAbstract-Factoryï¼‰"><a href="#4-æŠ½è±¡å·¥å‚ï¼ˆAbstract-Factoryï¼‰" class="headerlink" title="4. æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰"></a>4. æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰</h2><h3 id="æ„å›¾-3"><a href="#æ„å›¾-3" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>æä¾›ä¸€ä¸ªæ¥å£ï¼Œç”¨äºåˆ›å»º  <strong>ç›¸å…³çš„å¯¹è±¡å®¶æ—</strong> ã€‚</p><h3 id="ç±»å›¾-3"><a href="#ç±»å›¾-3" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p>æŠ½è±¡å·¥å‚æ¨¡å¼åˆ›å»ºçš„æ˜¯å¯¹è±¡å®¶æ—ï¼Œä¹Ÿå°±æ˜¯å¾ˆå¤šå¯¹è±¡è€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è¿™äº›å¯¹è±¡æ˜¯ç›¸å…³çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»ä¸€èµ·åˆ›å»ºå‡ºæ¥ã€‚è€Œå·¥å‚æ–¹æ³•æ¨¡å¼åªæ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰å¾ˆå¤§ä¸åŒã€‚</p><p>æŠ½è±¡å·¥å‚æ¨¡å¼ç”¨åˆ°äº†å·¥å‚æ–¹æ³•æ¨¡å¼æ¥åˆ›å»ºå•ä¸€å¯¹è±¡ï¼ŒAbstractFactory ä¸­çš„ createProductA() å’Œ createProductB() æ–¹æ³•éƒ½æ˜¯è®©å­ç±»æ¥å®ç°ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å•ç‹¬æ¥çœ‹å°±æ˜¯åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ç¬¦åˆå·¥å‚æ–¹æ³•æ¨¡å¼çš„å®šä¹‰ã€‚</p><p>è‡³äºåˆ›å»ºå¯¹è±¡çš„å®¶æ—è¿™ä¸€æ¦‚å¿µæ˜¯åœ¨ Client ä½“ç°ï¼ŒClient è¦é€šè¿‡ AbstractFactory åŒæ—¶è°ƒç”¨ä¸¤ä¸ªæ–¹æ³•æ¥åˆ›å»ºå‡ºä¸¤ä¸ªå¯¹è±¡ï¼Œåœ¨è¿™é‡Œè¿™ä¸¤ä¸ªå¯¹è±¡å°±æœ‰å¾ˆå¤§çš„ç›¸å…³æ€§ï¼ŒClient éœ€è¦åŒæ—¶åˆ›å»ºå‡ºè¿™ä¸¤ä¸ªå¯¹è±¡ã€‚</p><p>ä»é«˜å±‚æ¬¡æ¥çœ‹ï¼ŒæŠ½è±¡å·¥å‚ä½¿ç”¨äº†ç»„åˆï¼Œå³ Cilent ç»„åˆäº† AbstractFactoryï¼Œè€Œå·¥å‚æ–¹æ³•æ¨¡å¼ä½¿ç”¨äº†ç»§æ‰¿ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061213.png"> </div><br></p><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractProductA</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractProductB</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductA1</span> <span class="keyword">extends</span> <span class="title">AbstractProductA</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductA2</span> <span class="keyword">extends</span> <span class="title">AbstractProductA</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductB1</span> <span class="keyword">extends</span> <span class="title">AbstractProductB</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductB2</span> <span class="keyword">extends</span> <span class="title">AbstractProductB</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> AbstractProductA <span class="title">createProductA</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> AbstractProductB <span class="title">createProductB</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteFactory1</span> <span class="keyword">extends</span> <span class="title">AbstractFactory</span> </span>&#123;</span><br><span class="line">    <span class="function">AbstractProductA <span class="title">createProductA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ProductA1();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">AbstractProductB <span class="title">createProductB</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ProductB1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteFactory2</span> <span class="keyword">extends</span> <span class="title">AbstractFactory</span> </span>&#123;</span><br><span class="line">    <span class="function">AbstractProductA <span class="title">createProductA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ProductA2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">AbstractProductB <span class="title">createProductB</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ProductB2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AbstractFactory abstractFactory = <span class="keyword">new</span> ConcreteFactory1();</span><br><span class="line">        AbstractProductA productA = abstractFactory.createProductA();</span><br><span class="line">        AbstractProductB productB = abstractFactory.createProductB();</span><br><span class="line">        <span class="comment">// do something with productA and productB</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JDK-2"><a href="#JDK-2" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/javax/xml/parsers/DocumentBuilderFactory.html" target="_blank" rel="noopener">javax.xml.parsers.DocumentBuilderFactory</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/javax/xml/transform/TransformerFactory.html#newInstance--" target="_blank" rel="noopener">javax.xml.transform.TransformerFactory</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/javax/xml/xpath/XPathFactory.html#newInstance--" target="_blank" rel="noopener">javax.xml.xpath.XPathFactory</a></li></ul><h2 id="5-ç”Ÿæˆå™¨ï¼ˆBuilderï¼‰"><a href="#5-ç”Ÿæˆå™¨ï¼ˆBuilderï¼‰" class="headerlink" title="5. ç”Ÿæˆå™¨ï¼ˆBuilderï¼‰"></a>5. ç”Ÿæˆå™¨ï¼ˆBuilderï¼‰</h2><h3 id="æ„å›¾-4"><a href="#æ„å›¾-4" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>å°è£…ä¸€ä¸ªå¯¹è±¡çš„æ„é€ è¿‡ç¨‹ï¼Œå¹¶å…è®¸æŒ‰æ­¥éª¤æ„é€ ã€‚</p><h3 id="ç±»å›¾-4"><a href="#ç±»å›¾-4" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061229.png"> </div><br></p><h3 id="å®ç°-3"><a href="#å®ç°-3" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€æ˜“çš„ StringBuilder å®ç°ï¼Œå‚è€ƒäº† JDK 1.8 æºç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractStringBuilder</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">char</span>[] value;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AbstractStringBuilder</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">        count = <span class="number">0</span>;</span><br><span class="line">        value = <span class="keyword">new</span> <span class="keyword">char</span>[capacity];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AbstractStringBuilder <span class="title">append</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">        ensureCapacityInternal(count + <span class="number">1</span>);</span><br><span class="line">        value[count++] = c;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minimumCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// overflow-conscious code</span></span><br><span class="line">        <span class="keyword">if</span> (minimumCapacity - value.length &gt; <span class="number">0</span>)</span><br><span class="line">            expandCapacity(minimumCapacity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">expandCapacity</span><span class="params">(<span class="keyword">int</span> minimumCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> newCapacity = value.length * <span class="number">2</span> + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (newCapacity - minimumCapacity &lt; <span class="number">0</span>)</span><br><span class="line">            newCapacity = minimumCapacity;</span><br><span class="line">        <span class="keyword">if</span> (newCapacity &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (minimumCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> OutOfMemoryError();</span><br><span class="line">            newCapacity = Integer.MAX_VALUE;</span><br><span class="line">        &#125;</span><br><span class="line">        value = Arrays.copyOf(value, newCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBuilder</span> <span class="keyword">extends</span> <span class="title">AbstractStringBuilder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Create a copy, don't share the array</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(value, <span class="number">0</span>, count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> count = <span class="number">26</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">            sb.append((<span class="keyword">char</span>) (<span class="string">'a'</span> + i));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abcdefghijklmnopqrstuvwxyz</span><br></pre></td></tr></table></figure><h3 id="JDK-3"><a href="#JDK-3" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html" target="_blank" rel="noopener">java.lang.StringBuilder</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html#put-byte-" target="_blank" rel="noopener">java.nio.ByteBuffer</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuffer.html#append-boolean-" target="_blank" rel="noopener">java.lang.StringBuffer</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Appendable.html" target="_blank" rel="noopener">java.lang.Appendable</a></li><li><a href="https://github.com/apache/camel/tree/0e195428ee04531be27a0b659005e3aa8d159d23/camel-core/src/main/java/org/apache/camel/builder" target="_blank" rel="noopener">Apache Camel builders</a></li></ul><h2 id="6-åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰"><a href="#6-åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰" class="headerlink" title="6. åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰"></a>6. åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰</h2><h3 id="æ„å›¾-5"><a href="#æ„å›¾-5" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>ä½¿ç”¨åŸå‹å®ä¾‹æŒ‡å®šè¦åˆ›å»ºå¯¹è±¡çš„ç±»å‹ï¼Œé€šè¿‡å¤åˆ¶è¿™ä¸ªåŸå‹æ¥åˆ›å»ºæ–°å¯¹è±¡ã€‚</p><h3 id="ç±»å›¾-5"><a href="#ç±»å›¾-5" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061237.png"> </div><br></p><h3 id="å®ç°-4"><a href="#å®ç°-4" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Prototype</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> Prototype <span class="title">myClone</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcretePrototype</span> <span class="keyword">extends</span> <span class="title">Prototype</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String filed;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcretePrototype</span><span class="params">(String filed)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.filed = filed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">Prototype <span class="title">myClone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcretePrototype(filed);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> filed;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Prototype prototype = <span class="keyword">new</span> ConcretePrototype(<span class="string">"abc"</span>);</span><br><span class="line">        Prototype clone = prototype.myClone();</span><br><span class="line">        System.out.println(clone.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abc</span><br></pre></td></tr></table></figure><h3 id="JDK-4"><a href="#JDK-4" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone%28%29" target="_blank" rel="noopener">java.lang.Object#clone()</a></li></ul><h1 id="ä¸‰ã€è¡Œä¸ºå‹"><a href="#ä¸‰ã€è¡Œä¸ºå‹" class="headerlink" title="ä¸‰ã€è¡Œä¸ºå‹"></a>ä¸‰ã€è¡Œä¸ºå‹</h1><h2 id="1-è´£ä»»é“¾ï¼ˆChain-Of-Responsibilityï¼‰"><a href="#1-è´£ä»»é“¾ï¼ˆChain-Of-Responsibilityï¼‰" class="headerlink" title="1. è´£ä»»é“¾ï¼ˆChain Of Responsibilityï¼‰"></a>1. è´£ä»»é“¾ï¼ˆChain Of Responsibilityï¼‰</h2><h3 id="æ„å›¾-6"><a href="#æ„å›¾-6" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾å‘é€è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><h3 id="ç±»å›¾-6"><a href="#ç±»å›¾-6" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>Handlerï¼šå®šä¹‰å¤„ç†è¯·æ±‚çš„æ¥å£ï¼Œå¹¶ä¸”å®ç°åç»§é“¾ï¼ˆsuccessorï¼‰</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061242.png"> </div><br></p><h3 id="å®ç°-5"><a href="#å®ç°-5" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Handler successor;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">(Handler successor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.successor = successor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(Request request)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteHandler1</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteHandler1</span><span class="params">(Handler successor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(successor);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(Request request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.getType() == RequestType.type1) &#123;</span><br><span class="line">            System.out.println(request.getName() + <span class="string">" is handle by ConcreteHandler1"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (successor != <span class="keyword">null</span>) &#123;</span><br><span class="line">            successor.handleRequest(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteHandler2</span> <span class="keyword">extends</span> <span class="title">Handler</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteHandler2</span><span class="params">(Handler successor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(successor);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(Request request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.getType() == RequestType.type2) &#123;</span><br><span class="line">            System.out.println(request.getName() + <span class="string">" is handle by ConcreteHandler2"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (successor != <span class="keyword">null</span>) &#123;</span><br><span class="line">            successor.handleRequest(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Request</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> RequestType type;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Request</span><span class="params">(RequestType type, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RequestType <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> RequestType &#123;</span><br><span class="line">    type1, type2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Handler handler1 = <span class="keyword">new</span> ConcreteHandler1(<span class="keyword">null</span>);</span><br><span class="line">        Handler handler2 = <span class="keyword">new</span> ConcreteHandler2(handler1);</span><br><span class="line">        Request request1 = <span class="keyword">new</span> Request(RequestType.type1, <span class="string">"request1"</span>);</span><br><span class="line">        handler2.handleRequest(request1);</span><br><span class="line">        Request request2 = <span class="keyword">new</span> Request(RequestType.type2, <span class="string">"request2"</span>);</span><br><span class="line">        handler2.handleRequest(request2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">request1 is handle by ConcreteHandler1</span><br><span class="line">request2 is handle by ConcreteHandler2</span><br></pre></td></tr></table></figure><h3 id="JDK-5"><a href="#JDK-5" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/logging/Logger.html#log%28java.util.logging.Level,%20java.lang.String%29" target="_blank" rel="noopener">java.util.logging.Logger#log()</a></li><li><a href="https://commons.apache.org/proper/commons-chain/index.html" target="_blank" rel="noopener">Apache Commons Chain</a></li><li><a href="http://docs.oracle.com/javaee/7/api/javax/servlet/Filter.html#doFilter-javax.servlet.ServletRequest-javax.servlet.ServletResponse-javax.servlet.FilterChain-" target="_blank" rel="noopener">javax.servlet.Filter#doFilter()</a></li></ul><h2 id="2-å‘½ä»¤ï¼ˆCommandï¼‰"><a href="#2-å‘½ä»¤ï¼ˆCommandï¼‰" class="headerlink" title="2. å‘½ä»¤ï¼ˆCommandï¼‰"></a>2. å‘½ä»¤ï¼ˆCommandï¼‰</h2><h3 id="æ„å›¾-7"><a href="#æ„å›¾-7" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>å°†å‘½ä»¤å°è£…æˆå¯¹è±¡ä¸­ï¼Œä»¥ä¾¿ä½¿ç”¨å‘½ä»¤æ¥å‚æ•°åŒ–å…¶å®ƒå¯¹è±¡ï¼Œæˆ–è€…å°†å‘½ä»¤å¯¹è±¡æ”¾å…¥é˜Ÿåˆ—ä¸­è¿›è¡Œæ’é˜Ÿï¼Œæˆ–è€…å°†å‘½ä»¤å¯¹è±¡çš„æ“ä½œè®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚</p><h3 id="ç±»å›¾-7"><a href="#ç±»å›¾-7" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>Commandï¼šå‘½ä»¤</li><li>Receiverï¼šå‘½ä»¤æ¥æ”¶è€…ï¼Œä¹Ÿå°±æ˜¯å‘½ä»¤çœŸæ­£çš„æ‰§è¡Œè€…</li><li>Invokerï¼šé€šè¿‡å®ƒæ¥è°ƒç”¨å‘½ä»¤</li><li>Clientï¼šå¯ä»¥è®¾ç½®å‘½ä»¤ä¸å‘½ä»¤çš„æ¥æ”¶è€…</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061249.png"> </div><br></p><h3 id="å®ç°-6"><a href="#å®ç°-6" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>è®¾è®¡ä¸€ä¸ªé¥æ§å™¨ï¼Œå¯ä»¥æ§åˆ¶ç”µç¯å¼€å…³ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061255.jpg"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LightOnCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    Light light;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LightOnCommand</span><span class="params">(Light light)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.light = light;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        light.on();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LightOffCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    Light light;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LightOffCommand</span><span class="params">(Light light)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.light = light;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        light.off();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Light</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Light is on!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Light is off!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¥æ§å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Invoker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Command[] onCommands;</span><br><span class="line">    <span class="keyword">private</span> Command[] offCommands;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> slotNum = <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Invoker</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.onCommands = <span class="keyword">new</span> Command[slotNum];</span><br><span class="line">        <span class="keyword">this</span>.offCommands = <span class="keyword">new</span> Command[slotNum];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnCommand</span><span class="params">(Command command, <span class="keyword">int</span> slot)</span> </span>&#123;</span><br><span class="line">        onCommands[slot] = command;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOffCommand</span><span class="params">(Command command, <span class="keyword">int</span> slot)</span> </span>&#123;</span><br><span class="line">        offCommands[slot] = command;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onButtonWasPushed</span><span class="params">(<span class="keyword">int</span> slot)</span> </span>&#123;</span><br><span class="line">        onCommands[slot].execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">offButtonWasPushed</span><span class="params">(<span class="keyword">int</span> slot)</span> </span>&#123;</span><br><span class="line">        offCommands[slot].execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Invoker invoker = <span class="keyword">new</span> Invoker();</span><br><span class="line">        Light light = <span class="keyword">new</span> Light();</span><br><span class="line">        Command lightOnCommand = <span class="keyword">new</span> LightOnCommand(light);</span><br><span class="line">        Command lightOffCommand = <span class="keyword">new</span> LightOffCommand(light);</span><br><span class="line">        invoker.setOnCommand(lightOnCommand, <span class="number">0</span>);</span><br><span class="line">        invoker.setOffCommand(lightOffCommand, <span class="number">0</span>);</span><br><span class="line">        invoker.onButtonWasPushed(<span class="number">0</span>);</span><br><span class="line">        invoker.offButtonWasPushed(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JDK-6"><a href="#JDK-6" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html" target="_blank" rel="noopener">java.lang.Runnable</a></li><li><a href="https://github.com/Netflix/Hystrix/wiki" target="_blank" rel="noopener">Netflix Hystrix</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/javax/swing/Action.html" target="_blank" rel="noopener">javax.swing.Action</a></li></ul><h2 id="3-è§£é‡Šå™¨ï¼ˆInterpreterï¼‰"><a href="#3-è§£é‡Šå™¨ï¼ˆInterpreterï¼‰" class="headerlink" title="3. è§£é‡Šå™¨ï¼ˆInterpreterï¼‰"></a>3. è§£é‡Šå™¨ï¼ˆInterpreterï¼‰</h2><h3 id="æ„å›¾-8"><a href="#æ„å›¾-8" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>ä¸ºè¯­è¨€åˆ›å»ºè§£é‡Šå™¨ï¼Œé€šå¸¸ç”±è¯­è¨€çš„è¯­æ³•å’Œè¯­æ³•åˆ†ææ¥å®šä¹‰ã€‚</p><h3 id="ç±»å›¾-8"><a href="#ç±»å›¾-8" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>TerminalExpressionï¼šç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼Œæ¯ä¸ªç»ˆç»“ç¬¦éƒ½éœ€è¦ä¸€ä¸ª TerminalExpression</li><li>Contextï¼šä¸Šä¸‹æ–‡ï¼ŒåŒ…å«è§£é‡Šå™¨ä¹‹å¤–çš„ä¸€äº›å…¨å±€ä¿¡æ¯</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061301.png"> </div><br></p><h3 id="å®ç°-7"><a href="#å®ç°-7" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªè§„åˆ™æ£€éªŒå™¨å®ç°ï¼Œå…·æœ‰ and å’Œ or è§„åˆ™ï¼Œé€šè¿‡è§„åˆ™å¯ä»¥æ„å»ºä¸€é¢—è§£ææ ‘ï¼Œç”¨æ¥æ£€éªŒä¸€ä¸ªæ–‡æœ¬æ˜¯å¦æ»¡è¶³è§£ææ ‘å®šä¹‰çš„è§„åˆ™ã€‚</p><p>ä¾‹å¦‚ä¸€é¢—è§£ææ ‘ä¸º D And (A Or (B C))ï¼Œæ–‡æœ¬ â€œD Aâ€ æ»¡è¶³è¯¥è§£ææ ‘å®šä¹‰çš„è§„åˆ™ã€‚</p><p>è¿™é‡Œçš„ Context æŒ‡çš„æ˜¯ Stringã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Expression</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">interpret</span><span class="params">(String str)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TerminalExpression</span> <span class="keyword">extends</span> <span class="title">Expression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String literal = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TerminalExpression</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        literal = str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">interpret</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        StringTokenizer st = <span class="keyword">new</span> StringTokenizer(str);</span><br><span class="line">        <span class="keyword">while</span> (st.hasMoreTokens()) &#123;</span><br><span class="line">            String test = st.nextToken();</span><br><span class="line">            <span class="keyword">if</span> (test.equals(literal)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AndExpression</span> <span class="keyword">extends</span> <span class="title">Expression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Expression expression1 = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> Expression expression2 = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AndExpression</span><span class="params">(Expression expression1, Expression expression2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.expression1 = expression1;</span><br><span class="line">        <span class="keyword">this</span>.expression2 = expression2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">interpret</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> expression1.interpret(str) &amp;&amp; expression2.interpret(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrExpression</span> <span class="keyword">extends</span> <span class="title">Expression</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Expression expression1 = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> Expression expression2 = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrExpression</span><span class="params">(Expression expression1, Expression expression2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.expression1 = expression1;</span><br><span class="line">        <span class="keyword">this</span>.expression2 = expression2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">interpret</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> expression1.interpret(str) || expression2.interpret(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„å»ºè§£ææ ‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Expression <span class="title">buildInterpreterTree</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Literal</span></span><br><span class="line">        Expression terminal1 = <span class="keyword">new</span> TerminalExpression(<span class="string">"A"</span>);</span><br><span class="line">        Expression terminal2 = <span class="keyword">new</span> TerminalExpression(<span class="string">"B"</span>);</span><br><span class="line">        Expression terminal3 = <span class="keyword">new</span> TerminalExpression(<span class="string">"C"</span>);</span><br><span class="line">        Expression terminal4 = <span class="keyword">new</span> TerminalExpression(<span class="string">"D"</span>);</span><br><span class="line">        <span class="comment">// B C</span></span><br><span class="line">        Expression alternation1 = <span class="keyword">new</span> OrExpression(terminal2, terminal3);</span><br><span class="line">        <span class="comment">// A Or (B C)</span></span><br><span class="line">        Expression alternation2 = <span class="keyword">new</span> OrExpression(terminal1, alternation1);</span><br><span class="line">        <span class="comment">// D And (A Or (B C))</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AndExpression(terminal4, alternation2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Expression define = buildInterpreterTree();</span><br><span class="line">        String context1 = <span class="string">"D A"</span>;</span><br><span class="line">        String context2 = <span class="string">"A B"</span>;</span><br><span class="line">        System.out.println(define.interpret(context1));</span><br><span class="line">        System.out.println(define.interpret(context2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">true</span><br><span class="line">false</span><br></pre></td></tr></table></figure><h3 id="JDK-7"><a href="#JDK-7" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html" target="_blank" rel="noopener">java.util.Pattern</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/text/Normalizer.html" target="_blank" rel="noopener">java.text.Normalizer</a></li><li>All subclasses of <a href="http://docs.oracle.com/javase/8/docs/api/java/text/Format.html" target="_blank" rel="noopener">java.text.Format</a></li><li><a href="http://docs.oracle.com/javaee/7/api/javax/el/ELResolver.html" target="_blank" rel="noopener">javax.el.ELResolver</a></li></ul><h2 id="4-è¿­ä»£å™¨ï¼ˆIteratorï¼‰"><a href="#4-è¿­ä»£å™¨ï¼ˆIteratorï¼‰" class="headerlink" title="4. è¿­ä»£å™¨ï¼ˆIteratorï¼‰"></a>4. è¿­ä»£å™¨ï¼ˆIteratorï¼‰</h2><h3 id="æ„å›¾-9"><a href="#æ„å›¾-9" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>æä¾›ä¸€ç§é¡ºåºè®¿é—®èšåˆå¯¹è±¡å…ƒç´ çš„æ–¹æ³•ï¼Œå¹¶ä¸”ä¸æš´éœ²èšåˆå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p><h3 id="ç±»å›¾-9"><a href="#ç±»å›¾-9" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>Aggregate æ˜¯èšåˆç±»ï¼Œå…¶ä¸­ createIterator() æ–¹æ³•å¯ä»¥äº§ç”Ÿä¸€ä¸ª Iteratorï¼›</li><li>Iterator ä¸»è¦å®šä¹‰äº† hasNext() å’Œ next() æ–¹æ³•ã€‚</li><li>Client ç»„åˆäº† Aggregateï¼Œä¸ºäº†è¿­ä»£éå† Aggregateï¼Œä¹Ÿéœ€è¦ç»„åˆ Iteratorã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061307.png"> </div><br></p><h3 id="å®ç°-8"><a href="#å®ç°-8" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Aggregate</span> </span>&#123;</span><br><span class="line">    <span class="function">Iterator <span class="title">createIterator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteAggregate</span> <span class="keyword">implements</span> <span class="title">Aggregate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer[] items;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteAggregate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        items = <span class="keyword">new</span> Integer[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; items.length; i++) &#123;</span><br><span class="line">            items[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator <span class="title">createIterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteIterator&lt;Integer&gt;(items);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterator</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">Item <span class="title">next</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteIterator</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">Iterator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Item[] items;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> position = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteIterator</span><span class="params">(Item[] items)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items = items;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> items[position++];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> position &lt; items.length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Aggregate aggregate = <span class="keyword">new</span> ConcreteAggregate();</span><br><span class="line">        Iterator&lt;Integer&gt; iterator = aggregate.createIterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            System.out.println(iterator.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JDK-8"><a href="#JDK-8" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html" target="_blank" rel="noopener">java.util.Iterator</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/Enumeration.html" target="_blank" rel="noopener">java.util.Enumeration</a></li></ul><h2 id="5-ä¸­ä»‹è€…ï¼ˆMediatorï¼‰"><a href="#5-ä¸­ä»‹è€…ï¼ˆMediatorï¼‰" class="headerlink" title="5. ä¸­ä»‹è€…ï¼ˆMediatorï¼‰"></a>5. ä¸­ä»‹è€…ï¼ˆMediatorï¼‰</h2><h3 id="æ„å›¾-10"><a href="#æ„å›¾-10" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>é›†ä¸­ç›¸å…³å¯¹è±¡ä¹‹é—´å¤æ‚çš„æ²Ÿé€šå’Œæ§åˆ¶æ–¹å¼ã€‚</p><h3 id="ç±»å›¾-10"><a href="#ç±»å›¾-10" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>Mediatorï¼šä¸­ä»‹è€…ï¼Œå®šä¹‰ä¸€ä¸ªæ¥å£ç”¨äºä¸å„åŒäº‹ï¼ˆColleagueï¼‰å¯¹è±¡é€šä¿¡ã€‚</li><li>Colleagueï¼šåŒäº‹ï¼Œç›¸å…³å¯¹è±¡</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061313.png"> </div><br></p><h3 id="å®ç°-9"><a href="#å®ç°-9" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>Alarmï¼ˆé—¹é’Ÿï¼‰ã€CoffeePotï¼ˆå’–å•¡å£¶ï¼‰ã€Calendarï¼ˆæ—¥å†ï¼‰ã€Sprinklerï¼ˆå–·å¤´ï¼‰æ˜¯ä¸€ç»„ç›¸å…³çš„å¯¹è±¡ï¼Œåœ¨æŸä¸ªå¯¹è±¡çš„äº‹ä»¶äº§ç”Ÿæ—¶éœ€è¦å»æ“ä½œå…¶å®ƒå¯¹è±¡ï¼Œå½¢æˆäº†ä¸‹é¢è¿™ç§ä¾èµ–ç»“æ„ï¼š</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061317.jpg"> </div><br></p><p>ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥å°†å¤æ‚çš„ä¾èµ–ç»“æ„å˜æˆæ˜Ÿå½¢ç»“æ„ï¼š</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061334.jpg"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Colleague</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">onEvent</span><span class="params">(Mediator mediator)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Alarm</span> <span class="keyword">extends</span> <span class="title">Colleague</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEvent</span><span class="params">(Mediator mediator)</span> </span>&#123;</span><br><span class="line">        mediator.doEvent(<span class="string">"alarm"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAlarm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doAlarm()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeePot</span> <span class="keyword">extends</span> <span class="title">Colleague</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEvent</span><span class="params">(Mediator mediator)</span> </span>&#123;</span><br><span class="line">        mediator.doEvent(<span class="string">"coffeePot"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doCoffeePot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doCoffeePot()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Calender</span> <span class="keyword">extends</span> <span class="title">Colleague</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEvent</span><span class="params">(Mediator mediator)</span> </span>&#123;</span><br><span class="line">        mediator.doEvent(<span class="string">"calender"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doCalender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doCalender()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sprinkler</span> <span class="keyword">extends</span> <span class="title">Colleague</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEvent</span><span class="params">(Mediator mediator)</span> </span>&#123;</span><br><span class="line">        mediator.doEvent(<span class="string">"sprinkler"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSprinkler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doSprinkler()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doEvent</span><span class="params">(String eventType)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteMediator</span> <span class="keyword">extends</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Alarm alarm;</span><br><span class="line">    <span class="keyword">private</span> CoffeePot coffeePot;</span><br><span class="line">    <span class="keyword">private</span> Calender calender;</span><br><span class="line">    <span class="keyword">private</span> Sprinkler sprinkler;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteMediator</span><span class="params">(Alarm alarm, CoffeePot coffeePot, Calender calender, Sprinkler sprinkler)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.alarm = alarm;</span><br><span class="line">        <span class="keyword">this</span>.coffeePot = coffeePot;</span><br><span class="line">        <span class="keyword">this</span>.calender = calender;</span><br><span class="line">        <span class="keyword">this</span>.sprinkler = sprinkler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doEvent</span><span class="params">(String eventType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (eventType) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"alarm"</span>:</span><br><span class="line">                doAlarmEvent();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"coffeePot"</span>:</span><br><span class="line">                doCoffeePotEvent();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"calender"</span>:</span><br><span class="line">                doCalenderEvent();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                doSprinklerEvent();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAlarmEvent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        alarm.doAlarm();</span><br><span class="line">        coffeePot.doCoffeePot();</span><br><span class="line">        calender.doCalender();</span><br><span class="line">        sprinkler.doSprinkler();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doCoffeePotEvent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doCalenderEvent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSprinklerEvent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Alarm alarm = <span class="keyword">new</span> Alarm();</span><br><span class="line">        CoffeePot coffeePot = <span class="keyword">new</span> CoffeePot();</span><br><span class="line">        Calender calender = <span class="keyword">new</span> Calender();</span><br><span class="line">        Sprinkler sprinkler = <span class="keyword">new</span> Sprinkler();</span><br><span class="line">        Mediator mediator = <span class="keyword">new</span> ConcreteMediator(alarm, coffeePot, calender, sprinkler);</span><br><span class="line">        <span class="comment">// é—¹é’Ÿäº‹ä»¶åˆ°è¾¾ï¼Œè°ƒç”¨ä¸­ä»‹è€…å°±å¯ä»¥æ“ä½œç›¸å…³å¯¹è±¡</span></span><br><span class="line">        alarm.onEvent(mediator);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">doAlarm()</span><br><span class="line">doCoffeePot()</span><br><span class="line">doCalender()</span><br><span class="line">doSprinkler()</span><br></pre></td></tr></table></figure><h3 id="JDK-9"><a href="#JDK-9" class="headerlink" title="JDK"></a>JDK</h3><ul><li>All scheduleXXX() methods of <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Timer.html" target="_blank" rel="noopener">java.util.Timer</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executor.html#execute-java.lang.Runnable-" target="_blank" rel="noopener">java.util.concurrent.Executor#execute()</a></li><li>submit() and invokeXXX() methods of <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html" target="_blank" rel="noopener">java.util.concurrent.ExecutorService</a></li><li>scheduleXXX() methods of <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ScheduledExecutorService.html" target="_blank" rel="noopener">java.util.concurrent.ScheduledExecutorService</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/reflect/Method.html#invoke-java.lang.Object-java.lang.Object...-" target="_blank" rel="noopener">java.lang.reflect.Method#invoke()</a></li></ul><h2 id="6-å¤‡å¿˜å½•ï¼ˆMementoï¼‰"><a href="#6-å¤‡å¿˜å½•ï¼ˆMementoï¼‰" class="headerlink" title="6. å¤‡å¿˜å½•ï¼ˆMementoï¼‰"></a>6. å¤‡å¿˜å½•ï¼ˆMementoï¼‰</h2><h3 id="æ„å›¾-11"><a href="#æ„å›¾-11" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>åœ¨ä¸è¿åå°è£…çš„æƒ…å†µä¸‹è·å¾—å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œä»è€Œåœ¨éœ€è¦æ—¶å¯ä»¥å°†å¯¹è±¡æ¢å¤åˆ°æœ€åˆçŠ¶æ€ã€‚</p><h3 id="ç±»å›¾-11"><a href="#ç±»å›¾-11" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>Originatorï¼šåŸå§‹å¯¹è±¡</li><li>Caretakerï¼šè´Ÿè´£ä¿å­˜å¥½å¤‡å¿˜å½•</li><li>Menentoï¼šå¤‡å¿˜å½•ï¼Œå­˜å‚¨åŸå§‹å¯¹è±¡çš„çš„çŠ¶æ€ã€‚å¤‡å¿˜å½•å®é™…ä¸Šæœ‰ä¸¤ä¸ªæ¥å£ï¼Œä¸€ä¸ªæ˜¯æä¾›ç»™ Caretaker çš„çª„æ¥å£ï¼šå®ƒåªèƒ½å°†å¤‡å¿˜å½•ä¼ é€’ç»™å…¶å®ƒå¯¹è±¡ï¼›ä¸€ä¸ªæ˜¯æä¾›ç»™ Originator çš„å®½æ¥å£ï¼Œå…è®¸å®ƒè®¿é—®åˆ°å…ˆå‰çŠ¶æ€æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ã€‚ç†æƒ³æƒ…å†µæ˜¯åªå…è®¸ Originator è®¿é—®æœ¬å¤‡å¿˜å½•çš„å†…éƒ¨çŠ¶æ€ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061343.png"> </div><br></p><h3 id="å®ç°-10"><a href="#å®ç°-10" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>ä»¥ä¸‹å®ç°äº†ä¸€ä¸ªç®€å•è®¡ç®—å™¨ç¨‹åºï¼Œå¯ä»¥è¾“å…¥ä¸¤ä¸ªå€¼ï¼Œç„¶åè®¡ç®—è¿™ä¸¤ä¸ªå€¼çš„å’Œã€‚å¤‡å¿˜å½•æ¨¡å¼å…è®¸å°†è¿™ä¸¤ä¸ªå€¼å­˜å‚¨èµ·æ¥ï¼Œç„¶ååœ¨æŸä¸ªæ—¶åˆ»ç”¨å­˜å‚¨çš„çŠ¶æ€è¿›è¡Œæ¢å¤ã€‚</p><p>å®ç°å‚è€ƒï¼š<a href="https://www.oodesign.com/memento-pattern-calculator-example-java-sourcecode.html" target="_blank" rel="noopener">Memento Pattern - Calculator Example - Java Sourcecode</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Originator Interface</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Calculator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create Memento</span></span><br><span class="line">    <span class="function">PreviousCalculationToCareTaker <span class="title">backupLastCalculation</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// setMemento</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">restorePreviousCalculation</span><span class="params">(PreviousCalculationToCareTaker memento)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getCalculationResult</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setFirstNumber</span><span class="params">(<span class="keyword">int</span> firstNumber)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setSecondNumber</span><span class="params">(<span class="keyword">int</span> secondNumber)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Originator Implementation</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CalculatorImp</span> <span class="keyword">implements</span> <span class="title">Calculator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> firstNumber;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> secondNumber;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PreviousCalculationToCareTaker <span class="title">backupLastCalculation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// create a memento object used for restoring two numbers</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PreviousCalculationImp(firstNumber, secondNumber);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">restorePreviousCalculation</span><span class="params">(PreviousCalculationToCareTaker memento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.firstNumber = ((PreviousCalculationToOriginator) memento).getFirstNumber();</span><br><span class="line">        <span class="keyword">this</span>.secondNumber = ((PreviousCalculationToOriginator) memento).getSecondNumber();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCalculationResult</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// result is adding two numbers</span></span><br><span class="line">        <span class="keyword">return</span> firstNumber + secondNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirstNumber</span><span class="params">(<span class="keyword">int</span> firstNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.firstNumber = firstNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSecondNumber</span><span class="params">(<span class="keyword">int</span> secondNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.secondNumber = secondNumber;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Memento Interface to Originator</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This interface allows the originator to restore its state</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PreviousCalculationToOriginator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getFirstNumber</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getSecondNumber</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  Memento interface to CalculatorOperator (Caretaker)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PreviousCalculationToCareTaker</span> </span>&#123;</span><br><span class="line">    <span class="comment">// no operations permitted for the caretaker</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Memento Object Implementation</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Note that this object implements both interfaces to Originator and CareTaker</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PreviousCalculationImp</span> <span class="keyword">implements</span> <span class="title">PreviousCalculationToCareTaker</span>,</span></span><br><span class="line"><span class="class">        <span class="title">PreviousCalculationToOriginator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> firstNumber;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> secondNumber;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PreviousCalculationImp</span><span class="params">(<span class="keyword">int</span> firstNumber, <span class="keyword">int</span> secondNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.firstNumber = firstNumber;</span><br><span class="line">        <span class="keyword">this</span>.secondNumber = secondNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFirstNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> firstNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSecondNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> secondNumber;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * CareTaker object</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// program starts</span></span><br><span class="line">        Calculator calculator = <span class="keyword">new</span> CalculatorImp();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// assume user enters two numbers</span></span><br><span class="line">        calculator.setFirstNumber(<span class="number">10</span>);</span><br><span class="line">        calculator.setSecondNumber(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// find result</span></span><br><span class="line">        System.out.println(calculator.getCalculationResult());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Store result of this calculation in case of error</span></span><br><span class="line">        PreviousCalculationToCareTaker memento = calculator.backupLastCalculation();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// user enters a number</span></span><br><span class="line">        calculator.setFirstNumber(<span class="number">17</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// user enters a wrong second number and calculates result</span></span><br><span class="line">        calculator.setSecondNumber(-<span class="number">290</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// calculate result</span></span><br><span class="line">        System.out.println(calculator.getCalculationResult());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// user hits CTRL + Z to undo last operation and see last result</span></span><br><span class="line">        calculator.restorePreviousCalculation(memento);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// result restored</span></span><br><span class="line">        System.out.println(calculator.getCalculationResult());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">110</span><br><span class="line">-273</span><br><span class="line">110</span><br></pre></td></tr></table></figure><h3 id="JDK-10"><a href="#JDK-10" class="headerlink" title="JDK"></a>JDK</h3><ul><li>java.io.Serializable</li></ul><h2 id="7-è§‚å¯Ÿè€…ï¼ˆObserverï¼‰"><a href="#7-è§‚å¯Ÿè€…ï¼ˆObserverï¼‰" class="headerlink" title="7. è§‚å¯Ÿè€…ï¼ˆObserverï¼‰"></a>7. è§‚å¯Ÿè€…ï¼ˆObserverï¼‰</h2><h3 id="æ„å›¾-12"><a href="#æ„å›¾-12" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>å®šä¹‰å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶ä¸”è‡ªåŠ¨æ›´æ–°çŠ¶æ€ã€‚</p><p>ä¸»é¢˜ï¼ˆSubjectï¼‰æ˜¯è¢«è§‚å¯Ÿçš„å¯¹è±¡ï¼Œè€Œå…¶æ‰€æœ‰ä¾èµ–è€…ï¼ˆObserverï¼‰ç§°ä¸ºè§‚å¯Ÿè€…ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061349.jpg" width="600"> </div><br></p><h3 id="ç±»å›¾-12"><a href="#ç±»å›¾-12" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p>ä¸»é¢˜ï¼ˆSubjectï¼‰å…·æœ‰æ³¨å†Œå’Œç§»é™¤è§‚å¯Ÿè€…ã€å¹¶é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…çš„åŠŸèƒ½ï¼Œä¸»é¢˜æ˜¯é€šè¿‡ç»´æŠ¤ä¸€å¼ è§‚å¯Ÿè€…åˆ—è¡¨æ¥å®ç°è¿™äº›æ“ä½œçš„ã€‚</p><p>è§‚å¯Ÿè€…ï¼ˆObserverï¼‰çš„æ³¨å†ŒåŠŸèƒ½éœ€è¦è°ƒç”¨ä¸»é¢˜çš„ registerObserver() æ–¹æ³•ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061355.png"> </div><br></p><h3 id="å®ç°-11"><a href="#å®ç°-11" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>å¤©æ°”æ•°æ®å¸ƒå‘Šæ¿ä¼šåœ¨å¤©æ°”ä¿¡æ¯å‘ç”Ÿæ”¹å˜æ—¶æ›´æ–°å…¶å†…å®¹ï¼Œå¸ƒå‘Šæ¿æœ‰å¤šä¸ªï¼Œå¹¶ä¸”åœ¨å°†æ¥ä¼šç»§ç»­å¢åŠ ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061400.jpg"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">resisterObserver</span><span class="params">(Observer o)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeObserver</span><span class="params">(Observer o)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">notifyObserver</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherData</span> <span class="keyword">implements</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Observer&gt; observers;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> temperature;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> humidity;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> pressure;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeatherData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        observers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMeasurements</span><span class="params">(<span class="keyword">float</span> temperature, <span class="keyword">float</span> humidity, <span class="keyword">float</span> pressure)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.temperature = temperature;</span><br><span class="line">        <span class="keyword">this</span>.humidity = humidity;</span><br><span class="line">        <span class="keyword">this</span>.pressure = pressure;</span><br><span class="line">        notifyObserver();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">resisterObserver</span><span class="params">(Observer o)</span> </span>&#123;</span><br><span class="line">        observers.add(o);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeObserver</span><span class="params">(Observer o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = observers.indexOf(o);</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            observers.remove(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notifyObserver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Observer o : observers) &#123;</span><br><span class="line">            o.update(temperature, humidity, pressure);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">float</span> temp, <span class="keyword">float</span> humidity, <span class="keyword">float</span> pressure)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StatisticsDisplay</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StatisticsDisplay</span><span class="params">(Subject weatherData)</span> </span>&#123;</span><br><span class="line">        weatherData.resisterObserver(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">float</span> temp, <span class="keyword">float</span> humidity, <span class="keyword">float</span> pressure)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"StatisticsDisplay.update: "</span> + temp + <span class="string">" "</span> + humidity + <span class="string">" "</span> + pressure);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CurrentConditionsDisplay</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CurrentConditionsDisplay</span><span class="params">(Subject weatherData)</span> </span>&#123;</span><br><span class="line">        weatherData.resisterObserver(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">float</span> temp, <span class="keyword">float</span> humidity, <span class="keyword">float</span> pressure)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"CurrentConditionsDisplay.update: "</span> + temp + <span class="string">" "</span> + humidity + <span class="string">" "</span> + pressure);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherStation</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        WeatherData weatherData = <span class="keyword">new</span> WeatherData();</span><br><span class="line">        CurrentConditionsDisplay currentConditionsDisplay = <span class="keyword">new</span> CurrentConditionsDisplay(weatherData);</span><br><span class="line">        StatisticsDisplay statisticsDisplay = <span class="keyword">new</span> StatisticsDisplay(weatherData);</span><br><span class="line"></span><br><span class="line">        weatherData.setMeasurements(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        weatherData.setMeasurements(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CurrentConditionsDisplay.update: 0.0 0.0 0.0</span><br><span class="line">StatisticsDisplay.update: 0.0 0.0 0.0</span><br><span class="line">CurrentConditionsDisplay.update: 1.0 1.0 1.0</span><br><span class="line">StatisticsDisplay.update: 1.0 1.0 1.0</span><br></pre></td></tr></table></figure><h3 id="JDK-11"><a href="#JDK-11" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/Observer.html" target="_blank" rel="noopener">java.util.Observer</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/EventListener.html" target="_blank" rel="noopener">java.util.EventListener</a></li><li><a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpSessionBindingListener.html" target="_blank" rel="noopener">javax.servlet.http.HttpSessionBindingListener</a></li><li><a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="noopener">RxJava</a></li></ul><h2 id="8-çŠ¶æ€ï¼ˆStateï¼‰"><a href="#8-çŠ¶æ€ï¼ˆStateï¼‰" class="headerlink" title="8. çŠ¶æ€ï¼ˆStateï¼‰"></a>8. çŠ¶æ€ï¼ˆStateï¼‰</h2><h3 id="æ„å›¾-13"><a href="#æ„å›¾-13" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>å…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥å¥½åƒä¿®æ”¹äº†å®ƒæ‰€å±çš„ç±»ã€‚</p><h3 id="ç±»å›¾-13"><a href="#ç±»å›¾-13" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061410.png"> </div><br></p><h3 id="å®ç°-12"><a href="#å®ç°-12" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>ç³–æœé”€å”®æœºæœ‰å¤šç§çŠ¶æ€ï¼Œæ¯ç§çŠ¶æ€ä¸‹é”€å”®æœºæœ‰ä¸åŒçš„è¡Œä¸ºï¼ŒçŠ¶æ€å¯ä»¥å‘ç”Ÿè½¬ç§»ï¼Œä½¿å¾—é”€å”®æœºçš„è¡Œä¸ºä¹Ÿå‘ç”Ÿæ”¹å˜ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061406.jpg" width="600"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠ•å…¥ 25 åˆ†é’±</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertQuarter</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€€å› 25 åˆ†é’±</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ejectQuarter</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è½¬åŠ¨æ›²æŸ„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘æ”¾ç³–æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HasQuarterState</span> <span class="keyword">implements</span> <span class="title">State</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> GumballMachine gumballMachine;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HasQuarterState</span><span class="params">(GumballMachine gumballMachine)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gumballMachine = gumballMachine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"You can't insert another quarter"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ejectQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Quarter returned"</span>);</span><br><span class="line">        gumballMachine.setState(gumballMachine.getNoQuarterState());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"You turned..."</span>);</span><br><span class="line">        gumballMachine.setState(gumballMachine.getSoldState());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"No gumball dispensed"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NoQuarterState</span> <span class="keyword">implements</span> <span class="title">State</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    GumballMachine gumballMachine;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NoQuarterState</span><span class="params">(GumballMachine gumballMachine)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gumballMachine = gumballMachine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"You insert a quarter"</span>);</span><br><span class="line">        gumballMachine.setState(gumballMachine.getHasQuarterState());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ejectQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"You haven't insert a quarter"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"You turned, but there's no quarter"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"You need to pay first"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SoldOutState</span> <span class="keyword">implements</span> <span class="title">State</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    GumballMachine gumballMachine;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SoldOutState</span><span class="params">(GumballMachine gumballMachine)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gumballMachine = gumballMachine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"You can't insert a quarter, the machine is sold out"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ejectQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"You can't eject, you haven't inserted a quarter yet"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"You turned, but there are no gumballs"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"No gumball dispensed"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SoldState</span> <span class="keyword">implements</span> <span class="title">State</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    GumballMachine gumballMachine;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SoldState</span><span class="params">(GumballMachine gumballMachine)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gumballMachine = gumballMachine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Please wait, we're already giving you a gumball"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ejectQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Sorry, you already turned the crank"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turning twice doesn't get you another gumball!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        gumballMachine.releaseBall();</span><br><span class="line">        <span class="keyword">if</span> (gumballMachine.getCount() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            gumballMachine.setState(gumballMachine.getNoQuarterState());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"Oops, out of gumballs"</span>);</span><br><span class="line">            gumballMachine.setState(gumballMachine.getSoldOutState());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GumballMachine</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> State soldOutState;</span><br><span class="line">    <span class="keyword">private</span> State noQuarterState;</span><br><span class="line">    <span class="keyword">private</span> State hasQuarterState;</span><br><span class="line">    <span class="keyword">private</span> State soldState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> State state;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GumballMachine</span><span class="params">(<span class="keyword">int</span> numberGumballs)</span> </span>&#123;</span><br><span class="line">        count = numberGumballs;</span><br><span class="line">        soldOutState = <span class="keyword">new</span> SoldOutState(<span class="keyword">this</span>);</span><br><span class="line">        noQuarterState = <span class="keyword">new</span> NoQuarterState(<span class="keyword">this</span>);</span><br><span class="line">        hasQuarterState = <span class="keyword">new</span> HasQuarterState(<span class="keyword">this</span>);</span><br><span class="line">        soldState = <span class="keyword">new</span> SoldState(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (numberGumballs &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            state = noQuarterState;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            state = soldOutState;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        state.insertQuarter();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ejectQuarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        state.ejectQuarter();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        state.turnCrank();</span><br><span class="line">        state.dispense();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(State state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">releaseBall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"A gumball comes rolling out the slot..."</span>);</span><br><span class="line">        <span class="keyword">if</span> (count != <span class="number">0</span>) &#123;</span><br><span class="line">            count -= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> State <span class="title">getSoldOutState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> soldOutState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> State <span class="title">getNoQuarterState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> noQuarterState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> State <span class="title">getHasQuarterState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hasQuarterState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> State <span class="title">getSoldState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> soldState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        GumballMachine gumballMachine = <span class="keyword">new</span> GumballMachine(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        gumballMachine.insertQuarter();</span><br><span class="line">        gumballMachine.turnCrank();</span><br><span class="line"></span><br><span class="line">        gumballMachine.insertQuarter();</span><br><span class="line">        gumballMachine.ejectQuarter();</span><br><span class="line">        gumballMachine.turnCrank();</span><br><span class="line"></span><br><span class="line">        gumballMachine.insertQuarter();</span><br><span class="line">        gumballMachine.turnCrank();</span><br><span class="line">        gumballMachine.insertQuarter();</span><br><span class="line">        gumballMachine.turnCrank();</span><br><span class="line">        gumballMachine.ejectQuarter();</span><br><span class="line"></span><br><span class="line">        gumballMachine.insertQuarter();</span><br><span class="line">        gumballMachine.insertQuarter();</span><br><span class="line">        gumballMachine.turnCrank();</span><br><span class="line">        gumballMachine.insertQuarter();</span><br><span class="line">        gumballMachine.turnCrank();</span><br><span class="line">        gumballMachine.insertQuarter();</span><br><span class="line">        gumballMachine.turnCrank();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">You insert a quarter</span><br><span class="line">You turned...</span><br><span class="line">A gumball comes rolling out the slot...</span><br><span class="line">You insert a quarter</span><br><span class="line">Quarter returned</span><br><span class="line">You turned, but there's no quarter</span><br><span class="line">You need to pay first</span><br><span class="line">You insert a quarter</span><br><span class="line">You turned...</span><br><span class="line">A gumball comes rolling out the slot...</span><br><span class="line">You insert a quarter</span><br><span class="line">You turned...</span><br><span class="line">A gumball comes rolling out the slot...</span><br><span class="line">You haven't insert a quarter</span><br><span class="line">You insert a quarter</span><br><span class="line">You can't insert another quarter</span><br><span class="line">You turned...</span><br><span class="line">A gumball comes rolling out the slot...</span><br><span class="line">You insert a quarter</span><br><span class="line">You turned...</span><br><span class="line">A gumball comes rolling out the slot...</span><br><span class="line">Oops, out of gumballs</span><br><span class="line">You can't insert a quarter, the machine is sold out</span><br><span class="line">You turned, but there are no gumballs</span><br><span class="line">No gumball dispensed</span><br></pre></td></tr></table></figure><h2 id="9-ç­–ç•¥ï¼ˆStrategyï¼‰"><a href="#9-ç­–ç•¥ï¼ˆStrategyï¼‰" class="headerlink" title="9. ç­–ç•¥ï¼ˆStrategyï¼‰"></a>9. ç­–ç•¥ï¼ˆStrategyï¼‰</h2><h3 id="æ„å›¾-14"><a href="#æ„å›¾-14" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°è£…æ¯ä¸ªç®—æ³•ï¼Œå¹¶ä½¿å®ƒä»¬å¯ä»¥äº’æ¢ã€‚</p><p>ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç®—æ³•ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·ç«¯ã€‚</p><h3 id="ç±»å›¾-14"><a href="#ç±»å›¾-14" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>Strategy æ¥å£å®šä¹‰äº†ä¸€ä¸ªç®—æ³•æ—ï¼Œå®ƒä»¬éƒ½å…·æœ‰ behavior() æ–¹æ³•ã€‚</li><li>Context æ˜¯ä½¿ç”¨åˆ°è¯¥ç®—æ³•æ—çš„ç±»ï¼Œå…¶ä¸­çš„ doSomething() æ–¹æ³•ä¼šè°ƒç”¨ behavior()ï¼ŒsetStrategy(in Strategy) æ–¹æ³•å¯ä»¥åŠ¨æ€åœ°æ”¹å˜ strategy å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´èƒ½åŠ¨æ€åœ°æ”¹å˜ Context æ‰€ä½¿ç”¨çš„ç®—æ³•ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061419.png"> </div><br></p><h3 id="ä¸çŠ¶æ€æ¨¡å¼çš„æ¯”è¾ƒ"><a href="#ä¸çŠ¶æ€æ¨¡å¼çš„æ¯”è¾ƒ" class="headerlink" title="ä¸çŠ¶æ€æ¨¡å¼çš„æ¯”è¾ƒ"></a>ä¸çŠ¶æ€æ¨¡å¼çš„æ¯”è¾ƒ</h3><p>çŠ¶æ€æ¨¡å¼çš„ç±»å›¾å’Œç­–ç•¥æ¨¡å¼ç±»ä¼¼ï¼Œå¹¶ä¸”éƒ½æ˜¯èƒ½å¤ŸåŠ¨æ€æ”¹å˜å¯¹è±¡çš„è¡Œä¸ºã€‚</p><p>ä½†æ˜¯çŠ¶æ€æ¨¡å¼æ˜¯é€šè¿‡çŠ¶æ€è½¬ç§»æ¥æ”¹å˜ Context æ‰€ç»„åˆçš„ State å¯¹è±¡ï¼Œè€Œç­–ç•¥æ¨¡å¼æ˜¯é€šè¿‡ Context æœ¬èº«çš„å†³ç­–æ¥æ”¹å˜ç»„åˆçš„ Strategy å¯¹è±¡ã€‚</p><p>æ‰€è°“çš„çŠ¶æ€è½¬ç§»ï¼Œæ˜¯æŒ‡ Context åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ç”±äºä¸€äº›æ¡ä»¶å‘ç”Ÿæ”¹å˜è€Œä½¿å¾— State å¯¹è±¡å‘ç”Ÿæ”¹å˜ï¼Œæ³¨æ„å¿…é¡»è¦æ˜¯åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ã€‚</p><p>çŠ¶æ€æ¨¡å¼ä¸»è¦æ˜¯ç”¨æ¥è§£å†³çŠ¶æ€è½¬ç§»çš„é—®é¢˜ï¼Œå½“çŠ¶æ€å‘ç”Ÿè½¬ç§»äº†ï¼Œé‚£ä¹ˆ Context å¯¹è±¡å°±ä¼šæ”¹å˜å®ƒçš„è¡Œä¸ºï¼›è€Œç­–ç•¥æ¨¡å¼ä¸»è¦æ˜¯ç”¨æ¥å°è£…ä¸€ç»„å¯ä»¥äº’ç›¸æ›¿ä»£çš„ç®—æ³•æ—ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€åœ°å»æ›¿æ¢ Context ä½¿ç”¨çš„ç®—æ³•ã€‚</p><h3 id="å®ç°-13"><a href="#å®ç°-13" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>è®¾è®¡ä¸€ä¸ªé¸­å­ï¼Œå®ƒå¯ä»¥åŠ¨æ€åœ°æ”¹å˜å«å£°ã€‚è¿™é‡Œçš„ç®—æ³•æ—æ˜¯é¸­å­çš„å«å£°è¡Œä¸ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Quack</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"quack!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Squeak</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"squeak!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> QuackBehavior quackBehavior;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">performQuack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (quackBehavior != <span class="keyword">null</span>) &#123;</span><br><span class="line">            quackBehavior.quack();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQuackBehavior</span><span class="params">(QuackBehavior quackBehavior)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.quackBehavior = quackBehavior;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Duck duck = <span class="keyword">new</span> Duck();</span><br><span class="line">        duck.setQuackBehavior(<span class="keyword">new</span> Squeak());</span><br><span class="line">        duck.performQuack();</span><br><span class="line">        duck.setQuackBehavior(<span class="keyword">new</span> Quack());</span><br><span class="line">        duck.performQuack();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">squeak!</span><br><span class="line">quack!</span><br></pre></td></tr></table></figure><h3 id="JDK-12"><a href="#JDK-12" class="headerlink" title="JDK"></a>JDK</h3><ul><li>java.util.Comparator#compare()</li><li>javax.servlet.http.HttpServlet</li><li>javax.servlet.Filter#doFilter()</li></ul><h2 id="10-æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate-Methodï¼‰"><a href="#10-æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate-Methodï¼‰" class="headerlink" title="10. æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰"></a>10. æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰</h2><h3 id="æ„å›¾-15"><a href="#æ„å›¾-15" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>å®šä¹‰ç®—æ³•æ¡†æ¶ï¼Œå¹¶å°†ä¸€äº›æ­¥éª¤çš„å®ç°å»¶è¿Ÿåˆ°å­ç±»ã€‚</p><p>é€šè¿‡æ¨¡æ¿æ–¹æ³•ï¼Œå­ç±»å¯ä»¥é‡æ–°å®šä¹‰ç®—æ³•çš„æŸäº›æ­¥éª¤ï¼Œè€Œä¸ç”¨æ”¹å˜ç®—æ³•çš„ç»“æ„ã€‚</p><h3 id="ç±»å›¾-15"><a href="#ç±»å›¾-15" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061426.png"> </div><br></p><h3 id="å®ç°-14"><a href="#å®ç°-14" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>å†²å’–å•¡å’Œå†²èŒ¶éƒ½æœ‰ç±»ä¼¼çš„æµç¨‹ï¼Œä½†æ˜¯æŸäº›æ­¥éª¤ä¼šæœ‰ç‚¹ä¸ä¸€æ ·ï¼Œè¦æ±‚å¤ç”¨é‚£äº›ç›¸åŒæ­¥éª¤çš„ä»£ç ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061436.png"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CaffeineBeverage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">prepareRecipe</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        boilWater();</span><br><span class="line">        brew();</span><br><span class="line">        pourInCup();</span><br><span class="line">        addCondiments();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">boilWater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"boilWater"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pourInCup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"pourInCup"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Coffee</span> <span class="keyword">extends</span> <span class="title">CaffeineBeverage</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Coffee.brew"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Coffee.addCondiments"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tea</span> <span class="keyword">extends</span> <span class="title">CaffeineBeverage</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Tea.brew"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Tea.addCondiments"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        CaffeineBeverage caffeineBeverage = <span class="keyword">new</span> Coffee();</span><br><span class="line">        caffeineBeverage.prepareRecipe();</span><br><span class="line">        System.out.println(<span class="string">"-----------"</span>);</span><br><span class="line">        caffeineBeverage = <span class="keyword">new</span> Tea();</span><br><span class="line">        caffeineBeverage.prepareRecipe();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">boilWater</span><br><span class="line">Coffee.brew</span><br><span class="line">pourInCup</span><br><span class="line">Coffee.addCondiments</span><br><span class="line">-----------</span><br><span class="line">boilWater</span><br><span class="line">Tea.brew</span><br><span class="line">pourInCup</span><br><span class="line">Tea.addCondiments</span><br></pre></td></tr></table></figure><h3 id="JDK-13"><a href="#JDK-13" class="headerlink" title="JDK"></a>JDK</h3><ul><li>java.util.Collections#sort()</li><li>java.io.InputStream#skip()</li><li>java.io.InputStream#read()</li><li>java.util.AbstractList#indexOf()</li></ul><h2 id="11-è®¿é—®è€…ï¼ˆVisitorï¼‰"><a href="#11-è®¿é—®è€…ï¼ˆVisitorï¼‰" class="headerlink" title="11. è®¿é—®è€…ï¼ˆVisitorï¼‰"></a>11. è®¿é—®è€…ï¼ˆVisitorï¼‰</h2><h3 id="æ„å›¾-16"><a href="#æ„å›¾-16" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>ä¸ºä¸€ä¸ªå¯¹è±¡ç»“æ„ï¼ˆæ¯”å¦‚ç»„åˆç»“æ„ï¼‰å¢åŠ æ–°èƒ½åŠ›ã€‚</p><h3 id="ç±»å›¾-16"><a href="#ç±»å›¾-16" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>Visitorï¼šè®¿é—®è€…ï¼Œä¸ºæ¯ä¸€ä¸ª ConcreteElement å£°æ˜ä¸€ä¸ª visit æ“ä½œ</li><li>ConcreteVisitorï¼šå…·ä½“è®¿é—®è€…ï¼Œå­˜å‚¨éå†è¿‡ç¨‹ä¸­çš„ç´¯è®¡ç»“æœ</li><li>ObjectStructureï¼šå¯¹è±¡ç»“æ„ï¼Œå¯ä»¥æ˜¯ç»„åˆç»“æ„ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªé›†åˆã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061442.png"> </div><br></p><h3 id="å®ç°-15"><a href="#å®ç°-15" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomerGroup</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Customer&gt; customers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Customer customer : customers) &#123;</span><br><span class="line">            customer.accept(visitor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addCustomer</span><span class="params">(Customer customer)</span> </span>&#123;</span><br><span class="line">        customers.add(customer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Order&gt; orders = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    Customer(String name) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addOrder</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">        orders.add(order);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">for</span> (Order order : orders) &#123;</span><br><span class="line">            order.accept(visitor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Item&gt; items = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">    Order(String name) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Order(String name, String itemName) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.addItem(<span class="keyword">new</span> Item(itemName));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addItem</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        items.add(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Item item : items) &#123;</span><br><span class="line">            item.accept(visitor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    Item(String name) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(Customer customer)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(Order order)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(Item item)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneralReport</span> <span class="keyword">implements</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> customersNo;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ordersNo;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> itemsNo;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Customer customer)</span> </span>&#123;</span><br><span class="line">        System.out.println(customer.getName());</span><br><span class="line">        customersNo++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">        System.out.println(order.getName());</span><br><span class="line">        ordersNo++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        System.out.println(item.getName());</span><br><span class="line">        itemsNo++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">displayResults</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Number of customers: "</span> + customersNo);</span><br><span class="line">        System.out.println(<span class="string">"Number of orders:    "</span> + ordersNo);</span><br><span class="line">        System.out.println(<span class="string">"Number of items:     "</span> + itemsNo);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Customer customer1 = <span class="keyword">new</span> Customer(<span class="string">"customer1"</span>);</span><br><span class="line">        customer1.addOrder(<span class="keyword">new</span> Order(<span class="string">"order1"</span>, <span class="string">"item1"</span>));</span><br><span class="line">        customer1.addOrder(<span class="keyword">new</span> Order(<span class="string">"order2"</span>, <span class="string">"item1"</span>));</span><br><span class="line">        customer1.addOrder(<span class="keyword">new</span> Order(<span class="string">"order3"</span>, <span class="string">"item1"</span>));</span><br><span class="line"></span><br><span class="line">        Order order = <span class="keyword">new</span> Order(<span class="string">"order_a"</span>);</span><br><span class="line">        order.addItem(<span class="keyword">new</span> Item(<span class="string">"item_a1"</span>));</span><br><span class="line">        order.addItem(<span class="keyword">new</span> Item(<span class="string">"item_a2"</span>));</span><br><span class="line">        order.addItem(<span class="keyword">new</span> Item(<span class="string">"item_a3"</span>));</span><br><span class="line">        Customer customer2 = <span class="keyword">new</span> Customer(<span class="string">"customer2"</span>);</span><br><span class="line">        customer2.addOrder(order);</span><br><span class="line"></span><br><span class="line">        CustomerGroup customers = <span class="keyword">new</span> CustomerGroup();</span><br><span class="line">        customers.addCustomer(customer1);</span><br><span class="line">        customers.addCustomer(customer2);</span><br><span class="line"></span><br><span class="line">        GeneralReport visitor = <span class="keyword">new</span> GeneralReport();</span><br><span class="line">        customers.accept(visitor);</span><br><span class="line">        visitor.displayResults();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">customer1</span><br><span class="line">order1</span><br><span class="line">item1</span><br><span class="line">order2</span><br><span class="line">item1</span><br><span class="line">order3</span><br><span class="line">item1</span><br><span class="line">customer2</span><br><span class="line">order_a</span><br><span class="line">item_a1</span><br><span class="line">item_a2</span><br><span class="line">item_a3</span><br><span class="line">Number of customers: 2</span><br><span class="line">Number of orders:    4</span><br><span class="line">Number of items:     6</span><br></pre></td></tr></table></figure><h3 id="JDK-14"><a href="#JDK-14" class="headerlink" title="JDK"></a>JDK</h3><ul><li>javax.lang.model.element.Element and javax.lang.model.element.ElementVisitor</li><li>javax.lang.model.type.TypeMirror and javax.lang.model.type.TypeVisitor</li></ul><h2 id="12-ç©ºå¯¹è±¡ï¼ˆNullï¼‰"><a href="#12-ç©ºå¯¹è±¡ï¼ˆNullï¼‰" class="headerlink" title="12. ç©ºå¯¹è±¡ï¼ˆNullï¼‰"></a>12. ç©ºå¯¹è±¡ï¼ˆNullï¼‰</h2><h3 id="æ„å›¾-17"><a href="#æ„å›¾-17" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>ä½¿ç”¨ä»€ä¹ˆéƒ½ä¸åšçš„ç©ºå¯¹è±¡æ¥æ›¿ä»£ NULLã€‚</p><p>ä¸€ä¸ªæ–¹æ³•è¿”å› NULLï¼Œæ„å‘³ç€æ–¹æ³•çš„è°ƒç”¨ç«¯éœ€è¦å»æ£€æŸ¥è¿”å›å€¼æ˜¯å¦æ˜¯ NULLï¼Œè¿™ä¹ˆåšä¼šå¯¼è‡´éå¸¸å¤šçš„å†—ä½™çš„æ£€æŸ¥ä»£ç ã€‚å¹¶ä¸”å¦‚æœæŸä¸€ä¸ªè°ƒç”¨ç«¯å¿˜è®°äº†åšè¿™ä¸ªæ£€æŸ¥è¿”å›å€¼ï¼Œè€Œç›´æ¥ä½¿ç”¨è¿”å›çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p><h3 id="ç±»å›¾-17"><a href="#ç±»å›¾-17" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061452.png"> </div><br></p><h3 id="å®ç°-16"><a href="#å®ç°-16" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractOperation</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RealOperation</span> <span class="keyword">extends</span> <span class="title">AbstractOperation</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">request</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"do something"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NullOperation</span> <span class="keyword">extends</span> <span class="title">AbstractOperation</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">request</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AbstractOperation abstractOperation = func(-<span class="number">1</span>);</span><br><span class="line">        abstractOperation.request();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AbstractOperation <span class="title">func</span><span class="params">(<span class="keyword">int</span> para)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (para &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NullOperation();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RealOperation();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å››ã€ç»“æ„å‹"><a href="#å››ã€ç»“æ„å‹" class="headerlink" title="å››ã€ç»“æ„å‹"></a>å››ã€ç»“æ„å‹</h1><h2 id="1-é€‚é…å™¨ï¼ˆAdapterï¼‰"><a href="#1-é€‚é…å™¨ï¼ˆAdapterï¼‰" class="headerlink" title="1. é€‚é…å™¨ï¼ˆAdapterï¼‰"></a>1. é€‚é…å™¨ï¼ˆAdapterï¼‰</h2><h3 id="æ„å›¾-18"><a href="#æ„å›¾-18" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>æŠŠä¸€ä¸ªç±»æ¥å£è½¬æ¢æˆå¦ä¸€ä¸ªç”¨æˆ·éœ€è¦çš„æ¥å£ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061456.png"> </div><br></p><h3 id="ç±»å›¾-18"><a href="#ç±»å›¾-18" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061501.png"> </div><br></p><h3 id="å®ç°-17"><a href="#å®ç°-17" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>é¸­å­ï¼ˆDuckï¼‰å’Œç«é¸¡ï¼ˆTurkeyï¼‰æ‹¥æœ‰ä¸åŒçš„å«å£°ï¼ŒDuck çš„å«å£°è°ƒç”¨ quack() æ–¹æ³•ï¼Œè€Œ Turkey è°ƒç”¨ gobble() æ–¹æ³•ã€‚</p><p>è¦æ±‚å°† Turkey çš„ gobble() æ–¹æ³•é€‚é…æˆ Duck çš„ quack() æ–¹æ³•ï¼Œä»è€Œè®©ç«é¸¡å†’å……é¸­å­ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Turkey</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">gobble</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WildTurkey</span> <span class="keyword">implements</span> <span class="title">Turkey</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">gobble</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"gobble!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TurkeyAdapter</span> <span class="keyword">implements</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    Turkey turkey;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TurkeyAdapter</span><span class="params">(Turkey turkey)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.turkey = turkey;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        turkey.gobble();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Turkey turkey = <span class="keyword">new</span> WildTurkey();</span><br><span class="line">        Duck duck = <span class="keyword">new</span> TurkeyAdapter(turkey);</span><br><span class="line">        duck.quack();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JDK-15"><a href="#JDK-15" class="headerlink" title="JDK"></a>JDK</h3><ul><li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/Arrays.html#asList%28T...%29" target="_blank" rel="noopener">java.util.Arrays#asList()</a></li><li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html#list-java.util.Enumeration-" target="_blank" rel="noopener">java.util.Collections#list()</a></li><li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html#enumeration-java.util.Collection-" target="_blank" rel="noopener">java.util.Collections#enumeration()</a></li><li><a href="http://docs.oracle.com/javase/8/docs/api/javax/xml/bind/annotation/adapters/XmlAdapter.html#marshal-BoundType-" target="_blank" rel="noopener">javax.xml.bind.annotation.adapters.XMLAdapter</a></li></ul><h2 id="2-æ¡¥æ¥ï¼ˆBridgeï¼‰"><a href="#2-æ¡¥æ¥ï¼ˆBridgeï¼‰" class="headerlink" title="2. æ¡¥æ¥ï¼ˆBridgeï¼‰"></a>2. æ¡¥æ¥ï¼ˆBridgeï¼‰</h2><h3 id="æ„å›¾-19"><a href="#æ„å›¾-19" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>å°†æŠ½è±¡ä¸å®ç°åˆ†ç¦»å¼€æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚</p><h3 id="ç±»å›¾-19"><a href="#ç±»å›¾-19" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>Abstractionï¼šå®šä¹‰æŠ½è±¡ç±»çš„æ¥å£</li><li>Implementorï¼šå®šä¹‰å®ç°ç±»æ¥å£</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061510.png"> </div><br></p><h3 id="å®ç°-18"><a href="#å®ç°-18" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>RemoteControl è¡¨ç¤ºé¥æ§å™¨ï¼ŒæŒ‡ä»£ Abstractionã€‚</p><p>TV è¡¨ç¤ºç”µè§†ï¼ŒæŒ‡ä»£ Implementorã€‚</p><p>æ¡¥æ¥æ¨¡å¼å°†é¥æ§å™¨å’Œç”µè§†åˆ†ç¦»å¼€æ¥ï¼Œä»è€Œå¯ä»¥ç‹¬ç«‹æ”¹å˜é¥æ§å™¨æˆ–è€…ç”µè§†çš„å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">TV</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">tuneChannel</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sony</span> <span class="keyword">extends</span> <span class="title">TV</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Sony.on()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Sony.off()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tuneChannel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Sony.tuneChannel()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RCA</span> <span class="keyword">extends</span> <span class="title">TV</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"RCA.on()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"RCA.off()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tuneChannel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"RCA.tuneChannel()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteControl</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> TV tv;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RemoteControl</span><span class="params">(TV tv)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.tv = tv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">tuneChannel</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteRemoteControl1</span> <span class="keyword">extends</span> <span class="title">RemoteControl</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteRemoteControl1</span><span class="params">(TV tv)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(tv);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ConcreteRemoteControl1.on()"</span>);</span><br><span class="line">        tv.on();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ConcreteRemoteControl1.off()"</span>);</span><br><span class="line">        tv.off();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tuneChannel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ConcreteRemoteControl1.tuneChannel()"</span>);</span><br><span class="line">        tv.tuneChannel();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteRemoteControl2</span> <span class="keyword">extends</span> <span class="title">RemoteControl</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteRemoteControl2</span><span class="params">(TV tv)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(tv);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ConcreteRemoteControl2.on()"</span>);</span><br><span class="line">        tv.on();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ConcreteRemoteControl2.off()"</span>);</span><br><span class="line">        tv.off();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tuneChannel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ConcreteRemoteControl2.tuneChannel()"</span>);</span><br><span class="line">        tv.tuneChannel();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RemoteControl remoteControl1 = <span class="keyword">new</span> ConcreteRemoteControl1(<span class="keyword">new</span> RCA());</span><br><span class="line">        remoteControl1.on();</span><br><span class="line">        remoteControl1.off();</span><br><span class="line">        remoteControl1.tuneChannel();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JDK-16"><a href="#JDK-16" class="headerlink" title="JDK"></a>JDK</h3><ul><li>AWT (It provides an abstraction layer which maps onto the native OS the windowing support.)</li><li>JDBC</li></ul><h2 id="3-ç»„åˆï¼ˆCompositeï¼‰"><a href="#3-ç»„åˆï¼ˆCompositeï¼‰" class="headerlink" title="3. ç»„åˆï¼ˆCompositeï¼‰"></a>3. ç»„åˆï¼ˆCompositeï¼‰</h2><h3 id="æ„å›¾-20"><a href="#æ„å›¾-20" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„æ¥è¡¨ç¤ºâ€œæ•´ä½“/éƒ¨åˆ†â€å±‚æ¬¡å…³ç³»ï¼Œå…è®¸ç”¨æˆ·ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç†å•ç‹¬å¯¹è±¡å’Œç»„åˆå¯¹è±¡ã€‚</p><h3 id="ç±»å›¾-20"><a href="#ç±»å›¾-20" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p>ç»„ä»¶ï¼ˆComponentï¼‰ç±»æ˜¯ç»„åˆç±»ï¼ˆCompositeï¼‰å’Œå¶å­ç±»ï¼ˆLeafï¼‰çš„çˆ¶ç±»ï¼Œå¯ä»¥æŠŠç»„åˆç±»çœ‹æˆæ˜¯æ ‘çš„ä¸­é—´èŠ‚ç‚¹ã€‚</p><p>ç»„åˆå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªç»„ä»¶å¯¹è±¡ï¼Œå› æ­¤ç»„åˆå¯¹è±¡çš„æ“ä½œå¯ä»¥å§”æ‰˜ç»™ç»„ä»¶å¯¹è±¡å»å¤„ç†ï¼Œè€Œç»„ä»¶å¯¹è±¡å¯ä»¥æ˜¯å¦ä¸€ä¸ªç»„åˆå¯¹è±¡æˆ–è€…å¶å­å¯¹è±¡ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061522.png"> </div><br></p><h3 id="å®ç°-19"><a href="#å®ç°-19" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Component</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        print(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> level)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Component component)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Component component)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Composite</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Component&gt; child;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Composite</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">        child = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; level; i++) &#123;</span><br><span class="line">            System.out.print(<span class="string">"--"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"Composite:"</span> + name);</span><br><span class="line">        <span class="keyword">for</span> (Component component : child) &#123;</span><br><span class="line">            component.print(level + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Component component)</span> </span>&#123;</span><br><span class="line">        child.add(component);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Component component)</span> </span>&#123;</span><br><span class="line">        child.remove(component);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Leaf</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Leaf</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; level; i++) &#123;</span><br><span class="line">            System.out.print(<span class="string">"--"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"left:"</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Component component)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(); <span class="comment">// ç‰ºç‰²é€æ˜æ€§æ¢å–å•ä¸€èŒè´£åŸåˆ™ï¼Œè¿™æ ·å°±ä¸ç”¨è€ƒè™‘æ˜¯å¶å­èŠ‚ç‚¹è¿˜æ˜¯ç»„åˆèŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Component component)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Composite root = <span class="keyword">new</span> Composite(<span class="string">"root"</span>);</span><br><span class="line">        Component node1 = <span class="keyword">new</span> Leaf(<span class="string">"1"</span>);</span><br><span class="line">        Component node2 = <span class="keyword">new</span> Composite(<span class="string">"2"</span>);</span><br><span class="line">        Component node3 = <span class="keyword">new</span> Leaf(<span class="string">"3"</span>);</span><br><span class="line">        root.add(node1);</span><br><span class="line">        root.add(node2);</span><br><span class="line">        root.add(node3);</span><br><span class="line">        Component node21 = <span class="keyword">new</span> Leaf(<span class="string">"21"</span>);</span><br><span class="line">        Component node22 = <span class="keyword">new</span> Composite(<span class="string">"22"</span>);</span><br><span class="line">        node2.add(node21);</span><br><span class="line">        node2.add(node22);</span><br><span class="line">        Component node221 = <span class="keyword">new</span> Leaf(<span class="string">"221"</span>);</span><br><span class="line">        node22.add(node221);</span><br><span class="line">        root.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Composite:root</span><br><span class="line">--left:1</span><br><span class="line">--Composite:2</span><br><span class="line">----left:21</span><br><span class="line">----Composite:22</span><br><span class="line">------left:221</span><br><span class="line">--left:3</span><br></pre></td></tr></table></figure><h3 id="JDK-17"><a href="#JDK-17" class="headerlink" title="JDK"></a>JDK</h3><ul><li>javax.swing.JComponent#add(Component)</li><li>java.awt.Container#add(Component)</li><li>java.util.Map#putAll(Map)</li><li>java.util.List#addAll(Collection)</li><li>java.util.Set#addAll(Collection)</li></ul><h2 id="4-è£…é¥°ï¼ˆDecoratorï¼‰"><a href="#4-è£…é¥°ï¼ˆDecoratorï¼‰" class="headerlink" title="4. è£…é¥°ï¼ˆDecoratorï¼‰"></a>4. è£…é¥°ï¼ˆDecoratorï¼‰</h2><h3 id="æ„å›¾-21"><a href="#æ„å›¾-21" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>ä¸ºå¯¹è±¡åŠ¨æ€æ·»åŠ åŠŸèƒ½ã€‚</p><h3 id="ç±»å›¾-21"><a href="#ç±»å›¾-21" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p>è£…é¥°è€…ï¼ˆDecoratorï¼‰å’Œå…·ä½“ç»„ä»¶ï¼ˆConcreteComponentï¼‰éƒ½ç»§æ‰¿è‡ªç»„ä»¶ï¼ˆComponentï¼‰ï¼Œå…·ä½“ç»„ä»¶çš„æ–¹æ³•å®ç°ä¸éœ€è¦ä¾èµ–äºå…¶å®ƒå¯¹è±¡ï¼Œè€Œè£…é¥°è€…ç»„åˆäº†ä¸€ä¸ªç»„ä»¶ï¼Œè¿™æ ·å®ƒå¯ä»¥è£…é¥°å…¶å®ƒè£…é¥°è€…æˆ–è€…å…·ä½“ç»„ä»¶ã€‚æ‰€è°“è£…é¥°ï¼Œå°±æ˜¯æŠŠè¿™ä¸ªè£…é¥°è€…å¥—åœ¨è¢«è£…é¥°ä¸Šï¼Œä»è€ŒåŠ¨æ€æ‰©å±•è¢«è£…é¥°è€…çš„åŠŸèƒ½ã€‚è£…é¥°è€…çš„æ–¹æ³•æœ‰ä¸€éƒ¨åˆ†æ˜¯è‡ªå·±çš„ï¼Œè¿™å±äºå®ƒçš„åŠŸèƒ½ï¼Œç„¶åè°ƒç”¨è¢«è£…é¥°è€…çš„æ–¹æ³•å®ç°ï¼Œä»è€Œä¹Ÿä¿ç•™äº†è¢«è£…é¥°è€…çš„åŠŸèƒ½ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå…·ä½“ç»„ä»¶åº”å½“æ˜¯è£…é¥°å±‚æ¬¡çš„æœ€ä½å±‚ï¼Œå› ä¸ºåªæœ‰å…·ä½“ç»„ä»¶çš„æ–¹æ³•å®ç°ä¸éœ€è¦ä¾èµ–äºå…¶å®ƒå¯¹è±¡ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061537.png"> </div><br></p><h3 id="å®ç°-20"><a href="#å®ç°-20" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>è®¾è®¡ä¸åŒç§ç±»çš„é¥®æ–™ï¼Œé¥®æ–™å¯ä»¥æ·»åŠ é…æ–™ï¼Œæ¯”å¦‚å¯ä»¥æ·»åŠ ç‰›å¥¶ï¼Œå¹¶ä¸”æ”¯æŒåŠ¨æ€æ·»åŠ æ–°é…æ–™ã€‚æ¯å¢åŠ ä¸€ç§é…æ–™ï¼Œè¯¥é¥®æ–™çš„ä»·æ ¼å°±ä¼šå¢åŠ ï¼Œè¦æ±‚è®¡ç®—ä¸€ç§é¥®æ–™çš„ä»·æ ¼ã€‚</p><p>ä¸‹å›¾è¡¨ç¤ºåœ¨ DarkRoast é¥®æ–™ä¸Šæ–°å¢æ–°æ·»åŠ  Mocha é…æ–™ï¼Œä¹‹ååˆæ·»åŠ äº† Whip é…æ–™ã€‚DarkRoast è¢« Mocha åŒ…è£¹ï¼ŒMocha åˆè¢« Whip åŒ…è£¹ã€‚å®ƒä»¬éƒ½ç»§æ‰¿è‡ªç›¸åŒçˆ¶ç±»ï¼Œéƒ½æœ‰ cost() æ–¹æ³•ï¼Œå¤–å±‚ç±»çš„ cost() æ–¹æ³•è°ƒç”¨äº†å†…å±‚ç±»çš„ cost() æ–¹æ³•ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061542.jpg" width="600"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Beverage</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DarkRoast</span> <span class="keyword">implements</span> <span class="title">Beverage</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseBlend</span> <span class="keyword">implements</span> <span class="title">Beverage</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CondimentDecorator</span> <span class="keyword">implements</span> <span class="title">Beverage</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Beverage beverage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Milk</span> <span class="keyword">extends</span> <span class="title">CondimentDecorator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Milk</span><span class="params">(Beverage beverage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.beverage = beverage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + beverage.cost();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mocha</span> <span class="keyword">extends</span> <span class="title">CondimentDecorator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Mocha</span><span class="params">(Beverage beverage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.beverage = beverage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + beverage.cost();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Beverage beverage = <span class="keyword">new</span> HouseBlend();</span><br><span class="line">        beverage = <span class="keyword">new</span> Mocha(beverage);</span><br><span class="line">        beverage = <span class="keyword">new</span> Milk(beverage);</span><br><span class="line">        System.out.println(beverage.cost());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3.0</span><br></pre></td></tr></table></figure><h3 id="è®¾è®¡åŸåˆ™"><a href="#è®¾è®¡åŸåˆ™" class="headerlink" title="è®¾è®¡åŸåˆ™"></a>è®¾è®¡åŸåˆ™</h3><p>ç±»åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼šä¹Ÿå°±æ˜¯æ·»åŠ æ–°åŠŸèƒ½æ—¶ä¸éœ€è¦ä¿®æ”¹ä»£ç ã€‚é¥®æ–™å¯ä»¥åŠ¨æ€æ·»åŠ æ–°çš„é…æ–™ï¼Œè€Œä¸éœ€è¦å»ä¿®æ”¹é¥®æ–™çš„ä»£ç ã€‚</p><p>ä¸å¯èƒ½æŠŠæ‰€æœ‰çš„ç±»è®¾è®¡æˆéƒ½æ»¡è¶³è¿™ä¸€åŸåˆ™ï¼Œåº”å½“æŠŠè¯¥åŸåˆ™åº”ç”¨äºæœ€æœ‰å¯èƒ½å‘ç”Ÿæ”¹å˜çš„åœ°æ–¹ã€‚</p><h3 id="JDK-18"><a href="#JDK-18" class="headerlink" title="JDK"></a>JDK</h3><ul><li>java.io.BufferedInputStream(InputStream)</li><li>java.io.DataInputStream(InputStream)</li><li>java.io.BufferedOutputStream(OutputStream)</li><li>java.util.zip.ZipOutputStream(OutputStream)</li><li>java.util.Collections#checked<a href="">List|Map|Set|SortedSet|SortedMap</a></li></ul><h2 id="5-å¤–è§‚ï¼ˆFacadeï¼‰"><a href="#5-å¤–è§‚ï¼ˆFacadeï¼‰" class="headerlink" title="5. å¤–è§‚ï¼ˆFacadeï¼‰"></a>5. å¤–è§‚ï¼ˆFacadeï¼‰</h2><h3 id="æ„å›¾-22"><a href="#æ„å›¾-22" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ï¼Œä»è€Œè®©å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚</p><h3 id="ç±»å›¾-22"><a href="#ç±»å›¾-22" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061625.png"> </div><br></p><h3 id="å®ç°-21"><a href="#å®ç°-21" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>è§‚çœ‹ç”µå½±éœ€è¦æ“ä½œå¾ˆå¤šç”µå™¨ï¼Œä½¿ç”¨å¤–è§‚æ¨¡å¼å¯ä»¥å®ç°ä¸€é”®çœ‹ç”µå½±åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubSystem</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOnTV</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"turnOnTV()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCD</span><span class="params">(String cd)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"setCD( "</span> + cd + <span class="string">" )"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">starWatching</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"starWatching()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Facade</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> SubSystem subSystem = <span class="keyword">new</span> SubSystem();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">watchMovie</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        subSystem.turnOnTV();</span><br><span class="line">        subSystem.setCD(<span class="string">"a movie"</span>);</span><br><span class="line">        subSystem.starWatching();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Facade facade = <span class="keyword">new</span> Facade();</span><br><span class="line">        facade.watchMovie();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è®¾è®¡åŸåˆ™-1"><a href="#è®¾è®¡åŸåˆ™-1" class="headerlink" title="è®¾è®¡åŸåˆ™"></a>è®¾è®¡åŸåˆ™</h3><p>æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼šåªå’Œä½ çš„å¯†å‹è°ˆè¯ã€‚ä¹Ÿå°±æ˜¯å®¢æˆ·å¯¹è±¡æ‰€éœ€è¦äº¤äº’çš„å¯¹è±¡åº”å½“å°½å¯èƒ½å°‘ã€‚</p><h2 id="6-äº«å…ƒï¼ˆFlyweightï¼‰"><a href="#6-äº«å…ƒï¼ˆFlyweightï¼‰" class="headerlink" title="6. äº«å…ƒï¼ˆFlyweightï¼‰"></a>6. äº«å…ƒï¼ˆFlyweightï¼‰</h2><h3 id="æ„å›¾-23"><a href="#æ„å›¾-23" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>åˆ©ç”¨å…±äº«çš„æ–¹å¼æ¥æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡ä¸€éƒ¨åˆ†å†…éƒ¨çŠ¶æ€æ˜¯ç›¸åŒçš„ã€‚</p><h3 id="ç±»å›¾-23"><a href="#ç±»å›¾-23" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><ul><li>Flyweightï¼šäº«å…ƒå¯¹è±¡</li><li>IntrinsicStateï¼šå†…éƒ¨çŠ¶æ€ï¼Œç›¸åŒçš„é¡¹å…ƒå¯¹è±¡å…±äº«</li><li>ExtrinsicStateï¼šå¤–éƒ¨çŠ¶æ€</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061638.png"> </div><br></p><h3 id="å®ç°-22"><a href="#å®ç°-22" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Flyweight</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">doOperation</span><span class="params">(String extrinsicState)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteFlyweight</span> <span class="keyword">implements</span> <span class="title">Flyweight</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String intrinsicState;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteFlyweight</span><span class="params">(String intrinsicState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.intrinsicState = intrinsicState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doOperation</span><span class="params">(String extrinsicState)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Object address: "</span> + System.identityHashCode(<span class="keyword">this</span>));</span><br><span class="line">        System.out.println(<span class="string">"IntrinsicState: "</span> + intrinsicState);</span><br><span class="line">        System.out.println(<span class="string">"ExtrinsicState: "</span> + extrinsicState);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyweightFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String, Flyweight&gt; flyweights = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function">Flyweight <span class="title">getFlyweight</span><span class="params">(String intrinsicState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!flyweights.containsKey(intrinsicState)) &#123;</span><br><span class="line">            Flyweight flyweight = <span class="keyword">new</span> ConcreteFlyweight(intrinsicState);</span><br><span class="line">            flyweights.put(intrinsicState, flyweight);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flyweights.get(intrinsicState);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        FlyweightFactory factory = <span class="keyword">new</span> FlyweightFactory();</span><br><span class="line">        Flyweight flyweight1 = factory.getFlyweight(<span class="string">"aa"</span>);</span><br><span class="line">        Flyweight flyweight2 = factory.getFlyweight(<span class="string">"aa"</span>);</span><br><span class="line">        flyweight1.doOperation(<span class="string">"x"</span>);</span><br><span class="line">        flyweight2.doOperation(<span class="string">"y"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Object address: 1163157884</span><br><span class="line">IntrinsicState: aa</span><br><span class="line">ExtrinsicState: x</span><br><span class="line">Object address: 1163157884</span><br><span class="line">IntrinsicState: aa</span><br><span class="line">ExtrinsicState: y</span><br></pre></td></tr></table></figure><h3 id="JDK-19"><a href="#JDK-19" class="headerlink" title="JDK"></a>JDK</h3><p>Java åˆ©ç”¨ç¼“å­˜æ¥åŠ é€Ÿå¤§é‡å°å¯¹è±¡çš„è®¿é—®æ—¶é—´ã€‚</p><ul><li>java.lang.Integer#valueOf(int)</li><li>java.lang.Boolean#valueOf(boolean)</li><li>java.lang.Byte#valueOf(byte)</li><li>java.lang.Character#valueOf(char)</li></ul><h2 id="7-ä»£ç†ï¼ˆProxyï¼‰"><a href="#7-ä»£ç†ï¼ˆProxyï¼‰" class="headerlink" title="7. ä»£ç†ï¼ˆProxyï¼‰"></a>7. ä»£ç†ï¼ˆProxyï¼‰</h2><h3 id="æ„å›¾-24"><a href="#æ„å›¾-24" class="headerlink" title="æ„å›¾"></a>æ„å›¾</h3><p>æ§åˆ¶å¯¹å…¶å®ƒå¯¹è±¡çš„è®¿é—®ã€‚</p><h3 id="ç±»å›¾-24"><a href="#ç±»å›¾-24" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p>ä»£ç†æœ‰ä»¥ä¸‹å››ç±»ï¼š</p><ul><li>è¿œç¨‹ä»£ç†ï¼ˆRemote Proxyï¼‰ï¼šæ§åˆ¶å¯¹è¿œç¨‹å¯¹è±¡ï¼ˆä¸åŒåœ°å€ç©ºé—´ï¼‰çš„è®¿é—®ï¼Œå®ƒè´Ÿè´£å°†è¯·æ±‚åŠå…¶å‚æ•°è¿›è¡Œç¼–ç ï¼Œå¹¶å‘ä¸åŒåœ°å€ç©ºé—´ä¸­çš„å¯¹è±¡å‘é€å·²ç»ç¼–ç çš„è¯·æ±‚ã€‚</li><li>è™šæ‹Ÿä»£ç†ï¼ˆVirtual Proxyï¼‰ï¼šæ ¹æ®éœ€è¦åˆ›å»ºå¼€é”€å¾ˆå¤§çš„å¯¹è±¡ï¼Œå®ƒå¯ä»¥ç¼“å­˜å®ä½“çš„é™„åŠ ä¿¡æ¯ï¼Œä»¥ä¾¿å»¶è¿Ÿå¯¹å®ƒçš„è®¿é—®ï¼Œä¾‹å¦‚åœ¨ç½‘ç«™åŠ è½½ä¸€ä¸ªå¾ˆå¤§å›¾ç‰‡æ—¶ï¼Œä¸èƒ½é©¬ä¸Šå®Œæˆï¼Œå¯ä»¥ç”¨è™šæ‹Ÿä»£ç†ç¼“å­˜å›¾ç‰‡çš„å¤§å°ä¿¡æ¯ï¼Œç„¶åç”Ÿæˆä¸€å¼ ä¸´æ—¶å›¾ç‰‡ä»£æ›¿åŸå§‹å›¾ç‰‡ã€‚</li><li>ä¿æŠ¤ä»£ç†ï¼ˆProtection Proxyï¼‰ï¼šæŒ‰æƒé™æ§åˆ¶å¯¹è±¡çš„è®¿é—®ï¼Œå®ƒè´Ÿè´£æ£€æŸ¥è°ƒç”¨è€…æ˜¯å¦å…·æœ‰å®ç°ä¸€ä¸ªè¯·æ±‚æ‰€å¿…é¡»çš„è®¿é—®æƒé™ã€‚</li><li>æ™ºèƒ½ä»£ç†ï¼ˆSmart Referenceï¼‰ï¼šå–ä»£äº†ç®€å•çš„æŒ‡é’ˆï¼Œå®ƒåœ¨è®¿é—®å¯¹è±¡æ—¶æ‰§è¡Œä¸€äº›é™„åŠ æ“ä½œï¼šè®°å½•å¯¹è±¡çš„å¼•ç”¨æ¬¡æ•°ï¼Œæ¯”å¦‚æ™ºèƒ½æ™ºèƒ½ï¼›å½“ç¬¬ä¸€æ¬¡å¼•ç”¨ä¸€ä¸ªæŒä¹…åŒ–å¯¹è±¡æ—¶ï¼Œå°†å®ƒè£…å…¥å†…å­˜ï¼›åœ¨è®¿é—®ä¸€ä¸ªå®é™…å¯¹è±¡å‰ï¼Œæ£€æŸ¥æ˜¯å¦å·²ç»é”å®šäº†å®ƒï¼Œä»¥ç¡®ä¿å…¶å®ƒå¯¹è±¡ä¸èƒ½æ”¹å˜å®ƒã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061647.png"> </div><br></p><h3 id="å®ç°-23"><a href="#å®ç°-23" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªè™šæ‹Ÿä»£ç†çš„å®ç°ï¼Œæ¨¡æ‹Ÿäº†å›¾ç‰‡å»¶è¿ŸåŠ è½½çš„æƒ…å†µä¸‹ä½¿ç”¨ä¸å›¾ç‰‡å¤§å°ç›¸ç­‰çš„ä¸´æ—¶å†…å®¹å»æ›¿æ¢åŸå§‹å›¾ç‰‡ï¼Œç›´åˆ°å›¾ç‰‡åŠ è½½å®Œæˆæ‰å°†å›¾ç‰‡æ˜¾ç¤ºå‡ºæ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Image</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showImage</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HighResolutionImage</span> <span class="keyword">implements</span> <span class="title">Image</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> URL imageURL;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> startTime;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> height;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> width;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHeight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getWidth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> width;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HighResolutionImage</span><span class="params">(URL imageURL)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.imageURL = imageURL;</span><br><span class="line">        <span class="keyword">this</span>.startTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">this</span>.width = <span class="number">600</span>;</span><br><span class="line">        <span class="keyword">this</span>.height = <span class="number">600</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLoad</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿå›¾ç‰‡åŠ è½½ï¼Œå»¶è¿Ÿ 3s åŠ è½½å®Œæˆ</span></span><br><span class="line">        <span class="keyword">long</span> endTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">return</span> endTime - startTime &gt; <span class="number">3000</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showImage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Real Image: "</span> + imageURL);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageProxy</span> <span class="keyword">implements</span> <span class="title">Image</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> HighResolutionImage highResolutionImage;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ImageProxy</span><span class="params">(HighResolutionImage highResolutionImage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.highResolutionImage = highResolutionImage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showImage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!highResolutionImage.isLoad()) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">"Temp Image: "</span> + highResolutionImage.getWidth() + <span class="string">" "</span> + highResolutionImage.getHeight());</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        highResolutionImage.showImage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageViewer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String image = <span class="string">"http://image.jpg"</span>;</span><br><span class="line">        URL url = <span class="keyword">new</span> URL(image);</span><br><span class="line">        HighResolutionImage highResolutionImage = <span class="keyword">new</span> HighResolutionImage(url);</span><br><span class="line">        ImageProxy imageProxy = <span class="keyword">new</span> ImageProxy(highResolutionImage);</span><br><span class="line">        imageProxy.showImage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JDK-20"><a href="#JDK-20" class="headerlink" title="JDK"></a>JDK</h3><ul><li>java.lang.reflect.Proxy</li><li>RMI</li></ul><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>å¼—é‡Œæ›¼. Head First è®¾è®¡æ¨¡å¼ [M]. ä¸­å›½ç”µåŠ›å‡ºç‰ˆç¤¾, 2007.</li><li>Gamma E. è®¾è®¡æ¨¡å¼: å¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ [M]. æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾, 2007.</li><li>Bloch J. Effective java[M]. Addison-Wesley Professional, 2017.</li><li><a href="http://www.oodesign.com/" target="_blank" rel="noopener">Design Patterns</a></li><li><a href="http://java-design-patterns.com/" target="_blank" rel="noopener">Design patterns implemented in Java</a></li><li><a href="http://www.programering.com/a/MTNxAzMwATY.html" target="_blank" rel="noopener">The breakdown of design patterns in JDK</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- GFM-TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸€æ¦‚è¿°&quot;&gt;ä¸€ã€æ¦‚è¿°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#äºŒåˆ›å»ºå‹&quot;&gt;äºŒã€åˆ›å»ºå‹&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-å•ä¾‹singleton&quot;&gt;1. å•ä¾‹ï¼ˆSingletonï¼‰&lt;/a&gt;&lt;/
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Interview-Notebook" scheme="https://airpoet.github.io/categories/Github/Interview-Notebook/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œ</title>
    <link href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    <id>https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/è®¡ç®—æœºç½‘ç»œ/</id>
    <published>2018-07-04T13:51:06.364Z</published>
    <updated>2018-07-09T07:04:27.265Z</updated>
    
    <content type="html"><![CDATA[<!-- GFM-TOC --><ul><li><a href="#ä¸€æ¦‚è¿°">ä¸€ã€æ¦‚è¿°</a><ul><li><a href="#ç½‘ç»œçš„ç½‘ç»œ">ç½‘ç»œçš„ç½‘ç»œ</a></li><li><a href="#isp">ISP</a></li><li><a href="#ä¸»æœºä¹‹é—´çš„é€šä¿¡æ–¹å¼">ä¸»æœºä¹‹é—´çš„é€šä¿¡æ–¹å¼</a></li><li><a href="#ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢">ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢</a></li><li><a href="#æ—¶å»¶">æ—¶å»¶</a></li><li><a href="#è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„">è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„*</a></li></ul></li><li><a href="#äºŒç‰©ç†å±‚">äºŒã€ç‰©ç†å±‚</a><ul><li><a href="#é€šä¿¡æ–¹å¼">é€šä¿¡æ–¹å¼</a></li><li><a href="#å¸¦é€šè°ƒåˆ¶">å¸¦é€šè°ƒåˆ¶</a></li></ul></li><li><a href="#ä¸‰æ•°æ®é“¾è·¯å±‚">ä¸‰ã€æ•°æ®é“¾è·¯å±‚</a><ul><li><a href="#åŸºæœ¬é—®é¢˜">åŸºæœ¬é—®é¢˜</a></li><li><a href="#ä¿¡é“åˆ†ç±»">ä¿¡é“åˆ†ç±»</a></li><li><a href="#ä¿¡é“å¤ç”¨æŠ€æœ¯">ä¿¡é“å¤ç”¨æŠ€æœ¯</a></li><li><a href="#csmacd-åè®®">CSMA/CD åè®®*</a></li><li><a href="#ppp-åè®®">PPP åè®®</a></li><li><a href="#mac-åœ°å€">MAC åœ°å€</a></li><li><a href="#å±€åŸŸç½‘">å±€åŸŸç½‘</a></li><li><a href="#ä»¥å¤ªç½‘">ä»¥å¤ªç½‘*</a></li><li><a href="#äº¤æ¢æœº">äº¤æ¢æœº*</a></li><li><a href="#è™šæ‹Ÿå±€åŸŸç½‘">è™šæ‹Ÿå±€åŸŸç½‘</a></li></ul></li><li><a href="#å››ç½‘ç»œå±‚">å››ã€ç½‘ç»œå±‚*</a><ul><li><a href="#æ¦‚è¿°">æ¦‚è¿°</a></li><li><a href="#ip-æ•°æ®æŠ¥æ ¼å¼">IP æ•°æ®æŠ¥æ ¼å¼</a></li><li><a href="#ip-åœ°å€ç¼–å€æ–¹å¼">IP åœ°å€ç¼–å€æ–¹å¼</a></li><li><a href="#åœ°å€è§£æåè®®-arp">åœ°å€è§£æåè®® ARP</a></li><li><a href="#ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®-icmp">ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®® ICMP</a></li><li><a href="#è™šæ‹Ÿä¸“ç”¨ç½‘-vpn">è™šæ‹Ÿä¸“ç”¨ç½‘ VPN</a></li><li><a href="#ç½‘ç»œåœ°å€è½¬æ¢-nat">ç½‘ç»œåœ°å€è½¬æ¢ NAT</a></li><li><a href="#è·¯ç”±å™¨çš„ç»“æ„">è·¯ç”±å™¨çš„ç»“æ„</a></li><li><a href="#è·¯ç”±å™¨åˆ†ç»„è½¬å‘æµç¨‹">è·¯ç”±å™¨åˆ†ç»„è½¬å‘æµç¨‹</a></li><li><a href="#è·¯ç”±é€‰æ‹©åè®®">è·¯ç”±é€‰æ‹©åè®®</a></li></ul></li><li><a href="#äº”è¿è¾“å±‚">äº”ã€è¿è¾“å±‚*</a><ul><li><a href="#udp-å’Œ-tcp-çš„ç‰¹ç‚¹">UDP å’Œ TCP çš„ç‰¹ç‚¹</a></li><li><a href="#udp-é¦–éƒ¨æ ¼å¼">UDP é¦–éƒ¨æ ¼å¼</a></li><li><a href="#tcp-é¦–éƒ¨æ ¼å¼">TCP é¦–éƒ¨æ ¼å¼</a></li><li><a href="#tcp-çš„ä¸‰æ¬¡æ¡æ‰‹">TCP çš„ä¸‰æ¬¡æ¡æ‰‹</a></li><li><a href="#tcp-çš„å››æ¬¡æŒ¥æ‰‹">TCP çš„å››æ¬¡æŒ¥æ‰‹</a></li><li><a href="#tcp-æ»‘åŠ¨çª—å£">TCP æ»‘åŠ¨çª—å£</a></li><li><a href="#tcp-å¯é ä¼ è¾“">TCP å¯é ä¼ è¾“</a></li><li><a href="#tcp-æµé‡æ§åˆ¶">TCP æµé‡æ§åˆ¶</a></li><li><a href="#tcp-æ‹¥å¡æ§åˆ¶">TCP æ‹¥å¡æ§åˆ¶</a></li></ul></li><li><a href="#å…­åº”ç”¨å±‚">å…­ã€åº”ç”¨å±‚</a><ul><li><a href="#åŸŸåç³»ç»Ÿ">åŸŸåç³»ç»Ÿ</a></li><li><a href="#æ–‡ä»¶ä¼ é€åè®®">æ–‡ä»¶ä¼ é€åè®®</a></li><li><a href="#è¿œç¨‹ç™»å½•åè®®">è¿œç¨‹ç™»å½•åè®®</a></li><li><a href="#ç”µå­é‚®ä»¶åè®®">ç”µå­é‚®ä»¶åè®®</a></li><li><a href="#åŠ¨æ€ä¸»æœºé…ç½®åè®®">åŠ¨æ€ä¸»æœºé…ç½®åè®®</a></li><li><a href="#å¸¸ç”¨ç«¯å£">å¸¸ç”¨ç«¯å£</a></li><li><a href="#web-é¡µé¢è¯·æ±‚è¿‡ç¨‹">Web é¡µé¢è¯·æ±‚è¿‡ç¨‹</a></li></ul></li><li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a><!-- GFM-TOC --></li></ul><h1 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h1><h2 id="ç½‘ç»œçš„ç½‘ç»œ"><a href="#ç½‘ç»œçš„ç½‘ç»œ" class="headerlink" title="ç½‘ç»œçš„ç½‘ç»œ"></a>ç½‘ç»œçš„ç½‘ç»œ</h2><p>ç½‘ç»œæŠŠä¸»æœºè¿æ¥èµ·æ¥ï¼Œè€Œäº’è”ç½‘æ˜¯æŠŠå¤šç§ä¸åŒçš„ç½‘ç»œè¿æ¥èµ·æ¥ï¼Œå› æ­¤äº’è”ç½‘æ˜¯ç½‘ç»œçš„ç½‘ç»œã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045018.gif" width="500"> </div><br></p><h2 id="ISP"><a href="#ISP" class="headerlink" title="ISP"></a>ISP</h2><p>äº’è”ç½‘æœåŠ¡æä¾›å•† ISP å¯ä»¥ä»äº’è”ç½‘ç®¡ç†æœºæ„è·å¾—è®¸å¤š IP åœ°å€ï¼ŒåŒæ—¶æ‹¥æœ‰é€šä¿¡çº¿è·¯ä»¥åŠè·¯ç”±å™¨ç­‰è”ç½‘è®¾å¤‡ï¼Œä¸ªäººæˆ–æœºæ„å‘ ISP ç¼´çº³ä¸€å®šçš„è´¹ç”¨å°±å¯ä»¥æ¥å…¥äº’è”ç½‘ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045024.jpg" width="500"> </div><br></p><p>ç›®å‰çš„äº’è”ç½‘æ˜¯ä¸€ç§å¤šå±‚æ¬¡ ISP ç»“æ„ï¼ŒISP æ ¹æ®è¦†ç›–é¢ç§¯çš„å¤§å°åˆ†ä¸ºç¬¬ä¸€å±‚ ISPã€åŒºåŸŸ ISP å’Œæ¥å…¥ ISPã€‚</p><p>äº’è”ç½‘äº¤æ¢ç‚¹ IXP å…è®¸ä¸¤ä¸ª ISP ç›´æ¥ç›¸è¿è€Œä¸ç”¨ç»è¿‡ç¬¬ä¸‰ä¸ª ISPã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045028.jpg" width="500"> </div><br></p><h2 id="ä¸»æœºä¹‹é—´çš„é€šä¿¡æ–¹å¼"><a href="#ä¸»æœºä¹‹é—´çš„é€šä¿¡æ–¹å¼" class="headerlink" title="ä¸»æœºä¹‹é—´çš„é€šä¿¡æ–¹å¼"></a>ä¸»æœºä¹‹é—´çš„é€šä¿¡æ–¹å¼</h2><ul><li><p>å®¢æˆ·-æœåŠ¡å™¨ï¼ˆC/Sï¼‰ï¼šå®¢æˆ·æ˜¯æœåŠ¡çš„è¯·æ±‚æ–¹ï¼ŒæœåŠ¡å™¨æ˜¯æœåŠ¡çš„æä¾›æ–¹ã€‚</p></li><li><p>å¯¹ç­‰ï¼ˆP2Pï¼‰ï¼šä¸åŒºåˆ†å®¢æˆ·å’ŒæœåŠ¡å™¨ã€‚</p></li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045030.jpg" width=""> </div><br></p><h2 id="ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢"><a href="#ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢" class="headerlink" title="ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢"></a>ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢</h2><h3 id="1-ç”µè·¯äº¤æ¢"><a href="#1-ç”µè·¯äº¤æ¢" class="headerlink" title="1. ç”µè·¯äº¤æ¢"></a>1. ç”µè·¯äº¤æ¢</h3><p>ç”µè·¯äº¤æ¢ç”¨äºç”µè¯é€šä¿¡ç³»ç»Ÿï¼Œä¸¤ä¸ªç”¨æˆ·è¦é€šä¿¡ä¹‹å‰éœ€è¦å»ºç«‹ä¸€æ¡ä¸“ç”¨çš„ç‰©ç†é“¾è·¯ï¼Œå¹¶ä¸”åœ¨æ•´ä¸ªé€šä¿¡è¿‡ç¨‹ä¸­å§‹ç»ˆå ç”¨è¯¥é“¾è·¯ã€‚ç”±äºé€šä¿¡çš„è¿‡ç¨‹ä¸­ä¸å¯èƒ½ä¸€ç›´åœ¨ä½¿ç”¨ä¼ è¾“çº¿è·¯ï¼Œå› æ­¤ç”µè·¯äº¤æ¢å¯¹çº¿è·¯çš„åˆ©ç”¨ç‡å¾ˆä½ï¼Œå¾€å¾€ä¸åˆ° 10%ã€‚</p><h3 id="2-åˆ†ç»„äº¤æ¢"><a href="#2-åˆ†ç»„äº¤æ¢" class="headerlink" title="2. åˆ†ç»„äº¤æ¢"></a>2. åˆ†ç»„äº¤æ¢</h3><p>æ¯ä¸ªåˆ†ç»„éƒ½æœ‰é¦–éƒ¨å’Œå°¾éƒ¨ï¼ŒåŒ…å«äº†æºåœ°å€å’Œç›®çš„åœ°å€ç­‰æ§åˆ¶ä¿¡æ¯ï¼Œåœ¨åŒä¸€ä¸ªä¼ è¾“çº¿è·¯ä¸ŠåŒæ—¶ä¼ è¾“å¤šä¸ªåˆ†ç»„äº’ç›¸ä¸ä¼šå½±å“ï¼Œå› æ­¤åœ¨åŒä¸€æ¡ä¼ è¾“çº¿è·¯ä¸Šå…è®¸åŒæ—¶ä¼ è¾“å¤šä¸ªåˆ†ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´åˆ†ç»„äº¤æ¢ä¸éœ€è¦å ç”¨ä¼ è¾“çº¿è·¯ã€‚</p><p>è€ƒè™‘åœ¨ä¸€ä¸ªé‚®å±€é€šä¿¡ç³»ç»Ÿä¸­ï¼Œé‚®å±€æ”¶åˆ°ä¸€ä»½é‚®ä»¶ä¹‹åï¼Œå…ˆå­˜å‚¨ä¸‹æ¥ï¼Œç„¶åæŠŠç›¸åŒç›®çš„åœ°çš„é‚®ä»¶ä¸€èµ·è½¬å‘åˆ°ä¸‹ä¸€ä¸ªç›®çš„åœ°ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å­˜å‚¨è½¬å‘è¿‡ç¨‹ï¼Œåˆ†ç»„äº¤æ¢ä¹Ÿä½¿ç”¨äº†å­˜å‚¨è½¬å‘è¿‡ç¨‹ã€‚</p><h2 id="æ—¶å»¶"><a href="#æ—¶å»¶" class="headerlink" title="æ—¶å»¶"></a>æ—¶å»¶</h2><p>æ€»æ—¶å»¶ = ä¼ è¾“æ—¶å»¶ + ä¼ æ’­æ—¶å»¶ + å¤„ç†æ—¶å»¶ + æ’é˜Ÿæ—¶å»¶</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045034.png" width="800"> </div><br></p><h3 id="1-ä¼ è¾“æ—¶å»¶"><a href="#1-ä¼ è¾“æ—¶å»¶" class="headerlink" title="1. ä¼ è¾“æ—¶å»¶"></a>1. ä¼ è¾“æ—¶å»¶</h3><p>ä¸»æœºæˆ–è·¯ç”±å™¨ä¼ è¾“æ•°æ®å¸§æ‰€éœ€è¦çš„æ—¶é—´ã€‚</p><p><div align="center"><img src="https://latex.codecogs.com/gif.latex?delay=\frac{l(bit)}{v(bit/s)}"></div> <br></p><p>å…¶ä¸­ l è¡¨ç¤ºæ•°æ®å¸§çš„é•¿åº¦ï¼Œv è¡¨ç¤ºä¼ è¾“é€Ÿç‡ã€‚</p><h3 id="2-ä¼ æ’­æ—¶å»¶"><a href="#2-ä¼ æ’­æ—¶å»¶" class="headerlink" title="2. ä¼ æ’­æ—¶å»¶"></a>2. ä¼ æ’­æ—¶å»¶</h3><p>ç”µç£æ³¢åœ¨ä¿¡é“ä¸­ä¼ æ’­ä¸€å®šçš„è·ç¦»éœ€è¦èŠ±è´¹çš„æ—¶é—´ï¼Œç”µç£æ³¢ä¼ æ’­é€Ÿåº¦æ¥è¿‘å…‰é€Ÿã€‚</p><p><div align="center"><img src="https://latex.codecogs.com/gif.latex?delay=\frac{l(m)}{v(m/s)}"></div> <br></p><p>å…¶ä¸­ l è¡¨ç¤ºä¿¡é“é•¿åº¦ï¼Œv è¡¨ç¤ºç”µç£æ³¢åœ¨ä¿¡é“ä¸Šçš„ä¼ æ’­é€Ÿç‡ã€‚</p><h3 id="3-å¤„ç†æ—¶å»¶"><a href="#3-å¤„ç†æ—¶å»¶" class="headerlink" title="3. å¤„ç†æ—¶å»¶"></a>3. å¤„ç†æ—¶å»¶</h3><p>ä¸»æœºæˆ–è·¯ç”±å™¨æ”¶åˆ°åˆ†ç»„æ—¶è¿›è¡Œå¤„ç†æ‰€éœ€è¦çš„æ—¶é—´ï¼Œä¾‹å¦‚åˆ†æé¦–éƒ¨ã€ä»åˆ†ç»„ä¸­æå–æ•°æ®ã€è¿›è¡Œå·®é”™æ£€éªŒæˆ–æŸ¥æ‰¾é€‚å½“çš„è·¯ç”±ç­‰ã€‚</p><h3 id="4-æ’é˜Ÿæ—¶å»¶"><a href="#4-æ’é˜Ÿæ—¶å»¶" class="headerlink" title="4. æ’é˜Ÿæ—¶å»¶"></a>4. æ’é˜Ÿæ—¶å»¶</h3><p>åˆ†ç»„åœ¨è·¯ç”±å™¨çš„è¾“å…¥é˜Ÿåˆ—å’Œè¾“å‡ºé˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…çš„æ—¶é—´ï¼Œå–å†³äºç½‘ç»œå½“å‰çš„é€šä¿¡é‡ã€‚</p><h2 id="è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„"><a href="#è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„" class="headerlink" title="è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„*"></a>è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„*</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045041.png" width="800"> </div><br></p><h3 id="1-äº”å±‚åè®®"><a href="#1-äº”å±‚åè®®" class="headerlink" title="1. äº”å±‚åè®®"></a>1. äº”å±‚åè®®</h3><ul><li><p><strong>åº”ç”¨å±‚</strong> ï¼šä¸ºç‰¹å®šåº”ç”¨ç¨‹åºæä¾›æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œä¾‹å¦‚ HTTPã€DNS ç­‰ã€‚æ•°æ®å•ä½ä¸ºæŠ¥æ–‡ã€‚</p></li><li><p><strong>è¿è¾“å±‚</strong> ï¼šæä¾›çš„æ˜¯è¿›ç¨‹é—´çš„é€šç”¨æ•°æ®ä¼ è¾“æœåŠ¡ã€‚ç”±äºåº”ç”¨å±‚åè®®å¾ˆå¤šï¼Œå®šä¹‰é€šç”¨çš„è¿è¾“å±‚åè®®å°±å¯ä»¥æ”¯æŒä¸æ–­å¢å¤šçš„åº”ç”¨å±‚åè®®ã€‚è¿è¾“å±‚åŒ…æ‹¬ä¸¤ç§åè®®ï¼šä¼ è¾“æ§åˆ¶åè®® TCPï¼Œæä¾›é¢å‘è¿æ¥ã€å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œæ•°æ®å•ä½ä¸ºæŠ¥æ–‡æ®µï¼›ç”¨æˆ·æ•°æ®æŠ¥åè®® UDPï¼Œæä¾›æ— è¿æ¥ã€å°½æœ€å¤§åŠªåŠ›çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œæ•°æ®å•ä½ä¸ºç”¨æˆ·æ•°æ®æŠ¥ã€‚TCP ä¸»è¦æä¾›å®Œæ•´æ€§æœåŠ¡ï¼ŒUDP ä¸»è¦æä¾›åŠæ—¶æ€§æœåŠ¡ã€‚</p></li><li><p><strong>ç½‘ç»œå±‚</strong> ï¼šä¸ºä¸»æœºé—´æä¾›æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œè€Œè¿è¾“å±‚åè®®æ˜¯ä¸ºä¸»æœºä¸­çš„è¿›ç¨‹æä¾›æœåŠ¡ã€‚ç½‘ç»œå±‚æŠŠè¿è¾“å±‚ä¼ é€’ä¸‹æ¥çš„æŠ¥æ–‡æ®µæˆ–è€…ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„ã€‚</p></li><li><p><strong>æ•°æ®é“¾è·¯å±‚</strong> ï¼šç½‘ç»œå±‚é’ˆå¯¹çš„è¿˜æ˜¯ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œè€Œä¸»æœºä¹‹é—´å¯ä»¥æœ‰å¾ˆå¤šé“¾è·¯ï¼Œé“¾è·¯å±‚åè®®å°±æ˜¯ä¸ºåŒä¸€é“¾è·¯çš„èŠ‚ç‚¹æä¾›æœåŠ¡ã€‚æ•°æ®é“¾è·¯å±‚æŠŠç½‘ç»œå±‚ä¼ æ¥çš„åˆ†ç»„å°è£…æˆå¸§ã€‚</p></li><li><p><strong>ç‰©ç†å±‚</strong> ï¼šè€ƒè™‘çš„æ˜¯æ€æ ·åœ¨ä¼ è¾“åª’ä½“ä¸Šä¼ è¾“æ•°æ®æ¯”ç‰¹æµï¼Œè€Œä¸æ˜¯æŒ‡å…·ä½“çš„ä¼ è¾“åª’ä½“ã€‚ç‰©ç†å±‚çš„ä½œç”¨æ˜¯å°½å¯èƒ½å±è”½ä¼ è¾“åª’ä½“å’Œé€šä¿¡æ‰‹æ®µçš„å·®å¼‚ï¼Œä½¿æ•°æ®é“¾è·¯å±‚æ„Ÿè§‰ä¸åˆ°è¿™äº›å·®å¼‚ã€‚</p></li></ul><h3 id="2-ä¸ƒå±‚åè®®"><a href="#2-ä¸ƒå±‚åè®®" class="headerlink" title="2. ä¸ƒå±‚åè®®"></a>2. ä¸ƒå±‚åè®®</h3><p>å…¶ä¸­è¡¨ç¤ºå±‚å’Œä¼šè¯å±‚ç”¨é€”å¦‚ä¸‹ï¼š</p><ul><li><p><strong>è¡¨ç¤ºå±‚</strong> ï¼šæ•°æ®å‹ç¼©ã€åŠ å¯†ä»¥åŠæ•°æ®æè¿°ã€‚è¿™ä½¿å¾—åº”ç”¨ç¨‹åºä¸å¿…æ‹…å¿ƒåœ¨å„å°ä¸»æœºä¸­è¡¨ç¤º/å­˜å‚¨çš„å†…éƒ¨æ ¼å¼ä¸åŒçš„é—®é¢˜ã€‚</p></li><li><p><strong>ä¼šè¯å±‚</strong> ï¼šå»ºç«‹åŠç®¡ç†ä¼šè¯ã€‚</p></li></ul><p>äº”å±‚åè®®æ²¡æœ‰è¡¨ç¤ºå±‚å’Œä¼šè¯å±‚ï¼Œè€Œæ˜¯å°†è¿™äº›åŠŸèƒ½ç•™ç»™åº”ç”¨ç¨‹åºå¼€å‘è€…å¤„ç†ã€‚</p><h3 id="3-æ•°æ®åœ¨å„å±‚ä¹‹é—´çš„ä¼ é€’è¿‡ç¨‹"><a href="#3-æ•°æ®åœ¨å„å±‚ä¹‹é—´çš„ä¼ é€’è¿‡ç¨‹" class="headerlink" title="3. æ•°æ®åœ¨å„å±‚ä¹‹é—´çš„ä¼ é€’è¿‡ç¨‹"></a>3. æ•°æ®åœ¨å„å±‚ä¹‹é—´çš„ä¼ é€’è¿‡ç¨‹</h3><p>åœ¨å‘ä¸‹çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ·»åŠ ä¸‹å±‚åè®®æ‰€éœ€è¦çš„é¦–éƒ¨æˆ–è€…å°¾éƒ¨ï¼Œè€Œåœ¨å‘ä¸Šçš„è¿‡ç¨‹ä¸­ä¸æ–­æ‹†å¼€é¦–éƒ¨å’Œå°¾éƒ¨ã€‚</p><p>è·¯ç”±å™¨åªæœ‰ä¸‹é¢ä¸‰å±‚åè®®ï¼Œå› ä¸ºè·¯ç”±å™¨ä½äºç½‘ç»œæ ¸å¿ƒä¸­ï¼Œä¸éœ€è¦ä¸ºè¿›ç¨‹æˆ–è€…åº”ç”¨ç¨‹åºæä¾›æœåŠ¡ï¼Œå› æ­¤ä¹Ÿå°±ä¸éœ€è¦è¿è¾“å±‚å’Œåº”ç”¨å±‚ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045047.jpg" width="800"> </div><br></p><h3 id="4-TCP-IP"><a href="#4-TCP-IP" class="headerlink" title="4. TCP/IP"></a>4. TCP/IP</h3><p>å®ƒåªæœ‰å››å±‚ï¼Œç›¸å½“äºäº”å±‚åè®®ä¸­æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚åˆå¹¶ä¸ºç½‘ç»œæ¥å£å±‚ã€‚</p><p>ç°åœ¨çš„ TCP/IP ä½“ç³»ç»“æ„ä¸ä¸¥æ ¼éµå¾ª OSI åˆ†å±‚æ¦‚å¿µï¼Œåº”ç”¨å±‚å¯èƒ½ä¼šç›´æ¥ä½¿ç”¨ IP å±‚æˆ–è€…ç½‘ç»œæ¥å£å±‚ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045054.png" width="400"> </div><br></p><p>TCP/IP åè®®æ—æ˜¯ä¸€ç§æ²™æ¼å½¢çŠ¶ï¼Œä¸­é—´å°ä¸¤è¾¹å¤§ï¼ŒIP åè®®åœ¨å…¶ä¸­å ç”¨ä¸¾è¶³è½»é‡çš„åœ°ä½ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045100.png" width="500"> </div><br></p><h1 id="äºŒã€ç‰©ç†å±‚"><a href="#äºŒã€ç‰©ç†å±‚" class="headerlink" title="äºŒã€ç‰©ç†å±‚"></a>äºŒã€ç‰©ç†å±‚</h1><h2 id="é€šä¿¡æ–¹å¼"><a href="#é€šä¿¡æ–¹å¼" class="headerlink" title="é€šä¿¡æ–¹å¼"></a>é€šä¿¡æ–¹å¼</h2><p>æ ¹æ®ä¿¡æ¯åœ¨ä¼ è¾“çº¿ä¸Šçš„ä¼ é€æ–¹å‘ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸‰ç§é€šä¿¡æ–¹å¼ï¼š</p><ul><li>å•å·¥é€šä¿¡ï¼šå•å‘ä¼ è¾“</li><li>åŠåŒå·¥é€šä¿¡ï¼šåŒå‘äº¤æ›¿ä¼ è¾“</li><li>å…¨åŒå·¥é€šä¿¡ï¼šåŒå‘åŒæ—¶ä¼ è¾“</li></ul><h2 id="å¸¦é€šè°ƒåˆ¶"><a href="#å¸¦é€šè°ƒåˆ¶" class="headerlink" title="å¸¦é€šè°ƒåˆ¶"></a>å¸¦é€šè°ƒåˆ¶</h2><p>æ¨¡æ‹Ÿä¿¡å·æ˜¯è¿ç»­çš„ä¿¡å·ï¼Œæ•°å­—ä¿¡å·æ˜¯ç¦»æ•£çš„ä¿¡å·ã€‚å¸¦é€šè°ƒåˆ¶æŠŠæ•°å­—ä¿¡å·è½¬æ¢ä¸ºæ¨¡æ‹Ÿä¿¡å·ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045108.jpg"> </div><br></p><h1 id="ä¸‰ã€æ•°æ®é“¾è·¯å±‚"><a href="#ä¸‰ã€æ•°æ®é“¾è·¯å±‚" class="headerlink" title="ä¸‰ã€æ•°æ®é“¾è·¯å±‚"></a>ä¸‰ã€æ•°æ®é“¾è·¯å±‚</h1><h2 id="åŸºæœ¬é—®é¢˜"><a href="#åŸºæœ¬é—®é¢˜" class="headerlink" title="åŸºæœ¬é—®é¢˜"></a>åŸºæœ¬é—®é¢˜</h2><h3 id="1-å°è£…æˆå¸§"><a href="#1-å°è£…æˆå¸§" class="headerlink" title="1. å°è£…æˆå¸§"></a>1. å°è£…æˆå¸§</h3><p>å°†ç½‘ç»œå±‚ä¼ ä¸‹æ¥çš„åˆ†ç»„æ·»åŠ é¦–éƒ¨å’Œå°¾éƒ¨ï¼Œç”¨äºæ ‡è®°å¸§çš„å¼€å§‹å’Œç»“æŸã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045112.jpg" width="500"> </div><br></p><h3 id="2-é€æ˜ä¼ è¾“"><a href="#2-é€æ˜ä¼ è¾“" class="headerlink" title="2. é€æ˜ä¼ è¾“"></a>2. é€æ˜ä¼ è¾“</h3><p>é€æ˜è¡¨ç¤ºä¸€ä¸ªå®é™…å­˜åœ¨çš„äº‹ç‰©çœ‹èµ·æ¥å¥½åƒä¸å­˜åœ¨ä¸€æ ·ã€‚</p><p>å¸§ä½¿ç”¨é¦–éƒ¨å’Œå°¾éƒ¨è¿›è¡Œå®šç•Œï¼Œå¦‚æœå¸§çš„æ•°æ®éƒ¨åˆ†å«æœ‰å’Œé¦–éƒ¨å°¾éƒ¨ç›¸åŒçš„å†…å®¹ï¼Œé‚£ä¹ˆå¸§çš„å¼€å§‹å’Œç»“æŸä½ç½®å°±ä¼šè¢«é”™è¯¯çš„åˆ¤å®šã€‚éœ€è¦åœ¨æ•°æ®éƒ¨åˆ†å‡ºç°é¦–éƒ¨å°¾éƒ¨ç›¸åŒçš„å†…å®¹å‰é¢æ’å…¥è½¬ä¹‰å­—ç¬¦ï¼Œå¦‚æœå‡ºç°è½¬ä¹‰å­—ç¬¦ï¼Œé‚£ä¹ˆå°±åœ¨è½¬ä¹‰å­—ç¬¦å‰é¢å†åŠ ä¸ªè½¬ä¹‰å­—ç¬¦ï¼Œåœ¨æ¥æ”¶ç«¯è¿›è¡Œå¤„ç†ä¹‹åå¯ä»¥è¿˜åŸå‡ºåŸå§‹æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹é€æ˜ä¼ è¾“çš„å†…å®¹æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œç”¨æˆ·å¯Ÿè§‰ä¸åˆ°è½¬ä¹‰å­—ç¬¦çš„å­˜åœ¨ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045114.jpg" width="600"> </div><br></p><h3 id="3-å·®é”™æ£€æµ‹"><a href="#3-å·®é”™æ£€æµ‹" class="headerlink" title="3. å·®é”™æ£€æµ‹"></a>3. å·®é”™æ£€æµ‹</h3><p>ç›®å‰æ•°æ®é“¾è·¯å±‚å¹¿æ³›ä½¿ç”¨äº†å¾ªç¯å†—ä½™æ£€éªŒï¼ˆCRCï¼‰æ¥æ£€æŸ¥æ¯”ç‰¹å·®é”™ã€‚</p><h2 id="ä¿¡é“åˆ†ç±»"><a href="#ä¿¡é“åˆ†ç±»" class="headerlink" title="ä¿¡é“åˆ†ç±»"></a>ä¿¡é“åˆ†ç±»</h2><h3 id="1-å¹¿æ’­ä¿¡é“"><a href="#1-å¹¿æ’­ä¿¡é“" class="headerlink" title="1. å¹¿æ’­ä¿¡é“"></a>1. å¹¿æ’­ä¿¡é“</h3><p>ä¸€å¯¹å¤šé€šä¿¡ï¼Œä¸€ä¸ªèŠ‚ç‚¹å‘é€çš„æ•°æ®èƒ½å¤Ÿè¢«å¹¿æ’­ä¿¡é“ä¸Šæ‰€æœ‰çš„èŠ‚ç‚¹æ¥æ”¶åˆ°ã€‚</p><p>æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½åœ¨åŒä¸€ä¸ªå¹¿æ’­ä¿¡é“ä¸Šå‘é€æ•°æ®ï¼Œå› æ­¤éœ€è¦æœ‰ä¸“é—¨çš„æ§åˆ¶æ–¹æ³•è¿›è¡Œåè°ƒï¼Œé¿å…å‘ç”Ÿå†²çªï¼ˆå†²çªä¹Ÿå«ç¢°æ’ï¼‰ã€‚</p><p>ä¸»è¦æœ‰ä¸¤ç§æ§åˆ¶æ–¹æ³•è¿›è¡Œåè°ƒï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨ä¿¡é“å¤ç”¨æŠ€æœ¯ï¼Œä¸€æ˜¯ä½¿ç”¨ CSMA/CD åè®®ã€‚</p><h3 id="2-ç‚¹å¯¹ç‚¹ä¿¡é“"><a href="#2-ç‚¹å¯¹ç‚¹ä¿¡é“" class="headerlink" title="2. ç‚¹å¯¹ç‚¹ä¿¡é“"></a>2. ç‚¹å¯¹ç‚¹ä¿¡é“</h3><p>ä¸€å¯¹ä¸€é€šä¿¡ã€‚</p><p>å› ä¸ºä¸ä¼šå‘ç”Ÿç¢°æ’ï¼Œå› æ­¤ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨ PPP åè®®è¿›è¡Œæ§åˆ¶ã€‚</p><h2 id="ä¿¡é“å¤ç”¨æŠ€æœ¯"><a href="#ä¿¡é“å¤ç”¨æŠ€æœ¯" class="headerlink" title="ä¿¡é“å¤ç”¨æŠ€æœ¯"></a>ä¿¡é“å¤ç”¨æŠ€æœ¯</h2><h3 id="1-é¢‘åˆ†å¤ç”¨"><a href="#1-é¢‘åˆ†å¤ç”¨" class="headerlink" title="1. é¢‘åˆ†å¤ç”¨"></a>1. é¢‘åˆ†å¤ç”¨</h3><p>é¢‘åˆ†å¤ç”¨çš„æ‰€æœ‰ä¸»æœºåœ¨ç›¸åŒçš„æ—¶é—´å ç”¨ä¸åŒçš„é¢‘ç‡å¸¦å®½èµ„æºã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045121.jpg"> </div><br></p><h3 id="2-æ—¶åˆ†å¤ç”¨"><a href="#2-æ—¶åˆ†å¤ç”¨" class="headerlink" title="2. æ—¶åˆ†å¤ç”¨"></a>2. æ—¶åˆ†å¤ç”¨</h3><p>æ—¶åˆ†å¤ç”¨çš„æ‰€æœ‰ä¸»æœºåœ¨ä¸åŒçš„æ—¶é—´å ç”¨ç›¸åŒçš„é¢‘ç‡å¸¦å®½èµ„æºã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045124.jpg"> </div><br></p><p>ä½¿ç”¨é¢‘åˆ†å¤ç”¨å’Œæ—¶åˆ†å¤ç”¨è¿›è¡Œé€šä¿¡ï¼Œåœ¨é€šä¿¡çš„è¿‡ç¨‹ä¸­ä¸»æœºä¼šä¸€ç›´å ç”¨ä¸€éƒ¨åˆ†ä¿¡é“èµ„æºã€‚ä½†æ˜¯ç”±äºè®¡ç®—æœºæ•°æ®çš„çªå‘æ€§è´¨ï¼Œé€šä¿¡è¿‡ç¨‹æ²¡å¿…è¦ä¸€ç›´å ç”¨ä¿¡é“èµ„æºè€Œä¸è®©å‡ºç»™å…¶å®ƒç”¨æˆ·ä½¿ç”¨ï¼Œå› æ­¤è¿™ä¸¤ç§æ–¹å¼å¯¹ä¿¡é“çš„åˆ©ç”¨ç‡éƒ½ä¸é«˜ã€‚</p><h3 id="3-ç»Ÿè®¡æ—¶åˆ†å¤ç”¨"><a href="#3-ç»Ÿè®¡æ—¶åˆ†å¤ç”¨" class="headerlink" title="3. ç»Ÿè®¡æ—¶åˆ†å¤ç”¨"></a>3. ç»Ÿè®¡æ—¶åˆ†å¤ç”¨</h3><p>æ˜¯å¯¹æ—¶åˆ†å¤ç”¨çš„ä¸€ç§æ”¹è¿›ï¼Œä¸å›ºå®šæ¯ä¸ªç”¨æˆ·åœ¨æ—¶åˆ†å¤ç”¨å¸§ä¸­çš„ä½ç½®ï¼Œåªè¦æœ‰æ•°æ®å°±é›†ä¸­èµ·æ¥ç»„æˆç»Ÿè®¡æ—¶åˆ†å¤ç”¨å¸§ç„¶åå‘é€ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045130.png" width="700"> </div><br></p><h3 id="4-æ³¢åˆ†å¤ç”¨"><a href="#4-æ³¢åˆ†å¤ç”¨" class="headerlink" title="4. æ³¢åˆ†å¤ç”¨"></a>4. æ³¢åˆ†å¤ç”¨</h3><p>å…‰çš„é¢‘åˆ†å¤ç”¨ã€‚ç”±äºå…‰çš„é¢‘ç‡å¾ˆé«˜ï¼Œå› æ­¤ä¹ æƒ¯ä¸Šç”¨æ³¢é•¿è€Œä¸æ˜¯é¢‘ç‡æ¥è¡¨ç¤ºæ‰€ä½¿ç”¨çš„å…‰è½½æ³¢ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045137.png" width="700"> </div><br></p><h3 id="5-ç åˆ†å¤ç”¨"><a href="#5-ç åˆ†å¤ç”¨" class="headerlink" title="5. ç åˆ†å¤ç”¨"></a>5. ç åˆ†å¤ç”¨</h3><p>ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é… m bit çš„ç ç‰‡ï¼Œå¹¶ä¸”æ‰€æœ‰çš„ç ç‰‡æ­£äº¤ï¼Œå¯¹äºä»»æ„ä¸¤ä¸ªç ç‰‡ <img src="https://latex.codecogs.com/gif.latex?\vec{S}"> å’Œ <img src="https://latex.codecogs.com/gif.latex?\vec{T}"> æœ‰</p><p><div align="center"><img src="https://latex.codecogs.com/gif.latex?\frac{1}{m}\vec{S}\cdot\vec{T}=0"></div> <br></p><p>ä¸ºäº†è®¨è®ºæ–¹ä¾¿ï¼Œå– m=8ï¼Œè®¾ç ç‰‡ <img src="https://latex.codecogs.com/gif.latex?\vec{S}"> ä¸º 00011011ã€‚åœ¨æ‹¥æœ‰è¯¥ç ç‰‡çš„ç”¨æˆ·å‘é€æ¯”ç‰¹ 1 æ—¶å°±å‘é€è¯¥ç ç‰‡ï¼Œå‘é€æ¯”ç‰¹ 0 æ—¶å°±å‘é€è¯¥ç ç‰‡çš„åç  11100100ã€‚</p><p>åœ¨è®¡ç®—æ—¶å°† 00011011 è®°ä½œ (-1 -1 -1 +1 +1 -1 +1 +1)ï¼Œå¯ä»¥å¾—åˆ°</p><p><div align="center"><img src="https://latex.codecogs.com/gif.latex?\frac{1}{m}\vec{S}\cdot\vec{S}=1"></div> <br></p><p><div align="center"><img src="https://latex.codecogs.com/gif.latex?\frac{1}{m}\vec{S}\cdot\vec{S'}=-1"></div> <br></p><p>å…¶ä¸­ <img src="https://latex.codecogs.com/gif.latex?\vec{S'}"> ä¸º <img src="https://latex.codecogs.com/gif.latex?\vec{S}"> çš„åç ã€‚</p><p>åˆ©ç”¨ä¸Šé¢çš„å¼å­æˆ‘ä»¬çŸ¥é“ï¼Œå½“æ¥æ”¶ç«¯ä½¿ç”¨ç ç‰‡ <img src="https://latex.codecogs.com/gif.latex?\vec{S}"> å¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œå†…ç§¯è¿ç®—æ—¶ï¼Œç»“æœä¸º 0 çš„æ˜¯å…¶å®ƒç”¨æˆ·å‘é€çš„æ•°æ®ï¼Œç»“æœä¸º 1 çš„æ˜¯ç”¨æˆ·å‘é€çš„æ¯”ç‰¹ 1ï¼Œç»“æœä¸º -1 çš„æ˜¯ç”¨æˆ·å‘é€çš„æ¯”ç‰¹ 0ã€‚</p><p>ç åˆ†å¤ç”¨éœ€è¦å‘é€çš„æ•°æ®é‡ä¸ºåŸå…ˆçš„ m å€ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045144.png" width="600"> </div><br></p><h2 id="CSMA-CD-åè®®"><a href="#CSMA-CD-åè®®" class="headerlink" title="CSMA/CD åè®®*"></a>CSMA/CD åè®®*</h2><p>CSMA/CD è¡¨ç¤ºè½½æ³¢ç›‘å¬å¤šç‚¹æ¥å…¥ / ç¢°æ’æ£€æµ‹ã€‚</p><ul><li><strong>å¤šç‚¹æ¥å…¥</strong> ï¼šè¯´æ˜è¿™æ˜¯æ€»çº¿å‹ç½‘ç»œï¼Œè®¸å¤šä¸»æœºä»¥å¤šç‚¹çš„æ–¹å¼è¿æ¥åˆ°æ€»çº¿ä¸Šã€‚</li><li><strong>è½½æ³¢ç›‘å¬</strong> ï¼šæ¯ä¸ªä¸»æœºéƒ½å¿…é¡»ä¸åœåœ°ç›‘å¬ä¿¡é“ã€‚åœ¨å‘é€å‰ï¼Œå¦‚æœç›‘å¬åˆ°ä¿¡é“æ­£åœ¨ä½¿ç”¨ï¼Œå°±å¿…é¡»ç­‰å¾…ã€‚</li><li><strong>ç¢°æ’æ£€æµ‹</strong> ï¼šåœ¨å‘é€ä¸­ï¼Œå¦‚æœç›‘å¬åˆ°ä¿¡é“å·²æœ‰å…¶å®ƒä¸»æœºæ­£åœ¨å‘é€æ•°æ®ï¼Œå°±è¡¨ç¤ºå‘ç”Ÿäº†ç¢°æ’ã€‚è™½ç„¶æ¯ä¸€ä¸ªä¸»æœºåœ¨å‘é€æ•°æ®ä¹‹å‰éƒ½å·²ç»ç›‘å¬åˆ°ä¿¡é“ä¸ºç©ºé—²ï¼Œä½†æ˜¯ç”±äºç”µç£æ³¢çš„ä¼ æ’­æ—¶å»¶çš„å­˜åœ¨ï¼Œè¿˜æ˜¯æœ‰å¯èƒ½ä¼šå‘ç”Ÿç¢°æ’ã€‚</li></ul><p>è®°ç«¯åˆ°ç«¯çš„ä¼ æ’­æ—¶å»¶ä¸º Ï„ï¼Œæœ€å…ˆå‘é€çš„ç«™ç‚¹æœ€å¤šç»è¿‡ 2Ï„ å°±å¯ä»¥çŸ¥é“æ˜¯å¦å‘ç”Ÿäº†ç¢°æ’ï¼Œç§° 2Ï„ ä¸º  <strong>äº‰ç”¨æœŸ</strong> ã€‚åªæœ‰ç»è¿‡äº‰ç”¨æœŸä¹‹åè¿˜æ²¡æœ‰æ£€æµ‹åˆ°ç¢°æ’ï¼Œæ‰èƒ½è‚¯å®šè¿™æ¬¡å‘é€ä¸ä¼šå‘ç”Ÿç¢°æ’ã€‚</p><p>å½“å‘ç”Ÿç¢°æ’æ—¶ï¼Œç«™ç‚¹è¦åœæ­¢å‘é€ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´å†å‘é€ã€‚è¿™ä¸ªæ—¶é—´é‡‡ç”¨  <strong>æˆªæ–­äºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ç®—æ³•</strong>  æ¥ç¡®å®šï¼Œä»ç¦»æ•£çš„æ•´æ•°é›†åˆ {0, 1, .., (2<sup>k</sup>-1)} ä¸­éšæœºå–å‡ºä¸€ä¸ªæ•°ï¼Œè®°ä½œ rï¼Œç„¶åå– r å€çš„äº‰ç”¨æœŸä½œä¸ºé‡ä¼ ç­‰å¾…æ—¶é—´ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045148.png" width="600"> </div><br></p><h2 id="PPP-åè®®"><a href="#PPP-åè®®" class="headerlink" title="PPP åè®®"></a>PPP åè®®</h2><p>äº’è”ç½‘ç”¨æˆ·é€šå¸¸éœ€è¦è¿æ¥åˆ°æŸä¸ª ISP ä¹‹åæ‰èƒ½æ¥å…¥åˆ°äº’è”ç½‘ï¼ŒPPP åè®®æ˜¯ç”¨æˆ·è®¡ç®—æœºå’Œ ISP è¿›è¡Œé€šä¿¡æ—¶æ‰€ä½¿ç”¨çš„æ•°æ®é“¾è·¯å±‚åè®®ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045154.jpg" width="600"> </div><br></p><p>åœ¨ PPP çš„å¸§ä¸­ï¼š</p><ul><li>F å­—æ®µä¸ºå¸§çš„å®šç•Œç¬¦</li><li>A å’Œ C å­—æ®µæš‚æ—¶æ²¡æœ‰æ„ä¹‰</li><li>FCS å­—æ®µæ˜¯ä½¿ç”¨ CRC çš„æ£€éªŒåºåˆ—</li><li>ä¿¡æ¯éƒ¨åˆ†çš„é•¿åº¦ä¸è¶…è¿‡ 1500</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045158.jpg" width="500"> </div><br></p><h2 id="MAC-åœ°å€"><a href="#MAC-åœ°å€" class="headerlink" title="MAC åœ°å€"></a>MAC åœ°å€</h2><p>MAC åœ°å€æ˜¯é“¾è·¯å±‚åœ°å€ï¼Œé•¿åº¦ä¸º 6 å­—èŠ‚ï¼ˆ48 ä½ï¼‰ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†ç½‘ç»œé€‚é…å™¨ï¼ˆç½‘å¡ï¼‰ã€‚ä¸€å°ä¸»æœºæ‹¥æœ‰å¤šå°‘ä¸ªé€‚é…å™¨å°±æœ‰å¤šå°‘ä¸ª MAC åœ°å€ã€‚ä¾‹å¦‚ç¬”è®°æœ¬ç”µè„‘æ™®éå­˜åœ¨æ— çº¿ç½‘ç»œé€‚é…å™¨å’Œæœ‰çº¿ç½‘ç»œé€‚é…å™¨ï¼Œå› æ­¤å°±æœ‰ä¸¤ä¸ª MAC åœ°å€ã€‚</p><h2 id="å±€åŸŸç½‘"><a href="#å±€åŸŸç½‘" class="headerlink" title="å±€åŸŸç½‘"></a>å±€åŸŸç½‘</h2><p>å±€åŸŸç½‘æ˜¯å…¸å‹çš„ä¸€ç§å¹¿æ’­ä¿¡é“ï¼Œä¸»è¦ç‰¹ç‚¹æ˜¯ç½‘ç»œä¸ºä¸€ä¸ªå•ä½æ‰€æ‹¥æœ‰ï¼Œä¸”åœ°ç†èŒƒå›´å’Œç«™ç‚¹æ•°ç›®å‡æœ‰é™ã€‚</p><p>ä¸»è¦æœ‰ä»¥å¤ªç½‘ã€ä»¤ç‰Œç¯ç½‘ã€FDDI å’Œ ATM ç­‰å±€åŸŸç½‘æŠ€æœ¯ï¼Œç›®å‰ä»¥å¤ªç½‘å é¢†ç€ç°æœ‰çš„æœ‰çº¿å±€åŸŸç½‘å¸‚åœºã€‚</p><p>å¯ä»¥æŒ‰ç…§ç½‘ç»œæ‹“æ‰‘å¯¹å±€åŸŸç½‘è¿›è¡Œåˆ†ç±»ï¼š</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045204.jpg" width="600"> </div><br></p><h2 id="ä»¥å¤ªç½‘"><a href="#ä»¥å¤ªç½‘" class="headerlink" title="ä»¥å¤ªç½‘*"></a>ä»¥å¤ªç½‘*</h2><p>ä»¥å¤ªç½‘æ˜¯ä¸€ç§æ˜Ÿå‹æ‹“æ‰‘ç»“æ„å±€åŸŸç½‘ã€‚</p><p>æ—©æœŸä½¿ç”¨é›†çº¿å™¨è¿›è¡Œè¿æ¥ï¼Œå®ƒæ˜¯ä¸€ç§ç‰©ç†å±‚è®¾å¤‡ï¼Œä½œç”¨äºæ¯”ç‰¹è€Œä¸æ˜¯å¸§ï¼Œå½“ä¸€ä¸ªæ¯”ç‰¹åˆ°è¾¾æ¥å£æ—¶ï¼Œé›†çº¿å™¨é‡æ–°ç”Ÿæˆè¿™ä¸ªæ¯”ç‰¹ï¼Œå¹¶å°†å…¶èƒ½é‡å¼ºåº¦æ”¾å¤§ï¼Œä»è€Œæ‰©å¤§ç½‘ç»œçš„ä¼ è¾“è·ç¦»ã€‚ä¹‹åå†å°†è¿™ä¸ªæ¯”ç‰¹å‘å…¶å®ƒæ‰€æœ‰æ¥å£ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœé›†çº¿å™¨åŒæ—¶æ”¶åˆ°åŒæ—¶ä»ä¸¤ä¸ªä¸åŒæ¥å£çš„å¸§ï¼Œé‚£ä¹ˆå°±å‘ç”Ÿäº†ç¢°æ’ã€‚</p><p>ç›®å‰ä»¥å¤ªç½‘ä½¿ç”¨äº¤æ¢æœºæ›¿ä»£äº†é›†çº¿å™¨ï¼Œå®ƒä¸ä¼šå‘ç”Ÿç¢°æ’ï¼Œèƒ½æ ¹æ® MAC åœ°å€è¿›è¡Œå­˜å‚¨è½¬å‘ã€‚</p><p>ä»¥å¤ªç½‘å¸§ï¼š</p><ul><li><strong>ç±»å‹</strong> ï¼šæ ‡è®°ä¸Šå±‚ä½¿ç”¨çš„åè®®ï¼›</li><li><strong>æ•°æ®</strong> ï¼šé•¿åº¦åœ¨ 46-1500 ä¹‹é—´ï¼Œå¦‚æœå¤ªå°åˆ™éœ€è¦å¡«å……ï¼›</li><li><strong>FCS</strong> ï¼šå¸§æ£€éªŒåºåˆ—ï¼Œä½¿ç”¨çš„æ˜¯ CRC æ£€éªŒæ–¹æ³•ï¼›</li><li><strong>å‰åŒæ­¥ç </strong> ï¼šåªæ˜¯ä¸ºäº†è®¡ç®— FCS ä¸´æ—¶åŠ å…¥çš„ï¼Œè®¡ç®—ç»“æŸä¹‹åä¼šä¸¢å¼ƒã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045210.jpg" width="600"> </div><br></p><h2 id="äº¤æ¢æœº"><a href="#äº¤æ¢æœº" class="headerlink" title="äº¤æ¢æœº*"></a>äº¤æ¢æœº*</h2><p>äº¤æ¢æœºå…·æœ‰è‡ªå­¦ä¹ èƒ½åŠ›ï¼Œå­¦ä¹ çš„æ˜¯äº¤æ¢è¡¨çš„å†…å®¹ã€‚äº¤æ¢è¡¨ä¸­å­˜å‚¨ç€ MAC åœ°å€åˆ°æ¥å£çš„æ˜ å°„ã€‚ä¸‹å›¾ä¸­ï¼Œäº¤æ¢æœºæœ‰ 4 ä¸ªæ¥å£ï¼Œä¸»æœº A å‘ä¸»æœº B å‘é€æ•°æ®å¸§æ—¶ï¼Œäº¤æ¢æœºæŠŠä¸»æœº A åˆ°æ¥å£ 1 çš„æ˜ å°„å†™å…¥äº¤æ¢è¡¨ä¸­ã€‚ä¸ºäº†å‘é€æ•°æ®å¸§åˆ° Bï¼Œå…ˆæŸ¥äº¤æ¢è¡¨ï¼Œæ­¤æ—¶æ²¡æœ‰ä¸»æœº B çš„è¡¨é¡¹ï¼Œé‚£ä¹ˆä¸»æœº A å°±å‘é€å¹¿æ’­å¸§ï¼Œä¸»æœº C å’Œä¸»æœº D ä¼šä¸¢å¼ƒè¯¥å¸§ã€‚ä¸»æœº B æ”¶ä¸‹ä¹‹åï¼ŒæŸ¥æ‰¾äº¤æ¢è¡¨å¾—åˆ°ä¸»æœº A æ˜ å°„çš„æ¥å£ä¸º 1ï¼Œå°±å‘é€æ•°æ®å¸§åˆ°æ¥å£ 1ï¼ŒåŒæ—¶äº¤æ¢æœºæ·»åŠ ä¸»æœº B åˆ°æ¥å£ 3 çš„æ˜ å°„ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045213.jpg" width="800"> </div><br></p><p>å®ƒæ˜¯ä¸€ç§å³æ’å³ç”¨æ€¥ç”¨çš„è®¾å¤‡ï¼Œä¸éœ€è¦ç½‘ç»œç®¡ç†å‘˜å¹²é¢„ã€‚</p><h2 id="è™šæ‹Ÿå±€åŸŸç½‘"><a href="#è™šæ‹Ÿå±€åŸŸç½‘" class="headerlink" title="è™šæ‹Ÿå±€åŸŸç½‘"></a>è™šæ‹Ÿå±€åŸŸç½‘</h2><p>è™šæ‹Ÿå±€åŸŸç½‘å¯ä»¥å»ºç«‹ä¸ç‰©ç†ä½ç½®æ— å…³çš„é€»è¾‘ç»„ï¼Œåªæœ‰åœ¨åŒä¸€ä¸ªè™šæ‹Ÿå±€åŸŸç½‘ä¸­çš„æˆå‘˜æ‰ä¼šæ”¶åˆ°é“¾è·¯å±‚å¹¿æ’­ä¿¡æ¯ï¼Œä¾‹å¦‚ä¸‹å›¾ä¸­ (A1, A2, A3, A4) å±äºä¸€ä¸ªè™šæ‹Ÿå±€åŸŸç½‘ï¼ŒA1 å‘é€çš„å¹¿æ’­ä¼šè¢« A2ã€A3ã€A4 æ”¶åˆ°ï¼Œè€Œå…¶å®ƒç«™ç‚¹æ”¶ä¸åˆ°ã€‚</p><p>ä½¿ç”¨ VLAN å¹²çº¿è¿æ¥æ¥å»ºç«‹è™šæ‹Ÿå±€åŸŸç½‘ï¼Œæ¯å°äº¤æ¢æœºä¸Šçš„ä¸€ä¸ªç‰¹æ®Šç«¯å£è¢«è®¾ç½®ä¸ºå¹²çº¿ç«¯å£ï¼Œä»¥äº’è¿ VLAN äº¤æ¢æœºã€‚IEEE å®šä¹‰äº†ä¸€ç§æ‰©å±•çš„ä»¥å¤ªç½‘å¸§æ ¼å¼â€”â€”802.1Qï¼Œç”¨äºè·¨ VLAN å¹²çº¿çš„å¸§ï¼Œå®ƒåœ¨æ ‡å‡†ä»¥å¤ªç½‘å¸§ä¸ŠåŠ è¿›äº† 4 å­—èŠ‚é¦–éƒ¨ VLAN æ ‡ç­¾ï¼Œç”¨äºè¡¨ç¤ºè¯¥å¸§å±äºå“ªä¸€ä¸ªè™šæ‹Ÿå±€åŸŸç½‘ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045215.png" width="500"> </div><br></p><h1 id="å››ã€ç½‘ç»œå±‚"><a href="#å››ã€ç½‘ç»œå±‚" class="headerlink" title="å››ã€ç½‘ç»œå±‚*"></a>å››ã€ç½‘ç»œå±‚*</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å› ä¸ºç½‘ç»œå±‚æ˜¯æ•´ä¸ªäº’è”ç½‘çš„æ ¸å¿ƒï¼Œå› æ­¤åº”å½“è®©ç½‘ç»œå±‚å°½å¯èƒ½ç®€å•ã€‚ç½‘ç»œå±‚å‘ä¸Šåªæä¾›ç®€å•çµæ´»çš„ã€æ— è¿æ¥çš„ã€å°½æœ€å¤§åŠªåŠ›äº¤äº’çš„æ•°æ®æŠ¥æœåŠ¡ã€‚</p><p>ä½¿ç”¨ IP åè®®ï¼Œå¯ä»¥æŠŠå¼‚æ„çš„ç‰©ç†ç½‘ç»œè¿æ¥èµ·æ¥ï¼Œä½¿å¾—åœ¨ç½‘ç»œå±‚çœ‹èµ·æ¥å¥½åƒæ˜¯ä¸€ä¸ªç»Ÿä¸€çš„ç½‘ç»œã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045221.jpg" width="500"> </div><br></p><p>ä¸ IP åè®®é…å¥—ä½¿ç”¨çš„è¿˜æœ‰ä¸‰ä¸ªåè®®ï¼š</p><ul><li>åœ°å€è§£æåè®® ARPï¼ˆAddress Resolution Protocolï¼‰</li><li>ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®® ICMPï¼ˆInternet Control Message Protocolï¼‰</li><li>ç½‘é™…ç»„ç®¡ç†åè®® IGMPï¼ˆInternet Group Management Protocolï¼‰</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045225.png" width="350"> </div><br></p><h2 id="IP-æ•°æ®æŠ¥æ ¼å¼"><a href="#IP-æ•°æ®æŠ¥æ ¼å¼" class="headerlink" title="IP æ•°æ®æŠ¥æ ¼å¼"></a>IP æ•°æ®æŠ¥æ ¼å¼</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045229.jpg" width="700"> </div><br></p><ul><li><p><strong>ç‰ˆæœ¬</strong>  : æœ‰ 4ï¼ˆIPv4ï¼‰å’Œ 6ï¼ˆIPv6ï¼‰ä¸¤ä¸ªå€¼ï¼›</p></li><li><p><strong>é¦–éƒ¨é•¿åº¦</strong>  : å  4 ä½ï¼Œå› æ­¤æœ€å¤§å€¼ä¸º 15ã€‚å€¼ä¸º 1 è¡¨ç¤ºçš„æ˜¯ 1 ä¸ª 32 ä½å­—çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯ 4 å­—èŠ‚ã€‚å› ä¸ºé¦–éƒ¨å›ºå®šé•¿åº¦ä¸º 20 å­—èŠ‚ï¼Œå› æ­¤è¯¥å€¼æœ€å°ä¸º 5ã€‚å¦‚æœå¯é€‰å­—æ®µçš„é•¿åº¦ä¸æ˜¯ 4 å­—èŠ‚çš„æ•´æ•°å€ï¼Œå°±ç”¨å°¾éƒ¨çš„å¡«å……éƒ¨åˆ†æ¥å¡«å……ã€‚</p></li><li><p><strong>åŒºåˆ†æœåŠ¡</strong>  : ç”¨æ¥è·å¾—æ›´å¥½çš„æœåŠ¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸ä½¿ç”¨ã€‚</p></li><li><p><strong>æ€»é•¿åº¦</strong>  : åŒ…æ‹¬é¦–éƒ¨é•¿åº¦å’Œæ•°æ®éƒ¨åˆ†é•¿åº¦ã€‚</p></li><li><p><strong>ç”Ÿå­˜æ—¶é—´</strong>  ï¼šTTLï¼Œå®ƒçš„å­˜åœ¨æ˜¯ä¸ºäº†é˜²æ­¢æ— æ³•äº¤ä»˜çš„æ•°æ®æŠ¥åœ¨äº’è”ç½‘ä¸­ä¸æ–­å…œåœˆå­ã€‚ä»¥è·¯ç”±å™¨è·³æ•°ä¸ºå•ä½ï¼Œå½“ TTL ä¸º 0 æ—¶å°±ä¸¢å¼ƒæ•°æ®æŠ¥ã€‚</p></li><li><p><strong>åè®®</strong> ï¼šæŒ‡å‡ºæºå¸¦çš„æ•°æ®åº”è¯¥ä¸Šäº¤ç»™å“ªä¸ªåè®®è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚ ICMPã€TCPã€UDP ç­‰ã€‚</p></li><li><p><strong>é¦–éƒ¨æ£€éªŒå’Œ</strong> ï¼šå› ä¸ºæ•°æ®æŠ¥æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨ï¼Œéƒ½è¦é‡æ–°è®¡ç®—æ£€éªŒå’Œï¼Œå› æ­¤æ£€éªŒå’Œä¸åŒ…å«æ•°æ®éƒ¨åˆ†å¯ä»¥å‡å°‘è®¡ç®—çš„å·¥ä½œé‡ã€‚</p></li><li><p><strong>æ ‡è¯†</strong>  : åœ¨æ•°æ®æŠ¥é•¿åº¦è¿‡é•¿ä»è€Œå‘ç”Ÿåˆ†ç‰‡çš„æƒ…å†µä¸‹ï¼Œç›¸åŒæ•°æ®æŠ¥çš„ä¸åŒåˆ†ç‰‡å…·æœ‰ç›¸åŒçš„æ ‡è¯†ç¬¦ã€‚</p></li><li><p><strong>ç‰‡åç§»</strong>  : å’Œæ ‡è¯†ç¬¦ä¸€èµ·ï¼Œç”¨äºå‘ç”Ÿåˆ†ç‰‡çš„æƒ…å†µã€‚ç‰‡åç§»çš„å•ä½ä¸º 8 å­—èŠ‚ã€‚</p></li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045234.png" width="700"> </div><br></p><h2 id="IP-åœ°å€ç¼–å€æ–¹å¼"><a href="#IP-åœ°å€ç¼–å€æ–¹å¼" class="headerlink" title="IP åœ°å€ç¼–å€æ–¹å¼"></a>IP åœ°å€ç¼–å€æ–¹å¼</h2><p>IP åœ°å€çš„ç¼–å€æ–¹å¼ç»å†äº†ä¸‰ä¸ªå†å²é˜¶æ®µï¼š</p><ul><li>åˆ†ç±»</li><li>å­ç½‘åˆ’åˆ†</li><li>æ— åˆ†ç±»</li></ul><h3 id="1-åˆ†ç±»"><a href="#1-åˆ†ç±»" class="headerlink" title="1. åˆ†ç±»"></a>1. åˆ†ç±»</h3><p>ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç½‘ç»œå·å’Œä¸»æœºå·ï¼Œå…¶ä¸­ä¸åŒåˆ†ç±»å…·æœ‰ä¸åŒçš„ç½‘ç»œå·é•¿åº¦ï¼Œå¹¶ä¸”æ˜¯å›ºå®šçš„ã€‚</p><p>IP åœ°å€ ::= {&lt; ç½‘ç»œå· &gt;, &lt; ä¸»æœºå· &gt;}</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045239.png" width="500"> </div><br></p><h3 id="2-å­ç½‘åˆ’åˆ†"><a href="#2-å­ç½‘åˆ’åˆ†" class="headerlink" title="2. å­ç½‘åˆ’åˆ†"></a>2. å­ç½‘åˆ’åˆ†</h3><p>é€šè¿‡åœ¨ä¸»æœºå·å­—æ®µä¸­æ‹¿ä¸€éƒ¨åˆ†ä½œä¸ºå­ç½‘å·ï¼ŒæŠŠä¸¤çº§ IP åœ°å€åˆ’åˆ†ä¸ºä¸‰çº§ IP åœ°å€ã€‚æ³¨æ„ï¼Œå¤–éƒ¨ç½‘ç»œçœ‹ä¸åˆ°å­ç½‘çš„å­˜åœ¨ã€‚</p><p>IP åœ°å€ ::= {&lt; ç½‘ç»œå· &gt;, &lt; å­ç½‘å· &gt;, &lt; ä¸»æœºå· &gt;}</p><p>è¦ä½¿ç”¨å­ç½‘ï¼Œå¿…é¡»é…ç½®å­ç½‘æ©ç ã€‚ä¸€ä¸ª B ç±»åœ°å€çš„é»˜è®¤å­ç½‘æ©ç ä¸º 255.255.0.0ï¼Œå¦‚æœ B ç±»åœ°å€çš„å­ç½‘å ä¸¤ä¸ªæ¯”ç‰¹ï¼Œé‚£ä¹ˆå­ç½‘æ©ç ä¸º 11111111 11111111 11000000 00000000ï¼Œä¹Ÿå°±æ˜¯ 255.255.192.0ã€‚</p><h3 id="3-æ— åˆ†ç±»"><a href="#3-æ— åˆ†ç±»" class="headerlink" title="3. æ— åˆ†ç±»"></a>3. æ— åˆ†ç±»</h3><p>æ— åˆ†ç±»ç¼–å€ CIDR æ¶ˆé™¤äº†ä¼ ç»Ÿ A ç±»ã€B ç±»å’Œ C ç±»åœ°å€ä»¥åŠåˆ’åˆ†å­ç½‘çš„æ¦‚å¿µï¼Œä½¿ç”¨ç½‘ç»œå‰ç¼€å’Œä¸»æœºå·æ¥å¯¹ IP åœ°å€è¿›è¡Œç¼–ç ï¼Œç½‘ç»œå‰ç¼€çš„é•¿åº¦å¯ä»¥æ ¹æ®éœ€è¦å˜åŒ–ã€‚</p><p>IP åœ°å€ ::= {&lt; ç½‘ç»œå‰ç¼€å· &gt;, &lt; ä¸»æœºå· &gt;}</p><p>CIDR çš„è®°æ³•ä¸Šé‡‡ç”¨åœ¨ IP åœ°å€åé¢åŠ ä¸Šç½‘ç»œå‰ç¼€é•¿åº¦çš„æ–¹æ³•ï¼Œä¾‹å¦‚ 128.14.35.7/20 è¡¨ç¤ºå‰ 20 ä½ä¸ºç½‘ç»œå‰ç¼€ã€‚</p><p>CIDR çš„åœ°å€æ©ç å¯ä»¥ç»§ç»­ç§°ä¸ºå­ç½‘æ©ç ï¼Œå­ç½‘æ©ç é¦– 1 é•¿åº¦ä¸ºç½‘ç»œå‰ç¼€çš„é•¿åº¦ã€‚</p><p>ä¸€ä¸ª CIDR åœ°å€å—ä¸­æœ‰å¾ˆå¤šåœ°å€ï¼Œä¸€ä¸ª CIDR è¡¨ç¤ºçš„ç½‘ç»œå°±å¯ä»¥è¡¨ç¤ºåŸæ¥çš„å¾ˆå¤šä¸ªç½‘ç»œï¼Œå¹¶ä¸”åœ¨è·¯ç”±è¡¨ä¸­åªéœ€è¦ä¸€ä¸ªè·¯ç”±å°±å¯ä»¥ä»£æ›¿åŸæ¥çš„å¤šä¸ªè·¯ç”±ï¼Œå‡å°‘äº†è·¯ç”±è¡¨é¡¹çš„æ•°é‡ã€‚æŠŠè¿™ç§é€šè¿‡ä½¿ç”¨ç½‘ç»œå‰ç¼€æ¥å‡å°‘è·¯ç”±è¡¨é¡¹çš„æ–¹å¼ç§°ä¸ºè·¯ç”±èšåˆï¼Œä¹Ÿç§°ä¸º  <strong>æ„æˆè¶…ç½‘</strong> ã€‚</p><p>åœ¨è·¯ç”±è¡¨ä¸­çš„é¡¹ç›®ç”±â€œç½‘ç»œå‰ç¼€â€å’Œâ€œä¸‹ä¸€è·³åœ°å€â€ç»„æˆï¼Œåœ¨æŸ¥æ‰¾æ—¶å¯èƒ½ä¼šå¾—åˆ°ä¸æ­¢ä¸€ä¸ªåŒ¹é…ç»“æœï¼Œåº”å½“é‡‡ç”¨æœ€é•¿å‰ç¼€åŒ¹é…æ¥ç¡®å®šåº”è¯¥åŒ¹é…å“ªä¸€ä¸ªã€‚</p><h2 id="åœ°å€è§£æåè®®-ARP"><a href="#åœ°å€è§£æåè®®-ARP" class="headerlink" title="åœ°å€è§£æåè®® ARP"></a>åœ°å€è§£æåè®® ARP</h2><p>ç½‘ç»œå±‚å®ç°ä¸»æœºä¹‹é—´çš„é€šä¿¡ï¼Œè€Œé“¾è·¯å±‚å®ç°å…·ä½“æ¯æ®µé“¾è·¯ä¹‹é—´çš„é€šä¿¡ã€‚å› æ­¤åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼ŒIP æ•°æ®æŠ¥çš„æºåœ°å€å’Œç›®çš„åœ°å€å§‹ç»ˆä¸å˜ï¼Œè€Œ MAC åœ°å€éšç€é“¾è·¯çš„æ”¹å˜è€Œæ”¹å˜ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045244.jpg" width="700"> </div><br></p><p>ARP å®ç°ç”± IP åœ°å€å¾—åˆ° MAC åœ°å€ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045248.jpg" width="500"> </div><br></p><p>æ¯ä¸ªä¸»æœºéƒ½æœ‰ä¸€ä¸ª ARP é«˜é€Ÿç¼“å­˜ï¼Œé‡Œé¢æœ‰æœ¬å±€åŸŸç½‘ä¸Šçš„å„ä¸»æœºå’Œè·¯ç”±å™¨çš„ IP åœ°å€åˆ°ç¡¬ä»¶åœ°å€çš„æ˜ å°„è¡¨ã€‚</p><p>å¦‚æœä¸»æœº A çŸ¥é“ä¸»æœº B çš„ IP åœ°å€ï¼Œä½†æ˜¯ ARP é«˜é€Ÿç¼“å­˜ä¸­æ²¡æœ‰è¯¥ IP åœ°å€åˆ° MAC åœ°å€çš„æ˜ å°„ï¼Œæ­¤æ—¶ä¸»æœº A é€šè¿‡å¹¿æ’­çš„æ–¹å¼å‘é€ ARP è¯·æ±‚åˆ†ç»„ï¼Œä¸»æœº B æ”¶åˆ°è¯¥è¯·æ±‚åä¼šå‘é€ ARP å“åº”åˆ†ç»„ç»™ä¸»æœº A å‘ŠçŸ¥å…¶ MAC åœ°å€ï¼Œéšåä¸»æœº A å‘å…¶é«˜é€Ÿç¼“å­˜ä¸­å†™å…¥ä¸»æœº B çš„ IP åœ°å€åˆ° MAC åœ°å€çš„æ˜ å°„ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045251.png" width="700"> </div><br></p><h2 id="ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®-ICMP"><a href="#ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®-ICMP" class="headerlink" title="ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®® ICMP"></a>ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®® ICMP</h2><p>ICMP æ˜¯ä¸ºäº†æ›´æœ‰æ•ˆåœ°è½¬å‘ IP æ•°æ®æŠ¥å’Œæé«˜äº¤ä»˜æˆåŠŸçš„æœºä¼šã€‚å®ƒå°è£…åœ¨ IP æ•°æ®æŠ¥ä¸­ï¼Œä½†æ˜¯ä¸å±äºé«˜å±‚åè®®ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045255.jpg" width="500"> </div><br></p><p>ICMP æŠ¥æ–‡åˆ†ä¸ºå·®é”™æŠ¥å‘ŠæŠ¥æ–‡å’Œè¯¢é—®æŠ¥æ–‡ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045258.png" width="600"> </div><br></p><h3 id="1-Ping"><a href="#1-Ping" class="headerlink" title="1. Ping"></a>1. Ping</h3><p>Ping æ˜¯ ICMP çš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œä¸»è¦ç”¨æ¥æµ‹è¯•ä¸¤å°ä¸»æœºä¹‹é—´çš„è¿é€šæ€§ã€‚</p><p>Ping å‘é€çš„ IP æ•°æ®æŠ¥å°è£…çš„æ˜¯æ— æ³•äº¤ä»˜çš„ UDP ç”¨æˆ·æ•°æ®æŠ¥ã€‚</p><h3 id="2-Traceroute"><a href="#2-Traceroute" class="headerlink" title="2. Traceroute"></a>2. Traceroute</h3><p>Traceroute æ˜¯ ICMP çš„å¦ä¸€ä¸ªåº”ç”¨ï¼Œç”¨æ¥è·Ÿè¸ªä¸€ä¸ªåˆ†ç»„ä»æºç‚¹åˆ°ç»ˆç‚¹çš„è·¯å¾„ã€‚</p><ul><li>æºä¸»æœºå‘ç›®çš„ä¸»æœºå‘é€ä¸€è¿ä¸²çš„ IP æ•°æ®æŠ¥ã€‚ç¬¬ä¸€ä¸ªæ•°æ®æŠ¥ P1 çš„ç”Ÿå­˜æ—¶é—´ TTL è®¾ç½®ä¸º 1ï¼Œå½“ P1 åˆ°è¾¾è·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªè·¯ç”±å™¨ R1 æ—¶ï¼ŒR1 æ”¶ä¸‹å®ƒå¹¶æŠŠ TTL å‡ 1ï¼Œæ­¤æ—¶ TTL ç­‰äº 0ï¼ŒR1 å°±æŠŠ P1 ä¸¢å¼ƒï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ª ICMP æ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ï¼›</li><li>æºä¸»æœºæ¥ç€å‘é€ç¬¬äºŒä¸ªæ•°æ®æŠ¥ P2ï¼Œå¹¶æŠŠ TTL è®¾ç½®ä¸º 2ã€‚P2 å…ˆåˆ°è¾¾ R1ï¼ŒR1 æ”¶ä¸‹åæŠŠ TTL å‡ 1 å†è½¬å‘ç»™ R2ï¼ŒR2 æ”¶ä¸‹åä¹ŸæŠŠ TTL å‡ 1ï¼Œç”±äºæ­¤æ—¶ TTL ç­‰äº 0ï¼ŒR2 å°±ä¸¢å¼ƒ P2ï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ª ICMP æ—¶é—´è¶…è¿‡å·®é”™æŠ¥æ–‡ã€‚</li><li>ä¸æ–­æ‰§è¡Œè¿™æ ·çš„æ­¥éª¤ï¼Œç›´åˆ°æœ€åä¸€ä¸ªæ•°æ®æŠ¥åˆšåˆšåˆ°è¾¾ç›®çš„ä¸»æœºï¼Œä¸»æœºä¸è½¬å‘æ•°æ®æŠ¥ï¼Œä¹Ÿä¸æŠŠ TTL å€¼å‡ 1ã€‚ä½†æ˜¯å› ä¸ºæ•°æ®æŠ¥å°è£…çš„æ˜¯æ— æ³•äº¤ä»˜çš„ UDPï¼Œå› æ­¤ç›®çš„ä¸»æœºè¦å‘æºä¸»æœºå‘é€ ICMP ç»ˆç‚¹ä¸å¯è¾¾å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚</li><li>ä¹‹åæºä¸»æœºçŸ¥é“äº†åˆ°è¾¾ç›®çš„ä¸»æœºæ‰€ç»è¿‡çš„è·¯ç”±å™¨ IP åœ°å€ä»¥åŠåˆ°è¾¾æ¯ä¸ªè·¯ç”±å™¨çš„å¾€è¿”æ—¶é—´ã€‚</li></ul><h2 id="è™šæ‹Ÿä¸“ç”¨ç½‘-VPN"><a href="#è™šæ‹Ÿä¸“ç”¨ç½‘-VPN" class="headerlink" title="è™šæ‹Ÿä¸“ç”¨ç½‘ VPN"></a>è™šæ‹Ÿä¸“ç”¨ç½‘ VPN</h2><p>ç”±äº IP åœ°å€çš„ç´§ç¼ºï¼Œä¸€ä¸ªæœºæ„èƒ½ç”³è¯·åˆ°çš„ IP åœ°å€æ•°å¾€å¾€è¿œå°äºæœ¬æœºæ„æ‰€æ‹¥æœ‰çš„ä¸»æœºæ•°ã€‚å¹¶ä¸”ä¸€ä¸ªæœºæ„å¹¶ä¸éœ€è¦æŠŠæ‰€æœ‰çš„ä¸»æœºæ¥å…¥åˆ°å¤–éƒ¨çš„äº’è”ç½‘ä¸­ï¼Œæœºæ„å†…çš„è®¡ç®—æœºå¯ä»¥ä½¿ç”¨ä»…åœ¨æœ¬æœºæ„æœ‰æ•ˆçš„ IP åœ°å€ï¼ˆä¸“ç”¨åœ°å€ï¼‰ã€‚</p><p>æœ‰ä¸‰ä¸ªä¸“ç”¨åœ°å€å—ï¼š</p><ul><li>10.0.0.0 ~ 10.255.255.255</li><li>172.16.0.0 ~ 172.31.255.255</li><li>192.168.0.0 ~ 192.168.255.255</li></ul><p>VPN ä½¿ç”¨å…¬ç”¨çš„äº’è”ç½‘ä½œä¸ºæœ¬æœºæ„å„ä¸“ç”¨ç½‘ä¹‹é—´çš„é€šä¿¡è½½ä½“ã€‚ä¸“ç”¨æŒ‡æœºæ„å†…çš„ä¸»æœºåªä¸æœ¬æœºæ„å†…çš„å…¶å®ƒä¸»æœºé€šä¿¡ï¼›è™šæ‹ŸæŒ‡â€œå¥½åƒæ˜¯â€ï¼Œè€Œå®é™…ä¸Šå¹¶ä¸æ˜¯ï¼Œå®ƒæœ‰ç»è¿‡å…¬ç”¨çš„äº’è”ç½‘ã€‚</p><p>ä¸‹å›¾ä¸­ï¼Œåœºæ‰€ A å’Œ B çš„é€šä¿¡ç»è¿‡äº’è”ç½‘ï¼Œå¦‚æœåœºæ‰€ A çš„ä¸»æœº X è¦å’Œå¦ä¸€ä¸ªåœºæ‰€ B çš„ä¸»æœº Y é€šä¿¡ï¼ŒIP æ•°æ®æŠ¥çš„æºåœ°å€æ˜¯ 10.1.0.1ï¼Œç›®çš„åœ°å€æ˜¯ 10.2.0.3ã€‚æ•°æ®æŠ¥å…ˆå‘é€åˆ°ä¸äº’è”ç½‘ç›¸è¿çš„è·¯ç”±å™¨ R1ï¼ŒR1 å¯¹å†…éƒ¨æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œç„¶åé‡æ–°åŠ ä¸Šæ•°æ®æŠ¥çš„é¦–éƒ¨ï¼Œæºåœ°å€æ˜¯è·¯ç”±å™¨ R1 çš„å…¨çƒåœ°å€ 125.1.2.3ï¼Œç›®çš„åœ°å€æ˜¯è·¯ç”±å™¨ R2 çš„å…¨çƒåœ°å€ 194.4.5.6ã€‚è·¯ç”±å™¨ R2 æ”¶åˆ°æ•°æ®æŠ¥åå°†æ•°æ®éƒ¨åˆ†è¿›è¡Œè§£å¯†ï¼Œæ¢å¤åŸæ¥çš„æ•°æ®æŠ¥ï¼Œæ­¤æ—¶ç›®çš„åœ°å€ä¸º 10.2.0.3ï¼Œå°±äº¤ä»˜ç»™ Yã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045303.jpg" width="800"> </div><br></p><h2 id="ç½‘ç»œåœ°å€è½¬æ¢-NAT"><a href="#ç½‘ç»œåœ°å€è½¬æ¢-NAT" class="headerlink" title="ç½‘ç»œåœ°å€è½¬æ¢ NAT"></a>ç½‘ç»œåœ°å€è½¬æ¢ NAT</h2><p>ä¸“ç”¨ç½‘å†…éƒ¨çš„ä¸»æœºä½¿ç”¨æœ¬åœ° IP åœ°å€åˆæƒ³å’Œäº’è”ç½‘ä¸Šçš„ä¸»æœºé€šä¿¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ NAT æ¥å°†æœ¬åœ° IP è½¬æ¢ä¸ºå…¨çƒ IPã€‚</p><p>åœ¨ä»¥å‰ï¼ŒNAT å°†æœ¬åœ° IP å’Œå…¨çƒ IP ä¸€ä¸€å¯¹åº”ï¼Œè¿™ç§æ–¹å¼ä¸‹æ‹¥æœ‰ n ä¸ªå…¨çƒ IP åœ°å€çš„ä¸“ç”¨ç½‘å†…æœ€å¤šåªå¯ä»¥åŒæ—¶æœ‰ n å°ä¸»æœºæ¥å…¥äº’è”ç½‘ã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°åˆ©ç”¨å…¨çƒ IP åœ°å€ï¼Œç°åœ¨å¸¸ç”¨çš„ NAT è½¬æ¢è¡¨æŠŠè¿è¾“å±‚çš„ç«¯å£å·ä¹Ÿç”¨ä¸Šäº†ï¼Œä½¿å¾—å¤šä¸ªä¸“ç”¨ç½‘å†…éƒ¨çš„ä¸»æœºå…±ç”¨ä¸€ä¸ªå…¨çƒ IP åœ°å€ã€‚ä½¿ç”¨ç«¯å£å·çš„ NAT ä¹Ÿå«åšç½‘ç»œåœ°å€ä¸ç«¯å£è½¬æ¢ NAPTã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045313.png" width=""> </div><br></p><h2 id="è·¯ç”±å™¨çš„ç»“æ„"><a href="#è·¯ç”±å™¨çš„ç»“æ„" class="headerlink" title="è·¯ç”±å™¨çš„ç»“æ„"></a>è·¯ç”±å™¨çš„ç»“æ„</h2><p>è·¯ç”±å™¨ä»åŠŸèƒ½ä¸Šå¯ä»¥åˆ’åˆ†ä¸ºï¼šè·¯ç”±é€‰æ‹©å’Œåˆ†ç»„è½¬å‘ã€‚</p><p>åˆ†ç»„è½¬å‘ç»“æ„ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šäº¤æ¢ç»“æ„ã€ä¸€ç»„è¾“å…¥ç«¯å£å’Œä¸€ç»„è¾“å‡ºç«¯å£ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045309.jpg" width="600"> </div><br></p><h2 id="è·¯ç”±å™¨åˆ†ç»„è½¬å‘æµç¨‹"><a href="#è·¯ç”±å™¨åˆ†ç»„è½¬å‘æµç¨‹" class="headerlink" title="è·¯ç”±å™¨åˆ†ç»„è½¬å‘æµç¨‹"></a>è·¯ç”±å™¨åˆ†ç»„è½¬å‘æµç¨‹</h2><ul><li>ä»æ•°æ®æŠ¥çš„é¦–éƒ¨æå–ç›®çš„ä¸»æœºçš„ IP åœ°å€ Dï¼Œå¾—åˆ°ç›®çš„ç½‘ç»œåœ°å€ Nã€‚</li><li>è‹¥ N å°±æ˜¯ä¸æ­¤è·¯ç”±å™¨ç›´æ¥ç›¸è¿çš„æŸä¸ªç½‘ç»œåœ°å€ï¼Œåˆ™è¿›è¡Œç›´æ¥äº¤ä»˜ï¼›</li><li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ç›®çš„åœ°å€ä¸º D çš„ç‰¹å®šä¸»æœºè·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è¡¨ä¸­æ‰€æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›</li><li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰åˆ°è¾¾ç½‘ç»œ N çš„è·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›</li><li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„é»˜è®¤è·¯ç”±å™¨ï¼›</li><li>æŠ¥å‘Šè½¬å‘åˆ†ç»„å‡ºé”™ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045524.jpg" width="800"> </div><br></p><h2 id="è·¯ç”±é€‰æ‹©åè®®"><a href="#è·¯ç”±é€‰æ‹©åè®®" class="headerlink" title="è·¯ç”±é€‰æ‹©åè®®"></a>è·¯ç”±é€‰æ‹©åè®®</h2><p>è·¯ç”±é€‰æ‹©åè®®éƒ½æ˜¯è‡ªé€‚åº”çš„ï¼Œèƒ½éšç€ç½‘ç»œé€šä¿¡é‡å’Œæ‹“æ‰‘ç»“æ„çš„å˜åŒ–è€Œè‡ªé€‚åº”åœ°è¿›è¡Œè°ƒæ•´ã€‚</p><p>äº’è”ç½‘å¯ä»¥åˆ’åˆ†ä¸ºè®¸å¤šè¾ƒå°çš„è‡ªæ²»ç³»ç»Ÿ ASï¼Œä¸€ä¸ª AS å¯ä»¥ä½¿ç”¨ä¸€ç§å’Œåˆ«çš„ AS ä¸åŒçš„è·¯ç”±é€‰æ‹©åè®®ã€‚</p><p>å¯ä»¥æŠŠè·¯ç”±é€‰æ‹©åè®®åˆ’åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p><ul><li>è‡ªæ²»ç³»ç»Ÿå†…éƒ¨çš„è·¯ç”±é€‰æ‹©ï¼šRIP å’Œ OSPF</li><li>è‡ªæ²»ç³»ç»Ÿé—´çš„è·¯ç”±é€‰æ‹©ï¼šBGP</li></ul><h3 id="1-å†…éƒ¨ç½‘å…³åè®®-RIP"><a href="#1-å†…éƒ¨ç½‘å…³åè®®-RIP" class="headerlink" title="1. å†…éƒ¨ç½‘å…³åè®® RIP"></a>1. å†…éƒ¨ç½‘å…³åè®® RIP</h3><p>RIP æ˜¯ä¸€ç§åŸºäºè·ç¦»å‘é‡çš„è·¯ç”±é€‰æ‹©åè®®ã€‚è·ç¦»æ˜¯æŒ‡è·³æ•°ï¼Œç›´æ¥ç›¸è¿çš„è·¯ç”±å™¨è·³æ•°ä¸º 1ï¼Œè·³æ•°æœ€å¤šä¸º 15ï¼Œè¶…è¿‡ 15 è¡¨ç¤ºä¸å¯è¾¾ã€‚</p><p>RIP æŒ‰å›ºå®šçš„æ—¶é—´é—´éš”ä»…å’Œç›¸é‚»è·¯ç”±å™¨äº¤æ¢è‡ªå·±çš„è·¯ç”±è¡¨ï¼Œç»è¿‡è‹¥å¹²æ¬¡äº¤æ¢ä¹‹åï¼Œæ‰€æœ‰è·¯ç”±å™¨æœ€ç»ˆä¼šçŸ¥é“åˆ°è¾¾æœ¬è‡ªæ²»ç³»ç»Ÿä¸­ä»»ä½•ä¸€ä¸ªç½‘ç»œçš„æœ€çŸ­è·ç¦»å’Œä¸‹ä¸€è·³è·¯ç”±å™¨åœ°å€ã€‚</p><p>è·ç¦»å‘é‡ç®—æ³•ï¼š</p><ul><li>å¯¹åœ°å€ä¸º X çš„ç›¸é‚»è·¯ç”±å™¨å‘æ¥çš„ RIP æŠ¥æ–‡ï¼Œå…ˆä¿®æ”¹æŠ¥æ–‡ä¸­çš„æ‰€æœ‰é¡¹ç›®ï¼ŒæŠŠä¸‹ä¸€è·³å­—æ®µä¸­çš„åœ°å€æ”¹ä¸º Xï¼Œå¹¶æŠŠæ‰€æœ‰çš„è·ç¦»å­—æ®µåŠ  1ï¼›</li><li>å¯¹ä¿®æ”¹åçš„ RIP æŠ¥æ–‡ä¸­çš„æ¯ä¸€ä¸ªé¡¹ç›®ï¼Œè¿›è¡Œä»¥ä¸‹æ­¥éª¤ï¼š<ul><li>è‹¥åŸæ¥çš„è·¯ç”±è¡¨ä¸­æ²¡æœ‰ç›®çš„ç½‘ç»œ Nï¼Œåˆ™æŠŠè¯¥é¡¹ç›®æ·»åŠ åˆ°è·¯ç”±è¡¨ä¸­ï¼›</li><li>å¦åˆ™ï¼šè‹¥ä¸‹ä¸€è·³è·¯ç”±å™¨åœ°å€æ˜¯ Xï¼Œåˆ™æŠŠæ”¶åˆ°çš„é¡¹ç›®æ›¿æ¢åŸæ¥è·¯ç”±è¡¨ä¸­çš„é¡¹ç›®ï¼›å¦åˆ™ï¼šè‹¥æ”¶åˆ°çš„é¡¹ç›®ä¸­çš„è·ç¦» d å°äºè·¯ç”±è¡¨ä¸­çš„è·ç¦»ï¼Œåˆ™è¿›è¡Œæ›´æ–°ï¼ˆä¾‹å¦‚åŸå§‹è·¯ç”±è¡¨é¡¹ä¸º Net2, 5, Pï¼Œæ–°è¡¨é¡¹ä¸º Net2, 4, Xï¼Œåˆ™æ›´æ–°ï¼‰ï¼›å¦åˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚</li></ul></li><li>è‹¥ 3 åˆ†é’Ÿè¿˜æ²¡æœ‰æ”¶åˆ°ç›¸é‚»è·¯ç”±å™¨çš„æ›´æ–°è·¯ç”±è¡¨ï¼Œåˆ™æŠŠè¯¥ç›¸é‚»è·¯ç”±å™¨æ ‡ä¸ºä¸å¯è¾¾ï¼Œå³æŠŠè·ç¦»ç½®ä¸º 16ã€‚</li></ul><p>RIP åè®®å®ç°ç®€å•ï¼Œå¼€é”€å°ã€‚ä½†æ˜¯ RIP èƒ½ä½¿ç”¨çš„æœ€å¤§è·ç¦»ä¸º 15ï¼Œé™åˆ¶äº†ç½‘ç»œçš„è§„æ¨¡ã€‚å¹¶ä¸”å½“ç½‘ç»œå‡ºç°æ•…éšœæ—¶ï¼Œè¦ç»è¿‡æ¯”è¾ƒé•¿çš„æ—¶é—´æ‰èƒ½å°†æ­¤æ¶ˆæ¯ä¼ é€åˆ°æ‰€æœ‰è·¯ç”±å™¨ã€‚</p><h3 id="2-å†…éƒ¨ç½‘å…³åè®®-OSPF"><a href="#2-å†…éƒ¨ç½‘å…³åè®®-OSPF" class="headerlink" title="2. å†…éƒ¨ç½‘å…³åè®® OSPF"></a>2. å†…éƒ¨ç½‘å…³åè®® OSPF</h3><p>å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆ OSPFï¼Œæ˜¯ä¸ºäº†å…‹æœ RIP çš„ç¼ºç‚¹è€Œå¼€å‘å‡ºæ¥çš„ã€‚</p><p>å¼€æ”¾è¡¨ç¤º OSPF ä¸å—æŸä¸€å®¶å‚å•†æ§åˆ¶ï¼Œè€Œæ˜¯å…¬å¼€å‘è¡¨çš„ï¼›æœ€çŸ­è·¯å¾„ä¼˜å…ˆè¡¨ç¤ºä½¿ç”¨äº† Dijkstra æå‡ºçš„æœ€çŸ­è·¯å¾„ç®—æ³• SPFã€‚</p><p>OSPF å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>å‘æœ¬è‡ªæ²»ç³»ç»Ÿä¸­çš„æ‰€æœ‰è·¯ç”±å™¨å‘é€ä¿¡æ¯ï¼Œè¿™ç§æ–¹æ³•æ˜¯æ´ªæ³›æ³•ã€‚</li><li>å‘é€çš„ä¿¡æ¯å°±æ˜¯ä¸ç›¸é‚»è·¯ç”±å™¨çš„é“¾è·¯çŠ¶æ€ï¼Œé“¾è·¯çŠ¶æ€åŒ…æ‹¬ä¸å“ªäº›è·¯ç”±å™¨ç›¸è¿ä»¥åŠé“¾è·¯çš„åº¦é‡ï¼Œåº¦é‡ç”¨è´¹ç”¨ã€è·ç¦»ã€æ—¶å»¶ã€å¸¦å®½ç­‰æ¥è¡¨ç¤ºã€‚</li><li>åªæœ‰å½“é“¾è·¯çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè·¯ç”±å™¨æ‰ä¼šå‘é€ä¿¡æ¯ã€‚</li></ul><p>æ‰€æœ‰è·¯ç”±å™¨éƒ½å…·æœ‰å…¨ç½‘çš„æ‹“æ‰‘ç»“æ„å›¾ï¼Œå¹¶ä¸”æ˜¯ä¸€è‡´çš„ã€‚ç›¸æ¯”äº RIPï¼ŒOSPF çš„æ›´æ–°è¿‡ç¨‹æ”¶æ•›çš„å¾ˆå¿«ã€‚</p><h3 id="3-å¤–éƒ¨ç½‘å…³åè®®-BGP"><a href="#3-å¤–éƒ¨ç½‘å…³åè®®-BGP" class="headerlink" title="3. å¤–éƒ¨ç½‘å…³åè®® BGP"></a>3. å¤–éƒ¨ç½‘å…³åè®® BGP</h3><p>BGPï¼ˆBorder Gateway Protocolï¼Œè¾¹ç•Œç½‘å…³åè®®ï¼‰</p><p>AS ä¹‹é—´çš„è·¯ç”±é€‰æ‹©å¾ˆå›°éš¾ï¼Œä¸»è¦æ˜¯å› ä¸ºäº’è”ç½‘è§„æ¨¡å¾ˆå¤§ã€‚å¹¶ä¸”å„ä¸ª AS å†…éƒ¨ä½¿ç”¨ä¸åŒçš„è·¯ç”±é€‰æ‹©åè®®ï¼Œå°±æ— æ³•å‡†ç¡®å®šä¹‰è·¯å¾„çš„åº¦é‡ã€‚å¹¶ä¸” AS ä¹‹é—´çš„è·¯ç”±é€‰æ‹©å¿…é¡»è€ƒè™‘æœ‰å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æœ‰äº› AS ä¸æ„¿æ„è®©å…¶å®ƒ AS ç»è¿‡ã€‚</p><p>BGP åªèƒ½å¯»æ‰¾ä¸€æ¡æ¯”è¾ƒå¥½çš„è·¯ç”±ï¼Œè€Œä¸æ˜¯æœ€ä½³è·¯ç”±ã€‚</p><p>æ¯ä¸ª AS éƒ½å¿…é¡»é…ç½® BGP å‘è¨€äººï¼Œé€šè¿‡åœ¨ä¸¤ä¸ªç›¸é‚» BGP å‘è¨€äººä¹‹é—´å»ºç«‹ TCP è¿æ¥æ¥äº¤æ¢è·¯ç”±ä¿¡æ¯ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045321.png" width="600"> </div><br></p><h1 id="äº”ã€è¿è¾“å±‚"><a href="#äº”ã€è¿è¾“å±‚" class="headerlink" title="äº”ã€è¿è¾“å±‚*"></a>äº”ã€è¿è¾“å±‚*</h1><p>ç½‘ç»œå±‚åªæŠŠåˆ†ç»„å‘é€åˆ°ç›®çš„ä¸»æœºï¼Œä½†æ˜¯çœŸæ­£é€šä¿¡çš„å¹¶ä¸æ˜¯ä¸»æœºè€Œæ˜¯ä¸»æœºä¸­çš„è¿›ç¨‹ã€‚è¿è¾“å±‚æä¾›äº†è¿›ç¨‹é—´çš„é€»è¾‘é€šä¿¡ï¼Œè¿è¾“å±‚å‘é«˜å±‚ç”¨æˆ·å±è”½äº†ä¸‹é¢ç½‘ç»œå±‚çš„æ ¸å¿ƒç»†èŠ‚ï¼Œä½¿åº”ç”¨ç¨‹åºçœ‹èµ·æ¥åƒæ˜¯åœ¨ä¸¤ä¸ªè¿è¾“å±‚å®ä½“ä¹‹é—´æœ‰ä¸€æ¡ç«¯åˆ°ç«¯çš„é€»è¾‘é€šä¿¡ä¿¡é“ã€‚</p><h2 id="UDP-å’Œ-TCP-çš„ç‰¹ç‚¹"><a href="#UDP-å’Œ-TCP-çš„ç‰¹ç‚¹" class="headerlink" title="UDP å’Œ TCP çš„ç‰¹ç‚¹"></a>UDP å’Œ TCP çš„ç‰¹ç‚¹</h2><ul><li><p>ç”¨æˆ·æ•°æ®æŠ¥åè®® UDPï¼ˆUser Datagram Protocolï¼‰æ˜¯æ— è¿æ¥çš„ï¼Œå°½æœ€å¤§å¯èƒ½äº¤ä»˜ï¼Œæ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼Œé¢å‘æŠ¥æ–‡ï¼ˆå¯¹äºåº”ç”¨ç¨‹åºä¼ ä¸‹æ¥çš„æŠ¥æ–‡ä¸åˆå¹¶ä¹Ÿä¸æ‹†åˆ†ï¼Œåªæ˜¯æ·»åŠ  UDP é¦–éƒ¨ï¼‰ï¼Œæ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡ã€‚</p></li><li><p>ä¼ è¾“æ§åˆ¶åè®® TCPï¼ˆTransmission Control Protocolï¼‰æ˜¯é¢å‘è¿æ¥çš„ï¼Œæä¾›å¯é äº¤ä»˜ï¼Œæœ‰æµé‡æ§åˆ¶ï¼Œæ‹¥å¡æ§åˆ¶ï¼Œæä¾›å…¨åŒå·¥é€šä¿¡ï¼Œé¢å‘å­—èŠ‚æµï¼ˆæŠŠåº”ç”¨å±‚ä¼ ä¸‹æ¥çš„æŠ¥æ–‡çœ‹æˆå­—èŠ‚æµï¼ŒæŠŠå­—èŠ‚æµç»„ç»‡æˆå¤§å°ä¸ç­‰çš„æ•°æ®å—ï¼‰ï¼Œæ¯ä¸€æ¡ TCP è¿æ¥åªèƒ½æ˜¯ç‚¹å¯¹ç‚¹çš„ï¼ˆä¸€å¯¹ä¸€ï¼‰ã€‚</p></li></ul><h2 id="UDP-é¦–éƒ¨æ ¼å¼"><a href="#UDP-é¦–éƒ¨æ ¼å¼" class="headerlink" title="UDP é¦–éƒ¨æ ¼å¼"></a>UDP é¦–éƒ¨æ ¼å¼</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045326.jpg" width="600"> </div><br></p><p>é¦–éƒ¨å­—æ®µåªæœ‰ 8 ä¸ªå­—èŠ‚ï¼ŒåŒ…æ‹¬æºç«¯å£ã€ç›®çš„ç«¯å£ã€é•¿åº¦ã€æ£€éªŒå’Œã€‚12 å­—èŠ‚çš„ä¼ªé¦–éƒ¨æ˜¯ä¸ºäº†è®¡ç®—æ£€éªŒå’Œä¸´æ—¶æ·»åŠ çš„ã€‚</p><h2 id="TCP-é¦–éƒ¨æ ¼å¼"><a href="#TCP-é¦–éƒ¨æ ¼å¼" class="headerlink" title="TCP é¦–éƒ¨æ ¼å¼"></a>TCP é¦–éƒ¨æ ¼å¼</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045330.png" width="700"> </div><br></p><ul><li><p><strong>åºå·</strong>  ï¼šç”¨äºå¯¹å­—èŠ‚æµè¿›è¡Œç¼–å·ï¼Œä¾‹å¦‚åºå·ä¸º 301ï¼Œè¡¨ç¤ºç¬¬ä¸€ä¸ªå­—èŠ‚çš„ç¼–å·ä¸º 301ï¼Œå¦‚æœæºå¸¦çš„æ•°æ®é•¿åº¦ä¸º 100 å­—èŠ‚ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„åºå·åº”ä¸º 401ã€‚</p></li><li><p><strong>ç¡®è®¤å·</strong>  ï¼šæœŸæœ›æ”¶åˆ°çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„åºå·ã€‚ä¾‹å¦‚ B æ­£ç¡®æ”¶åˆ° A å‘é€æ¥çš„ä¸€ä¸ªæŠ¥æ–‡æ®µï¼Œåºå·ä¸º 501ï¼Œæºå¸¦çš„æ•°æ®é•¿åº¦ä¸º 200 å­—èŠ‚ï¼Œå› æ­¤ B æœŸæœ›ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„åºå·ä¸º 701ï¼ŒB å‘é€ç»™ A çš„ç¡®è®¤æŠ¥æ–‡æ®µä¸­ç¡®è®¤å·å°±ä¸º 701ã€‚</p></li><li><p><strong>æ•°æ®åç§»</strong>  ï¼šæŒ‡çš„æ˜¯æ•°æ®éƒ¨åˆ†è·ç¦»æŠ¥æ–‡æ®µèµ·å§‹å¤„çš„åç§»é‡ï¼Œå®é™…ä¸ŠæŒ‡çš„æ˜¯é¦–éƒ¨çš„é•¿åº¦ã€‚</p></li><li><p><strong>ç¡®è®¤ ACK</strong>  ï¼šå½“ ACK=1 æ—¶ç¡®è®¤å·å­—æ®µæœ‰æ•ˆï¼Œå¦åˆ™æ— æ•ˆã€‚TCP è§„å®šï¼Œåœ¨è¿æ¥å»ºç«‹åæ‰€æœ‰ä¼ é€çš„æŠ¥æ–‡æ®µéƒ½å¿…é¡»æŠŠ ACK ç½® 1ã€‚</p></li><li><p><strong>åŒæ­¥ SYN</strong>  ï¼šåœ¨è¿æ¥å»ºç«‹æ—¶ç”¨æ¥åŒæ­¥åºå·ã€‚å½“ SYN=1ï¼ŒACK=0 æ—¶è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚è‹¥å¯¹æ–¹åŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å“åº”æŠ¥æ–‡ä¸­ SYN=1ï¼ŒACK=1ã€‚</p></li><li><p><strong>ç»ˆæ­¢ FIN</strong>  ï¼šç”¨æ¥é‡Šæ”¾ä¸€ä¸ªè¿æ¥ï¼Œå½“ FIN=1 æ—¶ï¼Œè¡¨ç¤ºæ­¤æŠ¥æ–‡æ®µçš„å‘é€æ–¹çš„æ•°æ®å·²å‘é€å®Œæ¯•ï¼Œå¹¶è¦æ±‚é‡Šæ”¾è¿æ¥ã€‚</p></li><li><p><strong>çª—å£</strong>  ï¼šçª—å£å€¼ä½œä¸ºæ¥æ”¶æ–¹è®©å‘é€æ–¹è®¾ç½®å…¶å‘é€çª—å£çš„ä¾æ®ã€‚ä¹‹æ‰€ä»¥è¦æœ‰è¿™ä¸ªé™åˆ¶ï¼Œæ˜¯å› ä¸ºæ¥æ”¶æ–¹çš„æ•°æ®ç¼“å­˜ç©ºé—´æ˜¯æœ‰é™çš„ã€‚</p></li></ul><h2 id="TCP-çš„ä¸‰æ¬¡æ¡æ‰‹"><a href="#TCP-çš„ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="TCP çš„ä¸‰æ¬¡æ¡æ‰‹"></a>TCP çš„ä¸‰æ¬¡æ¡æ‰‹</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045344.png" width="600"> </div><br></p><p>å‡è®¾ A ä¸ºå®¢æˆ·ç«¯ï¼ŒB ä¸ºæœåŠ¡å™¨ç«¯ã€‚</p><ul><li><p>é¦–å…ˆ B å¤„äº LISTENï¼ˆç›‘å¬ï¼‰çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·çš„è¿æ¥è¯·æ±‚ã€‚</p></li><li><p>A å‘ B å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼ŒSYN=1ï¼ŒACK=0ï¼Œé€‰æ‹©ä¸€ä¸ªåˆå§‹çš„åºå· xã€‚</p></li><li><p>B æ”¶åˆ°è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå¦‚æœåŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å‘ A å‘é€è¿æ¥ç¡®è®¤æŠ¥æ–‡æ®µï¼ŒSYN=1ï¼ŒACK=1ï¼Œç¡®è®¤å·ä¸º x+1ï¼ŒåŒæ—¶ä¹Ÿé€‰æ‹©ä¸€ä¸ªåˆå§‹çš„åºå· yã€‚</p></li><li><p>A æ”¶åˆ° B çš„è¿æ¥ç¡®è®¤æŠ¥æ–‡æ®µåï¼Œè¿˜è¦å‘ B å‘å‡ºç¡®è®¤ï¼Œç¡®è®¤å·ä¸º y+1ï¼Œåºå·ä¸º x+1ã€‚</p></li><li><p>B æ”¶åˆ° A çš„ç¡®è®¤åï¼Œè¿æ¥å»ºç«‹ã€‚</p></li></ul><p><strong>ä¸‰æ¬¡æ¡æ‰‹çš„åŸå› </strong> </p><p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹æ˜¯ä¸ºäº†é˜²æ­¢å¤±æ•ˆçš„è¿æ¥è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ï¼Œè®©æœåŠ¡å™¨é”™è¯¯æ‰“å¼€è¿æ¥ã€‚</p><p>å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æ˜¯æŒ‡ï¼Œå®¢æˆ·ç«¯å‘é€çš„è¿æ¥è¯·æ±‚åœ¨ç½‘ç»œä¸­æ»ç•™ï¼Œå®¢æˆ·ç«¯å› ä¸ºæ²¡åŠæ—¶æ”¶åˆ°æœåŠ¡å™¨ç«¯å‘é€çš„è¿æ¥ç¡®è®¤ï¼Œå› æ­¤å°±é‡æ–°å‘é€äº†è¿æ¥è¯·æ±‚ã€‚æ»ç•™çš„è¿æ¥è¯·æ±‚å¹¶ä¸æ˜¯ä¸¢å¤±ï¼Œä¹‹åè¿˜æ˜¯ä¼šåˆ°è¾¾æœåŠ¡å™¨ã€‚å¦‚æœä¸è¿›è¡Œç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¼šè¯¯è®¤ä¸ºå®¢æˆ·ç«¯é‡æ–°è¯·æ±‚è¿æ¥ï¼Œç„¶åæ‰“å¼€äº†è¿æ¥ã€‚ä½†æ˜¯å¹¶ä¸æ˜¯å®¢æˆ·ç«¯çœŸæ­£æ‰“å¼€è¿™ä¸ªè¿æ¥ï¼Œå› æ­¤å®¢æˆ·ç«¯ä¸ä¼šç»™æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œè¿™ä¸ªè¿æ¥å°±ç™½ç™½æµªè´¹äº†ã€‚</p><h2 id="TCP-çš„å››æ¬¡æŒ¥æ‰‹"><a href="#TCP-çš„å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="TCP çš„å››æ¬¡æŒ¥æ‰‹"></a>TCP çš„å››æ¬¡æŒ¥æ‰‹</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045348.jpg" width="600"> </div><br></p><p>ä»¥ä¸‹æè¿°ä¸è®¨è®ºåºå·å’Œç¡®è®¤å·ï¼Œå› ä¸ºåºå·å’Œç¡®è®¤å·çš„è§„åˆ™æ¯”è¾ƒç®€å•ã€‚å¹¶ä¸”ä¸è®¨è®º ACKï¼Œå› ä¸º ACK åœ¨è¿æ¥å»ºç«‹ä¹‹åéƒ½ä¸º 1ã€‚</p><ul><li><p>A å‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼ŒFIN=1ã€‚</p></li><li><p>B æ”¶åˆ°ä¹‹åå‘å‡ºç¡®è®¤ï¼Œæ­¤æ—¶ TCP å±äºåŠå…³é—­çŠ¶æ€ï¼ŒB èƒ½å‘ A å‘é€æ•°æ®ä½†æ˜¯ A ä¸èƒ½å‘ B å‘é€æ•°æ®ã€‚</p></li><li><p>å½“ B ä¸å†éœ€è¦è¿æ¥æ—¶ï¼Œå‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚æŠ¥æ–‡æ®µï¼ŒFIN=1ã€‚</p></li><li><p>A æ”¶åˆ°åå‘å‡ºç¡®è®¤ï¼Œè¿›å…¥ TIME-WAIT çŠ¶æ€ï¼Œç­‰å¾… 2 MSL æ—¶é—´åé‡Šæ”¾è¿æ¥ã€‚</p></li><li><p>B æ”¶åˆ° A çš„ç¡®è®¤åé‡Šæ”¾è¿æ¥ã€‚</p></li></ul><p><strong>å››æ¬¡æŒ¥æ‰‹çš„åŸå› </strong> </p><p>å®¢æˆ·ç«¯å‘é€äº† FIN è¿æ¥é‡Šæ”¾æŠ¥æ–‡ä¹‹åï¼ŒæœåŠ¡å™¨æ”¶åˆ°äº†è¿™ä¸ªæŠ¥æ–‡ï¼Œå°±è¿›å…¥äº† CLOSE-WAIT çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€æ˜¯ä¸ºäº†è®©æœåŠ¡å™¨ç«¯å‘é€è¿˜æœªä¼ é€å®Œæ¯•çš„æ•°æ®ï¼Œä¼ é€å®Œæ¯•ä¹‹åï¼ŒæœåŠ¡å™¨ä¼šå‘é€ FIN è¿æ¥é‡Šæ”¾æŠ¥æ–‡ã€‚</p><p><strong>TIME_WAIT</strong> </p><p>å®¢æˆ·ç«¯æ¥æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„ FIN æŠ¥æ–‡åè¿›å…¥æ­¤çŠ¶æ€ï¼Œæ­¤æ—¶å¹¶ä¸æ˜¯ç›´æ¥è¿›å…¥ CLOSED çŠ¶æ€ï¼Œè¿˜éœ€è¦ç­‰å¾…ä¸€ä¸ªæ—¶é—´è®¡æ—¶å™¨è®¾ç½®çš„æ—¶é—´ 2MSLã€‚è¿™ä¹ˆåšæœ‰ä¸¤ä¸ªç†ç”±ï¼š</p><ul><li><p>ç¡®ä¿æœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡æ®µèƒ½å¤Ÿåˆ°è¾¾ã€‚å¦‚æœ B æ²¡æ”¶åˆ° A å‘é€æ¥çš„ç¡®è®¤æŠ¥æ–‡æ®µï¼Œé‚£ä¹ˆå°±ä¼šé‡æ–°å‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚æŠ¥æ–‡æ®µï¼ŒA ç­‰å¾…ä¸€æ®µæ—¶é—´å°±æ˜¯ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚</p></li><li><p>ç­‰å¾…ä¸€æ®µæ—¶é—´æ˜¯ä¸ºäº†è®©æœ¬è¿æ¥æŒç»­æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ï¼Œä½¿å¾—ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ä¸ä¼šå‡ºç°æ—§çš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚</p></li></ul><h2 id="TCP-æ»‘åŠ¨çª—å£"><a href="#TCP-æ»‘åŠ¨çª—å£" class="headerlink" title="TCP æ»‘åŠ¨çª—å£"></a>TCP æ»‘åŠ¨çª—å£</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045357.jpg" width="800"> </div><br></p><p>çª—å£æ˜¯ç¼“å­˜çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æš‚æ—¶å­˜æ”¾å­—èŠ‚æµã€‚å‘é€æ–¹å’Œæ¥æ”¶æ–¹å„æœ‰ä¸€ä¸ªçª—å£ï¼Œæ¥æ”¶æ–¹é€šè¿‡ TCP æŠ¥æ–‡æ®µä¸­çš„çª—å£å­—æ®µå‘Šè¯‰å‘é€æ–¹è‡ªå·±çš„çª—å£å¤§å°ï¼Œå‘é€æ–¹æ ¹æ®è¿™ä¸ªå€¼å’Œå…¶å®ƒä¿¡æ¯è®¾ç½®è‡ªå·±çš„çª—å£å¤§å°ã€‚</p><p>å‘é€çª—å£å†…çš„å­—èŠ‚éƒ½å…è®¸è¢«å‘é€ï¼Œæ¥æ”¶çª—å£å†…çš„å­—èŠ‚éƒ½å…è®¸è¢«æ¥æ”¶ã€‚å¦‚æœå‘é€çª—å£å·¦éƒ¨çš„å­—èŠ‚å·²ç»å‘é€å¹¶ä¸”æ”¶åˆ°äº†ç¡®è®¤ï¼Œé‚£ä¹ˆå°±å°†å‘é€çª—å£å‘å³æ»‘åŠ¨ä¸€å®šè·ç¦»ï¼Œç›´åˆ°å·¦éƒ¨ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸æ˜¯å·²å‘é€å¹¶ä¸”å·²ç¡®è®¤çš„çŠ¶æ€ï¼›æ¥æ”¶çª—å£çš„æ»‘åŠ¨ç±»ä¼¼ï¼Œæ¥æ”¶çª—å£å·¦éƒ¨å­—èŠ‚å·²ç»å‘é€ç¡®è®¤å¹¶äº¤ä»˜ä¸»æœºï¼Œå°±å‘å³æ»‘åŠ¨æ¥æ”¶çª—å£ã€‚</p><p>æ¥æ”¶çª—å£åªä¼šå¯¹çª—å£å†…æœ€åä¸€ä¸ªæŒ‰åºåˆ°è¾¾çš„å­—èŠ‚è¿›è¡Œç¡®è®¤ï¼Œä¾‹å¦‚æ¥æ”¶çª—å£å·²ç»æ”¶åˆ°çš„å­—èŠ‚ä¸º {31, 34, 35}ï¼Œå…¶ä¸­ {31} æŒ‰åºåˆ°è¾¾ï¼Œè€Œ {32, 33} å°±ä¸æ˜¯ï¼Œå› æ­¤åªå¯¹å­—èŠ‚ 31 è¿›è¡Œç¡®è®¤ã€‚å‘é€æ–¹å¾—åˆ°ä¸€ä¸ªå­—èŠ‚çš„ç¡®è®¤ä¹‹åï¼Œå°±çŸ¥é“è¿™ä¸ªå­—èŠ‚ä¹‹å‰çš„æ‰€æœ‰å­—èŠ‚éƒ½å·²ç»è¢«æ¥æ”¶ã€‚</p><h2 id="TCP-å¯é ä¼ è¾“"><a href="#TCP-å¯é ä¼ è¾“" class="headerlink" title="TCP å¯é ä¼ è¾“"></a>TCP å¯é ä¼ è¾“</h2><p>TCP ä½¿ç”¨è¶…æ—¶é‡ä¼ æ¥å®ç°å¯é ä¼ è¾“ï¼šå¦‚æœä¸€ä¸ªå·²ç»å‘é€çš„æŠ¥æ–‡æ®µåœ¨è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œé‚£ä¹ˆå°±é‡ä¼ è¿™ä¸ªæŠ¥æ–‡æ®µã€‚</p><p>ä¸€ä¸ªæŠ¥æ–‡æ®µä»å‘é€å†åˆ°æ¥æ”¶åˆ°ç¡®è®¤æ‰€ç»è¿‡çš„æ—¶é—´ç§°ä¸ºå¾€è¿”æ—¶é—´ RTTï¼ŒåŠ æƒå¹³å‡å¾€è¿”æ—¶é—´ RTTs è®¡ç®—å¦‚ä¸‹ï¼š</p><p><div align="center"><img src="https://latex.codecogs.com/gif.latex?RTTs=(1-a)*(RTTs)+a*RTT"></div> <br></p><p>è¶…æ—¶æ—¶é—´ RTO åº”è¯¥ç•¥å¤§äº RTTsï¼ŒTCP ä½¿ç”¨çš„è¶…æ—¶æ—¶é—´è®¡ç®—å¦‚ä¸‹ï¼š</p><p><div align="center"><img src="https://latex.codecogs.com/gif.latex?RTO=RTTs+4*RTT_d"></div> <br></p><p>å…¶ä¸­ RTT<sub>d</sub> ä¸ºåå·®ã€‚</p><h2 id="TCP-æµé‡æ§åˆ¶"><a href="#TCP-æµé‡æ§åˆ¶" class="headerlink" title="TCP æµé‡æ§åˆ¶"></a>TCP æµé‡æ§åˆ¶</h2><p>æµé‡æ§åˆ¶æ˜¯ä¸ºäº†æ§åˆ¶å‘é€æ–¹å‘é€é€Ÿç‡ï¼Œä¿è¯æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚</p><p>æ¥æ”¶æ–¹å‘é€çš„ç¡®è®¤æŠ¥æ–‡ä¸­çš„çª—å£å­—æ®µå¯ä»¥ç”¨æ¥æ§åˆ¶å‘é€æ–¹çª—å£å¤§å°ï¼Œä»è€Œå½±å“å‘é€æ–¹çš„å‘é€é€Ÿç‡ã€‚å°†çª—å£å­—æ®µè®¾ç½®ä¸º 0ï¼Œåˆ™å‘é€æ–¹ä¸èƒ½å‘é€æ•°æ®ã€‚</p><h2 id="TCP-æ‹¥å¡æ§åˆ¶"><a href="#TCP-æ‹¥å¡æ§åˆ¶" class="headerlink" title="TCP æ‹¥å¡æ§åˆ¶"></a>TCP æ‹¥å¡æ§åˆ¶</h2><p>å¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡ï¼Œåˆ†ç»„å°†ä¼šä¸¢å¤±ï¼Œæ­¤æ—¶å‘é€æ–¹ä¼šç»§ç»­é‡ä¼ ï¼Œä»è€Œå¯¼è‡´ç½‘ç»œæ‹¥å¡ç¨‹åº¦æ›´é«˜ã€‚å› æ­¤å½“å‡ºç°æ‹¥å¡æ—¶ï¼Œåº”å½“æ§åˆ¶å‘é€æ–¹çš„é€Ÿç‡ã€‚è¿™ä¸€ç‚¹å’Œæµé‡æ§åˆ¶å¾ˆåƒï¼Œä½†æ˜¯å‡ºå‘ç‚¹ä¸åŒã€‚æµé‡æ§åˆ¶æ˜¯ä¸ºäº†è®©æ¥æ”¶æ–¹èƒ½æ¥å¾—åŠæ¥å—ï¼Œè€Œæ‹¥å¡æ§åˆ¶æ˜¯ä¸ºäº†é™ä½æ•´ä¸ªç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045401.jpg" width="500"> </div><br></p><p>TCP ä¸»è¦é€šè¿‡å››ç§ç®—æ³•æ¥è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼šæ…¢å¼€å§‹ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ ã€å¿«æ¢å¤ã€‚</p><p>å‘é€æ–¹éœ€è¦ç»´æŠ¤ä¸€ä¸ªå«åšæ‹¥å¡çª—å£ï¼ˆcwndï¼‰çš„çŠ¶æ€å˜é‡ï¼Œæ³¨æ„æ‹¥å¡çª—å£ä¸å‘é€æ–¹çª—å£çš„åŒºåˆ«ï¼šæ‹¥å¡çª—å£åªæ˜¯ä¸€ä¸ªçŠ¶æ€å˜é‡ï¼Œå®é™…å†³å®šå‘é€æ–¹èƒ½å‘é€å¤šå°‘æ•°æ®çš„æ˜¯å‘é€æ–¹çª—å£ã€‚</p><p>ä¸ºäº†ä¾¿äºè®¨è®ºï¼Œåšå¦‚ä¸‹å‡è®¾ï¼š</p><ul><li>æ¥æ”¶æ–¹æœ‰è¶³å¤Ÿå¤§çš„æ¥æ”¶ç¼“å­˜ï¼Œå› æ­¤ä¸ä¼šå‘ç”Ÿæµé‡æ§åˆ¶ï¼›</li><li>è™½ç„¶ TCP çš„çª—å£åŸºäºå­—èŠ‚ï¼Œä½†æ˜¯è¿™é‡Œè®¾çª—å£çš„å¤§å°å•ä½ä¸ºæŠ¥æ–‡æ®µã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045404.png" width="800"> </div><br></p><h3 id="1-æ…¢å¼€å§‹ä¸æ‹¥å¡é¿å…"><a href="#1-æ…¢å¼€å§‹ä¸æ‹¥å¡é¿å…" class="headerlink" title="1. æ…¢å¼€å§‹ä¸æ‹¥å¡é¿å…"></a>1. æ…¢å¼€å§‹ä¸æ‹¥å¡é¿å…</h3><p>å‘é€çš„æœ€åˆæ‰§è¡Œæ…¢å¼€å§‹ï¼Œä»¤ cwnd=1ï¼Œå‘é€æ–¹åªèƒ½å‘é€ 1 ä¸ªæŠ¥æ–‡æ®µï¼›å½“æ”¶åˆ°ç¡®è®¤åï¼Œå°† cwnd åŠ å€ï¼Œå› æ­¤ä¹‹åå‘é€æ–¹èƒ½å¤Ÿå‘é€çš„æŠ¥æ–‡æ®µæ•°é‡ä¸ºï¼š2ã€4ã€8 â€¦</p><p>æ³¨æ„åˆ°æ…¢å¼€å§‹æ¯ä¸ªè½®æ¬¡éƒ½å°† cwnd åŠ å€ï¼Œè¿™æ ·ä¼šè®© cwnd å¢é•¿é€Ÿåº¦éå¸¸å¿«ï¼Œä»è€Œä½¿å¾—å‘é€æ–¹å‘é€çš„é€Ÿåº¦å¢é•¿é€Ÿåº¦è¿‡å¿«ï¼Œç½‘ç»œæ‹¥å¡çš„å¯èƒ½ä¹Ÿå°±æ›´é«˜ã€‚è®¾ç½®ä¸€ä¸ªæ…¢å¼€å§‹é—¨é™ ssthreshï¼Œå½“ cwnd &gt;= ssthresh æ—¶ï¼Œè¿›å…¥æ‹¥å¡é¿å…ï¼Œæ¯ä¸ªè½®æ¬¡åªå°† cwnd åŠ  1ã€‚</p><p>å¦‚æœå‡ºç°äº†è¶…æ—¶ï¼Œåˆ™ä»¤ ssthresh = cwnd/2ï¼Œç„¶åé‡æ–°æ‰§è¡Œæ…¢å¼€å§‹ã€‚</p><h3 id="2-å¿«é‡ä¼ ä¸å¿«æ¢å¤"><a href="#2-å¿«é‡ä¼ ä¸å¿«æ¢å¤" class="headerlink" title="2. å¿«é‡ä¼ ä¸å¿«æ¢å¤"></a>2. å¿«é‡ä¼ ä¸å¿«æ¢å¤</h3><p>åœ¨æ¥æ”¶æ–¹ï¼Œè¦æ±‚æ¯æ¬¡æ¥æ”¶åˆ°æŠ¥æ–‡æ®µéƒ½åº”è¯¥å‘é€å¯¹å·²æ”¶åˆ°æœ‰åºæŠ¥æ–‡æ®µçš„ç¡®è®¤ï¼Œä¾‹å¦‚å·²ç»æ¥æ”¶åˆ° M<sub>1</sub> å’Œ M<sub>2</sub>ï¼Œæ­¤æ—¶æ”¶åˆ° M<sub>4</sub>ï¼Œåº”å½“å‘é€å¯¹ M<sub>2</sub> çš„ç¡®è®¤ã€‚</p><p>åœ¨å‘é€æ–¹ï¼Œå¦‚æœæ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®è®¤ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µä¸¢å¤±ï¼Œä¾‹å¦‚æ”¶åˆ°ä¸‰ä¸ª M<sub>2</sub> ï¼Œåˆ™ M<sub>3</sub> ä¸¢å¤±ã€‚æ­¤æ—¶æ‰§è¡Œå¿«é‡ä¼ ï¼Œç«‹å³é‡ä¼ ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªæ˜¯ä¸¢å¤±ä¸ªåˆ«æŠ¥æ–‡æ®µï¼Œè€Œä¸æ˜¯ç½‘ç»œæ‹¥å¡ï¼Œå› æ­¤æ‰§è¡Œå¿«æ¢å¤ï¼Œä»¤ ssthresh = cwnd/2 ï¼Œcwnd = ssthreshï¼Œæ³¨æ„åˆ°æ­¤æ—¶ç›´æ¥è¿›å…¥æ‹¥å¡é¿å…ã€‚æ…¢å¼€å§‹å’Œå¿«æ¢å¤çš„å¿«æ…¢æŒ‡çš„æ˜¯ cwnd çš„è®¾å®šå€¼ï¼Œè€Œä¸æ˜¯ cwnd çš„å¢é•¿é€Ÿç‡ã€‚æ…¢å¼€å§‹ cwnd è®¾å®šä¸º 1ï¼Œè€Œå¿«æ¢å¤ cwnd è®¾å®šä¸º ssthreshã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045410.png" width="600"> </div><br></p><h1 id="å…­ã€åº”ç”¨å±‚"><a href="#å…­ã€åº”ç”¨å±‚" class="headerlink" title="å…­ã€åº”ç”¨å±‚"></a>å…­ã€åº”ç”¨å±‚</h1><h2 id="åŸŸåç³»ç»Ÿ"><a href="#åŸŸåç³»ç»Ÿ" class="headerlink" title="åŸŸåç³»ç»Ÿ"></a>åŸŸåç³»ç»Ÿ</h2><p>DNS æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæä¾›äº†ä¸»æœºåå’Œ IP åœ°å€ä¹‹é—´çš„è½¬æ¢ã€‚è¿™é‡Œçš„åˆ†å¸ƒå¼æ•°æ®åº“æ˜¯æŒ‡ï¼Œæ¯ä¸ªç«™ç‚¹åªä¿ç•™å®ƒè‡ªå·±çš„é‚£éƒ¨åˆ†æ•°æ®ã€‚</p><p>åŸŸåå…·æœ‰å±‚æ¬¡ç»“æ„ï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡ä¸ºï¼šæ ¹åŸŸåã€é¡¶çº§åŸŸåã€ç¬¬äºŒçº§åŸŸåã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045421.jpg"> </div><br></p><p>DNS å¯ä»¥ä½¿ç”¨ UDP æˆ–è€… TCP è¿›è¡Œä¼ è¾“ï¼Œä½¿ç”¨çš„ç«¯å£å·éƒ½ä¸º 53ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ DNS ä½¿ç”¨ UDP è¿›è¡Œä¼ è¾“ï¼Œè¿™å°±è¦æ±‚åŸŸåè§£æå™¨å’ŒåŸŸåæœåŠ¡å™¨éƒ½å¿…é¡»è‡ªå·±å¤„ç†è¶…æ—¶å’Œé‡ä¼ æ¥ä¿è¯å¯é æ€§ã€‚åœ¨ä¸¤ç§æƒ…å†µä¸‹ä¼šä½¿ç”¨ TCP è¿›è¡Œä¼ è¾“ï¼š</p><ul><li>å› ä¸º UDP æœ€å¤§åªæ”¯æŒ 512 å­—èŠ‚çš„æ•°æ®ï¼Œå¦‚æœè¿”å›çš„å“åº”è¶…è¿‡çš„ 512 å­—èŠ‚å°±æ”¹ç”¨ TCP è¿›è¡Œä¼ è¾“ã€‚</li><li>åŒºåŸŸä¼ é€æ˜¯ä¸»åŸŸåæœåŠ¡å™¨å‘è¾…åŠ©åŸŸåæœåŠ¡å™¨ä¼ é€å˜åŒ–çš„é‚£éƒ¨åˆ†æ•°æ®ï¼ŒåŒºåŸŸä¼ é€éœ€è¦ä½¿ç”¨ TCP è¿›è¡Œä¼ è¾“ã€‚</li></ul><h2 id="æ–‡ä»¶ä¼ é€åè®®"><a href="#æ–‡ä»¶ä¼ é€åè®®" class="headerlink" title="æ–‡ä»¶ä¼ é€åè®®"></a>æ–‡ä»¶ä¼ é€åè®®</h2><p>FTP ä½¿ç”¨ TCP è¿›è¡Œè¿æ¥ï¼Œå®ƒéœ€è¦ä¸¤ä¸ªè¿æ¥æ¥ä¼ é€ä¸€ä¸ªæ–‡ä»¶ï¼š</p><ul><li>æ§åˆ¶è¿æ¥ï¼šæœåŠ¡å™¨ä»¥æ‰“å¼€ç«¯å£å· 21 ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå®¢æˆ·ç«¯ä¸»åŠ¨å»ºç«‹è¿æ¥åï¼Œä½¿ç”¨è¿™ä¸ªè¿æ¥å°†å®¢æˆ·ç«¯çš„å‘½ä»¤ä¼ é€ç»™æœåŠ¡å™¨ï¼Œå¹¶ä¼ å›æœåŠ¡å™¨çš„åº”ç­”ã€‚</li><li>æ•°æ®è¿æ¥ï¼šç”¨æ¥ä¼ é€ä¸€ä¸ªæ–‡ä»¶ã€‚</li></ul><p>æ ¹æ®æ•°æ®è¿æ¥æ˜¯å¦æ˜¯æœåŠ¡å™¨ç«¯ä¸»åŠ¨å»ºç«‹ï¼ŒFTP æœ‰ä¸»åŠ¨å’Œè¢«åŠ¨ä¸¤ç§æ¨¡å¼ï¼š</p><ul><li>ä¸»åŠ¨æ¨¡å¼ï¼šæœåŠ¡å™¨ç«¯ä¸»åŠ¨å»ºç«‹æ•°æ®è¿æ¥ï¼Œå…¶ä¸­æœåŠ¡å™¨ç«¯çš„ç«¯å£å·ä¸º 20ï¼Œå®¢æˆ·ç«¯çš„ç«¯å£å·éšæœºï¼Œä½†æ˜¯å¿…é¡»å¤§äº 1024ï¼Œå› ä¸º 0~1023 æ˜¯ç†ŸçŸ¥ç«¯å£å·ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045427.jpg"> </div><br></p><ul><li>è¢«åŠ¨æ¨¡å¼ï¼šå®¢æˆ·ç«¯ä¸»åŠ¨å»ºç«‹æ•°æ®è¿æ¥ï¼Œå…¶ä¸­å®¢æˆ·ç«¯çš„ç«¯å£å·ç”±å®¢æˆ·ç«¯è‡ªå·±æŒ‡å®šï¼ŒæœåŠ¡å™¨ç«¯çš„ç«¯å£å·éšæœºã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045431.jpg"> </div><br></p><p>ä¸»åŠ¨æ¨¡å¼è¦æ±‚å®¢æˆ·ç«¯å¼€æ”¾ç«¯å£å·ç»™æœåŠ¡å™¨ç«¯ï¼Œéœ€è¦å»é…ç½®å®¢æˆ·ç«¯çš„é˜²ç«å¢™ã€‚è¢«åŠ¨æ¨¡å¼åªéœ€è¦æœåŠ¡å™¨ç«¯å¼€æ”¾ç«¯å£å·å³å¯ï¼Œæ— éœ€å®¢æˆ·ç«¯é…ç½®é˜²ç«å¢™ã€‚ä½†æ˜¯è¢«åŠ¨æ¨¡å¼ä¼šå¯¼è‡´æœåŠ¡å™¨ç«¯çš„å®‰å…¨æ€§å‡å¼±ï¼Œå› ä¸ºå¼€æ”¾äº†è¿‡å¤šçš„ç«¯å£å·ã€‚</p><h2 id="è¿œç¨‹ç™»å½•åè®®"><a href="#è¿œç¨‹ç™»å½•åè®®" class="headerlink" title="è¿œç¨‹ç™»å½•åè®®"></a>è¿œç¨‹ç™»å½•åè®®</h2><p>TELNET ç”¨äºç™»å½•åˆ°è¿œç¨‹ä¸»æœºä¸Šï¼Œå¹¶ä¸”è¿œç¨‹ä¸»æœºä¸Šçš„è¾“å‡ºä¹Ÿä¼šè¿”å›ã€‚</p><p>TELNET å¯ä»¥é€‚åº”è®¸å¤šè®¡ç®—æœºå’Œæ“ä½œç³»ç»Ÿçš„å·®å¼‚ï¼Œä¾‹å¦‚ä¸åŒæ“ä½œç³»ç»Ÿç³»ç»Ÿçš„æ¢è¡Œç¬¦å®šä¹‰ã€‚</p><h2 id="ç”µå­é‚®ä»¶åè®®"><a href="#ç”µå­é‚®ä»¶åè®®" class="headerlink" title="ç”µå­é‚®ä»¶åè®®"></a>ç”µå­é‚®ä»¶åè®®</h2><p>ä¸€ä¸ªç”µå­é‚®ä»¶ç³»ç»Ÿç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šç”¨æˆ·ä»£ç†ã€é‚®ä»¶æœåŠ¡å™¨ä»¥åŠé‚®ä»¶åè®®ã€‚</p><p>é‚®ä»¶åè®®åŒ…å«å‘é€åè®®å’Œè¯»å–åè®®ï¼Œå‘é€åè®®å¸¸ç”¨ SMTPï¼Œè¯»å–åè®®å¸¸ç”¨ POP3 å’Œ IMAPã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045436.png" width="700"> </div><br></p><h3 id="1-POP3"><a href="#1-POP3" class="headerlink" title="1. POP3"></a>1. POP3</h3><p>POP3 çš„ç‰¹ç‚¹æ˜¯åªè¦ç”¨æˆ·ä»æœåŠ¡å™¨ä¸Šè¯»å–äº†é‚®ä»¶ï¼Œå°±æŠŠè¯¥é‚®ä»¶åˆ é™¤ã€‚</p><h3 id="2-IMAP"><a href="#2-IMAP" class="headerlink" title="2. IMAP"></a>2. IMAP</h3><p>IMAP åè®®ä¸­å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸Šçš„é‚®ä»¶ä¿æŒåŒæ­¥ï¼Œå¦‚æœä¸å»æ‰‹åŠ¨åˆ é™¤é‚®ä»¶ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¸Šçš„é‚®ä»¶ä¹Ÿä¸ä¼šè¢«åˆ é™¤ã€‚IMAP è¿™ç§åšæ³•å¯ä»¥è®©ç”¨æˆ·éšæ—¶éšåœ°å»è®¿é—®æœåŠ¡å™¨ä¸Šçš„é‚®ä»¶ã€‚</p><h3 id="3-SMTP"><a href="#3-SMTP" class="headerlink" title="3. SMTP"></a>3. SMTP</h3><p>SMTP åªèƒ½å‘é€ ASCII ç ï¼Œè€Œäº’è”ç½‘é‚®ä»¶æ‰©å…… MIME å¯ä»¥å‘é€äºŒè¿›åˆ¶æ–‡ä»¶ã€‚MIME å¹¶æ²¡æœ‰æ”¹åŠ¨æˆ–è€…å–ä»£ SMTPï¼Œè€Œæ˜¯å¢åŠ é‚®ä»¶ä¸»ä½“çš„ç»“æ„ï¼Œå®šä¹‰äº†é ASCII ç çš„ç¼–ç è§„åˆ™ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045443.png" width=""> </div><br></p><h2 id="åŠ¨æ€ä¸»æœºé…ç½®åè®®"><a href="#åŠ¨æ€ä¸»æœºé…ç½®åè®®" class="headerlink" title="åŠ¨æ€ä¸»æœºé…ç½®åè®®"></a>åŠ¨æ€ä¸»æœºé…ç½®åè®®</h2><p>DHCP (Dynamic Host Configuration Protocol) æä¾›äº†å³æ’å³ç”¨çš„è¿ç½‘æ–¹å¼ï¼Œç”¨æˆ·ä¸å†éœ€è¦å»æ‰‹åŠ¨é…ç½® IP åœ°å€ç­‰ä¿¡æ¯ã€‚DHCP é…ç½®çš„å†…å®¹ä¸ä»…æ˜¯ IP åœ°å€ï¼Œè¿˜åŒ…æ‹¬å­ç½‘æ©ç ã€ç½‘å…³ IP åœ°å€ã€‚</p><p>DHCP å·¥ä½œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>å®¢æˆ·ç«¯å‘é€ Discover æŠ¥æ–‡ï¼Œè¯¥æŠ¥æ–‡çš„ç›®çš„åœ°å€ä¸º 255.255.255.255:67ï¼Œæºåœ°å€ä¸º 0.0.0.0:68ï¼Œè¢«æ”¾å…¥ UDP ä¸­ï¼Œè¯¥æŠ¥æ–‡è¢«å¹¿æ’­åˆ°åŒä¸€ä¸ªå­ç½‘çš„æ‰€æœ‰ä¸»æœºä¸Šã€‚</li><li>DHCP æœåŠ¡å™¨æ”¶åˆ° Discover æŠ¥æ–‡ä¹‹åï¼Œå‘é€ Offer æŠ¥æ–‡ç»™å®¢æˆ·ç«¯ï¼Œè¯¥æŠ¥æ–‡åŒ…å«äº†å®¢æˆ·ç«¯æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚å› ä¸ºå®¢æˆ·ç«¯å¯èƒ½æ”¶åˆ°å¤šä¸ª DHCP æœåŠ¡å™¨æä¾›çš„ä¿¡æ¯ï¼Œå› æ­¤å®¢æˆ·ç«¯éœ€è¦è¿›è¡Œé€‰æ‹©ã€‚</li><li>å¦‚æœå®¢æˆ·ç«¯é€‰æ‹©äº†æŸä¸ª DHCP æœåŠ¡å™¨æä¾›çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å‘é€ Request æŠ¥æ–‡ç»™è¯¥ DHCP æœåŠ¡å™¨ã€‚</li><li>DHCP æœåŠ¡å™¨å‘é€ Ack æŠ¥æ–‡ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯æ­¤æ—¶å¯ä»¥ä½¿ç”¨æä¾›ç»™å®ƒçš„ä¿¡æ¯ã€‚</li></ol><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045445.jpg"> </div><br></p><p>å¦‚æœå®¢æˆ·ç«¯å’Œ DHCP æœåŠ¡å™¨ä¸åœ¨åŒä¸€ä¸ªå­ç½‘ï¼Œå°±éœ€è¦ä½¿ç”¨ä¸­ç»§ä»£ç†ã€‚</p><h2 id="å¸¸ç”¨ç«¯å£"><a href="#å¸¸ç”¨ç«¯å£" class="headerlink" title="å¸¸ç”¨ç«¯å£"></a>å¸¸ç”¨ç«¯å£</h2><table><thead><tr><th style="text-align:center">åº”ç”¨</th><th style="text-align:center">åº”ç”¨å±‚åè®®</th><th style="text-align:center">ç«¯å£å·</th><th style="text-align:center">è¿è¾“å±‚åè®®</th><th style="text-align:center">å¤‡æ³¨</th></tr></thead><tbody><tr><td style="text-align:center">åŸŸåè§£æ</td><td style="text-align:center">DNS</td><td style="text-align:center">53</td><td style="text-align:center">UDP/TCP</td><td style="text-align:center">é•¿åº¦è¶…è¿‡ 512 å­—èŠ‚æ—¶ä½¿ç”¨ TCP</td></tr><tr><td style="text-align:center">åŠ¨æ€ä¸»æœºé…ç½®åè®®</td><td style="text-align:center">DHCP</td><td style="text-align:center">67/68</td><td style="text-align:center">UDP</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">ç®€å•ç½‘ç»œç®¡ç†åè®®</td><td style="text-align:center">SNMP</td><td style="text-align:center">161/162</td><td style="text-align:center">UDP</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">æ–‡ä»¶ä¼ é€åè®®</td><td style="text-align:center">FTP</td><td style="text-align:center">20/21</td><td style="text-align:center">TCP</td><td style="text-align:center">æ§åˆ¶è¿æ¥ 21ï¼Œæ•°æ®è¿æ¥ 20</td></tr><tr><td style="text-align:center">è¿œç¨‹ç»ˆç«¯åè®®</td><td style="text-align:center">TELNET</td><td style="text-align:center">23</td><td style="text-align:center">TCP</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">è¶…æ–‡æœ¬ä¼ é€åè®®</td><td style="text-align:center">HTTP</td><td style="text-align:center">80</td><td style="text-align:center">TCP</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">ç®€å•é‚®ä»¶ä¼ é€åè®®</td><td style="text-align:center">SMTP</td><td style="text-align:center">25</td><td style="text-align:center">TCP</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">é‚®ä»¶è¯»å–åè®®</td><td style="text-align:center">POP3</td><td style="text-align:center">110</td><td style="text-align:center">TCP</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">ç½‘é™…æŠ¥æ–‡å­˜å–åè®®</td><td style="text-align:center">IMAP</td><td style="text-align:center">143</td><td style="text-align:center">TCP</td></tr></tbody></table><h2 id="Web-é¡µé¢è¯·æ±‚è¿‡ç¨‹"><a href="#Web-é¡µé¢è¯·æ±‚è¿‡ç¨‹" class="headerlink" title="Web é¡µé¢è¯·æ±‚è¿‡ç¨‹"></a>Web é¡µé¢è¯·æ±‚è¿‡ç¨‹</h2><h3 id="1-DHCP-é…ç½®ä¸»æœºä¿¡æ¯"><a href="#1-DHCP-é…ç½®ä¸»æœºä¿¡æ¯" class="headerlink" title="1. DHCP é…ç½®ä¸»æœºä¿¡æ¯"></a>1. DHCP é…ç½®ä¸»æœºä¿¡æ¯</h3><ul><li><p>å‡è®¾ä¸»æœºæœ€å¼€å§‹æ²¡æœ‰ IP åœ°å€ä»¥åŠå…¶å®ƒä¿¡æ¯ï¼Œé‚£ä¹ˆå°±éœ€è¦å…ˆä½¿ç”¨ DHCP æ¥è·å–ã€‚</p></li><li><p>ä¸»æœºç”Ÿæˆä¸€ä¸ª DHCP è¯·æ±‚æŠ¥æ–‡ï¼Œå¹¶å°†è¿™ä¸ªæŠ¥æ–‡æ”¾å…¥å…·æœ‰ç›®çš„ç«¯å£ 67 å’Œæºç«¯å£ 68 çš„ UDP æŠ¥æ–‡æ®µä¸­ã€‚</p></li><li><p>è¯¥æŠ¥æ–‡æ®µåˆ™è¢«æ”¾å…¥åœ¨ä¸€ä¸ªå…·æœ‰å¹¿æ’­ IP ç›®çš„åœ°å€(255.255.255.255) å’Œæº IP åœ°å€ï¼ˆ0.0.0.0ï¼‰çš„ IP æ•°æ®æŠ¥ä¸­ã€‚</p></li><li><p>è¯¥æ•°æ®æŠ¥åˆ™è¢«æ”¾ç½®åœ¨ MAC å¸§ä¸­ï¼Œè¯¥å¸§å…·æœ‰ç›®çš„åœ°å€ FF:FF:FF:FF:FF:FFï¼Œå°†å¹¿æ’­åˆ°ä¸äº¤æ¢æœºè¿æ¥çš„æ‰€æœ‰è®¾å¤‡ã€‚</p></li><li><p>è¿æ¥åœ¨äº¤æ¢æœºçš„ DHCP æœåŠ¡å™¨æ”¶åˆ°å¹¿æ’­å¸§ä¹‹åï¼Œä¸æ–­åœ°å‘ä¸Šåˆ†è§£å¾—åˆ° IP æ•°æ®æŠ¥ã€UDP æŠ¥æ–‡æ®µã€DHCP è¯·æ±‚æŠ¥æ–‡ï¼Œä¹‹åç”Ÿæˆ DHCP ACK æŠ¥æ–‡ï¼Œè¯¥æŠ¥æ–‡åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šIP åœ°å€ã€DNS æœåŠ¡å™¨çš„ IP åœ°å€ã€é»˜è®¤ç½‘å…³è·¯ç”±å™¨çš„ IP åœ°å€å’Œå­ç½‘æ©ç ã€‚è¯¥æŠ¥æ–‡è¢«æ”¾å…¥ UDP æŠ¥æ–‡æ®µä¸­ï¼ŒUDP æŠ¥æ–‡æ®µæœ‰è¢«æ”¾å…¥ IP æ•°æ®æŠ¥ä¸­ï¼Œæœ€åæ”¾å…¥ MAC å¸§ä¸­ã€‚</p></li><li><p>è¯¥å¸§çš„ç›®çš„åœ°å€æ˜¯è¯·æ±‚ä¸»æœºçš„ MAC åœ°å€ï¼Œå› ä¸ºäº¤æ¢æœºå…·æœ‰è‡ªå­¦ä¹ èƒ½åŠ›ï¼Œä¹‹å‰ä¸»æœºå‘é€äº†å¹¿æ’­å¸§ä¹‹åå°±è®°å½•äº† MAC åœ°å€åˆ°å…¶è½¬å‘æ¥å£çš„äº¤æ¢è¡¨é¡¹ï¼Œå› æ­¤ç°åœ¨äº¤æ¢æœºå°±å¯ä»¥ç›´æ¥çŸ¥é“åº”è¯¥å‘å“ªä¸ªæ¥å£å‘é€è¯¥å¸§ã€‚</p></li><li><p>ä¸»æœºæ”¶åˆ°è¯¥å¸§åï¼Œä¸æ–­åˆ†è§£å¾—åˆ° DHCP æŠ¥æ–‡ã€‚ä¹‹åå°±é…ç½®å®ƒçš„ IP åœ°å€ã€å­ç½‘æ©ç å’Œ DNS æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œå¹¶åœ¨å…¶ IP è½¬å‘è¡¨ä¸­å®‰è£…é»˜è®¤ç½‘å…³ã€‚</p></li></ul><h3 id="2-ARP-è§£æ-MAC-åœ°å€"><a href="#2-ARP-è§£æ-MAC-åœ°å€" class="headerlink" title="2. ARP è§£æ MAC åœ°å€"></a>2. ARP è§£æ MAC åœ°å€</h3><ul><li><p>ä¸»æœºé€šè¿‡æµè§ˆå™¨ç”Ÿæˆä¸€ä¸ª TCP å¥—æ¥å­—ï¼Œå¥—æ¥å­—å‘ HTTP æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚ã€‚ä¸ºäº†ç”Ÿæˆè¯¥å¥—æ¥å­—ï¼Œä¸»æœºéœ€è¦çŸ¥é“ç½‘ç«™çš„åŸŸåå¯¹åº”çš„ IP åœ°å€ã€‚</p></li><li><p>ä¸»æœºç”Ÿæˆä¸€ä¸ª DNS æŸ¥è¯¢æŠ¥æ–‡ï¼Œè¯¥æŠ¥æ–‡å…·æœ‰ 53 å·ç«¯å£ï¼Œå› ä¸º DNS æœåŠ¡å™¨çš„ç«¯å£å·æ˜¯ 53ã€‚</p></li><li><p>è¯¥ DNS æŸ¥è¯¢æŠ¥æ–‡è¢«æ”¾å…¥ç›®çš„åœ°å€ä¸º DNS æœåŠ¡å™¨ IP åœ°å€çš„ IP æ•°æ®æŠ¥ä¸­ã€‚</p></li><li><p>è¯¥ IP æ•°æ®æŠ¥è¢«æ”¾å…¥ä¸€ä¸ªä»¥å¤ªç½‘å¸§ä¸­ï¼Œè¯¥å¸§å°†å‘é€åˆ°ç½‘å…³è·¯ç”±å™¨ã€‚</p></li><li><p>DHCP è¿‡ç¨‹åªçŸ¥é“ç½‘å…³è·¯ç”±å™¨çš„ IP åœ°å€ï¼Œä¸ºäº†è·å–ç½‘å…³è·¯ç”±å™¨çš„ MAC åœ°å€ï¼Œéœ€è¦ä½¿ç”¨ ARP åè®®ã€‚</p></li><li><p>ä¸»æœºç”Ÿæˆä¸€ä¸ªåŒ…å«ç›®çš„åœ°å€ä¸ºç½‘å…³è·¯ç”±å™¨ IP åœ°å€çš„ ARP æŸ¥è¯¢æŠ¥æ–‡ï¼Œå°†è¯¥ ARP æŸ¥è¯¢æŠ¥æ–‡æ”¾å…¥ä¸€ä¸ªå…·æœ‰å¹¿æ’­ç›®çš„åœ°å€ï¼ˆFF:FF:FF:FF:FF:FFï¼‰çš„ä»¥å¤ªç½‘å¸§ä¸­ï¼Œå¹¶å‘äº¤æ¢æœºå‘é€è¯¥ä»¥å¤ªç½‘å¸§ï¼Œäº¤æ¢æœºå°†è¯¥å¸§è½¬å‘ç»™æ‰€æœ‰çš„è¿æ¥è®¾å¤‡ï¼ŒåŒ…æ‹¬ç½‘å…³è·¯ç”±å™¨ã€‚</p></li><li><p>ç½‘å…³è·¯ç”±å™¨æ¥æ”¶åˆ°è¯¥å¸§åï¼Œä¸æ–­å‘ä¸Šåˆ†è§£å¾—åˆ° ARP æŠ¥æ–‡ï¼Œå‘ç°å…¶ä¸­çš„ IP åœ°å€ä¸å…¶æ¥å£çš„ IP åœ°å€åŒ¹é…ï¼Œå› æ­¤å°±å‘é€ä¸€ä¸ª ARP å›ç­”æŠ¥æ–‡ï¼ŒåŒ…å«äº†å®ƒçš„ MAC åœ°å€ï¼Œå‘å›ç»™ä¸»æœºã€‚</p></li></ul><h3 id="3-DNS-è§£æåŸŸå"><a href="#3-DNS-è§£æåŸŸå" class="headerlink" title="3. DNS è§£æåŸŸå"></a>3. DNS è§£æåŸŸå</h3><ul><li><p>çŸ¥é“äº†ç½‘å…³è·¯ç”±å™¨çš„ MAC åœ°å€ä¹‹åï¼Œå°±å¯ä»¥ç»§ç»­ DNS çš„è§£æè¿‡ç¨‹äº†ã€‚</p></li><li><p>ç½‘å…³è·¯ç”±å™¨æ¥æ”¶åˆ°åŒ…å« DNS æŸ¥è¯¢æŠ¥æ–‡çš„ä»¥å¤ªç½‘å¸§åï¼ŒæŠ½å–å‡º IP æ•°æ®æŠ¥ï¼Œå¹¶æ ¹æ®è½¬å‘è¡¨å†³å®šè¯¥ IP æ•°æ®æŠ¥åº”è¯¥è½¬å‘çš„è·¯ç”±å™¨ã€‚</p></li><li><p>å› ä¸ºè·¯ç”±å™¨å…·æœ‰å†…éƒ¨ç½‘å…³åè®®ï¼ˆRIPã€OSPFï¼‰å’Œå¤–éƒ¨ç½‘å…³åè®®ï¼ˆBGPï¼‰è¿™ä¸¤ç§è·¯ç”±é€‰æ‹©åè®®ï¼Œå› æ­¤è·¯ç”±è¡¨ä¸­å·²ç»é…ç½®äº†ç½‘å…³è·¯ç”±å™¨åˆ°è¾¾ DNS æœåŠ¡å™¨çš„è·¯ç”±è¡¨é¡¹ã€‚</p></li><li><p>åˆ°è¾¾ DNS æœåŠ¡å™¨ä¹‹åï¼ŒDNS æœåŠ¡å™¨æŠ½å–å‡º DNS æŸ¥è¯¢æŠ¥æ–‡ï¼Œå¹¶åœ¨ DNS æ•°æ®åº“ä¸­æŸ¥æ‰¾å¾…è§£æçš„åŸŸåã€‚</p></li><li><p>æ‰¾åˆ° DNS è®°å½•ä¹‹åï¼Œå‘é€ DNS å›ç­”æŠ¥æ–‡ï¼Œå°†è¯¥å›ç­”æŠ¥æ–‡æ”¾å…¥ UDP æŠ¥æ–‡æ®µä¸­ï¼Œç„¶åæ”¾å…¥ IP æ•°æ®æŠ¥ä¸­ï¼Œé€šè¿‡è·¯ç”±å™¨åå‘è½¬å‘å›ç½‘å…³è·¯ç”±å™¨ï¼Œå¹¶ç»è¿‡ä»¥å¤ªç½‘äº¤æ¢æœºåˆ°è¾¾ä¸»æœºã€‚</p></li></ul><h3 id="4-HTTP-è¯·æ±‚é¡µé¢"><a href="#4-HTTP-è¯·æ±‚é¡µé¢" class="headerlink" title="4. HTTP è¯·æ±‚é¡µé¢"></a>4. HTTP è¯·æ±‚é¡µé¢</h3><ul><li><p>æœ‰äº† HTTP æœåŠ¡å™¨çš„ IP åœ°å€ä¹‹åï¼Œä¸»æœºå°±èƒ½å¤Ÿç”Ÿæˆ TCP å¥—æ¥å­—ï¼Œè¯¥å¥—æ¥å­—å°†ç”¨äºå‘ Web æœåŠ¡å™¨å‘é€ HTTP GET æŠ¥æ–‡ã€‚</p></li><li><p>åœ¨ç”Ÿæˆ TCP å¥—æ¥å­—ä¹‹å‰ï¼Œå¿…é¡»å…ˆä¸ HTTP æœåŠ¡å™¨è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹æ¥å»ºç«‹è¿æ¥ã€‚ç”Ÿæˆä¸€ä¸ªå…·æœ‰ç›®çš„ç«¯å£ 80 çš„ TCP SYN æŠ¥æ–‡æ®µï¼Œå¹¶å‘ HTTP æœåŠ¡å™¨å‘é€è¯¥æŠ¥æ–‡æ®µã€‚</p></li><li><p>HTTP æœåŠ¡å™¨æ”¶åˆ°è¯¥æŠ¥æ–‡æ®µä¹‹åï¼Œç”Ÿæˆ TCP SYN ACK æŠ¥æ–‡æ®µï¼Œå‘å›ç»™ä¸»æœºã€‚</p></li><li><p>è¿æ¥å»ºç«‹ä¹‹åï¼Œæµè§ˆå™¨ç”Ÿæˆ HTTP GET æŠ¥æ–‡ï¼Œå¹¶äº¤ä»˜ç»™ HTTP æœåŠ¡å™¨ã€‚</p></li><li><p>HTTP æœåŠ¡å™¨ä» TCP å¥—æ¥å­—è¯»å– HTTP GET æŠ¥æ–‡ï¼Œç”Ÿæˆä¸€ä¸ª HTTP å“åº”æŠ¥æ–‡ï¼Œå°† Web é¡µé¢å†…å®¹æ”¾å…¥æŠ¥æ–‡ä¸»ä½“ä¸­ï¼Œå‘å›ç»™ä¸»æœºã€‚</p></li><li><p>æµè§ˆå™¨æ”¶åˆ° HTTP å“åº”æŠ¥æ–‡åï¼ŒæŠ½å–å‡º Web é¡µé¢å†…å®¹ï¼Œä¹‹åè¿›è¡Œæ¸²æŸ“ï¼Œæ˜¾ç¤º Web é¡µé¢ã€‚</p></li></ul><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>è®¡ç®—æœºç½‘ç»œ, è°¢å¸Œä»</li><li>JamesF.Kurose, KeithW.Ross, åº“ç½—æ–¯, ç­‰. è®¡ç®—æœºç½‘ç»œ: è‡ªé¡¶å‘ä¸‹æ–¹æ³• [M]. æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾, 2014.</li><li>W.RichardStevens. TCP/IP è¯¦è§£. å· 1, åè®® [M]. æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾, 2006.</li><li><a href="https://securitywing.com/active-vs-passive-ftp-mode/" target="_blank" rel="noopener">Active vs Passive FTP Mode: Which One is More Secure?</a></li><li><a href="http://www.serv-u.com/kb/1138/active-and-passive-ftp-transfers-defined" target="_blank" rel="noopener">Active and Passive FTP Transfers Defined  -  KB Article #1138</a></li><li><a href="http://webcache.googleusercontent.com/search?q=cache:http://anandgiria.blogspot.com/2013/09/windows-dhcp-interview-questions-and.html" target="_blank" rel="noopener">How DHCP works and DHCP Interview Questions and Answers</a></li><li><a href="https://www.quora.com/What-is-process-of-DORA-in-DHCP" target="_blank" rel="noopener">What is process of DORA in DHCP?</a></li><li><a href="https://tecadmin.net/what-is-dhcp-server/" target="_blank" rel="noopener">What is DHCP Server ?</a></li><li><a href="http://www.climatechangenews.com/2011/html/university-tokyo.html" target="_blank" rel="noopener">Tackling emissions targets in Tokyo</a></li><li><a href="http://www.climatechangenews.com/2011/html/university-tokyo.html" target="_blank" rel="noopener">What does my ISP know when I use Tor?</a></li><li><a href="http://www.linyibin.cn/2017/02/12/technology-ComputerNetworking-Internet/" target="_blank" rel="noopener">Technology-Computer Networking[1]-Computer Networks and the Internet</a></li><li><a href="http://slidesplayer.com/slide/11616167/" target="_blank" rel="noopener">P2P ç½‘ç»œæ¦‚è¿°.</a></li><li><a href="http://slideplayer.com/slide/5115386/" target="_blank" rel="noopener">Circuit Switching (a) Circuit switching. (b) Packet switching.</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- GFM-TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸€æ¦‚è¿°&quot;&gt;ä¸€ã€æ¦‚è¿°&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ç½‘ç»œçš„ç½‘ç»œ&quot;&gt;ç½‘ç»œçš„ç½‘ç»œ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#isp&quot;&gt;ISP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸»æœºä¹‹é—´
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Interview-Notebook" scheme="https://airpoet.github.io/categories/Github/Interview-Notebook/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>è®¡ç®—æœºæ“ä½œç³»ç»Ÿ</title>
    <link href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    <id>https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ/</id>
    <published>2018-07-04T13:51:06.363Z</published>
    <updated>2018-07-09T07:04:09.171Z</updated>
    
    <content type="html"><![CDATA[<!-- GFM-TOC --><ul><li><a href="#ä¸€æ¦‚è¿°">ä¸€ã€æ¦‚è¿°</a><ul><li><a href="#æ“ä½œç³»ç»ŸåŸºæœ¬ç‰¹å¾">æ“ä½œç³»ç»ŸåŸºæœ¬ç‰¹å¾</a></li><li><a href="#æ“ä½œç³»ç»ŸåŸºæœ¬åŠŸèƒ½">æ“ä½œç³»ç»ŸåŸºæœ¬åŠŸèƒ½</a></li><li><a href="#ç³»ç»Ÿè°ƒç”¨">ç³»ç»Ÿè°ƒç”¨</a></li><li><a href="#å¤§å†…æ ¸å’Œå¾®å†…æ ¸">å¤§å†…æ ¸å’Œå¾®å†…æ ¸</a></li><li><a href="#ä¸­æ–­åˆ†ç±»">ä¸­æ–­åˆ†ç±»</a></li></ul></li><li><a href="#äºŒè¿›ç¨‹ç®¡ç†">äºŒã€è¿›ç¨‹ç®¡ç†</a><ul><li><a href="#è¿›ç¨‹ä¸çº¿ç¨‹">è¿›ç¨‹ä¸çº¿ç¨‹</a></li><li><a href="#è¿›ç¨‹çŠ¶æ€çš„åˆ‡æ¢">è¿›ç¨‹çŠ¶æ€çš„åˆ‡æ¢</a></li><li><a href="#è¿›ç¨‹è°ƒåº¦ç®—æ³•">è¿›ç¨‹è°ƒåº¦ç®—æ³•</a></li><li><a href="#è¿›ç¨‹åŒæ­¥">è¿›ç¨‹åŒæ­¥</a></li><li><a href="#ç»å…¸åŒæ­¥é—®é¢˜">ç»å…¸åŒæ­¥é—®é¢˜</a></li><li><a href="#è¿›ç¨‹é€šä¿¡">è¿›ç¨‹é€šä¿¡</a></li></ul></li><li><a href="#ä¸‰æ­»é”">ä¸‰ã€æ­»é”</a><ul><li><a href="#æ­»é”çš„å¿…è¦æ¡ä»¶">æ­»é”çš„å¿…è¦æ¡ä»¶</a></li><li><a href="#æ­»é”çš„å¤„ç†æ–¹æ³•">æ­»é”çš„å¤„ç†æ–¹æ³•</a></li></ul></li><li><a href="#å››å†…å­˜ç®¡ç†">å››ã€å†…å­˜ç®¡ç†</a><ul><li><a href="#è™šæ‹Ÿå†…å­˜">è™šæ‹Ÿå†…å­˜</a></li><li><a href="#åˆ†é¡µç³»ç»Ÿåœ°å€æ˜ å°„">åˆ†é¡µç³»ç»Ÿåœ°å€æ˜ å°„</a></li><li><a href="#é¡µé¢ç½®æ¢ç®—æ³•">é¡µé¢ç½®æ¢ç®—æ³•</a></li><li><a href="#åˆ†æ®µ">åˆ†æ®µ</a></li><li><a href="#æ®µé¡µå¼">æ®µé¡µå¼</a></li><li><a href="#åˆ†é¡µä¸åˆ†æ®µçš„æ¯”è¾ƒ">åˆ†é¡µä¸åˆ†æ®µçš„æ¯”è¾ƒ</a></li></ul></li><li><a href="#äº”è®¾å¤‡ç®¡ç†">äº”ã€è®¾å¤‡ç®¡ç†</a><ul><li><a href="#ç£ç›˜è°ƒåº¦ç®—æ³•">ç£ç›˜è°ƒåº¦ç®—æ³•</a></li></ul></li><li><a href="#å…­é“¾æ¥">å…­ã€é“¾æ¥</a><ul><li><a href="#ç¼–è¯‘ç³»ç»Ÿ">ç¼–è¯‘ç³»ç»Ÿ</a></li><li><a href="#é™æ€é“¾æ¥">é™æ€é“¾æ¥</a></li><li><a href="#ç›®æ ‡æ–‡ä»¶">ç›®æ ‡æ–‡ä»¶</a></li><li><a href="#åŠ¨æ€é“¾æ¥">åŠ¨æ€é“¾æ¥</a></li></ul></li><li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a><!-- GFM-TOC --></li></ul><h1 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h1><h2 id="æ“ä½œç³»ç»ŸåŸºæœ¬ç‰¹å¾"><a href="#æ“ä½œç³»ç»ŸåŸºæœ¬ç‰¹å¾" class="headerlink" title="æ“ä½œç³»ç»ŸåŸºæœ¬ç‰¹å¾"></a>æ“ä½œç³»ç»ŸåŸºæœ¬ç‰¹å¾</h2><h3 id="1-å¹¶å‘"><a href="#1-å¹¶å‘" class="headerlink" title="1. å¹¶å‘"></a>1. å¹¶å‘</h3><p>å¹¶å‘æ˜¯æŒ‡å®è§‚ä¸Šåœ¨ä¸€æ®µæ—¶é—´å†…èƒ½åŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºï¼Œè€Œå¹¶è¡Œåˆ™æŒ‡åŒä¸€æ—¶åˆ»èƒ½è¿è¡Œå¤šä¸ªæŒ‡ä»¤ã€‚</p><p>å¹¶è¡Œéœ€è¦ç¡¬ä»¶æ”¯æŒï¼Œå¦‚å¤šæµæ°´çº¿æˆ–è€…å¤šå¤„ç†å™¨ã€‚</p><p>æ“ä½œç³»ç»Ÿé€šè¿‡å¼•å…¥è¿›ç¨‹å’Œçº¿ç¨‹ï¼Œä½¿å¾—ç¨‹åºèƒ½å¤Ÿå¹¶å‘è¿è¡Œã€‚</p><h3 id="2-å…±äº«"><a href="#2-å…±äº«" class="headerlink" title="2. å…±äº«"></a>2. å…±äº«</h3><p>å…±äº«æ˜¯æŒ‡ç³»ç»Ÿä¸­çš„èµ„æºå¯ä»¥è¢«å¤šä¸ªå¹¶å‘è¿›ç¨‹å…±åŒä½¿ç”¨ã€‚</p><p>æœ‰ä¸¤ç§å…±äº«æ–¹å¼ï¼šäº’æ–¥å…±äº«å’ŒåŒæ—¶å…±äº«ã€‚</p><p>äº’æ–¥å…±äº«çš„èµ„æºç§°ä¸ºä¸´ç•Œèµ„æºï¼Œä¾‹å¦‚æ‰“å°æœºç­‰ï¼Œåœ¨åŒä¸€æ—¶é—´åªå…è®¸ä¸€ä¸ªè¿›ç¨‹è®¿é—®ï¼Œéœ€è¦ç”¨åŒæ­¥æœºåˆ¶æ¥å®ç°å¯¹ä¸´ç•Œèµ„æºçš„è®¿é—®ã€‚</p><h3 id="3-è™šæ‹Ÿ"><a href="#3-è™šæ‹Ÿ" class="headerlink" title="3. è™šæ‹Ÿ"></a>3. è™šæ‹Ÿ</h3><p>è™šæ‹ŸæŠ€æœ¯æŠŠä¸€ä¸ªç‰©ç†å®ä½“è½¬æ¢ä¸ºå¤šä¸ªé€»è¾‘å®ä½“ã€‚</p><p>ä¸»è¦æœ‰ä¸¤ç§è™šæ‹ŸæŠ€æœ¯ï¼šæ—¶åˆ†å¤ç”¨æŠ€æœ¯å’Œç©ºåˆ†å¤ç”¨æŠ€æœ¯ã€‚ä¾‹å¦‚å¤šä¸ªè¿›ç¨‹èƒ½åœ¨åŒä¸€ä¸ªå¤„ç†å™¨ä¸Šå¹¶å‘æ‰§è¡Œä½¿ç”¨äº†æ—¶åˆ†å¤ç”¨æŠ€æœ¯ï¼Œè®©æ¯ä¸ªè¿›ç¨‹è½®æµå æœ‰å¤„ç†å™¨ï¼Œæ¯æ¬¡åªæ‰§è¡Œä¸€å°ä¸ªæ—¶é—´ç‰‡å¹¶å¿«é€Ÿåˆ‡æ¢ã€‚</p><h3 id="4-å¼‚æ­¥"><a href="#4-å¼‚æ­¥" class="headerlink" title="4. å¼‚æ­¥"></a>4. å¼‚æ­¥</h3><p>å¼‚æ­¥æŒ‡è¿›ç¨‹ä¸æ˜¯ä¸€æ¬¡æ€§æ‰§è¡Œå®Œæ¯•ï¼Œè€Œæ˜¯èµ°èµ°åœåœï¼Œä»¥ä¸å¯çŸ¥çš„é€Ÿåº¦å‘å‰æ¨è¿›ã€‚</p><h2 id="æ“ä½œç³»ç»ŸåŸºæœ¬åŠŸèƒ½"><a href="#æ“ä½œç³»ç»ŸåŸºæœ¬åŠŸèƒ½" class="headerlink" title="æ“ä½œç³»ç»ŸåŸºæœ¬åŠŸèƒ½"></a>æ“ä½œç³»ç»ŸåŸºæœ¬åŠŸèƒ½</h2><h3 id="1-è¿›ç¨‹ç®¡ç†"><a href="#1-è¿›ç¨‹ç®¡ç†" class="headerlink" title="1. è¿›ç¨‹ç®¡ç†"></a>1. è¿›ç¨‹ç®¡ç†</h3><p>è¿›ç¨‹æ§åˆ¶ã€è¿›ç¨‹åŒæ­¥ã€è¿›ç¨‹é€šä¿¡ã€æ­»é”å¤„ç†ã€å¤„ç†æœºè°ƒåº¦ç­‰ã€‚</p><h3 id="2-å†…å­˜ç®¡ç†"><a href="#2-å†…å­˜ç®¡ç†" class="headerlink" title="2. å†…å­˜ç®¡ç†"></a>2. å†…å­˜ç®¡ç†</h3><p>å†…å­˜åˆ†é…ã€åœ°å€æ˜ å°„ã€å†…å­˜ä¿æŠ¤ä¸å…±äº«ã€è™šæ‹Ÿå†…å­˜ç­‰ã€‚</p><h3 id="3-æ–‡ä»¶ç®¡ç†"><a href="#3-æ–‡ä»¶ç®¡ç†" class="headerlink" title="3. æ–‡ä»¶ç®¡ç†"></a>3. æ–‡ä»¶ç®¡ç†</h3><p>æ–‡ä»¶å­˜å‚¨ç©ºé—´çš„ç®¡ç†ã€ç›®å½•ç®¡ç†ã€æ–‡ä»¶è¯»å†™ç®¡ç†å’Œä¿æŠ¤ç­‰ã€‚</p><h3 id="4-è®¾å¤‡ç®¡ç†"><a href="#4-è®¾å¤‡ç®¡ç†" class="headerlink" title="4. è®¾å¤‡ç®¡ç†"></a>4. è®¾å¤‡ç®¡ç†</h3><p>å®Œæˆç”¨æˆ·çš„ I/O è¯·æ±‚ï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨å„ç§è®¾å¤‡ï¼Œå¹¶æé«˜è®¾å¤‡çš„åˆ©ç”¨ç‡ã€‚</p><p>ä¸»è¦åŒ…æ‹¬ç¼“å†²ç®¡ç†ã€è®¾å¤‡åˆ†é…ã€è®¾å¤‡å¤„ç†ã€è™›æ‹Ÿè®¾å¤‡ç­‰ã€‚</p><h2 id="ç³»ç»Ÿè°ƒç”¨"><a href="#ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨"></a>ç³»ç»Ÿè°ƒç”¨</h2><p>å¦‚æœä¸€ä¸ªè¿›ç¨‹åœ¨ç”¨æˆ·æ€éœ€è¦ä½¿ç”¨å†…æ ¸æ€çš„åŠŸèƒ½ï¼Œå°±è¿›è¡Œç³»ç»Ÿè°ƒç”¨ä»è€Œé™·å…¥å†…æ ¸ï¼Œç”±æ“ä½œç³»ç»Ÿä»£ä¸ºå®Œæˆã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044749.png" width="600"> </div><br></p><p>Linux çš„ç³»ç»Ÿè°ƒç”¨ä¸»è¦æœ‰ä»¥ä¸‹è¿™äº›ï¼š</p><table><thead><tr><th style="text-align:center">Task</th><th>Commands</th></tr></thead><tbody><tr><td style="text-align:center">è¿›ç¨‹æ§åˆ¶</td><td>fork(); exit(); wait();</td></tr><tr><td style="text-align:center">è¿›ç¨‹é€šä¿¡</td><td>pipe(); shmget(); mmap();</td></tr><tr><td style="text-align:center">æ–‡ä»¶æ“ä½œ</td><td>open(); read(); write();</td></tr><tr><td style="text-align:center">è®¾å¤‡æ“ä½œ</td><td>ioctl(); read(); write();</td></tr><tr><td style="text-align:center">ä¿¡æ¯ç»´æŠ¤</td><td>getpid(); alarm(); sleep();</td></tr><tr><td style="text-align:center">å®‰å…¨</td><td>chmod(); umask(); chown();</td></tr></tbody></table><h2 id="å¤§å†…æ ¸å’Œå¾®å†…æ ¸"><a href="#å¤§å†…æ ¸å’Œå¾®å†…æ ¸" class="headerlink" title="å¤§å†…æ ¸å’Œå¾®å†…æ ¸"></a>å¤§å†…æ ¸å’Œå¾®å†…æ ¸</h2><h3 id="1-å¤§å†…æ ¸"><a href="#1-å¤§å†…æ ¸" class="headerlink" title="1. å¤§å†…æ ¸"></a>1. å¤§å†…æ ¸</h3><p>å¤§å†…æ ¸æ˜¯å°†æ“ä½œç³»ç»ŸåŠŸèƒ½ä½œä¸ºä¸€ä¸ªç´§å¯†ç»“åˆçš„æ•´ä½“æ”¾åˆ°å†…æ ¸ã€‚</p><p>ç”±äºå„æ¨¡å—å…±äº«ä¿¡æ¯ï¼Œå› æ­¤æœ‰å¾ˆé«˜çš„æ€§èƒ½ã€‚</p><h3 id="2-å¾®å†…æ ¸"><a href="#2-å¾®å†…æ ¸" class="headerlink" title="2. å¾®å†…æ ¸"></a>2. å¾®å†…æ ¸</h3><p>ç”±äºæ“ä½œç³»ç»Ÿä¸æ–­å¤æ‚ï¼Œå› æ­¤å°†ä¸€éƒ¨åˆ†æ“ä½œç³»ç»ŸåŠŸèƒ½ç§»å‡ºå†…æ ¸ï¼Œä»è€Œé™ä½å†…æ ¸çš„å¤æ‚æ€§ã€‚ç§»å‡ºçš„éƒ¨åˆ†æ ¹æ®åˆ†å±‚çš„åŸåˆ™åˆ’åˆ†æˆè‹¥å¹²æœåŠ¡ï¼Œç›¸äº’ç‹¬ç«‹ã€‚</p><p>åœ¨å¾®å†…æ ¸ç»“æ„ä¸‹ï¼Œæ“ä½œç³»ç»Ÿè¢«åˆ’åˆ†æˆå°çš„ã€å®šä¹‰è‰¯å¥½çš„æ¨¡å—ï¼Œåªæœ‰å¾®å†…æ ¸è¿™ä¸€ä¸ªæ¨¡å—è¿è¡Œåœ¨å†…æ ¸æ€ï¼Œå…¶ä½™æ¨¡å—è¿è¡Œåœ¨ç”¨æˆ·æ€ã€‚</p><p>å› ä¸ºéœ€è¦é¢‘ç¹åœ°åœ¨ç”¨æˆ·æ€å’Œæ ¸å¿ƒæ€ä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€å®šçš„æ€§èƒ½æŸå¤±ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044755.jpg"> </div><br></p><h2 id="ä¸­æ–­åˆ†ç±»"><a href="#ä¸­æ–­åˆ†ç±»" class="headerlink" title="ä¸­æ–­åˆ†ç±»"></a>ä¸­æ–­åˆ†ç±»</h2><h3 id="1-å¤–ä¸­æ–­"><a href="#1-å¤–ä¸­æ–­" class="headerlink" title="1. å¤–ä¸­æ–­"></a>1. å¤–ä¸­æ–­</h3><p>ç”± CPU æ‰§è¡ŒæŒ‡ä»¤ä»¥å¤–çš„äº‹ä»¶å¼•èµ·ï¼Œå¦‚ I/O å®Œæˆä¸­æ–­ï¼Œè¡¨ç¤ºè®¾å¤‡è¾“å…¥/è¾“å‡ºå¤„ç†å·²ç»å®Œæˆï¼Œå¤„ç†å™¨èƒ½å¤Ÿå‘é€ä¸‹ä¸€ä¸ªè¾“å…¥/è¾“å‡ºè¯·æ±‚ã€‚æ­¤å¤–è¿˜æœ‰æ—¶é’Ÿä¸­æ–­ã€æ§åˆ¶å°ä¸­æ–­ç­‰ã€‚</p><h3 id="2-å¼‚å¸¸"><a href="#2-å¼‚å¸¸" class="headerlink" title="2. å¼‚å¸¸"></a>2. å¼‚å¸¸</h3><p>ç”± CPU æ‰§è¡ŒæŒ‡ä»¤çš„å†…éƒ¨äº‹ä»¶å¼•èµ·ï¼Œå¦‚éæ³•æ“ä½œç ã€åœ°å€è¶Šç•Œã€ç®—æœ¯æº¢å‡ºç­‰ã€‚</p><h3 id="3-é™·å…¥"><a href="#3-é™·å…¥" class="headerlink" title="3. é™·å…¥"></a>3. é™·å…¥</h3><p>åœ¨ç”¨æˆ·ç¨‹åºä¸­ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚</p><h1 id="äºŒã€è¿›ç¨‹ç®¡ç†"><a href="#äºŒã€è¿›ç¨‹ç®¡ç†" class="headerlink" title="äºŒã€è¿›ç¨‹ç®¡ç†"></a>äºŒã€è¿›ç¨‹ç®¡ç†</h1><h2 id="è¿›ç¨‹ä¸çº¿ç¨‹"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹"></a>è¿›ç¨‹ä¸çº¿ç¨‹</h2><h3 id="1-è¿›ç¨‹"><a href="#1-è¿›ç¨‹" class="headerlink" title="1. è¿›ç¨‹"></a>1. è¿›ç¨‹</h3><p>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ã€‚</p><p>è¿›ç¨‹æ§åˆ¶å— (Process Control Block, PCB) æè¿°è¿›ç¨‹çš„åŸºæœ¬ä¿¡æ¯å’Œè¿è¡ŒçŠ¶æ€ï¼Œæ‰€è°“çš„åˆ›å»ºè¿›ç¨‹å’Œæ’¤é”€è¿›ç¨‹ï¼Œéƒ½æ˜¯æŒ‡å¯¹ PCB çš„æ“ä½œã€‚</p><p>ä¸‹å›¾æ˜¾ç¤ºäº† 4 ä¸ªç¨‹åºåˆ›å»ºäº† 4 ä¸ªè¿›ç¨‹ï¼Œè¿™ 4 ä¸ªè¿›ç¨‹å¯ä»¥å¹¶å‘åœ°æ‰§è¡Œã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044758.png"> </div><br></p><h3 id="2-çº¿ç¨‹"><a href="#2-çº¿ç¨‹" class="headerlink" title="2. çº¿ç¨‹"></a>2. çº¿ç¨‹</h3><p>çº¿ç¨‹æ˜¯ç‹¬ç«‹è°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚</p><p>ä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å…±äº«è¿›ç¨‹èµ„æºã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044800.png"> </div><br></p><h3 id="3-åŒºåˆ«"><a href="#3-åŒºåˆ«" class="headerlink" title="3. åŒºåˆ«"></a>3. åŒºåˆ«</h3><ul><li><p>æ‹¥æœ‰èµ„æºï¼šè¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œä½†æ˜¯çº¿ç¨‹ä¸æ‹¥æœ‰èµ„æºï¼Œçº¿ç¨‹å¯ä»¥è®¿é—®éš¶å±è¿›ç¨‹çš„èµ„æºã€‚</p></li><li><p>è°ƒåº¦ï¼šçº¿ç¨‹æ˜¯ç‹¬ç«‹è°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œåœ¨åŒä¸€è¿›ç¨‹ä¸­ï¼Œçº¿ç¨‹çš„åˆ‡æ¢ä¸ä¼šå¼•èµ·è¿›ç¨‹åˆ‡æ¢ï¼Œä»ä¸€ä¸ªè¿›ç¨‹å†…çš„çº¿ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹æ—¶ï¼Œä¼šå¼•èµ·è¿›ç¨‹åˆ‡æ¢ã€‚</p></li><li><p>ç³»ç»Ÿå¼€é”€ï¼šç”±äºåˆ›å»ºæˆ–æ’¤é”€è¿›ç¨‹æ—¶ï¼Œç³»ç»Ÿéƒ½è¦ä¸ºä¹‹åˆ†é…æˆ–å›æ”¶èµ„æºï¼Œå¦‚å†…å­˜ç©ºé—´ã€I/O è®¾å¤‡ç­‰ï¼Œæ‰€ä»˜å‡ºçš„å¼€é”€è¿œå¤§äºåˆ›å»ºæˆ–æ’¤é”€çº¿ç¨‹æ—¶çš„å¼€é”€ã€‚ç±»ä¼¼åœ°ï¼Œåœ¨è¿›è¡Œè¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œæ¶‰åŠå½“å‰æ‰§è¡Œè¿›ç¨‹ CPU ç¯å¢ƒçš„ä¿å­˜åŠæ–°è°ƒåº¦è¿›ç¨‹ CPU ç¯å¢ƒçš„è®¾ç½®ï¼Œè€Œçº¿ç¨‹åˆ‡æ¢æ—¶åªéœ€ä¿å­˜å’Œè®¾ç½®å°‘é‡å¯„å­˜å™¨å†…å®¹ï¼Œå¼€é”€å¾ˆå°ã€‚</p></li><li><p>é€šä¿¡æ–¹é¢ï¼šè¿›ç¨‹é—´é€šä¿¡ (IPC) éœ€è¦è¿›ç¨‹åŒæ­¥å’Œäº’æ–¥æ‰‹æ®µçš„è¾…åŠ©ï¼Œä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚è€Œçº¿ç¨‹é—´å¯ä»¥é€šè¿‡ç›´æ¥è¯»/å†™åŒä¸€è¿›ç¨‹ä¸­çš„æ•°æ®æ®µï¼ˆå¦‚å…¨å±€å˜é‡ï¼‰æ¥è¿›è¡Œé€šä¿¡ã€‚</p></li></ul><p>ä¸¾ä¾‹ï¼šQQ å’Œæµè§ˆå™¨æ˜¯ä¸¤ä¸ªè¿›ç¨‹ï¼Œæµè§ˆå™¨è¿›ç¨‹é‡Œé¢æœ‰å¾ˆå¤šçº¿ç¨‹ï¼Œä¾‹å¦‚ HTTP è¯·æ±‚çº¿ç¨‹ã€äº‹ä»¶å“åº”çº¿ç¨‹ã€æ¸²æŸ“çº¿ç¨‹ç­‰ç­‰ï¼Œçº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œä½¿å¾—åœ¨æµè§ˆå™¨ä¸­ç‚¹å‡»ä¸€ä¸ªæ–°é“¾æ¥ä»è€Œå‘èµ· HTTP è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨è¿˜å¯ä»¥å“åº”ç”¨æˆ·çš„å…¶å®ƒäº‹ä»¶ã€‚</p><h2 id="è¿›ç¨‹çŠ¶æ€çš„åˆ‡æ¢"><a href="#è¿›ç¨‹çŠ¶æ€çš„åˆ‡æ¢" class="headerlink" title="è¿›ç¨‹çŠ¶æ€çš„åˆ‡æ¢"></a>è¿›ç¨‹çŠ¶æ€çš„åˆ‡æ¢</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044806.png" width="500"> </div><br></p><ul><li>å°±ç»ªçŠ¶æ€ï¼ˆreadyï¼‰ï¼šç­‰å¾…è¢«è°ƒåº¦</li><li>è¿è¡ŒçŠ¶æ€ï¼ˆrunningï¼‰</li><li>é˜»å¡çŠ¶æ€ï¼ˆwaitingï¼‰ï¼šç­‰å¾…èµ„æº</li></ul><p>åº”è¯¥æ³¨æ„ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>åªæœ‰å°±ç»ªæ€å’Œè¿è¡Œæ€å¯ä»¥ç›¸äº’è½¬æ¢ï¼Œå…¶å®ƒçš„éƒ½æ˜¯å•å‘è½¬æ¢ã€‚å°±ç»ªçŠ¶æ€çš„è¿›ç¨‹é€šè¿‡è°ƒåº¦ç®—æ³•ä»è€Œè·å¾— CPU æ—¶é—´ï¼Œè½¬ä¸ºè¿è¡ŒçŠ¶æ€ï¼›è€Œè¿è¡ŒçŠ¶æ€çš„è¿›ç¨‹ï¼Œåœ¨åˆ†é…ç»™å®ƒçš„ CPU æ—¶é—´ç‰‡ç”¨å®Œä¹‹åå°±ä¼šè½¬ä¸ºå°±ç»ªçŠ¶æ€ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è°ƒåº¦ã€‚</li><li>é˜»å¡çŠ¶æ€æ˜¯ç¼ºå°‘éœ€è¦çš„èµ„æºä»è€Œç”±è¿è¡ŒçŠ¶æ€è½¬æ¢è€Œæ¥ï¼Œä½†æ˜¯è¯¥èµ„æºä¸åŒ…æ‹¬ CPU æ—¶é—´ï¼Œç¼ºå°‘ CPU æ—¶é—´ä¼šä»è¿è¡Œæ€è½¬æ¢ä¸ºå°±ç»ªæ€ã€‚</li></ul><h2 id="è¿›ç¨‹è°ƒåº¦ç®—æ³•"><a href="#è¿›ç¨‹è°ƒåº¦ç®—æ³•" class="headerlink" title="è¿›ç¨‹è°ƒåº¦ç®—æ³•"></a>è¿›ç¨‹è°ƒåº¦ç®—æ³•</h2><p>ä¸åŒç¯å¢ƒçš„è°ƒåº¦ç®—æ³•ç›®æ ‡ä¸åŒï¼Œå› æ­¤éœ€è¦é’ˆå¯¹ä¸åŒç¯å¢ƒæ¥è®¨è®ºè°ƒåº¦ç®—æ³•ã€‚</p><h3 id="1-æ‰¹å¤„ç†ç³»ç»Ÿ"><a href="#1-æ‰¹å¤„ç†ç³»ç»Ÿ" class="headerlink" title="1. æ‰¹å¤„ç†ç³»ç»Ÿ"></a>1. æ‰¹å¤„ç†ç³»ç»Ÿ</h3><p>æ‰¹å¤„ç†ç³»ç»Ÿæ²¡æœ‰å¤ªå¤šçš„ç”¨æˆ·æ“ä½œï¼Œåœ¨è¯¥ç³»ç»Ÿä¸­ï¼Œè°ƒåº¦ç®—æ³•ç›®æ ‡æ˜¯ä¿è¯ååé‡å’Œå‘¨è½¬æ—¶é—´ï¼ˆä»æäº¤åˆ°ç»ˆæ­¢çš„æ—¶é—´ï¼‰ã€‚</p><p><strong>1.1 å…ˆæ¥å…ˆæœåŠ¡ first-come first-serverdï¼ˆFCFSï¼‰</strong> </p><p>æŒ‰ç…§è¯·æ±‚çš„é¡ºåºè¿›è¡Œè°ƒåº¦ã€‚</p><p>æœ‰åˆ©äºé•¿ä½œä¸šï¼Œä½†ä¸åˆ©äºçŸ­ä½œä¸šï¼Œå› ä¸ºçŸ­ä½œä¸šå¿…é¡»ä¸€ç›´ç­‰å¾…å‰é¢çš„é•¿ä½œä¸šæ‰§è¡Œå®Œæ¯•æ‰èƒ½æ‰§è¡Œï¼Œè€Œé•¿ä½œä¸šåˆéœ€è¦æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œé€ æˆäº†çŸ­ä½œä¸šç­‰å¾…æ—¶é—´è¿‡é•¿ã€‚</p><p><strong>1.2 çŸ­ä½œä¸šä¼˜å…ˆ shortest job firstï¼ˆSJFï¼‰</strong> </p><p>æŒ‰ä¼°è®¡è¿è¡Œæ—¶é—´æœ€çŸ­çš„é¡ºåºè¿›è¡Œè°ƒåº¦ã€‚</p><p>é•¿ä½œä¸šæœ‰å¯èƒ½ä¼šé¥¿æ­»ï¼Œå¤„äºä¸€ç›´ç­‰å¾…çŸ­ä½œä¸šæ‰§è¡Œå®Œæ¯•çš„çŠ¶æ€ã€‚å› ä¸ºå¦‚æœä¸€ç›´æœ‰çŸ­ä½œä¸šåˆ°æ¥ï¼Œé‚£ä¹ˆé•¿ä½œä¸šæ°¸è¿œå¾—ä¸åˆ°è°ƒåº¦ã€‚</p><p><strong>1.3 æœ€çŸ­å‰©ä½™æ—¶é—´ä¼˜å…ˆ shortest remaining time nextï¼ˆSRTNï¼‰</strong> </p><p>æŒ‰ä¼°è®¡å‰©ä½™æ—¶é—´æœ€çŸ­çš„é¡ºåºè¿›è¡Œè°ƒåº¦ã€‚</p><h3 id="2-äº¤äº’å¼ç³»ç»Ÿ"><a href="#2-äº¤äº’å¼ç³»ç»Ÿ" class="headerlink" title="2. äº¤äº’å¼ç³»ç»Ÿ"></a>2. äº¤äº’å¼ç³»ç»Ÿ</h3><p>äº¤äº’å¼ç³»ç»Ÿæœ‰å¤§é‡çš„ç”¨æˆ·äº¤äº’æ“ä½œï¼Œåœ¨è¯¥ç³»ç»Ÿä¸­è°ƒåº¦ç®—æ³•çš„ç›®æ ‡æ˜¯å¿«é€Ÿåœ°è¿›è¡Œå“åº”ã€‚</p><p><strong>2.1 æ—¶é—´ç‰‡è½®è½¬</strong> </p><p>å°†æ‰€æœ‰å°±ç»ªè¿›ç¨‹æŒ‰ FCFS çš„åŸåˆ™æ’æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯æ¬¡è°ƒåº¦æ—¶ï¼ŒæŠŠ CPU æ—¶é—´åˆ†é…ç»™é˜Ÿé¦–è¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹å¯ä»¥æ‰§è¡Œä¸€ä¸ªæ—¶é—´ç‰‡ã€‚å½“æ—¶é—´ç‰‡ç”¨å®Œæ—¶ï¼Œç”±è®¡æ—¶å™¨å‘å‡ºæ—¶é’Ÿä¸­æ–­ï¼Œè°ƒåº¦ç¨‹åºä¾¿åœæ­¢è¯¥è¿›ç¨‹çš„æ‰§è¡Œï¼Œå¹¶å°†å®ƒé€å¾€å°±ç»ªé˜Ÿåˆ—çš„æœ«å°¾ï¼ŒåŒæ—¶ç»§ç»­æŠŠ CPU æ—¶é—´åˆ†é…ç»™é˜Ÿé¦–çš„è¿›ç¨‹ã€‚</p><p>æ—¶é—´ç‰‡è½®è½¬ç®—æ³•çš„æ•ˆç‡å’Œæ—¶é—´ç‰‡çš„å¤§å°æœ‰å¾ˆå¤§å…³ç³»ã€‚å› ä¸ºè¿›ç¨‹åˆ‡æ¢éƒ½è¦ä¿å­˜è¿›ç¨‹çš„ä¿¡æ¯å¹¶ä¸”è½½å…¥æ–°è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¦‚æœæ—¶é—´ç‰‡å¤ªå°ï¼Œä¼šå¯¼è‡´è¿›ç¨‹åˆ‡æ¢å¾—å¤ªé¢‘ç¹ï¼Œåœ¨è¿›ç¨‹åˆ‡æ¢ä¸Šå°±ä¼šèŠ±è¿‡å¤šæ—¶é—´ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044814.png"> </div><br></p><p><strong>2.2 ä¼˜å…ˆçº§è°ƒåº¦</strong> </p><p>ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€ä¸ªä¼˜å…ˆçº§ï¼ŒæŒ‰ä¼˜å…ˆçº§è¿›è¡Œè°ƒåº¦ã€‚</p><p>ä¸ºäº†é˜²æ­¢ä½ä¼˜å…ˆçº§çš„è¿›ç¨‹æ°¸è¿œç­‰ä¸åˆ°è°ƒåº¦ï¼Œå¯ä»¥éšç€æ—¶é—´çš„æ¨ç§»å¢åŠ ç­‰å¾…è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚</p><p><strong>2.3 å¤šçº§åé¦ˆé˜Ÿåˆ—</strong> </p><p>å¦‚æœä¸€ä¸ªè¿›ç¨‹éœ€è¦æ‰§è¡Œ 100 ä¸ªæ—¶é—´ç‰‡ï¼Œå¦‚æœé‡‡ç”¨æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•ï¼Œé‚£ä¹ˆéœ€è¦äº¤æ¢ 100 æ¬¡ã€‚</p><p>å¤šçº§é˜Ÿåˆ—æ˜¯ä¸ºè¿™ç§éœ€è¦è¿ç»­æ‰§è¡Œå¤šä¸ªæ—¶é—´ç‰‡çš„è¿›ç¨‹è€ƒè™‘ï¼Œå®ƒè®¾ç½®äº†å¤šä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—æ—¶é—´ç‰‡å¤§å°éƒ½ä¸åŒï¼Œä¾‹å¦‚ 1,2,4,8,..ã€‚è¿›ç¨‹åœ¨ç¬¬ä¸€ä¸ªé˜Ÿåˆ—æ²¡æ‰§è¡Œå®Œï¼Œå°±ä¼šè¢«ç§»åˆ°ä¸‹ä¸€ä¸ªé˜Ÿåˆ—ã€‚è¿™ç§æ–¹å¼ä¸‹ï¼Œä¹‹å‰çš„è¿›ç¨‹åªéœ€è¦äº¤æ¢ 7 æ¬¡ã€‚</p><p>æ¯ä¸ªé˜Ÿåˆ—ä¼˜å…ˆæƒä¹Ÿä¸åŒï¼Œæœ€ä¸Šé¢çš„ä¼˜å…ˆæƒæœ€é«˜ã€‚å› æ­¤åªæœ‰ä¸Šä¸€ä¸ªé˜Ÿåˆ—æ²¡æœ‰è¿›ç¨‹åœ¨æ’é˜Ÿï¼Œæ‰èƒ½è°ƒåº¦å½“å‰é˜Ÿåˆ—ä¸Šçš„è¿›ç¨‹ã€‚</p><p>å¯ä»¥å°†è¿™ç§è°ƒåº¦ç®—æ³•çœ‹æˆæ˜¯æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•å’Œä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•çš„ç»“åˆã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044818.png"> </div><br></p><h3 id="3-å®æ—¶ç³»ç»Ÿ"><a href="#3-å®æ—¶ç³»ç»Ÿ" class="headerlink" title="3. å®æ—¶ç³»ç»Ÿ"></a>3. å®æ—¶ç³»ç»Ÿ</h3><p>å®æ—¶ç³»ç»Ÿè¦æ±‚ä¸€ä¸ªè¯·æ±‚åœ¨ä¸€ä¸ªç¡®å®šæ—¶é—´å†…å¾—åˆ°å“åº”ã€‚</p><p>åˆ†ä¸ºç¡¬å®æ—¶å’Œè½¯å®æ—¶ï¼Œå‰è€…å¿…é¡»æ»¡è¶³ç»å¯¹çš„æˆªæ­¢æ—¶é—´ï¼Œåè€…å¯ä»¥å®¹å¿ä¸€å®šçš„è¶…æ—¶ã€‚</p><h2 id="è¿›ç¨‹åŒæ­¥"><a href="#è¿›ç¨‹åŒæ­¥" class="headerlink" title="è¿›ç¨‹åŒæ­¥"></a>è¿›ç¨‹åŒæ­¥</h2><h3 id="1-ä¸´ç•ŒåŒº"><a href="#1-ä¸´ç•ŒåŒº" class="headerlink" title="1. ä¸´ç•ŒåŒº"></a>1. ä¸´ç•ŒåŒº</h3><p>å¯¹ä¸´ç•Œèµ„æºè¿›è¡Œè®¿é—®çš„é‚£æ®µä»£ç ç§°ä¸ºä¸´ç•ŒåŒºã€‚</p><p>ä¸ºäº†äº’æ–¥è®¿é—®ä¸´ç•Œèµ„æºï¼Œæ¯ä¸ªè¿›ç¨‹åœ¨è¿›å…¥ä¸´ç•ŒåŒºä¹‹å‰ï¼Œéœ€è¦å…ˆè¿›è¡Œæ£€æŸ¥ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// entry section</span><br><span class="line">// critical section;</span><br><span class="line">// exit section</span><br></pre></td></tr></table></figure><h3 id="2-åŒæ­¥ä¸äº’æ–¥"><a href="#2-åŒæ­¥ä¸äº’æ–¥" class="headerlink" title="2. åŒæ­¥ä¸äº’æ–¥"></a>2. åŒæ­¥ä¸äº’æ–¥</h3><ul><li>åŒæ­¥ï¼šå¤šä¸ªè¿›ç¨‹æŒ‰ä¸€å®šé¡ºåºæ‰§è¡Œï¼›</li><li>äº’æ–¥ï¼šå¤šä¸ªè¿›ç¨‹åœ¨åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªè¿›ç¨‹èƒ½è¿›å…¥ä¸´ç•ŒåŒºã€‚</li></ul><h3 id="3-ä¿¡å·é‡"><a href="#3-ä¿¡å·é‡" class="headerlink" title="3. ä¿¡å·é‡"></a>3. ä¿¡å·é‡</h3><p>ä¿¡å·é‡ï¼ˆSemaphoreï¼‰æ˜¯ä¸€ä¸ªæ•´å‹å˜é‡ï¼Œå¯ä»¥å¯¹å…¶æ‰§è¡Œ down å’Œ up æ“ä½œï¼Œä¹Ÿå°±æ˜¯å¸¸è§çš„ P å’Œ V æ“ä½œã€‚</p><ul><li><strong>down</strong>  : å¦‚æœä¿¡å·é‡å¤§äº 0 ï¼Œæ‰§è¡Œ -1 æ“ä½œï¼›å¦‚æœä¿¡å·é‡ç­‰äº 0ï¼Œè¿›ç¨‹ç¡çœ ï¼Œç­‰å¾…ä¿¡å·é‡å¤§äº 0ï¼›</li><li><strong>up</strong> ï¼šå¯¹ä¿¡å·é‡æ‰§è¡Œ +1 æ“ä½œï¼Œå”¤é†’ç¡çœ çš„è¿›ç¨‹è®©å…¶å®Œæˆ down æ“ä½œã€‚</li></ul><p>down å’Œ up æ“ä½œéœ€è¦è¢«è®¾è®¡æˆåŸè¯­ï¼Œä¸å¯åˆ†å‰²ï¼Œé€šå¸¸çš„åšæ³•æ˜¯åœ¨æ‰§è¡Œè¿™äº›æ“ä½œçš„æ—¶å€™å±è”½ä¸­æ–­ã€‚</p><p>å¦‚æœä¿¡å·é‡çš„å–å€¼åªèƒ½ä¸º 0 æˆ–è€… 1ï¼Œé‚£ä¹ˆå°±æˆä¸ºäº†  <strong>äº’æ–¥é‡ï¼ˆMutexï¼‰</strong> ï¼Œ0 è¡¨ç¤ºä¸´ç•ŒåŒºå·²ç»åŠ é”ï¼Œ1 è¡¨ç¤ºä¸´ç•ŒåŒºè§£é”ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> semaphore;</span><br><span class="line">semaphore mutex = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">P1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    down(&amp;mutex);</span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒº</span></span><br><span class="line">    up(&amp;mutex);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">P2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    down(&amp;mutex);</span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒº</span></span><br><span class="line">    up(&amp;mutex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font size="3">  <strong>ä½¿ç”¨ä¿¡å·é‡å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜</strong>  </font> <br></p><p>é—®é¢˜æè¿°ï¼šä½¿ç”¨ä¸€ä¸ªç¼“å†²åŒºæ¥ä¿å­˜ç‰©å“ï¼Œåªæœ‰ç¼“å†²åŒºæ²¡æœ‰æ»¡ï¼Œç”Ÿäº§è€…æ‰å¯ä»¥æ”¾å…¥ç‰©å“ï¼›åªæœ‰ç¼“å†²åŒºä¸ä¸ºç©ºï¼Œæ¶ˆè´¹è€…æ‰å¯ä»¥æ‹¿èµ°ç‰©å“ã€‚</p><p>å› ä¸ºç¼“å†²åŒºå±äºä¸´ç•Œèµ„æºï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ä¸€ä¸ªäº’æ–¥é‡ mutex æ¥æ§åˆ¶å¯¹ç¼“å†²åŒºçš„äº’æ–¥è®¿é—®ã€‚</p><p>ä¸ºäº†åŒæ­¥ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„è¡Œä¸ºï¼Œéœ€è¦è®°å½•ç¼“å†²åŒºä¸­ç‰©å“çš„æ•°é‡ã€‚æ•°é‡å¯ä»¥ä½¿ç”¨ä¿¡å·é‡æ¥è¿›è¡Œç»Ÿè®¡ï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨ä¸¤ä¸ªä¿¡å·é‡ï¼šempty è®°å½•ç©ºç¼“å†²åŒºçš„æ•°é‡ï¼Œfull è®°å½•æ»¡ç¼“å†²åŒºçš„æ•°é‡ã€‚å…¶ä¸­ï¼Œempty ä¿¡å·é‡æ˜¯åœ¨ç”Ÿäº§è€…è¿›ç¨‹ä¸­ä½¿ç”¨ï¼Œå½“ empty ä¸ä¸º 0 æ—¶ï¼Œç”Ÿäº§è€…æ‰å¯ä»¥æ”¾å…¥ç‰©å“ï¼›full ä¿¡å·é‡æ˜¯åœ¨æ¶ˆè´¹è€…è¿›ç¨‹ä¸­ä½¿ç”¨ï¼Œå½“ full ä¿¡å·é‡ä¸ä¸º 0 æ—¶ï¼Œæ¶ˆè´¹è€…æ‰å¯ä»¥å–èµ°ç‰©å“ã€‚</p><p>æ³¨æ„ï¼Œä¸èƒ½å…ˆå¯¹ç¼“å†²åŒºè¿›è¡ŒåŠ é”ï¼Œå†æµ‹è¯•ä¿¡å·é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸èƒ½å…ˆæ‰§è¡Œ down(mutex) å†æ‰§è¡Œ down(empty)ã€‚å¦‚æœè¿™ä¹ˆåšäº†ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼šç”Ÿäº§è€…å¯¹ç¼“å†²åŒºåŠ é”åï¼Œæ‰§è¡Œ down(empty) æ“ä½œï¼Œå‘ç° empty = 0ï¼Œæ­¤æ—¶ç”Ÿäº§è€…ç¡çœ ã€‚æ¶ˆè´¹è€…ä¸èƒ½è¿›å…¥ä¸´ç•ŒåŒºï¼Œå› ä¸ºç”Ÿäº§è€…å¯¹ç¼“å†²åŒºåŠ é”äº†ï¼Œä¹Ÿå°±æ— æ³•æ‰§è¡Œ up(empty) æ“ä½œï¼Œempty æ°¸è¿œéƒ½ä¸º 0ï¼Œé‚£ä¹ˆç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å°±ä¼šä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œé€ æˆæ­»é”ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> semaphore;</span><br><span class="line">semaphore mutex = <span class="number">1</span>;</span><br><span class="line">semaphore empty = N;</span><br><span class="line">semaphore full = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">producer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(TRUE)&#123;</span><br><span class="line">        <span class="keyword">int</span> item = produce_item();</span><br><span class="line">        down(&amp;empty);</span><br><span class="line">        down(&amp;mutex);</span><br><span class="line">        insert_item(item);</span><br><span class="line">        up(&amp;mutex);</span><br><span class="line">        up(&amp;full);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">consumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(TRUE)&#123;</span><br><span class="line">        down(&amp;full);</span><br><span class="line">        down(&amp;mutex);</span><br><span class="line">        <span class="keyword">int</span> item = remove_item();</span><br><span class="line">        up(&amp;mutex);</span><br><span class="line">        up(&amp;empty);</span><br><span class="line">        consume_item(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-ç®¡ç¨‹"><a href="#4-ç®¡ç¨‹" class="headerlink" title="4. ç®¡ç¨‹"></a>4. ç®¡ç¨‹</h3><p>ä½¿ç”¨ä¿¡å·é‡æœºåˆ¶å®ç°çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜éœ€è¦å®¢æˆ·ç«¯ä»£ç åšå¾ˆå¤šæ§åˆ¶ï¼Œè€Œç®¡ç¨‹æŠŠæ§åˆ¶çš„ä»£ç ç‹¬ç«‹å‡ºæ¥ï¼Œä¸ä»…ä¸å®¹æ˜“å‡ºé”™ï¼Œä¹Ÿä½¿å¾—å®¢æˆ·ç«¯ä»£ç è°ƒç”¨æ›´å®¹æ˜“ã€‚</p><p>c è¯­è¨€ä¸æ”¯æŒç®¡ç¨‹ï¼Œä¸‹é¢çš„ç¤ºä¾‹ä»£ç ä½¿ç”¨äº†ç±» Pascal è¯­è¨€æ¥æè¿°ç®¡ç¨‹ã€‚ç¤ºä¾‹ä»£ç çš„ç®¡ç¨‹æä¾›äº† insert() å’Œ remove() æ–¹æ³•ï¼Œå®¢æˆ·ç«¯ä»£ç é€šè¿‡è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•æ¥è§£å†³ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ã€‚</p><figure class="highlight pascal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">monitor ProducerConsumer</span><br><span class="line">    integer i;</span><br><span class="line">    condition c;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">insert</span><span class="params">()</span>;</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">remove</span><span class="params">()</span>;</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span> monitor;</span><br></pre></td></tr></table></figure><p>ç®¡ç¨‹æœ‰ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼šåœ¨ä¸€ä¸ªæ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ç®¡ç¨‹ã€‚è¿›ç¨‹åœ¨æ— æ³•ç»§ç»­æ‰§è¡Œçš„æ—¶å€™ä¸èƒ½ä¸€ç›´å ç”¨ç®¡ç¨‹ï¼Œå¦è€…å…¶å®ƒè¿›ç¨‹æ°¸è¿œä¸èƒ½ä½¿ç”¨ç®¡ç¨‹ã€‚</p><p>ç®¡ç¨‹å¼•å…¥äº†  <strong>æ¡ä»¶å˜é‡</strong>  ä»¥åŠç›¸å…³çš„æ“ä½œï¼š<strong>wait()</strong> å’Œ <strong>signal()</strong> æ¥å®ç°åŒæ­¥æ“ä½œã€‚å¯¹æ¡ä»¶å˜é‡æ‰§è¡Œ wait() æ“ä½œä¼šå¯¼è‡´è°ƒç”¨è¿›ç¨‹é˜»å¡ï¼ŒæŠŠç®¡ç¨‹è®©å‡ºæ¥ç»™å¦ä¸€ä¸ªè¿›ç¨‹æŒæœ‰ã€‚signal() æ“ä½œç”¨äºå”¤é†’è¢«é˜»å¡çš„è¿›ç¨‹ã€‚</p><p><font size="3"> <strong>ä½¿ç”¨ç®¡ç¨‹å®ç°ç”Ÿæˆè€…-æ¶ˆè´¹è€…é—®é¢˜</strong> </font><br></p><figure class="highlight pascal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®¡ç¨‹</span></span><br><span class="line">monitor ProducerConsumer</span><br><span class="line">    condition full, empty;</span><br><span class="line">    integer count := <span class="number">0</span>;</span><br><span class="line">    condition c;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">insert</span><span class="params">(item: integer)</span>;</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> count = N <span class="keyword">then</span> wait(full);</span><br><span class="line">        insert_item(item);</span><br><span class="line">        count := count + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> count = <span class="number">1</span> <span class="keyword">then</span> signal(empty);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">remove</span>:</span> integer;</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> count = <span class="number">0</span> <span class="keyword">then</span> wait(empty);</span><br><span class="line">        remove = remove_item;</span><br><span class="line">        count := count - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> count = N -<span class="number">1</span> <span class="keyword">then</span> signal(full);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span> monitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿäº§è€…å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">producer</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">while</span> <span class="title">true</span> <span class="title">do</span></span></span><br><span class="line"><span class="function">    <span class="title">begin</span></span></span><br><span class="line"><span class="function">        <span class="title">item</span> = <span class="title">produce_item</span>;</span></span><br><span class="line">        ProducerConsumer.insert(item);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">consumer</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">while</span> <span class="title">true</span> <span class="title">do</span></span></span><br><span class="line"><span class="function">    <span class="title">begin</span></span></span><br><span class="line"><span class="function">        <span class="title">item</span> = <span class="title">ProducerConsumer</span>.<span class="title">remove</span>;</span></span><br><span class="line">        consume_item(item);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="ç»å…¸åŒæ­¥é—®é¢˜"><a href="#ç»å…¸åŒæ­¥é—®é¢˜" class="headerlink" title="ç»å…¸åŒæ­¥é—®é¢˜"></a>ç»å…¸åŒæ­¥é—®é¢˜</h2><p>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜å‰é¢å·²ç»è®¨è®ºè¿‡äº†ã€‚</p><h3 id="1-è¯»è€…-å†™è€…é—®é¢˜"><a href="#1-è¯»è€…-å†™è€…é—®é¢˜" class="headerlink" title="1. è¯»è€…-å†™è€…é—®é¢˜"></a>1. è¯»è€…-å†™è€…é—®é¢˜</h3><p>å…è®¸å¤šä¸ªè¿›ç¨‹åŒæ—¶å¯¹æ•°æ®è¿›è¡Œè¯»æ“ä½œï¼Œä½†æ˜¯ä¸å…è®¸è¯»å’Œå†™ä»¥åŠå†™å’Œå†™æ“ä½œåŒæ—¶å‘ç”Ÿã€‚</p><p>ä¸€ä¸ªæ•´å‹å˜é‡ count è®°å½•åœ¨å¯¹æ•°æ®è¿›è¡Œè¯»æ“ä½œçš„è¿›ç¨‹æ•°é‡ï¼Œä¸€ä¸ªäº’æ–¥é‡ count_mutex ç”¨äºå¯¹ count åŠ é”ï¼Œä¸€ä¸ªäº’æ–¥é‡ data_mutex ç”¨äºå¯¹è¯»å†™çš„æ•°æ®åŠ é”ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> semaphore;</span><br><span class="line">semaphore count_mutex = <span class="number">1</span>;</span><br><span class="line">semaphore data_mutex = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(TRUE) &#123;</span><br><span class="line">        down(&amp;count_mutex);</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span>(count == <span class="number">1</span>) down(&amp;data_mutex); <span class="comment">// ç¬¬ä¸€ä¸ªè¯»è€…éœ€è¦å¯¹æ•°æ®è¿›è¡ŒåŠ é”ï¼Œé˜²æ­¢å†™è¿›ç¨‹è®¿é—®</span></span><br><span class="line">        up(&amp;count_mutex);</span><br><span class="line">        read();</span><br><span class="line">        down(&amp;count_mutex);</span><br><span class="line">        count--;</span><br><span class="line">        <span class="keyword">if</span>(count == <span class="number">0</span>) up(&amp;data_mutex);</span><br><span class="line">        up(&amp;count_mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">writer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(TRUE) &#123;</span><br><span class="line">        down(&amp;data_mutex);</span><br><span class="line">        write();</span><br><span class="line">        up(&amp;data_mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-å“²å­¦å®¶è¿›é¤é—®é¢˜"><a href="#2-å“²å­¦å®¶è¿›é¤é—®é¢˜" class="headerlink" title="2. å“²å­¦å®¶è¿›é¤é—®é¢˜"></a>2. å“²å­¦å®¶è¿›é¤é—®é¢˜</h3><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044825.jpg"> </div><br></p><p>äº”ä¸ªå“²å­¦å®¶å›´ç€ä¸€å¼ åœ†æ¡Œï¼Œæ¯ä¸ªå“²å­¦å®¶é¢å‰æ”¾ç€é£Ÿç‰©ã€‚å“²å­¦å®¶çš„ç”Ÿæ´»æœ‰ä¸¤ç§äº¤æ›¿æ´»åŠ¨ï¼šåƒé¥­ä»¥åŠæ€è€ƒã€‚å½“ä¸€ä¸ªå“²å­¦å®¶åƒé¥­æ—¶ï¼Œéœ€è¦å…ˆæ‹¿èµ·è‡ªå·±å·¦å³ä¸¤è¾¹çš„ä¸¤æ ¹ç­·å­ï¼Œå¹¶ä¸”ä¸€æ¬¡åªèƒ½æ‹¿èµ·ä¸€æ ¹ç­·å­ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ç§é”™è¯¯çš„è§£æ³•ï¼Œè€ƒè™‘åˆ°å¦‚æœæ‰€æœ‰å“²å­¦å®¶åŒæ—¶æ‹¿èµ·å·¦æ‰‹è¾¹çš„ç­·å­ï¼Œé‚£ä¹ˆå°±æ— æ³•æ‹¿èµ·å³æ‰‹è¾¹çš„ç­·å­ï¼Œé€ æˆæ­»é”ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">philosopher</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(TRUE) &#123;</span><br><span class="line">        think();</span><br><span class="line">        take(i);       <span class="comment">// æ‹¿èµ·å·¦è¾¹çš„ç­·å­</span></span><br><span class="line">        take((i+<span class="number">1</span>)%N); <span class="comment">// æ‹¿èµ·å³è¾¹çš„ç­·å­</span></span><br><span class="line">        eat();</span><br><span class="line">        put(i);</span><br><span class="line">        put((i+<span class="number">1</span>)%N);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†é˜²æ­¢æ­»é”çš„å‘ç”Ÿï¼Œå¯ä»¥è®¾ç½®ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li>å¿…é¡»åŒæ—¶æ‹¿èµ·å·¦å³ä¸¤æ ¹ç­·å­ï¼›</li><li>åªæœ‰åœ¨ä¸¤ä¸ªé‚»å±…éƒ½æ²¡æœ‰è¿›é¤çš„æƒ…å†µä¸‹æ‰å…è®¸è¿›é¤ã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LEFT (i + N - 1) % N <span class="comment">// å·¦é‚»å±…</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RIGHT (i + 1) % N    <span class="comment">// å³é‚»å±…</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> THINKING 0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HUNGRY   1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EATING   2</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> semaphore;</span><br><span class="line"><span class="keyword">int</span> state[N];                <span class="comment">// è·Ÿè¸ªæ¯ä¸ªå“²å­¦å®¶çš„çŠ¶æ€</span></span><br><span class="line">semaphore mutex = <span class="number">1</span>;         <span class="comment">// ä¸´ç•ŒåŒºçš„äº’æ–¥</span></span><br><span class="line">semaphore s[N];              <span class="comment">// æ¯ä¸ªå“²å­¦å®¶ä¸€ä¸ªä¿¡å·é‡</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">philosopher</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(TRUE) &#123;</span><br><span class="line">        think();</span><br><span class="line">        take_two(i);</span><br><span class="line">        eat();</span><br><span class="line">        put_tow(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">take_two</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    down(&amp;mutex);</span><br><span class="line">    state[i] = HUNGRY;</span><br><span class="line">    test(i);</span><br><span class="line">    up(&amp;mutex);</span><br><span class="line">    down(&amp;s[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">put_tow</span><span class="params">(i)</span> </span>&#123;</span><br><span class="line">    down(&amp;mutex);</span><br><span class="line">    state[i] = THINKING;</span><br><span class="line">    test(LEFT);</span><br><span class="line">    test(RIGHT);</span><br><span class="line">    up(&amp;mutex);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(i)</span> </span>&#123;         <span class="comment">// å°è¯•æ‹¿èµ·ä¸¤æŠŠç­·å­</span></span><br><span class="line">    <span class="keyword">if</span>(state[i] == HUNGRY &amp;&amp; state[LEFT] != EATING &amp;&amp; state[RIGHT] !=EATING) &#123;</span><br><span class="line">        state[i] = EATING;</span><br><span class="line">        up(&amp;s[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¿›ç¨‹é€šä¿¡"><a href="#è¿›ç¨‹é€šä¿¡" class="headerlink" title="è¿›ç¨‹é€šä¿¡"></a>è¿›ç¨‹é€šä¿¡</h2><p>è¿›ç¨‹åŒæ­¥ä¸è¿›ç¨‹é€šä¿¡å¾ˆå®¹æ˜“æ··æ·†ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼š</p><ul><li>è¿›ç¨‹åŒæ­¥ï¼šæ§åˆ¶å¤šä¸ªè¿›ç¨‹æŒ‰ä¸€å®šé¡ºåºæ‰§è¡Œï¼›</li><li>è¿›ç¨‹é€šä¿¡ï¼šè¿›ç¨‹é—´ä¼ è¾“ä¿¡æ¯ã€‚</li></ul><p>è¿›ç¨‹é€šä¿¡æ˜¯ä¸€ç§æ‰‹æ®µï¼Œè€Œè¿›ç¨‹åŒæ­¥æ˜¯ä¸€ç§ç›®çš„ã€‚ä¹Ÿå¯ä»¥è¯´ï¼Œä¸ºäº†èƒ½å¤Ÿè¾¾åˆ°è¿›ç¨‹åŒæ­¥çš„ç›®çš„ï¼Œéœ€è¦è®©è¿›ç¨‹è¿›è¡Œé€šä¿¡ï¼Œä¼ è¾“ä¸€äº›è¿›ç¨‹åŒæ­¥æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚</p><h3 id="1-ç®¡é“"><a href="#1-ç®¡é“" class="headerlink" title="1. ç®¡é“"></a>1. ç®¡é“</h3><p>ç®¡é“æ˜¯é€šè¿‡è°ƒç”¨ pipe å‡½æ•°åˆ›å»ºçš„ï¼Œfd[0] ç”¨äºè¯»ï¼Œfd[1] ç”¨äºå†™ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pipe</span><span class="params">(<span class="keyword">int</span> fd[<span class="number">2</span>])</span></span>;</span><br></pre></td></tr></table></figure><p>å®ƒå…·æœ‰ä»¥ä¸‹é™åˆ¶ï¼š</p><ul><li>åªæ”¯æŒåŠåŒå·¥é€šä¿¡ï¼ˆå•å‘ä¼ è¾“ï¼‰ï¼›</li><li>åªèƒ½åœ¨çˆ¶å­è¿›ç¨‹ä¸­ä½¿ç”¨ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044830.png"> </div><br></p><h3 id="2-FIFO"><a href="#2-FIFO" class="headerlink" title="2. FIFO"></a>2. FIFO</h3><p>ä¹Ÿç§°ä¸ºå‘½åç®¡é“ï¼Œå»é™¤äº†ç®¡é“åªèƒ½åœ¨çˆ¶å­è¿›ç¨‹ä¸­ä½¿ç”¨çš„é™åˆ¶ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mkfifo</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *path, <span class="keyword">mode_t</span> mode)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mkfifoat</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">const</span> <span class="keyword">char</span> *path, <span class="keyword">mode_t</span> mode)</span></span>;</span><br></pre></td></tr></table></figure><p>FIFO å¸¸ç”¨äºå®¢æˆ·-æœåŠ¡å™¨åº”ç”¨ç¨‹åºä¸­ï¼ŒFIFO ç”¨ä½œæ±‡èšç‚¹ï¼Œåœ¨å®¢æˆ·è¿›ç¨‹å’ŒæœåŠ¡å™¨è¿›ç¨‹ä¹‹é—´ä¼ é€’æ•°æ®ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044833.png"> </div><br></p><h3 id="3-æ¶ˆæ¯é˜Ÿåˆ—"><a href="#3-æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="3. æ¶ˆæ¯é˜Ÿåˆ—"></a>3. æ¶ˆæ¯é˜Ÿåˆ—</h3><p>ç›¸æ¯”äº FIFOï¼Œæ¶ˆæ¯é˜Ÿåˆ—å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ul><li>æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥ç‹¬ç«‹äºè¯»å†™è¿›ç¨‹å­˜åœ¨ï¼Œä»è€Œé¿å…äº† FIFO ä¸­åŒæ­¥ç®¡é“çš„æ‰“å¼€å’Œå…³é—­æ—¶å¯èƒ½äº§ç”Ÿçš„å›°éš¾ï¼›</li><li>é¿å…äº† FIFO çš„åŒæ­¥é˜»å¡é—®é¢˜ï¼Œä¸éœ€è¦è¿›ç¨‹è‡ªå·±æä¾›åŒæ­¥æ–¹æ³•ï¼›</li><li>è¯»è¿›ç¨‹å¯ä»¥æ ¹æ®æ¶ˆæ¯ç±»å‹æœ‰é€‰æ‹©åœ°æ¥æ”¶æ¶ˆæ¯ï¼Œè€Œä¸åƒ FIFO é‚£æ ·åªèƒ½é»˜è®¤åœ°æ¥æ”¶ã€‚</li></ul><h3 id="4-ä¿¡å·é‡"><a href="#4-ä¿¡å·é‡" class="headerlink" title="4. ä¿¡å·é‡"></a>4. ä¿¡å·é‡</h3><p>å®ƒæ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºä¸ºå¤šä¸ªè¿›ç¨‹æä¾›å¯¹å…±äº«æ•°æ®å¯¹è±¡çš„è®¿é—®ã€‚</p><h3 id="5-å…±äº«å­˜å‚¨"><a href="#5-å…±äº«å­˜å‚¨" class="headerlink" title="5. å…±äº«å­˜å‚¨"></a>5. å…±äº«å­˜å‚¨</h3><p>å…è®¸å¤šä¸ªè¿›ç¨‹å…±äº«ä¸€ä¸ªç»™å®šçš„å­˜å‚¨åŒºã€‚å› ä¸ºæ•°æ®ä¸éœ€è¦åœ¨è¿›ç¨‹ä¹‹é—´å¤åˆ¶ï¼Œæ‰€ä»¥è¿™æ˜¯æœ€å¿«çš„ä¸€ç§ IPCã€‚</p><p>éœ€è¦ä½¿ç”¨ä¿¡å·é‡ç”¨æ¥åŒæ­¥å¯¹å…±äº«å­˜å‚¨çš„è®¿é—®ã€‚</p><p>å¤šä¸ªè¿›ç¨‹å¯ä»¥å°†åŒä¸€ä¸ªæ–‡ä»¶æ˜ å°„åˆ°å®ƒä»¬çš„åœ°å€ç©ºé—´ä»è€Œå®ç°å…±äº«å†…å­˜ã€‚å¦å¤– XSI å…±äº«å†…å­˜ä¸æ˜¯ä½¿ç”¨æ–‡ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨ä½¿ç”¨å†…å­˜çš„åŒ¿åæ®µã€‚</p><h3 id="6-å¥—æ¥å­—"><a href="#6-å¥—æ¥å­—" class="headerlink" title="6. å¥—æ¥å­—"></a>6. å¥—æ¥å­—</h3><p>ä¸å…¶å®ƒé€šä¿¡æœºåˆ¶ä¸åŒçš„æ˜¯ï¼Œå®ƒå¯ç”¨äºä¸åŒæœºå™¨é—´çš„è¿›ç¨‹é€šä¿¡ã€‚</p><h1 id="ä¸‰ã€æ­»é”"><a href="#ä¸‰ã€æ­»é”" class="headerlink" title="ä¸‰ã€æ­»é”"></a>ä¸‰ã€æ­»é”</h1><h2 id="æ­»é”çš„å¿…è¦æ¡ä»¶"><a href="#æ­»é”çš„å¿…è¦æ¡ä»¶" class="headerlink" title="æ­»é”çš„å¿…è¦æ¡ä»¶"></a>æ­»é”çš„å¿…è¦æ¡ä»¶</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044839.png"> </div><br></p><ul><li>äº’æ–¥ï¼šæ¯ä¸ªèµ„æºè¦ä¹ˆå·²ç»åˆ†é…ç»™äº†ä¸€ä¸ªè¿›ç¨‹ï¼Œè¦ä¹ˆå°±æ˜¯å¯ç”¨çš„ã€‚</li><li>å æœ‰å’Œç­‰å¾…ï¼šå·²ç»å¾—åˆ°äº†æŸä¸ªèµ„æºçš„è¿›ç¨‹å¯ä»¥å†è¯·æ±‚æ–°çš„èµ„æºã€‚</li><li>ä¸å¯æŠ¢å ï¼šå·²ç»åˆ†é…ç»™ä¸€ä¸ªè¿›ç¨‹çš„èµ„æºä¸èƒ½å¼ºåˆ¶æ€§åœ°è¢«æŠ¢å ï¼Œå®ƒåªèƒ½è¢«å æœ‰å®ƒçš„è¿›ç¨‹æ˜¾å¼åœ°é‡Šæ”¾ã€‚</li><li>ç¯è·¯ç­‰å¾…ï¼šæœ‰ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ç»„æˆä¸€æ¡ç¯è·¯ï¼Œè¯¥ç¯è·¯ä¸­çš„æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…ä¸‹ä¸€ä¸ªè¿›ç¨‹æ‰€å æœ‰çš„èµ„æºã€‚</li></ul><h2 id="æ­»é”çš„å¤„ç†æ–¹æ³•"><a href="#æ­»é”çš„å¤„ç†æ–¹æ³•" class="headerlink" title="æ­»é”çš„å¤„ç†æ–¹æ³•"></a>æ­»é”çš„å¤„ç†æ–¹æ³•</h2><h3 id="1-é¸µé¸Ÿç­–ç•¥"><a href="#1-é¸µé¸Ÿç­–ç•¥" class="headerlink" title="1. é¸µé¸Ÿç­–ç•¥"></a>1. é¸µé¸Ÿç­–ç•¥</h3><p>æŠŠå¤´åŸ‹åœ¨æ²™å­é‡Œï¼Œå‡è£…æ ¹æœ¬æ²¡å‘ç”Ÿé—®é¢˜ã€‚</p><p>å› ä¸ºè§£å†³æ­»é”é—®é¢˜çš„ä»£ä»·å¾ˆé«˜ï¼Œå› æ­¤é¸µé¸Ÿç­–ç•¥è¿™ç§ä¸é‡‡å–ä»»åŠ¡æªæ–½çš„æ–¹æ¡ˆä¼šè·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚å½“å‘ç”Ÿæ­»é”æ—¶ä¸ä¼šå¯¹ç”¨æˆ·é€ æˆå¤šå¤§å½±å“ï¼Œæˆ–å‘ç”Ÿæ­»é”çš„æ¦‚ç‡å¾ˆä½ï¼Œå¯ä»¥é‡‡ç”¨é¸µé¸Ÿç­–ç•¥ã€‚</p><p>å¤§å¤šæ•°æ“ä½œç³»ç»Ÿï¼ŒåŒ…æ‹¬ Unixï¼ŒLinux å’Œ Windowsï¼Œå¤„ç†æ­»é”é—®é¢˜çš„åŠæ³•ä»…ä»…æ˜¯å¿½ç•¥å®ƒã€‚</p><h3 id="2-æ­»é”æ£€æµ‹ä¸æ­»é”æ¢å¤"><a href="#2-æ­»é”æ£€æµ‹ä¸æ­»é”æ¢å¤" class="headerlink" title="2. æ­»é”æ£€æµ‹ä¸æ­»é”æ¢å¤"></a>2. æ­»é”æ£€æµ‹ä¸æ­»é”æ¢å¤</h3><p>ä¸è¯•å›¾é˜»æ­¢æ­»é”ï¼Œè€Œæ˜¯å½“æ£€æµ‹åˆ°æ­»é”å‘ç”Ÿæ—¶ï¼Œé‡‡å–æªæ–½è¿›è¡Œæ¢å¤ã€‚</p><p>ï¼ˆä¸€ï¼‰æ¯ç§ç±»å‹ä¸€ä¸ªèµ„æºçš„æ­»é”æ£€æµ‹</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044847.png"> </div><br></p><p>ä¸Šå›¾ä¸ºèµ„æºåˆ†é…å›¾ï¼Œå…¶ä¸­æ–¹æ¡†è¡¨ç¤ºèµ„æºï¼Œåœ†åœˆè¡¨ç¤ºè¿›ç¨‹ã€‚èµ„æºæŒ‡å‘è¿›ç¨‹è¡¨ç¤ºè¯¥èµ„æºå·²ç»åˆ†é…ç»™è¯¥è¿›ç¨‹ï¼Œè¿›ç¨‹æŒ‡å‘èµ„æºè¡¨ç¤ºè¿›ç¨‹è¯·æ±‚è·å–è¯¥èµ„æºã€‚</p><p>å›¾ a å¯ä»¥æŠ½å–å‡ºç¯ï¼Œå¦‚å›¾ bï¼Œå®ƒæ»¡è¶³äº†ç¯è·¯ç­‰å¾…æ¡ä»¶ï¼Œå› æ­¤ä¼šå‘ç”Ÿæ­»é”ã€‚</p><p>æ¯ç§ç±»å‹ä¸€ä¸ªèµ„æºçš„æ­»é”æ£€æµ‹ç®—æ³•æ˜¯é€šè¿‡æ£€æµ‹æœ‰å‘å›¾æ˜¯å¦å­˜åœ¨ç¯æ¥å®ç°ï¼Œä»ä¸€ä¸ªèŠ‚ç‚¹å‡ºå‘è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå¯¹è®¿é—®è¿‡çš„èŠ‚ç‚¹è¿›è¡Œæ ‡è®°ï¼Œå¦‚æœè®¿é—®äº†å·²ç»æ ‡è®°çš„èŠ‚ç‚¹ï¼Œå°±è¡¨ç¤ºæœ‰å‘å›¾å­˜åœ¨ç¯ï¼Œä¹Ÿå°±æ˜¯æ£€æµ‹åˆ°æ­»é”çš„å‘ç”Ÿã€‚</p><p>ï¼ˆäºŒï¼‰æ¯ç§ç±»å‹å¤šä¸ªèµ„æºçš„æ­»é”æ£€æµ‹</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044850.png"> </div><br></p><p>ä¸Šå›¾ä¸­ï¼Œæœ‰ä¸‰ä¸ªè¿›ç¨‹å››ä¸ªèµ„æºï¼Œæ¯ä¸ªæ•°æ®ä»£è¡¨çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li>E å‘é‡ï¼šèµ„æºæ€»é‡</li><li>A å‘é‡ï¼šèµ„æºå‰©ä½™é‡</li><li>C çŸ©é˜µï¼šæ¯ä¸ªè¿›ç¨‹æ‰€æ‹¥æœ‰çš„èµ„æºæ•°é‡ï¼Œæ¯ä¸€è¡Œéƒ½ä»£è¡¨ä¸€ä¸ªè¿›ç¨‹æ‹¥æœ‰èµ„æºçš„æ•°é‡</li><li>R çŸ©é˜µï¼šæ¯ä¸ªè¿›ç¨‹è¯·æ±‚çš„èµ„æºæ•°é‡</li></ul><p>è¿›ç¨‹ P<sub>1</sub> å’Œ P<sub>2</sub> æ‰€è¯·æ±‚çš„èµ„æºéƒ½å¾—ä¸åˆ°æ»¡è¶³ï¼Œåªæœ‰è¿›ç¨‹ P<sub>3</sub> å¯ä»¥ï¼Œè®© P<sub>3</sub> æ‰§è¡Œï¼Œä¹‹åé‡Šæ”¾ P<sub>3</sub> æ‹¥æœ‰çš„èµ„æºï¼Œæ­¤æ—¶ A = (2 2 2 0)ã€‚P<sub>2</sub> å¯ä»¥æ‰§è¡Œï¼Œæ‰§è¡Œåé‡Šæ”¾ P<sub>2</sub> æ‹¥æœ‰çš„èµ„æºï¼ŒA = (4 2 2 1) ã€‚P<sub>1</sub> ä¹Ÿå¯ä»¥æ‰§è¡Œã€‚æ‰€æœ‰è¿›ç¨‹éƒ½å¯ä»¥é¡ºåˆ©æ‰§è¡Œï¼Œæ²¡æœ‰æ­»é”ã€‚</p><p>ç®—æ³•æ€»ç»“å¦‚ä¸‹ï¼š</p><p>æ¯ä¸ªè¿›ç¨‹æœ€å¼€å§‹æ—¶éƒ½ä¸è¢«æ ‡è®°ï¼Œæ‰§è¡Œè¿‡ç¨‹æœ‰å¯èƒ½è¢«æ ‡è®°ã€‚å½“ç®—æ³•ç»“æŸæ—¶ï¼Œä»»ä½•æ²¡æœ‰è¢«æ ‡è®°çš„è¿›ç¨‹éƒ½æ˜¯æ­»é”è¿›ç¨‹ã€‚</p><ol><li>å¯»æ‰¾ä¸€ä¸ªæ²¡æœ‰æ ‡è®°çš„è¿›ç¨‹ P<sub>i</sub>ï¼Œå®ƒæ‰€è¯·æ±‚çš„èµ„æºå°äºç­‰äº Aã€‚</li><li>å¦‚æœæ‰¾åˆ°äº†è¿™æ ·ä¸€ä¸ªè¿›ç¨‹ï¼Œé‚£ä¹ˆå°† C çŸ©é˜µçš„ç¬¬ i è¡Œå‘é‡åŠ åˆ° A ä¸­ï¼Œæ ‡è®°è¯¥è¿›ç¨‹ï¼Œå¹¶è½¬å› 1ã€‚</li><li>å¦‚æœæ²¡æœ‰è¿™æ ·ä¸€ä¸ªè¿›ç¨‹ï¼Œç®—æ³•ç»ˆæ­¢ã€‚</li></ol><p>ï¼ˆä¸‰ï¼‰æ­»é”æ¢å¤</p><ul><li>åˆ©ç”¨æŠ¢å æ¢å¤</li><li>åˆ©ç”¨å›æ»šæ¢å¤</li><li>é€šè¿‡æ€æ­»è¿›ç¨‹æ¢å¤</li></ul><h3 id="3-æ­»é”é¢„é˜²"><a href="#3-æ­»é”é¢„é˜²" class="headerlink" title="3. æ­»é”é¢„é˜²"></a>3. æ­»é”é¢„é˜²</h3><p>åœ¨ç¨‹åºè¿è¡Œä¹‹å‰é¢„é˜²å‘ç”Ÿæ­»é”ã€‚</p><p>ï¼ˆä¸€ï¼‰ç ´åäº’æ–¥æ¡ä»¶</p><p>ä¾‹å¦‚å‡è„±æœºæ‰“å°æœºæŠ€æœ¯å…è®¸è‹¥å¹²ä¸ªè¿›ç¨‹åŒæ—¶è¾“å‡ºï¼Œå”¯ä¸€çœŸæ­£è¯·æ±‚ç‰©ç†æ‰“å°æœºçš„è¿›ç¨‹æ˜¯æ‰“å°æœºå®ˆæŠ¤è¿›ç¨‹ã€‚</p><p>ï¼ˆäºŒï¼‰ç ´åå æœ‰å’Œç­‰å¾…æ¡ä»¶</p><p>ä¸€ç§å®ç°æ–¹å¼æ˜¯è§„å®šæ‰€æœ‰è¿›ç¨‹åœ¨å¼€å§‹æ‰§è¡Œå‰è¯·æ±‚æ‰€éœ€è¦çš„å…¨éƒ¨èµ„æºã€‚</p><p>ï¼ˆä¸‰ï¼‰ç ´åä¸å¯æŠ¢å æ¡ä»¶</p><p>ï¼ˆå››ï¼‰ç ´åç¯è·¯ç­‰å¾…</p><p>ç»™èµ„æºç»Ÿä¸€ç¼–å·ï¼Œè¿›ç¨‹åªèƒ½æŒ‰ç¼–å·é¡ºåºæ¥è¯·æ±‚èµ„æºã€‚</p><h3 id="4-æ­»é”é¿å…"><a href="#4-æ­»é”é¿å…" class="headerlink" title="4. æ­»é”é¿å…"></a>4. æ­»é”é¿å…</h3><p>åœ¨ç¨‹åºè¿è¡Œæ—¶é¿å…å‘ç”Ÿæ­»é”ã€‚</p><p>ï¼ˆä¸€ï¼‰å®‰å…¨çŠ¶æ€</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044854.png"> </div><br></p><p>å›¾ a çš„ç¬¬äºŒåˆ— Has è¡¨ç¤ºå·²æ‹¥æœ‰çš„èµ„æºæ•°ï¼Œç¬¬ä¸‰åˆ— Max è¡¨ç¤ºæ€»å…±éœ€è¦çš„èµ„æºæ•°ï¼ŒFree è¡¨ç¤ºè¿˜æœ‰å¯ä»¥ä½¿ç”¨çš„èµ„æºæ•°ã€‚ä»å›¾ a å¼€å§‹å‡ºå‘ï¼Œå…ˆè®© B æ‹¥æœ‰æ‰€éœ€çš„æ‰€æœ‰èµ„æºï¼ˆå›¾ bï¼‰ï¼Œè¿è¡Œç»“æŸåé‡Šæ”¾ Bï¼Œæ­¤æ—¶ Free å˜ä¸º 5ï¼ˆå›¾ cï¼‰ï¼›æ¥ç€ä»¥åŒæ ·çš„æ–¹å¼è¿è¡Œ C å’Œ Aï¼Œä½¿å¾—æ‰€æœ‰è¿›ç¨‹éƒ½èƒ½æˆåŠŸè¿è¡Œï¼Œå› æ­¤å¯ä»¥ç§°å›¾ a æ‰€ç¤ºçš„çŠ¶æ€æ—¶å®‰å…¨çš„ã€‚</p><p>å®šä¹‰ï¼šå¦‚æœæ²¡æœ‰æ­»é”å‘ç”Ÿï¼Œå¹¶ä¸”å³ä½¿æ‰€æœ‰è¿›ç¨‹çªç„¶è¯·æ±‚å¯¹èµ„æºçš„æœ€å¤§éœ€æ±‚ï¼Œä¹Ÿä»ç„¶å­˜åœ¨æŸç§è°ƒåº¦æ¬¡åºèƒ½å¤Ÿä½¿å¾—æ¯ä¸€ä¸ªè¿›ç¨‹è¿è¡Œå®Œæ¯•ï¼Œåˆ™ç§°è¯¥çŠ¶æ€æ˜¯å®‰å…¨çš„ã€‚</p><p>å®‰å…¨çŠ¶æ€çš„æ£€æµ‹ä¸æ­»é”çš„æ£€æµ‹ç±»ä¼¼ï¼Œå› ä¸ºå®‰å…¨çŠ¶æ€å¿…é¡»è¦æ±‚ä¸èƒ½å‘ç”Ÿæ­»é”ã€‚ä¸‹é¢çš„é“¶è¡Œå®¶ç®—æ³•ä¸æ­»é”æ£€æµ‹ç®—æ³•éå¸¸ç±»ä¼¼ï¼Œå¯ä»¥ç»“åˆç€åšå‚è€ƒå¯¹æ¯”ã€‚</p><p>ï¼ˆäºŒï¼‰å•ä¸ªèµ„æºçš„é“¶è¡Œå®¶ç®—æ³•</p><p>ä¸€ä¸ªå°åŸé•‡çš„é“¶è¡Œå®¶ï¼Œä»–å‘ä¸€ç¾¤å®¢æˆ·åˆ†åˆ«æ‰¿è¯ºäº†ä¸€å®šçš„è´·æ¬¾é¢åº¦ï¼Œç®—æ³•è¦åšçš„æ˜¯åˆ¤æ–­å¯¹è¯·æ±‚çš„æ»¡è¶³æ˜¯å¦ä¼šè¿›å…¥ä¸å®‰å…¨çŠ¶æ€ï¼Œå¦‚æœæ˜¯ï¼Œå°±æ‹’ç»è¯·æ±‚ï¼›å¦åˆ™äºˆä»¥åˆ†é…ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044857.png"> </div><br></p><p>ä¸Šå›¾ c ä¸ºä¸å®‰å…¨çŠ¶æ€ï¼Œå› æ­¤ç®—æ³•ä¼šæ‹’ç»ä¹‹å‰çš„è¯·æ±‚ï¼Œä»è€Œé¿å…è¿›å…¥å›¾ c ä¸­çš„çŠ¶æ€ã€‚</p><p>ï¼ˆä¸‰ï¼‰å¤šä¸ªèµ„æºçš„é“¶è¡Œå®¶ç®—æ³•</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044858.png"> </div><br></p><p>ä¸Šå›¾ä¸­æœ‰äº”ä¸ªè¿›ç¨‹ï¼Œå››ä¸ªèµ„æºã€‚å·¦è¾¹çš„å›¾è¡¨ç¤ºå·²ç»åˆ†é…çš„èµ„æºï¼Œå³è¾¹çš„å›¾è¡¨ç¤ºè¿˜éœ€è¦åˆ†é…çš„èµ„æºã€‚æœ€å³è¾¹çš„ Eã€P ä»¥åŠ A åˆ†åˆ«è¡¨ç¤ºï¼šæ€»èµ„æºã€å·²åˆ†é…èµ„æºä»¥åŠå¯ç”¨èµ„æºï¼Œæ³¨æ„è¿™ä¸‰ä¸ªä¸ºå‘é‡ï¼Œè€Œä¸æ˜¯å…·ä½“æ•°å€¼ï¼Œä¾‹å¦‚ A=(1020)ï¼Œè¡¨ç¤º 4 ä¸ªèµ„æºåˆ†åˆ«è¿˜å‰©ä¸‹ 1/0/2/0ã€‚</p><p>æ£€æŸ¥ä¸€ä¸ªçŠ¶æ€æ˜¯å¦å®‰å…¨çš„ç®—æ³•å¦‚ä¸‹ï¼š</p><ul><li>æŸ¥æ‰¾å³è¾¹çš„çŸ©é˜µæ˜¯å¦å­˜åœ¨ä¸€è¡Œå°äºç­‰äºå‘é‡ Aã€‚å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„è¡Œï¼Œé‚£ä¹ˆç³»ç»Ÿå°†ä¼šå‘ç”Ÿæ­»é”ï¼ŒçŠ¶æ€æ˜¯ä¸å®‰å…¨çš„ã€‚</li><li>å‡è‹¥æ‰¾åˆ°è¿™æ ·ä¸€è¡Œï¼Œå°†è¯¥è¿›ç¨‹æ ‡è®°ä¸ºç»ˆæ­¢ï¼Œå¹¶å°†å…¶å·²åˆ†é…èµ„æºåŠ åˆ° A ä¸­ã€‚</li><li>é‡å¤ä»¥ä¸Šä¸¤æ­¥ï¼Œç›´åˆ°æ‰€æœ‰è¿›ç¨‹éƒ½æ ‡è®°ä¸ºç»ˆæ­¢ï¼Œåˆ™çŠ¶æ€æ—¶å®‰å…¨çš„ã€‚</li></ul><p>å¦‚æœä¸€ä¸ªçŠ¶æ€ä¸æ˜¯å®‰å…¨çš„ï¼Œéœ€è¦æ‹’ç»è¿›å…¥è¿™ä¸ªçŠ¶æ€ã€‚</p><h1 id="å››ã€å†…å­˜ç®¡ç†"><a href="#å››ã€å†…å­˜ç®¡ç†" class="headerlink" title="å››ã€å†…å­˜ç®¡ç†"></a>å››ã€å†…å­˜ç®¡ç†</h1><h2 id="è™šæ‹Ÿå†…å­˜"><a href="#è™šæ‹Ÿå†…å­˜" class="headerlink" title="è™šæ‹Ÿå†…å­˜"></a>è™šæ‹Ÿå†…å­˜</h2><p>è™šæ‹Ÿå†…å­˜çš„ç›®çš„æ˜¯ä¸ºäº†è®©ç‰©ç†å†…å­˜æ‰©å……æˆæ›´å¤§çš„é€»è¾‘å†…å­˜ï¼Œä»è€Œè®©ç¨‹åºè·å¾—æ›´å¤šçš„å¯ç”¨å†…å­˜ã€‚</p><p>ä¸ºäº†æ›´å¥½çš„ç®¡ç†å†…å­˜ï¼Œæ“ä½œç³»ç»Ÿå°†å†…å­˜æŠ½è±¡æˆåœ°å€ç©ºé—´ã€‚æ¯ä¸ªç¨‹åºæ‹¥æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ï¼Œè¿™ä¸ªåœ°å€ç©ºé—´è¢«åˆ†å‰²æˆå¤šä¸ªå—ï¼Œæ¯ä¸€å—ç§°ä¸ºä¸€é¡µã€‚è¿™äº›é¡µè¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œä½†ä¸éœ€è¦æ˜ å°„åˆ°è¿ç»­çš„ç‰©ç†å†…å­˜ï¼Œä¹Ÿä¸éœ€è¦æ‰€æœ‰é¡µéƒ½å¿…é¡»åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚å½“ç¨‹åºå¼•ç”¨åˆ°ä¸€éƒ¨åˆ†ä¸åœ¨ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ç©ºé—´æ—¶ï¼Œç”±ç¡¬ä»¶æ‰§è¡Œå¿…è¦çš„æ˜ å°„ï¼Œå°†ç¼ºå¤±çš„éƒ¨åˆ†è£…å…¥ç‰©ç†å†…å­˜å¹¶é‡æ–°æ‰§è¡Œå¤±è´¥çš„æŒ‡ä»¤ã€‚</p><p>ä»ä¸Šé¢çš„æè¿°ä¸­å¯ä»¥çœ‹å‡ºï¼Œè™šæ‹Ÿå†…å­˜å…è®¸ç¨‹åºä¸ç”¨å°†åœ°å€ç©ºé—´ä¸­çš„æ¯ä¸€é¡µéƒ½æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªç¨‹åºä¸éœ€è¦å…¨éƒ¨è°ƒå…¥å†…å­˜å°±å¯ä»¥è¿è¡Œï¼Œè¿™ä½¿å¾—æœ‰é™çš„å†…å­˜è¿è¡Œå¤§ç¨‹åºç§°ä¸ºå¯èƒ½ã€‚ä¾‹å¦‚æœ‰ä¸€å°è®¡ç®—æœºå¯ä»¥äº§ç”Ÿ 16 ä½åœ°å€ï¼Œé‚£ä¹ˆä¸€ä¸ªç¨‹åºçš„åœ°å€ç©ºé—´èŒƒå›´æ˜¯ 0~64Kã€‚è¯¥è®¡ç®—æœºåªæœ‰ 32KB çš„ç‰©ç†å†…å­˜ï¼Œè™šæ‹Ÿå†…å­˜æŠ€æœ¯å…è®¸è¯¥è®¡ç®—æœºè¿è¡Œä¸€ä¸ª 64K å¤§å°çš„ç¨‹åºã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044903.png"> </div><br></p><h2 id="åˆ†é¡µç³»ç»Ÿåœ°å€æ˜ å°„"><a href="#åˆ†é¡µç³»ç»Ÿåœ°å€æ˜ å°„" class="headerlink" title="åˆ†é¡µç³»ç»Ÿåœ°å€æ˜ å°„"></a>åˆ†é¡µç³»ç»Ÿåœ°å€æ˜ å°„</h2><ul><li>å†…å­˜ç®¡ç†å•å…ƒï¼ˆMMUï¼‰ï¼šç®¡ç†ç€åœ°å€ç©ºé—´å’Œç‰©ç†å†…å­˜çš„è½¬æ¢ã€‚</li><li>é¡µè¡¨ï¼ˆPage tableï¼‰ï¼šé¡µï¼ˆåœ°å€ç©ºé—´ï¼‰å’Œé¡µæ¡†ï¼ˆç‰©ç†å†…å­˜ç©ºé—´ï¼‰çš„æ˜ å°„è¡¨ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼Œé¡µè¡¨çš„ç¬¬ 0 ä¸ªè¡¨é¡¹ä¸º 010ï¼Œè¡¨ç¤ºç¬¬ 0 ä¸ªé¡µæ˜ å°„åˆ°ç¬¬ 2 ä¸ªé¡µæ¡†ã€‚é¡µè¡¨é¡¹çš„æœ€åä¸€ä½ç”¨æ¥æ ‡è®°é¡µæ˜¯å¦åœ¨å†…å­˜ä¸­ã€‚</li></ul><p>ä¸‹å›¾çš„é¡µè¡¨å­˜æ”¾ç€ 16 ä¸ªé¡µï¼Œè¿™ 16 ä¸ªé¡µéœ€è¦ç”¨ 4 ä¸ªæ¯”ç‰¹ä½æ¥è¿›è¡Œç´¢å¼•å®šä½ã€‚å› æ­¤å¯¹äºè™šæ‹Ÿåœ°å€ï¼ˆ0010 000000000100ï¼‰ï¼Œå‰ 4 ä½æ˜¯ç”¨æ¥å­˜å‚¨é¡µé¢å·ï¼Œè€Œå 12 ä½å­˜å‚¨åœ¨é¡µä¸­çš„åç§»é‡ã€‚</p><p>ï¼ˆ0010 000000000100ï¼‰æ ¹æ®å‰ 4 ä½å¾—åˆ°é¡µå·ä¸º 2ï¼Œè¯»å–è¡¨é¡¹å†…å®¹ä¸ºï¼ˆ110 1ï¼‰ï¼Œå®ƒçš„å‰ 3 ä¸ºä¸ºé¡µæ¡†å·ï¼Œæœ€å 1 ä½è¡¨ç¤ºè¯¥é¡µåœ¨å†…å­˜ä¸­ã€‚æœ€åæ˜ å°„å¾—åˆ°ç‰©ç†å†…å­˜åœ°å€ä¸ºï¼ˆ110 000000000100ï¼‰ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044906.png" width="500"> </div><br></p><h2 id="é¡µé¢ç½®æ¢ç®—æ³•"><a href="#é¡µé¢ç½®æ¢ç®—æ³•" class="headerlink" title="é¡µé¢ç½®æ¢ç®—æ³•"></a>é¡µé¢ç½®æ¢ç®—æ³•</h2><p>åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœè¦è®¿é—®çš„é¡µé¢ä¸åœ¨å†…å­˜ä¸­ï¼Œå°±å‘ç”Ÿç¼ºé¡µä¸­æ–­ä»è€Œå°†è¯¥é¡µè°ƒå…¥å†…å­˜ä¸­ã€‚æ­¤æ—¶å¦‚æœå†…å­˜å·²æ— ç©ºé—²ç©ºé—´ï¼Œç³»ç»Ÿå¿…é¡»ä»å†…å­˜ä¸­è°ƒå‡ºä¸€ä¸ªé¡µé¢åˆ°ç£ç›˜å¯¹æ¢åŒºä¸­æ¥è…¾å‡ºç©ºé—´ã€‚</p><p>é¡µé¢ç½®æ¢ç®—æ³•å’Œç¼“å­˜æ·˜æ±°ç­–ç•¥ç±»ä¼¼ï¼Œå¯ä»¥å°†å†…å­˜çœ‹æˆç£ç›˜çš„ç¼“å­˜ã€‚åœ¨ç¼“å­˜ç³»ç»Ÿä¸­ï¼Œç¼“å­˜çš„å¤§å°æœ‰é™ï¼Œå½“æœ‰æ–°çš„ç¼“å­˜åˆ°è¾¾æ—¶ï¼Œéœ€è¦æ·˜æ±°ä¸€éƒ¨åˆ†å·²ç»å­˜åœ¨çš„ç¼“å­˜ï¼Œè¿™æ ·æ‰æœ‰ç©ºé—´å­˜æ”¾æ–°çš„ç¼“å­˜æ•°æ®ã€‚</p><p>é¡µé¢ç½®æ¢ç®—æ³•çš„ä¸»è¦ç›®æ ‡æ˜¯ä½¿é¡µé¢ç½®æ¢é¢‘ç‡æœ€ä½ï¼ˆä¹Ÿå¯ä»¥è¯´ç¼ºé¡µç‡æœ€ä½ï¼‰ã€‚</p><h3 id="1-æœ€ä½³"><a href="#1-æœ€ä½³" class="headerlink" title="1. æœ€ä½³"></a>1. æœ€ä½³</h3><blockquote><p>Optimal</p></blockquote><p>æ‰€é€‰æ‹©çš„è¢«æ¢å‡ºçš„é¡µé¢å°†æ˜¯æœ€é•¿æ—¶é—´å†…ä¸å†è¢«è®¿é—®ï¼Œé€šå¸¸å¯ä»¥ä¿è¯è·å¾—æœ€ä½çš„ç¼ºé¡µç‡ã€‚</p><p>æ˜¯ä¸€ç§ç†è®ºä¸Šçš„ç®—æ³•ï¼Œå› ä¸ºæ— æ³•çŸ¥é“ä¸€ä¸ªé¡µé¢å¤šé•¿æ—¶é—´ä¸å†è¢«è®¿é—®ã€‚</p><p>ä¸¾ä¾‹ï¼šä¸€ä¸ªç³»ç»Ÿä¸ºæŸè¿›ç¨‹åˆ†é…äº†ä¸‰ä¸ªç‰©ç†å—ï¼Œå¹¶æœ‰å¦‚ä¸‹é¡µé¢å¼•ç”¨åºåˆ—ï¼š</p><p><div align="center"><img src="https://latex.codecogs.com/gif.latex?7ï¼Œ0ï¼Œ1ï¼Œ2ï¼Œ0ï¼Œ3ï¼Œ0ï¼Œ4ï¼Œ2ï¼Œ3ï¼Œ0ï¼Œ3ï¼Œ2ï¼Œ1ï¼Œ2ï¼Œ0ï¼Œ1ï¼Œ7ï¼Œ0ï¼Œ1"></div> <br></p><p>å¼€å§‹è¿è¡Œæ—¶ï¼Œå…ˆå°† 7, 0, 1 ä¸‰ä¸ªé¡µé¢è£…å…¥å†…å­˜ã€‚å½“è¿›ç¨‹è¦è®¿é—®é¡µé¢ 2 æ—¶ï¼Œäº§ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œä¼šå°†é¡µé¢ 7 æ¢å‡ºï¼Œå› ä¸ºé¡µé¢ 7 å†æ¬¡è¢«è®¿é—®çš„æ—¶é—´æœ€é•¿ã€‚</p><h3 id="2-æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨"><a href="#2-æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨" class="headerlink" title="2. æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨"></a>2. æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨</h3><blockquote><p>LRU, Least Recently Used</p></blockquote><p>è™½ç„¶æ— æ³•çŸ¥é“å°†æ¥è¦ä½¿ç”¨çš„é¡µé¢æƒ…å†µï¼Œä½†æ˜¯å¯ä»¥çŸ¥é“è¿‡å»ä½¿ç”¨é¡µé¢çš„æƒ…å†µã€‚LRU å°†æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢æ¢å‡ºã€‚</p><p>ä¸ºäº†å®ç° LRUï¼Œéœ€è¦åœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªæ‰€æœ‰é¡µé¢çš„é“¾è¡¨ã€‚å½“ä¸€ä¸ªé¡µé¢è¢«è®¿é—®æ—¶ï¼Œå°†è¿™ä¸ªé¡µé¢ç§»åˆ°é“¾è¡¨è¡¨å¤´ã€‚è¿™æ ·å°±èƒ½ä¿è¯é“¾è¡¨è¡¨å°¾çš„é¡µé¢æ—¶æœ€è¿‘æœ€ä¹…æœªè®¿é—®çš„ã€‚</p><p>å› ä¸ºæ¯æ¬¡è®¿é—®éƒ½éœ€è¦æ›´æ–°é“¾è¡¨ï¼Œå› æ­¤è¿™ç§æ–¹å¼å®ç°çš„ LRU ä»£ä»·å¾ˆé«˜ã€‚</p><p><div align="center"><img src="https://latex.codecogs.com/gif.latex?4ï¼Œ7ï¼Œ0ï¼Œ7ï¼Œ1ï¼Œ0ï¼Œ1ï¼Œ2ï¼Œ1ï¼Œ2ï¼Œ6"></div> <br></p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044930.png"> </div><br></p><h3 id="3-æœ€è¿‘æœªä½¿ç”¨"><a href="#3-æœ€è¿‘æœªä½¿ç”¨" class="headerlink" title="3. æœ€è¿‘æœªä½¿ç”¨"></a>3. æœ€è¿‘æœªä½¿ç”¨</h3><blockquote><p>NRU, Not Recently Used</p></blockquote><p>æ¯ä¸ªé¡µé¢éƒ½æœ‰ä¸¤ä¸ªçŠ¶æ€ä½ï¼šR ä¸ Mï¼Œå½“é¡µé¢è¢«è®¿é—®æ—¶è®¾ç½®é¡µé¢çš„ R=1ï¼Œå½“é¡µé¢è¢«ä¿®æ”¹æ—¶è®¾ç½® M=1ã€‚å…¶ä¸­ R ä½ä¼šå®šæ—¶è¢«æ¸…é›¶ã€‚å¯ä»¥å°†é¡µé¢åˆ†æˆä»¥ä¸‹å››ç±»ï¼š</p><ul><li>R=0ï¼ŒM=0</li><li>R=0ï¼ŒM=1</li><li>R=1ï¼ŒM=0</li><li>R=1ï¼ŒM=1</li></ul><p>å½“å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼ŒNRU ç®—æ³•éšæœºåœ°ä»ç±»ç¼–å·æœ€å°çš„éç©ºç±»ä¸­æŒ‘é€‰ä¸€ä¸ªé¡µé¢å°†å®ƒæ¢å‡ºã€‚</p><p>NRU ä¼˜å…ˆæ¢å‡ºå·²ç»è¢«ä¿®æ”¹çš„è„é¡µé¢ï¼ˆR=0ï¼ŒM=1ï¼‰ï¼Œè€Œä¸æ˜¯è¢«é¢‘ç¹ä½¿ç”¨çš„å¹²å‡€é¡µé¢ï¼ˆR=1ï¼ŒM=0ï¼‰ã€‚</p><h3 id="4-å…ˆè¿›å…ˆå‡º"><a href="#4-å…ˆè¿›å…ˆå‡º" class="headerlink" title="4. å…ˆè¿›å…ˆå‡º"></a>4. å…ˆè¿›å…ˆå‡º</h3><blockquote><p>FIFO, First In First Out</p></blockquote><p>é€‰æ‹©æ¢å‡ºçš„é¡µé¢æ˜¯æœ€å…ˆè¿›å…¥çš„é¡µé¢ã€‚</p><p>è¯¥ç®—æ³•ä¼šå°†é‚£äº›ç»å¸¸è¢«è®¿é—®çš„é¡µé¢ä¹Ÿè¢«æ¢å‡ºï¼Œä»è€Œä½¿ç¼ºé¡µç‡å‡é«˜ã€‚</p><h3 id="5-ç¬¬äºŒæ¬¡æœºä¼šç®—æ³•"><a href="#5-ç¬¬äºŒæ¬¡æœºä¼šç®—æ³•" class="headerlink" title="5. ç¬¬äºŒæ¬¡æœºä¼šç®—æ³•"></a>5. ç¬¬äºŒæ¬¡æœºä¼šç®—æ³•</h3><p>FIFO ç®—æ³•å¯èƒ½ä¼šæŠŠç»å¸¸ä½¿ç”¨çš„é¡µé¢ç½®æ¢å‡ºå»ï¼Œä¸ºäº†é¿å…è¿™ä¸€é—®é¢˜ï¼Œå¯¹è¯¥ç®—æ³•åšä¸€ä¸ªç®€å•çš„ä¿®æ”¹ï¼š</p><p>å½“é¡µé¢è¢«è®¿é—® (è¯»æˆ–å†™) æ—¶è®¾ç½®è¯¥é¡µé¢çš„ R ä½ä¸º 1ã€‚éœ€è¦æ›¿æ¢çš„æ—¶å€™ï¼Œæ£€æŸ¥æœ€è€é¡µé¢çš„ R ä½ã€‚å¦‚æœ R ä½æ˜¯ 0ï¼Œé‚£ä¹ˆè¿™ä¸ªé¡µé¢æ—¢è€åˆæ²¡æœ‰è¢«ä½¿ç”¨ï¼Œå¯ä»¥ç«‹åˆ»ç½®æ¢æ‰ï¼›å¦‚æœæ˜¯ 1ï¼Œå°±å°† R ä½æ¸… 0ï¼Œå¹¶æŠŠè¯¥é¡µé¢æ”¾åˆ°é“¾è¡¨çš„å°¾ç«¯ï¼Œä¿®æ”¹å®ƒçš„è£…å…¥æ—¶é—´ä½¿å®ƒå°±åƒåˆšè£…å…¥çš„ä¸€æ ·ï¼Œç„¶åç»§ç»­ä»é“¾è¡¨çš„å¤´éƒ¨å¼€å§‹æœç´¢ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044934.png"> </div><br></p><h3 id="6-æ—¶é’Ÿ"><a href="#6-æ—¶é’Ÿ" class="headerlink" title="6. æ—¶é’Ÿ"></a>6. æ—¶é’Ÿ</h3><blockquote><p>Clock</p></blockquote><p>ç¬¬äºŒæ¬¡æœºä¼šç®—æ³•éœ€è¦åœ¨é“¾è¡¨ä¸­ç§»åŠ¨é¡µé¢ï¼Œé™ä½äº†æ•ˆç‡ã€‚æ—¶é’Ÿç®—æ³•ä½¿ç”¨ç¯å½¢é“¾è¡¨å°†é¡µé¢é“¾æ¥èµ·æ¥ï¼Œå†ä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æœ€è€çš„é¡µé¢ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044939.png"> </div><br></p><h2 id="åˆ†æ®µ"><a href="#åˆ†æ®µ" class="headerlink" title="åˆ†æ®µ"></a>åˆ†æ®µ</h2><p>è™šæ‹Ÿå†…å­˜é‡‡ç”¨çš„æ˜¯åˆ†é¡µæŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯å°†åœ°å€ç©ºé—´åˆ’åˆ†æˆå›ºå®šå¤§å°çš„é¡µï¼Œæ¯ä¸€é¡µå†ä¸å†…å­˜è¿›è¡Œæ˜ å°„ã€‚</p><p>ä¸‹å›¾ä¸ºä¸€ä¸ªç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å»ºç«‹çš„å¤šä¸ªè¡¨ï¼Œæœ‰ 4 ä¸ªè¡¨æ˜¯åŠ¨æ€å¢é•¿çš„ï¼Œå¦‚æœä½¿ç”¨åˆ†é¡µç³»ç»Ÿçš„ä¸€ç»´åœ°å€ç©ºé—´ï¼ŒåŠ¨æ€å¢é•¿çš„ç‰¹ç‚¹ä¼šå¯¼è‡´è¦†ç›–é—®é¢˜çš„å‡ºç°ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044943.png"> </div><br></p><p>åˆ†æ®µçš„åšæ³•æ˜¯æŠŠæ¯ä¸ªè¡¨åˆ†æˆæ®µï¼Œä¸€ä¸ªæ®µæ„æˆä¸€ä¸ªç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€‚æ¯ä¸ªæ®µçš„é•¿åº¦å¯ä»¥ä¸åŒï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€å¢é•¿ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044946.png"> </div><br></p><h2 id="æ®µé¡µå¼"><a href="#æ®µé¡µå¼" class="headerlink" title="æ®µé¡µå¼"></a>æ®µé¡µå¼</h2><p>ç¨‹åºçš„åœ°å€ç©ºé—´åˆ’åˆ†æˆå¤šä¸ªæ‹¥æœ‰ç‹¬ç«‹åœ°å€ç©ºé—´çš„æ®µï¼Œæ¯ä¸ªæ®µä¸Šçš„åœ°å€ç©ºé—´åˆ’åˆ†æˆå¤§å°ç›¸åŒçš„é¡µã€‚è¿™æ ·æ—¢æ‹¥æœ‰åˆ†æ®µç³»ç»Ÿçš„å…±äº«å’Œä¿æŠ¤ï¼Œåˆæ‹¥æœ‰åˆ†é¡µç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜åŠŸèƒ½ã€‚</p><h2 id="åˆ†é¡µä¸åˆ†æ®µçš„æ¯”è¾ƒ"><a href="#åˆ†é¡µä¸åˆ†æ®µçš„æ¯”è¾ƒ" class="headerlink" title="åˆ†é¡µä¸åˆ†æ®µçš„æ¯”è¾ƒ"></a>åˆ†é¡µä¸åˆ†æ®µçš„æ¯”è¾ƒ</h2><ul><li><p>å¯¹ç¨‹åºå‘˜çš„é€æ˜æ€§ï¼šåˆ†é¡µé€æ˜ï¼Œä½†æ˜¯åˆ†æ®µéœ€è¦ç¨‹åºå‘˜æ˜¾ç¤ºåˆ’åˆ†æ¯ä¸ªæ®µã€‚</p></li><li><p>åœ°å€ç©ºé—´çš„ç»´åº¦ï¼šåˆ†é¡µæ˜¯ä¸€ç»´åœ°å€ç©ºé—´ï¼Œåˆ†æ®µæ˜¯äºŒç»´çš„ã€‚</p></li><li><p>å¤§å°æ˜¯å¦å¯ä»¥æ”¹å˜ï¼šé¡µçš„å¤§å°ä¸å¯å˜ï¼Œæ®µçš„å¤§å°å¯ä»¥åŠ¨æ€æ”¹å˜ã€‚</p></li><li><p>å‡ºç°çš„åŸå› ï¼šåˆ†é¡µä¸»è¦ç”¨äºå®ç°è™šæ‹Ÿå†…å­˜ï¼Œä»è€Œè·å¾—æ›´å¤§çš„åœ°å€ç©ºé—´ï¼›åˆ†æ®µä¸»è¦æ˜¯ä¸ºäº†ä½¿ç¨‹åºå’Œæ•°æ®å¯ä»¥è¢«åˆ’åˆ†ä¸ºé€»è¾‘ä¸Šç‹¬ç«‹çš„åœ°å€ç©ºé—´å¹¶ä¸”æœ‰åŠ©äºå…±äº«å’Œä¿æŠ¤ã€‚</p></li></ul><h1 id="äº”ã€è®¾å¤‡ç®¡ç†"><a href="#äº”ã€è®¾å¤‡ç®¡ç†" class="headerlink" title="äº”ã€è®¾å¤‡ç®¡ç†"></a>äº”ã€è®¾å¤‡ç®¡ç†</h1><h2 id="ç£ç›˜è°ƒåº¦ç®—æ³•"><a href="#ç£ç›˜è°ƒåº¦ç®—æ³•" class="headerlink" title="ç£ç›˜è°ƒåº¦ç®—æ³•"></a>ç£ç›˜è°ƒåº¦ç®—æ³•</h2><p>è¯»å†™ä¸€ä¸ªç£ç›˜å—çš„æ—¶é—´çš„å½±å“å› ç´ æœ‰ï¼š</p><ul><li>æ—‹è½¬æ—¶é—´ï¼ˆä¸»è½´æ—‹è½¬ç£ç›˜ï¼Œä½¿å¾—ç£å¤´ç§»åŠ¨åˆ°é€‚å½“çš„æ‰‡åŒºä¸Šï¼‰</li><li>å¯»é“æ—¶é—´ï¼ˆåˆ¶åŠ¨æ‰‹è‡‚ç§»åŠ¨ï¼Œä½¿å¾—ç£å¤´ç§»åŠ¨åˆ°é€‚å½“çš„ç£é“ä¸Šï¼‰</li><li>å®é™…çš„æ•°æ®ä¼ è¾“æ—¶é—´</li></ul><p>å…¶ä¸­ï¼Œå¯»é“æ—¶é—´æœ€é•¿ï¼Œå› æ­¤ç£ç›˜è°ƒåº¦çš„ä¸»è¦ç›®æ ‡æ˜¯ä½¿ç£ç›˜çš„å¹³å‡å¯»é“æ—¶é—´æœ€çŸ­ã€‚</p><h3 id="1-å…ˆæ¥å…ˆæœåŠ¡"><a href="#1-å…ˆæ¥å…ˆæœåŠ¡" class="headerlink" title="1. å…ˆæ¥å…ˆæœåŠ¡"></a>1. å…ˆæ¥å…ˆæœåŠ¡</h3><blockquote><p>FCFS, First Come First Served</p></blockquote><p>æŒ‰ç…§ç£ç›˜è¯·æ±‚çš„é¡ºåºè¿›è¡Œè°ƒåº¦ã€‚</p><p>ä¼˜ç‚¹æ˜¯å…¬å¹³å’Œç®€å•ã€‚ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå› ä¸ºæœªå¯¹å¯»é“åšä»»ä½•ä¼˜åŒ–ï¼Œä½¿å¹³å‡å¯»é“æ—¶é—´å¯èƒ½è¾ƒé•¿ã€‚</p><h3 id="2-æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ"><a href="#2-æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ" class="headerlink" title="2. æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ"></a>2. æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ</h3><blockquote><p>SSTF, Shortest Seek Time First</p></blockquote><p>ä¼˜å…ˆè°ƒåº¦ä¸å½“å‰ç£å¤´æ‰€åœ¨ç£é“è·ç¦»æœ€è¿‘çš„ç£é“ã€‚</p><p>è™½ç„¶å¹³å‡å¯»é“æ—¶é—´æ¯”è¾ƒä½ï¼Œä½†æ˜¯ä¸å¤Ÿå…¬å¹³ã€‚å¦‚æœæ–°åˆ°è¾¾çš„ç£é“è¯·æ±‚æ€»æ˜¯æ¯”ä¸€ä¸ªåœ¨ç­‰å¾…çš„ç£é“è¯·æ±‚è¿‘ï¼Œé‚£ä¹ˆåœ¨ç­‰å¾…çš„ç£é“è¯·æ±‚ä¼šä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œä¹Ÿå°±æ˜¯å‡ºç°é¥¥é¥¿ç°è±¡ã€‚å…·ä½“æ¥è¯´ï¼Œä¸¤è¾¹çš„ç£é“è¯·æ±‚æ›´å®¹æ˜“å‡ºç°é¥¥é¥¿ç°è±¡ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044954.png"> </div><br></p><h3 id="3-ç”µæ¢¯ç®—æ³•"><a href="#3-ç”µæ¢¯ç®—æ³•" class="headerlink" title="3. ç”µæ¢¯ç®—æ³•"></a>3. ç”µæ¢¯ç®—æ³•</h3><blockquote><p>SCAN</p></blockquote><p>ç”µæ¢¯æ€»æ˜¯ä¿æŒä¸€ä¸ªæ–¹å‘è¿è¡Œï¼Œç›´åˆ°è¯¥æ–¹å‘æ²¡æœ‰è¯·æ±‚ä¸ºæ­¢ï¼Œç„¶åæ”¹å˜è¿è¡Œæ–¹å‘ã€‚</p><p>ç”µæ¢¯ç®—æ³•ï¼ˆæ‰«æç®—æ³•ï¼‰å’Œç”µæ¢¯çš„è¿è¡Œè¿‡ç¨‹ç±»ä¼¼ï¼Œæ€»æ˜¯æŒ‰ä¸€ä¸ªæ–¹å‘æ¥è¿›è¡Œç£ç›˜è°ƒåº¦ï¼Œç›´åˆ°è¯¥æ–¹å‘ä¸Šæ²¡æœ‰æœªå®Œæˆçš„ç£ç›˜è¯·æ±‚ï¼Œç„¶åæ”¹å˜æ–¹å‘ã€‚</p><p>å› ä¸ºè€ƒè™‘äº†ç§»åŠ¨æ–¹å‘ï¼Œå› æ­¤æ‰€æœ‰çš„ç£ç›˜è¯·æ±‚éƒ½ä¼šè¢«æ»¡è¶³ï¼Œè§£å†³äº† SSTF çš„é¥¥é¥¿é—®é¢˜ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-044957.png"> </div><br></p><h1 id="å…­ã€é“¾æ¥"><a href="#å…­ã€é“¾æ¥" class="headerlink" title="å…­ã€é“¾æ¥"></a>å…­ã€é“¾æ¥</h1><h2 id="ç¼–è¯‘ç³»ç»Ÿ"><a href="#ç¼–è¯‘ç³»ç»Ÿ" class="headerlink" title="ç¼–è¯‘ç³»ç»Ÿ"></a>ç¼–è¯‘ç³»ç»Ÿ</h2><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ª hello.c ç¨‹åºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"hello, world\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ Unix ç³»ç»Ÿä¸Šï¼Œç”±ç¼–è¯‘å™¨æŠŠæºæ–‡ä»¶è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o hello hello.c</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045001.jpg" width="800"> </div><br></p><ul><li>é¢„å¤„ç†é˜¶æ®µï¼šå¤„ç†ä»¥ # å¼€å¤´çš„é¢„å¤„ç†å‘½ä»¤ï¼›</li><li>ç¼–è¯‘é˜¶æ®µï¼šç¿»è¯‘æˆæ±‡ç¼–æ–‡ä»¶ï¼›</li><li>æ±‡ç¼–é˜¶æ®µï¼šå°†æ±‡ç¼–æ–‡ä»¶ç¿»è¯‘æˆå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ï¼›</li><li>é“¾æ¥é˜¶æ®µï¼šå°†å¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶å’Œ printf.o ç­‰å•ç‹¬é¢„ç¼–è¯‘å¥½çš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼Œå¾—åˆ°æœ€ç»ˆçš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ã€‚</li></ul><h2 id="é™æ€é“¾æ¥"><a href="#é™æ€é“¾æ¥" class="headerlink" title="é™æ€é“¾æ¥"></a>é™æ€é“¾æ¥</h2><p>é™æ€è¿æ¥å™¨ä»¥ä¸€ç»„å¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªå®Œå…¨é“¾æ¥çš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä½œä¸ºè¾“å‡ºã€‚é“¾æ¥å™¨ä¸»è¦å®Œæˆä»¥ä¸‹ä¸¤ä¸ªä»»åŠ¡ï¼š</p><ul><li>ç¬¦å·è§£æï¼šæ¯ä¸ªç¬¦å·å¯¹åº”äºä¸€ä¸ªå‡½æ•°ã€ä¸€ä¸ªå…¨å±€å˜é‡æˆ–ä¸€ä¸ªé™æ€å˜é‡ï¼Œç¬¦å·è§£æçš„ç›®çš„æ˜¯å°†æ¯ä¸ªç¬¦å·å¼•ç”¨ä¸ä¸€ä¸ªç¬¦å·å®šä¹‰å…³è”èµ·æ¥ã€‚</li><li>é‡å®šä½ï¼šé“¾æ¥å™¨é€šè¿‡æŠŠæ¯ä¸ªç¬¦å·å®šä¹‰ä¸ä¸€ä¸ªå†…å­˜ä½ç½®å…³è”èµ·æ¥ï¼Œç„¶åä¿®æ”¹æ‰€æœ‰å¯¹è¿™äº›ç¬¦å·çš„å¼•ç”¨ï¼Œä½¿å¾—å®ƒä»¬æŒ‡å‘è¿™ä¸ªå†…å­˜ä½ç½®ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045003.jpg"> </div><br></p><h2 id="ç›®æ ‡æ–‡ä»¶"><a href="#ç›®æ ‡æ–‡ä»¶" class="headerlink" title="ç›®æ ‡æ–‡ä»¶"></a>ç›®æ ‡æ–‡ä»¶</h2><ul><li>å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ï¼šå¯ä»¥ç›´æ¥åœ¨å†…å­˜ä¸­æ‰§è¡Œï¼›</li><li>å¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ï¼šå¯ä¸å…¶å®ƒå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶åœ¨é“¾æ¥é˜¶æ®µåˆå¹¶ï¼Œåˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ï¼›</li><li>å…±äº«ç›®æ ‡æ–‡ä»¶ï¼šè¿™æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶è¢«åŠ¨æ€åŠ è½½è¿›å†…å­˜å¹¶é“¾æ¥ï¼›</li></ul><h2 id="åŠ¨æ€é“¾æ¥"><a href="#åŠ¨æ€é“¾æ¥" class="headerlink" title="åŠ¨æ€é“¾æ¥"></a>åŠ¨æ€é“¾æ¥</h2><p>é™æ€åº“æœ‰ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>å½“é™æ€åº“æ›´æ–°æ—¶é‚£ä¹ˆæ•´ä¸ªç¨‹åºéƒ½è¦é‡æ–°è¿›è¡Œé“¾æ¥ï¼›</li><li>å¯¹äº printf è¿™ç§æ ‡å‡†å‡½æ•°åº“ï¼Œå¦‚æœæ¯ä¸ªç¨‹åºéƒ½è¦æœ‰ä»£ç ï¼Œè¿™ä¼šæå¤§æµªè´¹èµ„æºã€‚</li></ul><p>å…±äº«åº“æ˜¯ä¸ºäº†è§£å†³é™æ€åº“çš„è¿™ä¸¤ä¸ªé—®é¢˜è€Œè®¾è®¡çš„ï¼Œåœ¨ Linux ç³»ç»Ÿä¸­é€šå¸¸ç”¨ .so åç¼€æ¥è¡¨ç¤ºï¼ŒWindows ç³»ç»Ÿä¸Šå®ƒä»¬è¢«ç§°ä¸º DLLã€‚å®ƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>åœ¨ç»™å®šçš„æ–‡ä»¶ç³»ç»Ÿä¸­ä¸€ä¸ªåº“åªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€æœ‰å¼•ç”¨è¯¥åº“çš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶éƒ½å…±äº«è¿™ä¸ªæ–‡ä»¶ï¼Œå®ƒä¸ä¼šè¢«å¤åˆ¶åˆ°å¼•ç”¨å®ƒçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼›</li><li>åœ¨å†…å­˜ä¸­ï¼Œä¸€ä¸ªå…±äº«åº“çš„ .text èŠ‚ï¼ˆå·²ç¼–è¯‘ç¨‹åºçš„æœºå™¨ä»£ç ï¼‰çš„ä¸€ä¸ªå‰¯æœ¬å¯ä»¥è¢«ä¸åŒçš„æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å…±äº«ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-045009.jpg"> </div><br></p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>Tanenbaum A S, Bos H. Modern operating systems[M]. Prentice Hall Press, 2014.</li><li>æ±¤å­ç€›, å“²å‡¤å±, æ±¤å°ä¸¹. è®¡ç®—æœºæ“ä½œç³»ç»Ÿ[M]. è¥¿å®‰ç”µå­ç§‘æŠ€å¤§å­¦å‡ºç‰ˆç¤¾, 2001.</li><li>Bryant, R. E., &amp; Oâ€™Hallaron, D. R. (2004). æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ.</li><li><a href="https://applied-programming.github.io/Operating-Systems-Notes/" target="_blank" rel="noopener">Operating System Notes</a></li><li><a href="http://blog.csdn.net/yufaw/article/details/7409596" target="_blank" rel="noopener">è¿›ç¨‹é—´çš„å‡ ç§é€šä¿¡æ–¹å¼</a></li><li><a href="https://www.cs.uic.edu/\~jbell/CourseNotes/OperatingSystems/2_Structures.html" target="_blank" rel="noopener">Operating-System Structures</a></li><li><a href="http://cse.csusb.edu/tongyu/courses/cs460/notes/process.php" target="_blank" rel="noopener">Processes</a></li><li><a href="https://www.slideshare.net/rkolahalam/inter-process-communication-presentation1" target="_blank" rel="noopener">Inter Process Communication Presentation[1]</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- GFM-TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸€æ¦‚è¿°&quot;&gt;ä¸€ã€æ¦‚è¿°&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#æ“ä½œç³»ç»ŸåŸºæœ¬ç‰¹å¾&quot;&gt;æ“ä½œç³»ç»ŸåŸºæœ¬ç‰¹å¾&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#æ“ä½œç³»ç»ŸåŸºæœ¬åŠŸèƒ½&quot;&gt;æ“ä½œç³»ç»ŸåŸºæœ¬åŠŸèƒ½&lt;/a&gt;&lt;/li&gt;
&lt;l
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Interview-Notebook" scheme="https://airpoet.github.io/categories/Github/Interview-Notebook/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•</title>
    <link href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E7%AE%97%E6%B3%95/"/>
    <id>https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/ç®—æ³•/</id>
    <published>2018-07-04T13:51:06.360Z</published>
    <updated>2018-07-09T07:07:03.526Z</updated>
    
    <content type="html"><![CDATA[<!-- GFM-TOC --><ul><li><a href="#ä¸€å‰è¨€">ä¸€ã€å‰è¨€</a></li><li><a href="#äºŒç®—æ³•åˆ†æ">äºŒã€ç®—æ³•åˆ†æ</a><ul><li><a href="#æ•°å­¦æ¨¡å‹">æ•°å­¦æ¨¡å‹</a></li><li><a href="#threesum">ThreeSum</a></li><li><a href="#å€ç‡å®éªŒ">å€ç‡å®éªŒ</a></li><li><a href="#æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</a></li></ul></li><li><a href="#ä¸‰æ ˆå’Œé˜Ÿåˆ—">ä¸‰ã€æ ˆå’Œé˜Ÿåˆ—</a><ul><li><a href="#æ ˆ">æ ˆ</a></li><li><a href="#é˜Ÿåˆ—">é˜Ÿåˆ—</a></li></ul></li><li><a href="#å››å¹¶æŸ¥é›†">å››ã€å¹¶æŸ¥é›†</a><ul><li><a href="#quick-find">quick-find</a></li><li><a href="#quick-union">quick-union</a></li><li><a href="#åŠ æƒ-quick-union">åŠ æƒ quick-union</a></li><li><a href="#è·¯å¾„å‹ç¼©çš„åŠ æƒ-quick-union">è·¯å¾„å‹ç¼©çš„åŠ æƒ quick-union</a></li><li><a href="#å„ç§-union-find-ç®—æ³•çš„æ¯”è¾ƒ">å„ç§ union-find ç®—æ³•çš„æ¯”è¾ƒ</a></li></ul></li><li><a href="#äº”æ’åº">äº”ã€æ’åº</a><ul><li><a href="#é€‰æ‹©æ’åº">é€‰æ‹©æ’åº</a></li><li><a href="#å†’æ³¡æ’åº">å†’æ³¡æ’åº</a></li><li><a href="#æ’å…¥æ’åº">æ’å…¥æ’åº</a></li><li><a href="#å¸Œå°”æ’åº">å¸Œå°”æ’åº</a></li><li><a href="#å½’å¹¶æ’åº">å½’å¹¶æ’åº</a></li><li><a href="#å¿«é€Ÿæ’åº">å¿«é€Ÿæ’åº</a></li><li><a href="#å †æ’åº">å †æ’åº</a></li><li><a href="#å°ç»“">å°ç»“</a></li></ul></li><li><a href="#å…­æŸ¥æ‰¾">å…­ã€æŸ¥æ‰¾</a><ul><li><a href="#é“¾è¡¨å®ç°æ— åºç¬¦å·è¡¨">é“¾è¡¨å®ç°æ— åºç¬¦å·è¡¨</a></li><li><a href="#äºŒåˆ†æŸ¥æ‰¾å®ç°æœ‰åºç¬¦å·è¡¨">äºŒåˆ†æŸ¥æ‰¾å®ç°æœ‰åºç¬¦å·è¡¨</a></li><li><a href="#äºŒå‰æŸ¥æ‰¾æ ‘">äºŒå‰æŸ¥æ‰¾æ ‘</a></li><li><a href="#2-3-æŸ¥æ‰¾æ ‘">2-3 æŸ¥æ‰¾æ ‘</a></li><li><a href="#çº¢é»‘æ ‘">çº¢é»‘æ ‘</a></li><li><a href="#æ•£åˆ—è¡¨">æ•£åˆ—è¡¨</a></li><li><a href="#å°ç»“">å°ç»“</a></li></ul></li><li><a href="#ä¸ƒå…¶å®ƒ">ä¸ƒã€å…¶å®ƒ</a><ul><li><a href="#æ±‰è¯ºå¡”">æ±‰è¯ºå¡”</a></li><li><a href="#å“ˆå¤«æ›¼ç¼–ç ">å“ˆå¤«æ›¼ç¼–ç </a></li></ul></li><li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a><!-- GFM-TOC --></li></ul><h1 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h1><p>æœ¬æ–‡å®ç°ä»£ç ä»¥åŠæµ‹è¯•ä»£ç æ”¾åœ¨ <a href="https://github.com/CyC2018/Algorithm" target="_blank" rel="noopener">Algorithm</a></p><h1 id="äºŒã€ç®—æ³•åˆ†æ"><a href="#äºŒã€ç®—æ³•åˆ†æ" class="headerlink" title="äºŒã€ç®—æ³•åˆ†æ"></a>äºŒã€ç®—æ³•åˆ†æ</h1><h2 id="æ•°å­¦æ¨¡å‹"><a href="#æ•°å­¦æ¨¡å‹" class="headerlink" title="æ•°å­¦æ¨¡å‹"></a>æ•°å­¦æ¨¡å‹</h2><h3 id="1-è¿‘ä¼¼"><a href="#1-è¿‘ä¼¼" class="headerlink" title="1. è¿‘ä¼¼"></a>1. è¿‘ä¼¼</h3><p>N<sup>3</sup>/6-N<sup>2</sup>/2+N/3 \<sub> N<sup>3</sup>/6ã€‚ä½¿ç”¨ \</sub>f(N) æ¥è¡¨ç¤ºæ‰€æœ‰éšç€ N çš„å¢å¤§é™¤ä»¥ f(N) çš„ç»“æœè¶‹è¿‘äº 1 çš„å‡½æ•°ã€‚</p><h3 id="2-å¢é•¿æ•°é‡çº§"><a href="#2-å¢é•¿æ•°é‡çº§" class="headerlink" title="2. å¢é•¿æ•°é‡çº§"></a>2. å¢é•¿æ•°é‡çº§</h3><p>N<sup>3</sup>/6-N<sup>2</sup>/2+N/3 çš„å¢é•¿æ•°é‡çº§ä¸º O(N<sup>3</sup>)ã€‚å¢é•¿æ•°é‡çº§å°†ç®—æ³•ä¸å®ƒçš„å®ç°éš”ç¦»å¼€æ¥ï¼Œä¸€ä¸ªç®—æ³•çš„å¢é•¿æ•°é‡çº§ä¸º O(N<sup>3</sup>) ä¸å®ƒæ˜¯å¦ç”¨ Java å®ç°ï¼Œæ˜¯å¦è¿è¡Œäºç‰¹å®šè®¡ç®—æœºä¸Šæ— å…³ã€‚</p><h3 id="3-å†…å¾ªç¯"><a href="#3-å†…å¾ªç¯" class="headerlink" title="3. å†…å¾ªç¯"></a>3. å†…å¾ªç¯</h3><p>æ‰§è¡Œæœ€é¢‘ç¹çš„æŒ‡ä»¤å†³å®šäº†ç¨‹åºæ‰§è¡Œçš„æ€»æ—¶é—´ï¼ŒæŠŠè¿™äº›æŒ‡ä»¤ç§°ä¸ºç¨‹åºçš„å†…å¾ªç¯ã€‚</p><h3 id="4-æˆæœ¬æ¨¡å‹"><a href="#4-æˆæœ¬æ¨¡å‹" class="headerlink" title="4. æˆæœ¬æ¨¡å‹"></a>4. æˆæœ¬æ¨¡å‹</h3><p>ä½¿ç”¨æˆæœ¬æ¨¡å‹æ¥è¯„ä¼°ç®—æ³•ï¼Œä¾‹å¦‚æ•°ç»„çš„è®¿é—®æ¬¡æ•°å°±æ˜¯ä¸€ç§æˆæœ¬æ¨¡å‹ã€‚</p><h2 id="ThreeSum"><a href="#ThreeSum" class="headerlink" title="ThreeSum"></a>ThreeSum</h2><p>ThreeSum ç”¨äºç»Ÿè®¡ä¸€ä¸ªæ•°ç»„ä¸­å’Œä¸º 0 çš„ä¸‰å…ƒç»„æ•°é‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ThreeSum</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(<span class="keyword">int</span>[] nums)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreeSumSlow</span> <span class="keyword">implements</span> <span class="title">ThreeSum</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = nums.length;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = j + <span class="number">1</span>; k &lt; N; k++)</span><br><span class="line">                    <span class="keyword">if</span> (nums[i] + nums[j] + nums[k] == <span class="number">0</span>)</span><br><span class="line">                        cnt++;</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥ç®—æ³•çš„å†…å¾ªç¯ä¸º <code>if (nums[i] + nums[j] + nums[k] == 0)</code> è¯­å¥ï¼Œæ€»å…±æ‰§è¡Œçš„æ¬¡æ•°ä¸º N(N-1)(N-2) = N<sup>3</sup>/6-N<sup>2</sup>/2+N/3ï¼Œå› æ­¤å®ƒçš„è¿‘ä¼¼æ‰§è¡Œæ¬¡æ•°ä¸º ~N<sup>3</sup>/6ï¼Œå¢é•¿æ•°é‡çº§ä¸º O(N<sup>3</sup>)ã€‚</p><p><font size="4"> <strong>æ”¹è¿›</strong> </font><br></p><p>é€šè¿‡å°†æ•°ç»„å…ˆæ’åºï¼Œå¯¹ä¸¤ä¸ªå…ƒç´ æ±‚å’Œï¼Œå¹¶ç”¨äºŒåˆ†æŸ¥æ‰¾æ–¹æ³•æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨è¯¥å’Œçš„ç›¸åæ•°ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±è¯´æ˜å­˜åœ¨ä¸‰å…ƒç»„çš„å’Œä¸º 0ã€‚</p><p>åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰æ•°ç»„ä¸å«æœ‰ç›¸åŒå…ƒç´ æ‰èƒ½ä½¿ç”¨è¿™ç§è§£æ³•ï¼Œå¦åˆ™äºŒåˆ†æŸ¥æ‰¾çš„ç»“æœä¼šå‡ºé”™ã€‚</p><p>è¯¥æ–¹æ³•å¯ä»¥å°† ThreeSum ç®—æ³•å¢é•¿æ•°é‡çº§é™ä½ä¸º O(N<sup>2</sup>logN)ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreeSumFast</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        <span class="keyword">int</span> N = nums.length;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> target = -nums[i] - nums[j];</span><br><span class="line">                <span class="keyword">int</span> index = BinarySearch.search(nums, target);</span><br><span class="line">                <span class="comment">// åº”è¯¥æ³¨æ„è¿™é‡Œçš„ä¸‹æ ‡å¿…é¡»å¤§äº jï¼Œå¦åˆ™ä¼šé‡å¤ç»Ÿè®¡ã€‚</span></span><br><span class="line">                <span class="keyword">if</span> (index &gt; j)</span><br><span class="line">                    cnt++;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BinarySearch</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, h = nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= h) &#123;</span><br><span class="line">            <span class="keyword">int</span> m = l + (h - l) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (target == nums[m])</span><br><span class="line">                <span class="keyword">return</span> m;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (target &gt; nums[m])</span><br><span class="line">                l = m + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                h = m - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å€ç‡å®éªŒ"><a href="#å€ç‡å®éªŒ" class="headerlink" title="å€ç‡å®éªŒ"></a>å€ç‡å®éªŒ</h2><p>å¦‚æœ T(N) \<sub> aN<sup>b</sup>logNï¼Œé‚£ä¹ˆ T(2N)/T(N) \</sub> 2<sup>b</sup>ã€‚</p><p>ä¾‹å¦‚å¯¹äºæš´åŠ›çš„ ThreeSum ç®—æ³•ï¼Œè¿‘ä¼¼æ—¶é—´ä¸º ~N<sup>3</sup>/6ã€‚è¿›è¡Œå¦‚ä¸‹å®éªŒï¼šå¤šæ¬¡è¿è¡Œè¯¥ç®—æ³•ï¼Œæ¯æ¬¡å–çš„ N å€¼ä¸ºå‰ä¸€æ¬¡çš„ä¸¤å€ï¼Œç»Ÿè®¡æ¯æ¬¡æ‰§è¡Œçš„æ—¶é—´ï¼Œå¹¶ç»Ÿè®¡æœ¬æ¬¡è¿è¡Œæ—¶é—´ä¸å‰ä¸€æ¬¡è¿è¡Œæ—¶é—´çš„æ¯”å€¼ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p><table><thead><tr><th style="text-align:center">N</th><th style="text-align:center">Time(ms)</th><th style="text-align:center">Ratio</th></tr></thead><tbody><tr><td style="text-align:center">500</td><td style="text-align:center">48</td><td style="text-align:center">/</td></tr><tr><td style="text-align:center">1000</td><td style="text-align:center">320</td><td style="text-align:center">6.7</td></tr><tr><td style="text-align:center">2000</td><td style="text-align:center">555</td><td style="text-align:center">1.7</td></tr><tr><td style="text-align:center">4000</td><td style="text-align:center">4105</td><td style="text-align:center">7.4</td></tr><tr><td style="text-align:center">8000</td><td style="text-align:center">33575</td><td style="text-align:center">8.2</td></tr><tr><td style="text-align:center">16000</td><td style="text-align:center">268909</td><td style="text-align:center">8.0</td></tr></tbody></table><p>å¯ä»¥çœ‹åˆ°ï¼ŒT(2N)/T(N) \<sub> 2<sup>3</sup>ï¼Œå› æ­¤å¯ä»¥ç¡®å®š T(N) \</sub> aN<sup>3</sup>logNã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RatioTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = <span class="number">500</span>;</span><br><span class="line">        <span class="keyword">int</span> loopTimes = <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">double</span> preTime = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (loopTimes-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span>[] nums = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line">            StopWatch.start();</span><br><span class="line">            ThreeSum threeSum = <span class="keyword">new</span> ThreeSumSlow();</span><br><span class="line">            <span class="keyword">int</span> cnt = threeSum.count(nums);</span><br><span class="line">            System.out.println(cnt);</span><br><span class="line">            <span class="keyword">double</span> elapsedTime = StopWatch.elapsedTime();</span><br><span class="line">            <span class="keyword">double</span> ratio = preTime == -<span class="number">1</span> ? <span class="number">0</span> : elapsedTime / preTime;</span><br><span class="line">            System.out.println(N + <span class="string">"  "</span> + elapsedTime + <span class="string">"  "</span> + ratio);</span><br><span class="line">            preTime = elapsedTime;</span><br><span class="line">            N *= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopWatch</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> start;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">        start = System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">elapsedTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> now = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">return</span> (now - start) / <span class="number">1000.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><h3 id="1-å¤§å¸¸æ•°"><a href="#1-å¤§å¸¸æ•°" class="headerlink" title="1. å¤§å¸¸æ•°"></a>1. å¤§å¸¸æ•°</h3><p>åœ¨æ±‚è¿‘ä¼¼æ—¶ï¼Œå¦‚æœä½çº§é¡¹çš„å¸¸æ•°ç³»æ•°å¾ˆå¤§ï¼Œé‚£ä¹ˆè¿‘ä¼¼çš„ç»“æœå°±æ˜¯é”™è¯¯çš„ã€‚</p><h3 id="2-ç¼“å­˜"><a href="#2-ç¼“å­˜" class="headerlink" title="2. ç¼“å­˜"></a>2. ç¼“å­˜</h3><p>è®¡ç®—æœºç³»ç»Ÿä¼šä½¿ç”¨ç¼“å­˜æŠ€æœ¯æ¥ç»„ç»‡å†…å­˜ï¼Œè®¿é—®æ•°ç»„ç›¸é‚»çš„å…ƒç´ ä¼šæ¯”è®¿é—®ä¸ç›¸é‚»çš„å…ƒç´ å¿«å¾ˆå¤šã€‚</p><h3 id="3-å¯¹æœ€åæƒ…å†µä¸‹çš„æ€§èƒ½çš„ä¿è¯"><a href="#3-å¯¹æœ€åæƒ…å†µä¸‹çš„æ€§èƒ½çš„ä¿è¯" class="headerlink" title="3. å¯¹æœ€åæƒ…å†µä¸‹çš„æ€§èƒ½çš„ä¿è¯"></a>3. å¯¹æœ€åæƒ…å†µä¸‹çš„æ€§èƒ½çš„ä¿è¯</h3><p>åœ¨æ ¸ååº”å †ã€å¿ƒè„èµ·æå™¨æˆ–è€…åˆ¹è½¦æ§åˆ¶å™¨ä¸­çš„è½¯ä»¶ï¼Œæœ€åæƒ…å†µä¸‹çš„æ€§èƒ½æ˜¯ååˆ†é‡è¦çš„ã€‚</p><h3 id="4-éšæœºåŒ–ç®—æ³•"><a href="#4-éšæœºåŒ–ç®—æ³•" class="headerlink" title="4. éšæœºåŒ–ç®—æ³•"></a>4. éšæœºåŒ–ç®—æ³•</h3><p>é€šè¿‡æ‰“ä¹±è¾“å…¥ï¼Œå»é™¤ç®—æ³•å¯¹è¾“å…¥çš„ä¾èµ–ã€‚</p><h3 id="5-å‡æ‘Šåˆ†æ"><a href="#5-å‡æ‘Šåˆ†æ" class="headerlink" title="5. å‡æ‘Šåˆ†æ"></a>5. å‡æ‘Šåˆ†æ</h3><p>å°†æ‰€æœ‰æ“ä½œçš„æ€»æˆæœ¬é™¤äºæ“ä½œæ€»æ•°æ¥å°†æˆæœ¬å‡æ‘Šã€‚ä¾‹å¦‚å¯¹ä¸€ä¸ªç©ºæ ˆè¿›è¡Œ N æ¬¡è¿ç»­çš„ push() è°ƒç”¨éœ€è¦è®¿é—®æ•°ç»„çš„å…ƒç´ ä¸º N+4+8+16+â€¦+2N=5N-4ï¼ˆN æ˜¯å‘æ•°ç»„å†™å…¥å…ƒç´ ï¼Œå…¶ä½™çš„éƒ½æ˜¯è°ƒæ•´æ•°ç»„å¤§å°æ—¶è¿›è¡Œå¤åˆ¶éœ€è¦çš„è®¿é—®æ•°ç»„æ“ä½œï¼‰ï¼Œå‡æ‘Šåæ¯æ¬¡æ“ä½œè®¿é—®æ•°ç»„çš„å¹³å‡æ¬¡æ•°ä¸ºå¸¸æ•°ã€‚</p><h1 id="ä¸‰ã€æ ˆå’Œé˜Ÿåˆ—"><a href="#ä¸‰ã€æ ˆå’Œé˜Ÿåˆ—" class="headerlink" title="ä¸‰ã€æ ˆå’Œé˜Ÿåˆ—"></a>ä¸‰ã€æ ˆå’Œé˜Ÿåˆ—</h1><h2 id="æ ˆ"><a href="#æ ˆ" class="headerlink" title="æ ˆ"></a>æ ˆ</h2><p>First-In-Last-Out</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyStack</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">extends</span> <span class="title">Iterable</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">MyStack&lt;Item&gt; <span class="title">push</span><span class="params">(Item item)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Item <span class="title">pop</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-æ•°ç»„å®ç°"><a href="#1-æ•°ç»„å®ç°" class="headerlink" title="1. æ•°ç»„å®ç°"></a>1. æ•°ç»„å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayStack</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">MyStack</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// æ ˆå…ƒç´ æ•°ç»„ï¼Œåªèƒ½é€šè¿‡è½¬å‹æ¥åˆ›å»ºæ³›å‹æ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> Item[] a = (Item[]) <span class="keyword">new</span> Object[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">// å…ƒç´ æ•°é‡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MyStack&lt;Item&gt; <span class="title">push</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        check();</span><br><span class="line">        a[N++] = item;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Item <span class="title">pop</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"stack is empty"</span>);</span><br><span class="line"></span><br><span class="line">        Item item = a[--N];</span><br><span class="line">        check();</span><br><span class="line">        a[N] = <span class="keyword">null</span>; <span class="comment">// é¿å…å¯¹è±¡æ¸¸ç¦»</span></span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">check</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (N &gt;= a.length)</span><br><span class="line">            resize(<span class="number">2</span> * a.length);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (N &gt; <span class="number">0</span> &amp;&amp; N &lt;= a.length / <span class="number">4</span>)</span><br><span class="line">            resize(a.length / <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è°ƒæ•´æ•°ç»„å¤§å°ï¼Œä½¿å¾—æ ˆå…·æœ‰ä¼¸ç¼©æ€§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">        Item[] tmp = (Item[]) <span class="keyword">new</span> Object[size];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            tmp[i] = a[i];</span><br><span class="line">        a = tmp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;Item&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è¿”å›é€†åºéå†çš„è¿­ä»£å™¨</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Iterator&lt;Item&gt;() &#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">int</span> i = N;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> i &gt; <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Item <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> a[--i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-é“¾è¡¨å®ç°"><a href="#2-é“¾è¡¨å®ç°" class="headerlink" title="2. é“¾è¡¨å®ç°"></a>2. é“¾è¡¨å®ç°</h3><p>éœ€è¦ä½¿ç”¨é“¾è¡¨çš„å¤´æ’æ³•æ¥å®ç°ï¼Œå› ä¸ºå¤´æ’æ³•ä¸­æœ€åå‹å…¥æ ˆçš„å…ƒç´ åœ¨é“¾è¡¨çš„å¼€å¤´ï¼Œå®ƒçš„ next æŒ‡é’ˆæŒ‡å‘å‰ä¸€ä¸ªå‹å…¥æ ˆçš„å…ƒç´ ï¼Œåœ¨å¼¹å‡ºå…ƒç´ æ—¶å°±å¯ä»¥é€šè¿‡ next æŒ‡é’ˆéå†åˆ°å‰ä¸€ä¸ªå‹å…¥æ ˆçš„å…ƒç´ ä»è€Œè®©è¿™ä¸ªå…ƒç´ ç§°ä¸ºæ–°çš„æ ˆé¡¶å…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListStack</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">MyStack</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Node top = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        Item item;</span><br><span class="line">        Node next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MyStack&lt;Item&gt; <span class="title">push</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        Node newTop = <span class="keyword">new</span> Node();</span><br><span class="line">        newTop.item = item;</span><br><span class="line">        newTop.next = top;</span><br><span class="line">        top = newTop;</span><br><span class="line">        N++;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Item <span class="title">pop</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"stack is empty"</span>);</span><br><span class="line">        Item item = top.item;</span><br><span class="line">        top = top.next;</span><br><span class="line">        N--;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;Item&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Iterator&lt;Item&gt;() &#123;</span><br><span class="line">            <span class="keyword">private</span> Node cur = top;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> cur != <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Item <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                Item item = cur.item;</span><br><span class="line">                cur = cur.next;</span><br><span class="line">                <span class="keyword">return</span> item;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h2><p>First-In-First-Out</p><p>ä¸‹é¢æ˜¯é˜Ÿåˆ—çš„é“¾è¡¨å®ç°ï¼Œéœ€è¦ç»´æŠ¤ first å’Œ last èŠ‚ç‚¹æŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘é˜Ÿé¦–å’Œé˜Ÿå°¾ã€‚</p><p>è¿™é‡Œéœ€è¦è€ƒè™‘ first å’Œ last æŒ‡é’ˆå“ªä¸ªä½œä¸ºé“¾è¡¨çš„å¼€å¤´ã€‚å› ä¸ºå‡ºé˜Ÿåˆ—æ“ä½œéœ€è¦è®©é˜Ÿé¦–å…ƒç´ çš„ä¸‹ä¸€ä¸ªå…ƒç´ æˆä¸ºé˜Ÿé¦–ï¼Œæ‰€ä»¥éœ€è¦å®¹æ˜“è·å–ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè€Œé“¾è¡¨çš„å¤´éƒ¨èŠ‚ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå› æ­¤å¯ä»¥è®© first æŒ‡é’ˆé“¾è¡¨çš„å¼€å¤´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyQueue</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">extends</span> <span class="title">Iterable</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">MyQueue&lt;Item&gt; <span class="title">add</span><span class="params">(Item item)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Item <span class="title">remove</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListQueue</span>&lt;<span class="title">Item</span>&gt; <span class="keyword">implements</span> <span class="title">MyQueue</span>&lt;<span class="title">Item</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Node first;</span><br><span class="line">    <span class="keyword">private</span> Node last;</span><br><span class="line">    <span class="keyword">int</span> N = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        Item item;</span><br><span class="line">        Node next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MyQueue&lt;Item&gt; <span class="title">add</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        Node newNode = <span class="keyword">new</span> Node();</span><br><span class="line">        newNode.item = item;</span><br><span class="line">        newNode.next = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            last = newNode;</span><br><span class="line">            first = newNode;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            last.next = newNode;</span><br><span class="line">            last = newNode;</span><br><span class="line">        &#125;</span><br><span class="line">        N++;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Item <span class="title">remove</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"queue is empty"</span>);</span><br><span class="line">        Node node = first;</span><br><span class="line">        first = first.next;</span><br><span class="line">        N--;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty())</span><br><span class="line">            last = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span> node.item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;Item&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Iterator&lt;Item&gt;() &#123;</span><br><span class="line">            Node cur = first;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> cur != <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Item <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                Item item = cur.item;</span><br><span class="line">                cur = cur.next;</span><br><span class="line">                <span class="keyword">return</span> item;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å››ã€å¹¶æŸ¥é›†"><a href="#å››ã€å¹¶æŸ¥é›†" class="headerlink" title="å››ã€å¹¶æŸ¥é›†"></a>å››ã€å¹¶æŸ¥é›†</h1><p>ç”¨äºè§£å†³åŠ¨æ€è¿é€šæ€§é—®é¢˜ï¼Œèƒ½åŠ¨æ€è¿æ¥ä¸¤ä¸ªç‚¹ï¼Œå¹¶ä¸”åˆ¤æ–­ä¸¤ä¸ªç‚¹æ˜¯å¦è¿é€šã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061909.png" width="400"> </div><br></p><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">UF(int N)</td><td style="text-align:center">æ„é€ ä¸€ä¸ªå¤§å°ä¸º N çš„å¹¶æŸ¥é›†</td></tr><tr><td style="text-align:center">void union(int p, int q)</td><td style="text-align:center">è¿æ¥ p å’Œ q èŠ‚ç‚¹</td></tr><tr><td style="text-align:center">int find(int p)</td><td style="text-align:center">æŸ¥æ‰¾ p æ‰€åœ¨çš„è¿é€šåˆ†é‡</td></tr><tr><td style="text-align:center">boolean connected(int p, int q)</td><td style="text-align:center">åˆ¤æ–­ p å’Œ q èŠ‚ç‚¹æ˜¯å¦è¿é€š</td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">UF</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span>[] id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UF</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        id = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            id[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">connected</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> find(p) == find(q);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> p)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="quick-find"><a href="#quick-find" class="headerlink" title="quick-find"></a>quick-find</h2><p>å¯ä»¥å¿«é€Ÿè¿›è¡Œ find æ“ä½œï¼Œå³å¯ä»¥å¿«é€Ÿåˆ¤æ–­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦è¿é€šã€‚</p><p>åŒä¸€è¿é€šåˆ†é‡çš„æ‰€æœ‰èŠ‚ç‚¹çš„ id å€¼ç›¸ç­‰ã€‚</p><p>ä½†æ˜¯ union æ“ä½œä»£ä»·å´å¾ˆé«˜ï¼Œéœ€è¦å°†å…¶ä¸­ä¸€ä¸ªè¿é€šåˆ†é‡ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ id å€¼éƒ½ä¿®æ”¹ä¸ºå¦ä¸€ä¸ªèŠ‚ç‚¹çš„ id å€¼ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061914.png" width="350"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickFindUF</span> <span class="keyword">extends</span> <span class="title">UF</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">QuickFindUF</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(N);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id[p];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pID = find(p);</span><br><span class="line">        <span class="keyword">int</span> qID = find(q);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pID == qID)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; id.length; i++)</span><br><span class="line">            <span class="keyword">if</span> (id[i] == pID)</span><br><span class="line">                id[i] = qID;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="quick-union"><a href="#quick-union" class="headerlink" title="quick-union"></a>quick-union</h2><p>å¯ä»¥å¿«é€Ÿè¿›è¡Œ union æ“ä½œï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸ªèŠ‚ç‚¹çš„ id å€¼å³å¯ã€‚</p><p>ä½†æ˜¯ find æ“ä½œå¼€é”€å¾ˆå¤§ï¼Œå› ä¸ºåŒä¸€ä¸ªè¿é€šåˆ†é‡çš„èŠ‚ç‚¹ id å€¼ä¸åŒï¼Œid å€¼åªæ˜¯ç”¨æ¥æŒ‡å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚å› æ­¤éœ€è¦ä¸€ç›´å‘ä¸ŠæŸ¥æ‰¾æ“ä½œï¼Œç›´åˆ°æ‰¾åˆ°æœ€ä¸Šå±‚çš„èŠ‚ç‚¹ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061919.png" width="350"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickUnionUF</span> <span class="keyword">extends</span> <span class="title">UF</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">QuickUnionUF</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(N);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (p != id[p])</span><br><span class="line">            p = id[p];</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pRoot = find(p);</span><br><span class="line">        <span class="keyword">int</span> qRoot = find(q);</span><br><span class="line">        <span class="keyword">if</span> (pRoot != qRoot)</span><br><span class="line">            id[pRoot] = qRoot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•å¯ä»¥å¿«é€Ÿè¿›è¡Œ union æ“ä½œï¼Œä½†æ˜¯ find æ“ä½œå’Œæ ‘é«˜æˆæ­£æ¯”ï¼Œæœ€åçš„æƒ…å†µä¸‹æ ‘çš„é«˜åº¦ä¸ºè§¦ç‚¹çš„æ•°ç›®ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061926.png" width="150"> </div><br></p><h2 id="åŠ æƒ-quick-union"><a href="#åŠ æƒ-quick-union" class="headerlink" title="åŠ æƒ quick-union"></a>åŠ æƒ quick-union</h2><p>ä¸ºäº†è§£å†³ quick-union çš„æ ‘é€šå¸¸ä¼šå¾ˆé«˜çš„é—®é¢˜ï¼ŒåŠ æƒ quick-union åœ¨ union æ“ä½œæ—¶ä¼šè®©è¾ƒå°çš„æ ‘è¿æ¥è¾ƒå¤§çš„æ ‘ä¸Šé¢ã€‚</p><p>ç†è®ºç ”ç©¶è¯æ˜ï¼ŒåŠ æƒ quick-union ç®—æ³•æ„é€ çš„æ ‘æ·±åº¦æœ€å¤šä¸è¶…è¿‡ logNã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061930.png" width="200"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeightedQuickUnionUF</span> <span class="keyword">extends</span> <span class="title">UF</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿å­˜èŠ‚ç‚¹çš„æ•°é‡ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] sz;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeightedQuickUnionUF</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(N);</span><br><span class="line">        <span class="keyword">this</span>.sz = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            <span class="keyword">this</span>.sz[i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (p != id[p])</span><br><span class="line">            p = id[p];</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = find(p);</span><br><span class="line">        <span class="keyword">int</span> j = find(q);</span><br><span class="line">        <span class="keyword">if</span> (i == j) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (sz[i] &lt; sz[j]) &#123;</span><br><span class="line">            id[i] = j;</span><br><span class="line">            sz[j] += sz[i];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            id[j] = i;</span><br><span class="line">            sz[i] += sz[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è·¯å¾„å‹ç¼©çš„åŠ æƒ-quick-union"><a href="#è·¯å¾„å‹ç¼©çš„åŠ æƒ-quick-union" class="headerlink" title="è·¯å¾„å‹ç¼©çš„åŠ æƒ quick-union"></a>è·¯å¾„å‹ç¼©çš„åŠ æƒ quick-union</h2><p>åœ¨æ£€æŸ¥èŠ‚ç‚¹çš„åŒæ—¶å°†å®ƒä»¬ç›´æ¥é“¾æ¥åˆ°æ ¹èŠ‚ç‚¹ï¼Œåªéœ€è¦åœ¨ find ä¸­æ·»åŠ ä¸€ä¸ªå¾ªç¯å³å¯ã€‚</p><h2 id="å„ç§-union-find-ç®—æ³•çš„æ¯”è¾ƒ"><a href="#å„ç§-union-find-ç®—æ³•çš„æ¯”è¾ƒ" class="headerlink" title="å„ç§ union-find ç®—æ³•çš„æ¯”è¾ƒ"></a>å„ç§ union-find ç®—æ³•çš„æ¯”è¾ƒ</h2><table><thead><tr><th style="text-align:center">ç®—æ³•</th><th style="text-align:center">union</th><th style="text-align:center">find</th></tr></thead><tbody><tr><td style="text-align:center">quick-find</td><td style="text-align:center">N</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">quick-union</td><td style="text-align:center">æ ‘é«˜</td><td style="text-align:center">æ ‘é«˜</td></tr><tr><td style="text-align:center">åŠ æƒ quick-union</td><td style="text-align:center">logN</td><td style="text-align:center">logN</td></tr><tr><td style="text-align:center">è·¯å¾„å‹ç¼©çš„åŠ æƒ quick-union</td><td style="text-align:center">éå¸¸æ¥è¿‘ 1</td><td style="text-align:center">éå¸¸æ¥è¿‘ 1</td></tr></tbody></table><h1 id="äº”ã€æ’åº"><a href="#äº”ã€æ’åº" class="headerlink" title="äº”ã€æ’åº"></a>äº”ã€æ’åº</h1><p>å¾…æ’åºçš„å…ƒç´ éœ€è¦å®ç° Java çš„ Comparable æ¥å£ï¼Œè¯¥æ¥å£æœ‰ compareTo() æ–¹æ³•ï¼Œå¯ä»¥ç”¨å®ƒæ¥åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ çš„å¤§å°å…³ç³»ã€‚</p><p>ç ”ç©¶æ’åºç®—æ³•çš„æˆæœ¬æ¨¡å‹æ—¶ï¼Œè®¡ç®—çš„æ˜¯æ¯”è¾ƒå’Œäº¤æ¢çš„æ¬¡æ•°ã€‚</p><p>ä½¿ç”¨è¾…åŠ©å‡½æ•° less() å’Œ swap() æ¥è¿›è¡Œæ¯”è¾ƒå’Œäº¤æ¢çš„æ“ä½œï¼Œä½¿å¾—ä»£ç çš„å¯è¯»æ€§å’Œå¯ç§»æ¤æ€§æ›´å¥½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Sort</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">less</span><span class="params">(T v, T w)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> v.compareTo(w) &lt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(T[] a, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">        T t = a[i];</span><br><span class="line">        a[i] = a[j];</span><br><span class="line">        a[j] = t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h2><p>é€‰æ‹©å‡ºæ•°ç»„ä¸­çš„æœ€å°å…ƒç´ ï¼Œå°†å®ƒä¸æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ã€‚å†ä»å‰©ä¸‹çš„å…ƒç´ ä¸­é€‰æ‹©å‡ºæœ€å°çš„å…ƒç´ ï¼Œå°†å®ƒä¸æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ äº¤æ¢ä½ç½®ã€‚ä¸æ–­è¿›è¡Œè¿™æ ·çš„æ“ä½œï¼Œç›´åˆ°å°†æ•´ä¸ªæ•°ç»„æ’åºã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061936.png" width="250"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Selection</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">Sort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = nums.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> min = i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j++)</span><br><span class="line">                <span class="keyword">if</span> (less(nums[j], nums[min]))</span><br><span class="line">                    min = j;</span><br><span class="line">            swap(nums, i, min);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€‰æ‹©æ’åºéœ€è¦ \<sub>N<sup>2</sup>/2 æ¬¡æ¯”è¾ƒå’Œ \</sub>N æ¬¡äº¤æ¢ï¼Œå®ƒçš„è¿è¡Œæ—¶é—´ä¸è¾“å…¥æ— å…³ï¼Œè¿™ä¸ªç‰¹ç‚¹ä½¿å¾—å®ƒå¯¹ä¸€ä¸ªå·²ç»æ’åºçš„æ•°ç»„ä¹Ÿéœ€è¦è¿™ä¹ˆå¤šçš„æ¯”è¾ƒå’Œäº¤æ¢æ“ä½œã€‚</p><h2 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h2><p>é€šè¿‡ä»å·¦åˆ°å³ä¸æ–­äº¤æ¢ç›¸é‚»é€†åºçš„ç›¸é‚»å…ƒç´ ï¼Œåœ¨ä¸€è½®çš„äº¤æ¢ä¹‹åï¼Œå¯ä»¥è®©æœªæ’åºçš„å…ƒç´ ä¸Šæµ®åˆ°å³ä¾§ã€‚</p><p>åœ¨ä¸€è½®å¾ªç¯ä¸­ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿäº¤æ¢ï¼Œå°±è¯´æ˜æ•°ç»„å·²ç»æ˜¯æœ‰åºçš„ï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥é€€å‡ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bubble</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">Sort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = nums.length;</span><br><span class="line">        <span class="keyword">boolean</span> hasSorted = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N &amp;&amp; !hasSorted; i++) &#123;</span><br><span class="line">            hasSorted = <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N - i - <span class="number">1</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (less(nums[j + <span class="number">1</span>], nums[j])) &#123;</span><br><span class="line">                    hasSorted = <span class="keyword">false</span>;</span><br><span class="line">                    swap(nums, j, j + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h2><p>æ’å…¥æ’åºä»å·¦åˆ°å³è¿›è¡Œï¼Œæ¯æ¬¡éƒ½å°†å½“å‰å…ƒç´ æ’å…¥åˆ°å·¦ä¾§å·²ç»æ’åºçš„æ•°ç»„ä¸­ï¼Œä½¿å¾—æ’å…¥ä¹‹åå·¦éƒ¨æ•°ç»„ä¾ç„¶æœ‰åºã€‚</p><p>ç¬¬ j å…ƒç´ æ˜¯é€šè¿‡ä¸æ–­å‘å·¦æ¯”è¾ƒå¹¶äº¤æ¢æ¥å®ç°æ’å…¥è¿‡ç¨‹ï¼šå½“ç¬¬ j å…ƒç´ å°äºç¬¬ j - 1 å…ƒç´ ï¼Œå°±å°†å®ƒä»¬çš„ä½ç½®äº¤æ¢ï¼Œç„¶åä»¤ j æŒ‡é’ˆå‘å·¦ç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼Œä¸æ–­è¿›è¡Œä»¥ä¸Šæ“ä½œã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061941.png" width="250"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Insertion</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">Sort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = nums.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &gt; <span class="number">0</span> &amp;&amp; less(nums[j], nums[j - <span class="number">1</span>]); j--)</span><br><span class="line">                swap(nums, j, j - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºæ•°ç»„ {3, 5, 2, 4, 1}ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹é€†åºï¼š(3, 2), (3, 1), (5, 2), (5, 4), (5, 1), (2, 1), (4, 1)ï¼Œæ’å…¥æ’åºæ¯æ¬¡åªèƒ½äº¤æ¢ç›¸é‚»å…ƒç´ ï¼Œä»¤é€†åºæ•°é‡å‡å°‘ 1ï¼Œå› æ­¤æ’å…¥æ’åºéœ€è¦äº¤æ¢çš„æ¬¡æ•°ä¸ºé€†åºæ•°é‡ã€‚</p><p>æ’å…¥æ’åºçš„å¤æ‚åº¦å–å†³äºæ•°ç»„çš„åˆå§‹é¡ºåºï¼Œå¦‚æœæ•°ç»„å·²ç»éƒ¨åˆ†æœ‰åºäº†ï¼Œé€†åºè¾ƒå°‘ï¼Œé‚£ä¹ˆæ’å…¥æ’åºä¼šå¾ˆå¿«ã€‚</p><ul><li>å¹³å‡æƒ…å†µä¸‹æ’å…¥æ’åºéœ€è¦ \<sub>N<sup>2</sup>/4 æ¯”è¾ƒä»¥åŠ \</sub>N<sup>2</sup>/4 æ¬¡äº¤æ¢ï¼›</li><li>æœ€åçš„æƒ…å†µä¸‹éœ€è¦ \<sub>N<sup>2</sup>/2 æ¯”è¾ƒä»¥åŠ \</sub>N<sup>2</sup>/2 æ¬¡äº¤æ¢ï¼Œæœ€åçš„æƒ…å†µæ˜¯æ•°ç»„æ˜¯å€’åºçš„ï¼›</li><li>æœ€å¥½çš„æƒ…å†µä¸‹éœ€è¦ N-1 æ¬¡æ¯”è¾ƒå’Œ 0 æ¬¡äº¤æ¢ï¼Œæœ€å¥½çš„æƒ…å†µå°±æ˜¯æ•°ç»„å·²ç»æœ‰åºäº†ã€‚</li></ul><h2 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h2><p>å¯¹äºå¤§è§„æ¨¡çš„æ•°ç»„ï¼Œæ’å…¥æ’åºå¾ˆæ…¢ï¼Œå› ä¸ºå®ƒåªèƒ½äº¤æ¢ç›¸é‚»çš„å…ƒç´ ï¼Œæ¯æ¬¡åªèƒ½å°†é€†åºæ•°é‡å‡å°‘ 1ã€‚</p><p>å¸Œå°”æ’åºçš„å‡ºç°å°±æ˜¯ä¸ºäº†æ”¹è¿›æ’å…¥æ’åºçš„è¿™ç§å±€é™æ€§ï¼Œå®ƒé€šè¿‡äº¤æ¢ä¸ç›¸é‚»çš„å…ƒç´ ï¼Œæ¯æ¬¡å¯ä»¥å°†é€†åºæ•°é‡å‡å°‘å¤§äº 1ã€‚</p><p>å¸Œå°”æ’åºä½¿ç”¨æ’å…¥æ’åºå¯¹é—´éš” h çš„åºåˆ—è¿›è¡Œæ’åºã€‚é€šè¿‡ä¸æ–­å‡å° hï¼Œæœ€åä»¤ h=1ï¼Œå°±å¯ä»¥ä½¿å¾—æ•´ä¸ªæ•°ç»„æ˜¯æœ‰åºçš„ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061947.png" width="500"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Shell</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">Sort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = nums.length;</span><br><span class="line">        <span class="keyword">int</span> h = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (h &lt; N / <span class="number">3</span>)</span><br><span class="line">            h = <span class="number">3</span> * h + <span class="number">1</span>;  <span class="comment">// 1, 4, 13, 40, ...</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (h &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = h; i &lt; N; i++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &gt;= h &amp;&amp; less(nums[j], nums[j - h]); j -= h)</span><br><span class="line">                    swap(nums, j, j - h);</span><br><span class="line">            h = h / <span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¸Œå°”æ’åºçš„è¿è¡Œæ—¶é—´è¾¾ä¸åˆ°å¹³æ–¹çº§åˆ«ï¼Œä½¿ç”¨é€’å¢åºåˆ— 1, 4, 13, 40, â€¦  çš„å¸Œå°”æ’åºæ‰€éœ€è¦çš„æ¯”è¾ƒæ¬¡æ•°ä¸ä¼šè¶…è¿‡ N çš„è‹¥å¹²å€ä¹˜äºé€’å¢åºåˆ—çš„é•¿åº¦ã€‚åé¢ä»‹ç»çš„é«˜çº§æ’åºç®—æ³•åªä¼šæ¯”å¸Œå°”æ’åºå¿«ä¸¤å€å·¦å³ã€‚</p><h2 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h2><p>å½’å¹¶æ’åºçš„æ€æƒ³æ˜¯å°†æ•°ç»„åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«è¿›è¡Œæ’åºï¼Œç„¶åå½’å¹¶èµ·æ¥ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061953.png" width="350"> </div><br></p><h3 id="1-å½’å¹¶æ–¹æ³•"><a href="#1-å½’å¹¶æ–¹æ³•" class="headerlink" title="1. å½’å¹¶æ–¹æ³•"></a>1. å½’å¹¶æ–¹æ³•</h3><p>å½’å¹¶æ–¹æ³•å°†æ•°ç»„ä¸­ä¸¤ä¸ªå·²ç»æ’åºçš„éƒ¨åˆ†å½’å¹¶æˆä¸€ä¸ªã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MergeSort</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">Sort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> T[] aux;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(T[] nums, <span class="keyword">int</span> l, <span class="keyword">int</span> m, <span class="keyword">int</span> h)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = l, j = m + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt;= h; k++)</span><br><span class="line">            aux[k] = nums[k];        <span class="comment">// å°†æ•°æ®å¤åˆ¶åˆ°è¾…åŠ©æ•°ç»„</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt;= h; k++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; m)</span><br><span class="line">                nums[k] = aux[j++];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (j &gt; h)</span><br><span class="line">                nums[k] = aux[i++];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (aux[i].compareTo(nums[j]) &lt;= <span class="number">0</span>)</span><br><span class="line">                nums[k] = aux[i++];  <span class="comment">// å…ˆè¿›è¡Œè¿™ä¸€æ­¥ï¼Œä¿è¯ç¨³å®šæ€§</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                nums[k] = aux[j++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-è‡ªé¡¶å‘ä¸‹å½’å¹¶æ’åº"><a href="#2-è‡ªé¡¶å‘ä¸‹å½’å¹¶æ’åº" class="headerlink" title="2. è‡ªé¡¶å‘ä¸‹å½’å¹¶æ’åº"></a>2. è‡ªé¡¶å‘ä¸‹å½’å¹¶æ’åº</h3><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061958.png" width="450"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Up2DownMergeSort</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">MergeSort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums)</span> </span>&#123;</span><br><span class="line">        aux = (T[]) <span class="keyword">new</span> Comparable[nums.length];</span><br><span class="line">        sort(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums, <span class="keyword">int</span> l, <span class="keyword">int</span> h)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (h &lt;= l)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> mid = l + (h - l) / <span class="number">2</span>;</span><br><span class="line">        sort(nums, l, mid);</span><br><span class="line">        sort(nums, mid + <span class="number">1</span>, h);</span><br><span class="line">        merge(nums, l, mid, h);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºæ¯æ¬¡éƒ½å°†é—®é¢˜å¯¹åŠåˆ†æˆä¸¤ä¸ªå­é—®é¢˜ï¼Œè€Œè¿™ç§å¯¹åŠåˆ†çš„ç®—æ³•å¤æ‚åº¦ä¸€èˆ¬ä¸º O(NlogN)ï¼Œå› æ­¤è¯¥å½’å¹¶æ’åºæ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿä¸º O(NlogN)ã€‚</p><h3 id="3-è‡ªåº•å‘ä¸Šå½’å¹¶æ’åº"><a href="#3-è‡ªåº•å‘ä¸Šå½’å¹¶æ’åº" class="headerlink" title="3. è‡ªåº•å‘ä¸Šå½’å¹¶æ’åº"></a>3. è‡ªåº•å‘ä¸Šå½’å¹¶æ’åº</h3><p>å…ˆå½’å¹¶é‚£äº›å¾®å‹æ•°ç»„ï¼Œç„¶åæˆå¯¹å½’å¹¶å¾—åˆ°çš„å¾®å‹æ•°ç»„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Down2UpMergeSort</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">MergeSort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = nums.length;</span><br><span class="line">        aux = (T[]) <span class="keyword">new</span> Comparable[N];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> sz = <span class="number">1</span>; sz &lt; N; sz += sz)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> lo = <span class="number">0</span>; lo &lt; N - sz; lo += sz + sz)</span><br><span class="line">                merge(nums, lo, lo + sz - <span class="number">1</span>, Math.min(lo + sz + sz - <span class="number">1</span>, N - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h2><h3 id="1-åŸºæœ¬ç®—æ³•"><a href="#1-åŸºæœ¬ç®—æ³•" class="headerlink" title="1. åŸºæœ¬ç®—æ³•"></a>1. åŸºæœ¬ç®—æ³•</h3><ul><li>å½’å¹¶æ’åºå°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªå­æ•°ç»„åˆ†åˆ«æ’åºï¼Œå¹¶å°†æœ‰åºçš„å­æ•°ç»„å½’å¹¶ä½¿å¾—æ•´ä¸ªæ•°ç»„æ’åºï¼›</li><li>å¿«é€Ÿæ’åºé€šè¿‡ä¸€ä¸ªåˆ‡åˆ†å…ƒç´ å°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªå­æ•°ç»„ï¼Œå·¦å­æ•°ç»„å°äºç­‰äºåˆ‡åˆ†å…ƒç´ ï¼Œå³å­æ•°ç»„å¤§äºç­‰äºåˆ‡åˆ†å…ƒç´ ï¼Œå°†è¿™ä¸¤ä¸ªå­æ•°ç»„æ’åºä¹Ÿå°±å°†æ•´ä¸ªæ•°ç»„æ’åºäº†ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062002.png" width="500"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickSort</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">Sort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums)</span> </span>&#123;</span><br><span class="line">        shuffle(nums);</span><br><span class="line">        sort(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums, <span class="keyword">int</span> l, <span class="keyword">int</span> h)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (h &lt;= l)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> j = partition(nums, l, h);</span><br><span class="line">        sort(nums, l, j - <span class="number">1</span>);</span><br><span class="line">        sort(nums, j + <span class="number">1</span>, h);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">shuffle</span><span class="params">(T[] nums)</span> </span>&#123;</span><br><span class="line">        List&lt;Comparable&gt; list = Arrays.asList(nums);</span><br><span class="line">        Collections.shuffle(list);</span><br><span class="line">        list.toArray(nums);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-åˆ‡åˆ†"><a href="#2-åˆ‡åˆ†" class="headerlink" title="2. åˆ‡åˆ†"></a>2. åˆ‡åˆ†</h3><p>å– a[lo] ä½œä¸ºåˆ‡åˆ†å…ƒç´ ï¼Œç„¶åä»æ•°ç»„çš„å·¦ç«¯å‘å³æ‰«æç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äºå®ƒçš„å…ƒç´ ï¼Œå†ä»æ•°ç»„çš„å³ç«¯å‘å·¦æ‰«ææ‰¾åˆ°ç¬¬ä¸€ä¸ªå°äºç­‰äºå®ƒçš„å…ƒç´ ï¼Œäº¤æ¢è¿™ä¸¤ä¸ªå…ƒç´ ï¼Œå¹¶ä¸æ–­è¿›è¡Œè¿™ä¸ªè¿‡ç¨‹ï¼Œå°±å¯ä»¥ä¿è¯å·¦æŒ‡é’ˆ i çš„å·¦ä¾§å…ƒç´ éƒ½ä¸å¤§äºåˆ‡åˆ†å…ƒç´ ï¼Œå³æŒ‡é’ˆ j çš„å³ä¾§å…ƒç´ éƒ½ä¸å°äºåˆ‡åˆ†å…ƒç´ ã€‚å½“ä¸¤ä¸ªæŒ‡é’ˆç›¸é‡æ—¶ï¼Œå°†åˆ‡åˆ†å…ƒç´  a[lo] å’Œ a[j] äº¤æ¢ä½ç½®ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062007.png" width="300"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">partition</span><span class="params">(T[] nums, <span class="keyword">int</span> l, <span class="keyword">int</span> h)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = l, j = h + <span class="number">1</span>;</span><br><span class="line">    T v = nums[l];</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (less(nums[++i], v) &amp;&amp; i != h) ;</span><br><span class="line">        <span class="keyword">while</span> (less(v, nums[--j]) &amp;&amp; j != l) ;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= j)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        swap(nums, i, j);</span><br><span class="line">    &#125;</span><br><span class="line">    swap(nums, l, j);</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-æ€§èƒ½åˆ†æ"><a href="#3-æ€§èƒ½åˆ†æ" class="headerlink" title="3. æ€§èƒ½åˆ†æ"></a>3. æ€§èƒ½åˆ†æ</h3><p>å¿«é€Ÿæ’åºæ˜¯åŸåœ°æ’åºï¼Œä¸éœ€è¦è¾…åŠ©æ•°ç»„ï¼Œä½†æ˜¯é€’å½’è°ƒç”¨éœ€è¦è¾…åŠ©æ ˆã€‚</p><p>å¿«é€Ÿæ’åºæœ€å¥½çš„æƒ…å†µä¸‹æ˜¯æ¯æ¬¡éƒ½æ­£å¥½èƒ½å°†æ•°ç»„å¯¹åŠåˆ†ï¼Œè¿™æ ·é€’å½’è°ƒç”¨æ¬¡æ•°æ‰æ˜¯æœ€å°‘çš„ã€‚è¿™ç§æƒ…å†µä¸‹æ¯”è¾ƒæ¬¡æ•°ä¸º C<sub>N</sub>=2C<sub>N/2</sub>+Nï¼Œå¤æ‚åº¦ä¸º O(NlogN)ã€‚</p><p>æœ€åçš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸€æ¬¡ä»æœ€å°çš„å…ƒç´ åˆ‡åˆ†ï¼Œç¬¬äºŒæ¬¡ä»ç¬¬äºŒå°çš„å…ƒç´ åˆ‡åˆ†ï¼Œå¦‚æ­¤è¿™èˆ¬ã€‚å› æ­¤æœ€åçš„æƒ…å†µä¸‹éœ€è¦æ¯”è¾ƒ N<sup>2</sup>/2ã€‚ä¸ºäº†é˜²æ­¢æ•°ç»„æœ€å¼€å§‹å°±æ˜¯æœ‰åºçš„ï¼Œåœ¨è¿›è¡Œå¿«é€Ÿæ’åºæ—¶éœ€è¦éšæœºæ‰“ä¹±æ•°ç»„ã€‚</p><h3 id="4-ç®—æ³•æ”¹è¿›"><a href="#4-ç®—æ³•æ”¹è¿›" class="headerlink" title="4. ç®—æ³•æ”¹è¿›"></a>4. ç®—æ³•æ”¹è¿›</h3><p>ï¼ˆä¸€ï¼‰åˆ‡æ¢åˆ°æ’å…¥æ’åº</p><p>å› ä¸ºå¿«é€Ÿæ’åºåœ¨å°æ•°ç»„ä¸­ä¹Ÿä¼šé€’å½’è°ƒç”¨è‡ªå·±ï¼Œå¯¹äºå°æ•°ç»„ï¼Œæ’å…¥æ’åºæ¯”å¿«é€Ÿæ’åºçš„æ€§èƒ½æ›´å¥½ï¼Œå› æ­¤åœ¨å°æ•°ç»„ä¸­å¯ä»¥åˆ‡æ¢åˆ°æ’å…¥æ’åºã€‚</p><p>ï¼ˆäºŒï¼‰ä¸‰æ•°å–ä¸­</p><p>æœ€å¥½çš„æƒ…å†µä¸‹æ˜¯æ¯æ¬¡éƒ½èƒ½å–æ•°ç»„çš„ä¸­ä½æ•°ä½œä¸ºåˆ‡åˆ†å…ƒç´ ï¼Œä½†æ˜¯è®¡ç®—ä¸­ä½æ•°çš„ä»£ä»·å¾ˆé«˜ã€‚äººä»¬å‘ç°å– 3 ä¸ªå…ƒç´ å¹¶å°†å¤§å°å±…ä¸­çš„å…ƒç´ ä½œä¸ºåˆ‡åˆ†å…ƒç´ çš„æ•ˆæœæœ€å¥½ã€‚</p><p>ï¼ˆä¸‰ï¼‰ä¸‰å‘åˆ‡åˆ†</p><p>å¯¹äºæœ‰å¤§é‡é‡å¤å…ƒç´ çš„æ•°ç»„ï¼Œå¯ä»¥å°†æ•°ç»„åˆ‡åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œåˆ†åˆ«å¯¹åº”å°äºã€ç­‰äºå’Œå¤§äºåˆ‡åˆ†å…ƒç´ ã€‚</p><p>ä¸‰å‘åˆ‡åˆ†å¿«é€Ÿæ’åºå¯¹äºåªæœ‰è‹¥å¹²ä¸åŒä¸»é”®çš„éšæœºæ•°ç»„å¯ä»¥åœ¨çº¿æ€§æ—¶é—´å†…å®Œæˆæ’åºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreeWayQuickSort</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">QuickSort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums, <span class="keyword">int</span> l, <span class="keyword">int</span> h)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (h &lt;= l)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> lt = l, i = l + <span class="number">1</span>, gt = h;</span><br><span class="line">        T v = nums[l];</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= gt) &#123;</span><br><span class="line">            <span class="keyword">int</span> cmp = nums[i].compareTo(v);</span><br><span class="line">            <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                swap(nums, lt++, i++);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">                swap(nums, i, gt--);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                i++;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(nums, l, lt - <span class="number">1</span>);</span><br><span class="line">        sort(nums, gt + <span class="number">1</span>, h);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-åŸºäºåˆ‡åˆ†çš„å¿«é€Ÿé€‰æ‹©ç®—æ³•"><a href="#5-åŸºäºåˆ‡åˆ†çš„å¿«é€Ÿé€‰æ‹©ç®—æ³•" class="headerlink" title="5. åŸºäºåˆ‡åˆ†çš„å¿«é€Ÿé€‰æ‹©ç®—æ³•"></a>5. åŸºäºåˆ‡åˆ†çš„å¿«é€Ÿé€‰æ‹©ç®—æ³•</h3><p>å¿«é€Ÿæ’åºçš„ partition() æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªæ•´æ•° j ä½¿å¾— a[l..j-1] å°äºç­‰äº a[j]ï¼Œä¸” a[j+1..h] å¤§äºç­‰äº a[j]ï¼Œæ­¤æ—¶ a[j] å°±æ˜¯æ•°ç»„çš„ç¬¬ j å¤§å…ƒç´ ã€‚</p><p>å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ‰¾å‡ºæ•°ç»„çš„ç¬¬ k ä¸ªå…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">select</span><span class="params">(T[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, h = nums.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (h &gt; l) &#123;</span><br><span class="line">        <span class="keyword">int</span> j = partition(nums, l, h);</span><br><span class="line">        <span class="keyword">if</span> (j == k)</span><br><span class="line">            <span class="keyword">return</span> nums[k];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (j &gt; k)</span><br><span class="line">            h = j - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l = j + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> nums[k];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥ç®—æ³•æ˜¯çº¿æ€§çº§åˆ«çš„ã€‚å› ä¸ºæ¯æ¬¡èƒ½å°†æ•°ç»„äºŒåˆ†ï¼Œé‚£ä¹ˆæ¯”è¾ƒçš„æ€»æ¬¡æ•°ä¸º (N+N/2+N/4+..)ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ k ä¸ªå…ƒç´ ï¼Œè¿™ä¸ªå’Œæ˜¾ç„¶å°äº 2Nã€‚</p><h2 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h2><h3 id="1-å †"><a href="#1-å †" class="headerlink" title="1. å †"></a>1. å †</h3><p>å †çš„æŸä¸ªèŠ‚ç‚¹çš„å€¼æ€»æ˜¯å¤§äºç­‰äºå­èŠ‚ç‚¹çš„å€¼ï¼Œå¹¶ä¸”å †æ˜¯ä¸€é¢—å®Œå…¨äºŒå‰æ ‘ã€‚</p><p>å †å¯ä»¥ç”¨æ•°ç»„æ¥è¡¨ç¤ºï¼Œå› ä¸ºå †æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œè€Œå®Œå…¨äºŒå‰æ ‘å¾ˆå®¹æ˜“å°±å­˜å‚¨åœ¨æ•°ç»„ä¸­ã€‚ä½ç½® k çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä½ç½®ä¸º k/2ï¼Œè€Œå®ƒçš„ä¸¤ä¸ªå­èŠ‚ç‚¹çš„ä½ç½®åˆ†åˆ«ä¸º 2k å’Œ 2k+1ã€‚è¿™é‡Œä¸ä½¿ç”¨æ•°ç»„ç´¢å¼•ä¸º 0 çš„ä½ç½®ï¼Œæ˜¯ä¸ºäº†æ›´æ¸…æ™°åœ°æè¿°èŠ‚ç‚¹çš„ä½ç½®å…³ç³»ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062014.png" width="200"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Heap</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> T[] heap;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Heap</span><span class="params">(<span class="keyword">int</span> maxN)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.heap = (T[]) <span class="keyword">new</span> Comparable[maxN + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">less</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> heap[i].compareTo(heap[j]) &lt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">        T t = heap[i];</span><br><span class="line">        heap[i] = heap[j];</span><br><span class="line">        heap[j] = t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-ä¸Šæµ®å’Œä¸‹æ²‰"><a href="#2-ä¸Šæµ®å’Œä¸‹æ²‰" class="headerlink" title="2. ä¸Šæµ®å’Œä¸‹æ²‰"></a>2. ä¸Šæµ®å’Œä¸‹æ²‰</h3><p>åœ¨å †ä¸­ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹æ¯”çˆ¶èŠ‚ç‚¹å¤§ï¼Œé‚£ä¹ˆéœ€è¦äº¤æ¢è¿™ä¸ªä¸¤ä¸ªèŠ‚ç‚¹ã€‚äº¤æ¢åè¿˜å¯èƒ½æ¯”å®ƒæ–°çš„çˆ¶èŠ‚ç‚¹å¤§ï¼Œå› æ­¤éœ€è¦ä¸æ–­åœ°è¿›è¡Œæ¯”è¾ƒå’Œäº¤æ¢æ“ä½œï¼ŒæŠŠè¿™ç§æ“ä½œç§°ä¸ºä¸Šæµ®ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062018.png" width="400"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (k &gt; <span class="number">1</span> &amp;&amp; less(k / <span class="number">2</span>, k)) &#123;</span><br><span class="line">        swap(k / <span class="number">2</span>, k);</span><br><span class="line">        k = k / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼åœ°ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹æ¯”å­èŠ‚ç‚¹æ¥å¾—å°ï¼Œä¹Ÿéœ€è¦ä¸æ–­åœ°å‘ä¸‹è¿›è¡Œæ¯”è¾ƒå’Œäº¤æ¢æ“ä½œï¼ŒæŠŠè¿™ç§æ“ä½œç§°ä¸ºä¸‹æ²‰ã€‚ä¸€ä¸ªèŠ‚ç‚¹å¦‚æœæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œåº”å½“ä¸ä¸¤ä¸ªå­èŠ‚ç‚¹ä¸­æœ€å¤§é‚£ä¹ˆèŠ‚ç‚¹è¿›è¡Œäº¤æ¢ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062022.png" width="400"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sink</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">2</span> * k &lt;= N) &#123;</span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">2</span> * k;</span><br><span class="line">        <span class="keyword">if</span> (j &lt; N &amp;&amp; less(j, j + <span class="number">1</span>))</span><br><span class="line">            j++;</span><br><span class="line">        <span class="keyword">if</span> (!less(k, j))</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        swap(k, j);</span><br><span class="line">        k = j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-æ’å…¥å…ƒç´ "><a href="#3-æ’å…¥å…ƒç´ " class="headerlink" title="3. æ’å…¥å…ƒç´ "></a>3. æ’å…¥å…ƒç´ </h3><p>å°†æ–°å…ƒç´ æ”¾åˆ°æ•°ç»„æœ«å°¾ï¼Œç„¶åä¸Šæµ®åˆ°åˆé€‚çš„ä½ç½®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(Comparable v)</span> </span>&#123;</span><br><span class="line">    heap[++N] = v;</span><br><span class="line">    swim(N);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-åˆ é™¤æœ€å¤§å…ƒç´ "><a href="#4-åˆ é™¤æœ€å¤§å…ƒç´ " class="headerlink" title="4. åˆ é™¤æœ€å¤§å…ƒç´ "></a>4. åˆ é™¤æœ€å¤§å…ƒç´ </h3><p>ä»æ•°ç»„é¡¶ç«¯åˆ é™¤æœ€å¤§çš„å…ƒç´ ï¼Œå¹¶å°†æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ æ”¾åˆ°é¡¶ç«¯ï¼Œå¹¶è®©è¿™ä¸ªå…ƒç´ ä¸‹æ²‰åˆ°åˆé€‚çš„ä½ç½®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">delMax</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    T max = heap[<span class="number">1</span>];</span><br><span class="line">    swap(<span class="number">1</span>, N--);</span><br><span class="line">    heap[N + <span class="number">1</span>] = <span class="keyword">null</span>;</span><br><span class="line">    sink(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-å †æ’åº"><a href="#5-å †æ’åº" class="headerlink" title="5. å †æ’åº"></a>5. å †æ’åº</h3><p>ç”±äºå †å¯ä»¥å¾ˆå®¹æ˜“å¾—åˆ°æœ€å¤§çš„å…ƒç´ å¹¶åˆ é™¤å®ƒï¼Œä¸æ–­åœ°è¿›è¡Œè¿™ç§æ“ä½œå¯ä»¥å¾—åˆ°ä¸€ä¸ªé€’å‡åºåˆ—ã€‚å¦‚æœæŠŠæœ€å¤§å…ƒç´ å’Œå½“å‰å †ä¸­æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ï¼Œå¹¶ä¸”ä¸åˆ é™¤å®ƒï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä»å°¾åˆ°å¤´çš„é€’å‡åºåˆ—ï¼Œä»æ­£å‘æ¥çœ‹å°±æ˜¯ä¸€ä¸ªé€’å¢åºåˆ—ã€‚å› æ­¤å¾ˆå®¹æ˜“ä½¿ç”¨å †æ¥è¿›è¡Œæ’åºã€‚å¹¶ä¸”å †æ’åºæ˜¯åŸåœ°æ’åºï¼Œä¸å ç”¨é¢å¤–ç©ºé—´ã€‚</p><p>ï¼ˆä¸€ï¼‰æ„å»ºå †</p><p>æ— åºæ•°ç»„å»ºç«‹å †æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ä»å·¦åˆ°å³éå†æ•°ç»„ï¼Œç„¶åè¿›è¡Œä¸Šæµ®æ“ä½œã€‚ä¸€ä¸ªæ›´é«˜æ•ˆçš„æ–¹æ³•æ˜¯ä»å³è‡³å·¦è¿›è¡Œä¸‹æ²‰æ“ä½œï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å·²ç»æ˜¯å †æœ‰åºï¼Œé‚£ä¹ˆè¿›è¡Œä¸‹æ²‰æ“ä½œå¯ä»¥ä½¿å¾—è¿™ä¸ªèŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„å †æœ‰åºã€‚å¶å­èŠ‚ç‚¹ä¸éœ€è¦è¿›è¡Œä¸‹æ²‰æ“ä½œï¼Œå¯ä»¥å¿½ç•¥å¶å­èŠ‚ç‚¹çš„å…ƒç´ ï¼Œå› æ­¤åªéœ€è¦éå†ä¸€åŠçš„å…ƒç´ å³å¯ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062027.png" width="300"> </div><br></p><p>ï¼ˆäºŒï¼‰äº¤æ¢å †é¡¶å…ƒç´ ä¸æœ€åä¸€ä¸ªå…ƒç´ </p><p>äº¤æ¢ä¹‹åéœ€è¦è¿›è¡Œä¸‹æ²‰æ“ä½œç»´æŒå †çš„æœ‰åºçŠ¶æ€ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062032.png" width="270"> </div><br></p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062044.png" width="350"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeapSort</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">extends</span> <span class="title">Sort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°ç»„ç¬¬ 0 ä¸ªä½ç½®ä¸èƒ½æœ‰å…ƒç´ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = N / <span class="number">2</span>; k &gt;= <span class="number">1</span>; k--)</span><br><span class="line">            sink(nums, k, N);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (N &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            swap(nums, <span class="number">1</span>, N--);</span><br><span class="line">            sink(nums, <span class="number">1</span>, N);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sink</span><span class="params">(T[] nums, <span class="keyword">int</span> k, <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">2</span> * k &lt;= N) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = <span class="number">2</span> * k;</span><br><span class="line">            <span class="keyword">if</span> (j &lt; N &amp;&amp; less(nums, j, j + <span class="number">1</span>))</span><br><span class="line">                j++;</span><br><span class="line">            <span class="keyword">if</span> (!less(nums, k, j))</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            swap(nums, k, j);</span><br><span class="line">            k = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">less</span><span class="params">(T[] nums, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nums[i].compareTo(nums[j]) &lt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-åˆ†æ"><a href="#6-åˆ†æ" class="headerlink" title="6. åˆ†æ"></a>6. åˆ†æ</h3><p>ä¸€ä¸ªå †çš„é«˜åº¦ä¸º logNï¼Œå› æ­¤åœ¨å †ä¸­æ’å…¥å…ƒç´ å’Œåˆ é™¤æœ€å¤§å…ƒç´ çš„å¤æ‚åº¦éƒ½ä¸º logNã€‚</p><p>å¯¹äºå †æ’åºï¼Œç”±äºè¦å¯¹ N ä¸ªèŠ‚ç‚¹è¿›è¡Œä¸‹æ²‰æ“ä½œï¼Œå› æ­¤å¤æ‚åº¦ä¸º NlogNã€‚</p><p>å †æ’åºæ—¶ä¸€ç§åŸåœ°æ’åºï¼Œæ²¡æœ‰åˆ©ç”¨é¢å¤–çš„ç©ºé—´ã€‚</p><p>ç°ä»£æ“ä½œç³»ç»Ÿå¾ˆå°‘ä½¿ç”¨å †æ’åºï¼Œå› ä¸ºå®ƒæ— æ³•åˆ©ç”¨å±€éƒ¨æ€§åŸç†è¿›è¡Œç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯æ•°ç»„å…ƒç´ å¾ˆå°‘å’Œç›¸é‚»çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><h3 id="1-æ’åºç®—æ³•çš„æ¯”è¾ƒ"><a href="#1-æ’åºç®—æ³•çš„æ¯”è¾ƒ" class="headerlink" title="1. æ’åºç®—æ³•çš„æ¯”è¾ƒ"></a>1. æ’åºç®—æ³•çš„æ¯”è¾ƒ</h3><table><thead><tr><th style="text-align:center">ç®—æ³•</th><th style="text-align:center">ç¨³å®š</th><th style="text-align:center">æ—¶é—´å¤æ‚åº¦</th><th style="text-align:center">ç©ºé—´å¤æ‚åº¦</th><th style="text-align:center">å¤‡æ³¨</th></tr></thead><tbody><tr><td style="text-align:center">é€‰æ‹©æ’åº</td><td style="text-align:center">no</td><td style="text-align:center">N<sup>2</sup></td><td style="text-align:center">1</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">å†’æ³¡æ’åº</td><td style="text-align:center">yes</td><td style="text-align:center">N<sup>2</sup></td><td style="text-align:center">1</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">æ’å…¥æ’åº</td><td style="text-align:center">yes</td><td style="text-align:center">N ~ N<sup>2</sup></td><td style="text-align:center">1</td><td style="text-align:center">æ—¶é—´å¤æ‚åº¦å’Œåˆå§‹é¡ºåºæœ‰å…³</td></tr><tr><td style="text-align:center">å¸Œå°”æ’åº</td><td style="text-align:center">no</td><td style="text-align:center">N çš„è‹¥å¹²å€ä¹˜äºé€’å¢åºåˆ—çš„é•¿åº¦</td><td style="text-align:center">1</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">å¿«é€Ÿæ’åº</td><td style="text-align:center">no</td><td style="text-align:center">NlogN</td><td style="text-align:center">logN</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">ä¸‰å‘åˆ‡åˆ†å¿«é€Ÿæ’åº</td><td style="text-align:center">no</td><td style="text-align:center">N ~ NlogN</td><td style="text-align:center">logN</td><td style="text-align:center">é€‚ç”¨äºæœ‰å¤§é‡é‡å¤ä¸»é”®</td></tr><tr><td style="text-align:center">å½’å¹¶æ’åº</td><td style="text-align:center">yes</td><td style="text-align:center">NlogN</td><td style="text-align:center">N</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">å †æ’åº</td><td style="text-align:center">no</td><td style="text-align:center">NlogN</td><td style="text-align:center">1</td><td style="text-align:center"></td></tr></tbody></table><p>å¿«é€Ÿæ’åºæ˜¯æœ€å¿«çš„é€šç”¨æ’åºç®—æ³•ï¼Œå®ƒçš„å†…å¾ªç¯çš„æŒ‡ä»¤å¾ˆå°‘ï¼Œè€Œä¸”å®ƒè¿˜èƒ½åˆ©ç”¨ç¼“å­˜ï¼Œå› ä¸ºå®ƒæ€»æ˜¯é¡ºåºåœ°è®¿é—®æ•°æ®ã€‚å®ƒçš„è¿è¡Œæ—¶é—´è¿‘ä¼¼ä¸º ~cNlogNï¼Œè¿™é‡Œçš„ c æ¯”å…¶ä»–çº¿æ€§å¯¹æ•°çº§åˆ«çš„æ’åºç®—æ³•éƒ½è¦å°ã€‚ä½¿ç”¨ä¸‰å‘åˆ‡åˆ†å¿«é€Ÿæ’åºï¼Œå®é™…åº”ç”¨ä¸­å¯èƒ½å‡ºç°çš„æŸäº›åˆ†å¸ƒçš„è¾“å…¥èƒ½å¤Ÿè¾¾åˆ°çº¿æ€§çº§åˆ«ï¼Œè€Œå…¶å®ƒæ’åºç®—æ³•ä»ç„¶éœ€è¦çº¿æ€§å¯¹æ•°æ—¶é—´ã€‚</p><h3 id="2-Java-çš„æ’åºç®—æ³•å®ç°"><a href="#2-Java-çš„æ’åºç®—æ³•å®ç°" class="headerlink" title="2. Java çš„æ’åºç®—æ³•å®ç°"></a>2. Java çš„æ’åºç®—æ³•å®ç°</h3><p>Java ä¸»è¦æ’åºæ–¹æ³•ä¸º java.util.Arrays.sort()ï¼Œå¯¹äºåŸå§‹æ•°æ®ç±»å‹ä½¿ç”¨ä¸‰å‘åˆ‡åˆ†çš„å¿«é€Ÿæ’åºï¼Œå¯¹äºå¼•ç”¨ç±»å‹ä½¿ç”¨å½’å¹¶æ’åºã€‚</p><h1 id="å…­ã€æŸ¥æ‰¾"><a href="#å…­ã€æŸ¥æ‰¾" class="headerlink" title="å…­ã€æŸ¥æ‰¾"></a>å…­ã€æŸ¥æ‰¾</h1><p>ç¬¦å·è¡¨ï¼ˆSymbol Tableï¼‰æ˜¯ä¸€ç§å­˜å‚¨é”®å€¼å¯¹çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥æ”¯æŒå¿«é€ŸæŸ¥æ‰¾æ“ä½œã€‚</p><p>ç¬¦å·è¡¨åˆ†ä¸ºæœ‰åºå’Œæ— åºä¸¤ç§ï¼Œæœ‰åºç¬¦å·è¡¨ä¸»è¦æŒ‡æ”¯æŒ min()ã€max() ç­‰æ ¹æ®é”®çš„å¤§å°å…³ç³»æ¥å®ç°çš„æ“ä½œã€‚</p><p>æœ‰åºç¬¦å·è¡¨çš„é”®éœ€è¦å®ç° Comparable æ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UnorderedST</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Value <span class="title">get</span><span class="params">(Key key)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key, Value value)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(Key key)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderedST</span>&lt;<span class="title">Key</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">Key</span>&gt;, <span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key, Value value)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Value <span class="title">get</span><span class="params">(Key key)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Key <span class="title">min</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Key <span class="title">max</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">rank</span><span class="params">(Key key)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Key&gt; <span class="title">keys</span><span class="params">(Key l, Key h)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é“¾è¡¨å®ç°æ— åºç¬¦å·è¡¨"><a href="#é“¾è¡¨å®ç°æ— åºç¬¦å·è¡¨" class="headerlink" title="é“¾è¡¨å®ç°æ— åºç¬¦å·è¡¨"></a>é“¾è¡¨å®ç°æ— åºç¬¦å·è¡¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListUnorderedST</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt; <span class="keyword">implements</span> <span class="title">UnorderedST</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node first;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        Key key;</span><br><span class="line">        Value value;</span><br><span class="line">        Node next;</span><br><span class="line"></span><br><span class="line">        Node(Key key, Value value, Node next) &#123;</span><br><span class="line">            <span class="keyword">this</span>.key = key;</span><br><span class="line">            <span class="keyword">this</span>.value = value;</span><br><span class="line">            <span class="keyword">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        Node cur = first;</span><br><span class="line">        <span class="keyword">while</span> (cur != <span class="keyword">null</span>) &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key, Value value)</span> </span>&#123;</span><br><span class="line">        Node cur = first;</span><br><span class="line">        <span class="comment">// å¦‚æœåœ¨é“¾è¡¨ä¸­æ‰¾åˆ°èŠ‚ç‚¹çš„é”®ç­‰äº key å°±æ›´æ–°è¿™ä¸ªèŠ‚ç‚¹çš„å€¼ä¸º value</span></span><br><span class="line">        <span class="keyword">while</span> (cur != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur.key.equals(key)) &#123;</span><br><span class="line">                cur.value = value;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦åˆ™ä½¿ç”¨å¤´æ’æ³•æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹</span></span><br><span class="line">        first = <span class="keyword">new</span> Node(key, value, first);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (first == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (first.key.equals(key))</span><br><span class="line">            first = first.next;</span><br><span class="line">        Node pre = first, cur = first.next;</span><br><span class="line">        <span class="keyword">while</span> (cur != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur.key.equals(key)) &#123;</span><br><span class="line">                pre.next = cur.next;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            pre = pre.next;</span><br><span class="line">            cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Value <span class="title">get</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">        Node cur = first;</span><br><span class="line">        <span class="keyword">while</span> (cur != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur.key.equals(key))</span><br><span class="line">                <span class="keyword">return</span> cur.value;</span><br><span class="line">            cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äºŒåˆ†æŸ¥æ‰¾å®ç°æœ‰åºç¬¦å·è¡¨"><a href="#äºŒåˆ†æŸ¥æ‰¾å®ç°æœ‰åºç¬¦å·è¡¨" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾å®ç°æœ‰åºç¬¦å·è¡¨"></a>äºŒåˆ†æŸ¥æ‰¾å®ç°æœ‰åºç¬¦å·è¡¨</h2><p>ä½¿ç”¨ä¸€å¯¹å¹³è¡Œæ•°ç»„ï¼Œä¸€ä¸ªå­˜å‚¨é”®ä¸€ä¸ªå­˜å‚¨å€¼ã€‚</p><p>rank() æ–¹æ³•è‡³å…³é‡è¦ï¼Œå½“é”®åœ¨è¡¨ä¸­æ—¶ï¼Œå®ƒèƒ½å¤ŸçŸ¥é“è¯¥é”®çš„ä½ç½®ï¼›å½“é”®ä¸åœ¨è¡¨ä¸­æ—¶ï¼Œå®ƒä¹Ÿèƒ½çŸ¥é“åœ¨ä½•å¤„æ’å…¥æ–°é”®ã€‚</p><p>å¤æ‚åº¦ï¼šäºŒåˆ†æŸ¥æ‰¾æœ€å¤šéœ€è¦ logN+1 æ¬¡æ¯”è¾ƒï¼Œä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾å®ç°çš„ç¬¦å·è¡¨çš„æŸ¥æ‰¾æ“ä½œæ‰€éœ€è¦çš„æ—¶é—´æœ€å¤šæ˜¯å¯¹æ•°çº§åˆ«çš„ã€‚ä½†æ˜¯æ’å…¥æ“ä½œéœ€è¦ç§»åŠ¨æ•°ç»„å…ƒç´ ï¼Œæ˜¯çº¿æ€§çº§åˆ«çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BinarySearchOrderedST</span>&lt;<span class="title">Key</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">Key</span>&gt;, <span class="title">Value</span>&gt; <span class="keyword">implements</span> <span class="title">OrderedST</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Key[] keys;</span><br><span class="line">    <span class="keyword">private</span> Value[] values;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BinarySearchOrderedST</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">        keys = (Key[]) <span class="keyword">new</span> Comparable[capacity];</span><br><span class="line">        values = (Value[]) <span class="keyword">new</span> Object[capacity];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> N;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rank</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, h = N - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= h) &#123;</span><br><span class="line">            <span class="keyword">int</span> m = l + (h - l) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> cmp = key.compareTo(keys[m]);</span><br><span class="line">            <span class="keyword">if</span> (cmp == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> m;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                h = m - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                l = m + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Key&gt; <span class="title">keys</span><span class="params">(Key l, Key h)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = rank(l);</span><br><span class="line">        List&lt;Key&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (keys[index].compareTo(h) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            list.add(keys[index]);</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key, Value value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = rank(key);</span><br><span class="line">        <span class="comment">// å¦‚æœæ‰¾åˆ°å·²ç»å­˜åœ¨çš„èŠ‚ç‚¹é”®ä½ keyï¼Œå°±æ›´æ–°è¿™ä¸ªèŠ‚ç‚¹çš„å€¼ä¸º value</span></span><br><span class="line">        <span class="keyword">if</span> (index &lt; N &amp;&amp; keys[index].compareTo(key) == <span class="number">0</span>) &#123;</span><br><span class="line">            values[index] = value;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦åˆ™åœ¨æ•°ç»„ä¸­æ’å…¥æ–°çš„èŠ‚ç‚¹ï¼Œéœ€è¦å…ˆå°†æ’å…¥ä½ç½®ä¹‹åçš„å…ƒç´ éƒ½å‘åç§»åŠ¨ä¸€ä¸ªä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = N; j &gt; index; j--) &#123;</span><br><span class="line">            keys[j] = keys[j - <span class="number">1</span>];</span><br><span class="line">            values[j] = values[j - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        keys[index] = key;</span><br><span class="line">        values[index] = value;</span><br><span class="line">        N++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Value <span class="title">get</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = rank(key);</span><br><span class="line">        <span class="keyword">if</span> (index &lt; N &amp;&amp; keys[index].compareTo(key) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> values[index];</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Key <span class="title">min</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> keys[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Key <span class="title">max</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> keys[N - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äºŒå‰æŸ¥æ‰¾æ ‘"><a href="#äºŒå‰æŸ¥æ‰¾æ ‘" class="headerlink" title="äºŒå‰æŸ¥æ‰¾æ ‘"></a>äºŒå‰æŸ¥æ‰¾æ ‘</h2><p><strong>äºŒå‰æ ‘</strong>  æ˜¯ä¸€ä¸ªç©ºé“¾æ¥ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªæœ‰å·¦å³ä¸¤ä¸ªé“¾æ¥çš„èŠ‚ç‚¹ï¼Œæ¯ä¸ªé“¾æ¥éƒ½æŒ‡å‘ä¸€é¢—å­äºŒå‰æ ‘ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062059.png" width="200"> </div><br></p><p><strong>äºŒå‰æŸ¥æ‰¾æ ‘</strong> ï¼ˆBSTï¼‰æ˜¯ä¸€é¢—äºŒå‰æ ‘ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºç­‰äºå…¶å·¦å­æ ‘ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹çš„å€¼è€Œå°äºç­‰äºå³å­æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹çš„å€¼ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062104.png" width="200"> </div><br></p><p>BST æœ‰ä¸€ä¸ªé‡è¦æ€§è´¨ï¼Œå°±æ˜¯å®ƒçš„ä¸­åºéå†ç»“æœé€’å¢æ’åºã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062108.png" width="200"> </div><br></p><p>åŸºæœ¬æ•°æ®ç»“æ„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BST</span>&lt;<span class="title">Key</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">Key</span>&gt;, <span class="title">Value</span>&gt; <span class="keyword">implements</span> <span class="title">OrderedST</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Node root;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        Key key;</span><br><span class="line">        Value val;</span><br><span class="line">        Node left;</span><br><span class="line">        Node right;</span><br><span class="line">        <span class="comment">// ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘èŠ‚ç‚¹æ€»æ•°</span></span><br><span class="line">        <span class="keyword">int</span> N;</span><br><span class="line">        <span class="comment">// çº¢é»‘æ ‘ä¸­ä½¿ç”¨</span></span><br><span class="line">        <span class="keyword">boolean</span> color;</span><br><span class="line"></span><br><span class="line">        Node(Key key, Value val, <span class="keyword">int</span> N) &#123;</span><br><span class="line">            <span class="keyword">this</span>.key = key;</span><br><span class="line">            <span class="keyword">this</span>.val = val;</span><br><span class="line">            <span class="keyword">this</span>.N = N;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">(Node x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> x.N;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">recalculateSize</span><span class="params">(Node x)</span> </span>&#123;</span><br><span class="line">        x.N = size(x.left) + size(x.right) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆä¸ºäº†æ–¹ä¾¿ç»˜å›¾ï¼ŒäºŒå‰æ ‘çš„ç©ºé“¾æ¥ä¸ç”»å‡ºæ¥ã€‚ï¼‰</p><h3 id="1-get"><a href="#1-get" class="headerlink" title="1. get()"></a>1. get()</h3><ul><li>å¦‚æœæ ‘æ˜¯ç©ºçš„ï¼Œåˆ™æŸ¥æ‰¾æœªå‘½ä¸­ï¼›</li><li>å¦‚æœè¢«æŸ¥æ‰¾çš„é”®å’Œæ ¹èŠ‚ç‚¹çš„é”®ç›¸ç­‰ï¼ŒæŸ¥æ‰¾å‘½ä¸­ï¼›</li><li>å¦åˆ™é€’å½’åœ°åœ¨å­æ ‘ä¸­æŸ¥æ‰¾ï¼šå¦‚æœè¢«æŸ¥æ‰¾çš„é”®è¾ƒå°å°±åœ¨å·¦å­æ ‘ä¸­æŸ¥æ‰¾ï¼Œè¾ƒå¤§å°±åœ¨å³å­æ ‘ä¸­æŸ¥æ‰¾ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Value <span class="title">get</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> get(root, key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> Value <span class="title">get</span><span class="params">(Node x, Key key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">int</span> cmp = key.compareTo(x.key);</span><br><span class="line">    <span class="keyword">if</span> (cmp == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> x.val;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> get(x.left, key);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> get(x.right, key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-put"><a href="#2-put" class="headerlink" title="2. put()"></a>2. put()</h3><p>å½“æ’å…¥çš„é”®ä¸å­˜åœ¨äºæ ‘ä¸­ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå¹¶ä¸”æ›´æ–°ä¸Šå±‚èŠ‚ç‚¹çš„é“¾æ¥ä½¿å¾—è¯¥èŠ‚ç‚¹æ­£ç¡®é“¾æ¥åˆ°æ ‘ä¸­ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062114.png" width="200"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key, Value value)</span> </span>&#123;</span><br><span class="line">    root = put(root, key, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">put</span><span class="params">(Node x, Key key, Value value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Node(key, value, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> cmp = key.compareTo(x.key);</span><br><span class="line">    <span class="keyword">if</span> (cmp == <span class="number">0</span>)</span><br><span class="line">        x.val = value;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">        x.left = put(x.left, key, value);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        x.right = put(x.right, key, value);</span><br><span class="line">    recalculateSize(x);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-åˆ†æ"><a href="#3-åˆ†æ" class="headerlink" title="3. åˆ†æ"></a>3. åˆ†æ</h3><p>äºŒå‰æŸ¥æ‰¾æ ‘çš„ç®—æ³•è¿è¡Œæ—¶é—´å–å†³äºæ ‘çš„å½¢çŠ¶ï¼Œè€Œæ ‘çš„å½¢çŠ¶åˆå–å†³äºé”®è¢«æ’å…¥çš„å…ˆåé¡ºåºã€‚æœ€å¥½çš„æƒ…å†µä¸‹æ ‘æ˜¯å®Œå…¨å¹³è¡¡çš„ï¼Œæ¯æ¡ç©ºé“¾æ¥å’Œæ ¹èŠ‚ç‚¹çš„è·ç¦»éƒ½ä¸º logNã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062117.png" width="200"> </div><br></p><p>åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ ‘çš„é«˜åº¦ä¸º Nã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062121.png" width="200"> </div><br></p><h3 id="4-floor"><a href="#4-floor" class="headerlink" title="4. floor()"></a>4. floor()</h3><p>floor(key)ï¼šå°äºç­‰äºé”®çš„æœ€å¤§é”®</p><ul><li>å¦‚æœé”®å°äºæ ¹èŠ‚ç‚¹çš„é”®ï¼Œé‚£ä¹ˆ floor(key) ä¸€å®šåœ¨å·¦å­æ ‘ä¸­ï¼›</li><li>å¦‚æœé”®å¤§äºæ ¹èŠ‚ç‚¹çš„é”®ï¼Œéœ€è¦å…ˆåˆ¤æ–­å³å­æ ‘ä¸­æ˜¯å¦å­˜åœ¨ floor(key)ï¼Œå¦‚æœå­˜åœ¨å°±æ‰¾åˆ°ï¼Œå¦åˆ™æ ¹èŠ‚ç‚¹å°±æ˜¯ floor(key)ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Key <span class="title">floor</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">    Node x = floor(root, key);</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">return</span> x.key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">floor</span><span class="params">(Node x, Key key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">int</span> cmp = key.compareTo(x.key);</span><br><span class="line">    <span class="keyword">if</span> (cmp == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> floor(x.left, key);</span><br><span class="line">    Node t = floor(x.right, key);</span><br><span class="line">    <span class="keyword">return</span> t != <span class="keyword">null</span> ? t : x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-rank"><a href="#5-rank" class="headerlink" title="5. rank()"></a>5. rank()</h3><p>rank(key) è¿”å› key çš„æ’åã€‚</p><ul><li>å¦‚æœé”®å’Œæ ¹èŠ‚ç‚¹çš„é”®ç›¸ç­‰ï¼Œè¿”å›å·¦å­æ ‘çš„èŠ‚ç‚¹æ•°ï¼›</li><li>å¦‚æœå°äºï¼Œé€’å½’è®¡ç®—åœ¨å·¦å­æ ‘ä¸­çš„æ’åï¼›</li><li>å¦‚æœå¤§äºï¼Œé€’å½’è®¡ç®—åœ¨å³å­æ ‘ä¸­çš„æ’åï¼Œå¹¶åŠ ä¸Šå·¦å­æ ‘çš„èŠ‚ç‚¹æ•°ï¼Œå†åŠ ä¸Š 1ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rank</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> rank(key, root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">rank</span><span class="params">(Key key, Node x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> cmp = key.compareTo(x.key);</span><br><span class="line">    <span class="keyword">if</span> (cmp == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> size(x.left);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> rank(key, x.left);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + size(x.left) + rank(key, x.right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-min"><a href="#6-min" class="headerlink" title="6. min()"></a>6. min()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Key <span class="title">min</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> min(root).key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">min</span><span class="params">(Node x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (x.left == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> min(x.left);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-deleteMin"><a href="#7-deleteMin" class="headerlink" title="7. deleteMin()"></a>7. deleteMin()</h3><p>ä»¤æŒ‡å‘æœ€å°èŠ‚ç‚¹çš„é“¾æ¥æŒ‡å‘æœ€å°èŠ‚ç‚¹çš„å³å­æ ‘ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062127.png" width="500"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    root = deleteMin(root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Node <span class="title">deleteMin</span><span class="params">(Node x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x.left == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> x.right;</span><br><span class="line">    x.left = deleteMin(x.left);</span><br><span class="line">    recalculateSize(x);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-delete"><a href="#8-delete" class="headerlink" title="8. delete()"></a>8. delete()</h3><ul><li>å¦‚æœå¾…åˆ é™¤çš„èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå­æ ‘ï¼Œé‚£ä¹ˆåªéœ€è¦è®©æŒ‡å‘å¾…åˆ é™¤èŠ‚ç‚¹çš„é“¾æ¥æŒ‡å‘å”¯ä¸€çš„å­æ ‘å³å¯ï¼›</li><li>å¦åˆ™ï¼Œè®©å³å­æ ‘çš„æœ€å°èŠ‚ç‚¹æ›¿æ¢è¯¥èŠ‚ç‚¹ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062132.png" width="400"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">    root = delete(root, key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">delete</span><span class="params">(Node x, Key key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">int</span> cmp = key.compareTo(x.key);</span><br><span class="line">    <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">        x.left = delete(x.left, key);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">        x.right = delete(x.right, key);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x.right == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> x.left;</span><br><span class="line">        <span class="keyword">if</span> (x.left == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> x.right;</span><br><span class="line">        Node t = x;</span><br><span class="line">        x = min(t.right);</span><br><span class="line">        x.right = deleteMin(t.right);</span><br><span class="line">        x.left = t.left;</span><br><span class="line">    &#125;</span><br><span class="line">    recalculateSize(x);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-keys"><a href="#9-keys" class="headerlink" title="9. keys()"></a>9. keys()</h3><p>åˆ©ç”¨äºŒå‰æŸ¥æ‰¾æ ‘ä¸­åºéå†çš„ç»“æœä¸ºé€’å¢çš„ç‰¹ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Key&gt; <span class="title">keys</span><span class="params">(Key l, Key h)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> keys(root, l, h);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> List&lt;Key&gt; <span class="title">keys</span><span class="params">(Node x, Key l, Key h)</span> </span>&#123;</span><br><span class="line">    List&lt;Key&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    <span class="keyword">int</span> cmpL = l.compareTo(x.key);</span><br><span class="line">    <span class="keyword">int</span> cmpH = h.compareTo(x.key);</span><br><span class="line">    <span class="keyword">if</span> (cmpL &lt; <span class="number">0</span>)</span><br><span class="line">        list.addAll(keys(x.left, l, h));</span><br><span class="line">    <span class="keyword">if</span> (cmpL &lt;= <span class="number">0</span> &amp;&amp; cmpH &gt;= <span class="number">0</span>)</span><br><span class="line">        list.add(x.key);</span><br><span class="line">    <span class="keyword">if</span> (cmpH &gt; <span class="number">0</span>)</span><br><span class="line">        list.addAll(keys(x.right, l, h));</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="10-æ€§èƒ½åˆ†æ"><a href="#10-æ€§èƒ½åˆ†æ" class="headerlink" title="10. æ€§èƒ½åˆ†æ"></a>10. æ€§èƒ½åˆ†æ</h3><p>å¤æ‚åº¦ï¼šäºŒå‰æŸ¥æ‰¾æ ‘æ‰€æœ‰æ“ä½œåœ¨æœ€åçš„æƒ…å†µä¸‹æ‰€éœ€è¦çš„æ—¶é—´éƒ½å’Œæ ‘çš„é«˜åº¦æˆæ­£æ¯”ã€‚</p><h2 id="2-3-æŸ¥æ‰¾æ ‘"><a href="#2-3-æŸ¥æ‰¾æ ‘" class="headerlink" title="2-3 æŸ¥æ‰¾æ ‘"></a>2-3 æŸ¥æ‰¾æ ‘</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062137.png" width="250"> </div><br></p><p>2-3 æŸ¥æ‰¾æ ‘å¼•å…¥äº† 2- èŠ‚ç‚¹å’Œ 3- èŠ‚ç‚¹ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©æ ‘å¹³è¡¡ã€‚ä¸€é¢—å®Œç¾å¹³è¡¡çš„ 2-3 æŸ¥æ‰¾æ ‘çš„æ‰€æœ‰ç©ºé“¾æ¥åˆ°æ ¹èŠ‚ç‚¹çš„è·ç¦»åº”è¯¥æ˜¯ç›¸åŒçš„ã€‚</p><h3 id="1-æ’å…¥æ“ä½œ"><a href="#1-æ’å…¥æ“ä½œ" class="headerlink" title="1. æ’å…¥æ“ä½œ"></a>1. æ’å…¥æ“ä½œ</h3><p>æ’å…¥æ“ä½œå’Œ BST çš„æ’å…¥æ“ä½œæœ‰å¾ˆå¤§åŒºåˆ«ï¼ŒBST çš„æ’å…¥æ“ä½œæ˜¯å…ˆè¿›è¡Œä¸€æ¬¡æœªå‘½ä¸­çš„æŸ¥æ‰¾ï¼Œç„¶åå†å°†èŠ‚ç‚¹æ’å…¥åˆ°å¯¹åº”çš„ç©ºé“¾æ¥ä¸Šã€‚ä½†æ˜¯ 2-3 æŸ¥æ‰¾æ ‘å¦‚æœä¹Ÿè¿™ä¹ˆåšçš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šç ´åäº†å¹³è¡¡æ€§ã€‚å®ƒæ˜¯å°†æ–°èŠ‚ç‚¹æ’å…¥åˆ°å¶å­èŠ‚ç‚¹ä¸Šã€‚</p><p>æ ¹æ®å¶å­èŠ‚ç‚¹çš„ç±»å‹ä¸åŒï¼Œæœ‰ä¸åŒçš„å¤„ç†æ–¹å¼ï¼š</p><ul><li>å¦‚æœæ’å…¥åˆ° 2- èŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆç›´æ¥å°†æ–°èŠ‚ç‚¹å’ŒåŸæ¥çš„èŠ‚ç‚¹ç»„æˆ 3- èŠ‚ç‚¹å³å¯ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062141.png" width="400"> </div><br></p><ul><li>å¦‚æœæ˜¯æ’å…¥åˆ° 3- èŠ‚ç‚¹ä¸Šï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶ 4- èŠ‚ç‚¹æ—¶ï¼Œéœ€è¦å°† 4- èŠ‚ç‚¹åˆ†è£‚æˆ 3 ä¸ª 2- èŠ‚ç‚¹ï¼Œå¹¶å°†ä¸­é—´çš„ 2- èŠ‚ç‚¹ç§»åˆ°ä¸Šå±‚èŠ‚ç‚¹ä¸­ã€‚å¦‚æœä¸Šç§»æ“ä½œç»§ç»­äº§ç”Ÿä¸´æ—¶ 4- èŠ‚ç‚¹åˆ™ä¸€ç›´è¿›è¡Œåˆ†è£‚ä¸Šç§»ï¼Œç›´åˆ°ä¸å­˜åœ¨ä¸´æ—¶ 4- èŠ‚ç‚¹ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062145.png" width="500"> </div><br></p><h3 id="2-æ€§è´¨"><a href="#2-æ€§è´¨" class="headerlink" title="2. æ€§è´¨"></a>2. æ€§è´¨</h3><p>2-3 æŸ¥æ‰¾æ ‘æ’å…¥æ“ä½œçš„å˜æ¢éƒ½æ˜¯å±€éƒ¨çš„ï¼Œé™¤äº†ç›¸å…³çš„èŠ‚ç‚¹å’Œé“¾æ¥ä¹‹å¤–ä¸å¿…ä¿®æ”¹æˆ–è€…æ£€æŸ¥æ ‘çš„å…¶å®ƒéƒ¨åˆ†ï¼Œè€Œè¿™äº›å±€éƒ¨å˜æ¢ä¸ä¼šå½±å“æ ‘çš„å…¨å±€æœ‰åºæ€§å’Œå¹³è¡¡æ€§ã€‚</p><p>2-3 æŸ¥æ‰¾æ ‘çš„æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œå¤æ‚åº¦å’Œæ’å…¥é¡ºåºæ— å…³ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œè®¿é—®çš„èŠ‚ç‚¹å¿…ç„¶ä¸è¶…è¿‡ logN ä¸ªï¼Œå«æœ‰ 10 äº¿ä¸ªèŠ‚ç‚¹çš„ 2-3 æŸ¥æ‰¾æ ‘æœ€å¤šåªéœ€è¦è®¿é—® 30 ä¸ªèŠ‚ç‚¹å°±èƒ½è¿›è¡Œä»»æ„çš„æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œã€‚</p><h2 id="çº¢é»‘æ ‘"><a href="#çº¢é»‘æ ‘" class="headerlink" title="çº¢é»‘æ ‘"></a>çº¢é»‘æ ‘</h2><p>2-3 æŸ¥æ‰¾æ ‘éœ€è¦ç”¨åˆ° 2- èŠ‚ç‚¹å’Œ 3- èŠ‚ç‚¹ï¼Œçº¢é»‘æ ‘ä½¿ç”¨çº¢é“¾æ¥æ¥å®ç° 3- èŠ‚ç‚¹ã€‚æŒ‡å‘ä¸€ä¸ªèŠ‚ç‚¹çš„é“¾æ¥é¢œè‰²å¦‚æœä¸ºçº¢è‰²ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å’Œä¸Šå±‚èŠ‚ç‚¹è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ª 3- èŠ‚ç‚¹ï¼Œè€Œé»‘è‰²åˆ™æ˜¯æ™®é€šé“¾æ¥ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062149.png" width="250"> </div><br></p><p>çº¢é»‘æ ‘å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p><ul><li>çº¢é“¾æ¥éƒ½ä¸ºå·¦é“¾æ¥ï¼›</li><li>å®Œç¾é»‘è‰²å¹³è¡¡ï¼Œå³ä»»æ„ç©ºé“¾æ¥åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šçš„é»‘é“¾æ¥æ•°é‡ç›¸åŒã€‚</li></ul><p>ç”»çº¢é»‘æ ‘æ—¶å¯ä»¥å°†çº¢é“¾æ¥ç”»å¹³ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062153.png" width="300"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedBlackBST</span>&lt;<span class="title">Key</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">Key</span>&gt;, <span class="title">Value</span>&gt; <span class="keyword">extends</span> <span class="title">BST</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> RED = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> BLACK = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isRed</span><span class="params">(Node x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">return</span> x.color == RED;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-å·¦æ—‹è½¬"><a href="#1-å·¦æ—‹è½¬" class="headerlink" title="1. å·¦æ—‹è½¬"></a>1. å·¦æ—‹è½¬</h3><p>å› ä¸ºåˆæ³•çš„çº¢é“¾æ¥éƒ½ä¸ºå·¦é“¾æ¥ï¼Œå¦‚æœå‡ºç°å³é“¾æ¥ä¸ºçº¢é“¾æ¥ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œå·¦æ—‹è½¬æ“ä½œã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062158.png" width="450"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Node <span class="title">rotateLeft</span><span class="params">(Node h)</span> </span>&#123;</span><br><span class="line">    Node x = h.right;</span><br><span class="line">    h.right = x.left;</span><br><span class="line">    x.left = h;</span><br><span class="line">    x.color = h.color;</span><br><span class="line">    h.color = RED;</span><br><span class="line">    x.N = h.N;</span><br><span class="line">    recalculateSize(h);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-å³æ—‹è½¬"><a href="#2-å³æ—‹è½¬" class="headerlink" title="2. å³æ—‹è½¬"></a>2. å³æ—‹è½¬</h3><p>è¿›è¡Œå³æ—‹è½¬æ˜¯ä¸ºäº†è½¬æ¢ä¸¤ä¸ªè¿ç»­çš„å·¦çº¢é“¾æ¥ï¼Œè¿™ä¼šåœ¨ä¹‹åçš„æ’å…¥è¿‡ç¨‹ä¸­æ¢è®¨ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062202.png" width="450"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Node <span class="title">rotateRight</span><span class="params">(Node h)</span> </span>&#123;</span><br><span class="line">    Node x = h.left;</span><br><span class="line">    h.left = x.right;</span><br><span class="line">    x.color = h.color;</span><br><span class="line">    h.color = RED;</span><br><span class="line">    x.N = h.N;</span><br><span class="line">    recalculateSize(h);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-é¢œè‰²è½¬æ¢"><a href="#3-é¢œè‰²è½¬æ¢" class="headerlink" title="3. é¢œè‰²è½¬æ¢"></a>3. é¢œè‰²è½¬æ¢</h3><p>ä¸€ä¸ª 4- èŠ‚ç‚¹åœ¨çº¢é»‘æ ‘ä¸­è¡¨ç°ä¸ºä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹éƒ½æ˜¯çº¢è‰²çš„ã€‚åˆ†è£‚ 4- èŠ‚ç‚¹é™¤äº†éœ€è¦å°†å­èŠ‚ç‚¹çš„é¢œè‰²ç”±çº¢å˜é»‘ä¹‹å¤–ï¼ŒåŒæ—¶éœ€è¦å°†çˆ¶èŠ‚ç‚¹çš„é¢œè‰²ç”±é»‘å˜çº¢ï¼Œä» 2-3 æ ‘çš„è§’åº¦çœ‹å°±æ˜¯å°†ä¸­é—´èŠ‚ç‚¹ç§»åˆ°ä¸Šå±‚èŠ‚ç‚¹ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062207.png" width="300"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">flipColors</span><span class="params">(Node h)</span> </span>&#123;</span><br><span class="line">    h.color = RED;</span><br><span class="line">    h.left.color = BLACK;</span><br><span class="line">    h.right.color = BLACK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-æ’å…¥"><a href="#4-æ’å…¥" class="headerlink" title="4. æ’å…¥"></a>4. æ’å…¥</h3><p>å…ˆå°†ä¸€ä¸ªèŠ‚ç‚¹æŒ‰äºŒå‰æŸ¥æ‰¾æ ‘çš„æ–¹æ³•æ’å…¥åˆ°æ­£ç¡®ä½ç½®ï¼Œç„¶åå†è¿›è¡Œå¦‚ä¸‹é¢œè‰²æ“ä½œï¼š</p><ul><li>å¦‚æœå³å­èŠ‚ç‚¹æ˜¯çº¢è‰²çš„è€Œå·¦å­èŠ‚ç‚¹æ˜¯é»‘è‰²çš„ï¼Œè¿›è¡Œå·¦æ—‹è½¬ï¼›</li><li>å¦‚æœå·¦å­èŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œè€Œä¸”å·¦å­èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¹Ÿæ˜¯çº¢è‰²çš„ï¼Œè¿›è¡Œå³æ—‹è½¬ï¼›</li><li>å¦‚æœå·¦å³å­èŠ‚ç‚¹å‡ä¸ºçº¢è‰²çš„ï¼Œè¿›è¡Œé¢œè‰²è½¬æ¢ã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062211.png" width="400"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key, Value value)</span> </span>&#123;</span><br><span class="line">    root = put(root, key, value);</span><br><span class="line">    root.color = BLACK;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">put</span><span class="params">(Node x, Key key, Value value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="keyword">null</span>) &#123;</span><br><span class="line">        Node node = <span class="keyword">new</span> Node(key, value, <span class="number">1</span>);</span><br><span class="line">        node.color = RED;</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> cmp = key.compareTo(x.key);</span><br><span class="line">    <span class="keyword">if</span> (cmp == <span class="number">0</span>)</span><br><span class="line">        x.val = value;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">        x.left = put(x.left, key, value);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        x.right = put(x.right, key, value);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isRed(x.right) &amp;&amp; !isRed(x.left))</span><br><span class="line">        x = rotateLeft(x);</span><br><span class="line">    <span class="keyword">if</span> (isRed(x.left) &amp;&amp; isRed(x.left.left))</span><br><span class="line">        x = rotateRight(x);</span><br><span class="line">    <span class="keyword">if</span> (isRed(x.left) &amp;&amp; isRed(x.right))</span><br><span class="line">        flipColors(x);</span><br><span class="line"></span><br><span class="line">    recalculateSize(x);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¯¥æ’å…¥æ“ä½œå’ŒäºŒå‰æŸ¥æ‰¾æ ‘çš„æ’å…¥æ“ä½œç±»ä¼¼ï¼Œåªæ˜¯åœ¨æœ€ååŠ å…¥äº†æ—‹è½¬å’Œé¢œè‰²å˜æ¢æ“ä½œå³å¯ã€‚</p><p>æ ¹èŠ‚ç‚¹ä¸€å®šä¸ºé»‘è‰²ï¼Œå› ä¸ºæ ¹èŠ‚ç‚¹æ²¡æœ‰ä¸Šå±‚èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ²¡æœ‰ä¸Šå±‚èŠ‚ç‚¹çš„å·¦é“¾æ¥æŒ‡å‘æ ¹èŠ‚ç‚¹ã€‚flipColors() æœ‰å¯èƒ½ä¼šä½¿å¾—æ ¹èŠ‚ç‚¹çš„é¢œè‰²å˜ä¸ºçº¢è‰²ï¼Œæ¯å½“æ ¹èŠ‚ç‚¹ç”±çº¢è‰²å˜æˆé»‘è‰²æ—¶æ ‘çš„é»‘é“¾æ¥é«˜åº¦åŠ  1.</p><h3 id="5-åˆ†æ"><a href="#5-åˆ†æ" class="headerlink" title="5. åˆ†æ"></a>5. åˆ†æ</h3><p>ä¸€é¢—å¤§å°ä¸º N çš„çº¢é»‘æ ‘çš„é«˜åº¦ä¸ä¼šè¶…è¿‡ 2logNã€‚æœ€åçš„æƒ…å†µä¸‹æ˜¯å®ƒæ‰€å¯¹åº”çš„ 2-3 æ ‘ï¼Œæ„æˆæœ€å·¦è¾¹çš„è·¯å¾„èŠ‚ç‚¹å…¨éƒ¨éƒ½æ˜¯ 3- èŠ‚ç‚¹è€Œå…¶ä½™éƒ½æ˜¯ 2- èŠ‚ç‚¹ã€‚</p><p>çº¢é»‘æ ‘å¤§å¤šæ•°çš„æ“ä½œæ‰€éœ€è¦çš„æ—¶é—´éƒ½æ˜¯å¯¹æ•°çº§åˆ«çš„ã€‚</p><h2 id="æ•£åˆ—è¡¨"><a href="#æ•£åˆ—è¡¨" class="headerlink" title="æ•£åˆ—è¡¨"></a>æ•£åˆ—è¡¨</h2><p>æ•£åˆ—è¡¨ç±»ä¼¼äºæ•°ç»„ï¼Œå¯ä»¥æŠŠæ•£åˆ—è¡¨çš„æ•£åˆ—å€¼çœ‹æˆæ•°ç»„çš„ç´¢å¼•å€¼ã€‚è®¿é—®æ•£åˆ—è¡¨å’Œè®¿é—®æ•°ç»„å…ƒç´ ä¸€æ ·å¿«é€Ÿï¼Œå®ƒå¯ä»¥åœ¨å¸¸æ•°æ—¶é—´å†…å®ç°æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œã€‚</p><p>ç”±äºæ— æ³•é€šè¿‡æ•£åˆ—å€¼çŸ¥é“é”®çš„å¤§å°å…³ç³»ï¼Œå› æ­¤æ•£åˆ—è¡¨æ— æ³•å®ç°æœ‰åºæ€§æ“ä½œã€‚</p><h3 id="1-æ•£åˆ—å‡½æ•°"><a href="#1-æ•£åˆ—å‡½æ•°" class="headerlink" title="1. æ•£åˆ—å‡½æ•°"></a>1. æ•£åˆ—å‡½æ•°</h3><p>å¯¹äºä¸€ä¸ªå¤§å°ä¸º M çš„æ•£åˆ—è¡¨ï¼Œæ•£åˆ—å‡½æ•°èƒ½å¤ŸæŠŠä»»æ„é”®è½¬æ¢ä¸º [0, M-1] å†…çš„æ­£æ•´æ•°ï¼Œè¯¥æ­£æ•´æ•°å³ä¸º hash å€¼ã€‚</p><p>æ•£åˆ—è¡¨å­˜åœ¨å†²çªï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªä¸åŒçš„é”®å¯èƒ½æœ‰ç›¸åŒçš„ hash å€¼ã€‚</p><p>æ•£åˆ—å‡½æ•°åº”è¯¥æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š</p><ul><li>ä¸€è‡´æ€§ï¼šç›¸ç­‰çš„é”®åº”å½“æœ‰ç›¸ç­‰çš„ hash å€¼ï¼Œä¸¤ä¸ªé”®ç›¸ç­‰è¡¨ç¤ºè°ƒç”¨ equals() è¿”å›çš„å€¼ç›¸ç­‰ã€‚</li><li>é«˜æ•ˆæ€§ï¼šè®¡ç®—åº”å½“ç®€ä¾¿ï¼Œæœ‰å¿…è¦çš„è¯å¯ä»¥æŠŠ hash å€¼ç¼“å­˜èµ·æ¥ï¼Œåœ¨è°ƒç”¨ hash å‡½æ•°æ—¶ç›´æ¥è¿”å›ã€‚</li><li>å‡åŒ€æ€§ï¼šæ‰€æœ‰é”®çš„ hash å€¼åº”å½“å‡åŒ€åœ°åˆ†å¸ƒåˆ° [0, M-1] ä¹‹é—´ï¼Œè¿™ä¸ªæ¡ä»¶è‡³å…³é‡è¦ï¼Œç›´æ¥å½±å“åˆ°æ•£åˆ—è¡¨çš„æ€§èƒ½ã€‚</li></ul><p>é™¤ç•™ä½™æ•°æ³•å¯ä»¥å°†æ•´æ•°æ•£åˆ—åˆ° [0, M-1] ä¹‹é—´ï¼Œä¾‹å¦‚ä¸€ä¸ªæ­£æ•´æ•° kï¼Œè®¡ç®— k%M æ—¢å¯å¾—åˆ°ä¸€ä¸ª [0, M-1] ä¹‹é—´çš„ hash å€¼ã€‚æ³¨æ„ M å¿…é¡»æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œå¦åˆ™æ— æ³•åˆ©ç”¨é”®åŒ…å«çš„æ‰€æœ‰ä¿¡æ¯ã€‚ä¾‹å¦‚ M ä¸º 10<sup>k</sup>ï¼Œé‚£ä¹ˆåªèƒ½åˆ©ç”¨é”®çš„å k ä½ã€‚</p><p>å¯¹äºå…¶å®ƒæ•°ï¼Œå¯ä»¥å°†å…¶è½¬æ¢æˆæ•´æ•°çš„å½¢å¼ï¼Œç„¶ååˆ©ç”¨é™¤ç•™ä½™æ•°æ³•ã€‚ä¾‹å¦‚å¯¹äºæµ®ç‚¹æ•°ï¼Œå¯ä»¥å°†å…¶è¡¨ç¤ºæˆäºŒè¿›åˆ¶å½¢å¼ï¼Œç„¶åä½¿ç”¨äºŒè¿›åˆ¶å½¢å¼çš„æ•´æ•°å€¼è¿›è¡Œé™¤ç•™ä½™æ•°æ³•ã€‚</p><p>å¯¹äºæœ‰å¤šéƒ¨åˆ†ç»„åˆçš„é”®ï¼Œæ¯éƒ¨åˆ†éƒ½éœ€è¦è®¡ç®— hash å€¼ï¼Œå¹¶ä¸”æœ€ååˆå¹¶æ—¶éœ€è¦è®©æ¯éƒ¨åˆ† hash å€¼éƒ½å…·æœ‰åŒç­‰é‡è¦çš„åœ°ä½ã€‚å¯ä»¥å°†è¯¥é”®çœ‹æˆ R è¿›åˆ¶çš„æ•´æ•°ï¼Œé”®ä¸­æ¯éƒ¨åˆ†éƒ½å…·æœ‰ä¸åŒçš„æƒå€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²çš„æ•£åˆ—å‡½æ•°å®ç°å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> hash = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); i++)</span><br><span class="line">    hash = (R * hash + s.charAt(i)) % M;</span><br></pre></td></tr></table></figure><p>å†æ¯”å¦‚ï¼Œæ‹¥æœ‰å¤šä¸ªæˆå‘˜çš„è‡ªå®šä¹‰ç±»çš„å“ˆå¸Œå‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> hash = (((day * R + month) % M) * R + year) % M;</span><br></pre></td></tr></table></figure><p>R é€šå¸¸å– 31ã€‚</p><p>Java ä¸­çš„ hashCode() å®ç°äº† hash å‡½æ•°ï¼Œä½†æ˜¯é»˜è®¤ä½¿ç”¨å¯¹è±¡çš„å†…å­˜åœ°å€å€¼ã€‚åœ¨ä½¿ç”¨ hashCode() å‡½æ•°æ—¶ï¼Œåº”å½“ç»“åˆé™¤ç•™ä½™æ•°æ³•æ¥ä½¿ç”¨ã€‚å› ä¸ºå†…å­˜åœ°å€æ˜¯ 32 ä½æ•´æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦ 31 ä½çš„éè´Ÿæ•´æ•°ï¼Œå› æ­¤åº”å½“å±è”½ç¬¦å·ä½ä¹‹åå†ä½¿ç”¨é™¤ç•™ä½™æ•°æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> hash = (x.hashCode() &amp; <span class="number">0x7fffffff</span>) % M;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Java è‡ªå¸¦çš„ HashMap ç­‰è‡ªå¸¦çš„å“ˆå¸Œè¡¨å®ç°æ—¶ï¼Œåªéœ€è¦å»å®ç° Key ç±»å‹çš„ hashCode() å‡½æ•°å³å¯ã€‚Java è§„å®š hashCode() èƒ½å¤Ÿå°†é”®å‡åŒ€åˆ†å¸ƒäºæ‰€æœ‰çš„ 32 ä½æ•´æ•°ï¼ŒJava ä¸­çš„ Stringã€Integer ç­‰å¯¹è±¡çš„ hashCode() éƒ½èƒ½å®ç°è¿™ä¸€ç‚¹ã€‚ä»¥ä¸‹å±•ç¤ºäº†è‡ªå®šä¹‰ç±»å‹å¦‚ä½•å®ç° hashCode()ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Transaction</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String who;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Date when;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> amount;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Transaction</span><span class="params">(String who, Date when, <span class="keyword">double</span> amount)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.who = who;</span><br><span class="line">        <span class="keyword">this</span>.when = when;</span><br><span class="line">        <span class="keyword">this</span>.amount = amount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> hash = <span class="number">17</span>;</span><br><span class="line">        <span class="keyword">int</span> R = <span class="number">31</span>;</span><br><span class="line">        hash = R * hash + who.hashCode();</span><br><span class="line">        hash = R * hash + when.hashCode();</span><br><span class="line">        hash = R * hash + ((Double) amount).hashCode();</span><br><span class="line">        <span class="keyword">return</span> hash;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-åŸºäºæ‹‰é“¾æ³•çš„æ•£åˆ—è¡¨"><a href="#2-åŸºäºæ‹‰é“¾æ³•çš„æ•£åˆ—è¡¨" class="headerlink" title="2. åŸºäºæ‹‰é“¾æ³•çš„æ•£åˆ—è¡¨"></a>2. åŸºäºæ‹‰é“¾æ³•çš„æ•£åˆ—è¡¨</h3><p>æ‹‰é“¾æ³•ä½¿ç”¨é“¾è¡¨æ¥å­˜å‚¨ hash å€¼ç›¸åŒçš„é”®ï¼Œä»è€Œè§£å†³å†²çªã€‚æ­¤æ—¶æŸ¥æ‰¾éœ€è¦åˆ†ä¸¤æ­¥ï¼Œé¦–å…ˆæŸ¥æ‰¾ Key æ‰€åœ¨çš„é“¾è¡¨ï¼Œç„¶ååœ¨é“¾è¡¨ä¸­é¡ºåºæŸ¥æ‰¾ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062217.png" width="300"> </div><br></p><p>å¯¹äº N ä¸ªé”®ï¼ŒM æ¡é“¾è¡¨ (N&gt;M)ï¼Œå¦‚æœå“ˆå¸Œå‡½æ•°èƒ½å¤Ÿæ»¡è¶³å‡åŒ€æ€§çš„æ¡ä»¶ï¼Œæ¯æ¡é“¾è¡¨çš„å¤§å°è¶‹å‘äº N/Mï¼Œå› æ­¤æœªå‘½ä¸­çš„æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œæ‰€éœ€è¦çš„æ¯”è¾ƒæ¬¡æ•°ä¸º ~N/Mã€‚</p><h3 id="3-åŸºäºçº¿æ€§æ¢æµ‹æ³•çš„æ•£åˆ—è¡¨"><a href="#3-åŸºäºçº¿æ€§æ¢æµ‹æ³•çš„æ•£åˆ—è¡¨" class="headerlink" title="3. åŸºäºçº¿æ€§æ¢æµ‹æ³•çš„æ•£åˆ—è¡¨"></a>3. åŸºäºçº¿æ€§æ¢æµ‹æ³•çš„æ•£åˆ—è¡¨</h3><p>çº¿æ€§æ¢æµ‹æ³•ä½¿ç”¨ç©ºä½æ¥è§£å†³å†²çªï¼Œå½“å†²çªå‘ç”Ÿæ—¶ï¼Œå‘å‰æ¢æµ‹ä¸€ä¸ªç©ºä½æ¥å­˜å‚¨å†²çªçš„é”®ã€‚ä½¿ç”¨çº¿æ€§æ¢æµ‹æ³•ï¼Œæ•°ç»„çš„å¤§å° M åº”å½“å¤§äºé”®çš„ä¸ªæ•° Nï¼ˆM&gt;N)ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062221.png" width="400"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinearProbingHashST</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt; <span class="keyword">implements</span> <span class="title">UnorderedST</span>&lt;<span class="title">Key</span>, <span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> M = <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">private</span> Key[] keys;</span><br><span class="line">    <span class="keyword">private</span> Value[] values;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LinearProbingHashST</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LinearProbingHashST</span><span class="params">(<span class="keyword">int</span> M)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.M = M;</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        keys = (Key[]) <span class="keyword">new</span> Object[M];</span><br><span class="line">        values = (Value[]) <span class="keyword">new</span> Object[M];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (key.hashCode() &amp; <span class="number">0x7fffffff</span>) % M;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆä¸€ï¼‰æŸ¥æ‰¾</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Value <span class="title">get</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = hash(key); keys[i] != <span class="keyword">null</span>; i = (i + <span class="number">1</span>) % M)</span><br><span class="line">        <span class="keyword">if</span> (keys[i].equals(key))</span><br><span class="line">            <span class="keyword">return</span> values[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆäºŒï¼‰æ’å…¥</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key, Value value)</span> </span>&#123;</span><br><span class="line">    resize();</span><br><span class="line">    putInternal(key, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">putInternal</span><span class="params">(Key key, Value value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = hash(key); keys[i] != <span class="keyword">null</span>; i = (i + <span class="number">1</span>) % M)</span><br><span class="line">        <span class="keyword">if</span> (keys[i].equals(key)) &#123;</span><br><span class="line">            values[i] = value;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    keys[i] = key;</span><br><span class="line">    values[i] = value;</span><br><span class="line">    N++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆä¸‰ï¼‰åˆ é™¤</strong> </p><p>åˆ é™¤æ“ä½œåº”å½“å°†å³ä¾§æ‰€æœ‰ç›¸é‚»çš„é”®å€¼å¯¹é‡æ–°æ’å…¥æ•£åˆ—è¡¨ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Key key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = hash(key);</span><br><span class="line">    <span class="keyword">while</span> (keys[i] != <span class="keyword">null</span> &amp;&amp; !key.equals(keys[i]))</span><br><span class="line">        i = (i + <span class="number">1</span>) % M;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span> (keys[i] == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    keys[i] = <span class="keyword">null</span>;</span><br><span class="line">    values[i] = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†ä¹‹åç›¸è¿çš„é”®å€¼å¯¹é‡æ–°æ’å…¥</span></span><br><span class="line">    i = (i + <span class="number">1</span>) % M;</span><br><span class="line">    <span class="keyword">while</span> (keys[i] != <span class="keyword">null</span>) &#123;</span><br><span class="line">        Key keyToRedo = keys[i];</span><br><span class="line">        Value valToRedo = values[i];</span><br><span class="line">        keys[i] = <span class="keyword">null</span>;</span><br><span class="line">        values[i] = <span class="keyword">null</span>;</span><br><span class="line">        N--;</span><br><span class="line">        putInternal(keyToRedo, valToRedo);</span><br><span class="line">        i = (i + <span class="number">1</span>) % M;</span><br><span class="line">    &#125;</span><br><span class="line">    N--;</span><br><span class="line">    resize();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆå››ï¼‰è°ƒæ•´æ•°ç»„å¤§å°</strong> </p><p>çº¿æ€§æ¢æµ‹æ³•çš„æˆæœ¬å–å†³äºè¿ç»­æ¡ç›®çš„é•¿åº¦ï¼Œè¿ç»­æ¡ç›®ä¹Ÿå«èšç°‡ã€‚å½“èšç°‡å¾ˆé•¿æ—¶ï¼Œåœ¨æŸ¥æ‰¾å’Œæ’å…¥æ—¶ä¹Ÿéœ€è¦è¿›è¡Œå¾ˆå¤šæ¬¡æ¢æµ‹ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ 2~5 ä½ç½®å°±æ˜¯ä¸€ä¸ªèšç°‡ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062226.png" width="400"> </div><br></p><p>Î± = N/Mï¼ŒæŠŠ Î± ç§°ä¸ºåˆ©ç”¨ç‡ã€‚ç†è®ºè¯æ˜ï¼Œå½“ Î± å°äº 1/2 æ—¶æ¢æµ‹çš„é¢„è®¡æ¬¡æ•°åªåœ¨ 1.5 åˆ° 2.5 ä¹‹é—´ã€‚</p><p>ä¸ºäº†ä¿è¯æ•£åˆ—è¡¨çš„æ€§èƒ½ï¼Œåº”å½“è°ƒæ•´æ•°ç»„çš„å¤§å°ï¼Œä½¿å¾— Î± åœ¨ [1/4, 1/2] ä¹‹é—´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (N &gt;= M / <span class="number">2</span>)</span><br><span class="line">        resize(<span class="number">2</span> * M);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (N &lt;= M / <span class="number">8</span>)</span><br><span class="line">        resize(M / <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">(<span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">    LinearProbingHashST&lt;Key, Value&gt; t = <span class="keyword">new</span> LinearProbingHashST&lt;Key, Value&gt;(cap);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i++)</span><br><span class="line">        <span class="keyword">if</span> (keys[i] != <span class="keyword">null</span>)</span><br><span class="line">            t.putInternal(keys[i], values[i]);</span><br><span class="line"></span><br><span class="line">    keys = t.keys;</span><br><span class="line">    values = t.values;</span><br><span class="line">    M = t.M;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><h3 id="1-ç¬¦å·è¡¨ç®—æ³•æ¯”è¾ƒ"><a href="#1-ç¬¦å·è¡¨ç®—æ³•æ¯”è¾ƒ" class="headerlink" title="1. ç¬¦å·è¡¨ç®—æ³•æ¯”è¾ƒ"></a>1. ç¬¦å·è¡¨ç®—æ³•æ¯”è¾ƒ</h3><table><thead><tr><th style="text-align:center">ç®—æ³•</th><th style="text-align:center">æ’å…¥</th><th style="text-align:center">æŸ¥æ‰¾</th><th style="text-align:center">æ˜¯å¦æœ‰åº</th></tr></thead><tbody><tr><td style="text-align:center">äºŒåˆ†æŸ¥æ‰¾å®ç°çš„æœ‰åºè¡¨</td><td style="text-align:center">N</td><td style="text-align:center">logN</td><td style="text-align:center">yes</td></tr><tr><td style="text-align:center">äºŒå‰æŸ¥æ‰¾æ ‘</td><td style="text-align:center">logN</td><td style="text-align:center">logN</td><td style="text-align:center">yes</td></tr><tr><td style="text-align:center">2-3 æŸ¥æ‰¾æ ‘</td><td style="text-align:center">logN</td><td style="text-align:center">logN</td><td style="text-align:center">yes</td></tr><tr><td style="text-align:center">é“¾è¡¨å®ç°çš„æœ‰åºè¡¨</td><td style="text-align:center">N</td><td style="text-align:center">N</td><td style="text-align:center">no</td></tr><tr><td style="text-align:center">æ‹‰é“¾æ³•å®ç°çš„æ•£åˆ—è¡¨</td><td style="text-align:center">N/M</td><td style="text-align:center">N/M</td><td style="text-align:center">no</td></tr><tr><td style="text-align:center">çº¿æ€§æ¢æµ‹æ³•å®ç°çš„æ•£åˆ—è¡¨</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">no</td></tr></tbody></table><p>åº”å½“ä¼˜å…ˆè€ƒè™‘æ•£åˆ—è¡¨ï¼Œå½“éœ€è¦æœ‰åºæ€§æ“ä½œæ—¶ä½¿ç”¨çº¢é»‘æ ‘ã€‚</p><h3 id="2-Java-çš„ç¬¦å·è¡¨å®ç°"><a href="#2-Java-çš„ç¬¦å·è¡¨å®ç°" class="headerlink" title="2. Java çš„ç¬¦å·è¡¨å®ç°"></a>2. Java çš„ç¬¦å·è¡¨å®ç°</h3><ul><li>java.util.TreeMapï¼šçº¢é»‘æ ‘</li><li>java.util.HashMapï¼šæ‹‰é“¾æ³•çš„æ•£åˆ—è¡¨</li></ul><h3 id="3-ç¨€ç–å‘é‡ä¹˜æ³•"><a href="#3-ç¨€ç–å‘é‡ä¹˜æ³•" class="headerlink" title="3. ç¨€ç–å‘é‡ä¹˜æ³•"></a>3. ç¨€ç–å‘é‡ä¹˜æ³•</h3><p>å½“å‘é‡ä¸ºç¨€ç–å‘é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç¬¦å·è¡¨æ¥å­˜å‚¨å‘é‡ä¸­çš„é 0 ç´¢å¼•å’Œå€¼ï¼Œä½¿å¾—ä¹˜æ³•è¿ç®—åªéœ€è¦å¯¹é‚£äº›é 0 å…ƒç´ è¿›è¡Œå³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SparseVector</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;Integer, Double&gt; hashMap;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SparseVector</span><span class="params">(<span class="keyword">double</span>[] vector)</span> </span>&#123;</span><br><span class="line">        hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vector.length; i++)</span><br><span class="line">            <span class="keyword">if</span> (vector[i] != <span class="number">0</span>)</span><br><span class="line">                hashMap.put(i, vector[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hashMap.getOrDefault(i, <span class="number">0.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">dot</span><span class="params">(SparseVector other)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i : hashMap.keySet())</span><br><span class="line">            sum += <span class="keyword">this</span>.get(i) * other.get(i);</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸ƒã€å…¶å®ƒ"><a href="#ä¸ƒã€å…¶å®ƒ" class="headerlink" title="ä¸ƒã€å…¶å®ƒ"></a>ä¸ƒã€å…¶å®ƒ</h1><h2 id="æ±‰è¯ºå¡”"><a href="#æ±‰è¯ºå¡”" class="headerlink" title="æ±‰è¯ºå¡”"></a>æ±‰è¯ºå¡”</h2><p>è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„é€’å½’é—®é¢˜ï¼Œåˆ†ä¸ºä¸‰æ­¥æ±‚è§£ï¼š</p><ol><li>å°† n-1 ä¸ªåœ†ç›˜ä» from -&gt; buffer</li><li>å°† 1 ä¸ªåœ†ç›˜ä» from -&gt; to</li><li>å°† n-1 ä¸ªåœ†ç›˜ä» buffer -&gt; to</li></ol><p>å¦‚æœåªæœ‰ä¸€ä¸ªåœ†ç›˜ï¼Œé‚£ä¹ˆåªéœ€è¦è¿›è¡Œä¸€æ¬¡ç§»åŠ¨æ“ä½œï¼Œä»ä¸Šé¢çš„ç§»åŠ¨æ­¥éª¤å¯ä»¥çŸ¥é“ï¼Œn åœ†ç›˜éœ€è¦ç§»åŠ¨ (n-1)+1+(n-1) = 2n-1 æ¬¡ã€‚ </p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062233.png" width="300"> </div><br></p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062237.png" width="300"> </div><br></p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062241.png" width="300"> </div><br></p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062244.png" width="300"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hanoi</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> n, String from, String buffer, String to)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"from "</span> + from + <span class="string">" to "</span> + to);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        move(n - <span class="number">1</span>, from, to, buffer);</span><br><span class="line">        move(<span class="number">1</span>, from, buffer, to);</span><br><span class="line">        move(n - <span class="number">1</span>, buffer, from, to);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Hanoi.move(<span class="number">3</span>, <span class="string">"H1"</span>, <span class="string">"H2"</span>, <span class="string">"H3"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from H1 to H3</span><br><span class="line">from H1 to H2</span><br><span class="line">from H3 to H2</span><br><span class="line">from H1 to H3</span><br><span class="line">from H2 to H1</span><br><span class="line">from H2 to H3</span><br><span class="line">from H1 to H3</span><br></pre></td></tr></table></figure><h2 id="å“ˆå¤«æ›¼ç¼–ç "><a href="#å“ˆå¤«æ›¼ç¼–ç " class="headerlink" title="å“ˆå¤«æ›¼ç¼–ç "></a>å“ˆå¤«æ›¼ç¼–ç </h2><p>å“ˆå¤«æ›¼ç¼–ç æ ¹æ®æ•°æ®å‡ºç°çš„é¢‘ç‡å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œä»è€Œå‹ç¼©åŸå§‹æ•°æ®ã€‚</p><p>ä¾‹å¦‚å¯¹äºæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­å„ç§å­—ç¬¦å‡ºç°çš„æ¬¡æ•°å¦‚ä¸‹ï¼š</p><ul><li>a : 10</li><li>b : 20</li><li>c : 40</li><li>d : 80</li></ul><p>å¯ä»¥å°†æ¯ç§å­—ç¬¦è½¬æ¢æˆäºŒè¿›åˆ¶ç¼–ç ï¼Œä¾‹å¦‚å°† a è½¬æ¢ä¸º 00ï¼Œb è½¬æ¢ä¸º 01ï¼Œc è½¬æ¢ä¸º 10ï¼Œd è½¬æ¢ä¸º 11ã€‚è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œæ²¡æœ‰è€ƒè™‘å„ä¸ªå­—ç¬¦çš„æƒå€¼ï¼ˆå‡ºç°é¢‘ç‡ï¼‰ã€‚è€Œå“ˆå¤«æ›¼ç¼–ç èƒ½è®©å‡ºç°é¢‘ç‡æœ€å¤§çš„å­—ç¬¦ç¼–ç æœ€çŸ­ï¼Œä»è€Œä¿è¯æœ€ç»ˆçš„ç¼–ç é•¿åº¦æœ€çŸ­ã€‚</p><p>é¦–å…ˆç”Ÿæˆä¸€é¢—å“ˆå¤«æ›¼æ ‘ï¼Œæ¯æ¬¡ç”Ÿæˆè¿‡ç¨‹ä¸­é€‰å–é¢‘ç‡æœ€å°‘çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œç”Ÿæˆä¸€ä¸ªæ–°èŠ‚ç‚¹ä½œä¸ºå®ƒä»¬çš„çˆ¶èŠ‚ç‚¹ï¼Œå¹¶ä¸”æ–°èŠ‚ç‚¹çš„é¢‘ç‡ä¸ºä¸¤ä¸ªèŠ‚ç‚¹çš„å’Œã€‚é€‰å–é¢‘ç‡æœ€å°‘çš„åŸå› æ˜¯ï¼Œç”Ÿæˆè¿‡ç¨‹ä½¿å¾—å…ˆé€‰å–çš„èŠ‚ç‚¹åœ¨æ ‘çš„æœ€åº•å±‚ï¼Œé‚£ä¹ˆéœ€è¦çš„ç¼–ç é•¿åº¦æ›´é•¿ï¼Œé¢‘ç‡æ›´å°‘å¯ä»¥ä½¿å¾—æ€»ç¼–ç é•¿åº¦æ›´å°‘ã€‚</p><p>ç”Ÿæˆç¼–ç æ—¶ï¼Œä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œå‘å·¦éå†åˆ™æ·»åŠ äºŒè¿›åˆ¶ä½ 0ï¼Œå‘å³åˆ™æ·»åŠ äºŒè¿›åˆ¶ä½ 1ï¼Œç›´åˆ°éå†åˆ°æ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹ä»£è¡¨çš„å­—ç¬¦çš„ç¼–ç å°±æ˜¯è¿™ä¸ªè·¯å¾„ç¼–ç ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062250.png"> </div><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Huffman</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;</span><br><span class="line">        <span class="keyword">int</span> freq;</span><br><span class="line">        <span class="keyword">boolean</span> isLeaf;</span><br><span class="line">        Node left, right;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">char</span> ch, <span class="keyword">int</span> freq)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.ch = ch;</span><br><span class="line">            <span class="keyword">this</span>.freq = freq;</span><br><span class="line">            isLeaf = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(Node left, Node right, <span class="keyword">int</span> freq)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.left = left;</span><br><span class="line">            <span class="keyword">this</span>.right = right;</span><br><span class="line">            <span class="keyword">this</span>.freq = freq;</span><br><span class="line">            isLeaf = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.freq - o.freq;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;Character, String&gt; <span class="title">encode</span><span class="params">(Map&lt;Character, Integer&gt; frequencyForChar)</span> </span>&#123;</span><br><span class="line">        PriorityQueue&lt;Node&gt; priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Character c : frequencyForChar.keySet()) &#123;</span><br><span class="line">            priorityQueue.add(<span class="keyword">new</span> Node(c, frequencyForChar.get(c)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (priorityQueue.size() != <span class="number">1</span>) &#123;</span><br><span class="line">            Node node1 = priorityQueue.poll();</span><br><span class="line">            Node node2 = priorityQueue.poll();</span><br><span class="line">            priorityQueue.add(<span class="keyword">new</span> Node(node1, node2, node1.freq + node2.freq));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> encode(priorityQueue.poll());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Map&lt;Character, String&gt; <span class="title">encode</span><span class="params">(Node root)</span> </span>&#123;</span><br><span class="line">        Map&lt;Character, String&gt; encodingForChar = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        encode(root, <span class="string">""</span>, encodingForChar);</span><br><span class="line">        <span class="keyword">return</span> encodingForChar;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">encode</span><span class="params">(Node node, String encoding, Map&lt;Character, String&gt; encodingForChar)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (node.isLeaf) &#123;</span><br><span class="line">            encodingForChar.put(node.ch, encoding);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        encode(node.left, encoding + <span class="string">'0'</span>, encodingForChar);</span><br><span class="line">        encode(node.right, encoding + <span class="string">'1'</span>, encodingForChar);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>Sedgewick, Robert, and Kevin Wayne. <em>Algorithms</em>. Addison-Wesley Professional, 2011.</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- GFM-TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸€å‰è¨€&quot;&gt;ä¸€ã€å‰è¨€&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#äºŒç®—æ³•åˆ†æ&quot;&gt;äºŒã€ç®—æ³•åˆ†æ&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#æ•°å­¦æ¨¡å‹&quot;&gt;æ•°å­¦æ¨¡å‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#t
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Interview-Notebook" scheme="https://airpoet.github.io/categories/Github/Interview-Notebook/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼</title>
    <link href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <id>https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/æ­£åˆ™è¡¨è¾¾å¼/</id>
    <published>2018-07-04T13:51:06.359Z</published>
    <updated>2018-07-09T07:07:35.445Z</updated>
    
    <content type="html"><![CDATA[<!-- GFM-TOC --><ul><li><a href="#ä¸€æ¦‚è¿°">ä¸€ã€æ¦‚è¿°</a></li><li><a href="#äºŒåŒ¹é…å•ä¸ªå­—ç¬¦">äºŒã€åŒ¹é…å•ä¸ªå­—ç¬¦</a></li><li><a href="#ä¸‰åŒ¹é…ä¸€ç»„å­—ç¬¦">ä¸‰ã€åŒ¹é…ä¸€ç»„å­—ç¬¦</a></li><li><a href="#å››ä½¿ç”¨å…ƒå­—ç¬¦">å››ã€ä½¿ç”¨å…ƒå­—ç¬¦</a></li><li><a href="#äº”é‡å¤åŒ¹é…">äº”ã€é‡å¤åŒ¹é…</a></li><li><a href="#å…­ä½ç½®åŒ¹é…">å…­ã€ä½ç½®åŒ¹é…</a></li><li><a href="#ä¸ƒä½¿ç”¨å­è¡¨è¾¾å¼">ä¸ƒã€ä½¿ç”¨å­è¡¨è¾¾å¼</a></li><li><a href="#å…«å›æº¯å¼•ç”¨">å…«ã€å›æº¯å¼•ç”¨</a></li><li><a href="#ä¹å‰åæŸ¥æ‰¾">ä¹ã€å‰åæŸ¥æ‰¾</a></li><li><a href="#ååµŒå…¥æ¡ä»¶">åã€åµŒå…¥æ¡ä»¶</a></li><li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a><!-- GFM-TOC --></li></ul><h1 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h1><p>æ­£åˆ™è¡¨è¾¾å¼ç”¨äºæ–‡æœ¬å†…å®¹çš„æŸ¥æ‰¾å’Œæ›¿æ¢ã€‚</p><p>æ­£åˆ™è¡¨è¾¾å¼å†…ç½®äºå…¶å®ƒè¯­è¨€æˆ–è€…è½¯ä»¶äº§å“ä¸­ï¼Œå®ƒæœ¬èº«ä¸æ˜¯ä¸€ç§è¯­è¨€æˆ–è€…è½¯ä»¶ã€‚</p><p><a href="https://regexr.com/" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼åœ¨çº¿å·¥å…·</a></p><h1 id="äºŒã€åŒ¹é…å•ä¸ªå­—ç¬¦"><a href="#äºŒã€åŒ¹é…å•ä¸ªå­—ç¬¦" class="headerlink" title="äºŒã€åŒ¹é…å•ä¸ªå­—ç¬¦"></a>äºŒã€åŒ¹é…å•ä¸ªå­—ç¬¦</h1><p>æ­£åˆ™è¡¨è¾¾å¼ä¸€èˆ¬æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œä½†æ˜¯ä¹Ÿæœ‰äº›å®ç°æ˜¯ä¸åŒºåˆ†ã€‚</p><p><strong>.</strong>  å¯ä»¥ç”¨æ¥åŒ¹é…ä»»ä½•çš„å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯åœ¨ç»å¤§å¤šæ•°å®ç°é‡Œé¢ï¼Œä¸èƒ½åŒ¹é…æ¢è¡Œç¬¦ï¼›</p><p><strong>\</strong>  æ˜¯å…ƒå­—ç¬¦ï¼Œè¡¨ç¤ºå®ƒæœ‰ç‰¹æ®Šçš„å«ä¹‰ï¼Œè€Œä¸æ˜¯å­—ç¬¦æœ¬èº«çš„å«ä¹‰ã€‚å¦‚æœéœ€è¦åŒ¹é… . ï¼Œé‚£ä¹ˆè¦ç”¨ \ è¿›è¡Œè½¬ä¹‰ï¼Œå³åœ¨ . å‰é¢åŠ ä¸Š \ ã€‚</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nam.</span><br></pre></td></tr></table></figure><p><strong>åŒ¹é…ç»“æœ</strong> </p><p>My  <strong>name</strong>  is Zheng.</p><h1 id="ä¸‰ã€åŒ¹é…ä¸€ç»„å­—ç¬¦"><a href="#ä¸‰ã€åŒ¹é…ä¸€ç»„å­—ç¬¦" class="headerlink" title="ä¸‰ã€åŒ¹é…ä¸€ç»„å­—ç¬¦"></a>ä¸‰ã€åŒ¹é…ä¸€ç»„å­—ç¬¦</h1><p><strong>[ ]</strong>  å®šä¹‰ä¸€ä¸ªå­—ç¬¦é›†åˆï¼›</p><p>0-9ã€a-z å®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦åŒºé—´ï¼ŒåŒºé—´ä½¿ç”¨ ASCII ç æ¥ç¡®å®šï¼Œå­—ç¬¦åŒºé—´åªèƒ½ç”¨åœ¨ [ ] ä¹‹é—´ã€‚</p><p><strong>-</strong>  å…ƒå­—ç¬¦åªæœ‰åœ¨ [ ] ä¹‹é—´æ‰æ˜¯å…ƒå­—ç¬¦ï¼Œåœ¨ [ ] ä¹‹å¤–å°±æ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦ï¼›</p><p><strong>^</strong>  åœ¨ [ ] å­—ç¬¦é›†åˆä¸­æ˜¯å–éæ“ä½œã€‚</p><p><strong>åº”ç”¨</strong> </p><p>åŒ¹é…ä»¥ abc ä¸ºå¼€å¤´ï¼Œå¹¶ä¸”æœ€åä¸€ä¸ªå­—æ¯ä¸ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²ï¼š</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abc[^0-9]</span><br></pre></td></tr></table></figure><p><strong>åŒ¹é…ç»“æœ</strong> </p><ol><li><strong>abcd</strong> </li><li>abc1</li><li>abc2</li></ol><h1 id="å››ã€ä½¿ç”¨å…ƒå­—ç¬¦"><a href="#å››ã€ä½¿ç”¨å…ƒå­—ç¬¦" class="headerlink" title="å››ã€ä½¿ç”¨å…ƒå­—ç¬¦"></a>å››ã€ä½¿ç”¨å…ƒå­—ç¬¦</h1><h2 id="åŒ¹é…ç©ºç™½å­—ç¬¦"><a href="#åŒ¹é…ç©ºç™½å­—ç¬¦" class="headerlink" title="åŒ¹é…ç©ºç™½å­—ç¬¦"></a>åŒ¹é…ç©ºç™½å­—ç¬¦</h2><table><thead><tr><th style="text-align:center">å…ƒå­—ç¬¦</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">[\b]</td><td style="text-align:center">å›é€€ï¼ˆåˆ é™¤ï¼‰ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td style="text-align:center">\f</td><td style="text-align:center">æ¢é¡µç¬¦</td></tr><tr><td style="text-align:center">\n</td><td style="text-align:center">æ¢è¡Œç¬¦</td></tr><tr><td style="text-align:center">\r</td><td style="text-align:center">å›è½¦ç¬¦</td></tr><tr><td style="text-align:center">\t</td><td style="text-align:center">åˆ¶è¡¨ç¬¦</td></tr><tr><td style="text-align:center">\v</td><td style="text-align:center">å‚ç›´åˆ¶è¡¨ç¬¦</td></tr></tbody></table><p>\r\n æ˜¯ Windows ä¸­çš„æ–‡æœ¬è¡Œç»“æŸæ ‡ç­¾ï¼Œåœ¨ Unix/Linux åˆ™æ˜¯ \n ï¼›\r\n\r\n å¯ä»¥åŒ¹é… Windows ä¸‹çš„ç©ºç™½è¡Œï¼Œå› ä¸ºå®ƒå°†åŒ¹é…ä¸¤ä¸ªè¿ç»­çš„è¡Œå°¾æ ‡ç­¾ï¼Œè€Œè¿™æ­£æ˜¯ä¸¤æ¡è®°å½•ä¹‹é—´çš„ç©ºç™½è¡Œï¼›</p><p>. æ˜¯å…ƒå­—ç¬¦ï¼Œå‰ææ˜¯æ²¡æœ‰å¯¹å®ƒä»¬è¿›è¡Œè½¬ä¹‰ï¼›f å’Œ n ä¹Ÿæ˜¯å…ƒå­—ç¬¦ï¼Œä½†æ˜¯å‰ææ˜¯å¯¹å®ƒä»¬è¿›è¡Œäº†è½¬ä¹‰ã€‚</p><h2 id="åŒ¹é…ç‰¹å®šçš„å­—ç¬¦ç±»åˆ«"><a href="#åŒ¹é…ç‰¹å®šçš„å­—ç¬¦ç±»åˆ«" class="headerlink" title="åŒ¹é…ç‰¹å®šçš„å­—ç¬¦ç±»åˆ«"></a>åŒ¹é…ç‰¹å®šçš„å­—ç¬¦ç±»åˆ«</h2><h3 id="1-æ•°å­—å…ƒå­—ç¬¦"><a href="#1-æ•°å­—å…ƒå­—ç¬¦" class="headerlink" title="1. æ•°å­—å…ƒå­—ç¬¦"></a>1. æ•°å­—å…ƒå­—ç¬¦</h3><table><thead><tr><th style="text-align:center">å…ƒå­—ç¬¦</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">\d</td><td style="text-align:center">æ•°å­—å­—ç¬¦ï¼Œç­‰ä»·äº [0-9]</td></tr><tr><td style="text-align:center">\D</td><td style="text-align:center">éæ•°å­—å­—ç¬¦ï¼Œç­‰ä»·äº [^0-9]</td></tr></tbody></table><h3 id="2-å­—æ¯æ•°å­—å…ƒå­—ç¬¦"><a href="#2-å­—æ¯æ•°å­—å…ƒå­—ç¬¦" class="headerlink" title="2. å­—æ¯æ•°å­—å…ƒå­—ç¬¦"></a>2. å­—æ¯æ•°å­—å…ƒå­—ç¬¦</h3><table><thead><tr><th style="text-align:center">å…ƒå­—ç¬¦</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">\w</td><td style="text-align:center">å¤§å°å†™å­—æ¯ï¼Œä¸‹åˆ’çº¿å’Œæ•°å­—ï¼Œç­‰ä»·äº [a-zA-Z0-9_]</td></tr><tr><td style="text-align:center">\W</td><td style="text-align:center">å¯¹ \w å–é</td></tr></tbody></table><h3 id="3-ç©ºç™½å­—ç¬¦å…ƒå­—ç¬¦"><a href="#3-ç©ºç™½å­—ç¬¦å…ƒå­—ç¬¦" class="headerlink" title="3. ç©ºç™½å­—ç¬¦å…ƒå­—ç¬¦"></a>3. ç©ºç™½å­—ç¬¦å…ƒå­—ç¬¦</h3><table><thead><tr><th style="text-align:center">å…ƒå­—ç¬¦</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">\s</td><td style="text-align:center">ä»»ä½•ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼Œç­‰ä»·äº [\f\n\r\t\v]</td></tr><tr><td style="text-align:center">\S</td><td style="text-align:center">å¯¹ \s å–é</td></tr></tbody></table><p>\x åŒ¹é…åå…­è¿›åˆ¶å­—ç¬¦ï¼Œ\0 åŒ¹é…å…«è¿›åˆ¶ï¼Œä¾‹å¦‚ \x0A å¯¹åº” ASCII å­—ç¬¦ 10 ï¼Œç­‰ä»·äº \nï¼Œä¹Ÿå°±æ˜¯å®ƒä¼šåŒ¹é… \n ã€‚</p><h1 id="äº”ã€é‡å¤åŒ¹é…"><a href="#äº”ã€é‡å¤åŒ¹é…" class="headerlink" title="äº”ã€é‡å¤åŒ¹é…"></a>äº”ã€é‡å¤åŒ¹é…</h1><p><strong>+</strong>  åŒ¹é… 1 ä¸ªæˆ–è€…å¤šä¸ªå­—ç¬¦ï¼Œ <strong>*</strong> åŒ¹é… 0 ä¸ªæˆ–è€…å¤šä¸ªï¼Œ<strong>?</strong> åŒ¹é… 0 ä¸ªæˆ–è€… 1 ä¸ªã€‚</p><p><strong>åº”ç”¨</strong> </p><p>åŒ¹é…é‚®ç®±åœ°å€ã€‚</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[\w.]+@\w+\.\w+</span><br></pre></td></tr></table></figure><p>[\w.] åŒ¹é…çš„æ˜¯å­—æ¯æ•°å­—æˆ–è€… . ï¼Œåœ¨å…¶åé¢åŠ ä¸Š + ï¼Œè¡¨ç¤ºåŒ¹é…å¤šæ¬¡ã€‚åœ¨å­—ç¬¦é›†åˆ [ ] é‡Œï¼Œ. ä¸æ˜¯å…ƒå­—ç¬¦ï¼›</p><p><strong>åŒ¹é…ç»“æœ</strong> </p><p><strong>abc.def<span>@</span>qq.com</strong> </p><p>ä¸ºäº†å¯è¯»æ€§ï¼Œå¸¸å¸¸æŠŠè½¬ä¹‰çš„å­—ç¬¦æ”¾åˆ°å­—ç¬¦é›†åˆ [ ] ä¸­ï¼Œä½†æ˜¯å«ä¹‰æ˜¯ç›¸åŒçš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[\w.]+@\w+\.\w+</span><br><span class="line">[\w.]+@[\w]+[\.][\w]+</span><br></pre></td></tr></table></figure><p><strong>{n}</strong>  åŒ¹é… n ä¸ªå­—ç¬¦ï¼Œ<strong>{m, n}</strong> åŒ¹é… m~n ä¸ªå­—ç¬¦ï¼Œ<strong>{m,}</strong> è‡³å°‘åŒ¹é… m ä¸ªå­—ç¬¦ï¼›</p><p>* å’Œ + éƒ½æ˜¯è´ªå©ªå‹å…ƒå­—ç¬¦ï¼Œä¼šåŒ¹é…æœ€å¤šçš„å†…å®¹ï¼Œåœ¨å…ƒå­—ç¬¦åé¢åŠ  ? å¯ä»¥è½¬æ¢ä¸ºæ‡’æƒ°å‹å…ƒå­—ç¬¦ï¼Œä¾‹å¦‚ *?ã€+? å’Œ {m, n}? ã€‚</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a.+c</span><br></pre></td></tr></table></figure><p>ç”±äº + æ˜¯è´ªå©ªå‹çš„ï¼Œå› æ­¤ .+ ä¼šåŒ¹é…æ›´å¯èƒ½å¤šçš„å†…å®¹ï¼Œæ‰€ä»¥ä¼šæŠŠæ•´ä¸ª abcabcabc æ–‡æœ¬éƒ½åŒ¹é…ï¼Œè€Œä¸æ˜¯åªåŒ¹é…å‰é¢çš„ abc æ–‡æœ¬ã€‚ç”¨æ‡’æƒ°å‹å¯ä»¥å®ç°åŒ¹é…å‰é¢çš„ã€‚</p><p><strong>åŒ¹é…ç»“æœ</strong> </p><p><strong>abcabcabc</strong> </p><h1 id="å…­ã€ä½ç½®åŒ¹é…"><a href="#å…­ã€ä½ç½®åŒ¹é…" class="headerlink" title="å…­ã€ä½ç½®åŒ¹é…"></a>å…­ã€ä½ç½®åŒ¹é…</h1><h2 id="å•è¯è¾¹ç•Œ"><a href="#å•è¯è¾¹ç•Œ" class="headerlink" title="å•è¯è¾¹ç•Œ"></a>å•è¯è¾¹ç•Œ</h2><p><strong>\b</strong>  å¯ä»¥åŒ¹é…ä¸€ä¸ªå•è¯çš„è¾¹ç•Œï¼Œè¾¹ç•Œæ˜¯æŒ‡ä½äº \w å’Œ \W ä¹‹é—´çš„ä½ç½®ï¼›<strong>\B</strong> åŒ¹é…ä¸€ä¸ªä¸æ˜¯å•è¯è¾¹ç•Œçš„ä½ç½®ã€‚</p><p>\b åªåŒ¹é…ä½ç½®ï¼Œä¸åŒ¹é…å­—ç¬¦ï¼Œå› æ­¤ \babc\b åŒ¹é…å‡ºæ¥çš„ç»“æœä¸º 3 ä¸ªå­—ç¬¦ã€‚</p><h2 id="å­—ç¬¦ä¸²è¾¹ç•Œ"><a href="#å­—ç¬¦ä¸²è¾¹ç•Œ" class="headerlink" title="å­—ç¬¦ä¸²è¾¹ç•Œ"></a>å­—ç¬¦ä¸²è¾¹ç•Œ</h2><p><strong>^</strong>  åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´ï¼Œ<strong>$</strong> åŒ¹é…ç»“å°¾ã€‚</p><p>^ å…ƒå­—ç¬¦åœ¨å­—ç¬¦é›†åˆä¸­ç”¨ä½œæ±‚éï¼Œåœ¨å­—ç¬¦é›†åˆå¤–ç”¨ä½œåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´ã€‚</p><p>åˆ†è¡ŒåŒ¹é…æ¨¡å¼ï¼ˆmultilineï¼‰ä¸‹ï¼Œæ¢è¡Œè¢«å½“åšå­—ç¬¦ä¸²çš„è¾¹ç•Œã€‚</p><p><strong>åº”ç”¨</strong> </p><p>åŒ¹é…ä»£ç ä¸­ä»¥ // å¼€å§‹çš„æ³¨é‡Šè¡Œ</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^\s*\/\/.*$</span><br></pre></td></tr></table></figure><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-062447.png"> </div><br></p><p><strong>åŒ¹é…ç»“æœ</strong> </p><ol><li>public void fun() {</li><li>&nbsp;&nbsp;&nbsp;&nbsp;     <strong>// æ³¨é‡Š 1</strong> </li><li>&nbsp;&nbsp;&nbsp;&nbsp;    int a = 1;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;    int b = 2;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;     <strong>// æ³¨é‡Š 2</strong> </li><li>&nbsp;&nbsp;&nbsp;&nbsp;    int c = a + b;</li><li>}</li></ol><h1 id="ä¸ƒã€ä½¿ç”¨å­è¡¨è¾¾å¼"><a href="#ä¸ƒã€ä½¿ç”¨å­è¡¨è¾¾å¼" class="headerlink" title="ä¸ƒã€ä½¿ç”¨å­è¡¨è¾¾å¼"></a>ä¸ƒã€ä½¿ç”¨å­è¡¨è¾¾å¼</h1><p>ä½¿ç”¨  <strong>( )</strong>  å®šä¹‰ä¸€ä¸ªå­è¡¨è¾¾å¼ã€‚å­è¡¨è¾¾å¼çš„å†…å®¹å¯ä»¥å½“æˆä¸€ä¸ªç‹¬ç«‹å…ƒç´ ï¼Œå³å¯ä»¥å°†å®ƒçœ‹æˆä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”ä½¿ç”¨ * ç­‰å…ƒå­—ç¬¦ã€‚</p><p>å­è¡¨è¾¾å¼å¯ä»¥åµŒå¥—ï¼Œä½†æ˜¯åµŒå¥—å±‚æ¬¡è¿‡æ·±ä¼šå˜å¾—å¾ˆéš¾ç†è§£ã€‚</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ab)&#123;2,&#125;</span><br></pre></td></tr></table></figure><p><strong>åŒ¹é…ç»“æœ</strong> </p><p><strong>ababab</strong> </p><p><strong>|</strong>  æ˜¯æˆ–å…ƒå­—ç¬¦ï¼Œå®ƒæŠŠå·¦è¾¹å’Œå³è¾¹æ‰€æœ‰çš„éƒ¨åˆ†éƒ½çœ‹æˆå•ç‹¬çš„ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸¤ä¸ªéƒ¨åˆ†åªè¦æœ‰ä¸€ä¸ªåŒ¹é…å°±è¡Œã€‚</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(19|20)\d&#123;2&#125;</span><br></pre></td></tr></table></figure><p><strong>åŒ¹é…ç»“æœ</strong> </p><ol><li><strong>1900</strong> </li><li><strong>2010</strong> </li><li>1020</li></ol><p><strong>åº”ç”¨</strong> </p><p>åŒ¹é… IP åœ°å€ã€‚IP åœ°å€ä¸­æ¯éƒ¨åˆ†éƒ½æ˜¯ 0-255 çš„æ•°å­—ï¼Œç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ—¶ä»¥ä¸‹æƒ…å†µæ˜¯åˆæ³•çš„ï¼š</p><ul><li>ä¸€ä½æ•°å­—</li><li>ä¸ä»¥ 0 å¼€å¤´çš„ä¸¤ä½æ•°å­—</li><li>1 å¼€å¤´çš„ä¸‰ä½æ•°</li><li>2 å¼€å¤´ï¼Œç¬¬ 2 ä½æ˜¯ 0-4 çš„ä¸‰ä½æ•°</li><li>25 å¼€å¤´ï¼Œç¬¬ 3 ä½æ˜¯ 0-5 çš„ä¸‰ä½æ•°</li></ul><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((25[0-5]|(2[0-4]\d)|(1\d&#123;2&#125;)|([1-9]\d)|(\d))\.)&#123;3&#125;(25[0-5]|(2[0-4]\d)|(1\d&#123;2&#125;)|([1-9]\d)|(\d))</span><br></pre></td></tr></table></figure><p><strong>åŒ¹é…ç»“æœ</strong> </p><ol><li><strong>192.168.0.1</strong> </li><li>00.00.00.00</li><li>555.555.555.555</li></ol><h1 id="å…«ã€å›æº¯å¼•ç”¨"><a href="#å…«ã€å›æº¯å¼•ç”¨" class="headerlink" title="å…«ã€å›æº¯å¼•ç”¨"></a>å…«ã€å›æº¯å¼•ç”¨</h1><p>å›æº¯å¼•ç”¨ä½¿ç”¨  <strong>\n</strong>  æ¥å¼•ç”¨æŸä¸ªå­è¡¨è¾¾å¼ï¼Œå…¶ä¸­ n ä»£è¡¨çš„æ˜¯å­è¡¨è¾¾å¼çš„åºå·ï¼Œä» 1 å¼€å§‹ã€‚å®ƒå’Œå­è¡¨è¾¾å¼åŒ¹é…çš„å†…å®¹ä¸€è‡´ï¼Œæ¯”å¦‚å­è¡¨è¾¾å¼åŒ¹é…åˆ° abcï¼Œé‚£ä¹ˆå›æº¯å¼•ç”¨éƒ¨åˆ†ä¹Ÿéœ€è¦åŒ¹é… abc ã€‚</p><p><strong>åº”ç”¨</strong> </p><p>åŒ¹é… HTML ä¸­åˆæ³•çš„æ ‡é¢˜å…ƒç´ ã€‚</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><p>\1 å°†å›æº¯å¼•ç”¨å­è¡¨è¾¾å¼ (h[1-6]) åŒ¹é…çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»å’Œå­è¡¨è¾¾å¼åŒ¹é…çš„å†…å®¹ä¸€è‡´ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;(h[1-6])&gt;\w*?&lt;\/\1&gt;</span><br></pre></td></tr></table></figure><p><strong>åŒ¹é…ç»“æœ</strong> </p><ol><li><strong>&lt;h1&gt;x&lt;/h1&gt;</strong> </li><li><strong>&lt;h2&gt;x&lt;/h2&gt;</strong> </li><li>&lt;h3&gt;x&lt;/h1&gt;</li></ol><h2 id="æ›¿æ¢"><a href="#æ›¿æ¢" class="headerlink" title="æ›¿æ¢"></a>æ›¿æ¢</h2><p>éœ€è¦ç”¨åˆ°ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚</p><p><strong>åº”ç”¨</strong> </p><p>ä¿®æ”¹ç”µè¯å·ç æ ¼å¼ã€‚</p><p><strong>æ–‡æœ¬</strong> </p><p>313-555-1234</p><p><strong>æŸ¥æ‰¾æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(\d&#123;3&#125;)(-)(\d&#123;3&#125;)(-)(\d&#123;4&#125;)</span><br></pre></td></tr></table></figure><p><strong>æ›¿æ¢æ­£åˆ™è¡¨è¾¾å¼</strong> </p><p>åœ¨ç¬¬ä¸€ä¸ªå­è¡¨è¾¾å¼æŸ¥æ‰¾çš„ç»“æœåŠ ä¸Š () ï¼Œç„¶ååŠ ä¸€ä¸ªç©ºæ ¼ï¼Œåœ¨ç¬¬ä¸‰ä¸ªå’Œç¬¬äº”ä¸ªå­—è¡¨è¾¾å¼æŸ¥æ‰¾çš„ç»“æœä¸­é—´åŠ ä¸Š - è¿›è¡Œåˆ†éš”ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">($1) $3-$5</span><br></pre></td></tr></table></figure><p><strong>ç»“æœ</strong> </p><p>(313) 555-1234</p><h2 id="å¤§å°å†™è½¬æ¢"><a href="#å¤§å°å†™è½¬æ¢" class="headerlink" title="å¤§å°å†™è½¬æ¢"></a>å¤§å°å†™è½¬æ¢</h2><table><thead><tr><th style="text-align:center">å…ƒå­—ç¬¦</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">\l</td><td style="text-align:center">æŠŠä¸‹ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå°å†™</td></tr><tr><td style="text-align:center">\u</td><td style="text-align:center">æŠŠä¸‹ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå¤§å†™</td></tr><tr><td style="text-align:center">\L</td><td style="text-align:center">æŠŠ\L å’Œ\E ä¹‹é—´çš„å­—ç¬¦å…¨éƒ¨è½¬æ¢ä¸ºå°å†™</td></tr><tr><td style="text-align:center">\U</td><td style="text-align:center">æŠŠ\U å’Œ\E ä¹‹é—´çš„å­—ç¬¦å…¨éƒ¨è½¬æ¢ä¸ºå¤§å†™</td></tr><tr><td style="text-align:center">\E</td><td style="text-align:center">ç»“æŸ\L æˆ–è€…\U</td></tr></tbody></table><p><strong>åº”ç”¨</strong> </p><p>æŠŠæ–‡æœ¬çš„ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå¤§å†™ã€‚</p><p><strong>æ–‡æœ¬</strong> </p><p>abcd</p><p><strong>æŸ¥æ‰¾</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(\w)(\w&#123;2&#125;)(\w)</span><br></pre></td></tr></table></figure><p><strong>æ›¿æ¢</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$1\U$2\E$3</span><br></pre></td></tr></table></figure><p><strong>ç»“æœ</strong> </p><p>aBCd</p><h1 id="ä¹ã€å‰åæŸ¥æ‰¾"><a href="#ä¹ã€å‰åæŸ¥æ‰¾" class="headerlink" title="ä¹ã€å‰åæŸ¥æ‰¾"></a>ä¹ã€å‰åæŸ¥æ‰¾</h1><p>å‰åæŸ¥æ‰¾è§„å®šäº†åŒ¹é…çš„å†…å®¹é¦–å°¾åº”è¯¥åŒ¹é…çš„å†…å®¹ï¼Œä½†æ˜¯åˆä¸åŒ…å«é¦–å°¾åŒ¹é…çš„å†…å®¹ã€‚å‘å‰æŸ¥æ‰¾ç”¨  <strong>?=</strong>  æ¥å®šä¹‰ï¼Œå®ƒè§„å®šäº†å°¾éƒ¨åŒ¹é…çš„å†…å®¹ï¼Œè¿™ä¸ªåŒ¹é…çš„å†…å®¹åœ¨ ?= ä¹‹åå®šä¹‰ã€‚æ‰€è°“å‘å‰æŸ¥æ‰¾ï¼Œå°±æ˜¯è§„å®šäº†ä¸€ä¸ªåŒ¹é…çš„å†…å®¹ï¼Œç„¶åä»¥è¿™ä¸ªå†…å®¹ä¸ºå°¾éƒ¨å‘å‰é¢æŸ¥æ‰¾éœ€è¦åŒ¹é…çš„å†…å®¹ã€‚å‘ååŒ¹é…ç”¨ ?&lt;= å®šä¹‰ï¼ˆæ³¨: javaScript ä¸æ”¯æŒå‘ååŒ¹é…, java å¯¹å…¶æ”¯æŒä¹Ÿä¸å®Œå–„ï¼‰ã€‚</p><p><strong>åº”ç”¨</strong> </p><p>æŸ¥æ‰¾å‡ºé‚®ä»¶åœ°å€ @ å­—ç¬¦å‰é¢çš„éƒ¨åˆ†ã€‚</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\w+(?=@)</span><br></pre></td></tr></table></figure><p><strong>ç»“æœ</strong> </p><p><strong>abc</strong> @qq.com</p><p>å¯¹å‘å‰å’Œå‘åæŸ¥æ‰¾å–éï¼Œåªè¦æŠŠ = æ›¿æ¢æˆ ! å³å¯ï¼Œæ¯”å¦‚ (?=) æ›¿æ¢æˆ (?!) ã€‚å–éæ“ä½œä½¿å¾—åŒ¹é…é‚£äº›é¦–å°¾ä¸ç¬¦åˆè¦æ±‚çš„å†…å®¹ã€‚</p><h1 id="åã€åµŒå…¥æ¡ä»¶"><a href="#åã€åµŒå…¥æ¡ä»¶" class="headerlink" title="åã€åµŒå…¥æ¡ä»¶"></a>åã€åµŒå…¥æ¡ä»¶</h1><h2 id="å›æº¯å¼•ç”¨æ¡ä»¶"><a href="#å›æº¯å¼•ç”¨æ¡ä»¶" class="headerlink" title="å›æº¯å¼•ç”¨æ¡ä»¶"></a>å›æº¯å¼•ç”¨æ¡ä»¶</h2><p>æ¡ä»¶åˆ¤æ–­ä¸ºæŸä¸ªå­è¡¨è¾¾å¼æ˜¯å¦åŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ™éœ€è¦ç»§ç»­åŒ¹é…æ¡ä»¶è¡¨è¾¾å¼åé¢çš„å†…å®¹ã€‚</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><p>å­è¡¨è¾¾å¼ (\() åŒ¹é…ä¸€ä¸ªå·¦æ‹¬å·ï¼Œå…¶åçš„ ? è¡¨ç¤ºåŒ¹é… 0 ä¸ªæˆ–è€… 1 ä¸ªã€‚ ?(1) ä¸ºæ¡ä»¶ï¼Œå½“å­è¡¨è¾¾å¼ 1 åŒ¹é…æ—¶æ¡ä»¶æˆç«‹ï¼Œéœ€è¦æ‰§è¡Œ ) åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯åŒ¹é…å³æ‹¬å·ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(\()?abc(?(1)\))</span><br></pre></td></tr></table></figure><p><strong>ç»“æœ</strong> </p><ol><li><strong>(abc)</strong> </li><li><strong>abc</strong> </li><li>(abc</li></ol><h2 id="å‰åæŸ¥æ‰¾æ¡ä»¶"><a href="#å‰åæŸ¥æ‰¾æ¡ä»¶" class="headerlink" title="å‰åæŸ¥æ‰¾æ¡ä»¶"></a>å‰åæŸ¥æ‰¾æ¡ä»¶</h2><p>æ¡ä»¶ä¸ºå®šä¹‰çš„é¦–å°¾æ˜¯å¦åŒ¹é…ï¼Œå¦‚æœåŒ¹é…ï¼Œåˆ™ç»§ç»­æ‰§è¡Œåé¢çš„åŒ¹é…ã€‚æ³¨æ„ï¼Œé¦–å°¾ä¸åŒ…å«åœ¨åŒ¹é…çš„å†…å®¹ä¸­ã€‚</p><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> </p><p> ?(?=-) ä¸ºå‰å‘æŸ¥æ‰¾æ¡ä»¶ï¼Œåªæœ‰åœ¨ä»¥ - ä¸ºå‰å‘æŸ¥æ‰¾çš„ç»“å°¾èƒ½åŒ¹é… \d{5} ï¼Œæ‰ç»§ç»­åŒ¹é… -\d{4} ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\d&#123;5&#125;(?(?=-)-\d&#123;4&#125;)</span><br></pre></td></tr></table></figure><p><strong>ç»“æœ</strong> </p><ol><li><strong>11111</strong> </li><li>22222-</li><li><strong>33333-4444</strong> </li></ol><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>BenForta. æ­£åˆ™è¡¨è¾¾å¼å¿…çŸ¥å¿…ä¼š [M]. äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾, 2007.</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- GFM-TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸€æ¦‚è¿°&quot;&gt;ä¸€ã€æ¦‚è¿°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#äºŒåŒ¹é…å•ä¸ªå­—ç¬¦&quot;&gt;äºŒã€åŒ¹é…å•ä¸ªå­—ç¬¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸‰åŒ¹é…ä¸€ç»„å­—ç¬¦&quot;&gt;ä¸‰ã€åŒ¹é…ä¸€ç»„å­—ç¬¦&lt;/a&gt;&lt;/li&gt;
&lt;li
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Interview-Notebook" scheme="https://airpoet.github.io/categories/Github/Interview-Notebook/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>æ•°æ®åº“ç³»ç»ŸåŸç†</title>
    <link href="https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/"/>
    <id>https://airpoet.github.io/2018/07/04/Java/Interview/Interview-Notebook/æ•°æ®åº“ç³»ç»ŸåŸç†/</id>
    <published>2018-07-04T13:51:06.358Z</published>
    <updated>2018-07-09T07:06:25.504Z</updated>
    
    <content type="html"><![CDATA[<!-- GFM-TOC --><ul><li><a href="#ä¸€äº‹åŠ¡">ä¸€ã€äº‹åŠ¡</a><ul><li><a href="#æ¦‚å¿µ">æ¦‚å¿µ</a></li><li><a href="#acid">ACID</a></li><li><a href="#autocommit">AUTOCOMMIT</a></li></ul></li><li><a href="#äºŒå¹¶å‘ä¸€è‡´æ€§é—®é¢˜">äºŒã€å¹¶å‘ä¸€è‡´æ€§é—®é¢˜</a><ul><li><a href="#ä¸¢å¤±ä¿®æ”¹">ä¸¢å¤±ä¿®æ”¹</a></li><li><a href="#è¯»è„æ•°æ®">è¯»è„æ•°æ®</a></li><li><a href="#ä¸å¯é‡å¤è¯»">ä¸å¯é‡å¤è¯»</a></li><li><a href="#å¹»å½±è¯»">å¹»å½±è¯»</a></li></ul></li><li><a href="#ä¸‰å°é”">ä¸‰ã€å°é”</a><ul><li><a href="#å°é”ç²’åº¦">å°é”ç²’åº¦</a></li><li><a href="#å°é”ç±»å‹">å°é”ç±»å‹</a></li><li><a href="#å°é”åè®®">å°é”åè®®</a></li><li><a href="#mysql-éšå¼ä¸æ˜¾ç¤ºé”å®š">MySQL éšå¼ä¸æ˜¾ç¤ºé”å®š</a></li></ul></li><li><a href="#å››éš”ç¦»çº§åˆ«">å››ã€éš”ç¦»çº§åˆ«</a><ul><li><a href="#æœªæäº¤è¯»read-uncommitted">æœªæäº¤è¯»ï¼ˆREAD UNCOMMITTEDï¼‰</a></li><li><a href="#æäº¤è¯»read-committed">æäº¤è¯»ï¼ˆREAD COMMITTEDï¼‰</a></li><li><a href="#å¯é‡å¤è¯»repeatable-read">å¯é‡å¤è¯»ï¼ˆREPEATABLE READï¼‰</a></li><li><a href="#å¯ä¸²è¡ŒåŒ–serializable">å¯ä¸²è¡ŒåŒ–ï¼ˆSERIALIZABLEï¼‰</a></li></ul></li><li><a href="#äº”å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶">äº”ã€å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</a><ul><li><a href="#ç‰ˆæœ¬å·">ç‰ˆæœ¬å·</a></li><li><a href="#undo-æ—¥å¿—">Undo æ—¥å¿—</a></li><li><a href="#å®ç°è¿‡ç¨‹">å®ç°è¿‡ç¨‹</a></li><li><a href="#å¿«ç…§è¯»ä¸å½“å‰è¯»">å¿«ç…§è¯»ä¸å½“å‰è¯»</a></li></ul></li><li><a href="#å…­next-key-locks">å…­ã€Next-Key Locks</a><ul><li><a href="#record-locks">Record Locks</a></li><li><a href="#grap-locks">Grap Locks</a></li><li><a href="#next-key-locks">Next-Key Locks</a></li></ul></li><li><a href="#ä¸ƒå…³ç³»æ•°æ®åº“è®¾è®¡ç†è®º">ä¸ƒã€å…³ç³»æ•°æ®åº“è®¾è®¡ç†è®º</a><ul><li><a href="#å‡½æ•°ä¾èµ–">å‡½æ•°ä¾èµ–</a></li><li><a href="#å¼‚å¸¸">å¼‚å¸¸</a></li><li><a href="#èŒƒå¼">èŒƒå¼</a></li></ul></li><li><a href="#å…«er-å›¾">å…«ã€ER å›¾</a><ul><li><a href="#å®ä½“çš„ä¸‰ç§è”ç³»">å®ä½“çš„ä¸‰ç§è”ç³»</a></li><li><a href="#è¡¨ç¤ºå‡ºç°å¤šæ¬¡çš„å…³ç³»">è¡¨ç¤ºå‡ºç°å¤šæ¬¡çš„å…³ç³»</a></li><li><a href="#è”ç³»çš„å¤šå‘æ€§">è”ç³»çš„å¤šå‘æ€§</a></li><li><a href="#è¡¨ç¤ºå­ç±»">è¡¨ç¤ºå­ç±»</a></li></ul></li><li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a><!-- GFM-TOC --></li></ul><h1 id="ä¸€ã€äº‹åŠ¡"><a href="#ä¸€ã€äº‹åŠ¡" class="headerlink" title="ä¸€ã€äº‹åŠ¡"></a>ä¸€ã€äº‹åŠ¡</h1><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061723.png" width="400"> <br></p><p>äº‹åŠ¡æŒ‡çš„æ˜¯æ»¡è¶³ ACID ç‰¹æ€§çš„ä¸€ç»„æ“ä½œï¼Œå¯ä»¥é€šè¿‡ Commit æäº¤ä¸€ä¸ªäº‹åŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Rollback è¿›è¡Œå›æ»šã€‚</p><h2 id="ACID"><a href="#ACID" class="headerlink" title="ACID"></a>ACID</h2><h3 id="1-åŸå­æ€§ï¼ˆAtomicityï¼‰"><a href="#1-åŸå­æ€§ï¼ˆAtomicityï¼‰" class="headerlink" title="1. åŸå­æ€§ï¼ˆAtomicityï¼‰"></a>1. åŸå­æ€§ï¼ˆAtomicityï¼‰</h3><p>äº‹åŠ¡è¢«è§†ä¸ºä¸å¯åˆ†å‰²çš„æœ€å°å•å…ƒï¼Œäº‹åŠ¡çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šã€‚</p><p>å›æ»šå¯ä»¥ç”¨æ—¥å¿—æ¥å®ç°ï¼Œæ—¥å¿—è®°å½•ç€äº‹åŠ¡æ‰€æ‰§è¡Œçš„ä¿®æ”¹æ“ä½œï¼Œåœ¨å›æ»šæ—¶åå‘æ‰§è¡Œè¿™äº›ä¿®æ”¹æ“ä½œå³å¯ã€‚</p><h3 id="2-ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰"><a href="#2-ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰" class="headerlink" title="2. ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰"></a>2. ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</h3><p>æ•°æ®åº“åœ¨äº‹åŠ¡æ‰§è¡Œå‰åéƒ½ä¿æŒä¸€è‡´æ€§çŠ¶æ€ã€‚</p><p>åœ¨ä¸€è‡´æ€§çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰äº‹åŠ¡å¯¹ä¸€ä¸ªæ•°æ®çš„è¯»å–ç»“æœéƒ½æ˜¯ç›¸åŒçš„ã€‚</p><h3 id="3-éš”ç¦»æ€§ï¼ˆIsolationï¼‰"><a href="#3-éš”ç¦»æ€§ï¼ˆIsolationï¼‰" class="headerlink" title="3. éš”ç¦»æ€§ï¼ˆIsolationï¼‰"></a>3. éš”ç¦»æ€§ï¼ˆIsolationï¼‰</h3><p>ä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤ä»¥å‰ï¼Œå¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚</p><h3 id="4-æŒä¹…æ€§ï¼ˆDurabilityï¼‰"><a href="#4-æŒä¹…æ€§ï¼ˆDurabilityï¼‰" class="headerlink" title="4. æŒä¹…æ€§ï¼ˆDurabilityï¼‰"></a>4. æŒä¹…æ€§ï¼ˆDurabilityï¼‰</h3><p>ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œåˆ™å…¶æ‰€åšçš„ä¿®æ”¹å°†ä¼šæ°¸è¿œä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚å³ä½¿ç³»ç»Ÿå‘ç”Ÿå´©æºƒï¼Œäº‹åŠ¡æ‰§è¡Œçš„ç»“æœä¹Ÿä¸èƒ½ä¸¢å¤±ã€‚</p><p>å¯ä»¥é€šè¿‡æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤æ¥å®ç°ï¼Œåœ¨ç³»ç»Ÿå‘ç”Ÿå´©æºƒæ—¶ï¼Œä½¿ç”¨å¤‡ä»½çš„æ•°æ®åº“è¿›è¡Œæ•°æ®æ¢å¤ã€‚</p><hr><p>äº‹åŠ¡çš„ ACID ç‰¹æ€§æ¦‚å¿µç®€å•ï¼Œä½†ä¸æ˜¯å¾ˆå¥½ç†è§£ï¼Œä¸»è¦æ˜¯å› ä¸ºè¿™å‡ ä¸ªç‰¹æ€§ä¸æ˜¯ä¸€ç§å¹³çº§å…³ç³»ï¼š</p><ul><li>åªæœ‰æ»¡è¶³ä¸€è‡´æ€§ï¼Œäº‹åŠ¡çš„æ‰§è¡Œç»“æœæ‰æ˜¯æ­£ç¡®çš„ã€‚</li><li>åœ¨æ— å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œäº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œéš”ç¦»æ€§ä¸€å®šèƒ½å¤Ÿæ»¡è¶³ã€‚æ­¤æ—¶è¦åªè¦èƒ½æ»¡è¶³åŸå­æ€§ï¼Œå°±ä¸€å®šèƒ½æ»¡è¶³ä¸€è‡´æ€§ã€‚</li><li>åœ¨å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œï¼Œäº‹åŠ¡ä¸ä»…è¦æ»¡è¶³åŸå­æ€§ï¼Œè¿˜éœ€è¦æ»¡è¶³éš”ç¦»æ€§ï¼Œæ‰èƒ½æ»¡è¶³ä¸€è‡´æ€§ã€‚</li><li>äº‹åŠ¡æ»¡è¶³æŒä¹…åŒ–æ˜¯ä¸ºäº†èƒ½åº”å¯¹æ•°æ®åº“å´©æºƒçš„æƒ…å†µã€‚</li></ul><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061728.png" width="500"> </div><br></p><h2 id="AUTOCOMMIT"><a href="#AUTOCOMMIT" class="headerlink" title="AUTOCOMMIT"></a>AUTOCOMMIT</h2><p>MySQL é»˜è®¤é‡‡ç”¨è‡ªåŠ¨æäº¤æ¨¡å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸æ˜¾å¼ä½¿ç”¨<code>START TRANSACTION</code>è¯­å¥æ¥å¼€å§‹ä¸€ä¸ªäº‹åŠ¡ï¼Œé‚£ä¹ˆæ¯ä¸ªæŸ¥è¯¢éƒ½ä¼šè¢«å½“åšä¸€ä¸ªäº‹åŠ¡è‡ªåŠ¨æäº¤ã€‚</p><h1 id="äºŒã€å¹¶å‘ä¸€è‡´æ€§é—®é¢˜"><a href="#äºŒã€å¹¶å‘ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="äºŒã€å¹¶å‘ä¸€è‡´æ€§é—®é¢˜"></a>äºŒã€å¹¶å‘ä¸€è‡´æ€§é—®é¢˜</h1><p>åœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œäº‹åŠ¡çš„éš”ç¦»æ€§å¾ˆéš¾ä¿è¯ï¼Œå› æ­¤ä¼šå‡ºç°å¾ˆå¤šå¹¶å‘ä¸€è‡´æ€§é—®é¢˜ã€‚</p><h2 id="ä¸¢å¤±ä¿®æ”¹"><a href="#ä¸¢å¤±ä¿®æ”¹" class="headerlink" title="ä¸¢å¤±ä¿®æ”¹"></a>ä¸¢å¤±ä¿®æ”¹</h2><p>T<sub>1</sub> å’Œ T<sub>2</sub> ä¸¤ä¸ªäº‹åŠ¡éƒ½å¯¹ä¸€ä¸ªæ•°æ®è¿›è¡Œä¿®æ”¹ï¼ŒT<sub>1</sub> å…ˆä¿®æ”¹ï¼ŒT<sub>2</sub> éšåä¿®æ”¹ï¼ŒT<sub>2</sub> çš„ä¿®æ”¹è¦†ç›–äº† T<sub>1</sub> çš„ä¿®æ”¹ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061733.png" width="300"> </div><br></p><h2 id="è¯»è„æ•°æ®"><a href="#è¯»è„æ•°æ®" class="headerlink" title="è¯»è„æ•°æ®"></a>è¯»è„æ•°æ®</h2><p>T<sub>1</sub> ä¿®æ”¹ä¸€ä¸ªæ•°æ®ï¼ŒT<sub>2</sub> éšåè¯»å–è¿™ä¸ªæ•°æ®ã€‚å¦‚æœ T<sub>1</sub> æ’¤é”€äº†è¿™æ¬¡ä¿®æ”¹ï¼Œé‚£ä¹ˆ T<sub>2</sub> è¯»å–çš„æ•°æ®æ˜¯è„æ•°æ®ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061737.png" width="300"> </div><br></p><h2 id="ä¸å¯é‡å¤è¯»"><a href="#ä¸å¯é‡å¤è¯»" class="headerlink" title="ä¸å¯é‡å¤è¯»"></a>ä¸å¯é‡å¤è¯»</h2><p>T<sub>2</sub> è¯»å–ä¸€ä¸ªæ•°æ®ï¼ŒT<sub>1</sub> å¯¹è¯¥æ•°æ®åšäº†ä¿®æ”¹ã€‚å¦‚æœ T<sub>2</sub> å†æ¬¡è¯»å–è¿™ä¸ªæ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061742.png" width="300"> </div><br></p><h2 id="å¹»å½±è¯»"><a href="#å¹»å½±è¯»" class="headerlink" title="å¹»å½±è¯»"></a>å¹»å½±è¯»</h2><p>T<sub>1</sub> è¯»å–æŸä¸ªèŒƒå›´çš„æ•°æ®ï¼ŒT<sub>2</sub> åœ¨è¿™ä¸ªèŒƒå›´å†…æ’å…¥æ–°çš„æ•°æ®ï¼ŒT<sub>1</sub> å†æ¬¡è¯»å–è¿™ä¸ªèŒƒå›´çš„æ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061747.png" width="300"> </div><br></p><hr><p>äº§ç”Ÿå¹¶å‘ä¸ä¸€è‡´æ€§é—®é¢˜ä¸»è¦åŸå› æ˜¯ç ´åäº†äº‹åŠ¡çš„éš”ç¦»æ€§ï¼Œè§£å†³æ–¹æ³•æ˜¯é€šè¿‡å¹¶å‘æ§åˆ¶æ¥ä¿è¯éš”ç¦»æ€§ã€‚å¹¶å‘æ§åˆ¶å¯ä»¥é€šè¿‡å°é”æ¥å®ç°ï¼Œä½†æ˜¯å°é”æ“ä½œéœ€è¦ç”¨æˆ·è‡ªå·±æ§åˆ¶ï¼Œç›¸å½“å¤æ‚ã€‚æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæä¾›äº†äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Œè®©ç”¨æˆ·ä»¥ä¸€ç§æ›´è½»æ¾çš„æ–¹å¼å¤„ç†å¹¶å‘ä¸€è‡´æ€§é—®é¢˜ã€‚</p><h1 id="ä¸‰ã€å°é”"><a href="#ä¸‰ã€å°é”" class="headerlink" title="ä¸‰ã€å°é”"></a>ä¸‰ã€å°é”</h1><h2 id="å°é”ç²’åº¦"><a href="#å°é”ç²’åº¦" class="headerlink" title="å°é”ç²’åº¦"></a>å°é”ç²’åº¦</h2><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061750.jpg" width="300"> </div><br></p><p>MySQL ä¸­æä¾›äº†ä¸¤ç§å°é”ç²’åº¦ï¼šè¡Œçº§é”ä»¥åŠè¡¨çº§é”ã€‚</p><p>åº”è¯¥å°½é‡åªé”å®šéœ€è¦ä¿®æ”¹çš„é‚£éƒ¨åˆ†æ•°æ®ï¼Œè€Œä¸æ˜¯æ‰€æœ‰çš„èµ„æºã€‚é”å®šçš„æ•°æ®é‡è¶Šå°‘ï¼Œå‘ç”Ÿé”äº‰ç”¨çš„å¯èƒ½å°±è¶Šå°ï¼Œç³»ç»Ÿçš„å¹¶å‘ç¨‹åº¦å°±è¶Šé«˜ã€‚</p><p>ä½†æ˜¯åŠ é”éœ€è¦æ¶ˆè€—èµ„æºï¼Œé”çš„å„ç§æ“ä½œï¼ˆåŒ…æ‹¬è·å–é”ã€é‡Šæ”¾é”ã€ä»¥åŠæ£€æŸ¥é”çŠ¶æ€ï¼‰éƒ½ä¼šå¢åŠ ç³»ç»Ÿå¼€é”€ã€‚å› æ­¤å°é”ç²’åº¦è¶Šå°ï¼Œç³»ç»Ÿå¼€é”€å°±è¶Šå¤§ã€‚</p><p>åœ¨é€‰æ‹©å°é”ç²’åº¦æ—¶ï¼Œéœ€è¦åœ¨é”å¼€é”€å’Œå¹¶å‘ç¨‹åº¦ä¹‹é—´åšä¸€ä¸ªæƒè¡¡ã€‚</p><h2 id="å°é”ç±»å‹"><a href="#å°é”ç±»å‹" class="headerlink" title="å°é”ç±»å‹"></a>å°é”ç±»å‹</h2><h3 id="1-è¯»å†™é”"><a href="#1-è¯»å†™é”" class="headerlink" title="1. è¯»å†™é”"></a>1. è¯»å†™é”</h3><ul><li>æ’å®ƒé”ï¼ˆExclusiveï¼‰ï¼Œç®€å†™ä¸º X é”ï¼Œåˆç§°å†™é”ã€‚</li><li>å…±äº«é”ï¼ˆSharedï¼‰ï¼Œç®€å†™ä¸º S é”ï¼Œåˆç§°è¯»é”ã€‚</li></ul><p>æœ‰ä»¥ä¸‹ä¸¤ä¸ªè§„å®šï¼š</p><ul><li>ä¸€ä¸ªäº‹åŠ¡å¯¹æ•°æ®å¯¹è±¡ A åŠ äº† X é”ï¼Œå°±å¯ä»¥å¯¹ A è¿›è¡Œè¯»å–å’Œæ›´æ–°ã€‚åŠ é”æœŸé—´å…¶å®ƒäº‹åŠ¡ä¸èƒ½å¯¹ A åŠ ä»»ä½•é”ã€‚</li><li>ä¸€ä¸ªäº‹åŠ¡å¯¹æ•°æ®å¯¹è±¡ A åŠ äº† S é”ï¼Œå¯ä»¥å¯¹ A è¿›è¡Œè¯»å–æ“ä½œï¼Œä½†æ˜¯ä¸èƒ½è¿›è¡Œæ›´æ–°æ“ä½œã€‚åŠ é”æœŸé—´å…¶å®ƒäº‹åŠ¡èƒ½å¯¹ A åŠ  S é”ï¼Œä½†æ˜¯ä¸èƒ½åŠ  X é”ã€‚</li></ul><p>é”çš„å…¼å®¹å…³ç³»å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:center">-</th><th style="text-align:center">X</th><th style="text-align:center">S</th></tr></thead><tbody><tr><td style="text-align:center">X</td><td style="text-align:center">NO</td><td style="text-align:center">NO</td></tr><tr><td style="text-align:center">S</td><td style="text-align:center">NO</td><td style="text-align:center">YES</td></tr></tbody></table><h3 id="2-æ„å‘é”"><a href="#2-æ„å‘é”" class="headerlink" title="2. æ„å‘é”"></a>2. æ„å‘é”</h3><p>ä½¿ç”¨æ„å‘é”ï¼ˆIntention Locksï¼‰å¯ä»¥æ›´å®¹æ˜“åœ°æ”¯æŒå¤šç²’åº¦å°é”ã€‚</p><p>åœ¨å­˜åœ¨è¡Œçº§é”å’Œè¡¨çº§é”çš„æƒ…å†µä¸‹ï¼Œäº‹åŠ¡ T æƒ³è¦å¯¹è¡¨ A åŠ  X é”ï¼Œå°±éœ€è¦å…ˆæ£€æµ‹æ˜¯å¦æœ‰å…¶å®ƒäº‹åŠ¡å¯¹è¡¨ A æˆ–è€…è¡¨ A ä¸­çš„ä»»æ„ä¸€è¡ŒåŠ äº†é”ï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹è¡¨ A çš„æ¯ä¸€è¡Œéƒ½æ£€æµ‹ä¸€æ¬¡ï¼Œè¿™æ˜¯éå¸¸è€—æ—¶çš„ã€‚</p><p>æ„å‘é”åœ¨åŸæ¥çš„ X/S é”ä¹‹ä¸Šå¼•å…¥äº† IX/ISï¼ŒIX/IS éƒ½æ˜¯è¡¨é”ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªäº‹åŠ¡æƒ³è¦åœ¨è¡¨ä¸­çš„æŸä¸ªæ•°æ®è¡Œä¸ŠåŠ  X é”æˆ– S é”ã€‚æœ‰ä»¥ä¸‹ä¸¤ä¸ªè§„å®šï¼š</p><ul><li>ä¸€ä¸ªäº‹åŠ¡åœ¨è·å¾—æŸä¸ªæ•°æ®è¡Œå¯¹è±¡çš„ S é”ä¹‹å‰ï¼Œå¿…é¡»å…ˆè·å¾—è¡¨çš„ IS é”æˆ–è€…æ›´å¼ºçš„é”ï¼›</li><li>ä¸€ä¸ªäº‹åŠ¡åœ¨è·å¾—æŸä¸ªæ•°æ®è¡Œå¯¹è±¡çš„ X é”ä¹‹å‰ï¼Œå¿…é¡»å…ˆè·å¾—è¡¨çš„ IX é”ã€‚</li></ul><p>é€šè¿‡å¼•å…¥æ„å‘é”ï¼Œäº‹åŠ¡ T æƒ³è¦å¯¹è¡¨ A åŠ  X é”ï¼Œåªéœ€è¦å…ˆæ£€æµ‹æ˜¯å¦æœ‰å…¶å®ƒäº‹åŠ¡å¯¹è¡¨ A åŠ äº† X/IX/S/IS é”ï¼Œå¦‚æœåŠ äº†å°±è¡¨ç¤ºæœ‰å…¶å®ƒäº‹åŠ¡æ­£åœ¨ä½¿ç”¨è¿™ä¸ªè¡¨æˆ–è€…è¡¨ä¸­æŸä¸€è¡Œçš„é”ï¼Œå› æ­¤äº‹åŠ¡ T åŠ  X é”å¤±è´¥ã€‚</p><p>å„ç§é”çš„å…¼å®¹å…³ç³»å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:center">-</th><th style="text-align:center">X</th><th style="text-align:center">IX</th><th style="text-align:center">S</th><th style="text-align:center">IS</th></tr></thead><tbody><tr><td style="text-align:center">X</td><td style="text-align:center">NO</td><td style="text-align:center">NO</td><td style="text-align:center">NO</td><td style="text-align:center">NO</td></tr><tr><td style="text-align:center">IX</td><td style="text-align:center">NO</td><td style="text-align:center">YES</td><td style="text-align:center">NO</td><td style="text-align:center">YES</td></tr><tr><td style="text-align:center">S</td><td style="text-align:center">NO</td><td style="text-align:center">NO</td><td style="text-align:center">YES</td><td style="text-align:center">YES</td></tr><tr><td style="text-align:center">IS</td><td style="text-align:center">NO</td><td style="text-align:center">YES</td><td style="text-align:center">YES</td><td style="text-align:center">YES</td></tr></tbody></table><p>è§£é‡Šå¦‚ä¸‹ï¼š</p><ul><li>ä»»æ„ IS/IX é”ä¹‹é—´éƒ½æ˜¯å…¼å®¹çš„ï¼Œå› ä¸ºå®ƒä»¬åªæ˜¯è¡¨ç¤ºæƒ³è¦å¯¹è¡¨åŠ é”ï¼Œè€Œä¸æ˜¯çœŸæ­£åŠ é”ï¼›</li><li>S é”åªä¸ S é”å’Œ IS é”å…¼å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´äº‹åŠ¡ T æƒ³è¦å¯¹æ•°æ®è¡ŒåŠ  S é”ï¼Œå…¶å®ƒäº‹åŠ¡å¯ä»¥å·²ç»è·å¾—å¯¹è¡¨æˆ–è€…è¡¨ä¸­çš„è¡Œçš„ S é”ã€‚</li></ul><h2 id="å°é”åè®®"><a href="#å°é”åè®®" class="headerlink" title="å°é”åè®®"></a>å°é”åè®®</h2><h3 id="1-ä¸‰çº§å°é”åè®®"><a href="#1-ä¸‰çº§å°é”åè®®" class="headerlink" title="1. ä¸‰çº§å°é”åè®®"></a>1. ä¸‰çº§å°é”åè®®</h3><p><strong>ä¸€çº§å°é”åè®®</strong> </p><p>äº‹åŠ¡ T è¦ä¿®æ”¹æ•°æ® A æ—¶å¿…é¡»åŠ  X é”ï¼Œç›´åˆ° T ç»“æŸæ‰é‡Šæ”¾é”ã€‚</p><p>å¯ä»¥è§£å†³ä¸¢å¤±ä¿®æ”¹é—®é¢˜ï¼Œå› ä¸ºä¸èƒ½åŒæ—¶æœ‰ä¸¤ä¸ªäº‹åŠ¡å¯¹åŒä¸€ä¸ªæ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆäº‹åŠ¡çš„ä¿®æ”¹å°±ä¸ä¼šè¢«è¦†ç›–ã€‚</p><table><thead><tr><th style="text-align:center">T<sub>1</sub></th><th style="text-align:center">T<sub>2</sub></th></tr></thead><tbody><tr><td style="text-align:center">lock-x(A)</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">read A=20</td><td style="text-align:center"></td></tr><tr><td style="text-align:center"></td><td style="text-align:center">lock-x(A)</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">wait</td></tr><tr><td style="text-align:center">write A=19</td><td style="text-align:center">.</td></tr><tr><td style="text-align:center">commit</td><td style="text-align:center">.</td></tr><tr><td style="text-align:center">unlock-x(A)</td><td style="text-align:center">.</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">obtain</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">read A=19</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">write A=21</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">commit</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">unlock-x(A)</td></tr></tbody></table><p><strong>äºŒçº§å°é”åè®®</strong> </p><p>åœ¨ä¸€çº§çš„åŸºç¡€ä¸Šï¼Œè¦æ±‚è¯»å–æ•°æ® A æ—¶å¿…é¡»åŠ  S é”ï¼Œè¯»å–å®Œé©¬ä¸Šé‡Šæ”¾ S é”ã€‚</p><p>å¯ä»¥è§£å†³è¯»è„æ•°æ®é—®é¢˜ï¼Œå› ä¸ºå¦‚æœä¸€ä¸ªäº‹åŠ¡åœ¨å¯¹æ•°æ® A è¿›è¡Œä¿®æ”¹ï¼Œæ ¹æ® 1 çº§å°é”åè®®ï¼Œä¼šåŠ  X é”ï¼Œé‚£ä¹ˆå°±ä¸èƒ½å†åŠ  S é”äº†ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šè¯»å…¥æ•°æ®ã€‚</p><table><thead><tr><th style="text-align:center">T<sub>1</sub></th><th style="text-align:center">T<sub>2</sub></th></tr></thead><tbody><tr><td style="text-align:center">lock-x(A)</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">read A=20</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">write A=19</td><td style="text-align:center"></td></tr><tr><td style="text-align:center"></td><td style="text-align:center">lock-s(A)</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">wait</td></tr><tr><td style="text-align:center">rollback</td><td style="text-align:center">.</td></tr><tr><td style="text-align:center">A=20</td><td style="text-align:center">.</td></tr><tr><td style="text-align:center">unlock-x(A)</td><td style="text-align:center">.</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">obtain</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">read A=20</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">commit</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">unlock-s(A)</td></tr></tbody></table><p><strong>ä¸‰çº§å°é”åè®®</strong> </p><p>åœ¨äºŒçº§çš„åŸºç¡€ä¸Šï¼Œè¦æ±‚è¯»å–æ•°æ® A æ—¶å¿…é¡»åŠ  S é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸäº†æ‰èƒ½é‡Šæ”¾ S é”ã€‚</p><p>å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼Œå› ä¸ºè¯» A æ—¶ï¼Œå…¶å®ƒäº‹åŠ¡ä¸èƒ½å¯¹ A åŠ  X é”ï¼Œä»è€Œé¿å…äº†åœ¨è¯»çš„æœŸé—´æ•°æ®å‘ç”Ÿæ”¹å˜ã€‚</p><table><thead><tr><th style="text-align:center">T<sub>1</sub></th><th style="text-align:center">T<sub>2</sub></th></tr></thead><tbody><tr><td style="text-align:center">lock-s(A)</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">read A=20</td><td style="text-align:center"></td></tr><tr><td style="text-align:center"></td><td style="text-align:center">lock-x(A)</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">wait</td></tr><tr><td style="text-align:center">read A=20</td><td style="text-align:center">.</td></tr><tr><td style="text-align:center">commit</td><td style="text-align:center">.</td></tr><tr><td style="text-align:center">unlock-s(A)</td><td style="text-align:center">.</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">obtain</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">read A=20</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">write A=19</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">commit</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">unlock-X(A)</td></tr></tbody></table><h3 id="2-ä¸¤æ®µé”åè®®"><a href="#2-ä¸¤æ®µé”åè®®" class="headerlink" title="2. ä¸¤æ®µé”åè®®"></a>2. ä¸¤æ®µé”åè®®</h3><p>åŠ é”å’Œè§£é”åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µè¿›è¡Œã€‚</p><p>å¯ä¸²è¡ŒåŒ–è°ƒåº¦æ˜¯æŒ‡ï¼Œé€šè¿‡å¹¶å‘æ§åˆ¶ï¼Œä½¿å¾—å¹¶å‘æ‰§è¡Œçš„äº‹åŠ¡ç»“æœä¸æŸä¸ªä¸²è¡Œæ‰§è¡Œçš„äº‹åŠ¡ç»“æœç›¸åŒã€‚</p><p>äº‹åŠ¡éµå¾ªä¸¤æ®µé”åè®®æ˜¯ä¿è¯å¯ä¸²è¡ŒåŒ–è°ƒåº¦çš„å……åˆ†æ¡ä»¶ã€‚ä¾‹å¦‚ä»¥ä¸‹æ“ä½œæ»¡è¶³ä¸¤æ®µé”åè®®ï¼Œå®ƒæ˜¯å¯ä¸²è¡ŒåŒ–è°ƒåº¦ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lock-x(A)...lock-s(B)...lock-s(C)...unlock(A)...unlock(C)...unlock(B)</span><br></pre></td></tr></table></figure><p>ä½†ä¸æ˜¯å¿…è¦æ¡ä»¶ï¼Œä¾‹å¦‚ä»¥ä¸‹æ“ä½œä¸æ»¡è¶³ä¸¤æ®µé”åè®®ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯å¯ä¸²è¡ŒåŒ–è°ƒåº¦ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lock-x(A)...unlock(A)...lock-s(B)...unlock(B)...lock-s(C)...unlock(C)</span><br></pre></td></tr></table></figure><h2 id="MySQL-éšå¼ä¸æ˜¾ç¤ºé”å®š"><a href="#MySQL-éšå¼ä¸æ˜¾ç¤ºé”å®š" class="headerlink" title="MySQL éšå¼ä¸æ˜¾ç¤ºé”å®š"></a>MySQL éšå¼ä¸æ˜¾ç¤ºé”å®š</h2><p>MySQL çš„ InnoDB å­˜å‚¨å¼•æ“é‡‡ç”¨ä¸¤æ®µé”åè®®ï¼Œä¼šæ ¹æ®éš”ç¦»çº§åˆ«åœ¨éœ€è¦çš„æ—¶å€™è‡ªåŠ¨åŠ é”ï¼Œå¹¶ä¸”æ‰€æœ‰çš„é”éƒ½æ˜¯åœ¨åŒä¸€æ—¶åˆ»è¢«é‡Šæ”¾ï¼Œè¿™è¢«ç§°ä¸ºéšå¼é”å®šã€‚</p><p>InnoDB ä¹Ÿå¯ä»¥ä½¿ç”¨ç‰¹å®šçš„è¯­å¥è¿›è¡Œæ˜¾ç¤ºé”å®šï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">LOCK</span> <span class="keyword">In</span> <span class="keyword">SHARE</span> <span class="keyword">MODE</span>;</span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure><h1 id="å››ã€éš”ç¦»çº§åˆ«"><a href="#å››ã€éš”ç¦»çº§åˆ«" class="headerlink" title="å››ã€éš”ç¦»çº§åˆ«"></a>å››ã€éš”ç¦»çº§åˆ«</h1><h2 id="æœªæäº¤è¯»ï¼ˆREAD-UNCOMMITTEDï¼‰"><a href="#æœªæäº¤è¯»ï¼ˆREAD-UNCOMMITTEDï¼‰" class="headerlink" title="æœªæäº¤è¯»ï¼ˆREAD UNCOMMITTEDï¼‰"></a>æœªæäº¤è¯»ï¼ˆREAD UNCOMMITTEDï¼‰</h2><p>äº‹åŠ¡ä¸­çš„ä¿®æ”¹ï¼Œå³ä½¿æ²¡æœ‰æäº¤ï¼Œå¯¹å…¶å®ƒäº‹åŠ¡ä¹Ÿæ˜¯å¯è§çš„ã€‚</p><h2 id="æäº¤è¯»ï¼ˆREAD-COMMITTEDï¼‰"><a href="#æäº¤è¯»ï¼ˆREAD-COMMITTEDï¼‰" class="headerlink" title="æäº¤è¯»ï¼ˆREAD COMMITTEDï¼‰"></a>æäº¤è¯»ï¼ˆREAD COMMITTEDï¼‰</h2><p>ä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»å–å·²ç»æäº¤çš„äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æäº¤ä¹‹å‰å¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚</p><h2 id="å¯é‡å¤è¯»ï¼ˆREPEATABLE-READï¼‰"><a href="#å¯é‡å¤è¯»ï¼ˆREPEATABLE-READï¼‰" class="headerlink" title="å¯é‡å¤è¯»ï¼ˆREPEATABLE READï¼‰"></a>å¯é‡å¤è¯»ï¼ˆREPEATABLE READï¼‰</h2><p>ä¿è¯åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–åŒæ ·æ•°æ®çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p><h2 id="å¯ä¸²è¡ŒåŒ–ï¼ˆSERIALIZABLEï¼‰"><a href="#å¯ä¸²è¡ŒåŒ–ï¼ˆSERIALIZABLEï¼‰" class="headerlink" title="å¯ä¸²è¡ŒåŒ–ï¼ˆSERIALIZABLEï¼‰"></a>å¯ä¸²è¡ŒåŒ–ï¼ˆSERIALIZABLEï¼‰</h2><p>å¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œã€‚</p><hr><table><thead><tr><th style="text-align:center">éš”ç¦»çº§åˆ«</th><th style="text-align:center">è„è¯»</th><th style="text-align:center">ä¸å¯é‡å¤è¯»</th><th style="text-align:center">å¹»å½±è¯»</th></tr></thead><tbody><tr><td style="text-align:center">æœªæäº¤è¯»</td><td style="text-align:center">YES</td><td style="text-align:center">YES</td><td style="text-align:center">YES</td></tr><tr><td style="text-align:center">æäº¤è¯»</td><td style="text-align:center">NO</td><td style="text-align:center">YES</td><td style="text-align:center">YES</td></tr><tr><td style="text-align:center">å¯é‡å¤è¯»</td><td style="text-align:center">NO</td><td style="text-align:center">NO</td><td style="text-align:center">YES</td></tr><tr><td style="text-align:center">å¯ä¸²è¡ŒåŒ–</td><td style="text-align:center">NO</td><td style="text-align:center">NO</td><td style="text-align:center">NO</td></tr></tbody></table><h1 id="äº”ã€å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶"><a href="#äº”ã€å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶" class="headerlink" title="äº”ã€å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶"></a>äº”ã€å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</h1><p>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMulti-Version Concurrency Control, MVCCï¼‰æ˜¯ MySQL çš„ InnoDB å­˜å‚¨å¼•æ“å®ç°éš”ç¦»çº§åˆ«çš„ä¸€ç§å…·ä½“æ–¹å¼ï¼Œç”¨äºå®ç°æäº¤è¯»å’Œå¯é‡å¤è¯»è¿™ä¸¤ç§éš”ç¦»çº§åˆ«ã€‚è€Œæœªæäº¤è¯»éš”ç¦»çº§åˆ«æ€»æ˜¯è¯»å–æœ€æ–°çš„æ•°æ®è¡Œï¼Œæ— éœ€ä½¿ç”¨ MVCCï¼›å¯ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«éœ€è¦å¯¹æ‰€æœ‰è¯»å–çš„è¡Œéƒ½åŠ é”ï¼Œå•çº¯ä½¿ç”¨ MVCC æ— æ³•å®ç°ã€‚</p><h2 id="ç‰ˆæœ¬å·"><a href="#ç‰ˆæœ¬å·" class="headerlink" title="ç‰ˆæœ¬å·"></a>ç‰ˆæœ¬å·</h2><ul><li>ç³»ç»Ÿç‰ˆæœ¬å·ï¼šæ˜¯ä¸€ä¸ªé€’å¢çš„æ•°å­—ï¼Œæ¯å¼€å§‹ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œç³»ç»Ÿç‰ˆæœ¬å·å°±ä¼šè‡ªåŠ¨é€’å¢ã€‚</li><li>äº‹åŠ¡ç‰ˆæœ¬å·ï¼šäº‹åŠ¡å¼€å§‹æ—¶çš„ç³»ç»Ÿç‰ˆæœ¬å·ã€‚</li></ul><p>InooDB çš„ MVCC åœ¨æ¯è¡Œè®°å½•åé¢éƒ½ä¿å­˜ç€ä¸¤ä¸ªéšè—çš„åˆ—ï¼Œç”¨æ¥å­˜å‚¨ä¸¤ä¸ªç‰ˆæœ¬å·ï¼š</p><ul><li>åˆ›å»ºç‰ˆæœ¬å·ï¼šæŒ‡ç¤ºåˆ›å»ºä¸€ä¸ªæ•°æ®è¡Œçš„å¿«ç…§æ—¶çš„ç³»ç»Ÿç‰ˆæœ¬å·ï¼›</li><li>åˆ é™¤ç‰ˆæœ¬å·ï¼šå¦‚æœè¯¥å¿«ç…§çš„åˆ é™¤ç‰ˆæœ¬å·å¤§äºå½“å‰äº‹åŠ¡ç‰ˆæœ¬å·è¡¨ç¤ºè¯¥å¿«ç…§æœ‰æ•ˆï¼Œå¦åˆ™è¡¨ç¤ºè¯¥å¿«ç…§å·²ç»è¢«åˆ é™¤äº†ã€‚</li></ul><h2 id="Undo-æ—¥å¿—"><a href="#Undo-æ—¥å¿—" class="headerlink" title="Undo æ—¥å¿—"></a>Undo æ—¥å¿—</h2><p>InnoDB çš„ MVCC ä½¿ç”¨åˆ°çš„å¿«ç…§å­˜å‚¨åœ¨ Undo æ—¥å¿—ä¸­ï¼Œè¯¥æ—¥å¿—é€šè¿‡å›æ»šæŒ‡é’ˆæŠŠä¸€ä¸ªæ•°æ®è¡Œï¼ˆRecordï¼‰çš„æ‰€æœ‰å¿«ç…§è¿æ¥èµ·æ¥ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061808.jpg" width=""> </div><br></p><h2 id="å®ç°è¿‡ç¨‹"><a href="#å®ç°è¿‡ç¨‹" class="headerlink" title="å®ç°è¿‡ç¨‹"></a>å®ç°è¿‡ç¨‹</h2><p>ä»¥ä¸‹å®ç°è¿‡ç¨‹é’ˆå¯¹å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ã€‚</p><h3 id="1-SELECT"><a href="#1-SELECT" class="headerlink" title="1. SELECT"></a>1. SELECT</h3><p>å½“å¼€å§‹æ–°ä¸€ä¸ªäº‹åŠ¡æ—¶ï¼Œè¯¥äº‹åŠ¡çš„ç‰ˆæœ¬å·è‚¯å®šä¼šå¤§äºå½“å‰æ‰€æœ‰æ•°æ®è¡Œå¿«ç…§çš„åˆ›å»ºç‰ˆæœ¬å·ï¼Œç†è§£è¿™ä¸€ç‚¹å¾ˆå…³é”®ã€‚</p><p>å¤šä¸ªäº‹åŠ¡å¿…é¡»è¯»å–åˆ°åŒä¸€ä¸ªæ•°æ®è¡Œçš„å¿«ç…§ï¼Œå¹¶ä¸”è¿™ä¸ªå¿«ç…§æ˜¯è·ç¦»ç°åœ¨æœ€è¿‘çš„ä¸€ä¸ªæœ‰æ•ˆå¿«ç…§ã€‚ä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–ï¼Œå¦‚æœæœ‰ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨ä¿®æ”¹è¯¥æ•°æ®è¡Œï¼Œé‚£ä¹ˆå®ƒå¯ä»¥è¯»å–äº‹åŠ¡æœ¬èº«æ‰€åšçš„ä¿®æ”¹ï¼Œè€Œä¸ç”¨å’Œå…¶å®ƒäº‹åŠ¡çš„è¯»å–ç»“æœä¸€è‡´ã€‚</p><p>æŠŠæ²¡æœ‰å¯¹ä¸€ä¸ªæ•°æ®è¡Œåšä¿®æ”¹çš„äº‹åŠ¡ç§°ä¸º Tï¼ŒT æ‰€è¦è¯»å–çš„æ•°æ®è¡Œå¿«ç…§çš„åˆ›å»ºç‰ˆæœ¬å·å¿…é¡»å°äº T çš„ç‰ˆæœ¬å·ï¼Œå› ä¸ºå¦‚æœå¤§äºæˆ–è€…ç­‰äº T çš„ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆè¡¨ç¤ºè¯¥æ•°æ®è¡Œå¿«ç…§æ˜¯å…¶å®ƒäº‹åŠ¡çš„æœ€æ–°ä¿®æ”¹ï¼Œå› æ­¤ä¸èƒ½å»è¯»å–å®ƒã€‚</p><p>é™¤äº†ä¸Šé¢çš„è¦æ±‚ï¼ŒT æ‰€è¦è¯»å–çš„æ•°æ®è¡Œå¿«ç…§çš„åˆ é™¤ç‰ˆæœ¬å·å¿…é¡»å¤§äº T çš„ç‰ˆæœ¬å·ï¼Œå› ä¸ºå¦‚æœå°äºç­‰äº T çš„ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆè¡¨ç¤ºè¯¥æ•°æ®è¡Œå¿«ç…§æ˜¯å·²ç»è¢«åˆ é™¤çš„ï¼Œä¸åº”è¯¥å»è¯»å–å®ƒã€‚</p><h3 id="2-INSERT"><a href="#2-INSERT" class="headerlink" title="2. INSERT"></a>2. INSERT</h3><p>å°†å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºæ•°æ®è¡Œå¿«ç…§çš„åˆ›å»ºç‰ˆæœ¬å·ã€‚</p><h3 id="3-DELETE"><a href="#3-DELETE" class="headerlink" title="3. DELETE"></a>3. DELETE</h3><p>å°†å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºæ•°æ®è¡Œå¿«ç…§çš„åˆ é™¤ç‰ˆæœ¬å·ã€‚</p><h3 id="4-UPDATE"><a href="#4-UPDATE" class="headerlink" title="4. UPDATE"></a>4. UPDATE</h3><p>å°†å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºæ›´æ–°åçš„æ•°æ®è¡Œå¿«ç…§çš„åˆ›å»ºç‰ˆæœ¬å·ï¼ŒåŒæ—¶å°†å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºæ›´æ–°å‰çš„æ•°æ®è¡Œå¿«ç…§çš„åˆ é™¤ç‰ˆæœ¬å·ã€‚å¯ä»¥ç†è§£ä¸ºå…ˆæ‰§è¡Œ DELETE åæ‰§è¡Œ INSERTã€‚</p><h2 id="å¿«ç…§è¯»ä¸å½“å‰è¯»"><a href="#å¿«ç…§è¯»ä¸å½“å‰è¯»" class="headerlink" title="å¿«ç…§è¯»ä¸å½“å‰è¯»"></a>å¿«ç…§è¯»ä¸å½“å‰è¯»</h2><h3 id="1-å¿«ç…§è¯»"><a href="#1-å¿«ç…§è¯»" class="headerlink" title="1. å¿«ç…§è¯»"></a>1. å¿«ç…§è¯»</h3><p>ä½¿ç”¨ MVCC è¯»å–çš„æ˜¯å¿«ç…§ä¸­çš„æ•°æ®ï¼Œè¿™æ ·å¯ä»¥å‡å°‘åŠ é”æ‰€å¸¦æ¥çš„å¼€é”€ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> ...;</span><br></pre></td></tr></table></figure><h3 id="2-å½“å‰è¯»"><a href="#2-å½“å‰è¯»" class="headerlink" title="2. å½“å‰è¯»"></a>2. å½“å‰è¯»</h3><p>è¯»å–çš„æ˜¯æœ€æ–°çš„æ•°æ®ï¼Œéœ€è¦åŠ é”ã€‚ä»¥ä¸‹ç¬¬ä¸€ä¸ªè¯­å¥éœ€è¦åŠ  S é”ï¼Œå…¶å®ƒéƒ½éœ€è¦åŠ  X é”ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> ? <span class="keyword">lock</span> <span class="keyword">in</span> <span class="keyword">share</span> <span class="keyword">mode</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> ? <span class="keyword">for</span> <span class="keyword">update</span>;</span><br><span class="line"><span class="keyword">insert</span>;</span><br><span class="line"><span class="keyword">update</span>;</span><br><span class="line"><span class="keyword">delete</span>;</span><br></pre></td></tr></table></figure><h1 id="å…­ã€Next-Key-Locks"><a href="#å…­ã€Next-Key-Locks" class="headerlink" title="å…­ã€Next-Key Locks"></a>å…­ã€Next-Key Locks</h1><p>Next-Key Locks ä¹Ÿæ˜¯ MySQL çš„ InnoDB å­˜å‚¨å¼•æ“çš„ä¸€ç§é”å®ç°ã€‚MVCC ä¸èƒ½è§£å†³å¹»è¯»çš„é—®é¢˜ï¼ŒNext-Key Locks å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œå­˜åœ¨çš„ã€‚åœ¨å¯é‡å¤è¯»ï¼ˆREPEATABLE READï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œä½¿ç”¨ MVCC + Next-Key Locks å¯ä»¥è§£å†³å¹»è¯»é—®é¢˜ã€‚</p><h2 id="Record-Locks"><a href="#Record-Locks" class="headerlink" title="Record Locks"></a>Record Locks</h2><p>é”å®šæ•´ä¸ªè®°å½•ï¼ˆè¡Œï¼‰ã€‚é”å®šçš„å¯¹è±¡æ˜¯è®°å½•çš„ç´¢å¼•ï¼Œè€Œä¸æ˜¯è®°å½•æœ¬èº«ã€‚å¦‚æœè¡¨æ²¡æœ‰è®¾ç½®ç´¢å¼•ï¼ŒInnoDB ä¼šè‡ªåŠ¨åœ¨ä¸»é”®ä¸Šåˆ›å»ºéšè—çš„èšé›†ç´¢å¼•ï¼Œå› æ­¤ Record Locks ä¾ç„¶å¯ä»¥ä½¿ç”¨ã€‚</p><h2 id="Grap-Locks"><a href="#Grap-Locks" class="headerlink" title="Grap Locks"></a>Grap Locks</h2><p>é”å®šä¸€ä¸ªèŒƒå›´å†…çš„ç´¢å¼•ï¼Œä¾‹å¦‚å½“ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼Œå…¶å®ƒäº‹åŠ¡å°±ä¸èƒ½åœ¨ t.c ä¸­æ’å…¥ 15ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c <span class="keyword">FROM</span> t <span class="keyword">WHERE</span> c <span class="keyword">BETWEEN</span> <span class="number">10</span> <span class="keyword">and</span> <span class="number">20</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure><h2 id="Next-Key-Locks"><a href="#Next-Key-Locks" class="headerlink" title="Next-Key Locks"></a>Next-Key Locks</h2><p>å®ƒæ˜¯ Record Locks å’Œ Gap Locks çš„ç»“åˆï¼Œä¸ä»…é”å®šä¸€ä¸ªè®°å½•ï¼Œä¹Ÿé”å®šèŒƒå›´å†…çš„ç´¢å¼•ã€‚åœ¨ user ä¸­æœ‰ä»¥ä¸‹è®°å½•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">|   id | last_name   | first_name   |   age |</span><br><span class="line">|<span class="comment">------|-------------|--------------|-------|</span></span><br><span class="line">|    4 | stark       | tony         |    21 |</span><br><span class="line">|    1 | tom         | hiddleston   |    30 |</span><br><span class="line">|    3 | morgan      | freeman      |    40 |</span><br><span class="line">|    5 | jeff        | dean         |    50 |</span><br><span class="line">|    2 | donald      | trump        |    80 |</span><br><span class="line">+<span class="comment">------|-------------|--------------|-------+</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå°±éœ€è¦é”å®šä»¥ä¸‹èŒƒå›´ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(-âˆ, 21]</span><br><span class="line">(21, 30]</span><br><span class="line">(30, 40]</span><br><span class="line">(40, 50]</span><br><span class="line">(50, 80]</span><br><span class="line">(80, âˆ)</span><br></pre></td></tr></table></figure><h1 id="ä¸ƒã€å…³ç³»æ•°æ®åº“è®¾è®¡ç†è®º"><a href="#ä¸ƒã€å…³ç³»æ•°æ®åº“è®¾è®¡ç†è®º" class="headerlink" title="ä¸ƒã€å…³ç³»æ•°æ®åº“è®¾è®¡ç†è®º"></a>ä¸ƒã€å…³ç³»æ•°æ®åº“è®¾è®¡ç†è®º</h1><h2 id="å‡½æ•°ä¾èµ–"><a href="#å‡½æ•°ä¾èµ–" class="headerlink" title="å‡½æ•°ä¾èµ–"></a>å‡½æ•°ä¾èµ–</h2><p>è®° A-&gt;B è¡¨ç¤º A å‡½æ•°å†³å®š Bï¼Œä¹Ÿå¯ä»¥è¯´ B å‡½æ•°ä¾èµ–äº Aã€‚</p><p>å¦‚æœ {A1ï¼ŒA2ï¼Œâ€¦ ï¼ŒAn} æ˜¯å…³ç³»çš„ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§çš„é›†åˆï¼Œè¯¥é›†åˆå‡½æ•°å†³å®šäº†å…³ç³»çš„å…¶å®ƒæ‰€æœ‰å±æ€§å¹¶ä¸”æ˜¯æœ€å°çš„ï¼Œé‚£ä¹ˆè¯¥é›†åˆå°±ç§°ä¸ºé”®ç ã€‚</p><p>å¯¹äº A-&gt;Bï¼Œå¦‚æœèƒ½æ‰¾åˆ° A çš„çœŸå­é›† Aâ€™ï¼Œä½¿å¾— Aâ€™-&gt; Bï¼Œé‚£ä¹ˆ A-&gt;B å°±æ˜¯éƒ¨åˆ†å‡½æ•°ä¾èµ–ï¼Œå¦åˆ™å°±æ˜¯å®Œå…¨å‡½æ•°ä¾èµ–ï¼›</p><p>å¯¹äº A-&gt;Bï¼ŒB-&gt;Cï¼Œåˆ™ A-&gt;C æ˜¯ä¸€ä¸ªä¼ é€’å‡½æ•°ä¾èµ–ã€‚</p><h2 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h2><p>ä»¥ä¸‹çš„å­¦ç”Ÿè¯¾ç¨‹å…³ç³»çš„å‡½æ•°ä¾èµ–ä¸º Sno, Cname -&gt; Sname, Sdept, Mname, Gradeï¼Œé”®ç ä¸º {Sno, Cname}ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¡®å®šå­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹åï¼Œå°±èƒ½ç¡®å®šå…¶å®ƒä¿¡æ¯ã€‚</p><table><thead><tr><th style="text-align:center">Sno</th><th style="text-align:center">Sname</th><th style="text-align:center">Sdept</th><th style="text-align:center">Mname</th><th style="text-align:center">Cname</th><th style="text-align:center">Grade</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">å­¦ç”Ÿ-1</td><td style="text-align:center">å­¦é™¢-1</td><td style="text-align:center">é™¢é•¿-1</td><td style="text-align:center">è¯¾ç¨‹-1</td><td style="text-align:center">90</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">å­¦ç”Ÿ-2</td><td style="text-align:center">å­¦é™¢-2</td><td style="text-align:center">é™¢é•¿-2</td><td style="text-align:center">è¯¾ç¨‹-2</td><td style="text-align:center">80</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">å­¦ç”Ÿ-2</td><td style="text-align:center">å­¦é™¢-2</td><td style="text-align:center">é™¢é•¿-2</td><td style="text-align:center">è¯¾ç¨‹-1</td><td style="text-align:center">100</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">å­¦ç”Ÿ-3</td><td style="text-align:center">å­¦é™¢-2</td><td style="text-align:center">é™¢é•¿-2</td><td style="text-align:center">è¯¾ç¨‹-2</td><td style="text-align:center">95</td></tr></tbody></table><p>ä¸ç¬¦åˆèŒƒå¼çš„å…³ç³»ï¼Œä¼šäº§ç”Ÿå¾ˆå¤šå¼‚å¸¸ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å››ç§å¼‚å¸¸ï¼š</p><ul><li>å†—ä½™æ•°æ®ï¼šä¾‹å¦‚ å­¦ç”Ÿ-2 å‡ºç°äº†ä¸¤æ¬¡ã€‚</li><li>ä¿®æ”¹å¼‚å¸¸ï¼šä¿®æ”¹äº†ä¸€ä¸ªè®°å½•ä¸­çš„ä¿¡æ¯ï¼Œä½†æ˜¯å¦ä¸€ä¸ªè®°å½•ä¸­ç›¸åŒçš„ä¿¡æ¯å´æ²¡æœ‰è¢«ä¿®æ”¹ã€‚</li><li>åˆ é™¤å¼‚å¸¸ï¼šåˆ é™¤ä¸€ä¸ªä¿¡æ¯ï¼Œé‚£ä¹ˆä¹Ÿä¼šä¸¢å¤±å…¶å®ƒä¿¡æ¯ã€‚ä¾‹å¦‚å¦‚æœåˆ é™¤äº† è¯¾ç¨‹-1ï¼Œéœ€è¦åˆ é™¤ç¬¬ä¸€è¡Œå’Œç¬¬ä¸‰è¡Œï¼Œé‚£ä¹ˆ å­¦ç”Ÿ-1 çš„ä¿¡æ¯å°±ä¼šä¸¢å¤±ã€‚</li><li>æ’å…¥å¼‚å¸¸ï¼Œä¾‹å¦‚æƒ³è¦æ’å…¥ä¸€ä¸ªå­¦ç”Ÿçš„ä¿¡æ¯ï¼Œå¦‚æœè¿™ä¸ªå­¦ç”Ÿè¿˜æ²¡é€‰è¯¾ï¼Œé‚£ä¹ˆå°±æ— æ³•æ’å…¥ã€‚</li></ul><h2 id="èŒƒå¼"><a href="#èŒƒå¼" class="headerlink" title="èŒƒå¼"></a>èŒƒå¼</h2><p>èŒƒå¼ç†è®ºæ˜¯ä¸ºäº†è§£å†³ä»¥ä¸Šæåˆ°å››ç§å¼‚å¸¸ã€‚</p><p>é«˜çº§åˆ«èŒƒå¼çš„ä¾èµ–äºä½çº§åˆ«çš„èŒƒå¼ï¼Œ1NF æ˜¯æœ€ä½çº§åˆ«çš„èŒƒå¼ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061814.png" width="300"> </div><br></p><h3 id="1-ç¬¬ä¸€èŒƒå¼-1NF"><a href="#1-ç¬¬ä¸€èŒƒå¼-1NF" class="headerlink" title="1. ç¬¬ä¸€èŒƒå¼ (1NF)"></a>1. ç¬¬ä¸€èŒƒå¼ (1NF)</h3><p>å±æ€§ä¸å¯åˆ†ï¼›</p><h3 id="2-ç¬¬äºŒèŒƒå¼-2NF"><a href="#2-ç¬¬äºŒèŒƒå¼-2NF" class="headerlink" title="2. ç¬¬äºŒèŒƒå¼ (2NF)"></a>2. ç¬¬äºŒèŒƒå¼ (2NF)</h3><p>æ¯ä¸ªéä¸»å±æ€§å®Œå…¨å‡½æ•°ä¾èµ–äºé”®ç ã€‚</p><p>å¯ä»¥é€šè¿‡åˆ†è§£æ¥æ»¡è¶³ã€‚</p><p><font size="4"> <strong>åˆ†è§£å‰</strong> </font><br></p><table><thead><tr><th style="text-align:center">Sno</th><th style="text-align:center">Sname</th><th style="text-align:center">Sdept</th><th style="text-align:center">Mname</th><th style="text-align:center">Cname</th><th style="text-align:center">Grade</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">å­¦ç”Ÿ-1</td><td style="text-align:center">å­¦é™¢-1</td><td style="text-align:center">é™¢é•¿-1</td><td style="text-align:center">è¯¾ç¨‹-1</td><td style="text-align:center">90</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">å­¦ç”Ÿ-2</td><td style="text-align:center">å­¦é™¢-2</td><td style="text-align:center">é™¢é•¿-2</td><td style="text-align:center">è¯¾ç¨‹-2</td><td style="text-align:center">80</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">å­¦ç”Ÿ-2</td><td style="text-align:center">å­¦é™¢-2</td><td style="text-align:center">é™¢é•¿-2</td><td style="text-align:center">è¯¾ç¨‹-1</td><td style="text-align:center">100</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">å­¦ç”Ÿ-3</td><td style="text-align:center">å­¦é™¢-2</td><td style="text-align:center">é™¢é•¿-2</td><td style="text-align:center">è¯¾ç¨‹-2</td><td style="text-align:center">95</td></tr></tbody></table><p>ä»¥ä¸Šå­¦ç”Ÿè¯¾ç¨‹å…³ç³»ä¸­ï¼Œ{Sno, Cname} ä¸ºé”®ç ï¼Œæœ‰å¦‚ä¸‹å‡½æ•°ä¾èµ–ï¼š</p><ul><li>Sno -&gt; Sname, Sdept</li><li>Sdept -&gt; Mname</li><li>Sno, Cname-&gt; Grade</li></ul><p>Grade å®Œå…¨å‡½æ•°ä¾èµ–äºé”®ç ï¼Œå®ƒæ²¡æœ‰ä»»ä½•å†—ä½™æ•°æ®ï¼Œæ¯ä¸ªå­¦ç”Ÿçš„æ¯é—¨è¯¾éƒ½æœ‰ç‰¹å®šçš„æˆç»©ã€‚</p><p>Sname, Sdept å’Œ Mname éƒ½éƒ¨åˆ†ä¾èµ–äºé”®ç ï¼Œå½“ä¸€ä¸ªå­¦ç”Ÿé€‰ä¿®äº†å¤šé—¨è¯¾æ—¶ï¼Œè¿™äº›æ•°æ®å°±ä¼šå‡ºç°å¤šæ¬¡ï¼Œé€ æˆå¤§é‡å†—ä½™æ•°æ®ã€‚</p><p><font size="4"> <strong>åˆ†è§£å</strong> </font><br></p><p>å…³ç³»-1</p><table><thead><tr><th style="text-align:center">Sno</th><th style="text-align:center">Sname</th><th style="text-align:center">Sdept</th><th style="text-align:center">Mname</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">å­¦ç”Ÿ-1</td><td style="text-align:center">å­¦é™¢-1</td><td style="text-align:center">é™¢é•¿-1</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">å­¦ç”Ÿ-2</td><td style="text-align:center">å­¦é™¢-2</td><td style="text-align:center">é™¢é•¿-2</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">å­¦ç”Ÿ-3</td><td style="text-align:center">å­¦é™¢-2</td><td style="text-align:center">é™¢é•¿-2</td></tr></tbody></table><p>æœ‰ä»¥ä¸‹å‡½æ•°ä¾èµ–ï¼š</p><ul><li>Sno -&gt; Sname, Sdept, Mname</li><li>Sdept -&gt; Mname</li></ul><p>å…³ç³»-2</p><table><thead><tr><th style="text-align:center">Sno</th><th style="text-align:center">Cname</th><th style="text-align:center">Grade</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">è¯¾ç¨‹-1</td><td style="text-align:center">90</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">è¯¾ç¨‹-2</td><td style="text-align:center">80</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">è¯¾ç¨‹-1</td><td style="text-align:center">100</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">è¯¾ç¨‹-2</td><td style="text-align:center">95</td></tr></tbody></table><p>æœ‰ä»¥ä¸‹å‡½æ•°ä¾èµ–ï¼š</p><ul><li>Sno, Cname -&gt;  Grade</li></ul><h3 id="3-ç¬¬ä¸‰èŒƒå¼-3NF"><a href="#3-ç¬¬ä¸‰èŒƒå¼-3NF" class="headerlink" title="3. ç¬¬ä¸‰èŒƒå¼ (3NF)"></a>3. ç¬¬ä¸‰èŒƒå¼ (3NF)</h3><p>éä¸»å±æ€§ä¸ä¼ é€’å‡½æ•°ä¾èµ–äºé”®ç ã€‚</p><p>ä¸Šé¢çš„ å…³ç³»-1 ä¸­å­˜åœ¨ä»¥ä¸‹ä¼ é€’å‡½æ•°ä¾èµ–ï¼šSno -&gt; Sdept -&gt; Mnameï¼Œå¯ä»¥è¿›è¡Œä»¥ä¸‹åˆ†è§£ï¼š</p><p>å…³ç³»-11</p><table><thead><tr><th style="text-align:center">Sno</th><th style="text-align:center">Sname</th><th style="text-align:center">Sdept</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">å­¦ç”Ÿ-1</td><td style="text-align:center">å­¦é™¢-1</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">å­¦ç”Ÿ-2</td><td style="text-align:center">å­¦é™¢-2</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">å­¦ç”Ÿ-3</td><td style="text-align:center">å­¦é™¢-2</td></tr></tbody></table><p>å…³ç³»-12</p><table><thead><tr><th style="text-align:center">Sdept</th><th style="text-align:center">Mname</th></tr></thead><tbody><tr><td style="text-align:center">å­¦é™¢-1</td><td style="text-align:center">é™¢é•¿-1</td></tr><tr><td style="text-align:center">å­¦é™¢-2</td><td style="text-align:center">é™¢é•¿-2</td></tr></tbody></table><h1 id="å…«ã€ER-å›¾"><a href="#å…«ã€ER-å›¾" class="headerlink" title="å…«ã€ER å›¾"></a>å…«ã€ER å›¾</h1><p>Entity-Relationshipï¼Œæœ‰ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ï¼šå®ä½“ã€å±æ€§ã€è”ç³»ã€‚</p><p>ç”¨æ¥è¿›è¡Œå…³ç³»å‹æ•°æ®åº“ç³»ç»Ÿçš„æ¦‚å¿µè®¾è®¡ã€‚</p><h2 id="å®ä½“çš„ä¸‰ç§è”ç³»"><a href="#å®ä½“çš„ä¸‰ç§è”ç³»" class="headerlink" title="å®ä½“çš„ä¸‰ç§è”ç³»"></a>å®ä½“çš„ä¸‰ç§è”ç³»</h2><p>åŒ…å«ä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹å¤šä¸‰ç§ã€‚</p><p>å¦‚æœ A åˆ° B æ˜¯ä¸€å¯¹å¤šå…³ç³»ï¼Œé‚£ä¹ˆç”»ä¸ªå¸¦ç®­å¤´çš„çº¿æ®µæŒ‡å‘ Bï¼›å¦‚æœæ˜¯ä¸€å¯¹ä¸€ï¼Œç”»ä¸¤ä¸ªå¸¦ç®­å¤´çš„çº¿æ®µï¼›å¦‚æœæ˜¯å¤šå¯¹å¤šï¼Œç”»ä¸¤ä¸ªä¸å¸¦ç®­å¤´çš„çº¿æ®µã€‚ä¸‹å›¾çš„ Course å’Œ Student æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061821.jpg" width=""> </div><br></p><h2 id="è¡¨ç¤ºå‡ºç°å¤šæ¬¡çš„å…³ç³»"><a href="#è¡¨ç¤ºå‡ºç°å¤šæ¬¡çš„å…³ç³»" class="headerlink" title="è¡¨ç¤ºå‡ºç°å¤šæ¬¡çš„å…³ç³»"></a>è¡¨ç¤ºå‡ºç°å¤šæ¬¡çš„å…³ç³»</h2><p>ä¸€ä¸ªå®ä½“åœ¨è”ç³»å‡ºç°å‡ æ¬¡ï¼Œå°±è¦ç”¨å‡ æ¡çº¿è¿æ¥ã€‚ä¸‹å›¾è¡¨ç¤ºä¸€ä¸ªè¯¾ç¨‹çš„å…ˆä¿®å…³ç³»ï¼Œå…ˆä¿®å…³ç³»å‡ºç°ä¸¤ä¸ª Course å®ä½“ï¼Œç¬¬ä¸€ä¸ªæ˜¯å…ˆä¿®è¯¾ç¨‹ï¼Œåä¸€ä¸ªæ˜¯åä¿®è¯¾ç¨‹ï¼Œå› æ­¤éœ€è¦ç”¨ä¸¤æ¡çº¿æ¥è¡¨ç¤ºè¿™ç§å…³ç³»ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061824.jpg" width=""> </div><br></p><h2 id="è”ç³»çš„å¤šå‘æ€§"><a href="#è”ç³»çš„å¤šå‘æ€§" class="headerlink" title="è”ç³»çš„å¤šå‘æ€§"></a>è”ç³»çš„å¤šå‘æ€§</h2><p>è™½ç„¶è€å¸ˆå¯ä»¥å¼€è®¾å¤šé—¨è¯¾ï¼Œå¹¶ä¸”å¯ä»¥æ•™æˆå¤šåå­¦ç”Ÿï¼Œä½†æ˜¯å¯¹äºç‰¹å®šçš„å­¦ç”Ÿå’Œè¯¾ç¨‹ï¼Œåªæœ‰ä¸€ä¸ªè€å¸ˆæ•™æˆï¼Œè¿™å°±æ„æˆäº†ä¸€ä¸ªä¸‰å…ƒè”ç³»ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061830.png" width=""> </div><br></p><p>ä¸€èˆ¬åªä½¿ç”¨äºŒå…ƒè”ç³»ï¼Œå¯ä»¥æŠŠå¤šå…ƒå…³ç³»è½¬æ¢ä¸ºäºŒå…ƒå…³ç³»ã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061834.png" width=""> </div><br></p><h2 id="è¡¨ç¤ºå­ç±»"><a href="#è¡¨ç¤ºå­ç±»" class="headerlink" title="è¡¨ç¤ºå­ç±»"></a>è¡¨ç¤ºå­ç±»</h2><p>ç”¨ä¸€ä¸ªä¸‰è§’å½¢å’Œä¸¤æ¡çº¿æ¥è¿æ¥ç±»å’Œå­ç±»ï¼Œä¸å­ç±»æœ‰å…³çš„å±æ€§å’Œè”ç³»éƒ½è¿åˆ°å­ç±»ä¸Šï¼Œè€Œä¸çˆ¶ç±»å’Œå­ç±»éƒ½æœ‰å…³çš„è¿åˆ°çˆ¶ç±»ä¸Šã€‚</p><p><div align="center"> <img src="http://p6i5vzkfk.bkt.clouddn.com/study/2018-07-09-061838.jpg" width=""> </div><br></p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>AbrahamSilberschatz, HenryF.Korth, S.Sudarshan, ç­‰. æ•°æ®åº“ç³»ç»Ÿæ¦‚å¿µ [M]. æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾, 2006.</li><li>æ–½ç“¦èŒ¨. é«˜æ€§èƒ½ MYSQL(ç¬¬3ç‰ˆ)[M]. ç”µå­å·¥ä¸šå‡ºç‰ˆç¤¾, 2013.</li><li>å²å˜‰æƒ. æ•°æ®åº“ç³»ç»Ÿæ¦‚è®º[M]. æ¸…åå¤§å­¦å‡ºç‰ˆç¤¾æœ‰é™å…¬å¸, 2006.</li><li><a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-storage-engine.html" target="_blank" rel="noopener">The InnoDB Storage Engine</a></li><li><a href="https://www.slideshare.net/ErnestoHernandezRodriguez/transaction-isolation-levels" target="_blank" rel="noopener">Transaction isolation levels</a></li><li><a href="http://scanftree.com/dbms/2-phase-locking-protocol" target="_blank" rel="noopener">Concurrency Control</a></li><li><a href="https://www.slideshare.net/brshristov/the-nightmare-of-locking-blocking-and-isolation-levels-46391666" target="_blank" rel="noopener">The Nightmare of Locking, Blocking and Isolation Levels!</a></li><li><a href="https://aksakalli.github.io/2012/03/12/database-normalization-and-normal-forms-with-an-example.html" target="_blank" rel="noopener">Database Normalization and Normal Forms with an Example</a></li><li><a href="https://blog.jcole.us/2014/04/16/the-basics-of-the-innodb-undo-logging-and-history-system/" target="_blank" rel="noopener">The basics of the InnoDB undo logging and history system</a></li><li><a href="https://www.brightbox.com/blog/2013/10/31/on-mysql-locks/" target="_blank" rel="noopener">MySQL locking for the busy web developer</a></li><li><a href="https://draveness.me/mysql-innodb" target="_blank" rel="noopener">æµ…å…¥æµ…å‡º MySQL å’Œ InnoDB</a></li><li><a href="https://tech.meituan.com/innodb-lock.html" target="_blank" rel="noopener">Innodb ä¸­çš„äº‹åŠ¡éš”ç¦»çº§åˆ«å’Œé”çš„å…³ç³»</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- GFM-TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸€äº‹åŠ¡&quot;&gt;ä¸€ã€äº‹åŠ¡&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#æ¦‚å¿µ&quot;&gt;æ¦‚å¿µ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#acid&quot;&gt;ACID&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#autocomm
      
    
    </summary>
    
      <category term="Github" scheme="https://airpoet.github.io/categories/Github/"/>
    
      <category term="Interview-Notebook" scheme="https://airpoet.github.io/categories/Github/Interview-Notebook/"/>
    
    
      <category term="æŠ€æœ¯" scheme="https://airpoet.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="https://airpoet.github.io/tags/Java/"/>
    
      <category term="è½¬è½½" scheme="https://airpoet.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
</feed>
