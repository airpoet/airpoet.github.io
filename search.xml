<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Redis]]></title>
    <url>%2F2018%2F07%2F03%2FHadoop%2F8_Redis%2FRedis%2F</url>
    <content type="text"><![CDATA[1.å®‰è£…1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192931. ä¸‹è½½2. tar3. cd redis-3.xxxx/deps4. make geohash-int hiredis jemalloc linenoise lua-----------------5. cd .. é€€å›žåˆ° redis æ ¹ç›®å½•$redis-3.xxxx&gt; make test ç­‰å¾…å‡ åˆ†é’Ÿ, ç­‰å¾…ç¼–è¯‘å®Œæˆä¼šå‡ºçŽ° `ç¼–è¯‘å®Œæˆæ²¡æœ‰é”™è¯¯`çš„è‹±æ–‡... ç„¶åŽç›´æŽ¥ make 6. æŽ¥ä¸‹æ¥å°±æ˜¯æ‰§è¡Œ make install å®‰è£…äº†å¯åŠ¨ç­‰è„šæœ¬äº† é»˜è®¤ä¼šè‡ªåŠ¨å®‰è£…åˆ° /usr/local/binmake åŽé¢è·Ÿä¸Š PREFIX=path å¯ä»¥è‡ªå·±æŒ‡å®šå®‰è£…è·¯å¾„è¿™é‡Œå®‰è£…åˆ° ~/apps/ ä¸‹çš„ redis ç›®å½•ä¸­$&gt; sudo make PREFIX=/home/ap/apps/redis install7. # å¤åˆ¶é…ç½®æ–‡ä»¶åˆ°rediså®‰è£…ç›®å½•$redis-3.xxxx&gt; sudo cp redis.conf /home/ap/apps/redis&gt; vi redis.conf-------------------------# ä¿®æ”¹ redis-server åŽå°å¯åŠ¨(ä¹Ÿå¯ä»¥ä¸é…, ç”¨ nohupçš„æ–¹å¼åŽå°å¯åŠ¨)daemonize yes# ä¿®æ”¹ protected-mode ä¸º noprotected-mode no# æ³¨é‡ŠæŽ‰ bind æœ¬æœºç«¯å£# bind 127.0.0.1 ::1# é…ç½®çŽ¯å¢ƒå˜é‡export REDIS_HOME=/home/ap/apps/redisexport PATH=$PATH:$REDIS_HOME/bin# æŠŠçŽ¯å¢ƒå˜é‡ .zshrc å’Œ å­˜æœ‰ sh å‘½ä»¤çš„ redis å®‰è£…ç›®å½•å‘é€åˆ°å…¶å®ƒæœºå™¨# source è¦ä½¿ç”¨æœºå™¨çš„ .zshrcé…ç½®8. ï£¿ï£¿ï£¿ï£¿ å¯åŠ¨è¯•è¯•çœ‹~# å¦‚æžœé…ç½®äº†åŽå°å¯åŠ¨, å¹¶ä¸”åŠ è½½äº†é…ç½®æ–‡ä»¶çš„è¯å°±ä¸ä¼šå‡ºçŽ°ä»¥ä¸‹å›¾å½¢äº† $&gt; redis-server ~/apps/redis/redis.conf ä¹Ÿå¯ä»¥ç›´æŽ¥ $&gt; redis-server è¿™æ ·å°±ä¸ä¼šåŠ è½½é…ç½®æ–‡ä»¶, ä¼šå‡ºçŽ°ä¸‹é¢çš„.. _._ _.-``__ ''-._ _.-`` `. `_. ''-._ Redis 4.0.10 (00000000/0) 64 bit .-`` .-```. ```\/ _.,_ ''-._ ( ' , .-` | `, ) Running in standalone mode |`-._`-...-` __...-.``-._|'` _.-'| Port: 6379 | `-._ `._ / _.-' | PID: 1034 `-._ `-._ `-./ _.-' _.-' |`-._`-._ `-.__.-' _.-'_.-'| | `-._`-._ _.-'_.-' | http://redis.io `-._ `-._`-.__.-'_.-' _.-' |`-._`-._ `-.__.-' _.-'_.-'| | `-._`-._ _.-'_.-' | `-._ `-._`-.__.-'_.-' _.-' `-._ `-.__.-' _.-' `-._ _.-' `-.__.-'å‡ºçŽ°ä¸€ä¸ªè¿™ä¸ªåŠçš„å›¾åƒ, å°±è¯´æ˜Žå¯åŠ¨æˆåŠŸäº†.....# ä¹Ÿå¯ä»¥è¿™æ ·åŽå°å¯åŠ¨, å¸¦ lognohup &lt;sub&gt;/apps/redis/bin/redis-server &lt;/sub&gt;/apps/redis/redis.conf 1&gt;&lt;sub&gt;/logs/redis_log/redis_std.log 2&gt;&lt;/sub&gt;/logs/redis_log/redis_error.log &amp;7ã€å¯åŠ¨å®¢æˆ·ç«¯ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š[hadoop@hadoop02 ~]$ redis-cli# ï£¿ï£¿ï£¿ï£¿ æŸ¥çœ‹æ˜¯å¦æœ‰è¿›ç¨‹ps -ef | grep redis --------[ap@cs1]~% ps -ef | grep redisap 36260 35955 0 14:11 pts/3 00:00:00 redis-server *:6379ap 36287 36267 0 14:11 pts/5 00:00:00 grep redis&gt;&gt; æœ€å¼€å§‹çš„ 36260 å°±æ˜¯ pid9. ï£¿ï£¿ï£¿ è¿žæŽ¥# redis/bin/redis-cli [-h localhost -p 6379 ]# å¦‚æžœæ˜¯æœ¬æœºå¯åŠ¨å®¢æˆ·ç«¯$&gt; redis-cli# å¦‚æžœæ˜¯ä»Žå…¶ä»–èŠ‚ç‚¹ä¸Šé“¾æŽ¥ redisï¼Œé‚£ä¹ˆå¯ä»¥è¿™ä¹ˆåšï¼š$cs2&gt; redis-cli -h cs1 -p 6379cs1:6379&gt; pingPONG10. åœæ­¢æœåŠ¡cliç«¯: shutdown save|nosave 2.Redis æ³¨æ„ç‚¹REmote DIctionary Server(Redis)Redis å¸¸è¢«ç§°ä½œæ˜¯ä¸€æ¬¾ key-value å†… å­˜å­˜å‚¨ç³»ç»Ÿæˆ–è€…å†…å­˜æ•°æ®åº“ï¼ŒåŒæ—¶ç”±äºŽå®ƒæ”¯æŒä¸°å¯Œçš„æ•°æ®ç»“æž„ï¼Œåˆè¢«ç§°ä¸ºä¸€ç§æ•°æ®ç»“æž„æœåŠ¡ å™¨ï¼ˆData Structure Serverï¼‰ã€‚ å› ä¸ºå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯å­—ç¬¦ä¸²(String)ï¼Œå“ˆå¸Œ(Map)ï¼Œåˆ—è¡¨(list)ï¼Œ é›†åˆ(sets)å’Œæœ‰åºé›†åˆ(sorted sets)ç­‰ç±»åž‹ã€‚ ä¸Žå…¶ä»– key-value ç¼“å­˜äº§å“æ¯”è¾ƒç‹¬æœ‰ç‰¹ç‚¹1ã€Redis æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿æŒåœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½ è¿›è¡Œä½¿ç”¨ã€‚ 2ã€Redis ä¸ä»…ä»…æ”¯æŒç®€å•çš„ key-value ç±»åž‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾› listï¼Œsetï¼Œzsetï¼Œhash ç­‰æ•°æ® ç»“æž„çš„å­˜å‚¨ã€‚ 3ã€Redis æ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³ master-slave æ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚ Redisä¼˜åŠ¿1ã€æ€§èƒ½æžé«˜ï¼šRedis èƒ½è¯»çš„é€Ÿåº¦æ˜¯ 110000 æ¬¡/sï¼Œå†™çš„é€Ÿåº¦æ˜¯ 81000 æ¬¡/s ã€‚ 2ã€ä¸°å¯Œçš„æ•°æ®ç±»åž‹ï¼šRedis æ”¯æŒäºŒè¿›åˆ¶æ¡ˆä¾‹çš„ String, List, Hash, Set åŠ Sorted Set æ•°æ®ç±»åž‹æ“ ä½œã€‚ 3ã€åŽŸå­æ“ä½œï¼šRedis çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŽŸå­æ€§çš„ï¼ŒåŒæ—¶ Redis è¿˜æ”¯æŒå¯¹å‡ ä¸ªæ“ä½œå…¨å¹¶åŽçš„åŽŸå­ æ€§æ‰§è¡Œã€‚ 4ã€ä¸°å¯Œçš„ç‰¹æ€§ï¼šRedis è¿˜æ”¯æŒ Publish/Subscribeï¼Œé€šçŸ¥ key è¿‡æœŸï¼Œæ”¯æŒé«˜å¯ç”¨é›†ç¾¤ç­‰ç­‰ç‰¹æ€§ã€‚ 5ã€æ•°æ®æŒä¹…åŒ–æœºåˆ¶ æŒä¹…åŒ–æœºåˆ¶æœ‰ä¸¤ç§ï¼š1ã€RDB æ–¹å¼ï¼šå®šæœŸå°†å†…å­˜æ•°æ® dump åˆ°ç£ç›˜ 2ã€AOF(append only file)æŒä¹…åŒ–æœºåˆ¶ï¼šç”¨è®°æ—¥å¿—çš„æ–¹å¼è®°å½•æ¯ä¸€æ¡æ•°æ®æ›´æ–°æ“ä½œï¼Œä¸€æ—¦ å‡ºçŽ°ç¾éš¾äº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡æ—¥å¿—é‡æ”¾æ¥æ¢å¤æ•´ä¸ªæ•°æ®åº“ Redisé€‚ç”¨åœºæ™¯1ã€TopN éœ€æ±‚ï¼šå–æœ€æ–°çš„ n ä¸ªæ•°æ®ï¼Œå¦‚è¯»å–ä½œå®¶åšå®¢æœ€æ–°çš„ 50 ç¯‡æ–‡ç« ï¼Œé€šè¿‡ List å®žçŽ°æŒ‰æ—¶ é—´æŽ’åºçš„æ•°æ®çš„é«˜æ•ˆèŽ·å– 2ã€æŽ’è¡Œæ¦œåº”ç”¨ï¼šä»¥ç‰¹å®šæ¡ä»¶ä¸ºæŽ’åºæ ‡å‡†ï¼Œå°†å…¶è®¾æˆ sorted set çš„ scoreï¼Œè¿›è€Œå®žçŽ°é«˜æ•ˆèŽ·å– 3ã€éœ€è¦ç²¾å‡†è®¾å®šè¿‡æœŸæ—¶é—´çš„åº”ç”¨ï¼šæŠŠ sorted set çš„ score å€¼è®¾ç½®æˆè¿‡æœŸæ—¶é—´çš„æ—¶é—´æˆ³ï¼Œé‚£ä¹ˆ å°±å¯ä»¥ç®€å•åœ°é€šè¿‡è¿‡æœŸæ—¶é—´æŽ’åºï¼Œå®šæ—¶æ¸…é™¤è¿‡æœŸæ•°æ®äº† 4ã€è®¡æ•°å™¨åº”ç”¨ï¼šRedis çš„å‘½ä»¤éƒ½æ˜¯åŽŸå­æ€§çš„ï¼Œå¯ä»¥è½»æ¾åœ°åˆ©ç”¨ INCRï¼ŒDECR å‘½ä»¤æ¥æž„å»ºè®¡æ•° å™¨ç³»ç»Ÿã€‚ 5ã€åŽ»é™¤å¤§é‡æ•°æ®ä¸­çš„é‡å¤æ•°æ®ï¼šå°†æ•°æ®æ”¾å…¥ set ä¸­ï¼Œå°±èƒ½å®žçŽ°å¯¹é‡å¤æ•°æ®çš„æŽ’é™¤ 6ã€æž„å»ºé˜Ÿåˆ—ç³»ç»Ÿï¼šä½¿ç”¨ list å¯ä»¥æž„å»ºé˜Ÿåˆ—ç³»ç»Ÿï¼Œä½¿ç”¨ sorted set ç”šè‡³å¯ä»¥æž„å»ºæœ‰ä¼˜å…ˆçº§çš„é˜Ÿ åˆ—ç³»ç»Ÿã€‚ 7ã€å®žæ—¶ç³»ç»Ÿï¼Œååžƒåœ¾ç³»ç»Ÿï¼šé€šè¿‡ä¸Šé¢è¯´åˆ°çš„ set åŠŸèƒ½ï¼Œä½ å¯ä»¥çŸ¥é“ä¸€ä¸ªç»ˆç«¯ç”¨æˆ·æ˜¯å¦è¿›è¡Œ äº†æŸä¸ªæ“ä½œï¼Œå¯ä»¥æ‰¾åˆ°å…¶æ“ä½œçš„é›†åˆå¹¶è¿›è¡Œåˆ†æžç»Ÿè®¡å¯¹æ¯”ç­‰ã€‚ 8ã€Publish/SubScribe æž„å»ºå®žæ—¶æ¶ˆæ¯ç³»ç»Ÿ 9ã€ç¼“å­˜ï¼ˆä¼šè¯ï¼Œå•†å“åˆ—è¡¨ï¼Œè¯„è®ºåˆ—è¡¨ï¼Œç»å¸¸æŸ¥è¯¢çš„æ•°æ®ç­‰ï¼‰ 3.RedisåŸºæœ¬æ“ä½œå…·ä½“è§æ–‡æ¡£ ä¹Ÿå¯ä»¥æŸ¥è¯¢ç½‘ç«™ 3.1 å­—ç¬¦ä¸²3.1.1 String shellString ç±»åž‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚æ„æ€æ˜¯ Redis çš„ String å¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ã€‚æ¯”å¦‚ jpg å›¾ç‰‡æˆ–è€…åº åˆ—åŒ–çš„å¯¹è±¡ ã€‚ String ç±»åž‹æ˜¯ Redis æœ€åŸºæœ¬çš„æ•°æ®ç±»åž‹ï¼Œä¸€ä¸ªé”®æœ€å¤§èƒ½å­˜å‚¨ 512MBã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243å¦‚æžœç»™å®šäº† NX é€‰é¡¹ï¼Œé‚£ä¹ˆå‘½ä»¤ä»…åœ¨é”® key ä¸å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œæ‰è¿›è¡Œè®¾ç½®æ“ä½œï¼›å¦‚æžœé”® key å·²ç»å­˜ åœ¨ï¼Œé‚£ä¹ˆ SET ... NX å‘½ä»¤ä¸åšåŠ¨ä½œï¼ˆä¸ä¼šè¦†ç›–æ—§å€¼ï¼‰ã€‚===&gt; not existå¦‚æžœç»™å®šäº† XX é€‰é¡¹ï¼Œé‚£ä¹ˆå‘½ä»¤ä»…åœ¨é”® key å·²ç»å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œæ‰è¿›è¡Œè®¾ç½®æ“ä½œï¼›å¦‚æžœé”® key ä¸å­˜ åœ¨ï¼Œé‚£ä¹ˆ SET ... XX å‘½ä»¤ä¸åšåŠ¨ä½œï¼ˆä¸€å®šä¼šè¦†ç›–æ—§å€¼ï¼‰ã€‚# ç®€å•å­˜å–----------------------------------------------------------------------å¤æ‚åº¦ä¸º O(1) ã€‚redis&gt; SET msg "hello world" OKredis&gt; GET msghello world# åˆ é™¤del key1 key2 ... Keyn--------------------------------------------------------------------ä½œç”¨: åˆ é™¤1ä¸ªæˆ–å¤šä¸ªé”®è¿”å›žå€¼: ä¸å­˜åœ¨çš„keyå¿½ç•¥æŽ‰,è¿”å›žçœŸæ­£åˆ é™¤çš„keyçš„æ•°é‡# ç»™key è®¾ç½®æ–°å€¼rename key newkey------------------------------------------------------------------------ä½œç”¨: ç»™keyèµ‹ä¸€ä¸ªæ–°çš„keyåæ³¨:å¦‚æžœnewkeyå·²å­˜åœ¨,åˆ™newkeyçš„åŽŸå€¼è¢«è¦†ç›–# multi å­˜å–----------------------------------------------------------------------# ä¸­é—´çš„åˆ†éš”ç¬¦æ˜¯è‡ªå·±æŒ‡å®šçš„127.0.0.1:6379&gt; mset ss::name "airpoet" ss::age "a8" ss::like "ycy"OK127.0.0.1:6379&gt; mget ss::name ss::age ss::like1) "airpoet"2) "a8"3) "ycy"127.0.0.1:6379&gt; mset ss.age "18" ss.teacher "noone"OK127.0.0.1:6379&gt; mget ss.age ss::age1) "18"2) "a8"# msetnx----------------------------------------------------------------------åªæœ‰åœ¨æ‰€æœ‰ç»™å®šé”®éƒ½ä¸å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œ MSETNX ä¼šä¸ºæ‰€æœ‰ç»™å®šé”®è®¾ç½®å€¼ï¼Œæ•ˆæžœå’ŒåŒæ—¶æ‰§è¡Œå¤šä¸ª SETNX ä¸€æ ·ã€‚å¦‚æžœç»™å®šçš„é”®è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯å­˜åœ¨çš„ ï¼Œé‚£ä¹ˆ MSETNX å°†ä¸æ‰§è¡Œä»»ä½•è®¾ç½®æ“ä½œã€‚redis&gt; MSETNX nx-1 "hello" nx-2 "world" nx-3 "good luck" 1redis&gt; SET ex-key "bad key here"OKredis&gt; MSETNX nx-4 "apple" nx-5 "banana" ex-key "cherry" nx-6 "durian" 0# è®¾ç½®æ–°å€¼å¹¶è¿”å›žæ—§å€¼GETSET key new-value------------------------------------------------------------------------------------# å…ˆè®¾ç½®redis&gt; SET getset-str "i'm old value"OK# è®¾ç½®æ–°çš„å€¼, è¿”å›žæ—§å€¼redis&gt; GETSET getset-str "i'm new value" i'm old value# é‡æ–° get ä¸€ä¸‹, å‘çŽ°å·²æ˜¯æ–°å€¼redis&gt; GET getset-str i'm new value#è¿½åŠ å†…å®¹åˆ°å­—ç¬¦ä¸²æœ«å°¾APPEND key value------------------------------------------------------------------------------------redis&gt; SET myPhone "nokia" OKredis&gt; APPEND myPhone "-1110" (integer) 10redis&gt; GET myPhone "nokia-1110"#è¿”å›žå€¼çš„é•¿åº¦------------------------------------------------------------------------------------redis&gt; SET msg "hello" OK redis&gt; STRLEN msg (integer) 5 redis&gt; APPEND msg " world" (integer) 11 redis&gt; STRLEN msg (integer) 11==========================================================================================# ç´¢å¼•-------------------------------------------------------------------------------------$ å¦‚æžœå­—ç¬¦ä¸²é•¿åº¦ä¸º nä»Žå·¦åˆ°å³&gt;&gt; 0 ~ n-1ä»Žå³åˆ°åš&gt;&gt; -1 ~ -n # èŒƒå›´è®¾ç½®SETRANGE key index value-------------------------------------------------------------------------------------ä»Žç´¢å¼• index å¼€å§‹ï¼Œç”¨ value è¦†å†™(overwrite)ç»™å®šé”® key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ã€‚åªæŽ¥å—æ­£æ•°ç´¢å¼•ã€‚redis&gt; SET msg "hello"OKredis&gt; SETRANGE msg 1 "appy" (integer) 5redis&gt; GET msg "happy"# èŒƒå›´å–å€¼GETRANGE key start end-------------------------------------------------------------------------------------è¿”å›žé”® key å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ä¸­ï¼Œä½äºŽ start å’Œ end ä¸¤ä¸ªç´¢å¼•ä¹‹é—´çš„å†…å®¹(é—­åŒºé—´ï¼Œstart å’Œ end ä¼šè¢«åŒ…æ‹¬ åœ¨å†…)ã€‚å’Œ SETRANGE åªæŽ¥å—æ­£æ•°ç´¢å¼•ä¸åŒï¼Œ GETRANGE çš„ç´¢å¼•å¯ä»¥æ˜¯æ­£æ•°æˆ–è€… è´Ÿæ•°ã€‚redis&gt; SET msg "hello world"OKredis&gt; GETRANGE msg 0 4 "hello"# ä»ŽåŽå¾€å‰å–èŒƒå›´, ä¾ç„¶æ˜¯ä»Žå·¦å¾€å³(ä»Žå‰å¾€åŽ)è¯»çš„redis&gt; GETRANGE msg -5 -1 "world"==========================================================================================# æ•°å­—æ“ä½œ-------------------------------------------------------------------------------------åªè¦å‚¨å­˜åœ¨å­—ç¬¦ä¸²é”®é‡Œé¢çš„å€¼å¯ä»¥è¢«è§£é‡Šä¸º 64 ä½æ•´æ•°ï¼Œæˆ–è€… IEEE-754 æ ‡å‡†çš„ 64 ä½æµ®ç‚¹æ•°ï¼Œé‚£ä¹ˆç”¨æˆ·å°±å¯ä»¥å¯¹è¿™ä¸ªå­—ç¬¦ä¸²é”®æ‰§è¡Œé’ˆå¯¹æ•°å­—å€¼çš„å‘½ä»¤ã€‚ # å¢žåŠ æˆ–è€…å‡å°‘æ•°å­—çš„å€¼ INCRBY, DECRBYå¯å®žçŽ°æ¡ˆä¾‹: è®¡æ•°å™¨(counter), id ç”Ÿæˆå™¨ # é”® num ä¸å­˜åœ¨ï¼Œå‘½ä»¤å…ˆå°† num çš„å€¼åˆå§‹åŒ–ä¸º 0 ,ç„¶åŽå†æ‰§è¡ŒåŠ  100 æ“ä½œ redis&gt; INCRBY num 100 (integer) 100 redis&gt; DECRBY num 50 (integer) 50 # æµ®ç‚¹æ•°çš„è‡ªå¢žå’Œè‡ªå‡INCRBYFLOAT key incrementå‡çš„è¯ ç”¨è´Ÿæ•°-------------------------------------------------------------------------------------redis&gt; SET num 10OKredis&gt; INCRBYFLOAT num 3.14 "13.14"redis&gt; INCRBYFLOAT num -2.04 "11.1"å³ä½¿å­—ç¬¦ä¸²é”®å‚¨å­˜çš„æ˜¯æ•°å­—å€¼ï¼Œå®ƒä¹Ÿå¯ä»¥æ‰§è¡Œ APPENDã€STRLENã€SETRANGE å’Œ GETRANGEå½“ç”¨æˆ·é’ˆå¯¹ä¸€ä¸ªæ•°å­—å€¼æ‰§è¡Œè¿™äº›å‘½ä»¤çš„æ—¶å€™ï¼ŒRedis ä¼šå…ˆå°†æ•°å­—å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åŽå†æ‰§è¡Œå‘½ä»¤ã€‚ ==========================================================================================# äºŒè¿›åˆ¶çš„æ“ä½œç´¢å¼•æ˜¯ä»Žå³å¾€å·¦é€’å¢ž å…·ä½“æŸ¥çœ‹åº”ç”¨æ¡ˆä¾‹: å®žçŽ°åœ¨çº¿äººæ•°ç»Ÿè®¡åº”ç”¨æ¡ˆä¾‹: ä½¿ç”¨ Redis ç¼“å­˜çƒ­é—¨å›¾ç‰‡(äºŒè¿›åˆ¶)https://app.yinxiang.com/shard/s37/nl/7399077/92dcb5fb-c005-45dc-bcc5-d00863c08f84/==========================================================================================# å‚¨å­˜ä¸­æ–‡æ—¶çš„æ³¨æ„äº‹é¡¹--------------------------------------------ä¸€ä¸ªè‹±æ–‡å­—ç¬¦åªéœ€è¦ä½¿ç”¨ å•ä¸ªå­—èŠ‚æ¥å‚¨å­˜ï¼Œè€Œä¸€ä¸ªä¸­æ–‡å­—ç¬¦å´éœ€è¦ä½¿ç”¨å¤šä¸ªå­— èŠ‚æ¥å‚¨å­˜ã€‚STRLENã€SETRANGE å’Œ GETRANGE éƒ½æ˜¯ä¸ºè‹±æ–‡è®¾ç½®çš„ï¼Œå®ƒä»¬åªä¼šåœ¨å­—ç¬¦ä¸ºå•ä¸ªå­—èŠ‚çš„æƒ…å†µä¸‹æ­£å¸¸ å·¥ä½œï¼Œè€Œä¸€æ—¦æˆ‘ä»¬å‚¨å­˜çš„æ˜¯ç±»ä¼¼ä¸­æ–‡è¿™æ ·çš„å¤šå­—èŠ‚å­—ç¬¦ï¼Œé‚£ä¹ˆè¿™ä¸‰ä¸ªå‘½ä»¤å°±ä¸å†é€‚ç”¨äº†ã€‚# åœ¨ redis-cli ä¸­ä½¿ç”¨ä¸­æ–‡æ—¶ï¼Œå¿…é¡»æ‰“å¼€ --raw é€‰é¡¹ï¼Œæ‰èƒ½æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡$ redis-cli --raw$ redis&gt; SET msg "ä¸–ç•Œä½ å¥½" OK$ redis&gt; GET msg ä¸–ç•Œä½ å¥½# strlen åªèƒ½èŽ·å–å­—èŠ‚$redis&gt; STRLEN msg 12==========================================================================================# ç§»åŠ¨åº“move key db(æ³¨æ„: ä¸€ä¸ªredisè¿›ç¨‹,æ‰“å¼€äº†ä¸æ­¢ä¸€ä¸ªæ•°æ®åº“, é»˜è®¤æ‰“å¼€16ä¸ªæ•°æ®åº“,ä»Ž0åˆ°15ç¼–å·,å¦‚æžœæƒ³æ‰“å¼€æ›´å¤šæ•°æ®åº“,å¯ä»¥ä»Žé…ç½®æ–‡ä»¶ä¿®æ”¹)---------------------------------------------------------------------------redis 127.0.0.1:6379[1]&gt; select 2OKredis 127.0.0.1:6379[2]&gt; keys *(empty list or set)redis 127.0.0.1:6379[2]&gt; select 0OKredis 127.0.0.1:6379&gt; keys *1) "name"2) "cc"3) "a"4) "b"# ç§»åŠ¨key åˆ°å…¶å®ƒçš„åº“redis 127.0.0.1:6379&gt; move cc 2(integer) 1redis 127.0.0.1:6379&gt; select 2OKredis 127.0.0.1:6379[2]&gt; keys *1) "cc"redis 127.0.0.1:6379[2]&gt; get cc"3"ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿# æ’å…¥å’Œè¯»å–ä¸€æ¡ String ç±»åž‹çš„æ•°æ®127.0.0.1:6379&gt; set name huangboOK127.0.0.1:6379&gt; get name"huangbo"127.0.0.1:6379&gt;------------------------#å¯¹ string ç±»åž‹æ•°æ®è¿›è¡Œå¢žå‡ï¼ˆå‰ææ˜¯è¿™æ¡æ•°æ®çš„ value å¯ä»¥çœ‹æˆæ•°å­—ï¼‰127.0.0.1:6379&gt; set number 10OK127.0.0.1:6379&gt; incr number(integer) 11127.0.0.1:6379&gt; decr number(integer) 10127.0.0.1:6379&gt; incrby number 10(integer) 20127.0.0.1:6379&gt; decrby number 5(integer) 15------------------------# ä¸€æ¬¡æ€§æ’å…¥æˆ–è€…èŽ·å–å¤šæ¡æ•°æ®127.0.0.1:6379&gt; mset name huangbo age 18 facevalue 99OK127.0.0.1:6379&gt; mget name age facevalue1) "huangbo"2) "18"3) "99"------------------------# åœ¨æ’å…¥ä¸€æ¡ string ç±»åž‹æ•°æ®çš„åŒæ—¶ä¸ºå®ƒæŒ‡å®šä¸€ä¸ªå­˜æ´»æœŸé™è§£é‡Š: è¡¨ç¤º yu çš„ jiyi åªæœ‰ 7sï¼Œ7s ä¹‹åŽä¼šè‡ªåŠ¨æ¸…é™¤è¿™ä¸ª key-value127.0.0.1:6379&gt; setex yu 7 jiyiOK127.0.0.1:6379&gt; get yu"jiyi"127.0.0.1:6379&gt; get yu(nil) 3.1.2 String ä½¿ç”¨æ¡ˆä¾‹è§ github 3.2 list 3.2.1 Listå¸¸ç”¨æ“ä½œç¤ºä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071# ä»Žå¤´éƒ¨ï¼ˆå·¦è¾¹leftï¼‰æ’å…¥æ•°æ®127.0.0.1:6379&gt; lpush names huangbo xuzheng wangbaoqiang(integer) 3127.0.0.1:6379&gt; lrange names 0 -11) "wangbaoqiang"2) "xuzheng"3) "huangbo"# ä»Žå°¾éƒ¨ï¼ˆå³è¾¹rightï¼‰æ’å…¥æ•°æ®127.0.0.1:6379&gt; rpush names ycy cy y(integer) 6# è¯»å– list ä¸­æŒ‡å®šèŒƒå›´çš„ values ==&gt; å¥½åƒä¸æ”¯æŒè´Ÿæ•°ç´¢å¼• ??==&gt; ç´¢å¼•æ˜¯é—­åŒºé—´127.0.0.1:6379&gt; lrange names 0 -11) "wangbaoqiang"2) "xuzheng"3) "huangbo"4) "ycy"5) "cy"6) "y"127.0.0.1:6379&gt; LRANGE names 0 01) "wangbaoqiang"# ä»Žå¤´éƒ¨(å‰é¢)å¼¹å‡ºä¸€ä¸ªå…ƒç´ 127.0.0.1:6379&gt; lpop names"wangbaoqiang"127.0.0.1:6379&gt; LRANGE names 0 -11) "xuzheng"2) "huangbo"3) "ycy"4) "cy"5) "y"# ä»Žå°¾éƒ¨(æœ€åŽright)å¼¹å‡ºä¸€ä¸ªå…ƒç´ 127.0.0.1:6379&gt; rpop names"y"127.0.0.1:6379&gt; LRANGE names 0 -11) "xuzheng"2) "huangbo"3) "ycy"4) "cy"# ä»Žå‰é¢ list çš„å°¾éƒ¨(right)å¼¹å‡º(pop)ä¸€ä¸ªå…ƒç´  åŽ‹å…¥(push)åˆ° åŽé¢ listçš„ å¤´éƒ¨(left) -----------------------------------127.0.0.1:6379&gt; LRANGE names 0 -11) "xuzheng"2) "huangbo"3) "ycy"4) "cy"127.0.0.1:6379&gt; LRANGE nickname 0 -11) "YangChaoyue"2) "WuXuanyi"3) "MengMeiqi"127.0.0.1:6379&gt; ï£¿ RPOPLPUSH names nickname ï£¿"cy"127.0.0.1:6379&gt; LRANGE nickname 0 -11) "cy"2) "YangChaoyue"3) "WuXuanyi"4) "MengMeiqi"127.0.0.1:6379&gt; LRANGE names 0 -11) "xuzheng"2) "huangbo"3) "ycy"# æ±‚ list çš„é•¿åº¦ 3.2.2 liståº”ç”¨æ¡ˆä¾‹ä»£ç è§ github 3.3 Set é›†åˆ3.3.1 Set çš„ shell ä½¿ç”¨Redis çš„ Set æ˜¯ string ç±»åž‹çš„æ— åºé›†åˆã€‚ é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®žçŽ°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯ O(1)ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384# æ’å…¥ set æ•°æ® &amp; æŸ¥è¯¢ set æ•°æ®127.0.0.1:6379&gt; sadd bigdata hadoop spark hive(integer) 3127.0.0.1:6379&gt; scard bigdata(integer) 3127.0.0.1:6379&gt; smembers bigdata1) "hadoop"2) "spark"3) "hive"# åˆ¤æ–­ä¸€ä¸ªæˆå‘˜æ˜¯å¦å±žäºŽæŸæ¡æŒ‡å®šçš„ set æ•°æ®127.0.0.1:6379&gt; sismember bigdata hbase(integer) 0127.0.0.1:6379&gt; sismember bigdata hive(integer) 1# æ±‚ä¸¤ä¸ª set æ•°æ®çš„å·®é›†$ setdiff [set1] [set2]&gt; åˆ é™¤ set1 ä¸­ set1,set2çš„äº¤é›†, è¿”å›žåˆ é™¤æ“ä½œåŽçš„ set1(å¯¹ set1 çš„çœŸå®žå­˜å‚¨ä¸å½±å“)127.0.0.1:6379&gt; SMEMBERS bigdata1) "hadoop"2) "spark"3) "hive"127.0.0.1:6379&gt; SMEMBERS bigdata21) "hbase"2) "spark"3) "storm"127.0.0.1:6379&gt; sdiff bigdata bigdata21) "hadoop"2) "hive"# å°†ä¸Šé¢2è€…çš„å·®é›†, å­˜å…¥ä¸€ä¸ªæ–°çš„ set127.0.0.1:6379&gt; sdiffstore bigdatadiff bigdata bigdata2(integer) 2127.0.0.1:6379&gt; SMEMBERS bigdatadiff1) "hadoop"2) "hive"# æ±‚äº¤é›† &amp; å­˜å…¥æ–°çš„é›†åˆ127.0.0.1:6379&gt; SMEMBERS bigdata1) "hadoop"2) "spark"3) "hive"127.0.0.1:6379&gt; SMEMBERS bigdata21) "hbase"2) "spark"3) "storm"127.0.0.1:6379&gt; SINTER bigdata bigdata21) "spark"127.0.0.1:6379&gt; SINTERSTORE interdb bigdata bigdata2(integer) 1127.0.0.1:6379&gt; SMEMBERS interdb1) "spark"# æ±‚å¹¶é›† sunion127.0.0.1:6379&gt; SMEMBERS bigdata1) "hadoop"2) "spark"3) "hive"127.0.0.1:6379&gt; SMEMBERS bigdata21) "hbase"2) "spark"3) "storm"# è¿”å›žå¹¶é›†127.0.0.1:6379&gt; sunion bigdata bigdata21) "hadoop"2) "spark"3) "hive"4) "storm"5) "hbase"# å­˜å‚¨å¹¶é›†127.0.0.1:6379&gt; SUNIONSTORE uniondb bigdata bigdata2(integer) 5127.0.0.1:6379&gt; SMEMBERS uniondb1) "hadoop"2) "spark"3) "hive"4) "storm"5) "hbase" 3.3.2 set ä½¿ç”¨æ¡ˆä¾‹3.4 ZSetâ€“æœ‰åºé›†åˆZset å’Œ Set ä¸€æ ·ä¹Ÿæ˜¯ String ç±»åž‹å…ƒç´ çš„é›†åˆï¼Œä¸”ä¸å…è®¸é‡å¤çš„æˆå‘˜ã€‚ ä¸åŒçš„æ˜¯æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ª double ç±»åž‹çš„åˆ†æ•°ã€‚Redis æ­£æ˜¯é€šè¿‡åˆ†æ•°æ¥ä¸ºé›†åˆä¸­çš„æˆå‘˜ è¿›è¡Œä»Žå°åˆ°å¤§çš„æŽ’åºã€‚ Zset çš„æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†åˆ†æ•°(score)å´å¯ä»¥é‡å¤ã€‚ 3.4.1 zset shellæ“ä½œ1234567891011121314151617181920212223242526272829303132333435363738394041424344# å¾€ redis åº“ä¸­æ’å…¥ä¸€æ¡ sortedset æ•°æ®# æ³¨æ„: scoåœ¨å‰é¢(float), å¯é‡å¤, 'value'ä¸å¯é‡å¤$ zadd [zsetå] sco 'value'127.0.0.1:6379&gt; zadd yanzhi 70 huangbo 90 xuzheng 80 wangbaoqiang(integer) 3# å‡åºæŽ’åˆ—127.0.0.1:6379&gt; zrange yanzhi 0 41) "huangbo"2) "wangbaoqiang"3) "xuzheng"# é™åºæŽ’åˆ—127.0.0.1:6379&gt; zrevrange yanzhi 0 41) "xuzheng"2) "wangbaoqiang"3) "huangbo"# æŸ¥è¯¢æŸä¸ªæˆå‘˜çš„åæ¬¡127.0.0.1:6379&gt; zrevrange yanzhi 0 41) "xuzheng"2) "wangbaoqiang"3) "huangbo"127.0.0.1:6379&gt; zrank yanzhi huangbo(integer) 0127.0.0.1:6379&gt; zrank yanzhi wangbaoqiang(integer) 1127.0.0.1:6379&gt; zrank yanzhi xuzheng(integer) 2#ä¿®æ”¹æˆå‘˜çš„åˆ†æ•°zincrby yanzhi 50 huangbo"120"127.0.0.1:6379&gt; ZRANGE yanzhi 0 -11) "wangbaoqiang"2) "xuzheng"3) "huangbo"$ zrevrank è¿”å›ž huangbo çš„ yanzhi æŽ’å $ 'value' huangbo ä¸èƒ½é‡å¤, å¯¹åº”çš„åˆ†æ•°å¯ä»¥é‡å¤127.0.0.1:6379&gt; zrevrank yanzhi huangbo(integer) 0 3.4.2 æ¡ˆä¾‹Lol ç›’å­è‹±é›„æ•°æ®æŽ’è¡Œæ¦œï¼š 1ã€åœ¨ redis ä¸­éœ€è¦ä¸€ä¸ªæ¦œå•æ‰€å¯¹åº”çš„ sortedset æ•°æ® 2ã€çŽ©å®¶æ¯é€‰æ‹©ä¸€ä¸ªè‹±é›„æ‰“ä¸€åœºæ¸¸æˆï¼Œå°±å¯¹ sortedset æ•°æ®çš„ç›¸åº”çš„è‹±é›„åˆ†æ•°+1 3ã€Lol ç›’å­ä¸ŠæŸ¥çœ‹æ¦œå•æ—¶ï¼Œå°±è°ƒç”¨ zrange æ¥çœ‹æ¦œå•ä¸­çš„æŽ’åºç»“æžœ ä»£ç è§ github 3.5 æ•£åˆ— â€“ Hashâ€“ å“ˆå¸Œè¡¨ä¸€ä¸ªæ•£åˆ—ç”±å¤šä¸ªåŸŸå€¼å¯¹(field-value pair)ç»„æˆï¼Œæ•£åˆ—çš„é”®å’Œå€¼éƒ½å¯ä»¥æ˜¯æ–‡å­—ã€æ•´æ•°ã€æµ®ç‚¹æ•°æˆ–è€…äºŒ è¿›åˆ¶æ•°æ®ã€‚ åŒä¸€ä¸ªæ•£åˆ—é‡Œé¢çš„å„ä¸ªåŸŸå¿… é¡»æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œä½†ä¸åŒåŸŸçš„ å€¼å¯ä»¥æ˜¯é‡å¤çš„ã€‚ å°½é‡ä½¿ç”¨æ•£åˆ—é”®è€Œä¸æ˜¯å­—ç¬¦ä¸²é”®æ¥å‚¨å­˜é”®å€¼å¯¹æ•°æ®ï¼Œå› ä¸ºæ•£åˆ—é”®ç®¡ç†æ–¹ä¾¿ã€èƒ½å¤Ÿé¿å…é”®åå†²çªã€å¹¶ä¸”è¿˜èƒ½å¤ŸèŠ‚çº¦å†…å­˜ã€‚ Redis Hash æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆã€‚ Redis Hash ç±»åž‹å¯ä»¥çœ‹æˆå…·æœ‰ String Key å’Œ String Value çš„ map å®¹å™¨ Redis Hash æ˜¯ä¸€ä¸ª String ç±»åž‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼ŒHash ç‰¹åˆ«é€‚åˆç”¨äºŽå­˜å‚¨å¯¹è±¡ã€‚ 3.5.1 shell æ“ä½œ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119# æ•£åˆ—(hash)ç±»ä¼¼äºŽ HashMapä¸€ä¸ªæ•£åˆ—ç”±å¤šä¸ªåŸŸ å€¼å¯¹(field-value pair)ç»„æˆï¼Œæ•£åˆ—çš„åŸŸå’Œå€¼éƒ½å¯ä»¥æ˜¯æ–‡å­—ã€æ•´æ•°ã€æµ®ç‚¹æ•°æˆ–è€…äºŒ è¿›åˆ¶æ•°æ®åŒä¸€ä¸ªæ•£åˆ—é‡Œé¢çš„æ¯ä¸ªåŸŸå¿… é¡»æ˜¯ç‹¬ä¸€æ— äºŒã€å„ä¸ç›¸åŒ çš„ï¼Œè€ŒåŸŸçš„å€¼åˆ™æ²¡æœ‰è¿™ä¸€è¦æ±‚ï¼Œæ¢å¥è¯è¯´ï¼Œä¸åŒåŸŸçš„å€¼ å¯ä»¥æ˜¯é‡çš„ã€‚#å…³è”åŸŸå€¼å¯¹HSET key field valueHGET key field:TODO çœŸæ­£çš„ kv æ˜¯ f v, é‚£è®¾ç½®è¿™ä¸ª key å¹²å˜›çš„? ? ðŸ‘Œ===&gt; key æ˜¯æ•£åˆ—åç§°, æ¯”å¦‚ æ•£åˆ— message çš„ field-value pair æ˜¯"sender" "peter" -------------------------------------------------------------------------------------redis&gt; HSET message "id" 10086 (integer) 1redis&gt; HSET message "sender" "peter" (integer) 1redis&gt; HSET message "receiver" "jack" (integer) 1==========================================================================================#ä¸€æ¬¡è®¾ç½®æˆ–èŽ·å–æ•£åˆ—ä¸­çš„å¤šä¸ªåŸŸå€¼å¯¹HMSET key field value [field value ...]HMGET key field [field ...]redis&gt; HMSET message "id" 10086 "sender" "peter" "receiver" "jack"OKredis&gt; HMGET message "id" "sender" "receiver"1) "10086"2) "peter"3) "jack"#èŽ·å–æ•£åˆ—åŒ…å«çš„æ‰€æœ‰åŸŸã€å€¼ã€æˆ–è€…åŸŸå€¼å¯¹HKEYS key =&gt; è¿”å›žæ•£åˆ—é”® key åŒ…å«çš„æ‰€æœ‰åŸŸã€‚HVALS key =&gt; è¿”å›žæ•£åˆ—é”® key ä¸­ï¼Œæ‰€æœ‰åŸŸçš„å€¼ã€‚HGETALL key =&gt; è¿”å›žæ•£åˆ—é”® key åŒ…å«çš„æ‰€æœ‰åŸŸå€¼å¯¹ã€‚redis&gt; HKEYS message 1) "id"2) "sender"3) "receiver"4) "date"5) "content"redis&gt; HVALS message 1) "10086"2) "peter"3) "jack"4) "2014-8-3 3:25 p.m." 5) "Good morning, jack!"redis&gt; HGETALL message1) "id" #åŸŸ2) "10086" #å€¼3) "sender" #åŸŸ4) "peter" #å€¼5) "receiver"6) "jack"7) "date"8) "2014-8-3 3:25 p.m." 9) "content"10) "Good morning, jack!"================================================================ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿# hset , hget , hgetall127.0.0.1:6379&gt; hset shouji iphone 8(integer) 1127.0.0.1:6379&gt; hset shouji xiaomi 7(integer) 1127.0.0.1:6379&gt; hset shouji huawei p20(integer) 1127.0.0.1:6379&gt; hgetall shouji1) "iphone"2) "8"3) "xiaomi"4) "7"5) "huawei"6) "p20"127.0.0.1:6379&gt; hget shouji huawei"p20"# å–å‡º hash æ•°æ®ä¸­æ‰€æœ‰ fields / values127.0.0.1:6379&gt; hkeys shouji1) "iphone"2) "xiaomi"3) "huawei"127.0.0.1:6379&gt; hvals shouji1) "8"2) "7"3) "p20"# ä¸º hash æ•°æ®ä¸­æŒ‡å®šçš„ä¸€ä¸ª field çš„å€¼è¿›è¡Œå¢žå‡127.0.0.1:6379&gt; hincrby shouji xiaomi 10(integer) 17127.0.0.1:6379&gt; hget shouji xiaomi"17"# ä»Ž hash æ•°æ®ä¸­åˆ é™¤ä¸€ä¸ªå­—æ®µ field åŠå…¶å€¼127.0.0.1:6379&gt; HGETALL shouji1) "iphone"2) "8"3) "xiaomi"4) "17"5) "huawei"6) "p20"127.0.0.1:6379&gt; hdel shouji iphone(integer) 1127.0.0.1:6379&gt; HGETALL shouji1) "xiaomi"2) "17"3) "huawei"4) "p20" 3.5.2 æ¡ˆä¾‹: å®žçŽ°è´­ç‰©è½¦ éœ€æ±‚ç‚¹ï¼š åŠ å…¥è´­ç‰©è½¦ æŸ¥è¯¢è´­ç‰©è½¦ ä¿®æ”¹è´­ç‰©è½¦ æ¸…ç©ºè´­ç‰©è½¦ ä»£ç è§ github 3.6 é”®å€¼ç›¸å…³å‘½ä»¤ shellç®€å•å®žç”¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101# æŸ¥è¯¢æ‰€æœ‰ cart å¼€å¤´çš„ key127.0.0.1:6379&gt; keys cart*1) "cart:huangbo"2) "cart:xuzheng"3) "cart:wangbaoqiang"# æŸ¥è¯¢æ‰€æœ‰ key127.0.0.1:6379&gt; keys * 1) "bigdata:hadoop" 2) "uniondb" 3) "myset" 4) "cart:huangbo" 5) "bigdata:spark" ..... # åˆ¤æ–­ä¸€ä¸ª key æ˜¯å¦å­˜åœ¨ exists 127.0.0.1:6379&gt; EXISTS bigdata(integer) 1# del åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ª key127.0.0.1:6379&gt; del facevalue(integer) 1# type æŸ¥çœ‹ç±»åž‹, ä¾¿äºŽé’ˆå¯¹ç±»åž‹æ“ä½œ127.0.0.1:6379&gt; type bigdataset127.0.0.1:6379&gt; SMEMBERS bigdata1) "hadoop"2) "spark"3) "hive"# expire [key] second è®¾ç½®ä¸€ä¸ª key çš„è¿‡æœŸæ—¶é—´, å•ä½æ˜¯ç§’127.0.0.1:6379&gt; type nameslist127.0.0.1:6379&gt; lrange names 0 -11) "xuzheng"2) "huangbo"3) "ycy"$ 127.0.0.1:6379&gt; expire names 5(integer) 1127.0.0.1:6379&gt; lrange names 0 -11) "xuzheng"2) "huangbo"3) "ycy"$ 127.0.0.1:6379&gt; lrange names 0 -1(empty list or set)# expireat [key] timestamp è®¾ç½®åœ¨æ—¶é—´æˆ³ timestamp è¿‡æœŸ# ttl [key] æŸ¥è¯¢ key çš„æœ‰æ•ˆæ—¶é•¿, ä¸å­˜åœ¨æˆ–æ²¡æœ‰è¶…æ—¶è®¾ç½®, è¿”å›ž -1127.0.0.1:6379&gt; ttl bigdata(integer) -1# move [key] database å°†å½“å‰åº“ä¸­çš„ key ç§»åŠ¨åˆ°å…¶å®ƒæ•°æ®åº“ä¸­# é»˜è®¤æ˜¯æœ‰16ä¸ª databases 0-15127.0.0.1:6379&gt; move bigdata 2(integer) 1127.0.0.1:6379&gt; type bigdatanone127.0.0.1:6379&gt; SMEMBERS bigdata(empty list or set)127.0.0.1:6379&gt; SELECT 2OK127.0.0.1:6379[2]&gt; keys *1) "bigdata"127.0.0.1:6379[2]&gt; SMEMBERS bigdata1) "hadoop"2) "spark"3) "hive"# ç§»é™¤ç»™å®škey çš„è¿‡æœŸæ—¶é—´127.0.0.1:6379[2]&gt; keys *1) "bigdata"127.0.0.1:6379[2]&gt; expire bigdata 100(integer) 1127.0.0.1:6379[2]&gt; ttl bigdata(integer) 96127.0.0.1:6379[2]&gt; persist bigdata(integer) 1127.0.0.1:6379[2]&gt; ttl bigdata(integer) -1# éšæœºèŽ·å– keyç©ºé—´ä¸­çš„ä¸€ä¸ª127.0.0.1:6379&gt; randomkey"student_tang"# é‡å‘½å key127.0.0.1:6379&gt; zrange yanzhi 0 -11) "wangbaoqiang"2) "xuzheng"3) "huangbo"127.0.0.1:6379&gt; rename yanzhi shuiMaOK127.0.0.1:6379&gt; zrange shuiMa 0 -11) "wangbaoqiang"2) "xuzheng"3) "huangbo"# renamenx [key] newkey å¦‚æžœ newkey å­˜åœ¨, åˆ™å¤±è´¥è¿”å›ž0# type [key] æŸ¥è¯¢ key çš„ç±»åž‹ 3.7 æœåŠ¡å™¨ç›¸å…³å‘½ä»¤ ç®€å•æµ‹è¯•12345678910111213141516171819202122232425262728293031# é€‰æ‹©æ•°æ®åº“ (redis é»˜è®¤æ•°æ®åº“ç¼–å· 0-15)127.0.0.1:6379&gt; select 3OK# quité€€å‡º# echo msg å‘çŽ°ä¸èƒ½æœ‰ç©ºæ ¼127.0.0.1:6379[3]&gt; echo è¦åäº†"\xe8\xa6\x81\xe5\x90\x90\xe4\xba\x86"127.0.0.1:6379[3]&gt; echo iFellSick"iFellSick"# dbsize è¿”å›žå½“æœŸé‚£æ•°æ®åº“ä¸­çš„ key çš„æ¡æ•°127.0.0.1:6379[3]&gt; select 0OK127.0.0.1:6379&gt; DBSIZE(integer) 23# flushdb åˆ é™¤å½“å‰é€‰æ‹©æ•°æ®åº“ä¸­çš„æ‰€æœ‰key127.0.0.1:6379[2]&gt; dbsize(integer) 1127.0.0.1:6379[2]&gt; keys *1) "bigdata"127.0.0.1:6379[2]&gt; flushdbOK127.0.0.1:6379[2]&gt; keys *(empty list or set)# flushall åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰çš„ key 5. Redisé«˜å¯ç”¨åœ¨ Redis ä¸­ï¼Œå®žçŽ°é«˜å¯ç”¨çš„æŠ€æœ¯ä¸»è¦åŒ…æ‹¬æŒä¹…åŒ–ã€å¤åˆ¶ã€å“¨å…µå’Œé›†ç¾¤ ç¬¬ä¸€ï¼šæŒä¹…åŒ– æŒä¹…åŒ–æ˜¯æœ€ç®€å•çš„é«˜å¯ç”¨æ–¹æ³•(æœ‰æ—¶ç”šè‡³ä¸è¢«å½’ä¸ºé«˜å¯ç”¨çš„æ‰‹æ®µ)ï¼Œä¸»è¦ä½œç”¨æ˜¯æ•°æ®å¤‡ä»½ï¼Œ å³å°†æ•°æ®å­˜å‚¨åœ¨ç¡¬ç›˜ï¼Œä¿è¯æ•°æ®ä¸ä¼šå› è¿›ç¨‹é€€å‡ºè€Œä¸¢å¤±ã€‚ ç¬¬äºŒï¼šä¸»ä»Žå¤åˆ¶ å¤åˆ¶æ˜¯é«˜å¯ç”¨ Redis çš„åŸºç¡€ï¼Œå“¨å…µå’Œé›†ç¾¤éƒ½æ˜¯åœ¨å¤åˆ¶åŸºç¡€ä¸Šå®žçŽ°é«˜å¯ç”¨çš„ã€‚å¤åˆ¶ä¸»è¦å®žçŽ° äº†æ•°æ®çš„å¤šæœºå¤‡ä»½ï¼Œä»¥åŠå¯¹äºŽè¯»æ“ä½œçš„è´Ÿè½½å‡è¡¡å’Œç®€å•çš„æ•…éšœæ¢å¤ã€‚ç¼ºé™·ï¼šæ•…éšœæ¢å¤æ—  æ³•è‡ªåŠ¨åŒ–ï¼›å†™æ“ä½œæ— æ³•è´Ÿè½½å‡è¡¡ï¼›å­˜å‚¨èƒ½åŠ›å—åˆ°å•æœºçš„é™åˆ¶ã€‚ ç¬¬ä¸‰ï¼šå“¨å…µ å“¨å…µåœ¨å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œå“¨å…µå®žçŽ°äº†è‡ªåŠ¨åŒ–çš„æ•…éšœæ¢å¤ã€‚ç¼ºé™·ï¼šå†™æ“ä½œæ— æ³•è´Ÿè½½å‡è¡¡ï¼›å­˜ å‚¨èƒ½åŠ›å—åˆ°å•æœºçš„é™åˆ¶ã€‚ ç¬¬å››ï¼šé›†ç¾¤ é€šè¿‡é›†ç¾¤ï¼ŒRedis è§£å†³äº†å†™æ“ä½œæ— æ³•è´Ÿè½½å‡è¡¡ï¼Œä»¥åŠå­˜å‚¨èƒ½åŠ›å—åˆ°å•æœºé™åˆ¶çš„é—®é¢˜ï¼Œå®žçŽ° äº†è¾ƒä¸ºå®Œå–„çš„é«˜å¯ç”¨æ–¹æ¡ˆã€‚ 5.1 Redis æŒä¹…åŒ–Redis æŒä¹…åŒ–åˆ†ä¸º RDB æŒä¹…åŒ–å’Œ AOF æŒä¹…åŒ–ï¼š RDBï¼šå°†å½“å‰æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ AOFï¼šå°†æ¯æ¬¡æ‰§è¡Œçš„å†™å‘½ä»¤ä¿å­˜åˆ°ç¡¬ç›˜ï¼ˆç±»ä¼¼äºŽ MySQL çš„ binlogï¼‰ ç”±äºŽ AOF æŒä¹…åŒ–çš„å®žæ—¶æ€§æ›´å¥½ï¼Œå³å½“è¿›ç¨‹æ„å¤–é€€å‡ºæ—¶ä¸¢å¤±çš„æ•°æ®æ›´å°‘ï¼Œå› æ­¤ AOF æ˜¯ç›®å‰ä¸» æµçš„æŒä¹…åŒ–æ–¹å¼ï¼Œä¸è¿‡ RDB æŒä¹…åŒ–ä»ç„¶æœ‰å…¶ç”¨æ­¦ä¹‹åœ°ã€‚ 5.1.1 RDB æ‰‹åŠ¨æ–¹å¼ save save å‘½ä»¤ä¼šé˜»å¡ž Redis æœåŠ¡å™¨è¿›ç¨‹ï¼Œç›´åˆ° RDB æ–‡ä»¶åˆ›å»ºå®Œæ¯•ä¸ºæ­¢ bgsave bgsave å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç”±å­è¿›ç¨‹æ¥è´Ÿè´£åˆ›å»º RDB æ–‡ä»¶ï¼Œçˆ¶è¿›ç¨‹(å³ Redis ä¸» è¿›ç¨‹)åˆ™ç»§ç»­å¤„ç†è¯·æ±‚ã€‚ è‡ªåŠ¨è§¦å‘ åœ¨é…ç½®æ–‡ä»¶redis.confä¸­é…ç½® save m n save 900 1 save 300 10 save 60 10000 #900 ç§’å†…å¦‚æžœè¶…è¿‡ 1 ä¸ª key è¢«ä¿®æ”¹ï¼Œåˆ™å‘èµ·å¿«ç…§ä¿å­˜ #300 ç§’å†…å®¹å¦‚è¶…è¿‡ 10 ä¸ª key è¢«ä¿®æ”¹ï¼Œåˆ™å‘èµ·å¿«ç…§ä¿å­˜ #60 ç§’å†…å®¹å¦‚è¶…è¿‡ 10000 ä¸ª key è¢«ä¿®æ”¹ï¼Œåˆ™å‘èµ·å¿«ç…§ä¿å­˜ 5.1.2 AOF æ–¹å¼AOF æ¯”å¿«ç…§æ–¹å¼æœ‰æ›´å¥½çš„æŒä¹…åŒ–æ€§ï¼Œæ˜¯ç”±äºŽåœ¨ä½¿ç”¨ AOF æŒä¹…åŒ–æ–¹å¼æ—¶ï¼ŒRedis ä¼šå°†æ¯ä¸€ä¸ªæ”¶ åˆ°çš„å†™å‘½ä»¤éƒ½é€šè¿‡ write å‡½æ•°è¿½åŠ åˆ°æ–‡ä»¶ä¸­(é»˜è®¤æ˜¯ appendonly.aof)ã€‚å½“ Redis é‡å¯æ—¶ä¼šé€šè¿‡ é‡æ–°æ‰§è¡Œæ–‡ä»¶ä¸­ä¿å­˜çš„å†™å‘½ä»¤æ¥åœ¨å†…å­˜ä¸­é‡å»ºæ•´ä¸ªæ•°æ®åº“çš„å†…å®¹ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶å‘Šè¯‰ redis æˆ‘ä»¬æƒ³è¦ é€šè¿‡ fsync å‡½æ•°å¼ºåˆ¶ os å†™å…¥åˆ°ç£ç›˜çš„æ—¶æœºã€‚ ä¸‰ç§æ–¹å¼å¦‚ä¸‹ï¼ˆé»˜è®¤æ˜¯ï¼šæ¯ç§’ fsync ä¸€æ¬¡ï¼‰ï¼š 5.2 Redis ä¸»ä»Žå¤åˆ¶Redis ä¸»ä»Žå¤åˆ¶é…ç½®å’Œä½¿ç”¨éƒ½éžå¸¸ç®€å•ã€‚é€šè¿‡ä¸»ä»Žå¤åˆ¶å¯ä»¥å…è®¸å¤šä¸ª slave server æ‹¥æœ‰å’Œ master server ç›¸åŒçš„æ•°æ®åº“å‰¯æœ¬ã€‚ä¸‹é¢æ˜¯å…³äºŽ redis ä¸»ä»Žå¤åˆ¶çš„ä¸€äº›ç‰¹ç‚¹ï¼š 1ã€master å¯ä»¥æœ‰å¤šä¸ª slave 2ã€é™¤äº†å¤šä¸ª slave è¿žåˆ°ç›¸åŒçš„ master å¤–ï¼Œslave ä¹Ÿå¯ä»¥è¿žæŽ¥å…¶ä»– slave å½¢æˆå›¾çŠ¶ç»“æž„ 3ã€ä¸»ä»Žå¤åˆ¶ä¸ä¼šé˜»å¡ž masterã€‚ä¹Ÿå°±æ˜¯è¯´å½“ä¸€ä¸ªæˆ–å¤šä¸ª slave ä¸Ž master è¿›è¡Œåˆæ¬¡åŒæ­¥æ•°æ®æ—¶ï¼Œ master å¯ä»¥ç»§ç»­å¤„ç† client å‘æ¥çš„è¯·æ±‚ã€‚ç›¸å slave åœ¨åˆæ¬¡åŒæ­¥æ•°æ®æ—¶åˆ™ä¼šé˜»å¡žä¸èƒ½å¤„ç† client çš„è¯·æ±‚ã€‚ 4ã€ä¸»ä»Žå¤åˆ¶å¯ä»¥ç”¨æ¥æé«˜ç³»ç»Ÿçš„å¯ä¼¸ç¼©æ€§,æˆ‘ä»¬å¯ä»¥ç”¨å¤šä¸ª slave ä¸“é—¨ç”¨äºŽ client çš„è¯»è¯·æ±‚ï¼Œ æ¯”å¦‚ sort æ“ä½œå¯ä»¥ä½¿ç”¨ slave æ¥å¤„ç†ã€‚ä¹Ÿå¯ä»¥ç”¨æ¥åšç®€å•çš„æ•°æ®å†—ä½™ 5ã€å¯ä»¥åœ¨ master ç¦ç”¨æ•°æ®æŒä¹…åŒ–ï¼Œåªéœ€è¦æ³¨é‡ŠæŽ‰ master é…ç½®æ–‡ä»¶ä¸­çš„æ‰€æœ‰ save é…ç½®ï¼Œç„¶ åŽåªåœ¨ slave ä¸Šé…ç½®æ•°æ®æŒä¹…åŒ–ã€‚ ä¸»ä»Žå¤åˆ¶çš„è¿‡ç¨‹å½“è®¾ç½®å¥½ slave æœåŠ¡å™¨åŽï¼Œslave ä¼šå»ºç«‹å’Œ master çš„è¿žæŽ¥ï¼Œç„¶åŽå‘é€ sync å‘½ä»¤ã€‚ æ— è®ºæ˜¯ç¬¬ä¸€ æ¬¡åŒæ­¥å»ºç«‹çš„è¿žæŽ¥è¿˜æ˜¯è¿žæŽ¥æ–­å¼€åŽçš„é‡æ–°è¿žæŽ¥ï¼Œmaster éƒ½ä¼šå¯åŠ¨(fork)ä¸€ä¸ªåŽå°è¿›ç¨‹ï¼Œå°†æ•° æ®åº“å¿«ç…§ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼ˆfork ä¸€ä¸ªè¿›ç¨‹å…¥å†…åœ¨ä¹Ÿè¢«å¤åˆ¶äº†ï¼Œå³å†…å­˜ä¼šæ˜¯åŽŸæ¥çš„ä¸¤å€ï¼‰ï¼ŒåŒæ—¶ master ä¸»è¿›ç¨‹ä¼šå¼€å§‹æ”¶é›†æ–°çš„å†™å‘½ä»¤å¹¶ç¼“å­˜èµ·æ¥ã€‚ åŽå°è¿›ç¨‹å®Œæˆå†™æ–‡ä»¶åŽï¼Œmaster å°±å‘é€ æ–‡ä»¶ç»™ slaveï¼Œslave å°†æ–‡ä»¶ä¿å­˜åˆ°ç£ç›˜ä¸Šï¼Œç„¶åŽåŠ è½½åˆ°å†…å­˜æ¢å¤æ•°æ®åº“å¿«ç…§åˆ° slave ä¸Šã€‚ æŽ¥ç€ master å°±ä¼šæŠŠç¼“å­˜çš„å‘½ä»¤è½¬å‘ç»™ slaveã€‚ è€Œä¸”åŽç»­ master æ”¶åˆ°çš„å†™å‘½ä»¤éƒ½ä¼šé€šè¿‡å¼€å§‹å»ºç«‹ çš„è¿žæŽ¥å‘é€ç»™ slaveã€‚ ä»Ž master åˆ° slave çš„åŒæ­¥æ•°æ®çš„å‘½ä»¤å’Œä»Ž client å‘é€çš„å‘½ä»¤ä½¿ç”¨ç›¸åŒçš„ åè®®æ ¼å¼ã€‚ å½“ master å’Œ slave çš„è¿žæŽ¥æ–­å¼€æ—¶ slave å¯ä»¥è‡ªåŠ¨é‡æ–°å»ºç«‹è¿žæŽ¥ã€‚ å¦‚æžœ master åŒæ—¶ æ”¶åˆ°å¤šä¸ª slave å‘æ¥çš„åŒæ­¥è¿žæŽ¥å‘½ä»¤ï¼Œåªä¼šä½¿ç”¨å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹æ¥å†™æ•°æ®åº“é•œåƒï¼Œç„¶åŽå‘é€ç»™ æ‰€æœ‰ slaveã€‚ é…ç½® slave æœåŠ¡å™¨åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹é…ç½®ï¼š slaveof cs1 6379 #æŒ‡å®š master çš„ ip å’Œç«¯å£ æ³¨æ„ï¼šä¸»èŠ‚ç‚¹ä¸ç”¨åŠ ï¼ï¼ï¼ 6.Redis.confé…ç½®æ–‡ä»¶å‚æ•°è¯´æ˜Žredis.conf é…ç½®é¡¹è¯´æ˜Žå¦‚ä¸‹ï¼š 1ã€Redis é»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹ï¼Œä½¿ç”¨ yes å¯ç”¨å®ˆæŠ¤è¿› ç¨‹ daemonize no 2ã€å½“ Redis ä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œæ—¶ï¼ŒRedis é»˜è®¤ä¼šæŠŠ pid å†™å…¥/var/run/redis.pid æ–‡ä»¶ï¼Œå¯ä»¥ é€šè¿‡ pidfile æŒ‡å®š pidfile /var/run/redis.pid 3ã€æŒ‡å®š Redis ç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º 6379ï¼Œä½œè€…åœ¨è‡ªå·±çš„ä¸€ç¯‡åšæ–‡ä¸­è§£é‡Šäº†ä¸ºä»€ä¹ˆé€‰ç”¨ 6379 ä½œä¸ºé»˜è®¤ç«¯å£ï¼Œå› ä¸º 6379 åœ¨æ‰‹æœºæŒ‰é”®ä¸Š MERZ å¯¹åº”çš„å·ç ï¼Œè€Œ MERZ å–è‡ªæ„å¤§åˆ©æ­Œ å¥³ Alessia Merz çš„åå­— port 6379 4ã€ç»‘å®šçš„ä¸»æœºåœ°å€ bind 127.0.0.1 5ã€å½“å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åŽå…³é—­è¿žæŽ¥ï¼Œå¦‚æžœæŒ‡å®šä¸º 0ï¼Œè¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½ timeout 300 6ã€æŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«ï¼ŒRedis æ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warningï¼Œé»˜ è®¤ä¸º verbose loglevel verbose 7ã€æ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºï¼Œå¦‚æžœé…ç½® Redis ä¸ºå®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼Œè€Œè¿™é‡Œåˆé… ç½®ä¸ºæ—¥å¿—è®°å½•æ–¹å¼ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šå‘é€ç»™/dev/null logfile stdout 8ã€è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“ä¸º 0ï¼Œå¯ä»¥ä½¿ç”¨ SELECT å‘½ä»¤åœ¨è¿žæŽ¥ä¸ŠæŒ‡å®šæ•°æ® åº“ id databases 16 9ã€æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é… åˆ save \&lt;seconds> \&lt;changes> Redis é»˜è®¤é…ç½®æ–‡ä»¶ä¸­æä¾›äº†ä¸‰ä¸ªæ¡ä»¶ï¼š save 900 1 save 300 10 save 60 10000 åˆ†åˆ«è¡¨ç¤º 900 ç§’ï¼ˆ15 åˆ†é’Ÿï¼‰å†…æœ‰ 1 ä¸ªæ›´æ”¹ï¼Œ300 ç§’ï¼ˆ5 åˆ†é’Ÿï¼‰å†…æœ‰ 10 ä¸ªæ›´æ”¹ä»¥åŠ 60 ç§’ å†…æœ‰ 10000 ä¸ªæ›´æ”¹ã€‚ 10ã€æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦åŽ‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸º yesï¼ŒRedis é‡‡ç”¨ LZF åŽ‹ç¼©ï¼Œå¦‚æžœä¸ºäº† èŠ‚çœ CPU æ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§ rdbcompression yes 11ã€æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸º dump.rdb dbfilename dump.rdb 12ã€æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½• dir ./ 13ã€è®¾ç½®å½“æœ¬æœºä¸º slave æœåŠ¡æ—¶ï¼Œè®¾ç½® master æœåŠ¡çš„ IP åœ°å€åŠç«¯å£ï¼Œåœ¨ Redis å¯åŠ¨æ—¶ï¼Œå®ƒ ä¼šè‡ªåŠ¨ä»Ž master è¿›è¡Œæ•°æ®åŒæ­¥ slaveof \&lt;masterip> \&lt;masterport> 14ã€å½“ master æœåŠ¡è®¾ç½®äº†å¯†ç ä¿æŠ¤æ—¶ï¼Œslav æœåŠ¡è¿žæŽ¥ master çš„å¯†ç  masterauth \&lt;master-password> 15ã€è®¾ç½® Redis è¿žæŽ¥å¯†ç ï¼Œå¦‚æžœé…ç½®äº†è¿žæŽ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿žæŽ¥ Redis æ—¶éœ€è¦é€šè¿‡ AUTH \&lt;password>å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­ requirepass foobared 16ã€è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿žæŽ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ï¼ŒRedis å¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿žæŽ¥æ•° ä¸º Redis è¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°ï¼Œå¦‚æžœè®¾ç½® maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ã€‚å½“ å®¢æˆ·ç«¯è¿žæŽ¥æ•°åˆ°è¾¾é™åˆ¶æ—¶ï¼ŒRedis ä¼šå…³é—­æ–°çš„è¿žæŽ¥å¹¶å‘å®¢æˆ·ç«¯è¿”å›ž max number of clients reached é”™è¯¯ä¿¡æ¯ maxclients 128 17ã€æŒ‡å®š Redis æœ€å¤§å†…å­˜é™åˆ¶ï¼ŒRedis åœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åŽï¼Œ Redis ä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„ Keyï¼Œå½“æ­¤æ–¹æ³•å¤„ç† åŽï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œ å°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚Redis æ–°çš„ vm æœºåˆ¶ï¼Œä¼šæŠŠ Key å­˜æ”¾ å†…å­˜ï¼ŒValue ä¼šå­˜æ”¾åœ¨ swap åŒº maxmemory \&lt;bytes> 18ã€æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåŽè¿›è¡Œæ—¥å¿—è®°å½•ï¼ŒRedis åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ ç£ç›˜ï¼Œå¦‚æžœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤±ã€‚å› ä¸º redis æœ¬èº«åŒæ­¥æ•° æ®æ–‡ä»¶æ˜¯æŒ‰ä¸Šé¢ save æ¡ä»¶æ¥åŒæ­¥çš„ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…åªå­˜åœ¨äºŽå†…å­˜ä¸­ã€‚é»˜ è®¤ä¸º no appendonly no 19ã€æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸º appendonly.aof appendfilename appendonly.aof 20ã€æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ï¼Œå…±æœ‰ 3 ä¸ªå¯é€‰å€¼ï¼š noï¼šè¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰ alwaysï¼šè¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåŽæ‰‹åŠ¨è°ƒç”¨ fsync()å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰ everysecï¼šè¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜è¡·ï¼Œé»˜è®¤å€¼ï¼‰ appendfsync everysec 21ã€æŒ‡å®šæ˜¯å¦å¯ç”¨è™šæ‹Ÿå†…å­˜æœºåˆ¶ï¼Œé»˜è®¤å€¼ä¸º noï¼Œç®€å•çš„ä»‹ç»ä¸€ä¸‹ï¼ŒVM æœºåˆ¶å°†æ•°æ®åˆ†é¡µ å­˜æ”¾ï¼Œç”± Redis å°†è®¿é—®é‡è¾ƒå°‘çš„é¡µå³å†·æ•°æ® swap åˆ°ç£ç›˜ä¸Šï¼Œè®¿é—®å¤šçš„é¡µé¢ç”±ç£ç›˜è‡ªåŠ¨æ¢ å‡ºåˆ°å†…å­˜ä¸­ï¼ˆåœ¨åŽé¢çš„æ–‡ç« æˆ‘ä¼šä»”ç»†åˆ†æž Redis çš„ VM æœºåˆ¶ï¼‰ vm-enabled no 22ã€è™šæ‹Ÿå†…å­˜æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º/tmp/redis.swapï¼Œä¸å¯å¤šä¸ª Redis å®žä¾‹å…±äº« vm-swap-file /tmp/redis.swap 23ã€å°†æ‰€æœ‰å¤§äºŽ vm-max-memory çš„æ•°æ®å­˜å…¥è™šæ‹Ÿå†…å­˜,æ— è®º vm-max-memory è®¾ç½®å¤šå°,æ‰€ æœ‰ç´¢å¼•æ•°æ®éƒ½æ˜¯å†…å­˜å­˜å‚¨çš„(Redis çš„ç´¢å¼•æ•°æ® å°±æ˜¯ keys),ä¹Ÿå°±æ˜¯è¯´,å½“ vm-max-memory è®¾ ç½®ä¸º 0 çš„æ—¶å€™,å…¶å®žæ˜¯æ‰€æœ‰ value éƒ½å­˜åœ¨äºŽç£ç›˜ã€‚é»˜è®¤å€¼ä¸º 0 vm-max-memory 0 24ã€Redis swap æ–‡ä»¶åˆ†æˆäº†å¾ˆå¤šçš„ pageï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¿å­˜åœ¨å¤šä¸ª page ä¸Šé¢ï¼Œä½†ä¸€ä¸ª page ä¸Šä¸èƒ½è¢«å¤šä¸ªå¯¹è±¡å…±äº«ï¼Œvm-page-size æ˜¯è¦æ ¹æ®å­˜å‚¨çš„ æ•°æ®å¤§å°æ¥è®¾å®šçš„ï¼Œä½œè€…å»ºè®®å¦‚ æžœå­˜å‚¨å¾ˆå¤šå°å¯¹è±¡ï¼Œpage å¤§å°æœ€å¥½è®¾ç½®ä¸º 32 æˆ–è€… 64bytesï¼›å¦‚æžœå­˜å‚¨å¾ˆå¤§å¤§å¯¹è±¡ï¼Œåˆ™å¯ ä»¥ä½¿ç”¨æ›´å¤§çš„ pageï¼Œå¦‚æžœä¸ ç¡®å®šï¼Œå°±ä½¿ç”¨é»˜è®¤å€¼ vm-page-size 32 25ã€è®¾ç½® swap æ–‡ä»¶ä¸­çš„ page æ•°é‡ï¼Œç”±äºŽé¡µè¡¨ï¼ˆä¸€ç§è¡¨ç¤ºé¡µé¢ç©ºé—²æˆ–ä½¿ç”¨çš„ bitmapï¼‰æ˜¯ åœ¨æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œï¼Œåœ¨ç£ç›˜ä¸Šæ¯ 8 ä¸ª pages å°†æ¶ˆè€— 1byte çš„å†…å­˜ã€‚ vm-pages 134217728 26ã€è®¾ç½®è®¿é—® swap æ–‡ä»¶çš„çº¿ç¨‹æ•°,æœ€å¥½ä¸è¦è¶…è¿‡æœºå™¨çš„æ ¸æ•°,å¦‚æžœè®¾ç½®ä¸º 0,é‚£ä¹ˆæ‰€æœ‰å¯¹ swap æ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒé•¿æ—¶é—´çš„å»¶è¿Ÿã€‚é»˜è®¤å€¼ä¸º 4 vm-max-threads 4 27ã€è®¾ç½®åœ¨å‘å®¢æˆ·ç«¯åº”ç­”æ—¶ï¼Œæ˜¯å¦æŠŠè¾ƒå°çš„åŒ…åˆå¹¶ä¸ºä¸€ä¸ªåŒ…å‘é€ï¼Œé»˜è®¤ä¸ºå¼€å¯ glueoutputbuf yes 28ã€æŒ‡å®šåœ¨è¶…è¿‡ä¸€å®šçš„æ•°é‡æˆ–è€…æœ€å¤§çš„å…ƒç´ è¶…è¿‡æŸä¸€ä¸´ç•Œå€¼æ—¶ï¼Œé‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®— æ³• hash-max-zipmap-entries 64 hash-max-zipmap-value 512 29ã€æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯ï¼ˆåŽé¢åœ¨ä»‹ç» Redis çš„å“ˆå¸Œç®—æ³•æ—¶å…·ä½“ä»‹ç»ï¼‰ activerehashing yes 30ã€æŒ‡å®šåŒ…å«å…¶å®ƒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸»æœºä¸Šå¤šä¸ª Redis å®žä¾‹ä¹‹é—´ä½¿ç”¨åŒä¸€ä»½é…ç½®æ–‡ ä»¶ï¼Œè€ŒåŒæ—¶å„ä¸ªå®žä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶ include /path/to/local.conf 6.å…¶å®ƒéœ€è¦äº†è§£çš„æ·»åŠ æ³¨é‡Šçš„æŠ€å·§: æœ€å¥½çš„æ³¨é‡Šæ–¹å¼: å°‘è€Œç²¾ å®Œæˆä¸€æ®µå°é€»è¾‘çš„ä»£ç å°±åŠ ä¸ªæ³¨é‡Š å®¹æ˜“è´¹è§£çš„åœ°æ–¹åŠ æ³¨é‡Š æ‹“å±•: ç¼“å­˜æ·˜æ±°ç®—æ³• :TODONRU(Not recently used) FIFO(First-in, first-out) Second-chance LRU(Least recently Used) redis çš„å†…å­˜æ¨¡åž‹ Hadoop3.0 æ–°ç‰¹æ€§æœºåˆ¶ çº åˆ ç  æœºåˆ¶ 7.Redis é”™è¯¯12345678910111213141516171819202122# é”™è¯¯1(error) MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk. Commands that may modify the data set are disabled, because this instance is configured to report errors during writes if RDB snapshotting fails (stop-writes-on-bgsave-error option). Please check the Redis logs for details about the RDB error.127.0.0.1:6379&gt; config set stop-writes-on-bgsave-error noOK127.0.0.1:6379&gt; pingPONG# é”™è¯¯2cc: ../deps/hiredis/libhiredis.a: No such file or directorycc: ../deps/lua/src/liblua.a: No such file or directorycc: ../deps/geohash-int/geohash.o: No such file or directorycc: ../deps/geohash-int/geohash_helper.o: No such file or directorymake[1]: * [redis-server] Error 1make[1]: Leaving directory `/usr/local/src/redis-3.2.9/src'make: * [all] Error 2----------------è§£å†³åŠžæ³•è¿›å…¥æºç åŒ…ç›®å½•ä¸‹çš„depsç›®å½•ä¸­æ‰§è¡Œmake geohash-int hiredis jemalloc linenoise luaç„¶åŽå†è¿›è¡Œ../makeç¼–è¯‘å°±å¯ä»¥äº†å† $&gt; sudo make PREFIX=/usr/local/redis install 8.å‚è€ƒèµ„æ–™æ–‡æ¡£PDF]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kafka]]></title>
    <url>%2F2018%2F07%2F01%2FHadoop%2F7-Flume%26Kafka%2FKafka%2F</url>
    <content type="text"><![CDATA[1.æ¦‚è§ˆåˆ†å¸ƒå¼æµå¤„ç†å¹³å°ã€‚ åˆ†å¸ƒå¼, å‰¯æœ¬, å®¹é”™çš„åˆ†å¸ƒå¼å­˜å‚¨æµ. åœ¨ç³»ç»Ÿä¹‹é—´æž„å»ºå®žæ—¶æ•°æ®æµç®¡é“ã€‚ ä»¥topicåˆ†ç±»å¯¹è®°å½•è¿›è¡Œå­˜å‚¨ æ¯ä¸ªè®°å½•åŒ…å«key-value+timestamp æ¯ç§’é’Ÿç™¾ä¸‡æ¶ˆæ¯åžåé‡ã€‚ Java çš„ JMS æœ‰2ç§æ¨¡å¼: å‘å¸ƒè®¢é˜…æ¨¡å¼( æ‹¿åˆ°çš„æ˜¯ copy) &amp; é˜Ÿåˆ—æ¨¡å¼(queue): kafka é€šè¿‡ group æŠŠè¿™ä¸¤ç§æ¨¡å¼å®Œç¾Žçš„ç»“åˆèµ·æ¥ å¦‚æžœæƒ³è¦å®žçŽ°queue æ¨¡å¼, å°±æŠŠæ¶ˆè´¹è€…æ”¾åœ¨åŒä¸€ç»„, æ­¤ç»„ä¸­åªèƒ½æœ‰ä¸€ä¸ªæˆå‘˜æ¥æ¶ˆè´¹æ­¤æ¶ˆæ¯ æƒ³è¦å®žçŽ°å‘å¸ƒè®¢é˜…æ¨¡å¼, å°±æŠŠæ¯ä¸ªæ¶ˆè´¹è€…å„è‡ªä¸€ç»„, æ¯ä¸ªäººéƒ½å¯ä»¥æ‹¿åˆ°ä¸€ä¸ªæ¶ˆæ¯å‰¯æœ¬ å…³é”®è¯: producer //æ¶ˆæ¯ç”Ÿäº§è€… consumer //æ¶ˆæ¯æ¶ˆè´¹è€… consumer group //æ¶ˆè´¹è€…ç»„ kafka server //broker,kafkaæœåŠ¡å™¨ topic //ä¸»é¢˜,å‰¯æœ¬æ•°,åˆ†åŒº. zookeeper //hadoop namenoade + RM HA | hbase | kafka ä¼˜åŒ–æ–¹æ¡ˆ: æŠŠç£ç›˜æŒ‚è½½åœ¨æŸä¸ªç›®å½•, ç„¶åŽè®©è¿™ä¸ªç›®å½•, åªæ˜¯å­˜å‚¨æŸä¸ªåˆ†åŒºçš„æ•°æ® kafka çš„è¦ç‚¹ä¸€æ¡æ¶ˆæ¯æ˜¯å­˜åœ¨ä¸€ä¸ªåˆ†åŒºçš„ å‰¯æœ¬â€“å¯é æ€§ åˆ†åŒºâ€“é«˜æ•ˆæ€§ =&gt; å¹¶å‘è®¿é—® åˆ†åŒº(partition)æ˜¯ producer é€šè¿‡è´Ÿè½½å‡è¡¡é€‰æ‹©çš„ ä¸€ä¸ªåˆ†åŒºå­˜ç€å¤šæ¡æ¶ˆæ¯, æ¶ˆæ¯æ˜¯æœ‰åºçš„ ä¸€ä¸ªåˆ†åŒºå†…çš„æ¶ˆæ¯åªèƒ½è¢«ä¸€ä¸ªç»„å†…çš„ä¸€ä¸ªæˆå‘˜æ¶ˆè´¹ topic æ˜¯åœ¨ kafka server ä¸Š topic åŒ…å« å‰¯æœ¬æ•°, åˆ†åŒº producer &amp; consumer éƒ½æ˜¯é’ˆå¯¹ topic æ¥æ“ä½œçš„ kafka çš„ consumer æ˜¯æ‹‰æ¨¡å¼, ä»Ž kafkaåŽ»pull æ¶ˆæ¯, å®žæ—¶è®¡ç®—æ¡†æž¶æœ‰å¤šå¤§èƒ½åŠ›, å°± pull å¤šå°‘ æ‰€ä»¥ kafka ä¸€èˆ¬éƒ½ç”¨åœ¨å®žæ—¶/å‡†å®žæ—¶ è®¡ç®—ä¸­ é¡ºåºè¯»å†™ è¿½åŠ æ•°æ®, æ˜¯è¿½åŠ åˆ°æœ€åŽ è¯»å–æ˜¯ä»Žå¼€å¤´è¯»å– å¯ç”¨ offset è·³è½¬åˆ°æŒ‡å®šçš„æ•°æ®æ®µ æ•°æ®å¯é‡å¤æ¶ˆè´¹ Consumers ä¸€æ¡æ•°æ®åªèƒ½è¢«åŒç»„å†…ä¸€ä¸ªæˆå‘˜æ¶ˆè´¹ ä¸åŒç»„çš„å¯ä»¥æ¶ˆè´¹åŒä¸€ä¸ªæ•°æ® SSDè¯»å†™é€Ÿåº¦: 1200 ~ 3500 MB/s æ³¨æ„ç‚¹: Kafka çš„åˆ†åŒºæ•°, å¯ä»¥åŠ¨æ€è°ƒæ•´ Kafka çš„æ¯ä¸ªåˆ†åŒºéƒ½æœ‰å¯¹åº”çš„å†—ä½™æ•°é‡, é»˜è®¤æ˜¯1 æ¯ä¸ªåˆ†åŒºå¦‚æžœæœ‰å¤šä¸ªå‰¯æœ¬, è¿™äº›å‰¯æœ¬ä¸­, ä¼šæœ‰ä¸€ä¸ªæ˜¯ active çš„çŠ¶æ€, è´Ÿè´£è¯»å†™, å…¶å®ƒçš„éƒ½æ˜¯ standby çš„çŠ¶æ€ å¯¹äºŽHDFSå’Œkafkaçš„ block partition å¯¹äºŽä¸åŒçš„æ–‡ä»¶æˆ–è€…topicæ¥è¯´ï¼Œéƒ½å¯ä»¥æœ‰ä¸åŒçš„å‰¯æœ¬æ•°ï¼(æ¯ä¸ª topic å¯ä»¥å•ç‹¬è®¾ç½®)è®¾ç½®çš„å‰¯æœ¬æ•°ä¸èƒ½è¶…è¿‡brokerçš„æ•°é‡ï¼ï¼ï¼ Kafka çš„å¤§è‡´å·¥ä½œæ¨¡å¼ï¼š1ã€å¯åŠ¨ ZooKeeper çš„ server 2ã€å¯åŠ¨ Kafka çš„ server 3ã€Producer ç”Ÿäº§æ•°æ®ï¼Œç„¶åŽé€šè¿‡ ZooKeeper æ‰¾åˆ° Brokerï¼Œå†å°†æ•°æ® push åˆ° Broker ä¿å­˜ 4ã€Consumer é€šè¿‡ ZooKeeper æ‰¾åˆ° Brokerï¼Œç„¶åŽå†ä¸»åŠ¨ pull æ•°æ® 2.å®‰è£… kafka12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273740.é€‰æ‹©cs1 ~ cs6, 6å°ä¸»æœºéƒ½å®‰è£…kafka---------------------------------------------------------------------1.å‡†å¤‡zkç•¥---------------------------------------------------------------------2.jdkç•¥---------------------------------------------------------------------3.taræ–‡ä»¶---------------------------------------------------------------------4.çŽ¯å¢ƒå˜é‡---------------------------------------------------------------------ç•¥5.é…ç½®kafka--------------------------------------------------------------------- [kafka/config/server.properties] ... # è¿™é‡Œæ¯å°ä¸ä¸€æ · broker.id=1 ... listeners=PLAINTEXT://:9092 ... # è¿™é‡Œæ¯å°ä¸ä¸€æ · advertised.listeners=PLAINTEXT://cs1:9092 host.name=cs1 ... log.dirs=/home/centos/kafka/logs ... zookeeper.connect=s201:2181,s202:2181,s203:21816.åˆ†å‘æ•´ä¸ªæ–‡ä»¶ &amp; ç¬¦å·é“¾æŽ¥, .zshrcé…ç½®æ–‡ä»¶, åŒæ—¶ä¿®æ”¹æ¯ä¸ªserver.properties æ–‡ä»¶çš„broker.idå‚æ•° ---------------------------------------------------------------------7.å¯åŠ¨kafkaæœåŠ¡å™¨--------------------------------------------------------------------- a)å…ˆå¯åŠ¨zk b)å¯åŠ¨kafka b1)å‰å°å¯åŠ¨ [cs2 ~ cs4] [ap@cs1]~% kafka-server-start.sh /home/ap/apps/kafka/config/server.properties b2)åŽå°å¯åŠ¨ # è¿™é‡Œæ—¥å¿—ç›´æŽ¥æ‰“å°åœ¨æŽ§åˆ¶å° $&gt; kafka-server-start.sh -daemon /home/ap/apps/kafka/config/server.properties [æˆ–è€…] # è¿™æ ·èƒ½æŠŠæ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ nohup kafka-server-start.sh /home/ap/apps/kafka/config/server.properties 1&gt;&lt;sub&gt;/kafka/logs/kafka_std.log 2&gt;&lt;/sub&gt;/kafka/logs/kafka_err.log &amp; c)éªŒè¯kafkaæœåŠ¡å™¨æ˜¯å¦å¯åŠ¨ $&gt;netstat -anop | grep 90928.åˆ›å»ºä¸»é¢˜ --------------------------------------------------------------------- [ap@cs2]~% kafka-topics.sh --create --zookeeper cs1:2181 --replication-factor 3 --partitions 3 --topic test9.æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨---------------------------------------------------------------------[ap@cs2]~% kafka-topics.sh --list --zookeeper cs1:218110.å¯åŠ¨æŽ§åˆ¶å°ç”Ÿäº§è€… (å‰ææ˜¯ æ“ä½œæœ¬æœº &amp; cs2 ä¸Šå·²ç»å¯åŠ¨kafkaæœåŠ¡)--------------------------------------------------------------------- æ³¨æ„ : producer ä¸ç›´æŽ¥è¿žæŽ¥ zk, è€Œæ˜¯è¿žæŽ¥ broker, ä¹Ÿå°±æ˜¯ kafka server. å…¶å®ƒçš„éƒ½æ˜¯è¿ž zk å¦‚æžœproducer è¿žçš„æŸä¸€å°æŒ‚æŽ‰çš„è¯, å¯ä»¥åœ¨ --broker-list åŽé¢, åŠ ä¸Šå¤šå°æœåŠ¡å™¨,ç”¨é€—å·éš”å¼€ [ap@cs2]~% kafka-console-producer.sh --broker-list cs2:9092 --topic test11.å¯åŠ¨æŽ§åˆ¶å°æ¶ˆè´¹è€… (å‰ææ˜¯ æ“ä½œæœ¬æœº &amp; cs2 ä¸Šå·²ç»å¯åŠ¨å¡å¤«å¡æœåŠ¡)--------------------------------------------------------------------- # ä½¿ç”¨bootstrap-serverå‚æ•° æ›¿ä»£zookeeper Using the ConsoleConsumer with old consumer is deprecated and will be removed in a future major release. Consider using the new consumer by passing [bootstrap-server] instead of [zookeeper]. [ap@cs3]~% kafka-console-consumer.sh --bootstrap-server cs2:9092 --topic test --from-beginning12.åœ¨ç”Ÿäº§è€…æŽ§åˆ¶å°è¾“å…¥hello world--------------------------------------------------------------------- 3.kafkaé›†ç¾¤åœ¨zkçš„é…ç½®123456789101112131415161718192021222324/controller ===&gt; &#123;"version":1,"brokerid":202,"timestamp":"1490926369148"/controller_epoch ===&gt; 1/brokers/brokers/ids/brokers/ids/202 ===&gt; &#123;"jmx_port":-1,"timestamp":"1490926370304","endpoints":["PLAINTEXT://s202:9092"],"host":"s202","version":3,"port":9092&#125;/brokers/ids/203/brokers/ids/204 /brokers/topics/test/partitions/0/state ===&gt;&#123;"controller_epoch":1,"leader":203,"version":1,"leader_epoch":0,"isr":[203,204,202]&#125;/brokers/topics/test/partitions/1/state ===&gt;.../brokers/topics/test/partitions/2/state ===&gt;.../brokers/seqid ===&gt; null/admin/admin/delete_topics/test ===&gt;æ ‡è®°åˆ é™¤çš„ä¸»é¢˜, ä½†æ˜¯å®žé™…åˆ é™¤åŽ, è¿™é‡Œæ²¡å‡ºçŽ°/isr_change_notification/consumers/xxxx//config 4.kafka ä¸»é¢˜&amp;å‰¯æœ¬æ“ä½œ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110---------------------------------------------------------------------PS: æŸ¥çœ‹å¸®åŠ©å¥—è·¯* å¦‚æžœçœ‹ topic ç›¸å…³å¸®åŠ© * bin/kafka-topic.sh è„šæœ¬ç›´æŽ¥å›žè½¦, æŸ¥çœ‹å¸®åŠ©---------------------------------------------------------------------æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨---------------------------------------------------------------------[ap@cs2]~% kafka-topics.sqqh --list --zookeeper cs1:2181åˆ›å»ºä¸»é¢˜--------------------------------------------------------- repliation_factor 2 partitions 5 $&gt;kafka-topics.sh --zookeeper cs2:2181 --replication-factor 2 --partitions 3 --create --topic test2 2 x 3 = 6 //ä¸ªæ–‡ä»¶å¤¹ 2ä»½å‰¯æœ¬, æ¯ä»½å‰¯æœ¬æœ‰3ä¸ªåˆ†åŒº æ€»åˆ†åŒºæ•°ä¸º 6 æ¯ä¸ªåˆ†åŒºéƒ½æœ‰ä¸€ä¸ª leader, follower å°±æ˜¯å…¶å®ƒçš„å‰¯æœ¬ åˆ é™¤ä¸»é¢˜------------------------------------------------------------[ap@cs2]~% kafka-topics.sh --zookeeper cs1:2181,cs2:2181,cs3:2181 --delete --topic kafka_test1æŸ¥çœ‹ä¸»é¢˜æè¿°--------------------------------------------------------[ap@cs2]~% kafka-topics.sh --zookeeper cs1:2181,cs2:2181,cs3:2181 --describe --topic kafka_test1å¢žåŠ /åˆ é™¤åˆ†åŒºæ•°--------------------------------------------------------kafka-topics.sh \--alter \--zookeeper cs1:2181,cs2:2181,cs3:2181 \--topic kafka_test1 \--partitions 20--------------kafka-topics.sh \--alter \--zookeeper hadoop02:2181,hadoop03:2181,hadoop04:2181 \ --topic kafka_test \--replication-factor 2æŸ¥çœ‹æŸ topic æŸä¸ªåˆ†åŒºçš„åç§»é‡æœ€å¤§å€¼å’Œæœ€å°å€¼ :TODO å•¥æ„æ€??--------------------------------------------------------kafka-run-class.sh kafka.tools.GetOffsetShell --topic kafka_test1 --time -1 --broker-list cs1:9092,cs2:9092,cs3:9092 --partitions 1 é‡æ–°å¸ƒå±€åˆ†åŒºå’Œå‰¯æœ¬ï¼Œæ‰‹åŠ¨å†å¹³è¡¡ :TODO è¿˜æœªæµ‹è¯• ------------------------------------------------------------alter ä¼¼ä¹Žæ˜¯æœ‰é—®é¢˜çš„, createå¥½åƒæ²¡é—®é¢˜æ­¤å¥æ˜¯æ‰‹åŠ¨æŠŠåˆ†åŒºæ”¾åˆ° 203 &amp; 204ä¸Šäº† $&gt;kafka-topics.sh --alter --zookeeper s202:2181 --topic test2 --replica-assignment 203:204,203:204,203:204,203:204,203:204 æµ‹è¯• producer å‘æ¶ˆæ¯åŽ, å­˜åœ¨æœ¬åœ°çš„logs ç›®å½•çš„æ–‡ä»¶--------------------------------------------------------------1. å¼€å¯ä¸€ä¸ªproducer, å‘æ¶ˆæ¯2. æŸ¥çœ‹æœ¬åœ° cd ~/kafka/logs3. æŸ¥çœ‹æ–‡ä»¶å¤§å°, æ‰¾å‡ºæ–‡ä»¶(ä¸€æ¬¡æ€§æŸ¥çœ‹) 1. [ap@cs1]~% xcall.sh "ls -lh kafka/logs/test2-*" å‰¯æœ¬--------------------------------------------------------------brokerå­˜æ”¾æ¶ˆæ¯ä»¥æ¶ˆæ¯è¾¾åˆ°é¡ºåºå­˜æ”¾ã€‚ç”Ÿäº§å’Œæ¶ˆè´¹éƒ½æ˜¯å‰¯æœ¬æ„ŸçŸ¥çš„ã€‚æ”¯æŒåˆ°n-1æ•…éšœã€‚æ¯ä¸ªåˆ†åŒºéƒ½æœ‰leaderï¼Œfollow.leaderæŒ‚æŽ‰æ—¶ï¼Œæ¶ˆæ¯åˆ†åŒºå†™å…¥åˆ°æœ¬åœ°logæˆ–è€…ï¼Œå‘ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ç¡®è®¤å›žæ‰§ä¹‹å‰ï¼Œç”Ÿäº§è€…å‘æ–°çš„leaderå‘é€æ¶ˆæ¯ã€‚æ–°leaderçš„é€‰ä¸¾æ˜¯é€šè¿‡isrè¿›è¡Œï¼Œç¬¬ä¸€ä¸ªæ³¨å†Œçš„followeræˆä¸ºleaderã€‚## kafkaæ”¯æŒå‰¯æœ¬æ¨¡å¼, å°±æ˜¯ producer å†™åˆ° brokerçš„ topicä¸­çš„ partition çš„å‰¯æœ¬æœºåˆ¶---------------------[åŒæ­¥å¤åˆ¶] 1.producerè”ç³»zkè¯†åˆ«leader 2.å‘leaderå‘é€æ¶ˆæ¯ 3.leadræ”¶åˆ°æ¶ˆæ¯å†™å…¥åˆ°æœ¬åœ°log 4.followerä»Žleader pullæ¶ˆæ¯ 5.followerå‘æœ¬åœ°å†™å…¥log 6.followerå‘leaderå‘é€ackæ¶ˆæ¯ 7.leaderæ”¶åˆ°æ‰€æœ‰followerçš„ackæ¶ˆæ¯ 8.leaderå‘producerå›žä¼ ack [å¼‚æ­¥å‰¯æœ¬]-------------------------------------------------------------- å’ŒåŒæ­¥å¤åˆ¶çš„åŒºåˆ«åœ¨äºŽ leaderå†™å…¥æœ¬åœ°logä¹‹åŽï¼Œ ç›´æŽ¥å‘clientå›žä¼ ackæ¶ˆæ¯ï¼Œä¸éœ€è¦ç­‰å¾…æ‰€æœ‰followerå¤åˆ¶å®Œæˆã€‚ # kafka å‰¯æœ¬æ¨¡å¼ &amp; leader æœºåˆ¶ | å®˜æ–¹æ–‡æ¡£----------------------------------------------------ps : æŽ¨é€‰leaderè¿‡ç¨‹å°±æ˜¯followeråœ¨zkä¸­æ³¨å†Œè¿‡ç¨‹ï¼Œç¬¬ä¸€ä¸ªæ³¨å†Œå°±æ˜¯leaderThe process of choosing the new lead replica is that all followers' In-sync Replicas (ISRs) register themselves with ZooKeeper. The very first registered replica becomes the new lead replica, and the rest of the registered replicas become the followers.Kafka supports the following replication modes:â€¢ Synchronous replication: In synchronous replication, a producer first identifies the lead replica from ZooKeeper and publishes the message. As soon as the message is published, it is written to the log of the lead replica and all the followers of the lead start pulling the message, and by using a single channel, the order of messages is ensured. Each follower replica sends an acknowledgement to the lead replica once the message is written to its respective logs. Once replications are complete and all expected acknowledgements are received, the lead replica sends an acknowledgement to the producer.On the consumer side, all the pulling of messages is done from the lead replica.â€¢ Asynchronous replication: The only difference in this mode is that as soon as a lead replica writes the message to its local log, it sends the acknowledgement to the message client and does not wait for the acknowledgements from follower replicas. But as a down side, this mode does not ensure the message delivery in case of broker failure. 5.Kafka java API5.0 pom æ–‡ä»¶1234567891011121314151617181920212223242526272829&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.rox&lt;/groupId&gt; &lt;artifactId&gt;Kafka_Demo&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt; &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.11&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt; &lt;artifactId&gt;kafka_2.11&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 5.1å®žçŽ°æ¶ˆæ¯ç”Ÿäº§è€…ï¼Œå‘é€&amp;æŽ¥å— æ¶ˆæ¯12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576package com.rox.kafkademo.test;import kafka.consumer.Consumer;import kafka.consumer.ConsumerConfig;import kafka.consumer.ConsumerIterator;import kafka.consumer.KafkaStream;import kafka.producer.KeyedMessage$;import org.junit.Test;import kafka.javaapi.producer.Producer;import kafka.producer.KeyedMessage;import kafka.producer.ProducerConfig;import java.util.HashMap;import java.util.List;import java.util.Map;import java.util.Properties;public class TestProducer &#123; ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ // å‘é€æ¶ˆæ¯ producer @Test public void testSend() &#123; Properties props = new Properties(); // brokeråˆ—è¡¨ props.put("metadata.broker.list","cs2:9092"); // ä¸²è¡ŒåŒ– props.put("serializer.class", "kafka.serializer.StringEncoder"); props.put("request.required.acks", "1"); //åˆ›å»ºç”Ÿäº§è€…é…ç½®å¯¹è±¡ ProducerConfig config = new ProducerConfig(props); //åˆ›å»ºç”Ÿäº§è€… Producer&lt;String, String&gt; producer = new Producer&lt;String, String&gt;(config); KeyedMessage&lt;String, String&gt; msg = new KeyedMessage&lt;String, String&gt;("test2", "100", "hello word fuck you kafka"); // å‘é€ producer.send(msg); System.out.println("å‘é€å®Œæˆ"); &#125;ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ // æŽ¥æ”¶æ¶ˆæ¯ consumer @Test public void testConsumer() &#123; Properties props = new Properties(); props.put("zookeeper.connect", "cs2:2181"); props.put("group.id", "g2"); props.put("zookeeper.session.timeout.ms", "500"); props.put("auto.commit.interval.ms", "1000"); props.put("auto.offset.reset", "smallest"); // åˆ›å»ºæ¶ˆè´¹è€…é…ç½®å¯¹è±¡ ConsumerConfig config = new ConsumerConfig(props); Map&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;(); map.put("test2", new Integer(1)); Map&lt;String, List&lt;KafkaStream&lt;byte[], byte[]&gt;&gt;&gt; msgs = Consumer.createJavaConsumerConnector(new ConsumerConfig(props)).createMessageStreams(map); List&lt;KafkaStream&lt;byte[], byte[]&gt;&gt; msgList = msgs.get("test2"); for(KafkaStream&lt;byte[],byte[]&gt; stream : msgList)&#123; ConsumerIterator&lt;byte[],byte[]&gt; it = stream.iterator(); while(it.hasNext())&#123; byte[] message = it.next().message(); System.out.println(new String(message)); &#125; &#125; &#125;&#125; 5.2 æ–°çš„ API6.Flume é›†æˆ kafak6.1KafkaSinkkafka æ˜¯ consumer (æ¶ˆè´¹è€…) flume çš„æ¶ˆæ¯, ç»ç”± kafkaSink å¯¼å‡ºåˆ° kafka â€“æœ€å¸¸ç”¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273[flume ä¸ºç”Ÿäº§è€…]1.1) flume å‚æ•°é…ç½® ---------------------------------------------------- a1.sources = r1 a1.sinks = k1 a1.channels = c1 a1.sources.r1.type=netcat a1.sources.r1.bind=localhost a1.sources.r1.port=8888 a1.sinks.k1.type = org.apache.flume.sink.kafka.KafkaSink a1.sinks.k1.kafka.topic = test3 a1.sinks.k1.kafka.bootstrap.servers = cs2:9092 a1.sinks.k1.kafka.flumeBatchSize = 20 a1.sinks.k1.kafka.producer.acks = 1 a1.channels.c1.type=memory a1.sources.r1.channels = c1 a1.sinks.k1.channel = c11.2) å¼€å¯ kafka æ¶ˆè´¹è€…---------------------------------------------------- kafka-console-consumer.sh --bootstrap-server cs2:9092 --topic test3 --from-beginning æ³¨æ„ : Consider using the new consumer by passing [bootstrap-server] instead of [zookeeper]. ä½¿ç”¨ [bootstrap-server]ä»£æ›¿[zookeeper]1.3) flume æ‰§è¡Œ kafka_sink.conf ---------------------------------------------------- flume-ng agent -f apps/flume/conf/confs/kafka_sink.conf -n a11.4) éªŒè¯ç«¯å£---------------------------------------------------- netstat -anop | grep 8888 [OR] lsof -i tcp:88881.5) nc è¿žæŽ¥---------------------------------------------------- nc localhost 8888 å‘æ¶ˆæ¯....1.6) è§‚å¯Ÿ kafka æ¶ˆè´¹è€…æŽ¥å—æ¶ˆæ¯---------------------------------------------------- å‘çŽ°ç‰¹åˆ«å¿«! ========================================================ç®€å•æ¡ˆä¾‹2--------------a1.sources = r1a1.sinks = k1a1.channels = c1a1.sources.r1.type=exec#-F æœ€åŽ10è¡Œ,å¦‚æžœä»Žå¤´å¼€å§‹æ”¶é›† -c +0 -F:æŒç»­æ”¶é›†åŽç»­æ•°æ®,å¦åˆ™è¿›ç¨‹åœæ­¢ã€‚a1.sources.r1.command=tail -F -c +0 /home/ap/calllog/calllog.loga1.channels.c1.type=memorya1.sinks.k1.type = org.apache.flume.sink.kafka.KafkaSinka1.sinks.k1.kafka.topic = callloga1.sinks.k1.kafka.bootstrap.servers = cs2:9092 cs3:9092 cs4:9092# How many messages to process in one batch. Larger batches improve throughput while adding latency.a1.sinks.k1.kafka.flumeBatchSize = 20# How many replicas must acknowledge a message before its considered successfully written. Accepted values are 0 (Never wait for acknowledgement), 1 (wait for leader only), -1 (wait for all replicas) Set this to -1 to avoid data loss in some cases of leader failure.a1.sinks.k1.kafka.producer.acks = 1a1.sources.r1.channels = c1a1.sinks.k1.channel = c1 6.2 KafkaSource :TODOflume source ä»Ž kafka æŠ“æ•°æ®, flume source æ˜¯æ¶ˆè´¹è€…, kafka å¼€å¯ producer. 123456789101112131415161718192021222324252627[æ¶ˆè´¹è€…]1) é…ç½® a1.sources = r1 a1.sinks = k1 a1.channels = c1 a1.sources.r1.type = org.apache.flume.source.kafka.KafkaSource a1.sources.r1.batchSize = 5000 a1.sources.r1.batchDurationMillis = 2000 a1.sources.r1.kafka.bootstrap.servers = cs2:9092 a1.sources.r1.kafka.topics = test3 a1.sources.r1.kafka.consumer.group.id = g4 a1.sinks.k1.type = logger a1.channels.c1.type=memory a1.sources.r1.channels = c1 a1.sinks.k1.channel = c12) å¯åŠ¨ flume flume-ng agent -f /home/ap/apps/flume/conf/confs/kafka_source.conf -n a1 -Dflume.root.logger=INFO,console3) å¯åŠ¨ kafka producer kafka-console-producer.sh --broker-list cs2:9092 --topic test3 4) kafka å‘æ¶ˆæ¯: æ”¶ä¸åˆ°!!!! :TODO 6.3 KafkaChannel :TODO12345678910111213141516171819202122:TODO ä¹Ÿå‡ºé”™ ?? è¶Šç•Œ ç”Ÿäº§è€… + æ¶ˆè´¹è€… a1.sources = r1 a1.sinks = k1 a1.channels = c1 a1.sources.r1.type = avro a1.sources.r1.bind = localhost a1.sources.r1.port = 8888 a1.sinks.k1.type = logger a1.channels.c1.type = org.apache.flume.channel.kafka.KafkaChannel a1.channels.c1.kafka.bootstrap.servers = cs2:9092 a1.channels.c1.kafka.topic = test3 a1.channels.c1.kafka.consumer.group.id = g6 a1.channels.c1.kafka.parseAsFlumeEvent = false a1.channels.c1.zookeeperConnect= cs2:2181 a1.sources.r1.channels = c1 a1.sinks.k1.channel = c1]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Kafka</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Kafka</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flume]]></title>
    <url>%2F2018%2F06%2F30%2FHadoop%2F7-Flume%26Kafka%2FFlume%2F</url>
    <content type="text"><![CDATA[1.Flume æ¦‚å¿µæä¾› æ”¶é›†ã€ç§»åŠ¨ã€èšåˆå¤§é‡æ—¥å¿—æ•°æ®çš„æœåŠ¡ã€‚ åŸºäºŽæµæ•°æ®çš„æž¶æž„ï¼Œç”¨äºŽåœ¨çº¿æ—¥å¿—åˆ†æžã€‚ åŸºäºŽäº‹ä»¶ã€‚ åœ¨ç”Ÿäº§å’Œæ¶ˆè´¹è€…ä¹‹é—´å¯åŠ¨åè°ƒä½œç”¨ã€‚ æä¾›äº†äº‹åŠ¡ä¿è¯ï¼Œç¡®ä¿æ¶ˆæ¯ä¸€å®šè¢«åˆ†å‘ã€‚ å¤šç§ Source, Channel, Sinké…ç½®æ–¹å¼ã€‚ ä¸Ž Sqoop åŒºåˆ« Sqoop ç”¨æ¥é‡‡é›†å…³ç³»åž‹æ•°æ®åº“æ•°æ® Flume ç”¨ æ¥é‡‡é›†æµåŠ¨åž‹æ•°æ®ã€‚ å…³é”®è¯è§£é‡Š Client Client æ˜¯ä¸€ä¸ªå°†åŽŸå§‹ log åŒ…è£…æˆ events å¹¶ä¸”å‘é€ä»–ä»¬åˆ°ä¸€ä¸ªæˆ–å¤šä¸ª agent çš„å®žä½“, äº¤ç»™ source å¤„ç† Event Event ç”±å¯é€‰çš„ header å’Œè½½æœ‰æ•°æ®çš„ä¸€ä¸ª byte array æž„æˆã€‚ Source æŽ¥å—æ•°æ®ï¼Œç±»åž‹æœ‰å¤šç§ã€‚ Channel ä¸´æ—¶å­˜æ”¾åœ°ï¼Œå¯¹Sourceä¸­æ¥çš„æ•°æ®è¿›è¡Œç¼“å†²ï¼Œç›´åˆ°sinkæ¶ˆè´¹æŽ‰ã€‚ Sink ä»Žchannelæå–æ•°æ®å­˜æ”¾åˆ°ä¸­å¤®åŒ–å­˜å‚¨(hadoop / hbase)ã€‚ Iterator ä½œç”¨äºŽ Sourceï¼ŒæŒ‰ç…§é¢„è®¾çš„é¡ºåºåœ¨å¿…è¦åœ°æ–¹è£…é¥°å’Œè¿‡æ»¤ events Channel Selector å…è®¸ Source åŸºäºŽé¢„è®¾çš„æ ‡å‡†ï¼Œä»Žæ‰€æœ‰ channel ä¸­ï¼Œé€‰æ‹©ä¸€ä¸ªæˆ–è€…å¤šä¸ª channel A simple Flume agent with one source, channel, and sink Source ==&gt;Channel Channel Flume çš„æ•°æ®æµç”±äº‹ä»¶(Event)è´¯ç©¿å§‹ç»ˆã€‚äº‹ä»¶æ˜¯ Flume çš„åŸºæœ¬æ•°æ®å•ä½ï¼Œå®ƒæºå¸¦æ—¥å¿—æ•°æ®(å­— èŠ‚æ•°ç»„å½¢å¼)å¹¶ä¸”æºå¸¦æœ‰å¤´ä¿¡æ¯ï¼Œè¿™äº› Event ç”± Agent å¤–éƒ¨çš„ Source ç”Ÿæˆï¼Œå½“ Source æ•èŽ·äº‹ ä»¶åŽä¼šè¿›è¡Œç‰¹å®šçš„æ ¼å¼åŒ–ï¼Œç„¶åŽ Source ä¼šæŠŠäº‹ä»¶æŽ¨å…¥(å•ä¸ªæˆ–å¤šä¸ª)Channel ä¸­ã€‚ä½ å¯ä»¥æŠŠ Channel çœ‹ä½œæ˜¯ä¸€ä¸ªç¼“å†²åŒºï¼Œå®ƒå°†ä¿å­˜äº‹ä»¶ç›´åˆ° Sink å¤„ç†å®Œè¯¥äº‹ä»¶ã€‚Sink è´Ÿè´£æŒä¹…åŒ–æ—¥å¿—æˆ– è€…æŠŠäº‹ä»¶æŽ¨å‘å¦ä¸€ä¸ª Sourceã€‚ Flume ä»¥ agent ä¸ºæœ€å°çš„ç‹¬ç«‹è¿è¡Œå•ä½ã€‚ä¸€ä¸ª agent å°±æ˜¯ä¸€ä¸ª JVMã€‚å• agent ç”± Sourceã€Sink å’Œ Channel ä¸‰å¤§ç»„ä»¶æž„æˆï¼Œå¦‚ä¸‹å›¾: å‚è€ƒæ–‡æ¡£ 2.å®‰è£… Flume1.ä¸‹è½½2.tar3.çŽ¯å¢ƒå˜é‡æ³¨æ„: é…ç½®çš„è¯, ä½¿ç”¨è„šæœ¬å°±æ–¹ä¾¿äº›, ä½†æ˜¯å¦‚æžœé…ç½®æ–‡ä»¶åœ¨ flume æ–‡ä»¶å¤¹ä¸­, è·¯å¾„å°±æ¯”è¾ƒé•¿ â€‹ ä¸é…ç½®çš„è¯, è¦è¿›å…¥åˆ°flume è·¯å¾„ä¸‹ä½¿ç”¨, ä½†æ˜¯æ­¤æ—¶é…ç½®æ–‡ä»¶çš„è·¯å¾„å°±æ¯”è¾ƒçŸ­äº† PS: å¦‚æžœ.shæ–‡ä»¶æ²¡æœ‰æ‰§è¡Œæƒé™, å³xæƒé™, è¦ç”¨ç›¸å¯¹è·¯å¾„æ¥å¯åŠ¨, å³å¦‚æžœåœ¨ bin ç›®å½•, è¦ç”¨./flume-ng, åœ¨ bin å¤–,è¦ç”¨ bin/flumeæ‰§è¡Œ, æœ‰xæƒé™çš„è¯, å°±å¯ä»¥ç›´æŽ¥åœ¨ bin ä¸‹, ä½¿ç”¨ flume-ng, å¦‚æžœé…ç½®äº†çŽ¯å¢ƒå˜é‡, å¯ä»¥åœ¨ä»»ä½•è·¯å¾„ä¸‹ä½¿ç”¨ flume-ngäº†. Open flume-env.sh file and set the JAVA_Home to the folder where Java was installed in your system. 1export JAVA_HOME=/usr/local/jdk1.8.0_73 In the .zshrc file, set FLUME_HOME 12345#flumeexport FLUME_HOME=/home/ap/apps/flumeexport PATH=$PATH:$FLUME_HOME/bin---source .zshrc 4.éªŒè¯` $&gt; flume-ng version` //next generation.ä¸‹ä¸€ä»£. 3.é…ç½®flumeå‡†å¤‡å·¥ä½œ3.0å¦‚æžœ yum æ²¡æœ‰è®¾ç½®ç½‘ç»œæºçš„, è®¾ç½®ä¸€ä¸‹ é˜¿é‡Œ | ç½‘æ˜“123456789101112# å…ˆå¤‡ä»½åŽŸæ¥çš„ CentOS-Base.repo ä¸º CentOS-Base.repo.bakmv CentOS-Base.repo CentOS-Base.repo.bak# ä¸‹è½½é˜¿é‡ŒåŸºæœ¬æº $&gt;sudo wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo# ä¸‹è½½é˜¿é‡Œepelæº$&gt;sudo wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo# ç”Ÿæˆç¼“å­˜æ–‡ä»¶$&gt;sudo yum clean all$&gt;sudo yum makecache 3.1 æ‰€æœ‰æœºå™¨å®‰è£… nc æˆ–è€… telnet123$&gt;yum search nc$&gt; xcall.sh sudo yum install -y nc.x86_64$&gt; xcall.sh sudo yum install -y telnet 3.2 ä½¿ç”¨ nc123456789101112cs1_1&gt; nc -lk 8888 : å¼€å¯8888ç«¯å£ç›‘å¬-------å†å¼€ä¸€ä¸ªcs1 sessioncs1_2&gt; netstat -anop | grep 8888 : æŸ¥çœ‹æ˜¯æœ‰æœ‰æ­¤ç«¯å£æˆ–è€… &gt; lsof -i tcp:8888 : å¯ä»¥ç›´æŽ¥çœ‹åˆ° pidtcp 0 0 0.0.0.0:8888 0.0.0.0:* LISTEN 17251/nc off (0.00/0/0)---------æœ‰çš„è¯å°±å¯ä»¥æµ‹è¯•è¿žæŽ¥äº† (å®¢æˆ·ç«¯è¿žæŽ¥)cs1_2&gt; nc localhost 8888 ==================telnet ä½¿ç”¨æ–¹å¼ç±»ä¼¼, å¯æŸ¥çœ‹å¸®åŠ© 4. flumeé…ç½®å®˜æ–¹æ–‡æ¡£ æ€»ä½“æ¦‚è¿° å®žæ—¶å¤„ç†æž¶æž„flume: ç›‘æŽ§æ—¥å¿—æ–‡ä»¶ æ¯æ¬¡äº§ç”Ÿä¸€æ¡æ–°çš„æ•°æ®, ä¼šè¢«å®žæ—¶çš„æ”¶é›†åˆ°ä¸‹ä¸€è·³ Kafka: æ¶ˆæ¯ç³»ç»Ÿ å¯¹æ¶ˆæ¯è¿›è¡Œç®€å•å¤„ç†, å½“ç„¶, å…·æœ‰ç®€å•ç¼“å†²ä½œç”¨ Storm / SparkStreaming: æµå¼çš„åˆ†å¸ƒå¼è®¡ç®—å¼•æ“Ž Redis: ç¼“å­˜ç»„ä»¶ å†…å­˜æ•°æ®åº“ Hbase / HDFS /ES â€¦: æœ€åŽæŒä¹…åŒ–åˆ°è¿™äº›åœ°æ–¹.. 4.1 Flume Sourceæ³¨æ„: å¯åŠ¨ flume é…ç½®çš„æ—¶å€™, åŽé¢åŠ ä¸Š -Dflume.root.logger=INFO,console è¿˜æœ‰ä¸€ç§æ›´è¯¦ç»†çš„ : -Dflume.root.logger=DEBUG,console ä¼šæ‰“å°æ›´è¯¦ç»†çš„æ—¥å¿— 4.1.1 netcaté€šè¿‡æ¶ˆæ¯é€šä¿¡çš„æ–¹å¼, è¿›è¡Œé‡‡é›† 1234567891011121314151617181920212223242526272829303132331.åˆ›å»ºé…ç½®æ–‡ä»¶ [/soft/flume/conf/helloworld.conf] #å£°æ˜Žä¸‰ç§ç»„ä»¶ a1.sources = r1 a1.channels = c1 a1.sinks = k1 #å®šä¹‰sourceä¿¡æ¯ a1.sources.r1.type=netcat a1.sources.r1.bind=localhost a1.sources.r1.port=8888 #å®šä¹‰sinkä¿¡æ¯ a1.sinks.k1.type=logger #å®šä¹‰channelä¿¡æ¯ a1.channels.c1.type=memory #ç»‘å®šåœ¨ä¸€èµ· ps: æ³¨æ„: ä¸€ä¸ªsource(æº) å¯ä»¥è¾“å‡ºåˆ°å¤šä¸ª channels(é€šé“) ä¸€ä¸ªsink(æ²‰æ¼•)åªèƒ½ä»Žä¸€ä¸ª channel(é€šé“)ä¸­èŽ·å–æ•°æ® a1.sources.r1.channels=c1 a1.sinks.k1.channel=c1 2.è¿è¡Œ a)å¯åŠ¨flume agent $&gt; bin/flume-ng agent -f conf/helloworld.conf -n a1 -Dflume.root.logger=INFO,console b)å¯åŠ¨ncçš„å®¢æˆ·ç«¯ $&gt;nc localhost 8888 $nc&gt;hello world c)åœ¨flumeçš„ç»ˆç«¯è¾“å‡ºhello world. 4.1.2 execå®žæ—¶æ—¥å¿—æ”¶é›†,å®žæ—¶æ”¶é›†æ—¥å¿—ã€‚ æµ‹è¯•: å…ˆå¯åŠ¨ç›‘æŽ§, å†åˆ›å»ºæ–‡ä»¶, èƒ½å¦ç›‘æŽ§åˆ° ç»“è®º: å¯ä»¥ç›‘æŽ§åˆ° 123456789101112131415161718192021222324252627281. é…ç½® # å£°æ˜Ž3ç§ç»„ä»¶ a1.sources=r1 a1.channels=c1 a1.sinks=k1 # å®šä¹‰ source ä¿¡æ¯ a1.sources.r1.type=exec a1.sources.r1.command=tail -F /home/ap/test.txt #æ”¶é›†æœ€åŽçš„10è¡Œ a1.sources.r1.command=tail -F -c +0 /home/ap/test.txt #ä»Žç¬¬0è¡Œå¼€å§‹æ”¶é›† # å®šä¹‰ sink ä¿¡æ¯ a1.sinks.k1.type=logger # å®šä¹‰ channel ä¿¡æ¯ a1.channels.c1.type=memory # ç»‘å®šåœ¨ä¸€èµ· a1.sources.r1.channels=c1 a1.sinks.k1.channel=c12&gt; æ–°å»ºæ–‡ä»¶ test.txt3&gt; å¯åŠ¨ [ap@cs1]~% flume-ng agent -f apps/flume/conf/confs/exec.conf -n a1 -Dflume.root.logger=INFO,console4&gt; ä¿®æ”¹ test.txt æ–‡ä»¶$&gt; echo ddd &gt; test.txt è§‚å¯Ÿ agent æŽ§åˆ¶å°å˜åŒ– 4.1.3 æ‰¹é‡æ”¶é›†(spool)ç›‘æŽ§ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé™æ€æ–‡ä»¶ã€‚ æ–‡ä»¶æœ€å¥½æ˜¯ç›´æŽ¥ä»Žå¤–éƒ¨ç§»å…¥, æ–‡ä»¶å¤¹å†…æœ€å¥½ä¸è¦åšæ–‡ä»¶ç¼–è¾‘ã€‚ æ”¶é›†å®Œä¹‹åŽï¼Œä¼šé‡å‘½åæ–‡ä»¶æˆæ–°æ–‡ä»¶ã€‚.compeleted. ä¹‹åŽå°±ä¸ä¼šå†æ¬¡å¤„ç†è¿™ä¸ªæ–‡ä»¶äº†. åªä¼šç›‘æŽ§æ–°å¢žåŠ çš„æ–‡ä»¶, ä¸ä¼šç›‘æŽ§åˆ é™¤çš„æœ¬åœ°æ–‡ä»¶. 123456789101112131415161718192021222324252627a) é…ç½® # å£°æ˜Ž3ç§ç»„ä»¶ a1.sources=r1 a1.channels=c1 a1.sinks=k1 # å®šä¹‰ source ä¿¡æ¯ a1.sources.r1.type=spooldir a1.sources.r1.spoolDir=/home/ap/spool a1.sources.r1.fileHeader=true # å®šä¹‰ sink ä¿¡æ¯ a1.sinks.k1.type=logger # å®šä¹‰ channel ä¿¡æ¯ a1.channels.c1.type=memory # ç»‘å®šåœ¨ä¸€èµ· a1.sources.r1.channels=c1 a1.sinks.k1.channel=c1b)åˆ›å»ºç›®å½• $&gt;mkdir ~/spoolc)å¯åŠ¨flumeå¯ä»¥ç›´æŽ¥å¯åŠ¨ $&gt;flume-ng agent -f apps/flume/conf/confs/spool.conf -n a1 -Dflume.root.logger=INFO,console 4.1.4 åºåˆ—sources (seq)ä¸€ä¸ªç®€å•çš„åºåˆ—ç”Ÿæˆå™¨, å®ƒè¿žç»­ç”Ÿæˆä¸€ä¸ªè®¡æ•°å™¨, å®ƒä»Ž0å¼€å§‹, å¢žé‡ä¸º 1, å¹¶åœ¨ totalEvents åœæ­¢ã€‚ ä¸»è¦ç”¨äºŽæµ‹è¯•ã€‚ 1234567891011121314151617181920212223241) é…ç½®# å£°æ˜Ž3ç§ç»„ä»¶a1.sources=r1a1.channels=c1a1.sinks=k1# å®šä¹‰ source ä¿¡æ¯a1.sources.r1.type=seqa1.sources.r1.totalEvents=1000# å®šä¹‰ sink ä¿¡æ¯a1.sinks.k1.type=logger# å®šä¹‰ channel ä¿¡æ¯a1.channels.c1.type=memory# ç»‘å®šåœ¨ä¸€èµ·a1.sources.r1.channels=c1a1.sinks.k1.channel=c12) è¿è¡Œ$&gt;bin/flume-ng agent -f conf/confs/helloworld.seq.conf -n a1 -Dflume.root.logger=INFO,console 4.1.5 åŽ‹åŠ› source (ç”¨äºŽåŽ‹åŠ›æµ‹è¯•)123456a1.sources = stresssource-1a1.channels = memoryChannel-1a1.sources.stresssource-1.type = org.apache.flume.source.StressSourcea1.sources.stresssource-1.size = 10240a1.sources.stresssource-1.maxTotalEvents = 1000000a1.sources.stresssource-1.channels = memoryChannel-1 4.1.6 Multiplexing Channel Selector :TODOflume å¤šè·¯å¤ç”¨ å®˜ç½‘ 4.2. Flume Sinkæ²‰æ¼•, source ç»è¿‡ channel, æœ€åŽä¸‹æ²‰åˆ° sink, å†ç”± sink è¾“å‡º æ³¨æ„, flume åŽé¢åŠ ä¸Š &amp;æ˜¯æŒ‡åŽå°è¿è¡Œ å®˜ç½‘ 4.2.1è¾“å‡º (sink) åˆ° HDFS123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384851) é…ç½®===================================================================a1.sources = r1a1.channels = c1a1.sinks = k1a1.sources.r1.type = netcata1.sources.r1.bind = localhosta1.sources.r1.port = 8888a1.sinks.k1.type = hdfsa1.sinks.k1.hdfs.path = /flume/events/%y-%m-%d/%H/%M/%Sa1.sinks.k1.hdfs.filePrefix = events-# roundç›®å½• æ˜¯å¦ä¼šäº§ç”Ÿæ–°ç›®å½•,æ¯ååˆ†é’Ÿäº§ç”Ÿä¸€ä¸ªæ–°ç›®å½•,ä¸€èˆ¬æŽ§åˆ¶çš„ç›®å½•æ–¹é¢ã€‚#2017-12-12 --&gt;#2017-12-12 --&gt;%H%M%Sæ¯”å¦‚ å†™ä¸Š 1 / day, å°±æ˜¯ä¸€å¤©äº§ç”Ÿçš„æ•°æ®æ–‡ä»¶éƒ½åœ¨ ä¸€ä¸ªæ—¥æœŸçš„ç›®å½•ä¸‹.---a1.sinks.k1.hdfs.round = true a1.sinks.k1.hdfs.roundValue = 1a1.sinks.k1.hdfs.roundUnit = day#ä½¿ç”¨æœ¬åœ°æ—¶é—´æˆ³ä¸ºæ—¶é—´åºåˆ—å¤´ a1.sinks.k1.hdfs.useLocalTimeStamp=true#æ˜¯å¦äº§ç”Ÿæ–°æ–‡ä»¶ã€‚ -------------åªè¦3ä¸ªæ¡ä»¶ä¸­æŸä¸€ä¸ªæ»¡è¶³, å°±ä¼šæ»šåŠ¨ä¸€ä¸ªæ–‡ä»¶# rollæ»šåŠ¨, æ­¤äº‹ä»¶å†…çš„æ—¥å¿—ä¼šå†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶# ç›®å‰çš„çŒœæµ‹: 10ä¸ªå­—èŠ‚å°±ä¼šè§¦å‘, å¦‚æžœ10ç§’å†… 0 &lt; input &lt; 10å­—èŠ‚, ä¹Ÿä¼šæ»šåŠ¨ =&gt; æ˜¯çš„# ç­‰å¾…æ»šåŠ¨å½“å‰çš„æ–‡ä»¶ 10ç§’,Number of seconds to wait before rolling current file (0 = never roll based on time interval)a1.sinks.k1.hdfs.rollInterval=10 # è¿™æ˜¯æŒ‡10ä¸ªå­—èŠ‚å°±è§¦å‘æ»šåŠ¨ File size to trigger roll, in bytes (0: never roll based on file size) a1.sinks.k1.hdfs.rollSize=10 # Number of events written to file before it rolled (0 = never roll based on number of events) ä¸€è¡Œå°±æ˜¯ä¸€ä¸ªäº‹ä»¶ a1.sinks.k1.hdfs.rollCount=3 a1.channels.c1.type=memorya1.sources.r1.channels = c1a1.sinks.k1.channel = c1-----------------# sinkå…¶å®ƒå¯é€‰é…ç½®å‚æ•°(è¯¦æƒ…å¯æŸ¥å®˜ç½‘)agent1.sinks.sink1.type = hdfs#a1.sinks.k1.channel = c1agent1.sinks.sink1.hdfs.path =hdfs://myha01/weblog/flume-event/%y-%m-%d/%H-%M agent1.sinks.sink1.hdfs.filePrefix = tomcat_agent1.sinks.sink1.hdfs.maxOpenFiles = 5000agent1.sinks.sink1.hdfs.batchSize= 100agent1.sinks.sink1.hdfs.fileType = DataStreamagent1.sinks.sink1.hdfs.writeFormat =Textagent1.sinks.sink1.hdfs.rollSize = 102400agent1.sinks.sink1.hdfs.rollCount = 1000000agent1.sinks.sink1.hdfs.rollInterval = 60agent1.sinks.sink1.hdfs.round = trueagent1.sinks.sink1.hdfs.roundValue = 10agent1.sinks.sink1.hdfs.roundUnit = minuteagent1.sinks.sink1.hdfs.useLocalTimeStamp = true&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;å¦‚æžœ HDFS é›†ç¾¤æ˜¯é«˜å¯ç”¨é›†ç¾¤ï¼Œé‚£ä¹ˆå¿…é¡»è¦æ”¾å…¥ core-site.xml å’Œ hdfs-site.xml æ–‡ä»¶åˆ° $FLUME_HOME/conf/confs ç›®å½•ä¸­, å°±æ˜¯è·Ÿé…ç½®æ–‡ä»¶åŒçº§ç›®å½•.&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;2) å¼€å¯agent===================================================================[ap@cs1]~/apps/flume/conf/confs% flume-ng agent -f hdfs.conf -n a13) nc è¿žæŽ¥===================================================================nc local 8888è¿žæŽ¥ä¸Šäº†ä¹‹åŽ, å‘å‡ºåŽ»çš„æ¶ˆæ¯å°±ä¼šå†™å…¥ hdfs 4) å†™å…¥æ—¶, å®Œæ•´çš„ log æ˜¯è¿™æ ·çš„===================================================================18/06/30 18:39:18 INFO hdfs.HDFSSequenceFile: writeFormat = Writable, UseRawLocalFileSystem = false18/06/30 18:39:18 INFO hdfs.BucketWriter: Creating /user/ap/flume/events/18-06-30/18/39/00/events-.1530355158463.tmp18/06/30 18:39:28 INFO hdfs.BucketWriter: Closing /user/ap/flume/events/18-06-30/18/39/00/events-.1530355158463.tmp18/06/30 18:39:28 INFO hdfs.BucketWriter: Renaming /user/ap/flume/events/18-06-30/18/39/00/events-.1530355158463.tmp to /user/ap/flume/events/18-06-30/18/39/00/events-.153035515846318/06/30 18:39:28 INFO hdfs.HDFSEventSink: Writer callback called.5) æŸ¥çœ‹ ===================================================================æ³¨æ„: åºåˆ—æ–‡ä»¶ç”¨ text æŸ¥çœ‹ 4.2.2 è¾“å‡ºåˆ° Hiveå†™å…¥å¤ªæ…¢, å› ä¸ºè¦è½¬ä¸º MR, æ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç”¨ 4.2.3 è¾“å‡º (sink) åˆ° HBase123456789101112131415161718192021222324253.1) é…ç½®æ–‡ä»¶===================================================================a1.sources = r1a1.channels = c1a1.sinks = k1a1.sources.r1.type = netcata1.sources.r1.bind = localhosta1.sources.r1.port = 8888a1.sinks.k1.type = hbasea1.sinks.k1.table = ns1:t12a1.sinks.k1.columnFamily = f1a1.sinks.k1.serializer = org.apache.flume.sink.hbase.RegexHbaseEventSerializera1.channels.c1.type=memorya1.sources.r1.channels = c1a1.sinks.k1.channel = c13.2) å¼€å¯ nc è¾“å…¥===================================================================3.3) åœ¨ hbase shell ä¸­ scan è¡¨ 'ns1:t12'=================================================================== 4.2.4 è¾“å‡ºåˆ° kafka:TODO 4.3. Flume Channel4.3.1.Memory Channelä»¥ä¸Šç”¨çš„éƒ½æ˜¯Memory Channel, ä¸å†æ˜¾ç¤º 4.3.2 FileChannel1234567891011121314151617181920212223242526271) é…ç½®===================================================================a1.sources = r1a1.sinks= k1a1.channels = c1a1.sources.r1.type=netcata1.sources.r1.bind=localhosta1.sources.r1.port=8888a1.sinks.k1.type=loggera1.channels.c1.type = filea1.channels.c1.checkpointDir = /home/centos/flume/fc_checka1.channels.c1.dataDirs = /home/centos/flume/fc_dataa1.sources.r1.channels=c1a1.sinks.k1.channel=c12) åˆ›å»ºçš„æ–‡ä»¶å¤§æ¦‚æ˜¯è¿™æ ·===================================================================$~/flumedata&gt; ls -r fc*fc_data:log-1.meta log-1 in_use.lockfc_check:queueset in_use.lock inflighttakes inflightputs checkpoint.meta checkpoint 4.3.3 å¯æº¢å‡ºæ–‡ä»¶é€šé“This channel is currently experimental and not recommended for use in production. 123456789101112[spillable_channel.conf]a1.channels = c1a1.channels.c1.type = SPILLABLEMEMORY#0è¡¨ç¤ºç¦ç”¨å†…å­˜é€šé“ï¼Œç­‰ä»·äºŽæ–‡ä»¶é€šé“a1.channels.c1.memoryCapacity = 0#0,ç¦ç”¨æ–‡ä»¶é€šé“ï¼Œç­‰ä»·å†…å­˜é€šé“ã€‚a1.channels.c1.overflowCapacity = 2000a1.channels.c1.byteCapacity = 800000a1.channels.c1.checkpointDir = /user/centos/flume/fc_checka1.channels.c1.dataDirs = /user/centos/flume/fc_data 4.4 ä½¿ç”¨AvroSourceå’ŒAvroSinkå®žçŽ°è·ƒç‚¹agentå¤„ç† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869 [avro_hop.conf]############ ï£¿a1ï£¿ ############# å£°æ˜Ž3ç§ç»„ä»¶a1.sources=r1a1.channels=c1a1.sinks=k1# å®šä¹‰ source ä¿¡æ¯a1.sources.r1.type=netcata1.sources.r1.bind=localhosta1.sources.r1.port=8888# å®šä¹‰ sink ä¿¡æ¯a1.sinks.k1.type=avroa1.sinks.k1.hostname=localhosta1.sinks.k1.port=9999# å®šä¹‰ channel ä¿¡æ¯a1.channels.c1.type=memory# ç»‘å®šåœ¨ä¸€èµ·a1.sources.r1.channels=c1a1.sinks.k1.channel=c1############ ï£¿a2ï£¿ ############# å£°æ˜Ž3ç§ç»„ä»¶a2.sources=r2a2.channels=c2a2.sinks=k2# å®šä¹‰ source ä¿¡æ¯# source æ˜¯ avro, ç»‘å®šç«¯å£9999a2.sources.r2.type=avroa2.sources.r2.bind=localhosta2.sources.r2.port=9999# å®šä¹‰ sink ä¿¡æ¯# sink æ‰“å°åˆ°æŽ§åˆ¶å°a2.sinks.k2.type=logger# å®šä¹‰ channel ä¿¡æ¯a2.channels.c2.type=memory# ç»‘å®šåœ¨ä¸€èµ·a2.sources.r2.channels=c2a2.sinks.k2.channel=c22.å¯åŠ¨a2===================================================================$&gt;flume-ng agent -f /soft/flume/conf/avro_hop.conf -n a2 -Dflume.root.logger=INFO,console3.éªŒè¯a2===================================================================$&gt;netstat -anop | grep 99994.å¯åŠ¨a1===================================================================$&gt;flume-ng agent -f /soft/flume/conf/avro_hop.conf -n a15.éªŒè¯a1===================================================================$&gt;netstat -anop | grep 88886.nc è¿žæŽ¥a1 &amp; å‘æ¶ˆæ¯===================================================================$&gt;nc localhost 8888 4.5 Flume çš„é«˜å¯ç”¨é…ç½® æ˜¯é€šè¿‡é…ç½®ä¼˜å…ˆçº§æ¥å®žçŽ°ä¸»ä»Ž, ä¼˜å…ˆçº§æ˜¯ç»„å†…çš„ä¼˜å…ˆçº§, éœ€è¦å…ˆè®¾ç½®ä¸ºä¸€ç»„ ä¼˜å…ˆçº§é«˜çš„ down æŽ‰äº†, å†å¯åŠ¨èµ·æ¥, ä¾ç„¶æ˜¯ä¸» ==&gt; å·²éªŒè¯ 1234567891011==============================--è®¾ç½®ä¼˜å…ˆçº§ä»£é…ç½®å¦‚ä¸‹----------#set sink group è®¾ç½®ä¸ºä¸€ç»„a1.sinkgroups.g1.sinks = k1 k2#set failover è®¾ç½®å®¹ç¾ç›¸å…³çš„å‚æ•°a1.sinkgroups.g1.processor.type = failover# è®¾ç½® ç»„å†…æˆå‘˜çš„ä¼˜å…ˆçº§, å†³å®š ä¸»å¤‡a1.sinkgroups.g1.processor.priority.k1 = 10 a1.sinkgroups.g1.processor.priority.k2 = 1 a1.sinkgroups.g1.processor.maxpenalty = 10000 ä»¥ä¸‹é…ç½®æ–¹æ¡ˆä¸Žä¸Šå›¾ä¸åŒçš„, ç”¨çš„æ˜¯1ä¸ª channel, 2ä¸ª`sink` 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011. é…ç½® agent ==&gt; cs1, cs2================================================================================================[ha_agent.conf]------------------#agent name: a1 a1.channels = c1 a1.sources = r1a1.sinks = k1 k2#set gruopa1.sinkgroups = g1#set channela1.channels.c1.type = memory a1.channels.c1.capacity = 1000 a1.channels.c1.transactionCapacity = 100# set sourcesa1.sources.r1.channels = c1a1.sources.r1.type = execa1.sources.r1.command = tail -F /home/ap/flumedata/testha.log# è¿™é‡Œæœ‰ç–‘é—® : è¿™é‡Œè®¾ç½®æ‹¦æˆªå™¨çš„æ„ä¹‰?? éšä¾¿è®¾ç½®çš„å—?? :TODOa1.sources.r1.interceptors = i1 i2 a1.sources.r1.interceptors.i1.type = static a1.sources.r1.interceptors.i1.key = Type a1.sources.r1.interceptors.i1.value = LOGIN a1.sources.r1.interceptors.i2.type = timestamp# set sink1 -&gt; é€šè¿‡ avro æ²‰åˆ° cs3çš„ source ä¸Ša1.sinks.k1.channel = c1 a1.sinks.k1.type = avro a1.sinks.k1.hostname = cs3 a1.sinks.k1.port = 52020# set sink2 -&gt; é€šè¿‡ avro æ²‰åˆ° cs4çš„ source ä¸Ša1.sinks.k2.channel = c1 a1.sinks.k2.type = avro a1.sinks.k2.hostname = cs4 a1.sinks.k2.port = 52020#set sink group è®¾ç½®ä¸ºä¸€ç»„a1.sinkgroups.g1.sinks = k1 k2#set failover è®¾ç½®å®¹ç¾ç›¸å…³çš„å‚æ•°a1.sinkgroups.g1.processor.type = failover# è®¾ç½® ç»„å†…æˆå‘˜çš„ä¼˜å…ˆçº§, å†³å®š ä¸»å¤‡a1.sinkgroups.g1.processor.priority.k1 = 10 a1.sinkgroups.g1.processor.priority.k2 = 1 a1.sinkgroups.g1.processor.maxpenalty = 100002. é…ç½® collector ==&gt; cs3,cs4================================================================================================[ha_collector.conf]#set agent name a1.sources = r1a1.channels = c1 a1.sinks = k1#set channela1.channels.c1.type = memory a1.channels.c1.capacity = 1000 a1.channels.c1.transactionCapacity = 100# other node,nna to nnsa1.sources.r1.type = avro# :TODO è¿™äº› key, value è®¾ç½®äº†ä¹‹åŽ, ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹???## å½“å‰ä¸»æœºæ˜¯ä»€ä¹ˆï¼Œå°±ä¿®æ”¹æˆä»€ä¹ˆä¸»æœºå a1.sources.r1.bind = cs3 a1.sources.r1.port = 52020 a1.sources.r1.interceptors = i1 a1.sources.r1.interceptors.i1.type = static a1.sources.r1.interceptors.i1.key = Collector## å½“å‰ä¸»æœºæ˜¯ä»€ä¹ˆï¼Œå°±ä¿®æ”¹æˆä»€ä¹ˆä¸»æœºå a1.sources.r1.interceptors.i1.value = cs3 a1.sources.r1.channels = c1#set sink to hdfsa1.sinks.k1.type=hdfsa1.sinks.k1.hdfs.path=/user/ap/flume/event_ha/loghdfs a1.sinks.k1.hdfs.fileType=DataStream a1.sinks.k1.hdfs.writeFormat=TEXT a1.sinks.k1.hdfs.rollInterval=10a1.sinks.k1.channel=c1 a1.sinks.k1.hdfs.filePrefix=%Y-%m-%d3. å¯åŠ¨================================================================================================# å…ˆå¯åŠ¨ cs3,cs4 ==&gt; collector $&gt; [ap@cs4]~/apps/flume/conf/confs% flume-ng agent -f ha_collector.conf -n a1 -Dflume.root.logger=DEBUG,console# å†å¯åŠ¨ cs1, cs2 ==&gt; agent, è¿žæŽ¥ collector[ap@cs1]~/apps/flume/conf/confs% flume-ng agent -f ha_agent.conf -n a1 -Dflume.root.logger=DEBUG,console 4.6 å®žç”¨ä¸šåŠ¡åœºæ™¯çŸ¥è¯†ç‚¹: æ‹¦æˆªå™¨ interceptors 4.6.1 éœ€æ±‚: Aã€B ä¸¤å°æ—¥å¿—æœåŠ¡æœºå™¨å®žæ—¶ç”Ÿäº§æ—¥å¿—ä¸»è¦ç±»åž‹ä¸º access.logã€nginx.logã€web.log çŽ°åœ¨è¦æ±‚: æŠŠ Aã€B æœºå™¨ä¸­çš„ access.logã€nginx.logã€web.log é‡‡é›†æ±‡æ€»åˆ° C æœºå™¨ä¸Šç„¶åŽç»Ÿä¸€æ”¶é›†åˆ° hdfs ä¸­ã€‚ ä½†æ˜¯åœ¨ hdfs ä¸­è¦æ±‚çš„ç›®å½•ä¸º: /source/logs/access/20160101/** /source/logs/nginx/20160101/** /source/logs/web/20160101/** 4.6.2 éœ€æ±‚åˆ†æžéœ€æ±‚åˆ†æžå›¾ç¤º æ•°æ®å¤„ç†æµç¨‹åˆ†æž åœ¨æ¯ä¸€å°èŠ‚ç‚¹ä¸Šéƒ½è¦ æœé›† 3ä¸ª source æº æœé›†å®ŒæˆåŽå‘å¾€åŒä¸€å°èŠ‚ç‚¹ 4.6.3 éœ€æ±‚å®žçŽ°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261.åœ¨cs1,cs2ä¸Šé…ç½®flume, é€šè¿‡ avro, sinkåˆ°cs3=============================================================[exec_source_avro_sink.conf]------------------------------# æŒ‡å®šå„ä¸ªæ ¸å¿ƒç»„ä»¶ a1.sources = r1 r2 r3 a1.sinks = k1 a1.channels = c1# å‡†å¤‡æ•°æ®æº# static æ‹¦æˆªå™¨çš„åŠŸèƒ½å°±æ˜¯å¾€é‡‡é›†åˆ°çš„æ•°æ®çš„ header ä¸­æ’å…¥è‡ªå·±å®šä¹‰çš„ key-value å¯¹ # sources-&gt;r1a1.sources.r1.type = execa1.sources.r1.command = tail -F -c +0 /home/ap/flumedata/access.log a1.sources.r1.interceptors = i1a1.sources.r1.interceptors.i1.type = statica1.sources.r1.interceptors.i1.key = typea1.sources.r1.interceptors.i1.value = access# sources-&gt;r2a1.sources.r2.type = execa1.sources.r2.command = tail -F -c +0 /home/ap/flumedata/nginx.log a1.sources.r2.interceptors = i2a1.sources.r2.interceptors.i2.type = static a1.sources.r2.interceptors.i2.key = type a1.sources.r2.interceptors.i2.value = nginx# sources-&gt;r3a1.sources.r3.type = execa1.sources.r3.command = tail -F -c +0 /home/ap/flumedata/web.log a1.sources.r3.interceptors = i3a1.sources.r3.interceptors.i3.type = static a1.sources.r3.interceptors.i3.key = type a1.sources.r3.interceptors.i3.value = web# Describe the sinka1.sinks.k1.type = avro a1.sinks.k1.hostname = cs3 a1.sinks.k1.port = 41414# Use a channel which buffers events in memory a1.channels.c1.type = memory a1.channels.c1.capacity = 20000 a1.channels.c1.transactionCapacity = 10000# Bind the source and sink to the channel a1.sources.r1.channels = c1 a1.sources.r2.channels = c1 a1.sources.r3.channels = c1 a1.sinks.k1.channel = c12. åœ¨ cs3ä¸Šé…ç½® flume, source ä¸º avro, æŽ¥å—æ¥è‡ª cs1,cs2ä¸‹æ²‰çš„æ•°æ®======================================================================[avro_source_hdfs_sink.conf]-------------------------------#å®šä¹‰ agent åï¼Œ sourceã€channelã€sink çš„åç§° a1.sources = r1a1.sinks = k1a1.channels = c1#å®šä¹‰ source a1.sources.r1.type = avro a1.sources.r1.bind = localhosta1.sources.r1.port =41414#æ·»åŠ æ—¶é—´æ‹¦æˆªå™¨#Note:For all of the time related escape sequences, a header with the key â€œtimestampâ€ must #exist among the headers of the event (unless hdfs.useLocalTimeStamp is set to true). One way #to add this automatically is to use the TimestampInterceptor. a1.sources.r1.interceptors = i1 a1.sources.r1.interceptors.i1.type=org.apache.flume.interceptor.TimestampInterceptor$Builder#å®šä¹‰ channelsa1.channels.c1.type = memory #The maximum number of events stored in the channela1.channels.c1.capacity = 20000 #The maximum number of events the channel will take from a source or give to a sink per transactiona1.channels.c1.transactionCapacity = 10000#å®šä¹‰ sinka1.sinks.k1.type = hdfs a1.sinks.k1.hdfs.path = /user/ap/flume/event/%&#123;type&#125;/%Y%m%d a1.sinks.k1.hdfs.filePrefix = eventsa1.sinks.k1.hdfs.fileType = DataStreama1.sinks.k1.hdfs.writeFormat = Text#æ—¶é—´ç±»åž‹a1.sinks.k1.hdfs.useLocalTimeStamp = true #ç”Ÿæˆçš„æ–‡ä»¶ä¸æŒ‰æ¡æ•°ç”Ÿæˆ, å¦åˆ™å°±æ˜¯æŒ‰ç…§è®¾å®šçš„ eventäº§ç”Ÿçš„, 1è¡Œå°±æ˜¯ä¸€ä¸ª event #Number of events written to file before it rolled (0 = never roll based on number of events)a1.sinks.k1.hdfs.rollCount = 0#ç”Ÿæˆçš„æ–‡ä»¶æŒ‰æ—¶é—´ç”Ÿæˆ,å•ä½æ˜¯ç§’#Number of seconds to wait before rolling current file (0 = never roll based on time interval)a1.sinks.k1.hdfs.rollInterval = 30#ç”Ÿæˆçš„æ–‡ä»¶æŒ‰å¤§å°ç”Ÿæˆ, å•ä½æ˜¯ bytes#1 MB = 1,024 KB = 1,048,576 Bytes #File size to trigger roll, in bytes (0: never roll based on file size)a1.sinks.k1.hdfs.rollSize = 10485760 #è¿™é‡Œæ˜¯10MB#æ‰¹é‡å†™å…¥ hdfs çš„ä¸ªæ•°a1.sinks.k1.hdfs.batchSize = 20#flume æ“ä½œ hdfs çš„çº¿ç¨‹æ•°(åŒ…æ‹¬æ–°å»ºï¼Œå†™å…¥ç­‰) a1.sinks.k1.hdfs.threadsPoolSize=10#æ“ä½œ hdfs è¶…æ—¶æ—¶é—´a1.sinks.k1.hdfs.callTimeout=30000#ç»„è£… sourceã€channelã€sink a1.sources.r1.channels = c1 a1.sinks.k1.channel = c13.å¯åŠ¨æœåŠ¡============================================================================# å¯åŠ¨cs3 =&gt; æœåŠ¡å™¨ c[ap@cs3]~/apps/flume/conf/confs% flume-ng agent -f avro_source_hdfs_sink.conf -n a1 -Dflume.root.logger=DEBUG,console# å¯åŠ¨cs1, cs2 =&gt; æœåŠ¡å™¨ a, b# æ³¨æ„: åƒä¸‡åˆ«å¯é”™äº†, å¦åˆ™å¾ˆéš¾æ‰¾åˆ°åŽŸå› ..[ap@cs2]~/apps/flume/conf/confs% flume-ng agent -f exec_source_avro_sink.conf -n a1 -Dflume.root.logger=DEBUG,console==============é‡åˆ°é—®é¢˜: è¿™ç§é€šè¿‡avroå¤šç‚¹ sink åˆ°ä¸€ä¸ª source çš„æ—¶å€™, å®žçŽ°ä¸åˆ›å»ºæ–‡ä»¶å¤¹/æ–‡ä»¶çš„, å¥½åƒç¡®å®žå†™å…¥ä¸è¿›åŽ»...===&gt; md, åŽŸå› åº”è¯¥æ˜¯å¯åŠ¨é”™é…ç½®äº† 5.Flumeçš„Mavenä¾èµ–123456789101112131415161718192021222324252627282930313233&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.rox&lt;/groupId&gt; &lt;artifactId&gt;Flume_test&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.flume&lt;/groupId&gt; &lt;artifactId&gt;flume-ng-core&lt;/artifactId&gt; &lt;version&gt;1.6.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.flume.flume-ng-sinks&lt;/groupId&gt; &lt;artifactId&gt;flume-hdfs-sink&lt;/artifactId&gt; &lt;version&gt;1.6.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.flume.flume-ng-sinks&lt;/groupId&gt; &lt;artifactId&gt;flume-ng-hbase-sink&lt;/artifactId&gt; &lt;version&gt;1.6.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.flume.flume-ng-channels&lt;/groupId&gt; &lt;artifactId&gt;flume-file-channel&lt;/artifactId&gt; &lt;version&gt;1.6.0&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt;]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Flume</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Flume</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Azkaban]]></title>
    <url>%2F2018%2F06%2F29%2FHadoop%2F6-Sqoop%26Azkaban%2FAzkaban%2F</url>
    <content type="text"><![CDATA[1.å‡ºçŽ°å¥‘æœºåº”ç”¨åœºæ™¯ä¸¾ä¾‹: 1ã€é€šè¿‡ Hadoop å…ˆå°†åŽŸå§‹æ•°æ®åŒæ­¥åˆ° HDFS ä¸Š; 2ã€å€ŸåŠ© MapReduce è®¡ç®—æ¡†æž¶å¯¹åŽŸå§‹æ•°æ®è¿›è¡Œæ¸…æ´—è½¬æ¢ï¼Œç”Ÿæˆçš„æ•°æ®ä»¥åˆ†åŒºè¡¨çš„å½¢å¼å­˜å‚¨åˆ° å¤šå¼  Hive è¡¨ä¸­; 3ã€éœ€è¦å¯¹ Hive ä¸­å¤šä¸ªè¡¨çš„æ•°æ®è¿›è¡Œ Join å¤„ç†ï¼Œå¾—åˆ°ä¸€ä¸ªæ˜Žç»†æ•°æ® Hive å¤§è¡¨; 4ã€å°†æ˜Žç»†æ•°æ®è¿›è¡Œå„ç§ç»Ÿè®¡åˆ†æžï¼Œå¾—åˆ°ç»“æžœæŠ¥è¡¨ä¿¡æ¯; 5ã€éœ€è¦å°†ç»Ÿè®¡åˆ†æžå¾—åˆ°çš„ç»“æžœæ•°æ®åŒæ­¥åˆ°ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œä¾›ä¸šåŠ¡è°ƒç”¨ä½¿ç”¨ã€‚ 2.å¸¸è§å·¥ä½œæµè°ƒåº¦ç³»ç»Ÿ &amp; å¯¹æ¯”åœ¨ Hadoop é¢†åŸŸï¼Œå¸¸è§çš„å·¥ä½œæµè°ƒåº¦å™¨æœ‰ Oozieï¼ŒAzkabanï¼ŒCascadingï¼ŒHamake ç­‰ 2.1.å„ç§è°ƒåº¦å·¥å…·å¯¹æ¯” 2.2.Azkaban ä¸Ž Oozie å¯¹æ¯”ooize ç›¸æ¯” azkaban æ˜¯ä¸€ä¸ªé‡é‡çº§çš„ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿï¼ŒåŠŸèƒ½å…¨é¢ï¼Œä½†é…ç½®ä½¿ç”¨ä¹Ÿæ›´å¤æ‚ã€‚å¦‚æžœå¯ä»¥ä¸ åœ¨æ„æŸäº›åŠŸèƒ½çš„ç¼ºå¤±ï¼Œè½»é‡çº§è°ƒåº¦å™¨ azkaban æ˜¯å¾ˆä¸é”™çš„å€™é€‰å¯¹è±¡ã€‚ ïµ å·¥ä½œæµå®šä¹‰ Azkaban ä½¿ç”¨ Properties æ–‡ä»¶å®šä¹‰å·¥ä½œæµ Oozie ä½¿ç”¨ XML æ–‡ä»¶å®šä¹‰å·¥ä½œæµ ïµ å®šæ—¶æ‰§è¡Œ Azkaban çš„å®šæ—¶æ‰§è¡Œä»»åŠ¡æ˜¯åŸºäºŽæ—¶é—´çš„ Oozie çš„å®šæ—¶æ‰§è¡Œä»»åŠ¡åŸºäºŽæ—¶é—´å’Œè¾“å…¥æ•°æ® 2.3.Azkaban ç»„ä»¶å…³ç³»å…³ç³»æ•°æ®åº“(ç›®å‰ä»…æ”¯æŒ MySQL) web ç®¡ç†æœåŠ¡å™¨-AzkabanWebServer æ‰§è¡ŒæœåŠ¡å™¨-AzkabanExecutorServer Azkaban ä½¿ç”¨ MySQL æ¥å­˜å‚¨å®ƒçš„çŠ¶æ€ä¿¡æ¯ï¼ŒAzkaban Executor Server å’Œ Azkaban Web Server å‡ä½¿ç”¨åˆ°äº† MySQL æ•°æ®åº“ã€‚ å®ƒæœ‰å¦‚ä¸‹åŠŸèƒ½ç‰¹ç‚¹: ï‚² Web ç”¨æˆ·ç•Œé¢ ï‚² æ–¹ä¾¿ä¸Šä¼ å·¥ä½œæµ ï‚² æ–¹ä¾¿è®¾ç½®ä»»åŠ¡ä¹‹é—´çš„å…³ç³» ï‚² è°ƒåº¦å·¥ä½œæµ ï‚² è®¤è¯/æŽˆæƒ(æƒé™çš„å·¥ä½œ) ï‚² èƒ½å¤Ÿæ€æ­»å¹¶é‡æ–°å¯åŠ¨å·¥ä½œæµ ï‚² æ¨¡å—åŒ–å’Œå¯æ’æ‹”çš„æ’ä»¶æœºåˆ¶ ï‚² é¡¹ç›®å·¥ä½œåŒº ï‚² å·¥ä½œæµå’Œä»»åŠ¡çš„æ—¥å¿—è®°å½•å’Œå®¡è®¡ 3.Azkaban å®‰è£…éƒ¨ç½²3.1å‡†å¤‡å·¥ä½œAzkaban Web æœåŠ¡å™¨:azkaban-web-server-2.5.0.tar.gz Azkaban Excutor æ‰§è¡ŒæœåŠ¡å™¨ :azkaban-executor-server-2.5.0.tar.gz Azkaban åˆå§‹åŒ–è„šæœ¬æ–‡ä»¶:azkaban-sql-script-2.5.0.tar.gz 3.2å®‰è£…è¯´æ˜Žå°†å®‰è£…æ–‡ä»¶ä¸Šä¼ åˆ°é›†ç¾¤,æœ€å¥½ä¸Šä¼ åˆ°å®‰è£…hiveã€sqoop çš„æœºå™¨ä¸Š,æ–¹ä¾¿å‘½ä»¤çš„æ‰§è¡Œã€‚å¹¶æœ€å¥½åŒ ä¸€å­˜æ”¾åœ¨ apps ç›®å½•ä¸‹,ç”¨äºŽå­˜æ”¾æºå®‰è£…æ–‡ä»¶.æ–°å»º azkaban ç›®å½•,ç”¨äºŽå­˜æ”¾ azkaban è¿è¡Œç¨‹åº 3.3è§£åŽ‹123tar -zxvf azkaban-web-server-2.5.0.tar.gz -C /home/apps/ap/azkaban/tar -zxvf azkaban-executor-server-2.5.0.tar.gz -C /home/apps/ap/azkaban/tar -zxvf azkaban-sql-script-2.5.0.tar.gz -C /home/apps/ap/azkaban/ 3.4è¿›å…¥ mysql å¯¼å…¥ä»»åŠ¡ job è¡¨12345mysql&gt; create database azkaban; Query OK, 1 row affected (0.01 sec)mysql&gt; use azkaban; Database changedmysql&gt; source /home/hadoop/apps/azkaban/azkaban-script-2.5.0/create-all-sql-2.5.0.sql; 3.5åˆ›å»º SSL é…ç½®æœ€å¥½æ˜¯åœ¨ azkaban ç›®å½•ä¸‹æ‰§è¡Œ: 123456789101112131415161718192021222324252627282930# æ‰§è¡Œå‘½ä»¤: keytool -keystore keystore -alias jetty -genkey -keyalg RSA# è¿è¡Œæ­¤å‘½ä»¤åŽ,ä¼šæç¤ºè¾“å…¥å½“å‰ç”Ÿæˆ keystore çš„å¯†ç åŠç›¸åº”ä¿¡æ¯,è¾“å…¥å¯†ç è¯·åŠ³è®°,ä¿¡æ¯å¦‚ä¸‹:Enter keystore password:Re-enter new password:What is your first and last name? [Unknown]:What is the name of your organizational unit? [Unknown]:What is the name of your organization? [Unknown]:What is the name of your City or Locality? [Unknown]:What is the name of your State or Province? [Unknown]:What is the two-letter country code for this unit? [Unknown]: CNIs CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=CN correct? [no]: yEnter key password for &lt;jetty&gt;(RETURN if same as keystore password):æ­¤æ—¶, ä¼šå‘çŽ°ç›®å½•ä¸‹æœ‰ä¸€ä¸ª Keystore æ–‡ä»¶------------------------------------------å®Œæˆä¸Šè¿°å·¥ä½œåŽ,å°†åœ¨å½“å‰ç›®å½•ç”Ÿæˆ keystore è¯ä¹¦æ–‡ä»¶,å°† keystore æ‹·è´åˆ° azkaban web æœåŠ¡ å™¨æ ¹ç›®å½•ä¸­.å¦‚:ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿cp keystore azkaban-web-2.5.0 3.6 ä¿®æ”¹é…ç½®æ–‡ä»¶æ³¨æ„: é…ç½®æ–‡ä»¶åŽé¢ä¸€å®šä¸è¦æœ‰ç©ºæ ¼ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182831) ç”Ÿæˆæ—¶åŒºé…ç½®æ–‡ä»¶ Asia/Shanghaiï¼Œç”¨äº¤äº’å¼å‘½ä»¤ tzselect å³å¯, å¦‚æžœæœ‰çš„è¯å°±ä¸ç”¨å†ç”Ÿæˆäº† tzselect 2) æ‹·è´è¯¥æ—¶åŒºæ–‡ä»¶ï¼Œè¦†ç›–ç³»ç»Ÿæœ¬åœ°æ—¶åŒºé…ç½® sudo cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime3) ï£¿ï£¿ï£¿ azkaban web æœåŠ¡å™¨é…ç½® ï£¿ï£¿ï£¿3.1) ï£¿ é…ç½® web çš„ azkaban.properties ï£¿ cd ~/apps/azkaban/azkaban-web-2.5.0/conf/ vi azkaban.propertiesï£¿ ä»¥ä¸‹æ˜¯éœ€è¦ä¿®æ”¹çš„å†…å®¹ ï£¿#é»˜è®¤æ ¹ web ç›®å½•web.resource.dir=/home/ap/apps/azkaban/azkaban-web-2.5.0/web#é»˜è®¤æ—¶åŒº,å·²æ”¹ä¸ºäºšæ´²/ä¸Šæµ· é»˜è®¤ä¸ºç¾Žå›½default.timezone.id=Asia/Shanghai#ç”¨æˆ·é…ç½®,å…·ä½“é…ç½®å‚åŠ ä¸‹æ–‡user.manager.xml.file=/home/ap/apps/azkaban/azkaban-web-2.5.0/conf/azkaban-users.xml#globalé…ç½®æ–‡ä»¶æ‰€åœ¨ä½ç½®executor.global.properties=/home/ap/apps/azkaban/azkaban-executor-2.5.0/conf/global.properties#æ•°æ®åº“ç›¸å…³é…ç½®mysql.host=cs2mysql.database=azkabanmysql.user=rootmysql.password=123#SSL æ–‡ä»¶åjetty.keystore=/home/ap/apps/azkaban/azkaban-web-2.5.0/keystore#SSL æ–‡ä»¶å¯†ç jetty.password=123456#Jetty ä¸»å¯†ç  ä¸Ž keystore æ–‡ä»¶ç›¸åŒjetty.keypassword=123456#SSL æ–‡ä»¶åjetty.truststore=/home/ap/apps/azkaban/azkaban-web-2.5.0/keystore# SSL æ–‡ä»¶å¯†ç jetty.trustpassword=1234563.2) é…ç½® web çš„ azkaban-users.xml # å¢žåŠ  ç®¡ç†å‘˜ç”¨æˆ·vi azkaban-users.xml &lt;azkaban-users&gt; &lt;user username="azkaban" password="azkaban" roles="admin" groups="azkaban"/&gt; &lt;user username="metrics" password="metrics" roles="metrics"/&gt; # æ­¤è¡Œæ˜¯åŠ çš„, æŒ‡ç”¨æˆ·åå¯†ç éƒ½ä¸º admin &lt;user username="admin" password="admin" roles="admin,metrics"/&gt; &lt;role name="admin" permissions="ADMIN"/&gt; &lt;role name="metrics" permissions="METRICS"/&gt; &lt;/azkaban-users&gt; 4) ï£¿ï£¿ï£¿ é…ç½®æ‰§è¡ŒæœåŠ¡å™¨ executor ï£¿ï£¿ï£¿ cd apps/azkaban/azkaban-executor-2.5.0/conf/ vi azkaban.properties-----ä»¥ä¸‹æ˜¯éœ€è¦ä¿®æ”¹çš„å†…å®¹------#æ—¶åŒºdefault.timezone.id=Asia/Shanghai # Azkaban JobTypes æ’ä»¶é…ç½®ï¼Œæ’ä»¶æ‰€åœ¨ä½ç½® azkaban.jobtype.plugin.dir=/home/hadoop/apps/azkaban/azkaban-executor-2.5.0/plugins/jobtypes#Loader for projectsexecutor.global.properties=/home/ap/apps/azkaban/azkaban-executor-2.5.0/conf/global.properties#mysql éœ€è¦ä¿®æ”¹çš„åœ°æ–¹mysql.host=cs2mysql.database=azkabanmysql.user=rootmysql.password=1235)ï£¿ï£¿ï£¿ é…ç½®çŽ¯å¢ƒå˜é‡ ï£¿ï£¿ï£¿vi .zshrc # azkabanexport AZKABAN_WEB_HOME=/home/ap/apps/azkaban/azkaban-web-2.5.0export AZKABAN_EXE_HOME=/home/ap/apps/azkaban/azkaban-executor-2.5.0export PATH=$PATH:$AZKABAN_WEB_HOME/bin:$AZKABAN_EXE_HOME/bin 3.7 å¯åŠ¨12345678910111213141516171819201) ï£¿ï£¿ï£¿ å¯åŠ¨ Azkaban Web Server: ï£¿ï£¿ï£¿# ps: .out æ˜¯æ—¥å¿—, å¯ä»¥å…ˆåˆ›å»º logs ç›®å½•, æ—¥å¿—åœ°å€éšä¾¿# å‰å°å¯åŠ¨azkaban-web-start.sh# åŽå°å¯åŠ¨nohup azkaban-web-start.sh 1&gt;/home/ap/logs/azwebstd.out 2&gt;/home/ap/logs/azweberr.out &amp;2) ï£¿ï£¿ï£¿ å¯åŠ¨ Azkaban Executor: ï£¿ï£¿ï£¿#å‰å°å¯åŠ¨azkaban-executor-start.sh# åŽå°å¯åŠ¨nohup azkaban-executor-start.sh 1&gt;/home/ap/logs/azexstd.out 2&gt;/home/ap/logs/azexerr.out &amp;3) ï£¿ï£¿ï£¿ ç™»å½• webUI ï£¿ï£¿ï£¿https://cs2:8443/u: adminp: admin# æ³¨æ„: é…ç½®åŽé¢ä¸èƒ½æœ‰ç©ºæ ¼!!! 4.Azkaban å®žæˆ˜æ¼”ç¤ºè§è¿™é‡Œ]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Azkaban</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Azkaban</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Sqoop]]></title>
    <url>%2F2018%2F06%2F28%2FHadoop%2F6-Sqoop%26Azkaban%2FSqoop%2F</url>
    <content type="text"><![CDATA[1. ä½œç”¨ Sqoop æ˜¯ Apache æ——ä¸‹ä¸€æ¬¾â€œHadoop å’Œå…³ç³»æ•°æ®åº“æœåŠ¡å™¨ä¹‹é—´ä¼ é€æ•°æ®â€çš„å·¥å…·ã€‚ å¯¼å…¥æ•°æ®ï¼šMySQLï¼ŒOracle å¯¼å…¥æ•°æ®åˆ° Hadoop çš„ HDFSã€HIVEã€HBASE ç­‰æ•°æ®å­˜å‚¨ç³»ç»Ÿ å¯¼å‡ºæ•°æ®ï¼šä»Ž Hadoop çš„æ–‡ä»¶ç³»ç»Ÿä¸­å¯¼å‡ºæ•°æ®åˆ°å…³ç³»æ•°æ®åº“ MySQL ç­‰ Sqoop çš„æœ¬è´¨è¿˜æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå’Œ HDFSï¼ŒHive ç›¸æ¯”ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆé«˜æ·±çš„ç†è®ºã€‚ 2.å·¥ä½œæœºåˆ¶å°†å¯¼å…¥å¯¼å‡ºå‘½ä»¤ç¿»è¯‘æˆ MapReduce ç¨‹åºæ¥å®žçŽ° åœ¨ç¿»è¯‘å‡ºçš„ MapReduce ä¸­ä¸»è¦æ˜¯å¯¹ InputFormat å’Œ OutputFormat è¿›è¡Œå®šåˆ¶ 3.å®‰è£…æ³¨æ„: ç›®å½•ä¸‹è¦æœ‰hive, å› ä¸ºè¦æ‹¿åˆ° hive çš„ home, æ‰§è¡Œ hive æ“ä½œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253541ã€ å‡†å¤‡å®‰è£…åŒ… sqoop-1.4.6.bin_hadoop-2.0.4-alpha.tar.gz2ã€ è§£åŽ‹å®‰è£…åŒ…åˆ°å®‰è£…ç›®å½•tar -zxvf sqoop-1.4.6.bin_hadoop-2.0.4-alpha.tar.gz -C apps/ cd appsmv sqoop-1.4.6.bin_hadoop-2.0.4-alpha/ sqoop-1.4.63ã€ è¿›å…¥åˆ° conf æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° sqoop-env-template.shï¼Œä¿®æ”¹å…¶åç§°ä¸º sqoop-env.sh cd confmv sqoop-env-template.sh sqoop-env.sh4ã€ ä¿®æ”¹ sqoop-env.sh-----export HADOOP_COMMON_HOME=/home/ap/apps/hadoop export HADOOP_MAPRED_HOME=/home/ap/apps/hadoop export HBASE_HOME=/home/ap/apps/hbaseexport HIVE_HOME=/home/ap/apps/hiveexport ZOOCFGDIR=/home/ap/apps/zookeeper/conf-----5ã€ åŠ å…¥ mysql é©±åŠ¨åŒ…åˆ° sqoop-1.4.6/lib ç›®å½•ä¸‹cp mysql-connector-java-5.1.40-bin.jar ~/apps/sqoop-1.4.6/lib/6ã€ é…ç½®ç³»ç»ŸçŽ¯å¢ƒå˜é‡ vi ~/.bashrcç„¶åŽè¾“å…¥:export SQOOP_HOME=/home/hadoop/apps/sqoop-1.4.6 export PATH=$PATH:$SQOOP_HOME/binç„¶åŽä¿å­˜é€€å‡ºsource ~/.bashrc7ã€ éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸsqoop-version æˆ–è€… sqoopversionps : å¹å‡ºçŽ°è­¦å‘Š, ä¸ç”¨ç®¡---[ap@cs2]~% sqoop versionWarning: /home/ap/apps/sqoop/../hcatalog does not exist! HCatalog jobs will fail.Please set $HCAT_HOME to the root of your HCatalog installation.Warning: /home/ap/apps/sqoop/../accumulo does not exist! Accumulo imports will fail.Please set $ACCUMULO_HOME to the root of your Accumulo installation.Warning: /home/ap/apps/sqoop/../zookeeper does not exist! Accumulo imports will fail.Please set $ZOOKEEPER_HOME to the root of your Zookeeper installation.18/06/28 20:43:52 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6Sqoop 1.4.6git commit id c0c5a81723759fa575844a0a1eae8f510fa32c25Compiled by root on Mon Apr 27 14:38:36 CST 20158\ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ å¯ä»¥é…ç½®è®°ä½å¯†ç  ï£¿ï£¿ï£¿ï£¿ï£¿ä½†æ˜¯å¥½åƒä¸èµ·ä½œç”¨???æŸ¥çœ‹ä»»åŠ¡è¯¦ç»†æˆ–è€…æ‰§è¡Œä»»åŠ¡çš„æ—¶å€™ä¸è¾“å…¥å¯†ç  å…å¯†[sqoop-site.xml]æ·»åŠ : &lt;property&gt; &lt;name&gt;sqoop.metastore.client.record.password&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;description&gt;If true, allow saved passwords in the metastore.&lt;/description&gt; &lt;/property&gt; 4. åŸºæœ¬ä½¿ç”¨121) sqoop help : æŸ¥çœ‹å¸®åŠ©2) sqoop help import : è¿›ä¸€æ­¥å±‚çº§æŸ¥çœ‹ 5. Sqoop æ•°æ®å¯¼å…¥å¸¸ç”¨æŒ‡ä»¤12345678910--connect æŒ‡å®šæ•°æ®åº“é“¾æŽ¥url--username æŒ‡å®šæ•°æ®åº“çš„ç”¨æˆ·å--password æŒ‡å®šæ•°æ®åº“çš„å¯†ç --table æŒ‡å®šè¦å¯¼å‡ºæ•°æ®çš„mysqlæ•°æ®åº“è¡¨-m æŒ‡å®šMapTaskçš„ä¸ªæ•°--target-dir æŒ‡å®šå¯¼å‡ºæ•°æ®åœ¨HDFSä¸Šçš„å­˜å‚¨ç›®å½•--fields-terminated-by æŒ‡å®šæ¯æ¡è®°å½•ä¸­å­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦--where æŒ‡å®šæŸ¥è¯¢SQLçš„whereæ¡ä»¶--query æŒ‡å®šæŸ¥è¯¢SQL--columns æŒ‡å®šæŸ¥è¯¢åˆ— 5.1 list mysql çš„æ•°æ®åº“ &amp; è¡¨, å¤åˆ¶mysql ä¸­è¡¨ç»“æž„ç›¸åŒè¡¨ â€“&gt; hive12345678910111213141516171819202122åˆ—å‡ºMySQLæ•°æ®æœ‰å“ªäº›æ•°æ®åº“ï¼šï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿sqoop list-databases \--connect jdbc:mysql://cs2:3306/ \--username root \--password 123åˆ—å‡ºMySQLä¸­çš„æŸä¸ªæ•°æ®åº“æœ‰å“ªäº›æ•°æ®è¡¨ï¼šï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿sqoop list-tables \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123åˆ›å»ºä¸€å¼ è·Ÿmysqlä¸­çš„help_keywordè¡¨ä¸€æ ·çš„hiveè¡¨hkï¼š(æ²¡æœ‰æ•°æ®è²Œä¼¼)ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿sqoop create-hive-table \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--table help_keyword \--hive-table hk 5.2 å¯¼å…¥ mysqlä¸­è¡¨ åˆ° HDFS123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿å¯¼å…¥MySQLè¡¨ä¸­æ•°æ®åˆ°HDFSä¸­ï¼šï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿// æ™®é€šå¯¼å…¥ï¼šå¯¼å…¥mysqlåº“ä¸­çš„help_keywordçš„æ•°æ®åˆ°HDFSä¸Šçš„é»˜è®¤è·¯å¾„ï¼š/user/ap/help_keywordsqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--table help_keyword \-m 1æœ€åŽçš„1,æ˜¯æŒ‡ä½¿ç”¨1ä¸ª mapTask å¯¼å…¥åˆ°hdfsåŽ, å¯ä»¥ä½¿ç”¨ hdfs dfs -text /.... æŸ¥çœ‹æ•°æ®----// å¯¼å…¥ï¼š æŒ‡å®šåˆ†éš”ç¬¦ &amp; å¯¼å…¥è·¯å¾„ &amp; mapTask ä¸ªæ•°ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿sqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--table help_keyword \--target-dir /user/ap/my_help_keyword1 \--fields-terminated-by '\t' \-m 3// å¯¼å…¥æ•°æ®ï¼šå¸¦whereæ¡ä»¶ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿sqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--where "name='STRING' " \--table help_keyword \--target-dir /user/ap/my_help_keyword2 \-m 1// æŸ¥è¯¢æŒ‡å®šåˆ—-------------å‘çŽ°ä¸€ä¸ªç»“è®º, å¦‚æžœå¯åŠ¨3ä¸ª mapper, ä½†æ˜¯æœ€åŽåªæœ‰ä¸€ä¸ªç»“è®º, åªä¼šç”Ÿæˆä¸€ä¸ªç»“æžœæ–‡ä»¶ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿sqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--columns "name" \--where "name='STRING' " \--table help_keyword \--target-dir /user/ap/my_help_keyword3 \-m 3// å¯¼å…¥ï¼šæŒ‡å®šè‡ªå®šä¹‰æŸ¥è¯¢SQL--------------ç–‘ç‚¹: split-by çš„ä½œç”¨, å’Œ -m æ•°é‡çš„å…³ç³»ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿sqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--target-dir /user/ap/my_help_keyword4 \--query 'select help_keyword_id,name from help_keyword WHERE $CONDITIONS and name = "STRING"' \--split-by help_keyword_id \--fields-terminated-by '\t' \-m 1----------------------------sqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--target-dir /user/hadoop/my_help_keyword5 \--query "select help_keyword_id,name from help_keyword WHERE \$CONDITIONS" \--split-by help_keyword_id \--fields-terminated-by '\t' \-m 1# åœ¨ä»¥ä¸Šéœ€è¦æŒ‰ç…§è‡ªå®šä¹‰SQLè¯­å¥å¯¼å‡ºæ•°æ®åˆ°HDFSçš„æƒ…å†µä¸‹ï¼š1ã€å¼•å·é—®é¢˜ï¼Œè¦ä¹ˆå¤–å±‚ä½¿ç”¨å•å¼•å·ï¼Œå†…å±‚ä½¿ç”¨åŒå¼•å·ï¼Œ$CONDITIONSçš„$ç¬¦å·ä¸ç”¨è½¬ä¹‰ï¼Œ è¦ä¹ˆå¤–å±‚ä½¿ç”¨åŒå¼•å·ï¼Œé‚£ä¹ˆå†…å±‚ä½¿ç”¨å•å¼•å·ï¼Œç„¶åŽ$CONDITIONSçš„$ç¬¦å·éœ€è¦è½¬ä¹‰2ã€è‡ªå®šä¹‰çš„SQLè¯­å¥ä¸­å¿…é¡»å¸¦æœ‰WHERE \$CONDITIONS 5.3 å¯¼å…¥MySQLæ•°æ®åº“ä¸­çš„è¡¨æ•°æ®åˆ°Hiveä¸­ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿å¯¼å…¥MySQLæ•°æ®åº“ä¸­çš„è¡¨æ•°æ®åˆ°Hiveä¸­ï¼šï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿// æ™®é€šå¯¼å…¥ï¼šæ•°æ®å­˜å‚¨åœ¨é»˜è®¤çš„default hiveåº“ä¸­ï¼Œè¡¨åå°±æ˜¯å¯¹åº”çš„mysqlçš„è¡¨åï¼š// é€šè¿‡å¯¹æ¯”å‘çŽ°, sqoop æ˜¯é»˜è®¤å¯¼å…¥åˆ° hdfs çš„, å¯¼å…¥åˆ°hdfsæ—¶, ä¸ç”¨åŠ é¢å¤–çš„å‚æ•°sqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--table help_keyword \--hive-import \-m 1hadoop fs -cat /user/myhive/warehouse/help_keyword/part-m-00000 // æŸ¥çœ‹æ•°æ®å½“ç„¶ä¹Ÿå¯ä»¥åœ¨ hive ä¸­æŸ¥çœ‹æ•°æ®// æŒ‡å®šè¡Œåˆ†éš”ç¬¦å’Œåˆ—åˆ†éš”ç¬¦ï¼ŒæŒ‡å®šhive-importï¼ŒæŒ‡å®šè¦†ç›–å¯¼å…¥ï¼ŒæŒ‡å®šè‡ªåŠ¨åˆ›å»ºhiveè¡¨ï¼ŒæŒ‡å®šè¡¨åï¼ŒæŒ‡å®šåˆ é™¤ä¸­é—´ç»“æžœæ•°æ®ç›®å½• Database does not exist: mydb_test ???æ³¨æ„: è¦å…ˆåˆ›å»º database mydb_testé—®é¢˜: ä¸ºä»€ä¹ˆå¯¼å‡ºåŽ, å˜æˆäº†4ä¸ªå—sqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--table help_keyword \--fields-terminated-by "\t" \--lines-terminated-by "\n" \--hive-import \--hive-overwrite \--create-hive-table \--delete-target-dir \--hive-database mydb_test \--hive-table new_help_keywordå¦å¤–ä¸€ç§å†™æ³•ï¼šsqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--table help_keyword \--fields-terminated-by "\t" \--lines-terminated-by "\n" \--hive-import \--hive-overwrite \--create-hive-table \--hive-table mydb_test.new_help_keyword1 \--delete-target-dir 5.4 å¢žé‡å¯¼å…¥åˆ° HDFSâ€”-åº”è¯¥ä¹Ÿæ˜¯å¯ä»¥å¯¼å…¥åˆ° Hive 12345678910111213141516171819202122232425262728ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¢žé‡å¯¼å…¥ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿Incremental import arguments: --check-column &lt;column&gt; Source column to check for incremental change åŽŸå§‹çš„åˆ—ä½œä¸ºå¢žé•¿æ”¹å˜çš„ --incremental &lt;import-type&gt; Define an incremental import of type 'append' or 'lastmodified' --last-value &lt;value&gt; Last imported value in the incremental check columnï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿æ¯”è¾ƒä½¿ç”¨äºŽè‡ªå¢žé•¿ä¸»é”®!! // å¢žé‡å¯¼å…¥ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿sqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--table help_keyword \--target-dir /user/ap/my_help_keyword_import1 \--incremental append \--check-column help_keyword_id \--last-value 500 \-m 3 5.5 ç¬¬å››éƒ¨åˆ†ï¼š å¯¼å…¥æ•°æ®åˆ°HBase1234567891011121314ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ç¬¬å››éƒ¨åˆ†ï¼š å¯¼å…¥æ•°æ®åˆ°HBaseï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿å¯¼å…¥MySQLæ•°æ®åº“ä¸­çš„è¡¨æ•°æ®åˆ°HBaseä¸­ï¼šsqoop import \--connect jdbc:mysql://cs2:3306/mysql \--username root \--password 123 \--table help_keyword \--hbase-table new_help_keyword \--column-family person \--hbase-row-key help_keyword_id 5.6 å¯¼å‡º12345678910111213141516171819202122232425262728293031323334353637ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ç¬¬äº”éƒ¨åˆ†ï¼šå¯¼å‡ºï¼šï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿æ³¨æ„ï¼šå¯¼å‡ºçš„RDBMSçš„è¡¨å¿…é¡»è‡ªå·±é¢„å…ˆåˆ›å»ºï¼Œä¸ä¼šè‡ªåŠ¨åˆ›å»º------mysql-----å…ˆåœ¨ mysql ä¸­åˆ›å»ºåº“create database sqoopdb default character set utf8 COLLATE utf8_general_ci; use sqoopdb;CREATE TABLE sqoopstudent ( id INT NOT NULL PRIMARY KEY, name VARCHAR(20), sex VARCHAR(20), age INT,department VARCHAR(20));// å¯¼å‡ºHDFSæ•°æ®åˆ°MySQLï¼šï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿sqoop export \--connect jdbc:mysql://cs2:3306/sqoopdb \--username root \--password 123 \--table sqoopstudent \--export-dir /sqoopdata \--fields-terminated-by ','// å¯¼å‡ºhiveæ•°æ®åˆ°MySQLï¼šsqoop export \--connect jdbc:mysql://cs2:3306/sqoopdb \--username root \--password 123 \--table uv_info \--export-dir /user/hive/warehouse/uv/dt=2011-08-03 \--input-fields-terminated-by '\t' 5.6 å¯¼å‡ºHBaseæ•°æ®åˆ°MySQLå¾ˆé—æ†¾ï¼ŒçŽ°åœ¨è¿˜æ²¡æœ‰ç›´æŽ¥çš„å‘½ä»¤å°† HBase çš„æ•°æ®å¯¼å‡ºåˆ° MySQL ä¸€èˆ¬é‡‡ç”¨å¦‚ä¸‹ 3 ç§æ–¹æ³•: 1ã€å°† HBase æ•°æ®ï¼Œæ‰å¹³åŒ–æˆ HDFS æ–‡ä»¶ï¼Œç„¶åŽå†ç”± sqoop å¯¼å…¥ 2ã€å°† HBase æ•°æ®å¯¼å…¥ Hive è¡¨ä¸­ï¼Œç„¶åŽå†å¯¼å…¥ MySQL 3ã€ç›´æŽ¥ä½¿ç”¨ HBase çš„ Java API è¯»å–è¡¨æ•°æ®ï¼Œç›´æŽ¥å‘ MySQL å¯¼å…¥ï¼Œä¸éœ€è¦ä½¿ç”¨ sqoop 5.7 sqoop æ”¯æŒ &amp; ä¸æ”¯æŒhdfs to mysql å¯ä»¥ç›´æŽ¥ä½¿ç”¨ã€‚ï¼ï¼hive to mysql å°±æ˜¯hdfs to mysqlhbase to mysql å¾ˆä¸å¹¸ï¼Œä¸æ”¯æŒã€‚ï¼ æ€Žä¹ˆå®žçŽ°ï¼Ÿ 1ã€æ‰å¹³åŒ–åˆ°HDFS 2ã€hbaseå’Œhiveåšæ•´åˆ 3ã€è‡ªå·±ç¼–å†™ç¨‹åºåŽ»å®žçŽ°ä»ŽHBASEå½“ä¸­è¯»å–æ•°æ®ï¼Œç„¶åŽå†™å…¥åˆ°mYsql 6.Sqoop Job ä½œä¸šæŸ¥çœ‹å¸®åŠ©: sqoop help job 6.0 mysql åˆ›å»ºæ•°æ®åº“ spider å’Œ è¡¨ lagou12# è¿™æ ·å¯ä»¥ç›´æŽ¥å¯¼å…¥ sql æ•°æ®source /home/ap/temp/lagou.sql 6.1 åˆ›å»ºä½œä¸š Job (â€“create)123456789# æ³¨æ„: mysql ä¸­æ­¤æ—¶å·²ç»å­˜åœ¨ spider åº“, åº“ä¸­æœ‰ lagou è¡¨# ps: å¯¼å…¥è¡¨sqoop job --create my_sqoop_job \-- import \--connect jdbc:mysql://cs2:3306/spider \--username root \--password 123 \--table lagou 6.2 æŸ¥çœ‹ä½œä¸š Job (â€“list)1234sqoop job --list----------------------Available jobs: my_sqoop_job 6.3 æŸ¥çœ‹ä½œä¸šè¯¦ç»†ä¿¡æ¯ (â€“show)1sqoop job --show my_sqoop_job 6.4 æ‰§è¡Œä½œä¸š1sqoop job --exec my_sqoop_job 6.5 åˆ é™¤ä½œä¸š1sqoop job --delete my_sqoop_job 7.Sqoop å¯¼å…¥å¯¼å‡ºåŽŸç†7.1 å¯¼å…¥åŽŸç† 1ã€ç¬¬ä¸€æ­¥ï¼ŒSqoop ä¼šé€šè¿‡ JDBC æ¥èŽ·å–æ‰€éœ€è¦çš„æ•°æ®åº“å…ƒæ•°æ®ï¼Œä¾‹å¦‚ï¼Œå¯¼å…¥è¡¨çš„åˆ—åï¼Œæ•°æ® ç±»åž‹ç­‰ã€‚ 2ã€ç¬¬äºŒæ­¥ï¼Œè¿™äº›æ•°æ®åº“çš„æ•°æ®ç±»åž‹(varchar, number ç­‰)ä¼šè¢«æ˜ å°„æˆ Java çš„æ•°æ®ç±»åž‹(String, int ç­‰)ï¼Œæ ¹æ®è¿™äº›ä¿¡æ¯ï¼ŒSqoop ä¼šç”Ÿæˆä¸€ä¸ªä¸Žè¡¨ååŒåçš„ç±»ç”¨æ¥å®Œæˆåºåˆ—åŒ–å·¥ä½œï¼Œä¿å­˜è¡¨ä¸­çš„ æ¯ä¸€è¡Œè®°å½•ã€‚ 3ã€ç¬¬ä¸‰æ­¥ï¼ŒSqoop å¯åŠ¨ MapReducer ä½œä¸š 4ã€ç¬¬å››æ­¥ï¼Œå¯åŠ¨çš„ä½œä¸šåœ¨ input çš„è¿‡ç¨‹ä¸­ï¼Œä¼šé€šè¿‡ JDBC è¯»å–æ•°æ®è¡¨ä¸­çš„å†…å®¹ï¼Œè¿™æ—¶ï¼Œä¼šä½¿ ç”¨ Sqoop ç”Ÿæˆçš„ç±»è¿›è¡Œååºåˆ—åŒ–æ“ä½œ 5ã€ç¬¬äº”æ­¥ï¼Œæœ€åŽå°†è¿™äº›è®°å½•å†™åˆ° HDFS ä¸­ï¼Œåœ¨å†™å…¥åˆ° HDFS çš„è¿‡ç¨‹ä¸­ï¼ŒåŒæ ·ä¼šä½¿ç”¨ Sqoop ç”Ÿ æˆçš„ç±»è¿›è¡Œååºåˆ—åŒ– 7.2 å¯¼å‡ºåŽŸç† 1ã€ ç¬¬ä¸€æ­¥ï¼Œsqoop ä¾ç„¶ä¼šé€šè¿‡ JDBC è®¿é—®å…³ç³»åž‹æ•°æ®åº“ï¼Œå¾—åˆ°éœ€è¦å¯¼å‡ºæ•°æ®çš„å…ƒæ•°æ®ä¿¡æ¯ 2ã€ ç¬¬äºŒæ­¥ï¼Œæ ¹æ®èŽ·å–åˆ°çš„å…ƒæ•°æ®çš„ä¿¡æ¯ï¼Œsqoop ç”Ÿæˆä¸€ä¸ª Java ç±»ï¼Œç”¨æ¥è¿›è¡Œæ•°æ®çš„ä¼ è¾“è½½ ä½“ã€‚è¯¥ç±»å¿…é¡»å®žçŽ°åºåˆ—åŒ–å’Œååºåˆ—åŒ– 3ã€ ç¬¬ä¸‰æ­¥ï¼Œå¯åŠ¨ mapreduce ä½œä¸š 4ã€ ç¬¬å››æ­¥ï¼Œsqoop åˆ©ç”¨ç”Ÿæˆçš„è¿™ä¸ª java ç±»ï¼Œå¹¶è¡Œçš„ä»Ž hdfs ä¸­è¯»å–æ•°æ® 5ã€ ç¬¬äº”æ­¥ï¼Œæ¯ä¸ª map ä½œä¸šéƒ½ä¼šæ ¹æ®è¯»å–åˆ°çš„å¯¼å‡ºè¡¨çš„å…ƒæ•°æ®ä¿¡æ¯å’Œè¯»å–åˆ°çš„æ•°æ®ï¼Œç”Ÿæˆä¸€ æ‰¹ insert è¯­å¥ï¼Œç„¶åŽå¤šä¸ª map ä½œä¸šä¼šå¹¶è¡Œçš„å‘æ•°æ®åº“ mysql ä¸­æ’å…¥æ•°æ® æ‰€ä»¥ï¼Œæ•°æ®æ˜¯ä»Ž hdfs ä¸­å¹¶è¡Œçš„è¿›è¡Œè¯»å–ï¼Œä¹Ÿæ˜¯å¹¶è¡Œçš„è¿›å…¥å†™å…¥ï¼Œé‚£å¹¶è¡Œçš„è¯»å–æ˜¯ä¾èµ– hdfs çš„æ€§èƒ½ï¼Œè€Œå¹¶è¡Œçš„å†™å…¥åˆ° mysql ä¸­ï¼Œé‚£å°±è¦ä¾èµ–äºŽ mysql çš„å†™å…¥æ€§èƒ½å˜žã€‚ å®˜ç½‘: å‚è€ƒPDF:]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Sqoop</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Sqoop</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[i-HBase-1]]></title>
    <url>%2F2018%2F06%2F26%2FHadoop%2F5-HBase%2Fi-HBase-1%2F</url>
    <content type="text"><![CDATA[Hbaseæ¦‚å¿µ hbase &amp; hdfs å…³ç³»å›¾ hadoopæ•°æ®åº“ï¼Œåˆ†å¸ƒå¼å¯ä¼¸ç¼©å¤§åž‹æ•°æ®å­˜å‚¨ã€‚ ç”¨æˆ·å¯¹éšæœºã€å®žæ—¶è¯»å†™æ•°æ®ã€‚ åäº¿è¡Œ x ç™¾ä¸‡åˆ—ã€‚ ç‰ˆæœ¬åŒ–ã€éžå…³ç³»åž‹æ•°æ®åº“ã€‚ Feature Linear and modular scalability. //çº¿æ€§æ¨¡å—åŒ–æ‰©å±•æ–¹å¼ã€‚ Strictly consistent reads and writes. //ä¸¥æ ¼ä¸€è‡´æ€§è¯»å†™ Automatic and configurable sharding of tables//è‡ªåŠ¨å¯é…ç½®è¡¨åˆ‡å‰² Automatic failover support between RegionServers.//åŒºåŸŸæœåŠ¡å™¨ä¹‹é—´è‡ªåŠ¨å®¹åœ¨ Convenient base classes for backing Hadoop MapReduce jobs with Apache HBase tables. Easy to use Java API for client access.//java API Block cache and Bloom Filters for real-time queries//å—ç¼“å­˜å’Œå¸ƒéš†è¿‡æ»¤å™¨ç”¨äºŽå®žæ—¶æŸ¥è¯¢ Query predicate push down via server side Filters//é€šè¿‡æœåŠ¡å™¨ç«¯è¿‡æ»¤å™¨å®žçŽ°æŸ¥è¯¢é¢„æµ‹ Thrift gateway and a REST-ful Web service that supports XML, Protobuf, and binary data encoding options Extensible jruby-based (JIRB) shell Support for exporting metrics via the Hadoop metrics subsystem to files or Ganglia; or via JMX //å¯è§†åŒ– é¢å‘åˆ—æ•°æ®åº“ã€‚ HBaseè¦ç‚¹ 1) å®ƒä»‹äºŽ NoSQL å’Œ RDBMS ä¹‹é—´ï¼Œä»…èƒ½é€šè¿‡ä¸»é”®(rowkey)å’Œä¸»é”®çš„ range æ¥æ£€ç´¢æ•°æ® 2) HBase æŸ¥è¯¢æ•°æ®åŠŸèƒ½å¾ˆç®€å•ï¼Œä¸æ”¯æŒ join ç­‰å¤æ‚æ“ä½œ 3) ä¸æ”¯æŒå¤æ‚çš„äº‹åŠ¡ï¼Œåªæ”¯æŒè¡Œçº§äº‹åŠ¡(å¯é€šè¿‡ hive æ”¯æŒæ¥å®žçŽ°å¤šè¡¨ join ç­‰å¤æ‚æ“ä½œ)ã€‚ 4) HBase ä¸­æ”¯æŒçš„æ•°æ®ç±»åž‹:byte 5) ä¸»è¦ç”¨æ¥å­˜å‚¨ç»“æž„åŒ–å’ŒåŠç»“æž„åŒ–çš„æ¾æ•£æ•°æ®ã€‚ HBase è¡¨ç‰¹ç‚¹ å¤§:ä¸€ä¸ªè¡¨å¯ä»¥æœ‰ä¸Šåäº¿è¡Œï¼Œä¸Šç™¾ä¸‡åˆ— é¢å‘åˆ—:é¢å‘åˆ—(æ—)çš„å­˜å‚¨å’Œæƒé™æŽ§åˆ¶ï¼Œåˆ—(ç°‡)ç‹¬ç«‹æ£€ç´¢ã€‚ ç¨€ç–:å¯¹äºŽä¸ºç©º(null)çš„åˆ—ï¼Œå¹¶ä¸å ç”¨å­˜å‚¨ç©ºé—´ï¼Œå› æ­¤ï¼Œè¡¨å¯ä»¥è®¾è®¡çš„éžå¸¸ç¨€ç–ã€‚ æ— æ¨¡å¼:æ¯è¡Œéƒ½æœ‰ä¸€ä¸ªå¯æŽ’åºçš„ä¸»é”®å’Œä»»æ„å¤šçš„åˆ—ï¼Œåˆ—å¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€çš„å¢žåŠ ï¼ŒåŒä¸€ å¼ è¡¨ä¸­ä¸åŒçš„è¡Œå¯ä»¥æœ‰æˆªç„¶ä¸åŒçš„åˆ— HBase å­˜å‚¨æœºåˆ¶ é¢å‘åˆ—å­˜å‚¨ï¼Œtableæ˜¯æŒ‰rowæŽ’åºã€‚ åº•å±‚æ˜¯ è·³è¡¨ &amp; å¸ƒéš†è¿‡æ»¤å™¨ HBase å®šä½æœºåˆ¶(ä¸‰çº§åæ ‡) è¡Œrowkey åˆ—æ— &amp; åˆ—column family &amp; column æ—¶é—´æˆ³timestampç‰ˆæœ¬ è¡¨ è¡Œ åˆ— åˆ—æ—çš„å…³ç³» å®˜ç½‘çš„å…³ç³»å›¾å¦‚ä¸‹ å…¶å®ƒç‰ˆæœ¬ Table is a collection of rows.è¡¨æ˜¯è¡Œçš„é›†åˆ Row is a collection of column familiesè¡Œæ˜¯åˆ—æ—çš„é›†åˆ Column family is a collection of columns.åˆ—æ—æ˜¯åˆ—çš„é›†åˆ Column is a collection of key value pairs.åˆ—æ˜¯é”®å€¼å¯¹çš„é›†åˆ(åˆ—å…¶å®žå°±æ˜¯ key) RowKey, Column Family, TimeStamp, Cell æ¦‚å¿µè§£é‡Š RowKey æ˜¯ç”¨æ¥æ£€ç´¢è®°å½•çš„ä¸»é”® rowkey è¡Œé”®å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²(æœ€å¤§é•¿åº¦æ˜¯ 64KBï¼Œå®žé™…åº”ç”¨ä¸­é•¿åº¦ä¸€èˆ¬ä¸º 10-100bytes)ï¼Œæœ€å¥½æ˜¯ 16ã€‚ æ¯ä¸€ä¸ªç‰©ç†æ–‡ä»¶ä¸­éƒ½ä¼šå­˜ä¸€ä¸ª rk:TODO ?? åœ¨ HBase å†…éƒ¨ï¼Œrowkey ä¿å­˜ä¸ºå­—èŠ‚æ•°ç»„ã€‚HBase ä¼šå¯¹è¡¨ä¸­çš„æ•°æ®æŒ‰ç…§ rowkey æŽ’åº (å­—å…¸é¡ºåº) è®¾è®¡ key æ—¶ï¼Œè¦å……åˆ†æŽ’åºå­˜å‚¨è¿™ ä¸ªç‰¹æ€§ï¼Œå°†ç»å¸¸ä¸€èµ·è¯»å–çš„è¡Œå­˜å‚¨æ”¾åˆ°ä¸€èµ·ã€‚(ä½ç½®ç›¸å…³æ€§) æ³¨æ„ï¼šå­—å…¸åºå¯¹ int æŽ’åºçš„ç»“æžœæ˜¯1,10,100,11,12,13,14,15,16,17,18,19,2,20,21,â€¦9,91,92,93,94,95,96,97,98,99ã€‚è¦ä¿æŒæ•´å½¢çš„è‡ªç„¶åºï¼Œè¡Œé”®å¿…é¡»ç”¨ 0 ä½œå·¦å¡«å……ã€‚ Column Family åˆ—æ—æ˜¯è¡¨çš„ Schema çš„ä¸€éƒ¨åˆ†(è€Œåˆ—ä¸æ˜¯)ï¼Œå¿…é¡»åœ¨ä½¿ç”¨è¡¨ä¹‹å‰å®šä¹‰å¥½ï¼Œè€Œä¸”å®šä¹‰å¥½äº†ä¹‹åŽå°±ä¸èƒ½æ›´æ”¹ã€‚ HBase è¡¨ä¸­çš„æ¯ä¸ªåˆ—ï¼Œéƒ½å½’å±žä¸ŽæŸä¸ªåˆ—ç°‡ã€‚ åˆ—ç°‡è¶Šå¤šï¼Œåœ¨å–ä¸€è¡Œæ•°æ®æ—¶æ‰€è¦å‚ä¸Ž IOã€æœå¯»çš„æ–‡ä»¶å°±è¶Šå¤šï¼Œæ‰€ä»¥ï¼Œå¦‚æžœæ²¡æœ‰å¿…è¦ï¼Œä¸è¦ è®¾ç½®å¤ªå¤šçš„åˆ—ç°‡ï¼ˆæœ€å¥½å°±ä¸€ä¸ªåˆ—ç°‡ï¼‰ TimeStamp HBase ä¸­é€šè¿‡ rowkey å’Œ columns ç¡®å®šçš„ä¸ºä¸€ä¸ªå­˜å‚¨å•å…ƒç§°ä¸º cellã€‚ æ¯ä¸ª cell éƒ½ä¿å­˜ç€åŒä¸€ä»½ æ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ã€‚ ç‰ˆæœ¬é€šè¿‡æ—¶é—´æˆ³æ¥ç´¢å¼•ã€‚ æ¯ä¸ª cell ä¸­ï¼Œä¸åŒç‰ˆæœ¬çš„æ•°æ®æŒ‰ç…§æ—¶é—´å€’åºæŽ’åºï¼Œå³æœ€æ–°çš„æ•°æ®æŽ’åœ¨æœ€å‰é¢ã€‚ hbase æä¾›äº†ä¸¤ç§æ•°æ®ç‰ˆ æœ¬å›žæ”¶æ–¹å¼: ä¿å­˜æ•°æ®çš„æœ€åŽ n ä¸ªç‰ˆæœ¬ ä¿å­˜æœ€è¿‘ä¸€æ®µæ—¶é—´å†…çš„ç‰ˆæœ¬(è®¾ç½®æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸ TTL)ã€‚ Cell å•å…ƒæ ¼ ç”±{rowkey, column( = + ), version} å”¯ä¸€ç¡®å®šçš„å•å…ƒã€‚ Cell ä¸­çš„æ•°æ®æ˜¯æ²¡æœ‰ç±»åž‹çš„ï¼Œå…¨éƒ¨æ˜¯å­—èŠ‚ç å½¢å¼å­˜è´®ã€‚ HBase çš„HAæ­å»º é€‰æ‹©å®‰è£…çš„ä¸»æœºcs1~cs4, å®‰è£…jdk, è§£åŽ‹hbase åŒ…, é…ç½®çŽ¯å¢ƒå˜é‡ éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ$&gt;hbase version é…ç½® hbase å®Œå…¨åˆ†å¸ƒå¼[hbase/conf/hbase-env.sh]export JAVA_HOME=/usr/local/jdk1.8.0_73export HBASE_MANAGES_ZK=false [hbse-site.xml] hbase.cluster.distributed true hbase.rootdir hdfs://mycluster/hbase hbase.zookeeper.quorum cs1:2181,cs2:2181,cs3:2181 hbase.zookeeper.property.dataDir /home/ap/zookeeper é…ç½® regonservers[hbase/conf/regionservers]cs2cs3cs4cs5 ä¿®æ”¹ backup-mastersï¼ˆè‡ªè¡Œåˆ›å»ºï¼‰ï¼ŒæŒ‡å®šå¤‡ç”¨çš„ä¸»HMaster vi backup-masterscs6 æœ€é‡è¦ä¸€æ­¥: å‚»é€¼ç‰ˆ: è¦æŠŠ hadoop çš„ hdfs-site.xml å’Œ core-site.xml æ”¾åˆ° hbase/conf ä¸‹, è¿™æ ·hbase æ‰èƒ½é€šè¿‡å‘½åç©ºé—´mycluster æ‰¾åˆ°å½“å‰å¯ç”¨ namenode, å†é€šè¿‡ namenode åˆ†é…æŒ‡å®š hbase åœ¨ HDFSä¸Šçš„å­˜å‚¨è·¯å¾„cp /apps/hadoop/etc/hadoop/core-site.xml /apps/hbase/conf/cp /apps/hadoop/etc/hadoop/hdfs-site.xml /apps/hbase/conf/ é«˜çº§ç‰ˆ: åœ¨hbase-env.shæ–‡ä»¶æ·»åŠ hadoopé…ç½®æ–‡ä»¶ç›®å½•åˆ°HBASE_CLASSPATHçŽ¯å¢ƒå˜é‡å¹¶åˆ†å‘.[/soft/hbase/conf/hbase-env.sh]export HBASE_CLASSPATH=$HBASE_CLASSPATH:/soft/hadoop/etc/hadoop åœ¨hbase/conf/ç›®å½•ä¸‹åˆ›å»ºåˆ°hadoopçš„hdfs-site.xmlç¬¦å·è¿žæŽ¥ã€‚$&gt;ln -s /soft/hadoop/etc/hadoop/hdfs-site.xml /soft/hbase/conf/hdfs-site.xml å¯åŠ¨ hbase é›†ç¾¤$&gt;start-hbase.sh ç™»å½• hbase çš„ webUI http://cs1:16010/ æ³¨æ„, é¡µé¢ä¸Šæ˜¾ç¤ºçš„ç‰ˆæœ¬, æ˜¯~/apps/hbase/libä¸­è‡ªå·±å­˜å‚¨çš„ jar åŒ…çš„ç‰ˆæœ¬ å¯åŠ¨/åœæ­¢ hbase è¿›ç¨‹ start-hbase.sh ç­‰ä»·äºŽ hbase-daemon.sh start master hbase-daemons.sh start regionserver æ³¨æ„: åœ¨å“ªä¸ªèŠ‚ç‚¹å¯åŠ¨ start-hbase.sh , å°±åœ¨å“ªé‡Œå¯åŠ¨ HMaster è¿›ç¨‹, å¦‚æžœ stop-hbase.shåœæ­¢ hbase HBase shell æ“ä½œç™»å½•shellç»ˆç«¯. $hbase&gt; hbase shell help ç›¸å…³ $hbase&gt; helpæŸ¥çœ‹æ‰€æœ‰å¸®åŠ© $hbase&gt; table_helpå…³äºŽè¡¨æ“ä½œçš„å¦å¤–ä¸€ç§æ–¹å¼çš„å¸®åŠ©æ–‡æ¡£ $hbase&gt; help â€œdmlâ€èŽ·å–ä¸€ç»„å‘½ä»¤çš„æç¤º $hbase&gt;help â€˜list_namespaceâ€™æŸ¥çœ‹ç‰¹å®šçš„å‘½ä»¤å¸®åŠ© desc æŸ¥çœ‹æè¿°ä¿¡æ¯ desc â€˜t1â€™ : ä¸‹é¢è¿™äº›åœ¨å»ºè¡¨çš„æ—¶å€™éƒ½å¯ä»¥æŒ‡å®š{NAME =&gt; â€˜f1â€™, BLOOMFILTER =&gt; â€˜ROWâ€™, VERSIONS =&gt; â€˜1â€™, IN_MEMORY =&gt; â€˜falseâ€™, KEEP_DELETED_CELLS =&gt; â€˜FALSEâ€™, DATA_BLOCK_ENCODING =&gt; â€˜NONEâ€™, TTL =&gt; â€˜FOREVERâ€™, COMPRESSION =&gt; â€˜NONEâ€™, MIN_VERSIONS =&gt; â€˜0â€™, BLOCKCACHE =&gt; â€˜trueâ€™, BLOCKSIZE =&gt; â€˜65536â€™, REPLICATION_SCOPE =&gt; â€˜0â€™}1 row(s) in 0.1780 seconds list ç›¸å…³ $hbase&gt; liståˆ—å‡ºæ‰€æœ‰éžç³»ç»Ÿè¡¨ $hbase&gt;list_namespaceåˆ—å‡ºåå­—ç©ºé—´(æ•°æ®åº“) $hbase&gt;list_namespace_tables â€˜defalutâ€™åˆ—å‡ºåå­—ç©ºé—´çš„æ‰€ä»¥è¡¨ create ç›¸å…³ $hbase&gt;create_namespace â€˜ns1â€™åˆ›å»ºåå­—ç©ºé—´ $hbase&gt;create â€˜ns1:t1â€™,â€™f1â€™åˆ›å»ºè¡¨,æŒ‡å®šç©ºé—´ä¸‹,åˆ—æ—æ³¨æ„: å¦‚æžœ t1å·²ç»åˆ›å»ºäº†, å°±ä¸èƒ½é€šè¿‡è¿™ä¸ªæ–¹å¼æ¥æ·»åŠ  åˆ—æ— create â€˜t1â€™,â€™f1â€™ create â€˜user_infoâ€™,{NAME=&gt;â€™base_infoâ€™,VERSIONS=&gt;3 },{NAME=&gt;â€™extra_infoâ€™,VERSIONS=&gt;1 }åŒæ—¶åˆ›å»ºå¤šä¸ª åˆ—æ— exist ç›¸å…³ exists â€˜t1â€™æŸ¥çœ‹è¡¨æ˜¯å¦å­˜åœ¨ put ç›¸å…³ æ³¨æ„: å¦‚æžœå¾€ åŒè¡¨ &amp; åŒrowkey &amp; åŒæ ·çš„åˆ— ä¸­æ’å…¥ value, ä¼šé»˜è®¤å±•ç¤ºæœ€è¿‘çš„ä¸€ä¸ªæ—¶é—´æˆ³çš„ä¿¡æ¯, å¦‚æžœ get çš„å›žæ”¶æŒ‡å®š VERSIONSæ•°é‡, åˆ™ä¼šå±•ç¤ºæ­¤æ•°é‡çš„ç‰ˆæœ¬ä¿¡æ¯ å‘ user è¡¨ä¸­æ’å…¥ä¿¡æ¯ï¼Œrow key ä¸º rk0001ï¼Œåˆ—ç°‡ info ä¸­æ·»åŠ  name åˆ—æ ‡ç¤ºç¬¦ï¼Œå€¼ä¸º zhangsan put â€˜userâ€™, â€˜rk0001â€™, â€˜info:nameâ€™, â€˜zhangsanâ€™, 1482077777777æ‰‹åŠ¨æŒ‡å®šæ—¶é—´æˆ³æ—¶é—´æˆ³æ˜¯å¯ä»¥è‡ªå·±æŒ‡å®šçš„ï¼Œå¦‚è‹¥ä¸æŒ‡å®šï¼Œåˆ™ä¼šè‡ªåŠ¨èŽ·å–ç³»ç»Ÿçš„å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ å‘ user è¡¨ä¸­æ’å…¥ä¿¡æ¯ï¼Œrow key ä¸º rk0001ï¼Œåˆ—ç°‡ info ä¸­æ·»åŠ  gender åˆ—æ ‡ç¤ºç¬¦ï¼Œå€¼ä¸º female put â€˜userâ€™, â€˜rk0001â€™, â€˜info:genderâ€™, â€˜femaleâ€™ å‘ user è¡¨ä¸­æ’å…¥ä¿¡æ¯ï¼Œrow key ä¸º rk0001ï¼Œåˆ—ç°‡ info ä¸­æ·»åŠ  age åˆ—æ ‡ç¤ºç¬¦ï¼Œå€¼ä¸º 20 put â€˜userâ€™, â€˜rk0001â€™, â€˜info:ageâ€™, 20 å‘ user è¡¨ä¸­æ’å…¥ä¿¡æ¯ï¼Œrow key ä¸º rk0001ï¼Œåˆ—ç°‡ data ä¸­æ·»åŠ  pic åˆ—æ ‡ç¤ºç¬¦ï¼Œå€¼ä¸º picture put â€˜userâ€™, â€˜rk0001â€™, â€˜data:picâ€™, â€˜pictureâ€™ get ç›¸å…³ èŽ·å– user è¡¨ä¸­ row key ä¸º rk0001 çš„æ‰€æœ‰ä¿¡æ¯ æ³¨æ„: â€˜è¡¨åâ€™, â€˜ rowkeyâ€™ get â€˜userâ€™, â€˜rk0001â€™ èŽ·å– user è¡¨ä¸­ row key ä¸º rk0001ï¼Œinfo åˆ—ç°‡çš„æ‰€æœ‰ä¿¡æ¯ æ³¨æ„: â€˜è¡¨åâ€™, â€˜ rowkeyâ€™, â€˜åˆ—æ—åâ€™ get â€˜userâ€™, â€˜rk0001â€™, â€˜infoâ€™ èŽ·å– user è¡¨ä¸­ row key ä¸º rk0001ï¼Œinfo åˆ—ç°‡çš„ nameã€age åˆ—æ ‡ç¤ºç¬¦çš„ä¿¡æ¯ æ³¨æ„: â€˜è¡¨åâ€™, â€˜rowkeyâ€™, â€˜åˆ—æ—åâ€™:â€™åˆ—åâ€™, â€˜åˆ—æ—åâ€™:â€™åˆ—åâ€™ get â€˜userâ€™, â€˜rk0001â€™, â€˜info:nameâ€™, â€˜info:ageâ€™ èŽ·å– user è¡¨ä¸­ row key ä¸º rk0001ï¼Œinfoã€data åˆ—ç°‡çš„ä¿¡æ¯ æ³¨æ„: â€˜è¡¨åâ€™, â€˜rowkeyâ€™, â€˜åˆ—æ—åâ€™, â€˜åˆ—æ—åâ€™ get â€˜userâ€™, â€˜rk0001â€™, â€˜infoâ€™, â€˜dataâ€™ get â€˜userâ€™, â€˜rk0001â€™, {COLUMN =&gt; [â€˜infoâ€™, â€˜dataâ€™]} get â€˜userâ€™, â€˜rk0001â€™, {COLUMN =&gt; [â€˜info:nameâ€™, â€˜data:picâ€™]} èŽ·å– user è¡¨ä¸­ row key ä¸º rk0001ï¼Œåˆ—ç°‡ä¸º infoï¼Œç‰ˆæœ¬å·æœ€æ–° 5 ä¸ªçš„ä¿¡æ¯ æ³¨æ„: â€˜è¡¨åâ€™, â€˜rowkeyâ€™, {COLUMN =&gt;â€™åˆ—æ—åâ€™, å­˜å‚¨ç‰ˆæœ¬æ•°=&gt; æ•°é‡} get â€˜userâ€™, â€˜rk0001â€™, {COLUMN =&gt; â€˜infoâ€™, VERSIONS =&gt; 2} get â€˜userâ€™, â€˜rk0001â€™, {COLUMN =&gt; â€˜info:nameâ€™, VERSIONS =&gt; 5} get â€˜userâ€™, â€˜rk0001â€™, {COLUMN =&gt; â€˜info:nameâ€™, VERSIONS =&gt; 5, TIMERANGE =&gt; [1392368783980, 1392380169184]} èŽ·å– user è¡¨ä¸­ row key ä¸º rk0001ï¼Œåˆ—æ ‡ç¤ºç¬¦ä¸­å«æœ‰ a çš„ä¿¡æ¯ get â€˜peopleâ€™, â€˜rk0001â€™, {FILTER =&gt; â€œ(QualifierFilter(=,â€™substring:aâ€™))â€} èŽ·å– å›½ç± ä¸ºä¸­å›½çš„ç”¨æˆ·ä¿¡æ¯ æ³¨æ„: â€˜è¡¨åâ€™, â€˜rowkeyâ€™, â€˜åˆ—æ—åâ€™:â€™åˆ—åâ€™, â€˜valueâ€™ put â€˜userâ€™, â€˜rk0002â€™, â€˜info:nameâ€™, â€˜fanbingbingâ€™ put â€˜userâ€™, â€˜rk0002â€™, â€˜info:genderâ€™, â€˜femaleâ€™ put â€˜userâ€™, â€˜rk0002â€™, â€˜info:nationalityâ€™, â€˜ä¸­å›½â€™ get â€˜userâ€™, â€˜rk0002â€™, {FILTER =&gt; â€œValueFilter(=, â€˜binary:ä¸­å›½â€™)â€} èŽ·å–2ä¸ªä¸åŒåˆ—ä¸­çš„æŒ‡å®šå­—æ®µ æ³¨æ„: â€˜è¡¨åâ€™, â€˜rowkeyâ€™, {COLUMN =&gt; [â€˜åˆ—æ—åâ€™:â€™åˆ—åâ€™, â€˜åˆ—æ—åâ€™:â€™åˆ—åâ€™]} get â€˜userâ€™, â€˜rk0002â€™, {COLUMN =&gt; [â€˜info:nameâ€™, â€˜data:picâ€™]} scan ç›¸å…³ æ‰«æå…ƒæ•°æ® scan â€˜hbase : metaâ€™ t9,,1529936935368.f1a900954c069f0319195f16043c8e1a column=info:regioninfo, timestamp=1529936935933, value={ENCODED =&gt; f1a900954c069f0319195f16043c8e1a, NAME =&gt; â€˜t9,,1529936935368.f1a900954c069f031919 . 5f16043c8e1a.â€™, STARTKEY =&gt; â€˜â€™, ENDKEY =&gt; â€˜â€™} t9,,1529936935368.f1a900954c069f0319195f16043c8e1a column=info:seqnumDuringOpen, timestamp=1529936935933, value=\x00\x00\x00\x00\x00\x00\x00\x02 . t9,,1529936935368.f1a900954c069f0319195f16043c8e1a column=info:server, timestamp=1529936935933, value=cs5:16020 . t9,,1529936935368.f1a900954c069f0319195f16043c8e1a column=info:serverstartcode, timestamp=1529936935933, value=1529923622913 $hbase&gt;split â€˜ns1:t1â€™//åˆ‡å‰²è¡¨ $hbase&gt;split â€˜â€™ //åˆ‡å‰²åŒºåŸŸ, è§ä¸‹é¢ åˆ‡å‰²ä¹‹å‰ åˆ‡å‰²ä¹‹åŽ UIç•Œé¢ table regions ç»§ç»­è¿›è¡Œ region åˆ‡å‰² scan â€˜hbase:metaâ€™ æ‰¾åˆ°åˆ‡å‰²ç‚¹ STARTKEY =&gt; â€˜row000550â€™ çš„ é‚£è¡Œçš„ NAME =&gt; åŽé¢çš„å€¼ ä»Žè¿™ä¸ªå€¼å¼€å§‹åˆ‡å‰²åˆ°æŒ‡å®šå€¼split â€˜t9,row000551,1529938745618.90ed2fb6b7744ea5f0a7ff613d05aada.â€™,â€™row000888â€™ æ‰«æè¡¨ä¸­æ‰€æœ‰çš„ä¿¡æ¯ $hbase&gt;scan â€˜ns1:t1â€™ æŸ¥è¯¢ user è¡¨ä¸­åˆ—ç°‡ä¸º info çš„ä¿¡æ¯ hbase&gt; scan â€˜hbase:metaâ€™æ‰«ææƒæ ‡ $hbase&gt; scan â€˜hbase:metaâ€™, {COLUMNS =&gt; â€˜infoâ€™}æ³¨æ„: COLUMNSè¦å¤§å†™ $hbase&gt; scan â€˜ns1:t1â€™, {COLUMNS =&gt; [â€˜c1â€™, â€˜c2â€™], LIMIT =&gt; 10, STARTROW =&gt; â€˜xyzâ€™} scan â€˜userâ€™, {COLUMNS =&gt; â€˜infoâ€™, RAW =&gt; true, VERSIONS =&gt; 5} scan â€˜persionâ€™, {COLUMNS =&gt; â€˜infoâ€™, RAW =&gt; true, VERSIONS =&gt; 3}Scan æ—¶å¯ä»¥è®¾ç½®æ˜¯å¦å¼€å¯ Raw æ¨¡å¼ï¼Œå¼€å¯ Raw æ¨¡å¼ä¼šè¿”å›žåŒ…æ‹¬å·²æ·»åŠ åˆ é™¤æ ‡è®°ä½†æ˜¯æœª å®žé™…åˆ é™¤çš„æ•°æ®ã€‚ æŸ¥è¯¢ user è¡¨ä¸­åˆ—ç°‡ä¸º info å’Œ data çš„ä¿¡æ¯ scan â€˜userâ€™, {COLUMNS =&gt; [â€˜infoâ€™, â€˜dataâ€™]} scan â€˜userâ€™, {COLUMNS =&gt; [â€˜info:nameâ€™, â€˜data:picâ€™]} æŸ¥è¯¢ user è¡¨ä¸­åˆ—ç°‡ä¸º infoã€åˆ—æ ‡ç¤ºç¬¦ä¸º name çš„ä¿¡æ¯ scan â€˜userâ€™, {COLUMNS =&gt; â€˜info:nameâ€™} æŸ¥è¯¢ user è¡¨ä¸­åˆ—ç°‡ä¸º infoã€åˆ—æ ‡ç¤ºç¬¦ä¸º name çš„ä¿¡æ¯,å¹¶ä¸”ç‰ˆæœ¬æœ€æ–°çš„ 5 ä¸ª scan â€˜userâ€™, {COLUMNS =&gt; â€˜info:nameâ€™, VERSIONS =&gt; 5} æŸ¥è¯¢ user è¡¨ä¸­åˆ—ç°‡ä¸º info å’Œ data ä¸”åˆ—æ ‡ç¤ºç¬¦ä¸­å«æœ‰ a å­—ç¬¦çš„ä¿¡æ¯ scan â€˜userâ€™, {COLUMNS =&gt; [â€˜infoâ€™, â€˜dataâ€™], FILTER =&gt; â€œ(QualifierFilter(=,â€™substring:aâ€™))â€} æŸ¥è¯¢ user è¡¨ä¸­åˆ—ç°‡ä¸º infoï¼Œrk èŒƒå›´æ˜¯[rk0001, rk0003)çš„æ•°æ® scan â€˜peopleâ€™, {COLUMNS =&gt; â€˜infoâ€™, STARTROW =&gt; â€˜rk0001â€™, ENDROW =&gt; â€˜rk0003â€™} æŸ¥è¯¢ user è¡¨ä¸­ row key ä»¥ rk å­—ç¬¦å¼€å¤´çš„ scan â€˜userâ€™,{FILTER=&gt;â€PrefixFilter(â€˜rkâ€™)â€} æŸ¥è¯¢ user è¡¨ä¸­æŒ‡å®šèŒƒå›´çš„æ•°æ® scan â€˜userâ€™, {TIMERANGE =&gt; [1392368783980, 1392380169184]} delete/truncate ç›¸å…³ (åˆ é™¤,æ¸…ç©ºæ•°æ®) æ³¨æ„: åˆ é™¤åˆ—æ—, åœ¨ alter ä¸­ åˆ é™¤ user è¡¨ row key ä¸º rk0001ï¼Œåˆ—æ ‡ç¤ºç¬¦ä¸º info:name çš„å­—æ®µæ•°æ® delete â€˜peopleâ€™, â€˜rk0001â€™, â€˜info:nameâ€™ åˆ é™¤ user è¡¨ row key ä¸º rk0001ï¼Œåˆ—æ ‡ç¤ºç¬¦ä¸º info:nameï¼Œtimestamp ä¸º 1392383705316 çš„æ•°æ® delete â€˜userâ€™, â€˜rk0001â€™, â€˜info:nameâ€™, 1392383705316 æ¸…ç©º user è¡¨ä¸­çš„æ•°æ® truncate â€˜peopleâ€™ç›®å‰ç‰ˆæœ¬ä¼šå…ˆ disable , å† truncate, æœ€åŽå† enable alter ç›¸å…³ æ³¨æ„,åœ¨ä¿®æ”¹åˆ—æ— æ—¶ hbase&gt; alter â€˜t1â€™, NAME =&gt; â€˜f1â€™, VERSIONS =&gt; 5 VERSIONS æ˜¯æŒ‡èƒ½å­˜å¤šå°‘ä¸ªç‰ˆæœ¬, å¦‚æžœä¸æŒ‡å®šçš„è¯, é€€å‡º hbase çš„æ—¶å€™, é»˜è®¤åªä¼šç•™æœ€æ–°çš„ä¸€ä¸ªç‰ˆæœ¬ å¦‚æžœå­˜åœ¨, å°±æ˜¯ä¿®æ”¹ ä¸å­˜åœ¨, å°±æ˜¯å¢žåŠ  æ·»åŠ ä¸¤ä¸ªåˆ—ç°‡ f1 å’Œ f2 ç®€å†™: alter â€˜t1â€™, â€˜f2â€™ alter â€˜peopleâ€™, NAME =&gt; â€˜f1â€™ alter â€˜userâ€™, NAME =&gt; â€˜f2â€™ åœç”¨/å¯ç”¨ è¡¨ enable â€˜t9â€™å¯ç”¨ is_enabled â€˜t9â€™æ˜¯å¦å¯ç”¨ disable â€˜t9â€™åœç”¨ is_disabled â€˜t9â€™æ˜¯å¦ä¸å¯ç”¨ åˆ é™¤ä¸€ä¸ªåˆ—ç°‡: æ³¨æ„: å½“è¡¨ä¸­åªæœ‰ä¸€ä¸ªåˆ—æ—æ—¶, æ— æ³•å°†å…¶åˆ é™¤ disable â€˜userâ€™(æ–°ç‰ˆæœ¬ä¸ç”¨) alter â€˜userâ€™, NAME =&gt; â€˜f1â€™, METHOD =&gt; â€˜deleteâ€™ æˆ– alter â€˜userâ€™, â€˜deleteâ€™ =&gt; â€˜f1â€™ enable â€˜userâ€™ æ·»åŠ åˆ—ç°‡ f1 åŒæ—¶åˆ é™¤åˆ—ç°‡ f2 disable â€˜userâ€™(æ–°ç‰ˆæœ¬ä¸ç”¨) alter â€˜userâ€™, {NAME =&gt; â€˜f1â€™}, {NAME =&gt; â€˜f2â€™, METHOD =&gt; â€˜deleteâ€™} enable â€˜userâ€™ å°† user è¡¨çš„ f1 åˆ—ç°‡ç‰ˆæœ¬å·æ”¹ä¸º 5 disable â€˜userâ€™(æ–°ç‰ˆæœ¬ä¸ç”¨) alter â€˜peopleâ€™, NAME =&gt; â€˜infoâ€™, VERSIONS =&gt; 5people ä¸º rowkey enable â€˜userâ€™ drop ç›¸å…³ disable â€˜userâ€™ drop â€˜userâ€™ count ç›¸å…³ $hbase&gt;count â€˜ns1:t1â€™ç»Ÿè®¡å‡½æ•°, 1000è¡Œç»Ÿè®¡ä¸€æ¬¡ flush ç›¸å…³ æŠŠæ–‡ä»¶åˆ·åˆ°ç£ç›˜çš„è¿‡ç¨‹ hbase&gt; flush â€˜TABLENAMEâ€™ hbase&gt; flush â€˜REGIONNAMEâ€™ hbase&gt; flush â€˜ENCODED_REGIONNAMEâ€™ ValueFilter è¿‡æ»¤å™¨ get â€˜personâ€™, â€˜rk0001â€™, {FILTER =&gt; â€œValueFilter(=, â€˜binary:ä¸­å›½â€™)â€} get â€˜personâ€™, â€˜rk0001â€™, {FILTER =&gt; â€œ(QualifierFilter(=,â€™substring:aâ€™))â€} exit é€€å‡º$hbase&gt; exit é‡åˆ°é—®é¢˜æ€»ç»“ æ’å…¥å‰, å¿…é¡»åˆ›å»ºå¥½ namespaceç›¸å½“äºŽæ•°æ®åº“çš„æ¦‚å¿µ tableè¡¨å‘½ column familyåˆ—æ—å ä¸éœ€è¦æå‰åˆ›å»º è¡Œå åˆ—å value å¦‚æžœè¡¨å·²ç»åˆ›å»º, è¦å¢žåŠ åˆ—æ—çš„è¯, åªèƒ½ç”¨ alter, ä¸èƒ½ç»§ç»­ç”¨ create é€šè¿‡Java APIè®¿é—®Hbase åˆ›å»ºhbaseæ¨¡å— æ·»åŠ ä¾èµ–&lt;?xml version=â€1.0â€ encoding=â€UTF-8â€?&gt; 4.0.0 com.rox HbaseDemo 1.0-SNAPSHOT org.apache.hbase hbase-client 1.2.3 å¤åˆ¶hbaseé›†ç¾¤çš„hbase-site.xmlæ–‡ä»¶åˆ°æ¨¡å—çš„src/main/resourcesç›®å½•ä¸‹ã€‚ -â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Hbase API ç±»å’Œæ•°æ®æ¨¡åž‹ä¹‹é—´çš„å¯¹åº”å…³ç³»: \0. æ€»çš„å¯¹åº”å…³ç³» HBaseAdmin ç¼–ç¨‹å®žçŽ° ä»£ç è§ https://github.com/airpoet/bigdata/blob/master/HBaseDemo/src/test/java/com/rox/text/TestCRUD.javapublic class TestCRUD {@Testpublic void put() throws IOException {// åˆ›å»º conf å¯¹è±¡Configuration conf = HBaseConfiguration.create();/ é€šè¿‡è¿žæŽ¥å·¥åŽ‚åˆ›å»ºè¿žæŽ¥å¯¹ /// é€šè¿‡è¿žæŽ¥å·¥åŽ‚åˆ›å»ºè¿žæŽ¥å¯¹è±¡Connection conn = ConnectionFactory.createConnection(conf);// é€šè¿‡è¿žæŽ¥æŸ¥è¯¢ TableName å¯¹è±¡TableName tname = TableName.valueOf(â€œns1:t1â€);// èŽ·å¾— tableå¯¹è±¡Table table = conn.getTable(tname);// é€šè¿‡bytes å·¥å…·ç±»è½¬åŒ–å­—ç¬¦ä¸²ä¸ºå­—èŠ‚æ•°ç»„byte[] bytes = Bytes.toBytes(â€œrow3â€);// åˆ›å»º put å¯¹è±¡, ä¼ å…¥è¡Œå·Put put = new Put(bytes);// åˆ›å»º åˆ—æ—, åˆ—, value çš„ byte æ•°æ®byte[] f1 = Bytes.toBytes(â€œf1â€);byte[] id = Bytes.toBytes(â€œidâ€);byte[] value = Bytes.toBytes(188);put.addColumn(f1, id, value);// table put æ•°æ®table.put(put);//============================// getbyte[] rowid = Bytes.toBytes(â€œrow3â€);Get get = new Get(rowid);// å¾—åˆ° resResult res = table.get(get); // ä»Ž res ä¸­å–å‡º valuebyte[] idvalue = res.getValue(Bytes.toBytes(â€œf1â€),Bytes.toBytes(â€œidâ€));System.out.println(Bytes.toInt(idvalue));}} HBase å†™å…¥è¿‡ç¨‹ &amp; å­˜å‚¨è·¯å¾„ WALwrite ahead log,å†™å‰æ—¥å¿—ã€‚ HDFS ä¸Šå­˜å‚¨è·¯å¾„è¯¦è§£ http://cs1:50070/explorer.html#/hbase/data/ns1/t1/97eada11d196f1e134c41e859d338e07/f1/fsfsfgwgfsgfrgfdg dataå­˜å‚¨æ•°æ®çš„ç›®å½• ns1namespace åç§° t1è¡¨å 97eada11d196f1e134c41e859d338e07region çš„ç¼–å· f1åˆ—æ— fsfsfgwgfsgfrgfdgHFile: åˆ—æ—å­˜å‚¨çš„æ–‡ä»¶, æ¯ä¸€ä¸ª hfile æ–‡ä»¶å¯¹åº”çš„æ˜¯ä¸€ä¸ªåˆ—æ— meta æ•°æ®è·¯å¾„ http://cs1:50070/explorer.html#/hbase/data/hbase/meta/1588230740/info HBase å’Œ Hive çš„æ¯”è¾ƒ ç›¸åŒç‚¹ HBase å’Œ Hive éƒ½æ˜¯æž¶æž„åœ¨ Hadoop ä¹‹ä¸Šï¼Œç”¨ HDFS åšåº•å±‚çš„æ•°æ®å­˜å‚¨ï¼Œç”¨ MapReduce åš æ•°æ®è®¡ç®— ä¸åŒç‚¹ è§£å†³çš„é—®é¢˜ä¸åŒ Hive æ˜¯å»ºç«‹åœ¨ Hadoop ä¹‹ä¸Šä¸ºäº†é™ä½Ž MapReduce ç¼–ç¨‹å¤æ‚åº¦çš„ ETL å·¥å…·ã€‚ HBase æ˜¯ä¸ºäº†å¼¥è¡¥ Hadoop å¯¹å®žæ—¶æ“ä½œçš„ç¼ºé™· è¡¨çš„æž¶æž„ä¸åŒ Hive è¡¨æ˜¯çº¯é€»è¾‘è¡¨ï¼Œå› ä¸º Hive çš„æœ¬èº«å¹¶ä¸èƒ½åšæ•°æ®å­˜å‚¨å’Œè®¡ç®—ï¼Œè€Œæ˜¯å®Œå…¨ä¾èµ– Hadoop HBase æ˜¯ç‰©ç†è¡¨ï¼Œæä¾›äº†ä¸€å¼ è¶…å¤§çš„å†…å­˜ Hash è¡¨æ¥å­˜å‚¨ç´¢å¼•ï¼Œæ–¹ä¾¿æŸ¥è¯¢ å®šä½ &amp; è®¿é—®æœºåˆ¶ä¸åŒ Hive æ˜¯æ•°æ®ä»“åº“å·¥å…·ï¼Œéœ€è¦å…¨è¡¨æ‰«æï¼Œå°±ç”¨ Hiveï¼Œå› ä¸º Hive æ˜¯æ–‡ä»¶å­˜å‚¨ HBase æ˜¯æ•°æ®åº“ï¼Œéœ€è¦ç´¢å¼•è®¿é—®ï¼Œåˆ™ç”¨ HBaseï¼Œå› ä¸º HBase æ˜¯é¢å‘åˆ—çš„ NoSQL æ•°æ®åº“ å­˜å‚¨æ¨¡å¼ä¸åŒ Hive è¡¨ä¸­å­˜å…¥æ•°æ®(æ–‡ä»¶)æ—¶ä¸åšæ ¡éªŒï¼Œå±žäºŽè¯»æ¨¡å¼å­˜å‚¨ç³»ç»Ÿ HBase è¡¨æ’å…¥æ•°æ®æ—¶ï¼Œä¼šå’Œ RDBMS ä¸€æ ·åš Schema æ ¡éªŒï¼Œæ‰€ä»¥å±žäºŽå†™æ¨¡å¼å­˜å‚¨ç³»ç»Ÿ æ˜¯å¦å®žæ—¶å¤„ç†(å¤„ç†æ•ˆçŽ‡)ä¸åŒ Hive ä¸æ”¯æŒå•è¡Œè®°å½•æ“ä½œï¼Œæ•°æ®å¤„ç†ä¾é  MapReduceï¼Œæ“ä½œå»¶æ—¶é«˜ HBase æ”¯æŒå•è¡Œè®°å½•çš„ CRUDï¼Œå¹¶ä¸”æ˜¯å®žæ—¶å¤„ç†ï¼Œæ•ˆçŽ‡æ¯” Hive é«˜å¾—å¤š HBaseåœ¨ HDFS ä¸Šçš„å­˜å‚¨è·¯å¾„ ç›¸åŒåˆ—æ—çš„æ•°æ®å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ [è¡¨æ•°æ®çš„å­˜å‚¨ç›®å½•ç»“æž„æž„æˆ] hdfs://cs1:8020/hbase/data/${åå­—ç©ºé—´}/${è¡¨å}/${åŒºåŸŸåç§°}/${åˆ—æ—åç§°}/${æ–‡ä»¶å} [WALç›®å½•ç»“æž„æž„æˆ] hdfs://cs1:8020/hbase/WALs/${åŒºåŸŸæœåŠ¡å™¨åç§°,ç«¯å£å·,æ—¶é—´æˆ³}/ Client ç«¯ ä¸Ž HBase äº¤äº’è¿‡ç¨‹ HBase ç®€å•é›†ç¾¤ç»“æž„ region:æ˜¯ hbase ä¸­å¯¹è¡¨è¿›è¡Œåˆ‡å‰²çš„å•å…ƒï¼Œç”± regionserver è´Ÿè´£ç®¡ç† region åˆ†è£‚æ˜¯é€»è¾‘æ¦‚å¿µ?? :TODO hamster:hbase çš„ä¸»èŠ‚ç‚¹ï¼Œè´Ÿè´£æ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€æ„ŸçŸ¥ï¼Œè´Ÿè½½åˆ†é…ã€è´Ÿè´£ç”¨æˆ·è¡¨çš„å…ƒæ•°æ®(schema)ç®¡ç†(å¯ä»¥é…ç½®å¤šä¸ªç”¨æ¥å®žçŽ° HA),hmaster è´Ÿè½½åŽ‹åŠ›ç›¸å¯¹äºŽ hdfs çš„ namenode ä¼šå°å¾ˆå¤š regionserver:hbase ä¸­çœŸæ­£è´Ÿè´£ç®¡ç† region çš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯è´Ÿè´£ä¸ºå®¢æˆ·ç«¯è¿›è¡Œè¡¨æ•°æ®è¯»å†™ çš„æœåŠ¡å™¨æ¯ä¸€å° regionserver ä¼šç®¡ç†å¾ˆå¤šçš„ regionï¼ŒåŒä¸€ä¸ª regionserver ä¸Šé¢ç®¡ç†çš„æ‰€æœ‰çš„ region ä¸å±žäºŽåŒä¸€å¼ è¡¨ zookeeper:æ•´ä¸ª hbase ä¸­çš„ä¸»ä»ŽèŠ‚ç‚¹åè°ƒï¼Œä¸»èŠ‚ç‚¹ä¹‹é—´çš„é€‰ä¸¾ï¼Œé›†ç¾¤èŠ‚ç‚¹ä¹‹é—´çš„ä¸Šä¸‹çº¿æ„Ÿ çŸ¥â€žâ€žéƒ½æ˜¯é€šè¿‡ zookeeper æ¥å®žçŽ° HDFS:ç”¨æ¥å­˜å‚¨ hbase çš„ç³»ç»Ÿæ–‡ä»¶ï¼Œæˆ–è€…è¡¨çš„ region Hbase é¡¶å±‚ç»“æž„å›¾ 0.hbaseé›†ç¾¤å¯åŠ¨æ—¶ï¼Œmasterè´Ÿè´£åˆ†é…åŒºåŸŸåˆ°æŒ‡å®šåŒºåŸŸæœåŠ¡å™¨ã€‚ 1.è”ç³»zkï¼Œæ‰¾å‡ºmetaè¡¨æ‰€åœ¨rs(regionserver)/hbase/meta-region-server 2.å®šä½row key,æ‰¾åˆ°å¯¹åº”region server 3.ç¼“å­˜ä¿¡æ¯åœ¨æœ¬åœ°ã€‚ 4.è”ç³»RegionServer 5.HRegionServerè´Ÿè´£open HRegionå¯¹è±¡ï¼Œä¸ºæ¯ä¸ªåˆ—æ—åˆ›å»ºStoreå¯¹è±¡ï¼ŒStoreåŒ…å«å¤šä¸ªStoreFileå®žä¾‹ï¼Œä»–ä»¬æ˜¯å¯¹HFileçš„è½»é‡çº§å°è£…ã€‚æ¯ä¸ªStoreè¿˜å¯¹åº”äº†ä¸€ä¸ªMemStoreï¼Œç”¨äºŽå†…å­˜å­˜å‚¨æ•°æ®ã€‚ ç™¾ä¸‡æ•°æ®æ‰¹é‡æ’å…¥ ä»£ç long start = System.currentTimeMillis() ;Configuration conf = HBaseConfiguration.create();Connection conn = ConnectionFactory.createConnection(conf);TableName tname = TableName.valueOf(â€œns1:t1â€);HTable table = (HTable)conn.getTable(tname);//ä¸è¦è‡ªåŠ¨æ¸…ç†ç¼“å†²åŒºtable.setAutoFlush(false);for(int i = 4 ; i &lt; 1000000 ; i ++){Put put = new Put(Bytes.toBytes(&quot;row&quot; + i)) ; //å…³é—­å†™å‰æ—¥å¿— put.setWriteToWAL(false); put.addColumn(Bytes.toBytes(&quot;f1&quot;),Bytes.toBytes(&quot;id&quot;),Bytes.toBytes(i)); put.addColumn(Bytes.toBytes(&quot;f1&quot;),Bytes.toBytes(&quot;name&quot;),Bytes.toBytes(&quot;tom&quot; + i)); put.addColumn(Bytes.toBytes(&quot;f1&quot;),Bytes.toBytes(&quot;age&quot;),Bytes.toBytes(i % 100)); table.put(put); if(i % 2000 == 0){ table.flushCommits(); } }//table.flushCommits();System.out.println(System.currentTimeMillis() - start ); HBase åˆ‡å‰²æ–‡ä»¶ é»˜è®¤10G è¿›è¡Œåˆ‡å‰² hbase.hregion.max.filesize 10737418240 hbase-default.xml HBase åˆå¹¶æ–‡ä»¶ merge_region â€˜1f4609ba4e2a9440aedde5d0e7123722â€™,â€™48277c27196a5c6e30d5ae679e9ec4f0â€™merge â€˜å‰ä¸€ä¸ªåŒºåŸŸçš„ encodedâ€™ , â€˜åŽä¸€ä¸ªåŒºåŸŸçš„ encodedâ€™ HBase æ‰‹åŠ¨ç§»åŠ¨æ–‡ä»¶ hbase(main):034:0&gt; move â€˜8658ac9ea01f80c2cca32693397a1e70â€™,â€™cs3,16020,1529980599903â€™å‰é¢æ˜¯ encoded region name , åŽé¢æ˜¯æœåŠ¡å™¨å é¢„å…ˆåˆ‡å‰² åˆ›å»ºè¡¨æ—¶, é¢„å…ˆå¯¹è¡¨è¿›è¡Œåˆ‡å‰² åˆ‡å‰²çº¿æ˜¯ rowkeycreate â€˜ns1:t2â€™,â€™f1â€™,SPLITS=&gt;[â€˜row300â€™, â€˜row600â€™] åˆ›å»ºé¢„å…ˆåˆ‡å‰²è¡¨ä¹‹åŽ, å­˜çš„å€¼å°±ä¼šåˆ°å¯¹åº”çš„åŒºåŸŸä¸­åŽ» æ³¨æ„: put ä¸€æ¬¡å°±æ˜¯ä¸€æ¡æ•°æ® æŒ‡å®šç‰ˆæœ¬æ•°çš„é—®é¢˜ åˆ›å»ºè¡¨æ—¶æŒ‡å®šåˆ—æ—çš„ç‰ˆæœ¬æ•°,è¯¥åˆ—æ—çš„æ‰€æœ‰åˆ—éƒ½å…·æœ‰ç›¸åŒæ•°é‡ç‰ˆæœ¬ åˆ›å»ºè¡¨æ—¶ï¼ŒæŒ‡å®šåˆ—æ—çš„ç‰ˆæœ¬æ•°ã€‚$hbase&gt;create â€˜ns1:t3â€™,{NAME=&gt;â€™f1â€™,VERSIONS=&gt;3} å¦‚æžœåˆ›å»ºè¡¨çš„æ—¶å€™åˆ›çš„æ˜¯3ä¸ªç‰ˆæœ¬, æŸ¥4ä¸ªç‰ˆæœ¬, æ­¤æ—¶æœ€å¤šä¹Ÿå°±æ˜¾ç¤º3ä¸ª$hbase&gt;get â€˜ns1:t3â€™,â€™row1â€™,{COLUMN=&gt;â€™f1â€™,VERSIONS=&gt;4}COLUMN CELL f1:name timestamp=1530019546709, value=tom3 f1:name timestamp=1530019542978, value=tom2 f1:name timestamp=1530019540164, value=tom1 åŽŸç”Ÿæ‰«æ(expert) åŽŸç”Ÿæ‰«æ, åŒ…å«æ ‡è®°äº†deleteçš„æ•°æ®$hbase&gt;scan â€˜ns1:t3â€™,{COLUMN=&gt;â€™f1â€™,RAW=&gt;true,VERSIONS=&gt;10}hbase(main):177:0&gt; scan â€˜ns1:t3â€™,{COLUMN=&gt;â€™f1â€™,RAW=&gt;true,VERSIONS=&gt;10}ROW COLUMN+CELL row1 column=f1:name, timestamp=1530019546709, value=tom3 row1 column=f1:name, timestamp=1530019542978, value=tom2 row1 column=f1:name, timestamp=1530019540164, type=DeleteColumn row1 column=f1:name, timestamp=1530019540164, value=tom1 åˆ é™¤æ•°æ®, æ ‡è®°ä¸ºåˆ é™¤, å°äºŽè¯¥åˆ é™¤æ—¶é—´çš„æ•°æ®éƒ½ä½œåºŸ, flush åŽ, ç”¨ RAW ä¼¼ä¹Žè¿˜ä¼šä¿ç•™, ç”¨éž RAW çš„æ–¹å¼æŸ¥çœ‹çš„ç”», æ­¤åˆ é™¤æ•°æ®, åŠæ—¶é—´æˆ³æ¯”è¿™ä¸ªå°çš„æ•°æ®, éƒ½ä¸ä¼šæ˜¾ç¤º. $hbase&gt;delete â€˜ns1:t3â€™,â€™row1â€™,â€™f1:nameâ€™,148989875645 è¿™é‡Œæ˜¯å¦è¦åœæŽ‰ hbase æœåŠ¡å†èµ·æ¥çœ‹çœ‹? TTL time to live ,å­˜æ´»æ—¶é—´ å½±å“æ‰€æœ‰çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ²¡æœ‰åˆ é™¤çš„æ•°æ® è¶…è¿‡è¯¥æ—¶é—´ï¼ŒåŽŸç”Ÿæ‰«æä¹Ÿæ‰«ä¸åˆ°æ•°æ® åˆ›å»ºå¸¦ TTLå‚æ•°çš„è¡¨$hbase&gt;create â€˜ns1:txâ€™ , {NAME=&gt;â€™f1â€™,TTL=&gt;10,VERSIONS=&gt;10} KEEP_DELETED_CELLS åˆ é™¤keyä¹‹åŽï¼Œæ•°æ®æ˜¯å¦è¿˜ä¿ç•™, æœªæµ‹è¯•$hbase&gt;create â€˜ns1:txâ€™ , {NAME=&gt;â€™f1â€™,TTL=&gt;10,VERSIONS,KEEP_DELETED_CELLS=&gt;true} TTL çš„ä¼˜å…ˆçº§é«˜äºŽ KEEP_DELETED_CELLS, å¦‚æžœè®¾ç½®äº† TTL, æ—¶é—´ä¸€åˆ°å°±æ²¡äº†, ç”¨ RAW ä¹Ÿæ‰¾ä¸å›žæ¥ ç¼“å­˜ å’Œ æ‰¹å¤„ç† å¼€å¯æœåŠ¡å™¨ç«¯æ‰«æå™¨ç¼“å­˜ è¡¨å±‚é¢(å…¨å±€), è²Œä¼¼æ˜¯é»˜è®¤çš„? å†çœ‹çœ‹ä¹¦ä¸Šè¯´çš„ hbase.client.scanner.caching 2147483647 hbase-default.xml æ“ä½œå±‚é¢ æ³¨æ„: è²Œä¼¼JavaAPI ä¸­é»˜è®¤æ˜¯æ²¡æœ‰è®¾ç½® caching çš„ è®¾ç½®æ–¹å¼scan.setCaching(10); æ“ä½œæ—¶é—´cache row nums : 1000 //632cache row nums : 5000 //423cache row nums : 1 //7359 æ‰«æå™¨ç¼“å­˜æ˜¯ é¢å‘è¡Œçº§åˆ«çš„ æ‰¹é‡æ‰«ææ˜¯ é¢å‘åˆ—çº§åˆ«çš„ æŽ§åˆ¶æ¯æ¬¡next()æœåŠ¡å™¨ç«¯è¿”å›žçš„åˆ—çš„ä¸ªæ•°ã€‚ scan.setBatch(5);æ¯æ¬¡nextè¿”å›ž5åˆ—ã€‚ è¿‡æ»¤å™¨ å›¾ç¤º ä»£ç  https://github.com/airpoet/bigdata/blob/master/HBaseDemo/src/test/java/com/rox/text/TestCRUD.java è®¡æ•°å™¨ shell å®žçŽ° $hbase&gt;incr â€˜ns1:t8â€™,â€™row1â€™,â€™f1:clickâ€™,1åŽé¢å¯ä»¥è·Ÿä»»æ„æ•°å­—, æ­£è´Ÿ,0éƒ½å¯ä»¥ $hbase&gt;get_counter â€˜ns1:t8â€™,â€™row1â€™,â€™f1:clickâ€™èŽ·å–è®¡æ•°å™¨ Java ä»£ç  https://github.com/airpoet/bigdata/blob/master/HBaseDemo/src/test/java/com/rox/text/TestCRUD.java åå¤„ç†å™¨ coprocessor :TODO æœ‰ç©ºå†çœ‹ æ‰¹å¤„ç†çš„ï¼Œç­‰ä»·äºŽå­˜å‚¨è¿‡ç¨‹æˆ–è€…è§¦å‘å™¨ Observer RegionObserver //RegionServeråŒºåŸŸè§‚å¯Ÿè€… MasterObserver //MasterèŠ‚ç‚¹ã€‚ WAlObserver // Endpoint ç»ˆç«¯,ç±»ä¼¼äºŽå­˜å‚¨è¿‡ç¨‹ã€‚ HBase &amp; Mapreduce æ•´åˆ è¿è¡Œå®˜æ–¹æ¡ˆä¾‹ [ap@cs1]~/apps/hbase% export HBASE_HOME=/home/ap/apps/hbase [ap@cs1]~/apps/hbase% export HADOOP_HOME=/home/ap/apps/hadoop [ap@cs1]~/apps/hbase% export HADOOP_CLASSPATH=${HBASE_HOME}/bin/hbase mapredcp ä½¿ç”¨ MapReduceå¯¼å…¥æœ¬åœ°æ•°æ®åˆ°Hbase apps/hadoop/bin/yarn jar apps/hbase/lib/hbase-server-1.2.6.1.jar importtsv \ -Dimporttsv.columns=HBASE_ROW_KEY,info:name,info:color fruit \ hdfs://cs1:8020/input_fruitè¿™æ˜¯ namenode çš„ RPC åœ°å€ HBase &amp; Hive æ•´åˆ1.çŽ¯å¢ƒé…ç½® 12345export HBASE_HOME=/home/ap/apps/hbaseexport HADOOP_HOME=/home/ap/apps/hadoopexport HADOOP_CLASSPATH=`$&#123;HBASE_HOME&#125;/bin/hbase mapredcp` å‰©ä¸‹çš„hbaseçŸ¥è¯†ç‚¹ æœ‰ç©ºå†è¡¥å……]]></content>
      <categories>
        <category>Hadoop</category>
        <category>HBase</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>HBase</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[i-Zookeeper]]></title>
    <url>%2F2018%2F06%2F23%2FHadoop%2F4-Zookeeper%2Fi-Zookeeper%2F</url>
    <content type="text"><![CDATA[1.Zookeeper çš„å®‰è£…&amp;æ¦‚è¿°1.1. Zookeeper ç®€ä»‹Zookeeperæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼çš„ï¼Œä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›åè°ƒæœåŠ¡çš„Apacheé¡¹ç›®ã€‚ zkæä¾›çš„æœåŠ¡ Naming service //æŒ‰åç§°åŒºåˆ†é›†ç¾¤ä¸­çš„èŠ‚ç‚¹. Configuration management //å¯¹åŠ å…¥èŠ‚ç‚¹çš„æœ€æ–°åŒ–å¤„ç†ã€‚ Cluster management //å®žæ—¶æ„ŸçŸ¥é›†ç¾¤ä¸­èŠ‚ç‚¹çš„å¢žå‡. Leader election //leaderé€‰ä¸¾ Locking and synchronization service //ä¿®æ”¹æ—¶é”å®šæ•°æ®ï¼Œå®žçŽ°å®¹ç¾. Highly reliable data registry //èŠ‚ç‚¹å®•æœºæ•°æ®ä¹Ÿæ˜¯å¯ç”¨çš„ã€‚ 1.2. ZK çš„å·¥ä½œæœºåˆ¶ 1.4. ZK æž¶æž„ 1.4.1 åè¯è§£é‡Š 1.Client â€‹ ä»ŽserverèŽ·å–ä¿¡æ¯ï¼Œå‘¨æœŸæ€§å‘é€æ•°æ®ç»™serverï¼Œè¡¨ç¤ºè‡ªå·±è¿˜æ´»ç€ã€‚ â€‹ clientè¿žæŽ¥æ—¶ï¼Œserverå›žä¼ ackä¿¡æ¯ã€‚ â€‹ å¦‚æžœclientæ²¡æœ‰æ”¶åˆ°reponseï¼Œè‡ªåŠ¨é‡å®šå‘åˆ°å¦ä¸€ä¸ªserver. â€‹ 2.Server â€‹ zké›†ç¾¤ä¸­çš„ä¸€å‘˜ï¼Œå‘clientæä¾›æ‰€æœ‰serviceï¼Œå›žä¼ ackä¿¡æ¯ç»™clientï¼Œè¡¨ç¤ºè‡ªå·±è¿˜æ´»ç€ã€‚ â€‹ 3.ensemble â€‹ ä¸€ç»„æœåŠ¡å™¨ã€‚ â€‹ æœ€å°èŠ‚ç‚¹æ•°æ˜¯3. â€‹ 4.Leader â€‹ å¦‚æžœè¿žæŽ¥çš„èŠ‚ç‚¹å¤±è´¥ï¼Œè‡ªå®šæ¢å¤ï¼ŒzkæœåŠ¡å¯åŠ¨æ—¶ï¼Œå®Œæˆleaderé€‰ä¸¾ã€‚ â€‹ 5.Follower â€‹ è¿½å¯»leaderæŒ‡ä»¤çš„èŠ‚ç‚¹ã€‚ 1.4.2 æ•´ä½“è§£é‡Š 1ï¼‰Zookeeperï¼šä¸€ä¸ªé¢†å¯¼è€…ï¼ˆleaderï¼‰ï¼Œå¤šä¸ªè·Ÿéšè€…ï¼ˆfollowerï¼‰ç»„æˆçš„é›†ç¾¤ã€‚ 2ï¼‰Leaderè´Ÿè´£è¿›è¡ŒæŠ•ç¥¨çš„å‘èµ·å’Œå†³è®®ï¼Œæ›´æ–°ç³»ç»ŸçŠ¶æ€ 3ï¼‰Followerç”¨äºŽæŽ¥æ”¶å®¢æˆ·è¯·æ±‚å¹¶å‘å®¢æˆ·ç«¯è¿”å›žç»“æžœï¼Œåœ¨é€‰ä¸¾Leaderè¿‡ç¨‹ä¸­å‚ä¸ŽæŠ•ç¥¨ 4ï¼‰é›†ç¾¤ä¸­åªè¦æœ‰åŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹å­˜æ´»ï¼ŒZookeeperé›†ç¾¤å°±èƒ½æ­£å¸¸æœåŠ¡ã€‚ 5ï¼‰å…¨å±€æ•°æ®ä¸€è‡´ï¼šæ¯ä¸ªserverä¿å­˜ä¸€ä»½ç›¸åŒçš„æ•°æ®å‰¯æœ¬ï¼Œclientæ— è®ºè¿žæŽ¥åˆ°å“ªä¸ªserverï¼Œæ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ã€‚ 6ï¼‰æ›´æ–°è¯·æ±‚é¡ºåºè¿›è¡Œï¼Œæ¥è‡ªåŒä¸€ä¸ªclientçš„æ›´æ–°è¯·æ±‚æŒ‰å…¶å‘é€é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ 7ï¼‰æ•°æ®æ›´æ–°åŽŸå­æ€§ï¼Œä¸€æ¬¡æ•°æ®æ›´æ–°è¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆå¤±è´¥ã€‚ 8ï¼‰å®žæ—¶æ€§ï¼Œåœ¨ä¸€å®šæ—¶é—´èŒƒå›´å†…ï¼Œclientèƒ½è¯»åˆ°æœ€æ–°æ•°æ®ã€‚ 1.5. znode ZooKeeperæ•°æ®æ¨¡åž‹çš„ç»“æž„ä¸ŽUnixæ–‡ä»¶ç³»ç»Ÿå¾ˆç±»ä¼¼ï¼Œæ•´ä½“ä¸Šå¯ä»¥çœ‹ä½œæ˜¯ä¸€æ£µæ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç§°åšä¸€ä¸ªZNodeã€‚æ¯ä¸€ä¸ªZNodeé»˜è®¤èƒ½å¤Ÿå­˜å‚¨1MBçš„æ•°æ®ï¼Œæ¯ä¸ªZNodeéƒ½å¯ä»¥é€šè¿‡å…¶è·¯å¾„å”¯ä¸€æ ‡è¯† zkä¸­çš„èŠ‚ç‚¹ï¼Œç»´æŠ¤äº†statï¼Œç”±Version number, Action control list (ACL), Timestamp,Data length.æž„æˆ. data version //æ•°æ®å†™å…¥çš„è¿‡ç¨‹å˜åŒ– ACL //action control list, 1.6. èŠ‚ç‚¹ç±»åž‹â€‹ 1.æŒä¹…èŠ‚ç‚¹ â€‹ clientç»“æŸï¼Œè¿˜å­˜åœ¨ã€‚ â€‹ 2.ä¸´æ—¶èŠ‚ç‚¹ â€‹ åœ¨clientæ´»åŠ¨æ—¶æœ‰æ•ˆï¼Œæ–­å¼€è‡ªåŠ¨åˆ é™¤ã€‚ä¸´æ—¶èŠ‚ç‚¹ä¸èƒ½æœ‰å­èŠ‚ç‚¹ã€‚ â€‹ leaderæŽ¨é€‰æ—¶ä½¿ç”¨ã€‚ â€‹ 3.åºåˆ—èŠ‚ç‚¹ â€‹ åœ¨èŠ‚ç‚¹åä¹‹åŽé™„åŠ 10ä¸ªæ•°å­—ï¼Œä¸»è¦ç”¨äºŽåŒæ­¥å’Œé”. 1.7. Sessionâ€‹ Sessionä¸­çš„è¯·æ±‚ä»¥FIFOæ‰§è¡Œï¼Œä¸€æ—¦clientè¿žæŽ¥åˆ°serverï¼Œsessionå°±å»ºç«‹äº†ã€‚sessionidåˆ†é…client. â€‹ clientä»¥å›ºå®šé—´éš”å‘serverå‘é€å¿ƒè·³ï¼Œè¡¨ç¤ºsessionæ˜¯validçš„ï¼Œzké›†ç¾¤å¦‚æžœåœ¨è¶…æ—¶æ—¶å€™ï¼Œæ²¡æœ‰æ”¶åˆ°å¿ƒè·³ï¼Œ â€‹ åˆ¤å®šä¸ºclientæŒ‚äº†ï¼Œä¸Žæ­¤åŒæ—¶ï¼Œä¸´æ—¶èŠ‚ç‚¹è¢«åˆ é™¤ã€‚ 1.8. Watchesâ€‹ è§‚å¯Ÿã€‚ â€‹ clientèƒ½å¤Ÿé€šè¿‡watchæœºåˆ¶åœ¨æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ”¶åˆ°é€šçŸ¥ã€‚ â€‹ clientå¯ä»¥åœ¨read èŠ‚ç‚¹æ—¶è®¾ç½®è§‚å¯Ÿè€…ã€‚watchæœºåˆ¶ä¼šå‘é€é€šçŸ¥ç»™æ³¨å†Œçš„å®¢æˆ·ç«¯ã€‚ â€‹ è§‚å¯Ÿæ¨¡å¼åªè§¦å‘ä¸€æ¬¡ã€‚ â€‹ sessionè¿‡æœŸï¼Œwatchæœºåˆ¶åˆ é™¤äº†ã€‚ 1.9. zkå·¥ä½œæµç¨‹â€‹ zké›†ç¾¤å¯åŠ¨åŽï¼Œclientè¿žæŽ¥åˆ°å…¶ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹å¯ä»¥æ˜¯leaderï¼Œä¹Ÿå¯ä»¥æ˜¯followerã€‚ â€‹ è¿žé€šåŽï¼Œnodeåˆ†é…ä¸€ä¸ªidç»™clientï¼Œå‘é€ackä¿¡æ¯ç»™clientã€‚ â€‹ å¦‚æžœå®¢æˆ·ç«¯æ²¡æœ‰æ”¶åˆ°ackï¼Œè¿žæŽ¥åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚ â€‹ clientå‘¨æœŸæ€§å‘é€å¿ƒè·³ä¿¡æ¯ç»™èŠ‚ç‚¹ä¿è¯è¿žæŽ¥ä¸ä¼šä¸¢å¤±ã€‚ â€‹ å¦‚æžœclientè¯»å–æ•°æ®ï¼Œå‘é€è¯·æ±‚ç»™nodeï¼Œnodeè¯»å–è‡ªå·±æ•°æ®åº“ï¼Œè¿”å›žèŠ‚ç‚¹æ•°æ®ç»™client. â€‹ å¦‚æžœclientæƒ³è¦åœ¨ zk ä¸­å­˜å‚¨æ•°æ®ï¼Œå°†è·¯å¾„å’Œæ•°æ®å‘é€ç»™serverï¼Œserverè½¬å‘ç»™leaderã€‚ â€‹ leaderå†è¡¥å‘è¯·æ±‚ç»™æ‰€æœ‰followerã€‚åªæœ‰å¤§å¤šæ•°(è¶…è¿‡åŠæ•°)èŠ‚ç‚¹æˆåŠŸå“åº”ï¼Œåˆ™ â€‹ å†™æ“ä½œæˆåŠŸã€‚ 1.10 zk åº”ç”¨åœºæ™¯1.10.1 ç»Ÿä¸€å‘½åæœåŠ¡ 1.10.2 ç»Ÿä¸€é…ç®¡ç† 1.10.3 ç»Ÿä¸€é›†ç¾¤ç®¡ç† 1.10.4 æœåŠ¡å™¨åŠ¨æ€ä¸Šä¸‹çº¿ 1.10.5 è½¯è´Ÿè½½å‡è¡¡ 2.Zookeeper å®Œå…¨åˆ†å¸ƒå¼çš„å®‰è£…&amp;åŸºæœ¬ä½¿ç”¨2.1 å®‰è£…2.1.1 é«˜å¯ç”¨å®‰è£…PS: é«˜å¯ç”¨å®‰è£…è§è¿™é‡Œ 2.2.2 å®Œå…¨åˆ†å¸ƒå¼å®‰è£…123456789101112131415161718192021222324252627282930313233341.æŒ‘é€‰3å°ä¸»æœºcs1 ~ cs32.æ¯å°æœºå™¨éƒ½å®‰è£…zk &amp; é…ç½®çŽ¯å¢ƒå˜é‡3.é…ç½®zké…ç½®æ–‡ä»¶cs1 ~ cs3[/home/ap/apps/zk/conf/zoo.cfg]----------tickTime=2000initLimit=10syncLimit=5dataDir=/home/ap/zookeeperclientPort=2181server.1=cs1:2888:3888server.2=cs2:2888:3888server.3=cs3:2888:3888---------4.åœ¨æ¯å°ä¸»æœºçš„/home/ap/zookeeperä¸­æ·»åŠ myid,å†…å®¹åˆ†åˆ«æ˜¯1,2,3[cs1]$&gt;echo 1 &gt; /home/ap/zookeeper/myid[cs2]$&gt;echo 2 &gt; /home/ap/zookeeper/myid[cs3]$&gt;echo 3 &gt; /home/ap/zookeeper/myid5.åœ¨cs1~cs3ä¸Š,å¯åŠ¨æœåŠ¡å™¨é›†ç¾¤ $&gt;zkServer.sh start6.æŸ¥çœ‹æ¯å°æœåŠ¡å™¨çš„çŠ¶æ€$&gt;zkServer.sh status* æ³¨æ„: å¦‚æžœæœ‰3å°æœºå™¨, åªå¯åŠ¨ä¸€å°çš„è¯, ä¼šæ˜¾ç¤ºå¦‚ä¸‹, å› ä¸ºæ ¹æ®é…ç½®, æœ‰3å°æœºå™¨, æ­¤æ—¶åªæœ‰ä¸€å°å¯åŠ¨, æ²¡æœ‰è¿‡åŠæ•°, æ•´ä¸ªé›†ç¾¤æ˜¯æŒ‚æŽ‰çš„* åªæœ‰å¯åŠ¨çš„æœºå™¨æ•°é‡è¶…è¿‡é…ç½®çš„åŠæ•°, zk é›†ç¾¤æ‰æœ‰æ•ˆ. 2.2.3 zoo.cfg æ–‡ä»¶ä¸­é…ç½®å‚æ•°çš„å«ä¹‰1234567891011121314151617181920212223242526271ï¼‰tickTime=2000ï¼šé€šä¿¡å¿ƒè·³æ•° tickTimeï¼šé€šä¿¡å¿ƒè·³æ•°ï¼ŒZookeeperæœåŠ¡å™¨å¿ƒè·³æ—¶é—´ï¼Œå•ä½æ¯«ç§’ Zookeeperä½¿ç”¨çš„åŸºæœ¬æ—¶é—´ï¼ŒæœåŠ¡å™¨ä¹‹é—´æˆ–å®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¹‹é—´ç»´æŒå¿ƒè·³çš„æ—¶é—´é—´éš”ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªtickTimeæ—¶é—´å°±ä¼šå‘é€ä¸€ä¸ªå¿ƒè·³ï¼Œæ—¶é—´å•ä½ä¸ºæ¯«ç§’ã€‚ å®ƒç”¨äºŽå¿ƒè·³æœºåˆ¶ï¼Œå¹¶ä¸”è®¾ç½®æœ€å°çš„sessionè¶…æ—¶æ—¶é—´ä¸ºä¸¤å€å¿ƒè·³æ—¶é—´ã€‚(sessionçš„æœ€å°è¶…æ—¶æ—¶é—´æ˜¯2*tickTime)2ï¼‰initLimit=10ï¼šLFåˆå§‹é€šä¿¡æ—¶é™ initLimitï¼šLFåˆå§‹é€šä¿¡æ—¶é™ é›†ç¾¤ä¸­çš„followerè·Ÿéšè€…æœåŠ¡å™¨(F)ä¸Žleaderé¢†å¯¼è€…æœåŠ¡å™¨(L)ä¹‹é—´åˆå§‹è¿žæŽ¥æ—¶èƒ½å®¹å¿çš„æœ€å¤šå¿ƒè·³æ•°ï¼ˆtickTimeçš„æ•°é‡ï¼‰ï¼Œç”¨å®ƒæ¥é™å®šé›†ç¾¤ä¸­çš„ZookeeperæœåŠ¡å™¨è¿žæŽ¥åˆ°Leaderçš„æ—¶é™ã€‚ æŠ•ç¥¨é€‰ä¸¾æ–°leaderçš„åˆå§‹åŒ–æ—¶é—´ Followeråœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œä¼šä»ŽLeaderåŒæ­¥æ‰€æœ‰æœ€æ–°æ•°æ®ï¼Œç„¶åŽç¡®å®šè‡ªå·±èƒ½å¤Ÿå¯¹å¤–æœåŠ¡çš„èµ·å§‹çŠ¶æ€ã€‚ Leaderå…è®¸Fåœ¨initLimitæ—¶é—´å†…å®Œæˆè¿™ä¸ªå·¥ä½œã€‚3ï¼‰syncLimit=5ï¼šLFåŒæ­¥é€šä¿¡æ—¶é™ syncLimitï¼šLFåŒæ­¥é€šä¿¡æ—¶é™ é›†ç¾¤ä¸­Leaderä¸ŽFollowerä¹‹é—´çš„æœ€å¤§å“åº”æ—¶é—´å•ä½ï¼Œå‡å¦‚å“åº”è¶…è¿‡syncLimit * tickTimeï¼Œ Leaderè®¤ä¸ºFollweræ­»æŽ‰ï¼Œä»ŽæœåŠ¡å™¨åˆ—è¡¨ä¸­åˆ é™¤Follwerã€‚ åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼ŒLeaderè´Ÿè´£ä¸ŽZKé›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨è¿›è¡Œé€šä¿¡ï¼Œä¾‹å¦‚é€šè¿‡ä¸€äº›å¿ƒè·³æ£€æµ‹æœºåˆ¶ï¼Œæ¥æ£€æµ‹æœºå™¨çš„å­˜æ´»çŠ¶æ€ã€‚ å¦‚æžœLå‘å‡ºå¿ƒè·³åŒ…åœ¨syncLimitä¹‹åŽï¼Œè¿˜æ²¡æœ‰ä»ŽFé‚£æ”¶åˆ°å“åº”ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºè¿™ä¸ªFå·²ç»ä¸åœ¨çº¿äº†ã€‚4ï¼‰dataDirï¼šæ•°æ®æ–‡ä»¶ç›®å½•+æ•°æ®æŒä¹…åŒ–è·¯å¾„ dataDirï¼šæ•°æ®æ–‡ä»¶ç›®å½•+æ•°æ®æŒä¹…åŒ–è·¯å¾„ ä¿å­˜å†…å­˜æ•°æ®åº“å¿«ç…§ä¿¡æ¯çš„ä½ç½®ï¼Œå¦‚æžœæ²¡æœ‰å…¶ä»–è¯´æ˜Žï¼Œæ›´æ–°çš„äº‹åŠ¡æ—¥å¿—ä¹Ÿä¿å­˜åˆ°æ•°æ®åº“ã€‚5ï¼‰clientPort=2181ï¼šå®¢æˆ·ç«¯è¿žæŽ¥ç«¯å£ ç›‘å¬å®¢æˆ·ç«¯è¿žæŽ¥çš„ç«¯å£6) Server.A=B:C:Dã€‚ Aæ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºè¿™ä¸ªæ˜¯ç¬¬å‡ å·æœåŠ¡å™¨ï¼› Bæ˜¯è¿™ä¸ªæœåŠ¡å™¨çš„ipåœ°å€ï¼› Cæ˜¯è¿™ä¸ªæœåŠ¡å™¨ä¸Žé›†ç¾¤ä¸­çš„LeaderæœåŠ¡å™¨äº¤æ¢ä¿¡æ¯çš„ç«¯å£ï¼› Dæ˜¯ä¸‡ä¸€é›†ç¾¤ä¸­çš„LeaderæœåŠ¡å™¨æŒ‚äº†ï¼Œéœ€è¦ä¸€ä¸ªç«¯å£æ¥é‡æ–°è¿›è¡Œé€‰ä¸¾ï¼Œé€‰å‡ºä¸€ä¸ªæ–°çš„Leaderï¼Œè€Œè¿™ä¸ªç«¯å£å°±æ˜¯ç”¨æ¥æ‰§è¡Œé€‰ä¸¾æ—¶æœåŠ¡å™¨ç›¸äº’é€šä¿¡çš„ç«¯å£ã€‚ # é›†ç¾¤æ¨¡å¼ä¸‹é…ç½®ä¸€ä¸ªæ–‡ä»¶myidï¼Œè¿™ä¸ªæ–‡ä»¶åœ¨dataDirç›®å½•ä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œé¢æœ‰ä¸€ä¸ªæ•°æ®å°±æ˜¯Açš„å€¼ï¼ŒZookeeperå¯åŠ¨æ—¶è¯»å–æ­¤æ–‡ä»¶ï¼Œæ‹¿åˆ°é‡Œé¢çš„æ•°æ®ä¸Žzoo.cfgé‡Œé¢çš„é…ç½®ä¿¡æ¯æ¯”è¾ƒä»Žè€Œåˆ¤æ–­åˆ°åº•æ˜¯å“ªä¸ªserverã€‚ 2.2 ZKå®¢æˆ·ç«¯çš„è¿žæŽ¥12345678910111213141516171819202122232425262728293031323334353637383940414243$&gt;zkCli.sh -server cs1:2181 //è¿›å…¥zkå‘½ä»¤è¡Œ$zk]help //æŸ¥çœ‹å¸®åŠ©$zk]quit //é€€å‡º$zk]create /a tom //åˆ›å»ºèŠ‚ç‚¹$zk]get /a //æŸ¥çœ‹æ•°æ®$zk]ls / //åˆ—å‡ºèŠ‚ç‚¹$zk]ls2 / //æŸ¥çœ‹å½“å‰èŠ‚ç‚¹æ•°æ®å¹¶èƒ½çœ‹åˆ°æ›´æ–°æ¬¡æ•°ç­‰æ•°æ®$zk]set /a tom //è®¾ç½®æ•°æ®$zk]delete /a //åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹$zk]rmr /a //é€’å½’åˆ é™¤æ‰€æœ‰èŠ‚ç‚¹ã€‚$zk]stat / //æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€æ³¨æ„: * åˆ›å»ºèŠ‚ç‚¹ä¸èƒ½é€’å½’åˆ›å»º, ç›®å‰åªèƒ½ä¸€å±‚ä¸€å±‚åˆ›å»º* æ¯æ¬¡åˆ›å»ºéƒ½çš„å†™æ•°æ®, åªåˆ›å»ºç›®å½•çš„è¯ä¼šåˆ›å»ºä¸æˆåŠŸ* å¦‚æžœ close åŽ, å¹¶æ²¡æœ‰é€€å‡ºå®¢æˆ·ç«¯, åªæ˜¯è®¿é—®ä¸åˆ°æ•°æ®, æ­¤æ—¶å¦‚æžœæƒ³è¦è¿žæŽ¥, å¯ä»¥ç”¨connect host:port================================================================================ZK çš„å¸®åŠ©æ–‡æ¡£----------------help:ZooKeeper -server host:port cmd args stat path [watch] set path data [version] ls path [watch] delquota [-n|-b] path ls2 path [watch] setAcl path acl setquota -n|-b val path history redo cmdno printwatches on|off delete path [version] sync path listquota path rmr path get path [watch] create [-s] [-e] path data acl addauth scheme auth quit getAcl path close connect host:port 2.3 ç›‘å¬æµ‹è¯•æ³¨æ„ç‚¹: æ³¨å†Œçš„ç›‘å¬åªèƒ½ä½¿ç”¨ä¸€æ¬¡, ç›‘å¬å®Œæ¯•åŽéœ€è¦é‡æ–°æ³¨å†Œ. 123456789101112131415161718192021222324=======èŠ‚ç‚¹å€¼çš„å˜åŒ–çš„ç›‘å¬==========ï¼ˆ1ï¼‰åœ¨cs1ä¸»æœºä¸Šæ³¨å†Œç›‘å¬/app1èŠ‚ç‚¹æ•°æ®å˜åŒ–[zk: localhost:2181(CONNECTED) 26] get /app1 watch ï¼ˆ2ï¼‰åœ¨cs2ä¸»æœºä¸Šä¿®æ”¹/app1èŠ‚ç‚¹çš„æ•°æ®[zk: localhost:2181(CONNECTED) 5] set /app1 777ï¼ˆ3ï¼‰è§‚å¯Ÿcs2ä¸»æœºæ”¶åˆ°æ•°æ®å˜åŒ–çš„ç›‘å¬WATCHER::WatchedEvent state:SyncConnected type:NodeDataChanged path:/app1=======èŠ‚ç‚¹çš„å­èŠ‚ç‚¹å˜åŒ–çš„ç›‘å¬==========ï¼ˆ1ï¼‰åœ¨cs1ä¸»æœºä¸Šæ³¨å†Œç›‘å¬/app1èŠ‚ç‚¹çš„å­èŠ‚ç‚¹å˜åŒ–[zk: localhost:2181(CONNECTED) 1] ls /app1 watch[aa0000000001, server101]ï¼ˆ2ï¼‰åœ¨cs2ä¸»æœº/app1èŠ‚ç‚¹ä¸Šåˆ›å»ºå­èŠ‚ç‚¹[zk: localhost:2181(CONNECTED) 6] create /app1/bb 666Created /app1/bbï¼ˆ3ï¼‰è§‚å¯Ÿcs1ä¸»æœºæ”¶åˆ°å­èŠ‚ç‚¹å˜åŒ–çš„ç›‘å¬WATCHER::WatchedEvent state:SyncConnected type:NodeChildrenChanged path:/app1 3. ZK å†…éƒ¨æœºåˆ¶3.1 é€‰ä¸¾æœºåˆ¶3.1.1. zookeeperçš„é€‰ä¸¾æœºåˆ¶ï¼ˆå…¨æ–°é›†ç¾¤paxosï¼‰ä»¥ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜Žæ•´ä¸ªé€‰ä¸¾çš„è¿‡ç¨‹. å‡è®¾æœ‰äº”å°æœåŠ¡å™¨ç»„æˆçš„zookeeperé›†ç¾¤,å®ƒä»¬çš„idä»Ž1-5,åŒæ—¶å®ƒä»¬éƒ½æ˜¯æœ€æ–°å¯åŠ¨çš„,ä¹Ÿå°±æ˜¯æ²¡æœ‰åŽ†å²æ•°æ®,åœ¨å­˜æ”¾æ•°æ®é‡è¿™ä¸€ç‚¹ä¸Š,éƒ½æ˜¯ä¸€æ ·çš„.å‡è®¾è¿™äº›æœåŠ¡å™¨ä¾åºå¯åŠ¨,æ¥çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ. 1) æœåŠ¡å™¨1å¯åŠ¨,æ­¤æ—¶åªæœ‰å®ƒä¸€å°æœåŠ¡å™¨å¯åŠ¨äº†,å®ƒå‘å‡ºåŽ»çš„æŠ¥æ²¡æœ‰ä»»ä½•å“åº”,æ‰€ä»¥å®ƒçš„é€‰ä¸¾çŠ¶æ€ä¸€ç›´æ˜¯LOOKINGçŠ¶æ€ 2) æœåŠ¡å™¨2å¯åŠ¨,å®ƒä¸Žæœ€å¼€å§‹å¯åŠ¨çš„æœåŠ¡å™¨1è¿›è¡Œé€šä¿¡,äº’ç›¸äº¤æ¢è‡ªå·±çš„é€‰ä¸¾ç»“æžœ,ç”±äºŽä¸¤è€…éƒ½æ²¡æœ‰åŽ†å²æ•°æ®,æ‰€ä»¥idå€¼è¾ƒå¤§çš„æœåŠ¡å™¨2èƒœå‡º,ä½†æ˜¯ç”±äºŽæ²¡æœ‰è¾¾åˆ°è¶…è¿‡åŠæ•°ä»¥ä¸Šçš„æœåŠ¡å™¨éƒ½åŒæ„é€‰ä¸¾å®ƒ(è¿™ä¸ªä¾‹å­ä¸­çš„åŠæ•°ä»¥ä¸Šæ˜¯3),æ‰€ä»¥æœåŠ¡å™¨1,2è¿˜æ˜¯ç»§ç»­ä¿æŒLOOKINGçŠ¶æ€. 3) æœåŠ¡å™¨3å¯åŠ¨,æ ¹æ®å‰é¢çš„ç†è®ºåˆ†æž,æœåŠ¡å™¨3æˆä¸ºæœåŠ¡å™¨1,2,3ä¸­çš„è€å¤§,è€Œä¸Žä¸Šé¢ä¸åŒçš„æ˜¯,æ­¤æ—¶æœ‰ä¸‰å°æœåŠ¡å™¨é€‰ä¸¾äº†å®ƒ,æ‰€ä»¥å®ƒæˆä¸ºäº†è¿™æ¬¡é€‰ä¸¾çš„leader. 4) æœåŠ¡å™¨4å¯åŠ¨,æ ¹æ®å‰é¢çš„åˆ†æž,ç†è®ºä¸ŠæœåŠ¡å™¨4åº”è¯¥æ˜¯æœåŠ¡å™¨1,2,3,4ä¸­æœ€å¤§çš„,ä½†æ˜¯ç”±äºŽå‰é¢å·²ç»æœ‰åŠæ•°ä»¥ä¸Šçš„æœåŠ¡å™¨é€‰ä¸¾äº†æœåŠ¡å™¨3,æ‰€ä»¥å®ƒåªèƒ½æŽ¥æ”¶å½“å°å¼Ÿçš„å‘½äº†. 5) æœåŠ¡å™¨5å¯åŠ¨,åŒ4ä¸€æ ·,å½“å°å¼Ÿ. 3.1.2. éžå…¨æ–°é›†ç¾¤çš„é€‰ä¸¾æœºåˆ¶(æ•°æ®æ¢å¤)é‚£ä¹ˆï¼Œåˆå§‹åŒ–çš„æ—¶å€™ï¼Œæ˜¯æŒ‰ç…§ä¸Šè¿°çš„è¯´æ˜Žè¿›è¡Œé€‰ä¸¾çš„ï¼Œä½†æ˜¯å½“zookeeperè¿è¡Œäº†ä¸€æ®µæ—¶é—´ä¹‹åŽï¼Œæœ‰æœºå™¨downæŽ‰ï¼Œé‡æ–°é€‰ä¸¾æ—¶ï¼Œé€‰ä¸¾è¿‡ç¨‹å°±ç›¸å¯¹å¤æ‚äº†ã€‚ éœ€è¦åŠ å…¥æ•°æ®idã€leader idå’Œé€»è¾‘æ—¶é’Ÿã€‚ æ•°æ®idï¼šæ•°æ®æ–°çš„idå°±å¤§ï¼Œæ•°æ®æ¯æ¬¡æ›´æ–°éƒ½ä¼šæ›´æ–°idã€‚ Leader idï¼šå°±æ˜¯æˆ‘ä»¬é…ç½®çš„myidä¸­çš„å€¼ï¼Œæ¯ä¸ªæœºå™¨ä¸€ä¸ªã€‚ é€»è¾‘æ—¶é’Ÿï¼šè¿™ä¸ªå€¼ä»Ž0å¼€å§‹é€’å¢ž,æ¯æ¬¡é€‰ä¸¾å¯¹åº”ä¸€ä¸ªå€¼,ä¹Ÿå°±æ˜¯è¯´: å¦‚æžœåœ¨åŒä¸€æ¬¡é€‰ä¸¾ä¸­,é‚£ä¹ˆè¿™ä¸ªå€¼åº”è¯¥æ˜¯ä¸€è‡´çš„ ; é€»è¾‘æ—¶é’Ÿå€¼è¶Šå¤§,è¯´æ˜Žè¿™ä¸€æ¬¡é€‰ä¸¾leaderçš„è¿›ç¨‹æ›´æ–°. é€‰ä¸¾çš„æ ‡å‡†å°±å˜æˆï¼š â€‹ 1ã€é€»è¾‘æ—¶é’Ÿå°çš„é€‰ä¸¾ç»“æžœè¢«å¿½ç•¥ï¼Œé‡æ–°æŠ•ç¥¨ â€‹ 2ã€ç»Ÿä¸€é€»è¾‘æ—¶é’ŸåŽï¼Œæ•°æ®idå¤§çš„èƒœå‡º â€‹ 3ã€æ•°æ®idç›¸åŒçš„æƒ…å†µä¸‹ï¼Œleader idå¤§çš„èƒœå‡º æ ¹æ®è¿™ä¸ªè§„åˆ™é€‰å‡ºleaderã€‚ 3.2 stat çš„ç»“æž„ 1ï¼‰czxid- å¼•èµ·è¿™ä¸ªznodeåˆ›å»ºçš„zxidï¼Œåˆ›å»ºèŠ‚ç‚¹çš„äº‹åŠ¡çš„zxid æ¯æ¬¡ä¿®æ”¹ZooKeeperçŠ¶æ€éƒ½ä¼šæ”¶åˆ°ä¸€ä¸ªzxidå½¢å¼çš„æ—¶é—´æˆ³ï¼Œä¹Ÿå°±æ˜¯ZooKeeperäº‹åŠ¡IDã€‚äº‹åŠ¡IDæ˜¯ZooKeeperä¸­æ‰€æœ‰ä¿®æ”¹æ€»çš„æ¬¡åºã€‚æ¯ä¸ªä¿®æ”¹éƒ½æœ‰å”¯ä¸€çš„zxidï¼Œå¦‚æžœzxid1å°äºŽzxid2ï¼Œé‚£ä¹ˆzxid1åœ¨zxid2ä¹‹å‰å‘ç”Ÿã€‚ 2ï¼‰ctime - znodeè¢«åˆ›å»ºçš„æ¯«ç§’æ•°(ä»Ž1970å¹´å¼€å§‹) 3ï¼‰mzxid - znodeæœ€åŽæ›´æ–°çš„zxid 4ï¼‰mtime - znodeæœ€åŽä¿®æ”¹çš„æ¯«ç§’æ•°(ä»Ž1970å¹´å¼€å§‹) 5ï¼‰pZxid-znodeæœ€åŽæ›´æ–°çš„å­èŠ‚ç‚¹zxid 6ï¼‰cversion - znodeå­èŠ‚ç‚¹å˜åŒ–å·ï¼Œznodeå­èŠ‚ç‚¹ä¿®æ”¹æ¬¡æ•° 7ï¼‰dataversion - znodeæ•°æ®å˜åŒ–å· 8ï¼‰aclVersion - znodeè®¿é—®æŽ§åˆ¶åˆ—è¡¨çš„å˜åŒ–å· 9ï¼‰ephemeralOwner- å¦‚æžœæ˜¯ä¸´æ—¶èŠ‚ç‚¹ï¼Œè¿™ä¸ªæ˜¯znodeæ‹¥æœ‰è€…çš„session idã€‚å¦‚æžœä¸æ˜¯ä¸´æ—¶èŠ‚ç‚¹åˆ™æ˜¯0ã€‚ 10ï¼‰dataLength- znodeçš„æ•°æ®é•¿åº¦ 11ï¼‰numChildren - znodeå­èŠ‚ç‚¹æ•°é‡ 4. é€šè¿‡ JavaAPI è®¿é—® ZK4.1 æ·»åŠ Maven ä¾èµ–123456789101112131415161718192021222324259.1[pom.xml]&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.it18zhang&lt;/groupId&gt; &lt;artifactId&gt;ZooKeeperDemo&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;version&gt;3.4.9&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.11&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 4.2 Java ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134* å¯¹åº”å…³ç³»:* Linux Java----------------------* ls getChildren* get getData* set setDAta* create createË˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜Ë˜package com.rox.zktest;import org.apache.zookeeper.*;import org.apache.zookeeper.data.ACL;import org.apache.zookeeper.data.Stat;import org.junit.Test;import java.io.IOException;import java.util.List;/** * å¯¹åº”å…³ç³»: * Linux Java * ls getChildren * get getData * set setDAta * create create */public class TestZK &#123; @Test public void ls() throws IOException, KeeperException, InterruptedException &#123; /** * æ”¾ä¸‰ä¸ªå°±ä¸è¡Œ, åªèƒ½æ”¾2ä¸ªç›®å‰æ¥çœ‹ */ ZooKeeper zk = new ZooKeeper("cs1:2181,cs2:2181,cs3:2181", 5000, null); List&lt;String&gt; list = zk.getChildren("/", null); for (String s : list) &#123; System.out.println(s); &#125; &#125; @Test public void lsAll() &#123; try &#123; ls("/"); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; /** * åˆ—å‡ºæŒ‡å®š path ä¸‹çš„children * * @param path */ public void ls(String path) throws Exception &#123; System.out.println(path); ZooKeeper zk = new ZooKeeper("cs1:2181,cs2:2181,cs3:2181", 5000, null); List&lt;String&gt; list = zk.getChildren(path, null); if (list == null || list.isEmpty()) &#123; return; &#125; for (String s : list) &#123; // å…ˆè¾“å‡º children if (path.equals("/" )) &#123; ls(path + s); &#125; else &#123; ls(path + "/" + s); &#125; &#125; &#125; /** * è®¾ç½®æ•°æ® */ @Test public void setData() throws Exception &#123; ZooKeeper zk = new ZooKeeper("cs1:2181", 5000, null); zk.setData("/a","tomaslee".getBytes(),0); &#125; /** * åˆ›å»ºä¸´æ—¶èŠ‚ç‚¹ */ @Test public void createEPHEMERAL() throws Exception &#123; ZooKeeper zk = new ZooKeeper("cs1:2181", 5000, null); zk.create("/c/c1", "tom".getBytes(), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL); System.out.println("hello"); &#125; /** * åˆ›å»ºè§‚å¯Ÿè€… */ @Test public void testWatch() throws Exception &#123; final ZooKeeper zk = new ZooKeeper("cs1:2181,cs2:2181,cs3:2181", 5000, null); Stat st = new Stat(); Watcher w = null; w = new Watcher() &#123; public void process(WatchedEvent event) &#123; try &#123; System.out.println("æ•°æ®æ”¹äº†..."); zk.getData("/a",this,null); &#125;catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; &#125;; byte[] data = zk.getData("/a",w,st); System.out.println(new String(data)); while (true) &#123; Thread.sleep(1000); &#125; &#125;&#125;]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Zookeeper</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Zookeeper</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoop-HAé«˜å¯ç”¨é›†ç¾¤QJMæ­å»º]]></title>
    <url>%2F2018%2F06%2F22%2FHadoop%2F0-Hadoop%2FHadoop-HA%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%2F</url>
    <content type="text"><![CDATA[1.æ­¤æ•™ç¨‹é»˜è®¤å·²ç»æ­å»ºå¥½å®Œå…¨åˆ†å¸ƒå¼2. Zookeeper é›†ç¾¤æ­å»º1234567891011121314151617181920212223242526272829é…ç½®å®Œå…¨åˆ†å¸ƒå¼zké›†ç¾¤--------------------- 1.æŒ‘é€‰3å°ä¸»æœº cs1 ~ cs3 2.æ¯å°æœºå™¨éƒ½å®‰è£…zk tar çŽ¯å¢ƒå˜é‡ 3.é…ç½®zké…ç½®æ–‡ä»¶ cs1 ~ cs3 [/home/ap/apps/zk/conf/zoo.cfg] ... dataDir=/home/ap/zookeeper 4.åœ¨æ¯å°ä¸»æœºçš„/home/centos/zookeeperä¸­æ·»åŠ myid,å†…å®¹åˆ†åˆ«æ˜¯1,2,3 [cs1] $&gt;echo 1 &gt; /home/ap/zookeeper/myid [cs2] $&gt;echo 2 &gt; /home/ap/zookeeper/myid [cs3] $&gt;echo 3 &gt; /home/ap/zookeeper/myid 5.å¯åŠ¨æœåŠ¡å™¨é›†ç¾¤ $&gt;zkServer.sh start 6.æŸ¥çœ‹æ¯å°æœåŠ¡å™¨çš„çŠ¶æ€ $&gt;zkServer.sh status* æ³¨æ„: å¦‚æžœæœ‰3å°æœºå™¨, åªå¯åŠ¨ä¸€å°çš„è¯, ä¼šæ˜¾ç¤ºå¦‚ä¸‹, å› ä¸ºæ ¹æ®é…ç½®, æœ‰3å°æœºå™¨, æ­¤æ—¶åªæœ‰ä¸€å°å¯åŠ¨, æ²¡æœ‰è¿‡åŠæ•°, æ•´ä¸ªé›†ç¾¤æ˜¯æŒ‚æŽ‰çš„* åªæœ‰å¯åŠ¨çš„æœºå™¨æ•°é‡è¶…è¿‡é…ç½®çš„åŠæ•°, zk é›†ç¾¤æ‰æœ‰æ•ˆ. 3.HA é›†ç¾¤æ­å»ºé¦–å…ˆå£°æ˜Žç¬”è€…ç”¨çš„6å°ä¸»æœº, ä¸»æœºå cs1-cs6, ç”¨æˆ·åä¸ºap, å¯ä»¥å¯¹ç…§æ”¹ä¸ºè‡ªå·±çš„ä¸»æœºå&amp;ç”¨æˆ·å å¦å¤–, æ­å»º HA ä¸ä¼šå½±å“åŽŸæ¥çš„å®Œå…¨åˆ†å¸ƒå¼, å…·ä½“æ“ä½œä¼šåœ¨ä¸‹é¢å‘ŠçŸ¥.hadoop å®‰è£…ç›®å½•å±‚çº§ç»“æž„: /home/ap/apps/hadoop/etc/hadoop/hdfs-site.xml data ç›®å½•å±‚çº§ç»“æž„: cs1: /home/ap/hadoopdata/namenode/current/edits_00.... cs2: /home/ap/hadoopdata/datanode/current/BP-15... å¯ä»¥å¯¹ç…§å‚è€ƒ é›†ç¾¤ç»“æž„å¦‚ä¸‹ å¼€å§‹æ­å»ºé¦–å…ˆä¿è¯ å„èŠ‚ç‚¹ç›´æŽ¥çš„ ssh å…å¯†ç™»å½•æ²¡é—®é¢˜ å¦‚æžœéžç”Ÿäº§çŽ¯å¢ƒ, å¯ä»¥åŒæ—¶æŠŠ .sshåˆ æŽ‰åŽ, å…¨éƒ¨é‡æ–°ç”Ÿæˆ ssh-keygen, åŒæ—¶ç›¸äº’å‘é€, è¿™æ ·æ“ä½œæœ€ç®€å•, æ•ˆçŽ‡æœ€é«˜. å…¶æ¬¡ä¸Šä»£ç äº† æŠŠåŽŸæœ¬/home/ap/apps/hadoop/etc/hadoopä¸­çš„ hadoopç›®å½•æ”¹ä¸ºfull,æ„æ€æ˜¯å®Œå…¨åˆ†å¸ƒå¼. cp -r full ha, å¤åˆ¶ä¸€ä»½ full ä¸º ha, åœ¨è¿™ä»½é…ç½®æ–‡ä»¶ä¸­é…ç½® HA ln -s /home/ap/apps/hadoop/etc/ha /home/ap/apps/hadoop/etc/hadoop, ç”¨ä¸€ä¸ªè½¯é“¾æŽ¥hadoop æŒ‡å‘ ha é…ç½® /home/ap/apps/hadoop/etc/ha/hdfs-site.xml 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576[hdfs-site.xml]------------------------------------------------------------------&lt;configuration&gt; &lt;!-- æŒ‡å®š 2ä¸ª namenode çš„å‘½åç©ºé—´ --&gt; &lt;property&gt; &lt;name&gt;dfs.nameservices&lt;/name&gt; &lt;value&gt;mycluster&lt;/value&gt; &lt;/property&gt; &lt;!-- myuclusterä¸‹çš„åç§°èŠ‚ç‚¹ä¸¤ä¸ªid --&gt; &lt;property&gt; &lt;name&gt;dfs.ha.namenodes.mycluster&lt;/name&gt; &lt;value&gt;nn1,nn2&lt;/value&gt; &lt;/property&gt; &lt;!-- é…ç½®æ¯ä¸ªnnçš„rpcåœ°å€ã€‚ --&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.rpc-address.mycluster.nn1&lt;/name&gt; &lt;value&gt;cs1:8020&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.rpc-address.mycluster.nn2&lt;/name&gt; &lt;value&gt;cs6:8020&lt;/value&gt; &lt;/property&gt; &lt;!-- é…ç½®webuiç«¯å£ --&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.http-address.mycluster.nn1&lt;/name&gt; &lt;value&gt;cs1:50070&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.http-address.mycluster.nn2&lt;/name&gt; &lt;value&gt;cs6:50070&lt;/value&gt; &lt;/property&gt; &lt;!-- åç§°èŠ‚ç‚¹å…±äº«ç¼–è¾‘ç›®å½•. --&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt; &lt;value&gt;qjournal://cs2:8485;cs3:8485;cs4:8485/mycluster&lt;/value&gt; &lt;/property&gt; &lt;!-- javaç±»ï¼Œclientä½¿ç”¨å®ƒåˆ¤æ–­å“ªä¸ªèŠ‚ç‚¹æ˜¯æ¿€æ´»æ€ã€‚ --&gt; &lt;property&gt; &lt;name&gt;dfs.client.failover.proxy.provider.mycluster&lt;/name&gt; &lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt; &lt;/property&gt; &lt;!-- è„šæœ¬åˆ—è¡¨æˆ–è€…javaç±»ï¼Œåœ¨å®¹ç¾ä¿æŠ¤æ¿€æ´»æ€çš„nn. --&gt; &lt;property&gt; &lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt; &lt;value&gt; sshfence shell(/bin/true) &lt;/value&gt; &lt;/property&gt; &lt;!-- sshå…å¯†ç™»é™† --&gt; &lt;property&gt; &lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt; &lt;value&gt;/home/ap/.ssh/id_rsa&lt;/value&gt; &lt;/property&gt; &lt;!-- é…ç½® sshfence éš”ç¦»æœºåˆ¶è¶…æ—¶æ—¶é—´(å¯ä¸é…) --&gt; &lt;property&gt; &lt;name&gt;dfs.ha.fencing.ssh.connect-timeout&lt;/name&gt; &lt;value&gt;30000&lt;/value&gt; &lt;/property&gt; &lt;!-- é…ç½®JNå­˜æ”¾editçš„æœ¬åœ°è·¯å¾„ã€‚ --&gt; &lt;property&gt; &lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt; &lt;value&gt;/home/ap/hadoopdata/journal&lt;/value&gt; &lt;/property&gt; &lt;/configuration&gt; é…ç½® core-site.xml, è¿™é‡Œç»™å‡ºå®Œæ•´é…ç½® (ç›®å‰ä¸åŒ…æ‹¬ Hive é…ç½®) 1234567891011121314151617181920212223[core-site.xml]------------------------------------------------------------&lt;configuration&gt; &lt;!-- æŒ‡å®š hdfs çš„ nameservice ä¸º mycluster --&gt; &lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;value&gt;hdfs://mycluster&lt;/value&gt; &lt;/property&gt; &lt;!-- æŒ‡å®š hadoop å·¥ä½œç›®å½• --&gt; &lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;value&gt;/home/ap/hadoopdata&lt;/value&gt; &lt;/property&gt; &lt;!-- æŒ‡å®šzké›†ç¾¤è®¿é—®åœ°å€ --&gt; &lt;property&gt; &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt; &lt;value&gt;cs1:2181,cs2:2181,cs3:2181&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; é…ç½®mapred-site.xml 1234567891011121314151617181920212223[mapred-site.xml]-------------------&lt;configuration&gt; &lt;!-- æŒ‡å®š mr æ¡†æž¶ä¸º yarn æ–¹å¼ --&gt; &lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt; &lt;!-- è®¾ç½® mapreduce çš„åŽ†å²æœåŠ¡å™¨åœ°å€å’Œç«¯å£å· --&gt; &lt;property&gt; &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt; &lt;value&gt;cs1:10020&lt;/value&gt; &lt;/property&gt; &lt;!-- mapreduce åŽ†å²æœåŠ¡å™¨çš„ web è®¿é—®åœ°å€ --&gt; &lt;property&gt; &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt; &lt;value&gt;cs1:19888&lt;/value&gt; &lt;/property&gt; &lt;/configuration&gt; æŠŠ/home/ap/apps/hadoop/etc/*å‘ç»™å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹ 2-6 æ³¨æ„: è½¯é“¾æŽ¥scp çš„æ—¶å€™ä¼šæœ‰é—®é¢˜, æœ€ç»ˆä¿è¯æ¯ä¸ªèŠ‚ç‚¹è·Ÿ cs1ä¸€æ ·å°±å¯ä»¥äº†,å¯ä»¥æ¯ä¸ªèŠ‚ç‚¹å•ç‹¬ä¿®æ”¹, ä¹Ÿå¯ä»¥å†™è„šæœ¬ä¸€èµ·ä¿®æ”¹ ln -sfT /home/ap/apps/hadoop/etc/ha /home/ap/apps/hadoop/etc/hadoop éƒ¨ç½²ç»†èŠ‚ 12345678910111213141516171819202122232425262728293031323334350.åœ¨ zk èŠ‚ç‚¹å¯åŠ¨ zkServercs1-cs3: $&gt;zkServer.sh start1.åœ¨jnèŠ‚ç‚¹åˆ†åˆ«å¯åŠ¨jnè¿›ç¨‹$&gt;hadoop-daemon.sh start journalnode2.å¯åŠ¨jnä¹‹åŽï¼Œåœ¨ä¸¤ä¸ªNNä¹‹é—´è¿›è¡Œdiskå…ƒæ•°æ®åŒæ­¥ a)å¦‚æžœæ˜¯å…¨æ–°é›†ç¾¤ï¼Œå…ˆformatæ–‡ä»¶ç³»ç»Ÿ,åªéœ€è¦åœ¨ä¸€ä¸ªnnä¸Šæ‰§è¡Œã€‚ [cs1] $&gt;hadoop namenode -format b)å¦‚æžœå°†éžHAé›†ç¾¤è½¬æ¢æˆHAé›†ç¾¤ï¼Œå¤åˆ¶åŽŸNNçš„metadataåˆ°å¦ä¸€ä¸ªnn. 1.æ­¥éª¤ä¸€ [cs1] $&gt;scp -r /home/centos/hadoop/dfs ap@cs6:/home/centos/hadoop/ 2.æ­¥éª¤äºŒ åœ¨æ–°çš„nn(æœªæ ¼å¼åŒ–çš„nn)ä¸Šè¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼Œå®žçŽ°å¾…å‘½çŠ¶æ€å¼•å¯¼ã€‚ [cs6] $&gt;hdfs namenode -bootstrapStandby //éœ€è¦cs1ä¸ºå¯åŠ¨çŠ¶æ€,æç¤ºæ˜¯å¦æ ¼å¼åŒ–,é€‰æ‹©N.3.åœ¨ä¸€ä¸ªNNä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®Œæˆeditæ—¥å¿—åˆ°jnèŠ‚ç‚¹çš„ä¼ è¾“ã€‚$&gt;hdfs namenode -initializeSharedEdits#æŸ¥çœ‹cs2,cs3,cs4 è¿™å‡ ä¸ª jn èŠ‚ç‚¹æ˜¯å¦æœ‰editæ•°æ®.4.å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹.[cs1]$&gt;hadoop-daemon.sh start namenode //å¯åŠ¨åç§°èŠ‚ç‚¹$&gt;hadoop-daemons.sh start datanode //å¯åŠ¨æ‰€æœ‰æ•°æ®èŠ‚ç‚¹[2,3,4]$&gt;hadoop-daemon.sh start journalnode[cs6]$&gt;hadoop-daemon.sh start namenode //å¯åŠ¨åç§°èŠ‚ç‚¹ HA ç®¡ç† 12345678910# æŸ¥çœ‹web ç•Œé¢, æ˜¯å¦æ˜¯2ä¸ª standby çŠ¶æ€http://cs1:50070/http://cs6:50070/hdfs haadmin : æŸ¥çœ‹ ha å¸®åŠ©-----------------$&gt;hdfs haadmin -transitionToActive nn1 //åˆ‡æˆæ¿€æ´»æ€$&gt;hdfs haadmin -transitionToStandby nn1 //åˆ‡æˆå¾…å‘½æ€$&gt;hdfs haadmin -transitionToActive --forceactive nn2//å¼ºè¡Œæ¿€æ´»$&gt;hdfs haadmin -failover nn1 nn2 //æ¨¡æ‹Ÿå®¹ç¾æ¼”ç¤º,ä»Žnn1åˆ‡æ¢åˆ°nn2 åŠ å…¥ Zookeeper å®¹ç¾æœåŠ¡ zkfc 12345678910111213141516171819202122232425262728293031323334353637&lt;!-- 1.éƒ¨ç½²å®¹ç¾ --&gt;------------------------------a.åœæ­¢æ‰€æœ‰è¿›ç¨‹$&gt;stop-all.shb.é…ç½®hdfs-site.xmlï¼Œå¯ç”¨è‡ªåŠ¨å®¹ç¾.[hdfs-site.xml]&lt;property&gt; &lt;name&gt;dfs.ha.automatic-failover.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt;&lt;/property&gt;c.é…ç½®core-site.xmlï¼ŒæŒ‡å®šzkçš„è¿žæŽ¥åœ°å€.&lt;property&gt; &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt; &lt;value&gt;cs1:2181,cs2:2181,cs3:2181&lt;/value&gt;&lt;/property&gt;d.åˆ†å‘ä»¥ä¸Šä¸¤ä¸ªæ–‡ä»¶åˆ°æ‰€æœ‰èŠ‚ç‚¹ã€‚&lt;!-- 2.ç™»å½•å…¶ä¸­çš„ä¸€å°NN(s201),åœ¨ZKä¸­åˆå§‹åŒ–HAçŠ¶æ€, åˆ›å»º namenode çš„ å‘½åç©ºé—´èŠ‚ç‚¹ mycluster --&gt;------------------------------------$&gt;hdfs zkfc -formatZK&lt;!-- 3.å¯åŠ¨hdfsè¿›ç¨‹. --&gt; $&gt;start-dfs.sh&lt;!-- 4.æŸ¥çœ‹ webUI, æ˜¯å¦æœ‰ä¸€å°è‡ªåŠ¨åˆ‡æ¢ä¸º active çŠ¶æ€äº† --&gt;http://cs1:50070/http://cs6:50070/&lt;!-- 5.æµ‹è¯•è‡ªåŠ¨å®¹ç¾(å¦‚æžœcs6æ˜¯æ´»è·ƒèŠ‚ç‚¹) --&gt; $&gt;kill -9 cs6çš„ namenodeè¿›ç¨‹å·è§‚å¯Ÿ cs1:50070çš„çŠ¶æ€å˜åŒ– é…ç½®RMçš„HAè‡ªåŠ¨å®¹ç¾ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021.é…ç½®yarn-site.xml&lt;configuration&gt; &lt;!-- æ˜¯å¦å…è®¸é«˜å¯ç”¨ --&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.ha.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;!-- Identifies the cluster. Used by the elector to ensure an RM doesnâ€™t take over as Active for another cluster. --&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt; &lt;value&gt;cluster1&lt;/value&gt; &lt;/property&gt; &lt;!-- RM çš„ id --&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt; &lt;value&gt;rm1,rm2&lt;/value&gt; &lt;/property&gt; &lt;!-- 2å° RM çš„å®¿ä¸» --&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname.rm1&lt;/name&gt; &lt;value&gt;cs1&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname.rm2&lt;/name&gt; &lt;value&gt;cs6&lt;/value&gt; &lt;/property&gt; &lt;!-- é…ç½®webç•Œé¢ --&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.webapp.address.rm1&lt;/name&gt; &lt;value&gt;cs1:8088&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.webapp.address.rm2&lt;/name&gt; &lt;value&gt;cs6:8088&lt;/value&gt; &lt;/property&gt; &lt;!-- zookeeper åœ°å€ --&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.zk-address&lt;/name&gt; &lt;value&gt;cs1:2181,cs2:2181,cs3:2181&lt;/value&gt; &lt;/property&gt; &lt;!-- YARN é›†ç¾¤ä¸º MapReduce ç¨‹åºæä¾›çš„ shuffle æœåŠ¡(åŽŸæœ¬çš„) --&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt; &lt;!-- ===========ä»¥ä¸‹æ˜¯å¯é€‰çš„============= --&gt; &lt;!-- å¼€å¯ YARN é›†ç¾¤çš„æ—¥å¿—èšåˆåŠŸèƒ½ --&gt; &lt;property&gt; &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;!-- YARN é›†ç¾¤çš„èšåˆæ—¥å¿—æœ€é•¿ä¿ç•™æ—¶é•¿ --&gt; &lt;property&gt; &lt;name&gt;yarn.log-aggregation.retain-seconds&lt;/name&gt; &lt;value&gt;86400&lt;/value&gt; &lt;/property&gt; &lt;!-- å¯ç”¨è‡ªåŠ¨æ¢å¤ --&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.recovery.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;!-- æŒ‡å®š resourcemanager çš„çŠ¶æ€ä¿¡æ¯å­˜å‚¨åœ¨ zookeeper é›†ç¾¤ä¸Š--&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.store.class&lt;/name&gt; &lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt;------------------------------------------------------------------2.ä½¿ç”¨ç®¡ç†å‘½ä»¤&lt;!-- æŸ¥çœ‹çŠ¶æ€ --&gt;$&gt;yarn rmadmin -getServiceState rm1&lt;!-- åˆ‡æ¢çŠ¶æ€åˆ°standby --&gt;$&gt;yarn rmadmin -transitionToStandby rm13.å¯åŠ¨yarné›†ç¾¤$&gt;start-yarn.sh4.hadoopæ²¡æœ‰å¯åŠ¨ä¸¤ä¸ªresourcemanager,éœ€è¦æ‰‹åŠ¨å¯åŠ¨å¦å¤–ä¸€ä¸ª$&gt;yarn-daemon.sh start resourcemanager5.æŸ¥çœ‹webUI, ç‚¹å‡» About, æŸ¥çœ‹ active æˆ– standbyhttp://cs1:8088http://cs6:80886.åšå®¹ç¾æ¨¡æ‹Ÿ.kill -9 æ´»è·ƒçš„ RM ç«¯å£å·7.æ³¨æ„: å¦‚æžœå®¹ç¾å¤±è´¥, æ£€æŸ¥ä¸‹æ¯å°ä¸»æœºæ—¶é—´æ˜¯å¦åŒæ­¥$&gt;sudo ntpdate ntp1.aliyun.com è‡³æ­¤, å¤§åŠŸå‘Šæˆ 4.HA é›†ç¾¤çš„å¯åŠ¨/å…³é—­4.1 HA çš„å¯åŠ¨ä¸€:å•ç‚¹å¯åŠ¨ å¯åŠ¨ zk æœåŠ¡ QuorumPeerMain, å¦åˆ™åŽé¢ RM ä¼šèµ·ä¸æ¥,è¿žä¸ä¸Š ZK æœåŠ¡cs1-cs3: $&gt; zkServer.sh start å¯åŠ¨ namenode/datanode cs1,cs6: $&gt; hadoop-daemon.sh start namenode cs1/cs6: $&gt; hadoop-daemons.sh start datanode cs6: $&gt; hadoop-daemon.sh start namenode å¯åŠ¨ journalnode cs2-cs4: $&gt; hadoop-daemon.sh start journalnode å¯åŠ¨RM (RM ä¼šè‡ªåŠ¨é€‰å‡ºä¸€ä¸ª active) cs1,cs6: $&gt; yarn-daemon.sh start resourcemanager cs1/cs6: $&gt; yarn-daemons.sh start nodemanager å¯åŠ¨ zk çš„ DFSZKFailoverController cs1,cs6: $&gt; hadoop-daemon.sh start zkfc æ­¤å¤–å¯ä»¥å¯åŠ¨MapReduce çš„åŽ†å²ä»»åŠ¡æœåŠ¡å™¨ [ap@cs1]$&gt; mr-jobhistory-daemon.sh start historyserver ç„¶åŽè®¿é—®é…ç½®çš„ http://cs1:19888/jobhistory äºŒ:æ‡’æ±‰å¯åŠ¨ å¯åŠ¨ zk æœåŠ¡ QuorumPeerMain, å¦åˆ™åŽé¢ RM ä¼šèµ·ä¸æ¥,è¿žä¸ä¸Š ZK æœåŠ¡cs1-cs3: $&gt; zkServer.sh start æ‰§è¡Œå¯åŠ¨å…¨éƒ¨ cs1: $&gt; start-all.sh(RM èŠ‚ç‚¹) æˆ–è€…, ä½¿ç”¨æ–°çš„å¯åŠ¨æ–¹å¼ cs1: $&gt; start-dfs.sh(ä»»æ„èŠ‚ç‚¹) cs1: $&gt; start-yarn.sh(åœ¨ RM èŠ‚ç‚¹) å¦ä¸€ä¸ª RM èŠ‚ç‚¹ä¸ä¼šè‡ªå·±å¯åŠ¨,è¦æ‰‹åŠ¨å¯åŠ¨ cs6: $&gt; yarn-daemon.sh start resourcemanager ä¸‰: å¯åŠ¨å®ŒæˆåŽ 1234567891011121314151617181920212223242526272829303132============= cs1 jps =============5696 QuorumPeerMain6641 DFSZKFailoverController6338 NameNode6756 ResourceManager6873 Jps============= cs2 jps =============10849 Jps10722 NodeManager10631 JournalNode10541 DataNode127934 QuorumPeerMain============= cs3 jps =============630 NodeManager758 Jps535 JournalNode443 DataNode117503 QuorumPeerMain============= cs4 jps =============79589 Jps79462 NodeManager79368 JournalNode79278 DataNode============= cs5 jps =============23655 Jps23529 NodeManager23423 DataNode============= cs6 jps =============35680 Jps35506 NameNode35608 DFSZKFailoverController21455 ResourceManager 4.2 HA çš„å…³é—­åœ¨ ä¸€å°NN ä¸Šstop-all.sh, æ³¨æ„ zk çš„ server- QuorumPeerMainä¸ä¼šåœæŽ‰ 5. åœ¨é›†ç¾¤å®žçŽ°æ—¶é—´åŒæ­¥(root ç”¨æˆ·æ“ä½œ)æ€è·¯:æ—¶é—´åŒæ­¥çš„æ–¹å¼ï¼šæ‰¾ä¸€ä¸ªæœºå™¨ï¼Œä½œä¸ºæ—¶é—´æœåŠ¡å™¨ï¼Œæ‰€æœ‰çš„æœºå™¨ä¸Žè¿™å°é›†ç¾¤æ—¶é—´è¿›è¡Œå®šæ—¶çš„åŒæ­¥ï¼Œæ¯”å¦‚ï¼Œæ¯éš”ååˆ†é’Ÿï¼ŒåŒæ­¥ä¸€æ¬¡æ—¶é—´ã€‚ 5.1 åœ¨cs1ä¸Šä¿®æ”¹ntpæœåŠ¡12345678910111213141516171819202122232425262728293031323334353637383940414243444546471) æ£€æŸ¥ ntp æ˜¯å¦å®‰è£…#root&gt; rpm -qa|grep ntp---ntp-4.2.6p5-10.el6.centos.x86_64fontpackages-filesystem-1.41-1.1.el6.noarchntpdate-4.2.6p5-10.el6.centos.x86_64# å‡ºçŽ°ä¸Šé¢çš„3ä¸ªæ–‡ä»¶, å°±æ˜¯å®‰è£…äº†; å¦‚æžœæ²¡æœ‰çš„è¯, ç”¨ yum è£…ä¸€ä¸‹# root&gt; yum inatall -y ntp2) ä¿®æ”¹ ntp é…ç½®æ–‡ä»¶#root&gt; vi /etc/ntp.confä¿®æ”¹å†…å®¹å¦‚ä¸‹ aï¼‰ä¿®æ”¹1ï¼ˆè®¾ç½®æœ¬åœ°ç½‘ç»œä¸Šçš„ä¸»æœºä¸å—é™åˆ¶ã€‚ï¼‰ #restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap ä¸º restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap bï¼‰ä¿®æ”¹2ï¼ˆè®¾ç½®ä¸ºä¸é‡‡ç”¨å…¬å…±çš„æœåŠ¡å™¨ï¼‰ server 0.centos.pool.ntp.org iburst server 1.centos.pool.ntp.org iburst server 2.centos.pool.ntp.org iburst server 3.centos.pool.ntp.org iburst ä¸º #server 0.centos.pool.ntp.org iburst #server 1.centos.pool.ntp.org iburst #server 2.centos.pool.ntp.org iburst #server 3.centos.pool.ntp.org iburst cï¼‰æ·»åŠ 3ï¼ˆæ·»åŠ é»˜è®¤çš„ä¸€ä¸ªå†…éƒ¨æ—¶é’Ÿæ•°æ®ï¼Œä½¿ç”¨å®ƒä¸ºå±€åŸŸç½‘ç”¨æˆ·æä¾›æœåŠ¡ã€‚ï¼‰ server 127.127.1.0 fudge 127.127.1.0 stratum 103ï¼‰ä¿®æ”¹/etc/sysconfig/ntpd æ–‡ä»¶#root&gt; vim /etc/sysconfig/ntpdå¢žåŠ å†…å®¹å¦‚ä¸‹ï¼ˆè®©ç¡¬ä»¶æ—¶é—´ä¸Žç³»ç»Ÿæ—¶é—´ä¸€èµ·åŒæ­¥ï¼‰SYNC_HWCLOCK=yes4ï¼‰é‡æ–°å¯åŠ¨ntpd#root&gt; service ntpd statusntpd å·²åœ#root&gt; service ntpd startæ­£åœ¨å¯åŠ¨ ntpdï¼š 5) æ‰§è¡Œå¼€æœºå¯åŠ¨ ntpd æœåŠ¡#root&gt; chkconfig ntpd onæŸ¥çœ‹ ntpd æœåŠ¡å¼€æœºå¯åŠ¨çš„çŠ¶æ€#root&gt; chkconfig --list ntpd 5.2 å…¶å®ƒæœºå™¨ä¸Š1234567891ï¼‰åœ¨å…¶ä»–æ‰€æœ‰æœºå™¨é…ç½®10åˆ†é’Ÿä¸Žæ—¶é—´æœåŠ¡å™¨åŒæ­¥ä¸€æ¬¡#ç¼–å†™å®šæ—¶ä»»åŠ¡è„šæœ¬#root&gt; crontab -e */10 * * * * /usr/sbin/ntpdate hadoop1022) ä¿®æ”¹ä»»æ„æœºå™¨æ—¶é—´#root&gt; date -s "2017-9-11 11:11:11"3) ååˆ†é’ŸåŽæŸ¥çœ‹æœºå™¨æ—¶é—´æ˜¯å¦ä¸Žcs1 åŒæ­¥]]></content>
      <categories>
        <category>Hadoop</category>
        <category>hadoop</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[i-Hive-Practice-1 å½±è¯„ç»ƒä¹ ]]></title>
    <url>%2F2018%2F06%2F19%2FHadoop%2F3-Hive%2Fi-Hive-Practice-1-%E5%BD%B1%E8%AF%84%E7%BB%83%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[çŽ°æœ‰å¦‚æ­¤ä¸‰ä»½æ•°æ®ï¼š1ã€users.dat æ•°æ®æ ¼å¼ä¸ºï¼š 2::M::56::16::70072å¯¹åº”å­—æ®µä¸ºï¼šUserID BigInt, Gender String, Age Int, Occupation String, Zipcode Stringå¯¹åº”å­—æ®µä¸­æ–‡è§£é‡Šï¼šç”¨æˆ·idï¼Œæ€§åˆ«ï¼Œå¹´é¾„ï¼ŒèŒä¸šï¼Œé‚®æ”¿ç¼–ç  2ã€movies.dat æ•°æ®æ ¼å¼ä¸ºï¼š 2::Jumanji (1995)::Adventure|Childrenâ€™s|Fantasyå¯¹åº”å­—æ®µä¸ºï¼šMovieID BigInt, Title String, Genres Stringå¯¹åº”å­—æ®µä¸­æ–‡è§£é‡Šï¼šç”µå½±IDï¼Œç”µå½±åå­—ï¼Œç”µå½±ç±»åž‹ 3ã€ratings.dat æ•°æ®æ ¼å¼ä¸ºï¼š 1::1193::5::978300760å¯¹åº”å­—æ®µä¸ºï¼šUserID BigInt, MovieID BigInt, Rating Double, Timestamped Stringå¯¹åº”å­—æ®µä¸­æ–‡è§£é‡Šï¼šç”¨æˆ·IDï¼Œç”µå½±IDï¼Œè¯„åˆ†ï¼Œè¯„åˆ†æ—¶é—´æˆ³ é¢˜ç›®è¦æ±‚ï¼š æ•°æ®è¦æ±‚ï¼šï¼ˆ1ï¼‰å†™shellè„šæœ¬æ¸…æ´—æ•°æ®ã€‚ï¼ˆhiveä¸æ”¯æŒè§£æžå¤šå­—èŠ‚çš„åˆ†éš”ç¬¦ï¼Œä¹Ÿå°±æ˜¯è¯´hiveåªèƒ½è§£æžâ€™:â€™, ä¸æ”¯æŒè§£æžâ€™::â€™ï¼Œæ‰€ä»¥ç”¨æ™®é€šæ–¹å¼å»ºè¡¨æ¥ä½¿ç”¨æ˜¯è¡Œä¸é€šçš„ï¼Œè¦æ±‚å¯¹æ•°æ®åšä¸€æ¬¡ç®€å•æ¸…æ´—ï¼‰ï¼ˆ2ï¼‰ä½¿ç”¨Hiveèƒ½è§£æžçš„æ–¹å¼è¿›è¡Œ Hiveè¦æ±‚ï¼šï¼ˆ1ï¼‰æ­£ç¡®å»ºè¡¨ï¼Œå¯¼å…¥æ•°æ®ï¼ˆä¸‰å¼ è¡¨ï¼Œä¸‰ä»½æ•°æ®ï¼‰ï¼Œå¹¶éªŒè¯æ˜¯å¦æ­£ç¡® ï¼ˆ2ï¼‰æ±‚è¢«è¯„åˆ†æ¬¡æ•°æœ€å¤šçš„10éƒ¨ç”µå½±ï¼Œå¹¶ç»™å‡ºè¯„åˆ†æ¬¡æ•°ï¼ˆç”µå½±åï¼Œè¯„åˆ†æ¬¡æ•°ï¼‰ 123456789101112131415161718192021222324252627282930313233343536æ€è·¯:1. åˆ†ç»„select movieid, count(movieid) rateCount from ratings group by movieid limit 10;2. æŽ’åºselect movieid, count(movieid) rateCount from ratings group by movieid order by rateCount desc limit 10;3.joinselect a.movieid mvid, b.Title mvtitle, a.rateCount mvratecount from (select movieid, count(movieid) rateCount from ratings group by movieid order by rateCount desc limit 10) ajoin movies b where a.movieid=b.movieid;==============================ï£¿ å®Œæ•´çš„------------select a.movieid mvid, b.Title mvtitle, a.rateCount mvratecount from (select movieid, count(movieid) rateCount from ratings group by movieid order by rateCount desc limit 10) ajoin movies b where a.movieid=b.movieid;--ç»“æžœ---+-------+----------------------------------------------------+--------------+| mvid | mvtitle | mvratecount |+-------+----------------------------------------------------+--------------+| 2858 | American Beauty (1999) | 3428 || 260 | Star Wars: Episode IV - A New Hope (1977) | 2991 || 1196 | Star Wars: Episode V - The Empire Strikes Back (1980) | 2990 || 1210 | Star Wars: Episode VI - Return of the Jedi (1983) | 2883 || 480 | Jurassic Park (1993) | 2672 || 2028 | Saving Private Ryan (1998) | 2653 || 589 | Terminator 2: Judgment Day (1991) | 2649 || 2571 | Matrix, The (1999) | 2590 || 1270 | Back to the Future (1985) | 2583 || 593 | Silence of the Lambs, The (1991) | 2578 |+-------+----------------------------------------------------+--------------+ ï¼ˆ3ï¼‰åˆ†åˆ«æ±‚ç”·æ€§ï¼Œå¥³æ€§å½“ä¸­è¯„åˆ†æœ€é«˜çš„10éƒ¨ç”µå½±ï¼ˆæ€§åˆ«ï¼Œç”µå½±åï¼Œå½±è¯„åˆ†ï¼‰ 123456789101112131415161718192021222324252627# æ³¨æ„,è¿™é‡Œçš„ avg(r.rating) æ˜¯å› ä¸ºgroup byäº† gender,title, ä¹Ÿå°±æ˜¯# è¯´æœ‰ gender,title åˆ†ç»„, æ­¤æ—¶å¯èƒ½å¯¹åº”æ­¤ç»„çš„æœ‰å¤šä¸ªå€¼,# è¿™é‡Œå°±æ˜¯ ç›¸åŒæ€§åˆ«è¯„ä»·ç›¸åŒç”µå½±çš„, è¯„åˆ†æœ‰å¤šä¸ª, æ­¤æ—¶å°±è¦ä½¿ç”¨èšåˆå‡½æ•°,å¾—å‡ºå”¯ä¸€å€¼# å› æ­¤å°±ä½¿ç”¨äº† avg(r.rating)select u.gender, m.title, avg(r.rating) rrfrom ratings r join users u on r.userid=u.userid join movies m on r.movieid=m.movieidwhere u.gender = 'M'group by gender,titleorder by rr desclimit 10;+-----------+--------------------------------------------+------+| u.gender | m.title | rr |+-----------+--------------------------------------------+------+| M | Schlafes Bruder (Brother of Sleep) (1995) | 5.0 || M | Small Wonders (1996) | 5.0 || M | Lured (1947) | 5.0 || M | Bells, The (1926) | 5.0 || M | Dangerous Game (1993) | 5.0 || M | Baby, The (1973) | 5.0 || M | Gate of Heavenly Peace, The (1995) | 5.0 || M | Follow the Bitch (1998) | 5.0 || M | Ulysses (Ulisse) (1954) | 5.0 || M | Angela (1995) | 5.0 |+-----------+--------------------------------------------+------+ ï¼ˆ4ï¼‰æ±‚movieid = 2116è¿™éƒ¨ç”µå½±å„å¹´é¾„æ®µï¼ˆå› ä¸ºå¹´é¾„å°±åªæœ‰7ä¸ªï¼Œå°±æŒ‰è¿™ä¸ª7ä¸ªåˆ†å°±å¥½äº†ï¼‰çš„å¹³å‡å½±è¯„ï¼ˆå¹´é¾„æ®µï¼Œå½±è¯„åˆ†ï¼‰ 12345# æ³¨æ„: æ²¡æœ‰æ­§ä¹‰çš„å­—æ®µ, å¯ä»¥ä¸ç”¨æŒ‡æ˜Žæ˜¯è°çš„å±žæ€§select age, avg(r.rating) avgrating from ratings r join users u on r.userid=u.useridwhere movieid=2116group by age; ï¼ˆ5ï¼‰æ±‚æœ€å–œæ¬¢çœ‹ç”µå½±ï¼ˆå½±è¯„æ¬¡æ•°æœ€å¤šï¼‰çš„é‚£ä½å¥³æ€§è¯„æœ€é«˜åˆ†çš„10éƒ¨ç”µå½±çš„å¹³å‡å½±è¯„åˆ†ï¼ˆè§‚å½±è€…ï¼Œç”µå½±åï¼Œå½±è¯„åˆ†ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455# 1.å…ˆæ‹¿åˆ° å½±è¯„æ¬¡æ•°æœ€å¤šçš„å¥³æ€§(id)0: jdbc:hive2://cs2:10000&gt; select UserID, count(UserID) count from ratings. . . . . . . . . . . . .&gt; group by UserID. . . . . . . . . . . . .&gt; order by count desc. . . . . . . . . . . . .&gt; limit 1;+---------+--------+| userid | count |+---------+--------+| 4169 | 2314 |+---------+--------+# 2.æ‹¿åˆ°æ­¤äººè¯„åˆ†æœ€é«˜çš„10éƒ¨ç”µå½±, æ­¤äºº userid, ç”µå½± id, æ­¤äººè¯„åˆ†## ä¸€å®šè¦åŽ»é‡select distinct(MovieID) MovieID, Rating from ratings where UserID=4169 order by Rating desclimit 10;+----------+---------+| movieid | rating |+----------+---------+| 78 | 5.0 || 73 | 5.0 || 72 | 5.0 || 58 | 5.0 || 55 | 5.0 || 50 | 5.0 || 41 | 5.0 || 36 | 5.0 || 25 | 5.0 || 17 | 5.0 |+----------+---------+3.è¿™10éƒ¨ç”µå½±çš„(è§‚å½±è€…ï¼Œç”µå½±åï¼Œå¹³å‡å½±è¯„åˆ†)è§‚å½±è€…è¿˜æ²¡å†™select t.MovieID, m.Title, avg(r.rating) avgrating from topten t join ratings r on t.MovieID=r.MovieIDjoin movies m on t.MovieID=m.MovieIDgroup by t.MovieID,m.Title;+------------+-----------------------------------------------+---------------------+| t.movieid | m.title | avgrating |+------------+-----------------------------------------------+---------------------+| 3849 | Spiral Staircase, The (1946) | 4.046511627906977 || 3870 | Our Town (1940) | 3.857142857142857 || 3871 | Shane (1953) | 3.839344262295082 || 3893 | Nurse Betty (2000) | 3.5026833631484795 || 3897 | Almost Famous (2000) | 4.22635814889336 || 3910 | Dancer in the Dark (2000) | 3.82 || 3927 | Fantastic Voyage (1966) | 3.5804597701149423 || 3928 | Abbott and Costello Meet Frankenstein (1948) | 3.441747572815534 || 3929 | Bank Dick, The (1940) | 3.993197278911565 || 3932 | Invisible Man, The (1933) | 3.75 |+------------+-----------------------------------------------+---------------------+ ï¼ˆ6ï¼‰æ±‚å¥½ç‰‡ï¼ˆè¯„åˆ†&gt;=4.0ï¼‰æœ€å¤šçš„é‚£ä¸ªå¹´ä»½çš„æœ€å¥½çœ‹çš„10éƒ¨ç”µå½±ï¼ˆ7ï¼‰æ±‚1997å¹´ä¸Šæ˜ çš„ç”µå½±ä¸­ï¼Œè¯„åˆ†æœ€é«˜çš„10éƒ¨Comedyç±»ç”µå½±ï¼ˆ8ï¼‰è¯¥å½±è¯„åº“ä¸­å„ç§ç±»åž‹ç”µå½±ä¸­è¯„ä»·æœ€é«˜çš„5éƒ¨ç”µå½±ï¼ˆç±»åž‹ï¼Œç”µå½±åï¼Œå¹³å‡å½±è¯„åˆ†ï¼‰ï¼ˆ9ï¼‰å„å¹´è¯„åˆ†æœ€é«˜çš„ç”µå½±ç±»åž‹ï¼ˆå¹´ä»½ï¼Œç±»åž‹ï¼Œå½±è¯„åˆ†ï¼‰ï¼ˆ10ï¼‰æ¯ä¸ªåœ°åŒºæœ€é«˜è¯„åˆ†çš„ç”µå½±åï¼ŒæŠŠç»“æžœå­˜å…¥HDFSï¼ˆåœ°åŒºï¼Œç”µå½±åï¼Œå½±è¯„åˆ†ï¼‰]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Hive</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Hive</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IDEAçš„ç®€å•ä½¿ç”¨]]></title>
    <url>%2F2018%2F06%2F18%2FTools%2FIDEA%2FIDEA%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[1.å®‰è£… Scala æ’ä»¶é¦–å…ˆ, ç›´æŽ¥åœ¨ plugin ä¸­æœç´¢å®˜æ–¹çš„ Scala è¯­è¨€åŒ…æ’ä»¶æ˜¯è¿žä¸ä¸Šçš„, è¦éªŒè¯ä¸€äº› UUIDä¹‹ç±»çš„ä¸œè¥¿, åŽŸå› ä½ æ‡‚çš„ äºŽæ˜¯ä¹Žåœ¨ç½‘ä¸Šæœç´¢, æœ‰ä¸€ç¯‡åšå®¢è¯´, çœ‹æœç´¢çš„æ—¶å€™æ˜¾ç¤ºçš„ç‰ˆæœ¬, ç„¶åŽä¸‹è½½æ­¤ç‰ˆæœ¬å®‰è£…, å¦‚ä¸‹å›¾ä¸­ç”»æ¡†çš„ç‰ˆæœ¬å· ç„¶åŽåŽ»å®˜ç½‘æ‰¾åˆ°æ­¤ç‰ˆæœ¬å®‰è£…,ä¸‹è½½ä¸‹æ¥ ä»Žç£ç›˜å®‰è£… ç®€ç›´ä¸è¦å¤ªå‘ b å“¦!!! ä¸€ç›´è¯´ç‰ˆæœ¬ä¸åŒ¹é…. æˆ‘å°±ä¸€ç›´æ²¡æœ‰æ€€ç–‘ç‰ˆæœ¬çš„é—®é¢˜, ç›´åˆ°çœ‹åˆ° æ€Žä¹ˆæ„Ÿè§‰è¿™ä¸ª 2013.3 åœ¨å“ªé‡Œè§åˆ°è¿‡?? æŸ¥äº†ä¸€ä¸‹æˆ‘çš„ idea ç‰ˆæœ¬, ä¸å°±æ˜¯ 2017.3.5å˜› ! éš¾é“ä»–ä»¬æœ‰å…³ç³»?? æŠ±ç€è¯•ä¸€è¯•çš„æ€åº¦, éšä¾¿ä¸‹äº†ä¸€ä¸ª2017.3.15çš„ å±…ç„¶èƒ½è£…ä¸Š?? å¥½å§, é‡å¯, OK äº†! ç”±æ­¤å¯è§, ä¹Ÿä¸è¦å®Œå…¨ç›¸ä¿¡åˆ«äººçš„åšå®¢å•Š!! å¦‚æžœä¸è¡Œ, å¤šæ–¹å°è¯•! å°½ä¿¡ä¹¦ä¸å¦‚æ— ä¹¦!]]></content>
      <categories>
        <category>å·¥å…·</category>
        <category>IDEA</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>å·¥å…·</tag>
        <tag>IDEA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hiveå­¦ä¹ â€”2]]></title>
    <url>%2F2018%2F06%2F14%2FHadoop%2F3-Hive%2FHive%E5%AD%A6%E4%B9%A0-2%2F</url>
    <content type="text"><![CDATA[hiveæ•°æ®ç±»åž‹1) åŽŸå­æ•°æ®ç±»åž‹ TinyIntï¼š1byteæœ‰ç¬¦å·æ•´æ•° SmallIntï¼š2byteæœ‰ç¬¦å·æ•´æ•° Intï¼š4byteæœ‰ç¬¦å·æ•´æ•° BigIntï¼š8byteæœ‰ç¬¦å·æ•´æ•° Floatï¼šå•ç²¾åº¦æµ®ç‚¹æ•° Doubleï¼šåŒç²¾åº¦æµ®ç‚¹æ•° Booleanï¼šå¸ƒå°”ç±»åž‹ Stringï¼šå­—ç¬¦ä¸² TimeStampï¼šæ•´æ•° 2) å¤æ‚æ•°æ®ç±»åž‹ Array\&lt;Type> ç”±ä¸€ç³»åˆ—ç›¸åŒæ•°æ®ç±»åž‹çš„å…ƒç´ ç»„æˆ è¿™äº›å…ƒç´ å¯ä»¥é€šè¿‡ ä¸‹æ ‡ æ¥è®¿é—® æŸ¥è¯¢æ—¶å¦‚æžœæŸ¥åˆ°è¿”å›žå“åº”å€¼ï¼Œæ²¡æŸ¥åˆ°åˆ™è¿”å›žnullå»ºè¡¨ï¼šcreate table person(name string,work_locations array\&lt;string>)row format delimited fields terminated by â€˜\tâ€™collection items terminated by â€˜,â€™;å¯¼å…¥æ•°æ®ï¼šload data local inpath â€˜/home/sigeon/person.txtâ€™ into table person;æŸ¥è¯¢Select work_locations[0] from person; Map&lt;KType, VType&gt; åŒ…å« key-value é”®å€¼å¯¹ å¯ä»¥é€šè¿‡ key æ¥è®¿é—®å…ƒç´ å»ºè¡¨è¯­å¥ï¼šcreate table score(name string, scores map)row format delimited fields terminated by â€˜\tâ€™collection items terminated by â€˜,â€™map keys terminated by â€˜:â€™;å¯¼å…¥æ•°æ®ï¼šload data local inpath â€˜/home/sigeon/score.txtâ€™ into table score;æŸ¥è¯¢è¯­å¥ï¼šSelect scores[â€˜Chineseâ€™] from score; Struct&lt;Param1:Type1, Param1:Type1, â€¦ &gt; å¯ä»¥åŒ…å«ä¸åŒæ•°æ®ç±»åž‹çš„å…ƒç´ ç±»ä¼¼äºŽcè¯­è¨€ä¸­çš„ç»“æž„ä½“ è¿™äº›å…ƒç´ å¯ä»¥é€šè¿‡ ç‚¹è¯­æ³• çš„æ–¹å¼æ¥å¾—åˆ°å»ºè¡¨è¯­å¥ï¼šcreate table course(id int,course struct&lt;name:string, score:int&gt;)row format delimited fields terminated by â€˜\tâ€™collection items terminated by â€˜,â€™;å¯¼å…¥æ•°æ®ï¼šload data local inpath â€˜/ home/sigoen/course.txtâ€™ into table course;æŸ¥è¯¢è¯­å¥ï¼šSelect c.course.score from course c; å‡ ä¸ªåˆ†éš”ç¬¦ æŒ‡å®šåˆ†éš”ç¬¦è¦æŒ‰ä»Žå¤–å‘å†…çš„é¡ºåºï¼Œå­—æ®µ -&gt; é›†åˆå…ƒç´  -&gt;map k-v ROW FORMATï¼šæŒ‡å®šåˆ†éš”ç¬¦çš„å…³é”®å­— DELIMITED FIELDS TERMINATED BYï¼šå­—æ®µåˆ†éš”ç¬¦ COLLECTION ITEMS TERMINATED BYï¼šé›†åˆå…ƒç´ åˆ†éš”ç¬¦ï¼ˆArray ä¸­çš„å„å…ƒç´ ã€Struct ä¸­çš„å„å…ƒç´ ã€ Map ä¸­çš„ key-value å¯¹ä¹‹é—´ï¼‰ MAP KEYS TERMINATED BYï¼šMap ä¸­ key ä¸Ž value çš„åˆ†éš”ç¬¦ LINES TERMINATED BYï¼šè¡Œä¹‹é—´çš„åˆ†éš”ç¬¦ hiveè§†å›¾ å’Œå…³ç³»åž‹æ•°æ®åº“ä¸€æ ·ï¼ŒHiveä¹Ÿæä¾›äº†è§†å›¾çš„åŠŸèƒ½ Hive çš„è§†å›¾å’Œå…³ç³»åž‹æ•°æ®åº“çš„è§†å›¾æœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼š 1ã€åªæœ‰é€»è¾‘è§†å›¾ï¼Œæ²¡æœ‰ç‰©åŒ–è§†å›¾ï¼› 2ã€è§†å›¾åªèƒ½æŸ¥è¯¢ï¼Œä¸èƒ½å¢žåˆ æ”¹ (Load|Insert/Update/Delete) æ•°æ®ï¼› 3ã€è§†å›¾åœ¨åˆ›å»ºæ—¶å€™ï¼Œåªæ˜¯ä¿å­˜äº†ä¸€ä»½å…ƒæ•°æ® (å­˜åœ¨TBLSä¸­)ï¼Œå½“æŸ¥è¯¢è§†å›¾çš„æ—¶å€™ï¼Œæ‰å¼€å§‹æ‰§è¡Œè§†å›¾å¯¹åº”çš„é‚£äº›å­æŸ¥è¯¢è§†å›¾å…ƒæ•°æ®åªå­˜å‚¨äº†hqlè¯­å¥ï¼Œè€Œä¸æ˜¯æ‰§è¡Œç»“æžœ è§†å›¾æ“ä½œ åˆ›å»ºè§†å›¾ 1create view my_view as &lt;select * from mytable&gt; [limit 500]; æŸ¥çœ‹è§†å›¾ show tables; // æ˜¾ç¤ºæ‰€æœ‰è¡¨å’Œè§†å›¾ show views; //æ˜¾ç¤ºæ‰€æœ‰è§†å›¾ desc [formatted] view_name; // æŸ¥çœ‹æŸä¸ªå…·ä½“è§†å›¾çš„(è¯¦ç»†)ä¿¡æ¯è§†å›¾ç±»åž‹ï¼šVIRTUAL_VIEW åˆ é™¤è§†å›¾ drop view [if exists] view_name ä½¿ç”¨è§†å›¾ select count(distinct uid) from my_view; hiveå‡½æ•° å‡½æ•°åˆ†ç±» UDFï¼ˆè‡ªå®šä¹‰å‡½æ•° User-Defined Functionï¼‰ä½œç”¨äºŽå•ä¸ªæ•°æ®è¡Œï¼Œäº§ç”Ÿä¸€ä¸ªæ•°æ®è¡Œä½œä¸ºè¾“å‡ºã€‚ï¼ˆæ•°å­¦å‡½æ•°ï¼Œå­— ç¬¦ä¸²å‡½æ•°ï¼‰ UDAFï¼ˆç”¨æˆ·å®šä¹‰èšé›†å‡½æ•° User-Defined Aggregation Funcationï¼‰ï¼šæŽ¥æ”¶å¤šä¸ªè¾“å…¥æ•°æ®è¡Œï¼Œå¹¶äº§ ç”Ÿä¸€ä¸ªè¾“å‡ºæ•°æ®è¡Œã€‚ï¼ˆcountï¼Œmaxï¼‰ UDTFï¼ˆè¡¨æ ¼ç”Ÿæˆå‡½æ•° User-Defined Table Functionï¼‰ï¼šæŽ¥æ”¶ä¸€è¡Œè¾“å…¥ï¼Œè¾“å‡ºå¤šè¡Œï¼ˆexplodeï¼‰ å†…ç½®å‡½æ•° æŸ¥çœ‹å‡½æ•°å‘½ä»¤ æŸ¥çœ‹å†…ç½®å‡½æ•°ï¼š show functions; æ˜¾ç¤ºå‡½æ•°çš„è¯¦ç»†ä¿¡æ¯ï¼š desc function [extended] fun_name;extendedï¼šæ˜¾ç¤ºæ‰©å±•ä¿¡æ¯ åˆ†ç±» å…³ç³»è¿ç®— åˆ†ç±»\1. ç­‰å€¼æ¯”è¾ƒ: =\2. ç­‰å€¼æ¯”è¾ƒ:&lt;=&gt;\3. ä¸ç­‰å€¼æ¯”è¾ƒ: &lt;&gt;å’Œ!=\4. å°äºŽæ¯”è¾ƒ: &lt;\5. å°äºŽç­‰äºŽæ¯”è¾ƒ: &lt;=\6. å¤§äºŽæ¯”è¾ƒ: &gt;\7. å¤§äºŽç­‰äºŽæ¯”è¾ƒ: &gt;=\8. åŒºé—´æ¯”è¾ƒ\9. ç©ºå€¼åˆ¤æ–­: IS NULL\10. éžç©ºåˆ¤æ–­: IS NOT NULL\10. LIKE æ¯”è¾ƒ: LIKE\11. JAVA çš„ LIKE æ“ä½œ: RLIKE\12. REGEXP æ“ä½œ: REGEXP æ•°å­¦è¿ç®— åˆ†ç±»\1. åŠ æ³•æ“ä½œ: +\2. å‡æ³•æ“ä½œ: â€“\3. ä¹˜æ³•æ“ä½œ: *\4. é™¤æ³•æ“ä½œ: /\5. å–ä½™æ“ä½œ: %\6. ä½ä¸Žæ“ä½œ: &amp;\7. ä½æˆ–æ“ä½œ: |\8. ä½å¼‚æˆ–æ“ä½œ: ^9ï¼Žä½å–åæ“ä½œ: ~ é€»è¾‘è¿ç®— åˆ†ç±»\1. é€»è¾‘ä¸Žæ“ä½œ: AND ã€&amp;&amp;\2. é€»è¾‘æˆ–æ“ä½œ: OR ã€||\3. é€»è¾‘éžæ“ä½œ: NOTã€! å¤åˆç±»åž‹æž„é€ å‡½æ•° åˆ†ç±» array ç»“æž„ map ç»“æž„\3. struct ç»“æž„\4. named_struct ç»“æž„\5. create_union å¤åˆç±»åž‹æ“ä½œç¬¦ \1. èŽ·å– array ä¸­çš„å…ƒç´  \2. èŽ·å– map ä¸­çš„å…ƒç´  \3. èŽ·å– struct ä¸­çš„å…ƒç´  é›†åˆæ“ä½œå‡½æ•° \1. map ç±»åž‹å¤§å°ï¼šsize \2. array ç±»åž‹å¤§å°ï¼šsize \3. åˆ¤æ–­å…ƒç´ æ•°ç»„æ˜¯å¦åŒ…å«å…ƒç´ ï¼šarray_contains \4. èŽ·å– map ä¸­æ‰€æœ‰ value é›†åˆ \5. èŽ·å– map ä¸­æ‰€æœ‰ key é›†åˆ \6. æ•°ç»„æŽ’åº \7. èŽ·å–ç´ ç»„æˆ–mapé›†åˆçš„å•ä¸ªå…ƒç´ ï¼ˆk-vå¯¹ï¼‰ï¼šexplode() å½“åŒæ—¶æŸ¥è¯¢ç‚¸è£‚å­—æ®µå’Œæ™®é€šå­—æ®µæ—¶ï¼Œéœ€è¦ä½¿ç”¨æ¨ªå‘è™šæ‹Ÿè§†å›¾ï¼šlateral view å¦‚ï¼šselect name,addr.city from usr_addr lateral view(address) addr as city;è¿™é‡Œä¸€èˆ¬éœ€è¦ç»™ æŸ¥è¯¢ç»“æžœ å’Œ ç»“æžœå­—æ®µ èµ·åˆ«åï¼Œä¸ç„¶æ²¡åŠžæ³•èŽ·å¾—æ¯ä¸ªå­—æ®µï¼Œå¦‚æžœåªæ˜¯æŸ¥è¯¢æ‰€æœ‰çš„è¯å°±ä¸éœ€è¦äº† ç±»åž‹è½¬æ¢å‡½æ•° \1. äºŒè¿›åˆ¶è½¬æ¢ï¼šbinary \2. åŸºç¡€ç±»åž‹ä¹‹é—´å¼ºåˆ¶è½¬æ¢ï¼šcast æ•°å€¼è®¡ç®—å‡½æ•° \1. å–æ•´å‡½æ•°: round \2. æŒ‡å®šç²¾åº¦å–æ•´å‡½æ•°: round \3. å‘ä¸‹å–æ•´å‡½æ•°: floor \4. å‘ä¸Šå–æ•´å‡½æ•°: ceil \5. å‘ä¸Šå–æ•´å‡½æ•°: ceiling \6. å–éšæœºæ•°å‡½æ•°: rand \7. è‡ªç„¶æŒ‡æ•°å‡½æ•°: exp \8. ä»¥ 10 ä¸ºåº•å¯¹æ•°å‡½æ•°: log10 \9. ä»¥ 2 ä¸ºåº•å¯¹æ•°å‡½æ•°: log2 \10. å¯¹æ•°å‡½æ•°: log \11. å¹‚è¿ç®—å‡½æ•°: pow \12. å¹‚è¿ç®—å‡½æ•°: power \13. å¼€å¹³æ–¹å‡½æ•°: sqrt \14. äºŒè¿›åˆ¶å‡½æ•°: bin \15. åå…­è¿›åˆ¶å‡½æ•°: hex \16. åè½¬åå…­è¿›åˆ¶å‡½æ•°: unhex \17. è¿›åˆ¶è½¬æ¢å‡½æ•°: conv \18. ç»å¯¹å€¼å‡½æ•°: abs \19. æ­£å–ä½™å‡½æ•°: pmod \20. æ­£å¼¦å‡½æ•°: sin \21. åæ­£å¼¦å‡½æ•°: asin \22. ä½™å¼¦å‡½æ•°: cos \23. åä½™å¼¦å‡½æ•°: acos \24. positive å‡½æ•°: positive \25. negative å‡½æ•°: negative å­—ç¬¦ä¸²å‡½æ•° \1. å­—ç¬¦ ascii ç å‡½æ•°ï¼šascii \2. base64 å­—ç¬¦ä¸² \3. å­—ç¬¦ä¸²è¿žæŽ¥å‡½æ•°ï¼šconcat \4. å¸¦åˆ†éš”ç¬¦å­—ç¬¦ä¸²è¿žæŽ¥å‡½æ•°ï¼šconcat_ws \5. æ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²çš„å‡½æ•°ï¼šconcat_ws \6. å°æ•°ä½æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²å‡½æ•°ï¼šformat_number \7. å­—ç¬¦ä¸²æˆªå–å‡½æ•°ï¼šsubstr, substringåºå·ä»Ž1å¼€å§‹ï¼Œå¯ä»¥ä¼ è´Ÿæ•°ï¼Œä»£è¡¨ä»Žå³å¼€å§‹ \9. å­—ç¬¦ä¸²æŸ¥æ‰¾å‡½æ•°ï¼šinstræ‰¾åˆ°è¿”å›žä¸€ä¸ªæ­£æ•´æ•°ï¼Œæœªæ‰¾åˆ°è¿”å›ž0 \10. å­—ç¬¦ä¸²é•¿åº¦å‡½æ•°ï¼šlength \11. å­—ç¬¦ä¸²æŸ¥æ‰¾å‡½æ•°ï¼šlocate \12. å­—ç¬¦ä¸²æ ¼å¼åŒ–å‡½æ•°ï¼šprintf \13. å­—ç¬¦ä¸²è½¬æ¢æˆ map å‡½æ•°ï¼šstr_to_map \14. base64 è§£ç å‡½æ•°ï¼šunbase64(string str) \15. å­—ç¬¦ä¸²è½¬å¤§å†™å‡½æ•°ï¼šupper,ucase \16. å­—ç¬¦ä¸²è½¬å°å†™å‡½æ•°ï¼šlower,lcase \17. åŽ»ç©ºæ ¼å‡½æ•°ï¼štrim \18. å·¦è¾¹åŽ»ç©ºæ ¼å‡½æ•°ï¼šltrim \19. å³è¾¹åŽ»ç©ºæ ¼å‡½æ•°ï¼šrtrim \20. æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢å‡½æ•°ï¼šregexp_replace \21. æ­£åˆ™è¡¨è¾¾å¼è§£æžå‡½æ•°ï¼šregexp_extract \22. URL è§£æžå‡½æ•°ï¼šparse_url \23. json è§£æžå‡½æ•°ï¼šget_json_object \24. ç©ºæ ¼å­—ç¬¦ä¸²å‡½æ•°ï¼šspace \25. é‡å¤å­—ç¬¦ä¸²å‡½æ•°ï¼šrepeat \26. å·¦è¡¥è¶³å‡½æ•°ï¼šlpad \27. å³è¡¥è¶³å‡½æ•°ï¼šrpad \28. åˆ†å‰²å­—ç¬¦ä¸²å‡½æ•°: split \29. é›†åˆæŸ¥æ‰¾å‡½æ•°: find_in_set \30. åˆ†è¯å‡½æ•°ï¼šsentences \31. åˆ†è¯åŽç»Ÿè®¡ä¸€èµ·å‡ºçŽ°é¢‘æ¬¡æœ€é«˜çš„ TOP-K \32. åˆ†è¯åŽç»Ÿè®¡ä¸ŽæŒ‡å®šå•è¯ä¸€èµ·å‡ºçŽ°é¢‘æ¬¡æœ€é«˜çš„ TOP-K æ—¥æœŸå‡½æ•° \1. UNIX æ—¶é—´æˆ³è½¬æ—¥æœŸå‡½æ•°: from_unixtime \2. èŽ·å–å½“å‰ UNIX æ—¶é—´æˆ³å‡½æ•°: unix_timestamp \3. æ—¥æœŸè½¬ UNIX æ—¶é—´æˆ³å‡½æ•°: unix_timestamp \4. æŒ‡å®šæ ¼å¼æ—¥æœŸè½¬ UNIX æ—¶é—´æˆ³å‡½æ•°: unix_timestamp \5. æ—¥æœŸæ—¶é—´è½¬æ—¥æœŸå‡½æ•°: to_date \6. æ—¥æœŸè½¬å¹´å‡½æ•°: year \7. æ—¥æœŸè½¬æœˆå‡½æ•°: month \8. æ—¥æœŸè½¬å¤©å‡½æ•°: day \9. æ—¥æœŸè½¬å°æ—¶å‡½æ•°: hour \10. æ—¥æœŸè½¬åˆ†é’Ÿå‡½æ•°: minute \11. æ—¥æœŸè½¬ç§’å‡½æ•°: second \12. æ—¥æœŸè½¬å‘¨å‡½æ•°: weekofyear \13. æ—¥æœŸæ¯”è¾ƒå‡½æ•°: datediff \14. æ—¥æœŸå¢žåŠ å‡½æ•°: date_add \15. æ—¥æœŸå‡å°‘å‡½æ•°: date_sub æ¡ä»¶å‡½æ•° \1. If å‡½æ•°: if( æ¡ä»¶ ï¼Œtrueè¿”å›žå‚æ•°ï¼Œfalseè¿”å›žå‚æ•° ) \2. å½“param1ä¸ä¸ºnullè¿”å›žparam1ï¼Œå¦åˆ™è¿”å›žparam2ï¼šnvl(param1, param2) \2. éžç©ºæŸ¥æ‰¾å‡½æ•°: coalesce \3. æ¡ä»¶åˆ¤æ–­å‡½æ•°ï¼šcase æ··åˆå‡½æ•° åˆ†ç±»\1. è°ƒç”¨ Java å‡½æ•°ï¼šjava_method\2. è°ƒç”¨ Java å‡½æ•°ï¼šreflect\3. å­—ç¬¦ä¸²çš„ hash å€¼ï¼šhash XPath è§£æž XML å‡½æ•° åˆ†ç±»\1. xpath\2. xpath_string\3. xpath_boolean\4. xpath_short, xpath_int, xpath_long\5. xpath_float, xpath_double, xpath_number æ±‡æ€»ç»Ÿè®¡å‡½æ•°ï¼ˆUDAFï¼‰ \1. ä¸ªæ•°ç»Ÿè®¡å‡½æ•°: count \2. æ€»å’Œç»Ÿè®¡å‡½æ•°: sum \3. å¹³å‡å€¼ç»Ÿè®¡å‡½æ•°: avg \4. æœ€å°å€¼ç»Ÿè®¡å‡½æ•°: min \5. æœ€å¤§å€¼ç»Ÿè®¡å‡½æ•°: max \6. éžç©ºé›†åˆæ€»ä½“å˜é‡å‡½æ•°: var_pop \7. éžç©ºé›†åˆæ ·æœ¬å˜é‡å‡½æ•°: var_samp \8. æ€»ä½“æ ‡å‡†åç¦»å‡½æ•°: stddev_pop \9. æ ·æœ¬æ ‡å‡†åç¦»å‡½æ•°: stddev_samp 10ï¼Žä¸­ä½æ•°å‡½æ•°: percentile \11. ä¸­ä½æ•°å‡½æ•°: percentile \12. è¿‘ä¼¼ä¸­ä½æ•°å‡½æ•°: percentile_approx \13. è¿‘ä¼¼ä¸­ä½æ•°å‡½æ•°: percentile_approx \14. ç›´æ–¹å›¾: histogram_numeric \15. é›†åˆåŽ»é‡æ•°ï¼šcollect_set \16. é›†åˆä¸åŽ»é‡å‡½æ•°ï¼šcollect_list è¡¨æ ¼ç”Ÿæˆå‡½æ•° Table-Generating Functions (UDTF) åˆ†ç±»1ï¼Žæ•°ç»„æ‹†åˆ†æˆå¤šè¡Œï¼šexplode(array)2ï¼ŽMap æ‹†åˆ†æˆå¤šè¡Œï¼šexplode(map) è‡ªå®šä¹‰å‡½æ•° \1. éœ€è¦ç»§æ‰¿ org.apache.hadoop.hive.ql.exec.UDF ç±»ï¼Œå®žçŽ°ä¸€ä¸ªæˆ–å¤šä¸ª evaluate() æ–¹æ³• \2. å°†hiveçš„jaråŒ…æ”¾åœ¨hiveçš„classpathè·¯å¾„ä¸‹ï¼Œè¿›å…¥hiveå®¢æˆ·ç«¯ï¼Œæ‰§è¡Œå‘½ä»¤ï¼šadd jar \; \3. æ£€æŸ¥jaråŒ…æ˜¯å¦æ·»åŠ æˆåŠŸï¼Œæ‰§è¡Œå‘½ä»¤ï¼šlist jars; \4. ç»™è‡ªå®šä¹‰å‡½æ•° æ·»åŠ åˆ«åï¼Œå¹¶åœ¨hiveä¸­ æ³¨å†Œ è¯¥å‡½æ•°ï¼Œæ‰§è¡Œå‘½ä»¤ï¼šcreate temporary function myfunc as â€˜ä¸»ç±»å…¨è·¯å¾„åâ€™;myfuncï¼šè‡ªå®šä¹‰å‡½æ•°åˆ«åè¯¥æ–¹æ³•åˆ›å»ºçš„æ˜¯ä¸´æ—¶å‡½æ•°ï¼Œå½“å‰å®¢æˆ·ç«¯å…³é—­å°±æ²¡æœ‰äº†ï¼Œä¸‹æ¬¡é‡å¤ç¬¬3ï¼Œ4æ­¥ï¼›çœŸå®ž ç”Ÿäº§ä¸­å°±æ˜¯ä½¿ç”¨è¯¥æ–¹æ³•ï¼ \5. æŸ¥çœ‹hiveå‡½æ•°åº“æœ‰æ²¡æœ‰æˆåŠŸæ·»åŠ ï¼Œæ‰§è¡Œå‘½ä»¤ï¼šshow functions; \6. è°ƒç”¨å‡½æ•°æ—¶é€šè¿‡å‡½æ•°åå’Œå‚æ•°åˆ—è¡¨ç¡®å®šè°ƒç”¨çš„æ˜¯å…·ä½“å“ªä¸€ä¸ªæ–¹æ³•]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Hive</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Hive</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[i-Hive-1]]></title>
    <url>%2F2018%2F06%2F13%2FHadoop%2F3-Hive%2Fi-Hive-1%2F</url>
    <content type="text"><![CDATA[1. Hive åˆæŽ¢1.1 Hive çš„æ•°æ®å­˜å‚¨ Hiveçš„æ•°æ®å­˜å‚¨åŸºäºŽHadoop HDFS Hiveæ²¡æœ‰ä¸“é—¨çš„æ•°æ®å­˜å‚¨æ ¼å¼ å­˜å‚¨ç»“æž„ä¸»è¦åŒ…æ‹¬ï¼šæ•°æ®åº“ã€æ–‡ä»¶ã€è¡¨ã€è§†å›¾ã€ç´¢å¼• Hiveé»˜è®¤å¯ä»¥ç›´æŽ¥åŠ è½½æ–‡æœ¬æ–‡ä»¶ï¼ˆTextFileï¼‰ï¼Œè¿˜æ”¯æŒSequenceFileã€RCFile åˆ›å»ºè¡¨æ—¶ï¼ŒæŒ‡å®šHiveæ•°æ®çš„åˆ—åˆ†éš”ç¬¦ä¸Žè¡Œåˆ†éš”ç¬¦ï¼ŒHiveå³å¯è§£æžæ•°æ® 1.2 Hiveçš„ç³»ç»Ÿæž¶æž„ ç”¨æˆ·æŽ¥å£ï¼ŒåŒ…æ‹¬ CLIï¼ŒJDBC/ODBCï¼ŒWebUI å…ƒæ•°æ®å­˜å‚¨ï¼Œé€šå¸¸æ˜¯å­˜å‚¨åœ¨å…³ç³»æ•°æ®åº“å¦‚ mysql, derby ä¸­ è§£é‡Šå™¨ã€ç¼–è¯‘å™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨ Hadoopï¼šç”¨ HDFS è¿›è¡Œå­˜å‚¨ï¼Œåˆ©ç”¨ MapReduce è¿›è¡Œè®¡ç®— 1.3 Hiveçš„ç³»ç»Ÿæž¶æž„ ç”¨æˆ·æŽ¥å£ä¸»è¦æœ‰ä¸‰ä¸ªï¼šCLIï¼ŒJDBC/ODBCå’Œ WebUI CLIï¼Œå³Shellå‘½ä»¤è¡Œ JDBC/ODBC æ˜¯ Hive çš„Javaï¼Œä¸Žä½¿ç”¨ä¼ ç»Ÿæ•°æ®åº“JDBCçš„æ–¹å¼ç±»ä¼¼ WebGUIæ˜¯é€šè¿‡æµè§ˆå™¨è®¿é—® Hive Hive å°†å…ƒæ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­(metastore)ï¼Œç›®å‰åªæ”¯æŒ mysqlã€derbyã€‚Hive ä¸­çš„å…ƒæ•°æ®åŒ…æ‹¬è¡¨çš„åå­—ï¼Œè¡¨çš„åˆ—å’Œåˆ†åŒºåŠå…¶å±žæ€§ï¼Œè¡¨çš„å±žæ€§ï¼ˆæ˜¯å¦ä¸ºå¤–éƒ¨è¡¨ç­‰ï¼‰ï¼Œè¡¨çš„æ•°æ®æ‰€åœ¨ç›®å½•ç­‰ è§£é‡Šå™¨ã€ç¼–è¯‘å™¨ã€ä¼˜åŒ–å™¨å®Œæˆ HQL æŸ¥è¯¢è¯­å¥ä»Žè¯æ³•åˆ†æžã€è¯­æ³•åˆ†æžã€ç¼–è¯‘ã€ä¼˜åŒ–ä»¥åŠæŸ¥è¯¢è®¡åˆ’ï¼ˆplanï¼‰çš„ç”Ÿæˆã€‚ç”Ÿæˆçš„æŸ¥è¯¢è®¡åˆ’å­˜å‚¨åœ¨ HDFS ä¸­ï¼Œå¹¶åœ¨éšåŽç”± MapReduce è°ƒç”¨æ‰§è¡Œ Hive çš„æ•°æ®å­˜å‚¨åœ¨ HDFS ä¸­ï¼Œå¤§éƒ¨åˆ†çš„æŸ¥è¯¢ç”± MapReduce å®Œæˆï¼ˆåŒ…å« çš„æŸ¥è¯¢ï¼Œæ¯”å¦‚ select from table ä¸ä¼šç”Ÿæˆ MapRedcue ä»»åŠ¡ 1.4 Hiveçš„metastore metastoreæ˜¯hiveå…ƒæ•°æ®çš„é›†ä¸­å­˜æ”¾åœ°ã€‚ metastoreé»˜è®¤ä½¿ç”¨å†…åµŒçš„derbyæ•°æ®åº“ä½œä¸ºå­˜å‚¨å¼•æ“Ž Derbyå¼•æ“Žçš„ç¼ºç‚¹ï¼šä¸€æ¬¡åªèƒ½æ‰“å¼€ä¸€ä¸ªä¼šè¯ ä½¿ç”¨Mysqlä½œä¸ºå¤–ç½®å­˜å‚¨å¼•æ“Žï¼Œå¤šç”¨æˆ·åŒæ—¶è®¿é—® 1.5 Hive å’Œ Hadoop çš„è°ƒç”¨å…³ç³» 1ã€æäº¤sql äº¤ç»™é©±åŠ¨2ã€é©±åŠ¨ç¼–è¯‘ è§£æžç›¸å…³çš„å­—æ®µè¡¨ä¿¡æ¯3ã€åŽ»metastoreæŸ¥è¯¢ç›¸å…³çš„ä¿¡æ¯ è¿”å›žå­—æ®µè¡¨ä¿¡æ¯4ã€ç¼–è¯‘è¿”å›žä¿¡æ¯ å‘ç»™é©±åŠ¨5ã€é©±åŠ¨å‘é€ä¸€ä¸ªæ‰§è¡Œè®¡åˆ’ äº¤ç»™æ‰§è¡Œå¼•æ“Ž6.1ã€DDLs å¯¹æ•°æ®åº“è¡¨çš„æ“ä½œçš„, ç›´æŽ¥å’Œmetastoreäº¤äº’,create table t1(name string); 6.2ã€å®Œæˆjobè¿”å›žæ•°æ®ä¿¡æ¯ã€æ‰¾namenodeæŸ¥æ•°æ®6.3ã€namenodeäº¤äº’select count(1) from t1;7ã€è¿”å›žç»“æžœä¿¡æ¯é›† 1.6 Hive å‚æ•°é…ç½®ä½¿ç”¨ å‘½åç©ºé—´ ä½¿ç”¨æƒé™ æè¿° hivevar å¯è¯»å†™ $ hive -d name=zhangsan; hiveconf å¯è¯»å†™ \$ hive â€“hiveconf hive.cli.print.current.db=true; $ hive â€“hiveconf hive.cli.print.header=true; system å¯è¯»å†™ javaå®šä¹‰çš„é…ç½®å±žæ€§ï¼Œå¦‚system:user.name env åªè¯» shellçŽ¯å¢ƒå˜é‡ï¼Œå¦‚env:USER hivevar 1234567# ä½¿ç”¨åœºæ™¯: èµ·åˆ«åhive -d name=zhangsan #ä¼ å‚&gt; create table t2(name string,$&#123;name&#125; string); #å–å‚æ•°&gt; desc t2;---name stringzhangsan string hiveconf : 12345678910# æ˜¾ç¤ºå½“å‰æ•°æ®åº“åç§°[ap@cs2]~% hive --hiveconf hive.cli.print.current.db=true;hive (default)&gt; create database mydb;hive (default)&gt; use mydb;hive (mydb)&gt; # æ˜¾ç¤ºè¡¨å¤´(å­—æ®µå)hive --hiveconf hive.cli.print.header=true;select * from t2;t2.name t2.zhangsan 1.7 Hive çš„è„šæœ¬æ‰§è¡Œ Hive -e â€œxx â€ e å°±æ˜¯ edit, åœ¨ç»ˆç«¯æ‰“å°è¾“å‡º Hive -e â€œshow tablesâ€ &gt;&gt; a.txt å¯ä»¥æŠŠæ‰§è¡Œç»“æžœé‡å®šå‘åˆ°æ–‡ä»¶ä¸­ Hive -S -e â€œshow tablesâ€ &gt;&gt; a.txt -S : silence å®‰é™çš„æ‰§è¡Œ hive -f file hive -f hql , hql æ˜¯æ–‡ä»¶, æ‰§è¡Œæ–‡ä»¶ æ‰§è¡Œå®Œäº†ä¹‹åŽ, å°±ç¦»å¼€ hive å‘½ä»¤è¡Œ hive -i /home/ap/hive-init.sql æ‰§è¡Œå®Œäº†,è¿˜åœ¨æŽ§åˆ¶å°, å¯ä»¥ç»§ç»­æ“ä½œ hive&gt;source file source + æ–‡ä»¶å : ç›´æŽ¥æ‰§è¡Œå½“å‰ç›®å½•æ–‡ä»¶ source /home/ap/xx.sql; 1.8 hiveä¸Žä¾èµ–çŽ¯å¢ƒçš„äº¤äº’ ä¸Žlinuxäº¤äº’å‘½ä»¤ ï¼ !ls !pwd ä¸Žhdfsäº¤äº’å‘½ä»¤ dfs -ls / dfs -mkdir /hive hive (default)&gt; dfs -rm -r /user/hive/warehouse/t5; beeline ä¸Ž linux &amp; hdfs äº¤äº’ !help æŸ¥çœ‹å¸®åŠ© 1.9 Hive çš„ JDBC æ¨¡å¼ JAVA APIäº¤äº’æ‰§è¡Œæ–¹å¼ hive è¿œç¨‹æœåŠ¡ (ç«¯å£å·1000 0) å¯åŠ¨æ–¹å¼ hive --service hiveserver2 org.apache.hive.jdbc.HiveDriver åœ¨javaä»£ç ä¸­è°ƒç”¨hiveçš„JDBCå»ºç«‹è¿žæŽ¥ ç”¨ beeline è¿žæŽ¥ æ–¹å¼1: ç›´æŽ¥ç™»å½• æ³¨æ„: è¿™é‡Œçš„cs2æ˜¯æŒ‡çš„æ•°æ®åº“æ‰€åœ¨çš„æœåŠ¡å™¨, å¦‚æžœmysql å®‰è£…åœ¨ cs2ä¸Š, é‚£ä¹ˆä¸ç®¡åœ¨å“ªå°æœºå™¨ä¸Šç™»å½•beeline , éƒ½è¿™æ ·è¾“å…¥å°±è¡Œäº† beeline -u jdbc:hive2://cs2:10000 -n ap æ–¹å¼2: è¾“å…¥ç”¨æˆ·åå¯†ç ç™»å½• !connect jdbc:hive2://cs2:10000 beelineæ³¨æ„ç‚¹: ä½¿ç”¨ beeline è¿žæŽ¥æ—¶, è²Œä¼¼æ— æ³•ä¸Ž Linux ç›®å½•äº¤äº’ å½“å‰ç›®å½•åœ¨/home/ap/apps/apache-hive-2.3.2-bin/bin/ä¸‹ è¦ä¼ æ–‡ä»¶çš„è¯, è¦ä½¿ç”¨å…¨è·¯å¾„ 1.10 SETå‘½ä»¤ä½¿ç”¨ Hive æŽ§åˆ¶å°set å‘½ä»¤ set; set -v; æ˜¾ç¤ºæ‰€æœ‰çš„çŽ¯å¢ƒå˜é‡ set hive.cli.print.current.db=true; set hive.cli.print.header=true; set hive.metastore.warehouse.dir=/hive; hiveå‚æ•°åˆå§‹åŒ–é…ç½®setå‘½ä»¤: ~/.hiverc åˆ›å»ºæ­¤æ–‡ä»¶, åœ¨æ­¤æ–‡ä»¶ä¸­é…ç½®åˆå§‹åŒ–å‘½ä»¤ è¡¥å……ï¼šhiveåŽ†å²æ“ä½œå‘½ä»¤é›†~/.hivehistory 2. Hiveæ•°æ®ç±»åž‹2.1 åŸºæœ¬æ•°æ®ç±»åž‹ 2.2 å¤åˆæ•°æ®ç±»åž‹ åˆ›å»ºå­¦ç”Ÿè¡¨ 123456CREATE TABLE student( id INT, name STRING, favors ARRAY\&lt;STRING&gt;, scores MAP&lt;STRING, FLOAT&gt;); é»˜è®¤åˆ†éš”ç¬¦ æè¿° è¯­å¥ \n åˆ†éš”è¡Œ LINES TERMINATED BY â€˜\tâ€™ ^A åˆ†éš”å­—æ®µ(åˆ—)ï¼Œæ˜¾ç¤ºç¼–ç ä½¿ç”¨\001 FIELDS TERMINATED BY â€˜\001â€™ ^B åˆ†éš”å¤åˆç±»åž‹ä¸­çš„å…ƒç´ ï¼Œæ˜¾ç¤ºç¼–ç ä½¿ç”¨\002 COLLECTION ITEMS TERMINATED BY â€˜\002â€™ ^C åˆ†éš”mapå…ƒç´ çš„keyå’Œvalueï¼Œæ˜¾ç¤ºç¼–ç ä½¿ç”¨\003 MAP KEYS TERMINATED BY â€˜\003â€™ 2.2.1. Struct ä½¿ç”¨Structså†…éƒ¨çš„æ•°æ®å¯ä»¥é€šè¿‡DOTï¼ˆ.ï¼‰æ¥å­˜å–ï¼Œä¾‹å¦‚ï¼Œè¡¨ä¸­ä¸€åˆ—cçš„ç±»åž‹ä¸ºSTRUCT{a INT; b INT}ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡c.aæ¥è®¿é—®åŸŸa 123456789101112131415161718192021222324252627282930# æ•°æ®1001,zhangsan:241002,lisi:281003,wangwu:25# 1.åˆ›å»ºè¡¨hive&gt; create table student_test(id INT, info struct&lt;name:STRING, age:INT&gt;)ROW FORMAT DELIMITED FIELDS TERMINATED BY ','COLLECTION ITEMS TERMINATED BY ':';# 2.åŠ è½½è¡¨hive&gt; load data local inpath "student_test" into table student_test;# 3.é¡ºä¾¿è®¾ç½® æ˜¾ç¤ºè¡¨å¤´,å’Œå½“å‰æ•°æ®åº“hive&gt; set hive.cli.print.header=true;hive&gt; set hive.cli.print.current.db=true;# 4. å±•ç¤ºæ‰€æœ‰çš„hive (default)&gt; select * from student_test;---student_test.id student_test.info1001 &#123;"name":"zhangsan","age":24&#125;1002 &#123;"name":"lisi","age":28&#125;1003 &#123;"name":"wangwu","age":25&#125;---# Struct -ç»“æž„ä½“-ä½¿ç”¨ . hive (default)&gt; select id,info.name,info.age from student_test;id name age1001 zhangsan 241002 lisi 281003 wangwu 25 2.2.2. Array ä½¿ç”¨Arrayä¸­çš„æ•°æ®ä¸ºç›¸åŒç±»åž‹ï¼Œä¾‹å¦‚ï¼Œå‡å¦‚array Aä¸­å…ƒç´ [&#39;a&#39;,&#39;b&#39;,&#39;câ€™]ï¼Œåˆ™A[1]çš„å€¼ä¸ºâ€™bâ€™ 123456789101112131415161718192021222324# åŽŸå§‹æ•°æ®zhangsan,24:25:27:37lisi,28:39:23:43wangwu,25:23:02:54# åˆ›å»ºè¡¨hive (default)&gt; create table class_test(name string,student_id_list array&lt;int&gt;) row format delimited fields terminated by ',' collection items terminated by ':';# åŠ è½½è¡¨hive (default)&gt; load data local inpath "class_test" into table class_test;# æŸ¥çœ‹è¡¨hive (default)&gt; select * from class_test;OKclass_test.name class_test.student_id_listzhangsan [24,25,27,37]lisi [28,39,23,43]wangwu [25,23,2,54]# æŸ¥çœ‹æ•°æ®ä¸­æŸä¸ªå…ƒç´ hive (default)&gt; select name, student_id_list[0] from class_test where name='zhangsan';OKname _c1zhangsan 24 2.2.3. Map ä½¿ç”¨è®¿é—®æŒ‡å®šåŸŸå¯ä»¥é€šè¿‡[â€œæŒ‡å®šåŸŸåç§°â€]è¿›è¡Œï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªMap MåŒ…å«äº†ä¸€ä¸ªgroup-&gt;gidçš„kvå¯¹ï¼Œgidçš„å€¼å¯ä»¥é€šè¿‡M[â€˜groupâ€™]æ¥èŽ·å– 1234567891011121314151617181920212223242526272829303132333435# åŽŸå§‹æ•°æ®1001 job:80,team:60,person:701002 job:60,team:80,person:801003 job:90,team:70,person:100# åˆ›å»ºè¡¨hive (default)&gt; create table employee(id string,perf map&lt;string,int&gt;) row format delimited fields terminated by '\t' collection items terminated by ',' map keys terminated by ':';# å¯¼å…¥hive (default)&gt; load data local inpath "employee_data" into table employee;# æŸ¥çœ‹hive (default)&gt; select * from employee;---employee.id employee.perf1001 &#123;"job":80,"team":60,"person":70&#125;1002 &#123;"job":60,"team":80,"person":80&#125;1003 &#123;"job":90,"team":70,"person":100&#125;Time taken: 0.228 seconds, Fetched: 3 row(s)# æŸ¥çœ‹å•ä¸ªhive (default)&gt; select id,perf['job'],perf['team'],perf['person'] from employee;OKid _c1 _c2 _c31001 80 60 701002 60 80 801003 90 70 100# æ˜¾ç¤ºåˆ«åhive (default)&gt; select id,perf['job'] as job,perf['team'] as team,perf['person'] as person from employee;OKid job team person1001 80 60 701002 60 80 801003 90 70 100 3. DDL , DML3.1 DDL3.1.1 æ•°æ®åº“å®šä¹‰ é»˜è®¤æ•°æ®åº“â€defaultâ€ ä½¿ç”¨æŸä¸ªæ•°æ®åº“ use &lt;æ•°æ®åº“å&gt; åˆ›å»ºä¸€ä¸ªæ–°åº“ 12345678CREATE DATABASE [IF NOT EXISTS] mydb [LOCATION] '/.......' [COMMENT] '....â€™;hive&gt;SHOW DATABASES;hive&gt;DESCRIBE DATABASE [extended] mydb;hive&gt;DROP DATABASE [IF EXISTS] mydb [CASCADE]; åˆ›å»º create database db1; åˆ é™¤ drop database if exists db1; çº§è”åˆ é™¤ drop database if exists db1 cascade; 3.1.2 è¡¨å®šä¹‰/ä¿®æ”¹ åˆ›å»ºè¡¨ hive&gt;CREATE TABLE IF NOT EXISTS t1(â€¦) [COMMENT â€˜â€¦.â€™] [LOCATION â€˜â€¦â€™] hive (default)&gt; create table t4(name string,age int) row format delimited fields terminated by &quot;\tâ€; hive&gt; SHOW TABLES in mydb; show tables in mydb â€˜â€™class*â€œ : æŸ¥çœ‹ä»¥ mydb åº“ä¸­, ä»¥ class å¼€å¤´çš„è¡¨ hive&gt;CREATE TABLE t2 LIKE t1; å¤åˆ¶è¡¨ åªä¼šå¤åˆ¶è¡¨ç»“æž„ hive (default)&gt; create table t2 like t1; hive (mydb)&gt; create table t3 like default.employee; å¤åˆ¶å…¶å®ƒåº“çš„è¡¨ hive&gt;DESCRIBE t2; desc t2; # æ•ˆæžœä¸€æ ·çš„ desc extended t1; # æŸ¥çœ‹æ›´è¯¦ç»†çš„è¡¨ä¿¡æ¯ hive (default)&gt; desc formatted t1; # æ ¼å¼åŒ–æŸ¥çœ‹è¡¨çš„è¯¦ç»†ä¿¡æ¯ drop table xxx; åˆ é™¤è¡¨ æŸ¥çœ‹å»ºè¡¨è¯­å¥ show create table t_table; ä¿®æ”¹è¡¨ é‡å‘½åè¡¨ ALTER TABLE table_name RENAME TO new_table_name å¢žåŠ /åˆ é™¤ åˆ†åŒº alter table student_p add partition(part=&#39;a&#39;) partition(part=&#39;b&#39;); ä¸¤ä¸ª partitionä¸­æ²¡æœ‰â€™,â€™ alter table student drop partition(stat_data=â€˜ffffâ€™), partition(part=â€˜aâ€™),partiton(part=â€˜bâ€™); ä¸¤ä¸ª partitionä¸­æœ‰â€™,â€™ å¢žåŠ /æ›´æ–° åˆ— ALTER TABLE table_name ADD|REPLACE COLUMNS (col_name data_type [COMMENT col_comment], ...) æ³¨ï¼šADDæ˜¯ä»£è¡¨æ–°å¢žä¸€å­—æ®µï¼Œå­—æ®µä½ç½®åœ¨æ‰€æœ‰åˆ—åŽé¢(partitionåˆ—å‰)ï¼ŒREPLACEåˆ™æ˜¯è¡¨ç¤ºæ›¿æ¢è¡¨ä¸­æ‰€æœ‰å­—æ®µã€‚ alter table student add columns (name1 string); ALTER TABLE table_name CHANGE c_name new_c_name new_c_type [FIRST | AFTER c_name] 3.1.3 åˆ—å®šä¹‰ ä¿®æ”¹åˆ—çš„åç§°ã€ç±»åž‹ã€ä½ç½®ã€æ³¨é‡Š ALTER TABLE t3 CHANGE COLUMN old_name new_name String COMMENT &#39;...&#39; AFTER column2; 123456789# ä¿®æ”¹åˆ—åhive (default)&gt; alter table t1 change column name username string comment 'new name';# æŸ¥çœ‹è¡¨hive (default)&gt; desc t1;---col_name data_type commentusername string new nameage int--- å¢žåŠ åˆ— hive&gt; ALTER TABLE t3 ADD COLUMNS(gender int); 1234567891011121314# æŸ¥çœ‹è¡¨ç»“æž„hive (default)&gt; desc t3;---col_name data_type commentname string---# æ·»åŠ åˆ—hive (default)&gt; alter table t3 add columns(gender int);---hive (default)&gt; desc t3;---col_name data_type commentname stringgender int åˆ é™¤åˆ— replace éžå¸¸ä¸å»ºè®®ä½¿ç”¨, ä¼šé€ æˆæ•°æ®é”™ä¹±, ä¸€èˆ¬é‡‡å–é‡æ–°åˆ›å»ºä¸€å¼ è¡¨çš„æ–¹å¼. 3.1.4 æ˜¾ç¤ºå‘½ä»¤ show tables show databases show partitions show functions desc extended t_name; desc formatted table_name; 3.2 DML3.2.1 Load è¯­æ³•ç»“æž„ LOAD DATA [LOCAL] INPATH &#39;filepath&#39; [OVERWRITE] INTO TABLE tablename [PARTITION (partcol1=val1, partcol2=val2 ...)] è¯´æ˜Žï¼š Load æ“ä½œåªæ˜¯å•çº¯çš„å¤åˆ¶/ç§»åŠ¨æ“ä½œï¼Œå°†æ•°æ®æ–‡ä»¶ç§»åŠ¨åˆ° Hive è¡¨å¯¹åº”çš„ä½ç½®ã€‚ filepathï¼š ç›¸å¯¹è·¯å¾„ï¼Œä¾‹å¦‚ï¼šproject/data1 ç»å¯¹è·¯å¾„ï¼Œä¾‹å¦‚ï¼š/user/hive/project/data1 åŒ…å«æ¨¡å¼çš„å®Œæ•´ URIï¼Œä¾‹å¦‚ï¼š hdfs://namenode:9000/user/hive/project/data1 LOCALå…³é”®å­— å¦‚æžœæŒ‡å®šäº† LOCALï¼Œ load å‘½ä»¤ä¼šåŽ»æŸ¥æ‰¾æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„ filepathã€‚ å¦‚æžœæ²¡æœ‰æŒ‡å®š LOCAL å…³é”®å­—ï¼Œåˆ™æ ¹æ®inpathä¸­çš„uriæŸ¥æ‰¾æ–‡ä»¶ OVERWRITE å…³é”®å­— å¦‚æžœä½¿ç”¨äº† OVERWRITE å…³é”®å­—ï¼Œåˆ™ç›®æ ‡è¡¨ï¼ˆæˆ–è€…åˆ†åŒºï¼‰ä¸­çš„å†…å®¹ä¼šè¢«åˆ é™¤ï¼Œç„¶åŽå†å°† filepath æŒ‡å‘çš„æ–‡ä»¶/ç›®å½•ä¸­çš„å†…å®¹æ·»åŠ åˆ°è¡¨/åˆ†åŒºä¸­ã€‚ å¦‚æžœç›®æ ‡è¡¨ï¼ˆåˆ†åŒºï¼‰å·²ç»æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æ–‡ä»¶åå’Œ filepath ä¸­çš„æ–‡ä»¶åå†²çªï¼Œé‚£ä¹ˆçŽ°æœ‰çš„æ–‡ä»¶ä¼šè¢«æ–°æ–‡ä»¶æ‰€æ›¿ä»£ã€‚ 3.2.2 Insertè¯­æ³•ç»“æž„ æ™®é€šæ’å…¥ INSERT OVERWRITE TABLE tablename1 [PARTITION (partcol1=val1, partcol2=val2 â€¦)] select_statement1 FROM from_statement Multiple inserts: 12345678910FROM from_statement [INSERT OVERWRITE TABLE tablename1 [PARTITION (partcol1=val1, partcol2=val2 ...)] select_statement1 ][INSERT OVERWRITE TABLE tablename2 [PARTITION ...] select_statement2] ...# å¤šé‡æ’å…¥ä¸¾ä¾‹from studentinsert into table student_p partition(part='a')select * where id&lt;95011insert into table student_p partition(part='b')select * where id&gt;95011; Dynamic partition inserts: ä¸æŒ‡å®šåˆ†åŒºå­—æ®µ, æŒ‰ç…§ from è¡¨çš„åˆ†åŒºå­—æ®µæ’å…¥ INSERT OVERWRITE TABLE tablename PARTITION (partcol1, partcol2 ...) select_statement FROM from_statement å¯¼å‡ºè¡¨æ•°æ®è¯­æ³•ç»“æž„ INSERT OVERWRITE [LOCAL] DIRECTORY directory1 SELECT ... FROM ... 123456789101112131415# å¯¼å‡ºåˆ°æœ¬åœ°insert overwrite local directory '/home/ap/test/stucent1'select * from student1;--------------------ä¾‹å­:'æŸ¥è¯¢å­¦ç”Ÿä¿¡æ¯ï¼ŒæŒ‰æ€§åˆ«åˆ†åŒºï¼Œåœ¨åˆ†åŒºå†…æŒ‰å¹´é¾„æœ‰åº'0: jdbc:hive2://cs2:10000&gt; set mapred.reduce.tasks=2;No rows affected (0.015 seconds)0: jdbc:hive2://cs2:10000&gt; insert overwrite local directory '/home/ap/ihiveout'. . . . . . . . . . . . .&gt; select * from student distribute by Sex sort by Sage;--------------------# å¯¼å‡ºåˆ° HDFS (ä»…ä»…æ˜¯å°‘äº†ä¸€ä¸ª local)insert overwrite directory '/test/stucent1'select * from student1; multiple inserts: 123FROM from_statementINSERT OVERWRITE [LOCAL] DIRECTORY directory1 select_statement1[INSERT OVERWRITE [LOCAL] DIRECTORY directory2 select_statement2] ... 4. Hiveçš„æ•°æ®æ¨¡åž‹4.1 ç®¡ç†è¡¨ - åˆç§°ä¸ºå†…éƒ¨è¡¨, å—æŽ§è¡¨åŸºæœ¬æ“ä½œ åˆ›å»ºæ•°æ®æ–‡ä»¶inner_table.dat åˆ›å»ºè¡¨ hive&gt;create table inner_table (key string); åŠ è½½æ•°æ® åŠ è½½æœ¬åœ°æ•°æ® hive&gt;load data local inpath &#39;/root/inner_table.dat&#39; into table inner_table; åŠ è½½HDFS ä¸Šæ•°æ® hive&gt;load data inpath â€˜xxxâ€™ into table xxx; åŒºåˆ« åŠ è½½ hdfs ä¸Šçš„æ•°æ®æ²¡æœ‰ local åŠ è½½æœ¬åœ°æ•°æ®æ˜¯ copy ä¸€ä»½, åŠ è½½ hdfs ä¸Šçš„æ•°æ®æ˜¯ç›´æŽ¥ç§»åŠ¨æ•°æ®åˆ°åŠ è½½çš„è¡¨ç›®å½•ä¸‹â€“ mv æŸ¥çœ‹æ•°æ® select * from inner_table select count(*) from inner_table åˆ é™¤è¡¨ drop table inner_table æ¸…ç©ºè¡¨ truncate table table_name; æ³¨æ„: å¦‚æžœåˆ›å»ºè¡¨çš„æ—¶å€™, åªæŒ‡å®šäº†ç›®å½•, æ²¡æœ‰æŒ‡å®šè¡¨å, åˆ é™¤è¡¨çš„æ—¶å€™, ä¼šæŠŠè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰è¡¨å…¨éƒ¨åˆ æŽ‰ hive (mydb)&gt; create table t2(id int)location &#39;/home/t2&#39;; å†…éƒ¨è¡¨è§£é‡Š ç®¡ç†è¡¨ï¼Œä¹Ÿç§°ä½œå†…éƒ¨è¡¨,å—æŽ§è¡¨ æ‰€æœ‰çš„ Table æ•°æ®ï¼ˆä¸åŒ…æ‹¬ External Tableï¼‰éƒ½ä¿å­˜åœ¨warehouseè¿™ä¸ªç›®å½•ä¸­ã€‚ åˆ é™¤è¡¨æ—¶ï¼Œå…ƒæ•°æ®ä¸Žæ•°æ®éƒ½ä¼šè¢«åˆ é™¤ åˆ›å»ºè¿‡ç¨‹å’Œæ•°æ®åŠ è½½è¿‡ç¨‹ï¼ˆè¿™ä¸¤ä¸ªè¿‡ç¨‹å¯ä»¥åœ¨åŒä¸€ä¸ªè¯­å¥ä¸­å®Œæˆï¼‰ï¼Œåœ¨åŠ è½½æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå®žé™…æ•°æ®ä¼šè¢«ç§»åŠ¨åˆ°æ•°æ®ä»“åº“ç›®å½•ä¸­ï¼›ä¹‹åŽå¯¹æ•°æ®å¯¹è®¿é—®å°†ä¼šç›´æŽ¥åœ¨æ•°æ®ä»“åº“ç›®å½•ä¸­å®Œæˆã€‚åˆ é™¤è¡¨æ—¶ï¼Œè¡¨ä¸­çš„æ•°æ®å’Œå…ƒæ•°æ®å°†ä¼šè¢«åŒæ—¶åˆ é™¤ å†…éƒ¨è¡¨è½¬ä¸ºå¤–éƒ¨è¡¨, å¤–éƒ¨è¡¨è½¬ä¸ºå†…éƒ¨è¡¨ 123456789101112131415161718192021222324252627hive (mydb)&gt; create table t1(id int);# manage_table è½¬æ¢ä¸º å¤–éƒ¨è¡¨ external_table ## æ³¨æ„: ä¿®æ”¹ä¸ºå¤–éƒ¨è¡¨æ—¶, åŽé¢2ä¸ªéƒ½è¦å¤§å†™hive (mydb)&gt; alter table t1 set tblproperties('EXTERNAL'='TRUE');## ä¿®æ”¹ä¸ºå†…éƒ¨è¡¨hive (mydb)&gt; alter table t1 set tblproperties('EXTERNAL'='FALSE');# æŸ¥çœ‹t1è¯¦ç»†ä¿¡æ¯desc formatted t1;---Location: hdfs://cs1:9000/user/hive/warehouse/mydb.db/t1Table Type: EXTERNAL_TABLE-- # åˆ é™¤t1hive (mydb)&gt; drop table t1;# æ­¤æ—¶å†æŸ¥çœ‹, å·²ç»æ²¡äº†hive (mydb)&gt; show tables;OKtab_name# ä½†æ˜¯æŸ¥çœ‹hdfs è·¯å¾„ä¼šå‘çŽ°è¿˜åœ¨, å› ä¸ºæ­¤è¡¨çŽ°åœ¨å·²ç»æ˜¯å¤–éƒ¨è¡¨, åˆ é™¤ä¸ä¼šåˆ é™¤æ•°æ®dfs -ls /user/hive/warehouse/mydb.db/t1# å¦‚æžœæ­¤æ—¶å†åˆ›å»ºä¸€ä¸ªæ–°è¡¨ t1, è¡¨ç»“æž„ä¸€æ ·, åˆ™æ•°æ®ä¼šè‡ªåŠ¨åŠ è½½ 4.2 â€» å¤–éƒ¨è¡¨4.2.1åŸºæœ¬æ“ä½œ åˆ›å»ºæ•°æ®æ–‡ä»¶external_table.dat åˆ›å»ºè¡¨ hive&gt;create external table external_table1 (key string) ROW FORMAT DELIMITED FIELDS TERMINATED BY &#39;\t&#39; location &#39;/home/externalâ€™; åœ¨HDFSåˆ›å»ºç›®å½•/home/external #hadoop fs -put /home/external_table.dat /home/external åœ¨å·¥ä½œä¸­, ä¸€èˆ¬éƒ½è¿™æ ·ä½¿ç”¨, æŠŠæ•°æ®ä¸Šä¼ åˆ° hdfs ä¸­ åŠ è½½æ•°æ® LOAD DATA &#39;/home/external_table1.dat&#39; INTO TABLE external_table1; æŸ¥çœ‹æ•°æ® select * from external_table select count(*) from external_table åˆ é™¤è¡¨ drop table external_table 4.2.2 å¤–éƒ¨è¡¨è§£é‡Š åŒ…å«External çš„è¡¨å«å¤–éƒ¨è¡¨ åˆ é™¤å¤–éƒ¨è¡¨åªåˆ é™¤metastoreçš„å…ƒæ•°æ®ï¼Œä¸åˆ é™¤hdfsä¸­çš„è¡¨æ•°æ® å¤–éƒ¨è¡¨ åªæœ‰ä¸€ä¸ªè¿‡ç¨‹ï¼ŒåŠ è½½æ•°æ®å’Œåˆ›å»ºè¡¨åŒæ—¶å®Œæˆï¼Œå¹¶ä¸ä¼šç§»åŠ¨åˆ°æ•°æ®ä»“åº“ç›®å½•ä¸­ï¼Œåªæ˜¯ä¸Žå¤–éƒ¨æ•°æ®å»ºç«‹ä¸€ä¸ªé“¾æŽ¥ã€‚å½“åˆ é™¤ä¸€ä¸ª å¤–éƒ¨è¡¨ æ—¶ï¼Œä»…åˆ é™¤è¯¥é“¾æŽ¥ æŒ‡å‘å·²ç»åœ¨ HDFS ä¸­å­˜åœ¨çš„æ•°æ®ï¼Œå¯ä»¥åˆ›å»º Partition å®ƒå’Œ å†…éƒ¨è¡¨ åœ¨å…ƒæ•°æ®çš„ç»„ç»‡ä¸Šæ˜¯ç›¸åŒçš„ï¼Œè€Œå®žé™…æ•°æ®çš„å­˜å‚¨åˆ™æœ‰è¾ƒå¤§çš„å·®å¼‚ 4.2.3 å¤–éƒ¨è¡¨è¯­æ³•123456789101112CREATE EXTERNAL TABLE page_view( viewTime INT, userid BIGINT, page_url STRING, referrer_url STRING, ip STRING COMMENT 'IP Address of the User', country STRING COMMENT 'country of originationâ€˜) COMMENT 'This is the staging page view table' ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS TEXTFILE LOCATION 'hdfs://centos:9000/user/data/staging/page_view'; 4.2.4å¤–éƒ¨è¡¨æ³¨æ„ç‚¹: å…ˆåˆ›å»ºå¤–éƒ¨è¡¨/å†…éƒ¨è¡¨, è¡¨åä¸ºt3, å†å¾€t3ä¼ å¯¹åº”å­—æ®µçš„æ•°æ®, å°±å¯ä»¥ç›´æŽ¥ select æ•°æ®äº† åˆ é™¤å¤–éƒ¨è¡¨ä¹‹åŽ, åŽŸæœ¬æ•°æ®ä¸ä¼šåˆ é™¤, æ­¤æ—¶åœ¨ç›¸åŒçš„çˆ¶è·¯å¾„åˆ›å»ºä¸Žè¢«åˆ é™¤è¡¨å­—æ®µç›¸åŒ&amp;åç§°ç›¸åŒçš„å†…éƒ¨/å¤–éƒ¨è¡¨, æ•°æ®ä¹Ÿä¼šç›´æŽ¥åŠ è½½ å†çœ‹ä¸€ä¸ªæ“ä½œ 12345678910# åœ¨ mydb.db åº“ä¸‹åˆ›å»ºä¸€ä¸ªå¤–éƒ¨è¡¨ t5, æŒ‡å®šè·¯å¾„ä¸º '/external/t5'# æ­¤æ—¶åœ¨ mydb.db åº“çš„è·¯å¾„ä¸‹æ˜¯ä¸å­˜åœ¨ t5è¡¨çš„, è€Œæ˜¯å­˜åœ¨ '/external/t5' ä¸­# ä½†æ˜¯ä½¿ç”¨ 'show tables' æ˜¯å­˜åœ¨ t5 çš„hive (mydb)&gt; create external table t5(id int) location '/external/t5';# å¾€æ­¤ç›®å½•ä¼ æ•°æ®, æ³¨æ„: æ­¤æ—¶ä¼ è¿‡åŽ», intdata æ•°æ®å­˜åœ¨ t5ç›®å½•ä¸‹[ap@cs2]~% hadoop fs -put intdata /external/t5[ap@cs2]~% hadoop fs -put intdata /external/t5/i2# ç»§ç»­ä¼ æ•°æ®, æŸ¥è¯¢çš„æ—¶å€™, å°±æ˜¯ä¼ çš„å…¨éƒ¨æ•°æ®'ç›¸å½“äºŽæ‰€æœ‰çš„æ•°æ®éƒ½åœ¨ t5è¡¨ä¸­'[ap@cs2]~% hadoop fs -put intdata /external/t5# æ³¨æ„: å¦‚æžœä¼ åˆ° t5 ç›®å½•ä¸‹, æ²¡æœ‰æŒ‡å®šæ•°æ®æ–‡ä»¶åçš„è¯, ä¼šé»˜è®¤é‡‡ç”¨æ•°æ®çš„åç§°æ–‡ä»¶. 4.3 â€» åˆ†åŒºè¡¨4.3.1 åŸºæœ¬æ¦‚å¿µå’Œæ“ä½œ åˆ†åŒºå¯ä»¥ç†è§£ä¸ºåˆ†ç±»ï¼Œé€šè¿‡åˆ†ç±»æŠŠä¸åŒç±»åž‹çš„æ•°æ®æ”¾åˆ°ä¸åŒçš„ç›®å½•ä¸‹ã€‚ åˆ†ç±»çš„æ ‡å‡†å°±æ˜¯åˆ†åŒºå­—æ®µï¼Œå¯ä»¥ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥å¤šä¸ªã€‚ åˆ†åŒºè¡¨çš„æ„ä¹‰åœ¨äºŽä¼˜åŒ–æŸ¥è¯¢ã€‚æŸ¥è¯¢æ—¶å°½é‡åˆ©ç”¨åˆ†åŒºå­—æ®µã€‚å¦‚æžœä¸ä½¿ç”¨åˆ†åŒºå­—æ®µï¼Œå°±ä¼šå…¨éƒ¨æ‰«æã€‚ åˆ›å»ºåˆ†åŒºè¡¨, æŒ‡å®šåˆ†åŒºå­—æ®µ hive&gt;CREATE TABLE t3(...) PARTITIONED BY (province string); åˆ›å»ºè¡¨çš„æ—¶å€™, æŒ‡å®šåˆ†åŒºå­—æ®µ keyprovince ä¸ºåˆ†åŒºå­—æ®µæ·»åŠ ä¸€ä¸ªå€¼ hive&gt;ALTER TABLE t3 ADD [IF NOT EXISTS] PARTITION(...) LOCATION &#39;...â€™; alter table t3 add if not exists partition(province=&#39;hubei&#39;) partition(province=&#39;shanghai&#39;); alter table t3 add if not exists partition(province=&#39;jiangsu&#39;); å¯ä¸ºæ­¤åˆ†åŒºå­—æ®µæ·»åŠ å¤šä¸ªå€¼, ä¸º province æ·»åŠ  hubei, hunanâ€¦. æŸ¥çœ‹è¡¨çš„åˆ†åŒºå­—æ®µ&amp;å€¼ hive&gt;SHOW PARTITIONS t3 [partition (province=&#39;beijing&#39;)]; åˆ é™¤åˆ†åŒº hive&gt;ALTER TABLE t3 DROP PARTITION(province=â€˜beijingâ€™.); è¿™é‡Œæ˜¯åˆ é™¤åŒ—äº¬çš„åˆ†åŒº (å¦‚æžœæ˜¯å†…éƒ¨è¡¨, ä¼šè¿žæ•°æ®ä¸€èµ·åˆ é™¤) è®¾ç½®è¡¨ä¸èƒ½è¢«åˆ é™¤/æŸ¥è¯¢ â€”â€”â€“ è¿™é‡ŒæŠ¥è¯­æ³•é”™è¯¯, :TODO é˜²æ­¢åˆ†åŒºè¢«åˆ é™¤:alter table student_p partition (part=&#39;aa&#39;) enable no_drop; é˜²æ­¢åˆ†åŒºè¢«æŸ¥è¯¢:alter table student_p partition (part=&#39;aa&#39;) enable offline; enable å’Œ disable æ˜¯åå‘æ“ä½œ å…¶å®ƒä¸€äº›ç›¸å…³å‘½ä»¤ SHOW TABLES; # æŸ¥çœ‹æ‰€æœ‰çš„è¡¨ SHOW TABLES â€˜TMPâ€˜; #æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢ SHOW PARTITIONS TMP_TABLE; #æŸ¥çœ‹è¡¨æœ‰å“ªäº›åˆ†åŒº DESC TMP_TABLE; #æŸ¥çœ‹è¡¨ç»“æž„ 4.3.2 åˆ›å»ºåˆ†åŒºè¡¨å®Œæ•´è¯­æ³•1234567891011CREATE TABLE tmp_table #è¡¨å(title string, # å­—æ®µåç§° å­—æ®µç±»åž‹minimum_bid double,quantity bigint,have_invoice bigint)COMMENT 'æ³¨é‡Šï¼šXXX' #è¡¨æ³¨é‡Š PARTITIONED BY(pt STRING) #åˆ†åŒºè¡¨å­—æ®µï¼ˆå¦‚æžœä½ æ–‡ä»¶éžå¸¸ä¹‹å¤§çš„è¯ï¼Œé‡‡ç”¨åˆ†åŒºè¡¨å¯ä»¥å¿«è¿‡æ»¤å‡ºæŒ‰åˆ†åŒºå­—æ®µåˆ’åˆ†çš„æ•°æ®ï¼‰ ROW FORMAT DELIMITED FIELDS TERMINATED BY '\001' # å­—æ®µæ˜¯ç”¨ä»€ä¹ˆåˆ†å‰²å¼€çš„STORED AS SEQUENCEFILE; #ç”¨å“ªç§æ–¹å¼å­˜å‚¨æ•°æ®ï¼ŒSEQUENCEFILEæ˜¯hadoopè‡ªå¸¦çš„æ–‡ä»¶åŽ‹ç¼©æ ¼å¼ 4.3.3 åˆ†åŒºè¡¨æ³¨æ„ç‚¹(é”™è¯¯ç‚¹) 1) åˆ†åŒºè¡¨åœ¨ load æ•°æ®çš„æ—¶å€™, å¾—æŒ‡å®šåˆ†åŒº, å¦åˆ™ä¼šæŠ¥é”™ 123456789101112# é”™è¯¯1: åˆ†åŒºè¡¨åœ¨ load æ•°æ®çš„æ—¶å€™, å¾—æŒ‡å®šåˆ†åŒºhive (mydb)&gt; load data local inpath '~/ihivedata/intdata' into table t6;FAILED: SemanticException [Error 10062]: Need to specify partition columns because the destination table is partitioned# é”™è¯¯2: å¯¼å…¥æœ¬åœ°æ•°æ®çš„æ—¶å€™, 'path'æ˜¯ä»Žå½“å‰æ‰€åœ¨è·¯å¾„å¼€å§‹çš„hive (mydb)&gt; load data local inpath '~/ihivedata/intdata' into table t6 partition(class='job1');FAILED: SemanticException Line 1:23 Invalid path ''&lt;sub&gt;/ihivedata/intdata'': No files matching path file:/home/ap/&lt;/sub&gt;/ihivedata/intdata# è¿™é‡Œå°±æ­£ç¡®äº†hive (mydb)&gt; load data local inpath 'ihivedata/intdata' into table t6 partition(class='job1');Loading data to table mydb.t6 partition (class=job1)OK æœ¬è´¨åŽŸå› : åˆ†åŒºè¡¨çš„åˆ†åŒº, å°±æ˜¯åœ¨ hdfs ä¸Š, åŽŸè¡¨çš„æ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»ºäº†ä¸€ä¸ªå­æ–‡ä»¶å¤¹, æ–‡ä»¶å¤¹åå°±æ˜¯åˆ†åŒºå. ä»Žæœ¬åœ° load æ•°æ®: hive (mydb)&gt; load data local inpath &#39;ihivedata/intdata&#39; into table t6 partition(class=&#39;job1&#39;); load æ•°æ®æŒ‡å®šåˆ†åŒºä¹‹åŽ, ä¼šç›´æŽ¥ load åˆ°æ•°æ®æ–‡ä»¶å¤¹é‡Œé¢ 2) æ²¡æœ‰æ·»åŠ åˆ†åŒºæ—¶, ç›´æŽ¥å¾€ä¸å­˜åœ¨çš„åˆ†åŒºå¯¼å…¥æ•°æ®, åˆ†åŒºä¼šè‡ªåŠ¨åˆ›å»º 12# ç›´æŽ¥å¾€ä¸å­˜åœ¨çš„åˆ†åŒºloadæ•°æ®, åˆ†åŒºä¼šè‡ªåŠ¨åˆ›å»ºload data local inpath 'ihivedata/intdata' into table t6 partition(class='job110'); 3) æ‰‹åŠ¨åœ¨è¡¨ä¸­åˆ›å»ºåˆ†åŒº(æ–‡ä»¶å¤¹), å¹¶ç›´æŽ¥å‘æ­¤æ–‡ä»¶å¤¹ä¸­å¯¼å…¥æ•°æ® 12345678910111213141516171819202122232425262728293031323334353637# ç›´æŽ¥åˆ›å»ºç›®å½•hive (mydb)&gt; dfs -mkdir /user/hive/warehouse/mydb.db/t6/class=job120;# ç›´æŽ¥ä»Ž hadoop ç«¯ä¼ æ•°æ®hadoop fs -put ihivedata/intdata /user/hive/warehouse/mydb.db/t6/class=job120# æ­¤æ—¶å† show partitions t6; ä¼šå‘çŽ°å¹¶æ²¡æœ‰æ­¤åˆ†åŒº---partitionclass=job1class=job110class=job2class=job3class=job4# æ­¤æ—¶å°±éœ€è¦æ‰‹åŠ¨'æ¿€æ´»'æ­¤åˆ†åŒº, åŠ å…¥äº†å°±æœ‰äº†hive (mydb)&gt; alter table t6 add partition(class='job120');---hive (mydb)&gt; show partitions t6;---partitionclass=job1class=job110class=job120class=job2class=job3class=job4# æŸ¥çœ‹åˆ†åŒºä¿¡æ¯hive (mydb)&gt; select * from t6 where class='job110';OKt6.id t6.class1 job1102 job1103 job1104 job1105 job110 4.3.4 å¤åˆåˆ†åŒºåŸºæœ¬æ“ä½œ åˆ›å»ºæ•°æ®æ–‡ä»¶partition_table.dat åˆ›å»ºè¡¨ create table t7(name string,age int)partitioned by(class string,city string)row format delimited fields terminated by &#39;\t&#39; stored as TEXTFILE; åœ¨ Hive ä¸‹åŠ è½½æ•°æ®åˆ°åˆ†åŒº load data local inpath &#39;ihivedata/partidata&#39; into table t7 partition(class=&#39;job1&#39;,city=&#39;beijing&#39;); load data local inpath &#39;ihivedata/partidata&#39; into table t7 partition(class=&#39;job1&#39;,city=&#39;shanghai&#39;); load data local inpath &#39;ihivedata/partidata&#39; into table t7 partition(class=&#39;job2&#39;,city=&#39;ss&#39;); æ³¨æ„: å¤šçº§åˆ†åŒºå…¶å®žå°±æ˜¯å¤šçº§ç›®å½• è¶Šé è¿‘å·¦è¾¹, ç›®å½•å±‚çº§è¶Šé«˜; è¶Šé è¿‘å³è¾¹, ç›®å½•å±‚çº§è¶Šä½Ž; load æ•°æ®åˆ°å¤šçº§åˆ†åŒº, loadå±‚çº§å¿…é¡»å’Œæ•´ä¸ªå±‚çº§æ•°é‡ç›¸åŒ ä¹Ÿå°±æ˜¯è¯´, å¦‚æžœåˆ†åŒºæœ‰2å±‚, ä¼ æ•°æ®çš„æ—¶å€™, ä¹Ÿå¿…é¡»ä¼ 2å±‚åˆ†åŒº, å¹¶ä¸”å±‚çº§é¡ºåºå¿…é¡»ä¸€è‡´ ä»ŽLinux æœ¬åœ°ç›´æŽ¥å¯¼æ•°æ®åˆ°åˆ†åŒº å¯ä»¥ç›´æŽ¥åœ¨ hadoop UI é¡µé¢, æŸ¥çœ‹è·¯å¾„, ç„¶åŽç›´æŽ¥ä¼ åˆ°æ­¤è·¯å¾„ä¸­ hadoop fs -put ihivedata/partidata /user/hive/warehouse/mydb.db/t7/class=job1/city=beijing/p2 æŸ¥çœ‹æ•°æ® select * from partition_table select count(*) from partition_table åˆ é™¤è¡¨ drop table partition_table å·¥ä½œä¸­ ç”¨çš„æœ€å¤šçš„æ˜¯ å¤–éƒ¨è¡¨ + åˆ†åŒºè¡¨ 4.4 æ¡¶è¡¨ - ä¸»è¦ç”¨äºŽæŠ½æ ·æŸ¥è¯¢æ¡¶è¡¨çš„åŸºæœ¬æ“ä½œ åˆ›å»ºæ¡¶è¡¨å®Œæ•´è¿‡ç¨‹ 12345678910111213141516171819202122232425262728#åˆ›å»ºåˆ†æ¡¶è¡¨drop table stu_buck;create table stu_buck(Sno int,Sname string,Sex string,Sage int,Sdept string)clustered by(Sno) sorted by(Sno DESC)into 4 bucketsrow format delimitedfields terminated by ',';#è®¾ç½®å˜é‡,è®¾ç½®åˆ†æ¡¶ä¸ºtrue, è®¾ç½®reduceæ•°é‡æ˜¯åˆ†æ¡¶çš„æ•°é‡ä¸ªæ•°set hive.enforce.bucketing = true;set mapreduce.job.reduces=4;#å¼€å§‹å¾€åˆ›å»ºçš„åˆ†é€šè¡¨æ’å…¥æ•°æ®(æ’å…¥æ•°æ®éœ€è¦æ˜¯å·²åˆ†æ¡¶, ä¸”æŽ’åºçš„)#å¯ä»¥ä½¿ç”¨distribute by(sno) sort by(sno asc) æˆ–æ˜¯æŽ’åºå’Œåˆ†æ¡¶çš„å­—æ®µç›¸åŒçš„æ—¶å€™ä½¿ç”¨Cluster by(å­—æ®µ)#æ³¨æ„ä½¿ç”¨cluster by å°±ç­‰åŒäºŽåˆ†æ¡¶+æŽ’åº(sort)insert into table stu_buckselect Sno,Sname,Sex,Sage,Sdept from student distribute by(Sno) sort by(Sno asc);insert overwrite table stu_buckselect * from student distribute by(Sno) sort by(Sno asc);insert overwrite table stu_buckselect * from student cluster by(Sno);-----ä»¥ä¸Š3è€…æ•ˆæžœä¸€æ ·çš„ ä¿å­˜selectæŸ¥è¯¢ç»“æžœçš„å‡ ç§æ–¹å¼ï¼š å°†æŸ¥è¯¢ç»“æžœä¿å­˜åˆ°ä¸€å¼ æ–°çš„hiveè¡¨ä¸­ 123create table t_tmpasselect * from t_p; å°†æŸ¥è¯¢ç»“æžœä¿å­˜åˆ°ä¸€å¼ å·²ç»å­˜åœ¨çš„hiveè¡¨ä¸­ 12insert into table t_tmpselect * from t_p; å°†æŸ¥è¯¢ç»“æžœä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶ç›®å½•ï¼ˆå¯ä»¥æ˜¯æœ¬åœ°ï¼Œä¹Ÿå¯ä»¥æ˜¯hdfsï¼‰ 12345insert overwrite local directory '/home/hadoop/test'select * from t_p;insert overwrite directory '/aaa/test'select * from t_p; æ•°æ®åŠ è½½åˆ°æ¡¶è¡¨æ—¶ï¼Œä¼šå¯¹å­—æ®µå–hashå€¼ï¼Œç„¶åŽä¸Žæ¡¶çš„æ•°é‡å–æ¨¡ã€‚æŠŠæ•°æ®æ”¾åˆ°å¯¹åº”çš„æ–‡ä»¶ä¸­ã€‚ æ‰€ä»¥é¡ºåºæ˜¯æ‰“ä¹±çš„, ä¸æ˜¯åŽŸå§‹ t1çš„æ•°æ®é¡ºåº æŸ¥çœ‹æ•°æ® å¯ä»¥ç›´æŽ¥select * æŸ¥çœ‹å…¨éƒ¨ ä¹Ÿå¯ä»¥ç›´æŽ¥å•ç‹¬æŸ¥çœ‹æ¯ä¸ªæ¡¶çš„æ•°æ® 123456789hive (mydb)&gt; dfs -cat /user/hive/warehouse/mydb.db/bucket_table/000000_0;4hive (mydb)&gt; dfs -cat /user/hive/warehouse/mydb.db/bucket_table/000001_0;51hive (mydb)&gt; dfs -cat /user/hive/warehouse/mydb.db/bucket_table/000002_0;2hive (mydb)&gt; dfs -cat /user/hive/warehouse/mydb.db/bucket_table/000003_0;3 ä¿®æ”¹æ¡¶çš„ä¸ªæ•° alter table bucket_table clustered by (id) sorted by(id) into 10 buckets; ä½†æ˜¯è¿™æ ·ä¿®æ”¹ä¹‹åŽ, ç”Ÿæˆçš„æ˜¯åŽŸæ¥çš„ copy, å¹¶ä¸”é‡Œé¢çš„æ•°æ®ä¹Ÿå¾ˆå¥‡æ€ª, ä¸çŸ¥é“æ˜¯æŒ‰ç…§ä»€ä¹ˆæ¥æ‰§è¡Œçš„? :TODO æ³¨æ„ï¼š ç‰©ç†ä¸Šï¼Œæ¯ä¸ªæ¡¶å°±æ˜¯è¡¨(æˆ–åˆ†åŒºï¼‰ç›®å½•é‡Œçš„ä¸€ä¸ªæ–‡ä»¶ ä¸€ä¸ªä½œä¸šäº§ç”Ÿçš„æ¡¶(è¾“å‡ºæ–‡ä»¶)å’Œreduceä»»åŠ¡ä¸ªæ•°ç›¸åŒ æ¡¶è¡¨å·¥ä½œä¸­å®¹æ˜“é‡åˆ°çš„é”™è¯¯ å‘æ¡¶è¡¨ä¸­æ’å…¥å…¶å®ƒè¡¨æŸ¥å‡ºçš„æ•°æ®çš„æ—¶å€™, å¿…é¡»æŒ‡å®šå­—æ®µå, å¦åˆ™ä¼šæŠ¥å­—æ®µä¸åŒ¹é…. 1234FAILED: SemanticException [Error 10044]: Line 1:12 Cannot insert into target table because column number/types are different 'bucket_table': Table insclause-0 has 1 columns, but query has 2 columns.# åº”è¯¥æ˜¯è¿™æ ·insert into bucket_table select id from t6; â€» æ¡¶è¡¨çš„æŠ½æ ·æŸ¥è¯¢ æ¡¶è¡¨çš„æŠ½æ ·æŸ¥è¯¢ select * from bucket_table tablesample(bucket 1 out of 4 on id); tablesampleæ˜¯æŠ½æ ·è¯­å¥ è¯­æ³•è§£æžï¼šTABLESAMPLE(BUCKET x OUT OF y) yå¿…é¡»æ˜¯tableæ€»bucketæ•°çš„å€æ•°æˆ–è€…å› å­ã€‚ hiveæ ¹æ®yçš„å¤§å°ï¼Œå†³å®šæŠ½æ ·çš„æ¯”ä¾‹ã€‚ ä¾‹å¦‚ï¼Œtableæ€»å…±åˆ†äº†64ä»½ï¼Œå½“y=32æ—¶ï¼ŒæŠ½å–(64/32=)2ä¸ªbucketçš„æ•°æ®ï¼Œå½“y=128æ—¶ï¼ŒæŠ½å–(64/128=)1/2ä¸ªbucketçš„æ•°æ®ã€‚xè¡¨ç¤ºä»Žå“ªä¸ªbucketå¼€å§‹æŠ½å–ã€‚ ä¾‹å¦‚ï¼Œtableæ€»bucketæ•°ä¸º32ï¼Œtablesample(bucket 3 out of 16)ï¼Œè¡¨ç¤ºæ€»å…±æŠ½å–ï¼ˆ32/16=ï¼‰2ä¸ªbucketçš„æ•°æ®ï¼Œåˆ†åˆ«ä¸ºç¬¬3ä¸ªbucketå’Œç¬¬ï¼ˆ3+16=ï¼‰19ä¸ªbucketçš„æ•°æ®ã€‚ 5. Hive è§†å›¾çš„æ“ä½œ ä½¿ç”¨è§†å›¾å¯ä»¥é™ä½ŽæŸ¥è¯¢çš„å¤æ‚åº¦ è§†å›¾çš„åˆ›å»º create view v1 AS select t1.name from t1; è§†å›¾çš„åˆ é™¤ drop view if exists v1; 6. Hive ç´¢å¼•çš„æ“ä½œ åˆ›å»ºç´¢å¼• create index t1_index on table t1(id) as &#39;org.apache.hadoop.hive.ql.index.compact.CompactIndexHandler&#39; with deferred rebuild in table t1_index_table; t1_index: ç´¢å¼•åç§° as: æŒ‡å®šç´¢å¼•å™¨ t1_index_table: è¦åˆ›å»ºçš„ç´¢å¼•è¡¨ æ˜¾ç¤ºç´¢å¼• show formatted index on t1; é‡å»ºç´¢å¼• alter index t1_index on t1 rebuild; é‡å»ºå®Œç´¢å¼•ä¹‹åŽ, æŸ¥çœ‹ t1_index_table è¿™å¼ è¡¨, å°±å­˜äº†t1è¡¨æ–‡ä»¶å…·ä½“çš„ä½ç½®, æœ€åŽä¸€åˆ—t1_index_table._offsetsæ˜¯ ç´¢å¼•çš„åç§»é‡, ç±»ä¼¼äºŽæŒ‡é’ˆ, åç§»é‡æ˜¯ç´¢å¼•çš„ç²¾é«“ 12345678hive (mydb)&gt; select * from t1_index_table;OKt1_index_table.id t1_index_table._bucketname t1_index_table._offsets1 hdfs://cs1:9000/user/hive/warehouse/mydb.db/t1/intdata [0]2 hdfs://cs1:9000/user/hive/warehouse/mydb.db/t1/intdata [2]3 hdfs://cs1:9000/user/hive/warehouse/mydb.db/t1/intdata [4]4 hdfs://cs1:9000/user/hive/warehouse/mydb.db/t1/intdata [6]5 hdfs://cs1:9000/user/hive/warehouse/mydb.db/t1/intdata [8] åˆ†åŒºå­—æ®µæœ¬è´¨ä¸Šå…¶å®žå°±æ˜¯ç´¢å¼• 7. è£…è½½æ•°æ®7.1 æ™®é€šè£…è½½æ•°æ®: ä»Žæœ¬åœ° put ä»Ž hive cp ä»Žæ–‡ä»¶ä¸­è£…è½½æ•°æ® 1hive&gt;LOAD DATA [LOCAL] INPATH '...' [OVERWRITE] INTO TABLE t2 [PARTITION (province='beijing')]; é€šè¿‡æŸ¥è¯¢è¡¨è£…è½½æ•°æ® 12345678910111213141516# æ–¹å¼1hive&gt;INSERT OVERWRITE TABLE t2 PARTITION (province='beijing') SELECT * FROM xxx WHERE xxx;# æ–¹å¼2hive&gt;FROM t4 INSERT OVERWRITE TABLE t3 PARTITION (...) SELECT ...WHERE... INSERT OVERWRITE TABLE t3 PARTITION (...) SELECT ...WHERE... INSERT OVERWRITE TABLE t3 PARTITION (...) SELECT ...WHERE...; # æ–¹å¼3 ç›´æŽ¥æ’å…¥æ•°æ®, ä¹Ÿä¼šè½¬åŒ–ä¸ºæ–‡ä»¶çš„å½¢å¼, å­˜åœ¨è¡¨çš„ç›®å½•ä¸‹- insert into table_name values(xxx); # æ–¹å¼4 ç›´æŽ¥ä¼ æ–‡ä»¶ - load data (local) inpath â€˜ xxxâ€™ into table t_1; 7.2åŠ¨æ€è£…è½½æ•°æ® ä¸å¼€å¯åŠ¨æ€è£…è½½æ—¶ 12hive&gt;INSERT OVERWRITE TABLE t3 PARTITION(province='bj', city='bj') SELECT t.province, t.city FROM temp t WHERE t.province='bj'; å¼€å¯åŠ¨æ€åˆ†åŒºæ”¯æŒ 123hive&gt;set hive.exec.dynamic.partition=true;hive&gt;set hive.exec.dynamic.partition.mode=nostrict;hive&gt;set hive.exec.max.dynamic.partitions.pernode=1000; æŠŠ t6 è¡¨çš„æ‰€æœ‰çš„å­—æ®µ (åŒ…æ‹¬åˆ†åŒºå­—æ®µ) åŠ è½½è¿› t9 å¯¹åº”çš„åˆ†åŒº 1hive (mydb)&gt; insert overwrite table t9 partition(class) select id,class from t6; å•è¯­å¥å»ºè¡¨å¹¶åŒæ—¶è£…è½½æ•°æ® 1hive&gt;CREATE TABLE t4 AS SELECT .... 8. å¯¼å‡ºæ•°æ® åœ¨hdfsä¹‹é—´å¤åˆ¶æ–‡ä»¶(å¤¹) hadoop fs -cp source destination hive&gt; dfs -cp source destination æ¡ˆä¾‹: hive&gt; dfs -get /user/hive/warehouse/mydb.db/t9 /root/t9; ä»Ž hdfs å¤åˆ¶åˆ°æœ¬åœ° ä½¿ç”¨DIRECTORY hive&gt;INSERT OVERWRITE ã€LOCALã€‘ DIRECTORY &#39;...&#39; SELECT ...FROM...WHERE ...; æ¡ˆä¾‹:é€šè¿‡æŸ¥è¯¢å¯¼å‡ºåˆ° t9, èµ°çš„ MapReduce å¯¼åˆ°åˆ° hdfs: insert overwrite directory &quot;/home/t9&quot; select * from t9; å¯¼å‡ºåˆ°æœ¬åœ°: insert overwrite local directory &quot;/home/ap/t9&quot; select * from t9; 9. è¯»æ¨¡å¼&amp;å†™æ¨¡å¼ RDBMSæ˜¯å†™æ¨¡å¼ Hiveæ˜¯è¯»æ¨¡å¼ 10. å®Œæ•´å»ºè¡¨è¯­å¥è¯­æ³•12345678910111213CREATE [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name [(col_name data_type [COMMENT col_comment], ...)] [COMMENT table_comment] [PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)] [CLUSTERED BY (col_name, col_name, ...) [SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS] [SKEWED BY (col_name, col_name, ...) ON ([(col_value, col_value, ...), ...|col_value, col_value, ...]) [STORED AS DIRECTORIES] ] [ [ROW FORMAT row_format] [STORED AS file_format] | STORED BY 'storage.handler.class.name' [WITH SERDEPROPERTIES (...)] ] [LOCATION hdfs_path] [TBLPROPERTIES (property_name=property_value, ...)] [AS select_statement] (Note: not supported when creating external tables.) 11. æ–‡ä»¶æ ¼å¼ TextFile SequenceFile RCFile ORC 11.1 é»˜è®¤å­˜å‚¨æ ¼å¼å°±æ˜¯ TextFile å­˜å‚¨ç©ºé—´æ¶ˆè€—æ¯”è¾ƒå¤§ï¼Œ å¹¶ä¸”åŽ‹ç¼©çš„text æ— æ³•åˆ†å‰²å’Œåˆå¹¶ æŸ¥è¯¢çš„æ•ˆçŽ‡æœ€ä½Ž,å¯ä»¥ç›´æŽ¥å­˜å‚¨ï¼Œ åŠ è½½æ•°æ®çš„é€Ÿåº¦æœ€é«˜ 11.2 ä½¿ç”¨SequenceFileå­˜å‚¨ å­˜å‚¨ç©ºé—´æ¶ˆè€—å¤§ åŽ‹ç¼©çš„æ–‡ä»¶å¯ä»¥åˆ†å‰²å’Œåˆå¹¶ æŸ¥è¯¢æ•ˆçŽ‡é«˜ éœ€è¦é€šè¿‡textæ–‡ä»¶è½¬åŒ–æ¥åŠ è½½ 12345678910111213hive&gt; create table test2(str STRING) STORED AS SEQUENCEFILE; set hive.exec.compress.output=true;set mapred.output.compress=true;set mapred.output.compression.codec=com.hadoop.compression.lzo.LzoCodec;set io.seqfile.compression.type=BLOCK;set io.compression.codecs=com.hadoop.compression.lzo.LzoCodec;INSERT OVERWRITE TABLE test2 SELECT * FROM test1; æ³¨æ„ç‚¹: SequenceFile ç±»åž‹çš„è¡¨, ä¸èƒ½ç›´æŽ¥å¯¼å…¥æ•°æ®æ–‡ä»¶, åªèƒ½é€šè¿‡ä»Žä»–è¡¨æŸ¥è¯¢ insert overwrite table t2 select * from t1; 123# æŸ¥çœ‹æ­¤ 'SequenceFile' è¡¨hive (db2)&gt; dfs -cat /user/hive/warehouse/db2.db/t2/000000_0 ;SEQ"org.apache.hadoop.io.BytesWritableorg.apache.hadoop.io.Text*org.apache.hadoop.io.compress.DefaultCodecï¿½ï¿½ï¿½/*&lt;bbï¿½mï¿½?xï¿½c453xï¿½c464xï¿½c475xï¿½c486xï¿½c497hive (db2)&gt; 11.3 ä½¿ç”¨RCFileå­˜å‚¨RCFILEæ˜¯ä¸€ç§è¡Œåˆ—å­˜å‚¨ç›¸ç»“åˆçš„å­˜å‚¨æ–¹å¼ã€‚é¦–å…ˆï¼Œå…¶å°†æ•°æ®æŒ‰è¡Œåˆ†å—ï¼Œä¿è¯åŒä¸€ä¸ªrecordåœ¨ä¸€ä¸ªå—ä¸Šï¼Œé¿å…è¯»ä¸€ä¸ªè®°å½•éœ€è¦è¯»å–å¤šä¸ªblockã€‚å…¶æ¬¡ï¼Œå—æ•°æ®åˆ—å¼å­˜å‚¨ï¼Œæœ‰åˆ©äºŽæ•°æ®åŽ‹ç¼©å’Œå¿«é€Ÿçš„åˆ—å­˜å–ã€‚ rcfile å­˜å‚¨ç©ºé—´æœ€å° æŸ¥è¯¢çš„æ•ˆçŽ‡æœ€é«˜ éœ€è¦é€šè¿‡textæ–‡ä»¶è½¬åŒ–æ¥åŠ è½½ åŠ è½½çš„é€Ÿåº¦æœ€ä½Ž 123456789101112hive&gt; create table test3(str STRING) STORED AS RCFILE; set hive.exec.compress.output=true;set mapred.output.compress=true;set mapred.output.compression.codec=com.hadoop.compression.lzo.LzoCodec;set io.compression.codecs=com.hadoop.compression.lzo.LzoCodec;INSERT OVERWRITE TABLE test3 SELECT * FROM test1; æ³¨æ„ç‚¹: RCFile ä¹Ÿåªèƒ½ä»Žå…¶å®ƒè¡¨å¯¼å…¥æ•°æ® 12hive (db2)&gt; dfs -cat /user/hive/warehouse/db2.db/t3/000000_0;RCF*org.apache.hadoop.io.compress.DefaultCodechive.io.rcfile.column.number1 11.4 ä½¿ç”¨ORCå­˜å‚¨(æœ€å¥½çš„ä¸€ç§æ ¼å¼)æ˜¯ä¸€ç§é’ˆå¯¹ RCFile ä¼˜åŒ–çš„æ ¼å¼ ä¸»è¦ç‰¹ç‚¹: åŽ‹ç¼©, ç´¢å¼•, å•æ–‡ä»¶è¾“å‡º 12345678910111213hive&gt; create table t1_orc(id int, name string) row format delimited fields terminated by '\t' stored as orc tblproperties("orc.compress"="ZLIB");ALTER TABLE ... [PARTITION partition_spec] SET FILEFORMAT ORC;# ä¹Ÿå¯ä»¥æ”¹ä¸ºå…¶å®ƒçš„, ä¿®æ”¹çš„è¯­æ³•å°±æ˜¯è¿™æ ·alter table t1 set fileformat textfile;SET hive.default.fileformat=Orc;insert overwrite table t1_orc select * from t1; æ³¨æ„ç‚¹: ORC ä¹Ÿåªèƒ½ä»Žå…¶å®ƒè¡¨å¯¼å…¥æ•°æ® å ç”¨ç©ºé—´å¤§, ä¸€ä¸ª block æœ‰256M, ä¹‹å‰2ç§éƒ½æ˜¯128M 1234567891011hive (db2)&gt; dfs -cat /user/hive/warehouse/db2.db/t4/000000_0;ORCP+P ï¿½6ï¿½bï¿½``ï¿½ï¿½ï¿½ÑŒ@ï¿½Hï¿½ 1q01-PPK# (" id0P:P@ï¿½;ï¿½ï¿½" (0ï¿½ï¿½ORChive 12. åºåˆ—åŒ– &amp; ååºåˆ—åŒ– (Hive SerDe)12.1 SerDe What is a SerDe? SerDe æ˜¯ â€œSerializer and Deserializer.â€çš„ç¼©å†™ Hive ä½¿ç”¨ SerDeå’ŒFileFormatè¿›è¡Œè¡Œå†…å®¹çš„è¯»å†™. Hiveåºåˆ—åŒ–æµç¨‹ ä»Ž HDFS ä¸Šè¯»å…¥æ–‡ä»¶ (ååºåˆ—åŒ–) HDFSæ–‡ä»¶ --&gt; InputFileFormat --&gt; &lt;key, value&gt; --&gt; Deserializer --&gt; è¡Œå¯¹è±¡ å†™å‡ºåˆ° HDFS (åºåˆ—åŒ–) è¡Œå¯¹è±¡ --&gt; Serializer --&gt; &lt;key, value&gt; --&gt; OutputFileFormat --&gt; HDFSæ–‡ä»¶ æ³¨æ„: æ•°æ®å…¨éƒ¨å­˜åœ¨åœ¨valueä¸­ï¼Œkeyå†…å®¹æ— æ„ä¹‰ Hive ä½¿ç”¨å¦‚ä¸‹FileFormat ç±»è¯»å†™ HDFS files: TextInputFormat/HiveIgnoreKeyTextOutputFormat: è¯»å†™æ™®é€šHDFSæ–‡æœ¬æ–‡ä»¶. SequenceFileInputFormat/SequenceFileOutputFormat: è¯»å†™SequenceFileæ ¼å¼çš„HDFSæ–‡ä»¶ â€¦. Hive ä½¿ç”¨å¦‚ä¸‹SerDe ç±»(å)åºåˆ—åŒ–æ•°æ®: MetadataTypedColumnsetSerDe: è¯»å†™csvã€tsvæ–‡ä»¶å’Œé»˜è®¤æ ¼å¼æ–‡ä»¶ ThriftSerDe: è¯»å†™Thrift åºåˆ—åŒ–åŽçš„å¯¹è±¡. DynamicSerDe: è¯»å†™Thriftåºåˆ—åŒ–åŽçš„å¯¹è±¡, ä¸è¿‡ä¸éœ€è¦è§£è¯»schemaä¸­çš„ddl. 12.2 ä½¿ç”¨CSV SerdeCSVæ ¼å¼çš„æ–‡ä»¶ä¹Ÿç§°ä¸ºé€—å·åˆ†éš”å€¼ï¼ˆComma-Separated Valuesï¼ŒCSVï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºå­—ç¬¦åˆ†éš”å€¼ï¼Œå› ä¸ºåˆ†éš”å­—ç¬¦ä¹Ÿå¯ä»¥ä¸æ˜¯é€—å·ã€‚åœ¨æœ¬æ–‡ä¸­çš„CSVæ ¼å¼çš„æ•°æ®å°±ä¸æ˜¯ç®€å•çš„é€—å·åˆ†å‰²çš„ï¼‰ï¼Œå…¶æ–‡ä»¶ä»¥çº¯æ–‡æœ¬å½¢å¼å­˜å‚¨è¡¨æ ¼æ•°æ®ï¼ˆæ•°å­—å’Œæ–‡æœ¬ï¼‰ã€‚CSVæ–‡ä»¶ç”±ä»»æ„æ•°ç›®çš„è®°å½•ç»„æˆï¼Œè®°å½•é—´ä»¥æŸç§æ¢è¡Œç¬¦åˆ†éš”ï¼›æ¯æ¡è®°å½•ç”±å­—æ®µç»„æˆï¼Œå­—æ®µé—´çš„åˆ†éš”ç¬¦æ˜¯å…¶å®ƒå­—ç¬¦æˆ–å­—ç¬¦ä¸²ï¼Œæœ€å¸¸è§çš„æ˜¯é€—å·æˆ–åˆ¶è¡¨ç¬¦ã€‚é€šå¸¸ï¼Œæ‰€æœ‰è®°å½•éƒ½æœ‰å®Œå…¨ç›¸åŒçš„å­—æ®µåºåˆ—ã€‚é»˜è®¤çš„åˆ†éš”ç¬¦æ˜¯ DEFAULT_ESCAPE_CHARACTER \DEFAULT_QUOTE_CHARACTER â€œ â€”å¦‚æžœæ²¡æœ‰ï¼Œåˆ™ä¸éœ€è¦æŒ‡å®šDEFAULT_SEPARATOR , 12345678CREATE TABLE csv_table(a string, b string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' WITH SERDEPROPERTIES ("separatorChar"="\t", "quoteChar"="'", "escapeChar"="\\") STORED AS TEXTFILE;# separatorCharï¼šåˆ†éš”ç¬¦# quoteCharï¼šå¼•å·ç¬¦# escapeCharï¼šè½¬ä¹‰ç¬¦&gt;&gt; :TODO åˆ›å»ºè¡¨æ²¡æˆåŠŸ, ç”¨åˆ°æ—¶å†è¯´ 13. Lateral View è¯­æ³•lateral viewç”¨äºŽå’Œsplit, explodeç­‰UDTFä¸€èµ·ä½¿ç”¨ï¼Œå®ƒèƒ½å¤Ÿå°†ä¸€è¡Œæ•°æ®æ‹†æˆå¤šè¡Œæ•°æ®ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå¯ä»¥å¯¹æ‹†åˆ†åŽçš„æ•°æ®è¿›è¡Œèšåˆã€‚lateral viewé¦–å…ˆä¸ºåŽŸå§‹è¡¨çš„æ¯è¡Œè°ƒç”¨UDTFï¼ŒUTDFä¼šæŠŠä¸€è¡Œæ‹†åˆ†æˆä¸€æˆ–è€…å¤šè¡Œï¼Œlateral viewå†æŠŠç»“æžœç»„åˆï¼Œäº§ç”Ÿä¸€ä¸ªæ”¯æŒåˆ«åè¡¨çš„è™šæ‹Ÿè¡¨ã€‚ lateral: ä¾§é¢, æ¨ªåˆ‡é¢ Lateral View: åˆ‡é¢è¡¨ åˆ›å»ºè¡¨ create table t8(name string,nums array\&lt;int>)row format delimited fields terminated by â€œ\tâ€ COLLECTION ITEMS TERMINATED BY â€˜:â€™; æ•°æ®åˆ‡å‰² SELECT name,new_num FROM t8 LATERAL VIEW explode(nums) num AS new_num; select name,id from class_test lateral view explode(student_id_list) list as id; æ³¨æ„: as å‰é¢çš„ list è²Œä¼¼æ˜¯å¯ä»¥éšè¡¨èµ·åçš„ æ•ˆæžœæ¼”ç¤º 12345678910111213141516171819202122hive (default)&gt; select * from class_test;OKclass_test.name class_test.student_id_listzhangsan [24,25,27,37]lisi [28,39,23,43]wangwu [25,23,2,54]---hive (default)&gt; select name,id from class_test lateral view explode(student_id_list) list as id;OKname idzhangsan 24zhangsan 25zhangsan 27zhangsan 37lisi 28lisi 39lisi 23lisi 43wangwu 25wangwu 23wangwu 2wangwu 54 14. Hiveçš„é«˜çº§å‡½æ•°14.1 ç®€ä»‹ ç®€å•æŸ¥è¯¢ select â€¦ fromâ€¦whereâ€¦ ä½¿ç”¨å„ç§å‡½æ•° hive&gt;show functions; å±•ç¤ºæ‰€æœ‰å‡½æ•° hive&gt;describe function xxx; è¯¦ç»†æè¿°å‡½æ•°ç”¨æ³• LIMITè¯­å¥ åˆ—åˆ«å åµŒå¥—selectè¯­å¥ 14.2 é«˜çº§å‡½æ•°åˆ†ç±» æ ‡å‡†å‡½æ•° reverse() upper() èšåˆå‡½æ•° avg() sum() 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657select avg(id) from t3;select sum(id) from t3;# æœ€ç®€ç­”çš„åµŒå¥—hive (mydb)&gt; select t.id from (select * from t1 where id &gt; 3)t;# æœ€ç®€å•çš„ group by# if else çš„æ•ˆæžœselect id, case when id &lt;= 2 then 'low'when id&gt;=3 and id &lt;4 then 'middle'when id&gt;=4 and id &lt;5 then 'high'else 'very high'end as id_highly from t1;----æ‰§è¡Œç»“æžœ----id id_highly1 low2 low3 middle4 high5 very high--------------------select sid,case coursewhen 'yuwen' then scoreelse '0'end(åˆ«å) yuwencase coursewhen 'shuxue' then scoreelse '0'end(åˆ«å) shuxue# cast è½¬æ¢å‡½æ•°, å¤§æ¦‚æ˜¯è¿™ä¹ˆç”¨hive (mydb)&gt; select id from t1 where cast(id AS FLOAT) &lt;3.0;OKid12 - ![image-20180619150824031](http://p6i5vzkfk.bkt.clouddn.com/study/2018-06-19-070824.png) é¦–å…ˆå½“å‰ä¸å­˜åœ¨çš„åˆ—è¡¥0, ç„¶åŽæŒ‰ç…§å­¦å·åˆ†ç»„æ±‚å’Œ â€‹ ç„¶åŽæŒ‰ç…§ sid åˆ†ç»„æ±‚å’Œ/æ±‚æœ€å¤§å€¼, å°±å¯ä»¥äº† åŒä¸€åˆ—ä¸åŒçš„æ”¾åœ¨ä¸åŒçš„åˆ—ä¸Š, å¸¸ç”¨çš„æ–¹æ³• é¢è¯•é¢˜4 array_contains() desc function array_contains() è‡ªå®šä¹‰å‡½æ•° UDF 15. Hive æ€§èƒ½è°ƒä¼˜15.1 ä»€ä¹ˆæ—¶å€™å¯ä»¥é¿å…æ‰§è¡ŒMapReduceï¼Ÿ select * or select field1,field2 limite 10 whereè¯­å¥ä¸­åªæœ‰åˆ†åŒºå­—æ®µ ä½¿ç”¨æœ¬åœ°set hive.exec.mode.local.auto=true; 12345select * from t3;select name,age from t3;select name,age from t3 limit 2;select name,age from t3 where age=25;# å½“ where æ˜¯æœ¬åœ°å­—æ®µ(åˆ—ä¸­çš„å­—æ®µ), æ˜¯ä¸èµ° MRçš„ group byè¯­å¥ï¼š é€šå¸¸å’Œèšåˆå‡½æ•°ä¸€èµ·ä½¿ç”¨ï¼ŒæŒ‰ç…§ä¸€ä¸ªæˆ–è€…å¤šä¸ªåˆ—å¯¹ç»“æžœè¿›è¡Œåˆ†ç»„ï¼Œç„¶åŽå¯¹æ¯ç»„æ‰§è¡Œèšåˆæ“ä½œ havingè¯­å¥ï¼š é™åˆ¶ç»“æžœçš„è¾“å‡º hiveå°†æŸ¥è¯¢è½¬åŒ–ä¸ºMapReduceæ‰§è¡Œï¼Œhiveçš„ä¼˜åŒ–å¯ä»¥è½¬åŒ–ä¸ºmapreduceçš„ä¼˜åŒ–ï¼ 15.2 hiveæ˜¯å¦‚ä½•å°†æŸ¥è¯¢è½¬åŒ–ä¸ºMapReduceçš„ï¼Ÿ-EXPLAINçš„ä½¿ç”¨ hiveå¯¹sqlçš„æŸ¥è¯¢è®¡åˆ’ä¿¡æ¯è§£æž EXPLAIN SELECT COUNT(1) FROM T1; EXPLAIN EXTENDED æ˜¾ç¤ºè¯¦ç»†æ‰©å±•æŸ¥è¯¢è®¡åˆ’ä¿¡æ¯ EXPLAIN EXTENDED SELECT COUNT(1) FROM T1; ä¸ºå•¥æˆ‘çš„ explain extended åªæœ‰å›ºå®šçš„å‡ è¡Œ? å› ä¸ºè¿™ä¸ª count æ²¡æœ‰è°ƒåŠ¨ MR, ç”¨ sum å°±ä¼šå¯ç”¨ MR, ä¼šå‡ºçŽ°é•¿é•¿çš„ log 12345678910111213141516171819---ä¸ä¼šå¯ç”¨ MRhive (mydb)&gt; explain EXTENDED select count(1) from t9;---ExplainSTAGE DEPENDENCIES: Stage-0 is a root stage ...--------------------------------è¿™é‡Œä¼šå¯ç”¨ MRhive (mydb)&gt; explain EXTENDED select sum(id) from t9;---ExplainSTAGE DEPENDENCIES: Stage-1 is a root stage Stage-0 depends on stages: Stage-1STAGE PLANS: Stage: Stage-1 .... 15.3 æ€§èƒ½è°ƒä¼˜15.3.1 æœ¬åœ°mr æœ¬åœ°æ¨¡å¼è®¾ç½®æ–¹å¼ï¼š set mapred.job.tracker=local; mapper çš„æœ¬åœ°æ¨¡å¼, åªæœ‰åœ¨å¼€å‘ä¸­æ‰ä¼šä½¿ç”¨ set hive.exec.mode.local.auto=true; Hive çš„æ‰§è¡Œæ¨¡å¼ å¯ä»¥ç”¨åœ¨ç”Ÿäº§ä¸­, å› ä¸ºæ˜¯è‡ªåŠ¨æ¨¡å¼, å¯æ ¹æ®å‚æ•°å˜åŒ– è®¾ç½®è¿™é‡Œæ‰ä¼šè½¬æˆ local hadoop æŒ‰ç…§è¿™é‡Œè®¾å®šçš„è§„åˆ™hive.exec.mode.local.auto.input.files.max æµ‹è¯• select 1 from wlan limit 5; ä¸‹é¢ä¸¤ä¸ªå‚æ•°æ˜¯local mrä¸­å¸¸ç”¨çš„æŽ§åˆ¶å‚æ•°: hive.exec.mode.local.auto.inputbytes.maxé»˜è®¤134217728 è®¾ç½®local mrçš„æœ€å¤§è¾“å…¥æ•°æ®é‡,å½“è¾“å…¥æ•°æ®é‡å°äºŽè¿™ä¸ªå€¼çš„æ—¶å€™ä¼šé‡‡ç”¨local mrçš„æ–¹å¼ hive.exec.mode.local.auto.input.files.maxé»˜è®¤æ˜¯4 è®¾ç½®local mrçš„æœ€å¤§è¾“å…¥æ–‡ä»¶ä¸ªæ•°,å½“è¾“å…¥æ–‡ä»¶ä¸ªæ•°å°äºŽè¿™ä¸ªå€¼çš„æ—¶å€™ä¼šé‡‡ç”¨local mrçš„æ–¹å¼ å¤§äºŽæ­¤æ•°æ—¶, å°±ä¸ä¼šè½¬åŒ–ä¸º local hadoop 1Cannot run job locally: Number of Input Files (= 6) is larger than hive.exec.mode.local.auto.input.files.max(= 4) å¯ä»¥è¿™æ ·ä¿®æ”¹local mrçš„æœ€å¤§è¾“å…¥æ–‡ä»¶ä¸ªæ•°å€¼, ä¸»è¦åœ¨è°ƒè¯•é˜¶æ®µä½¿ç”¨ 1234hive (mydb)&gt; set hive.exec.mode.local.auto.input.files.max=8;# è¿™æ ·è®¾ç½®äº†ä¹‹åŽ, åªè¦æ–‡ä»¶æ•°&lt;=8, å°±ä¼šåœ¨æœ¬åœ°è¿è¡ŒJob running in-process (local Hadoop) 15.3.2 å¼€å¯å¹¶è¡Œè®¡ç®— å¼€å¯å¹¶è¡Œè®¡ç®—,å¢žåŠ é›†ç¾¤çš„åˆ©ç”¨çŽ‡ set hive.exec.parallel=true; 15.3.3 è®¾ç½®ä¸¥æ ¼æ¨¡å¼ è®¾ç½®ä¸¥æ ¼æ¨¡å¼ set hive.mapred.mode=strict; è®¾ç½®éžä¸¥æ ¼æ¨¡å¼ set hive.mapred.mode=nonstrict; strictå¯ä»¥ç¦æ­¢ä¸‰ç§ç±»åž‹çš„æŸ¥è¯¢ï¼š å¼ºåˆ¶åˆ†åŒºè¡¨çš„whereæ¡ä»¶è¿‡æ»¤ Order byè¯­å¥å¿…é¡»ä½¿ç”¨limit hive (mydb)&gt; select id from t9 where class=&#39;job110&#39; order by id limit 3; é™åˆ¶ç¬›å¡å°”ç§¯æŸ¥è¯¢ 15.3.4 è°ƒæ•´mapperå’Œreducerçš„æ•°é‡ è°ƒæ•´mapperå’Œreducerçš„æ•°é‡ å¤ªå¤šmapå¯¼è‡´å¯åŠ¨äº§ç”Ÿè¿‡å¤šå¼€é”€ marpred.min.split.size æŒ‰ç…§è¾“å…¥æ•°æ®é‡å¤§å°ç¡®å®šreduceræ•°ç›®, `set mapred.reduce.tasks= é»˜è®¤3 dfs -count /åˆ†åŒºç›®å½•/* hive.exec.reducers.maxè®¾ç½®é˜»æ­¢èµ„æºè¿‡åº¦æ¶ˆè€— JVMé‡ç”¨ å°æ–‡ä»¶å¤šæˆ–taskå¤šçš„ä¸šåŠ¡åœºæ™¯ set mapred.job.reuse.jvm.num.task=10 ä¼šä¸€ç›´å ç”¨taskæ§½ 15.3.5 æŽ’åºæ–¹é¢çš„ä¼˜åŒ– order by è¯­å¥ï¼šæ˜¯å…¨å±€æŽ’åº, ç”¨çš„æ¯”è¾ƒå¤š 123# åŠ ä¸ª desc å°±æ˜¯å€’åºæŽ’åºhive (mydb)&gt; select id from bucket_table order by id desc limit 10;Automatically selecting local only mode for query sort by è¯­å¥ï¼š æ˜¯å•reduceæŽ’åº ä¸€èˆ¬ä¸Ž distribute byç»“åˆä½¿ç”¨ distribute byè¯­å¥ï¼šç±»ä¼¼äºŽåˆ†æ¡¶ï¼Œæ ¹æ®æŒ‡å®šçš„å­—æ®µå°†æ•°æ®åˆ†åˆ°ä¸åŒçš„ reducerï¼Œä¸”åˆ†å‘ç®—æ³•æ˜¯ hash æ•£åˆ— ä¸Ž sort by ç»“åˆç”¨çš„æ¯”è¾ƒå¤š, åœ¨æ¯ä¸ªåˆ†åŒºå†…æœ‰åº 12# æ³¨æ„æ­¤å¤„ distribute çš„ä½œç”¨hive (mydb)&gt; select id from bucket_table distribute by id sort by id desc limit 10; cluster byè¯­å¥ï¼š select * from t9 cluster by id; å¯ä»¥ç¡®ä¿ç±»ä¼¼çš„æ•°æ®çš„åˆ†å‘åˆ°åŒä¸€ä¸ªreduce taskä¸­ï¼Œå¹¶ä¸”ä¿è¯æ•°æ®æœ‰åº, é˜²æ­¢æ‰€æœ‰çš„æ•°æ®åˆ†å‘åˆ°åŒä¸€ä¸ªreduceä¸Šï¼Œå¯¼è‡´æ•´ä½“çš„jobæ—¶é—´å»¶é•¿ cluster byè¯­å¥çš„ç­‰ä»·è¯­å¥ï¼š å¦‚æžœåˆ†æ¡¶å’Œsortå­—æ®µæ˜¯åŒä¸€ä¸ªæ—¶ï¼Œæ­¤æ—¶ï¼Œcluster by = distribute by + sort by distribute by Word sort by Word ASC 15.3.6 Map-sideèšåˆå¯ä»¥ç›´æŽ¥åœ¨ .hivercä¸­é…ç½® set hive.map.aggr=true; è¿™ä¸ªè®¾ç½®å¯ä»¥å°†é¡¶å±‚çš„èšåˆæ“ä½œæ”¾åœ¨Mapé˜¶æ®µæ‰§è¡Œï¼Œä»Žè€Œå‡è½»æ¸…æ´—é˜¶æ®µæ•°æ®ä¼ è¾“å’ŒReduceé˜¶æ®µçš„æ‰§è¡Œæ—¶é—´ï¼Œæå‡æ€»ä½“æ€§èƒ½ã€‚:TODO ä¸å¤ªæ‡‚ ç¼ºç‚¹ï¼šè¯¥è®¾ç½®ä¼šæ¶ˆè€—æ›´å¤šçš„å†…å­˜ã€‚ æ‰§è¡Œselect count(1) from wlan; 15.3.6 Join ä¼˜åŒ– ä¼˜å…ˆè¿‡æ»¤åŽå†è¿›è¡Œ Join æ“ä½œï¼Œæœ€å¤§é™åº¦çš„å‡å°‘å‚ä¸Ž join çš„æ•°æ®é‡ å°è¡¨ join å¤§è¡¨ï¼Œæœ€å¥½å¯åŠ¨ mapjoin åœ¨ä½¿ç”¨å†™æœ‰ Join æ“ä½œçš„æŸ¥è¯¢è¯­å¥æ—¶æœ‰ä¸€æ¡åŽŸåˆ™:åº”è¯¥å°†æ¡ç›®å°‘çš„è¡¨/å­æŸ¥è¯¢æ”¾åœ¨ Join æ“ä½œ ç¬¦çš„å·¦è¾¹ã€‚ Join on çš„æ¡ä»¶ç›¸åŒçš„è¯ï¼Œæœ€å¥½æ”¾å…¥åŒä¸€ä¸ª jobï¼Œå¹¶ä¸” join è¡¨çš„æŽ’åˆ—é¡ºåºä»Žå°åˆ°å¤§ åœ¨ç¼–å†™ Join æŸ¥è¯¢è¯­å¥æ—¶ï¼Œå¦‚æžœç¡®å®šæ˜¯ç”±äºŽ join å‡ºçŽ°çš„æ•°æ®å€¾æ–œï¼Œé‚£ä¹ˆè¯·åšå¦‚ä¸‹è®¾ç½®: set hive.skewjoin.key=100000; // è¿™ä¸ªæ˜¯ join çš„é”®å¯¹åº”çš„è®°å½•æ¡æ•°è¶…è¿‡è¿™ä¸ªå€¼åˆ™ä¼šè¿›è¡Œ åˆ†æ‹†ï¼Œå€¼æ ¹æ®å…·ä½“æ•°æ®é‡è®¾ç½® set hive.optimize.skewjoin=true; // å¦‚æžœæ˜¯ join è¿‡ç¨‹å‡ºçŽ°å€¾æ–œåº”è¯¥è®¾ç½®ä¸º true 16. è¡¨è¿žæŽ¥ (åªæ”¯æŒç­‰å€¼è¿žæŽ¥) 16.1 ç®€ä»‹ INNER JOIN ä¸¤å¼ è¡¨ä¸­éƒ½æœ‰ï¼Œä¸”ä¸¤è¡¨ç¬¦åˆè¿žæŽ¥æ¡ä»¶ select t1.name,t1.age,t9.age from t9 join t1 on t1.name=t9.name; LEFT OUTER JOIN å·¦è¡¨ä¸­ç¬¦åˆwhereæ¡ä»¶å‡ºçŽ°ï¼Œå³è¡¨å¯ä»¥ä¸ºç©º ä»Žå·¦è¡¨è¿”å›žæ‰€æœ‰çš„è¡Œ(å­—æ®µ), å³è¡¨æ²¡æœ‰åŒ¹é…where æ¡ä»¶çš„è¯è¿”å›žnull RIGHT OUTER JOIN å³è¡¨ä¸­ç¬¦åˆwhereæ¡ä»¶å‡ºçŽ°ï¼Œå·¦è¡¨å¯ä»¥ä¸ºç©º FULL OUTER JOIN è¿”å›žæ‰€æœ‰è¡¨ç¬¦åˆwhereæ¡ä»¶çš„æ‰€æœ‰è®°å½•ï¼Œæ²¡æœ‰NULLæ›¿ä»£ LEFT SEMI-JOIN å·¦è¡¨ä¸­ç¬¦åˆå³è¡¨onæ¡ä»¶å‡ºçŽ°ï¼Œå³è¡¨ä¸å‡ºçŽ° Hive å½“å‰æ²¡æœ‰å®žçŽ° IN/EXISTS å­æŸ¥è¯¢ï¼Œå¯ä»¥ç”¨ LEFT SEMI JOIN é‡å†™å­æŸ¥è¯¢è¯­å¥ã€‚LEFT SEMI JOIN çš„é™åˆ¶æ˜¯ï¼Œ JOIN å­å¥ä¸­å³è¾¹çš„è¡¨åªèƒ½åœ¨ ON å­å¥ä¸­è®¾ç½®è¿‡æ»¤æ¡ä»¶ï¼Œåœ¨ WHERE å­å¥ã€SELECT å­å¥æˆ–å…¶ä»–åœ°æ–¹è¿‡æ»¤éƒ½ä¸è¡Œã€‚ 12345SELECT a.key, a.value FROM aWHERE a.key in (SELECT b.key FROM B);# å¯ä»¥è¢«é‡å†™ä¸ºï¼šSELECT a.key, a.val FROM a LEFT SEMI JOIN b on (a.key = b.key) ç¬›å¡å°”ç§¯ æ˜¯m x nçš„ç»“æžœ map-side JOIN åªæœ‰ä¸€å¼ å°è¡¨ï¼Œåœ¨mapperçš„æ—¶å€™å°†å°è¡¨å®Œå…¨æ”¾åœ¨å†…å­˜ä¸­ select /+ mapjoin(t9) /t1.name,t1.age from t9 JOIN t1on t1.name=t9.name; 16.2 ä»£ç æµ‹è¯•1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192å…³äºŽhiveä¸­çš„å„ç§joinå‡†å¤‡æ•°æ®1,a2,b3,c4,d7,y8,u2,bb3,cc7,yy9,ppå»ºè¡¨ï¼šcreate table a(id int,name string)row format delimited fields terminated by ',';create table b(id int,name string)row format delimited fields terminated by ',';å¯¼å…¥æ•°æ®ï¼šload data local inpath '/home/hadoop/a.txt' into table a;load data local inpath '/home/hadoop/b.txt' into table b;å®žéªŒï¼š** inner joinselect * from a inner join b on a.id=b.id;+-------+---------+-------+---------+--+| a.id | a.name | b.id | b.name |+-------+---------+-------+---------+--+| 2 | b | 2 | bb || 3 | c | 3 | cc || 7 | y | 7 | yy |+-------+---------+-------+---------+--+**left joinselect * from a left join b on a.id=b.id;+-------+---------+-------+---------+--+| a.id | a.name | b.id | b.name |+-------+---------+-------+---------+--+| 1 | a | NULL | NULL || 2 | b | 2 | bb || 3 | c | 3 | cc || 4 | d | NULL | NULL || 7 | y | 7 | yy || 8 | u | NULL | NULL |+-------+---------+-------+---------+--+**right joinselect * from a right join b on a.id=b.id;**select * from a full outer join b on a.id=b.id;+-------+---------+-------+---------+--+| a.id | a.name | b.id | b.name |+-------+---------+-------+---------+--+| 1 | a | NULL | NULL || 2 | b | 2 | bb || 3 | c | 3 | cc || 4 | d | NULL | NULL || 7 | y | 7 | yy || 8 | u | NULL | NULL || NULL | NULL | 9 | pp |+-------+---------+-------+---------+--+**select * from a left semi join b on a.id = b.id;+-------+---------+--+| a.id | a.name |+-------+---------+--+| 2 | b || 3 | c || 7 | y |+-------+---------+--+ 17. Hiveè‡ªå®šä¹‰å‡½æ•° &amp; Transform17.1 è‡ªå®šä¹‰å‡½æ•°ç±»åˆ« UDF ä½œç”¨äºŽå•ä¸ªæ•°æ®è¡Œï¼Œäº§ç”Ÿä¸€ä¸ªæ•°æ®è¡Œä½œä¸ºè¾“å‡ºã€‚ï¼ˆæ•°å­¦å‡½æ•°ï¼Œå­—ç¬¦ä¸²å‡½æ•°ï¼‰ UDAF (ç”¨æˆ·å®šä¹‰èšé›†å‡½æ•°)ï¼šæŽ¥æ”¶å¤šä¸ªè¾“å…¥æ•°æ®è¡Œï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªè¾“å‡ºæ•°æ®è¡Œã€‚ï¼ˆcountï¼Œmaxï¼‰ 17.2 UDF å¼€å‘å®žä¾‹17.2.1 ç®€å•å…¥é—¨ å…ˆå¼€å‘ä¸€ä¸ªjavaç±»ï¼Œç»§æ‰¿UDFï¼Œå¹¶é‡è½½evaluateæ–¹æ³• 12345678910package com.rox.hive.udf;import org.apache.hadoop.hive.ql.exec.UDF;public class ToLowerCase extends UDF &#123; // å¿…é¡»æ˜¯ public public String evaluate(String field) &#123; String res = field.toLowerCase(); return res; &#125;&#125; æ‰“æˆjaråŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨ å°†jaråŒ…æ·»åŠ åˆ°hiveçš„classpath hive&gt;add JAR /home/ap/udf.jar; åˆ›å»ºä¸´æ—¶å‡½æ•°ä¸Žå¼€å‘å¥½çš„java classå…³è” Hive&gt;create temporary function tolowercase as &#39;com.rox.hive.udf.ToLowerCase&#39;; å³å¯åœ¨hqlä¸­ä½¿ç”¨è‡ªå®šä¹‰çš„å‡½æ•°strip select tolowercase(name) from t_1.. 17.2.2 ç¨ç¨å¤æ‚123456789101112131415161718192021222324252627282930313233343536373839404142# éœ€æ±‚: é€šè¿‡ä¸€äº›æ‰‹æœºå·åˆ¤æ–­æ‰‹æœºåŒºåŸŸ1364535532,101374535532,421384535532,341364535532,451384535532,22136-beijing137-shanghai138-guangzhou-----## 1.ç¼–å†™ UDF public static HashMap&lt;String, String&gt; provinceMap = new HashMap&lt;String, String&gt;(); static &#123; provinceMap.put("136", "beijing"); provinceMap.put("136", "shanghai"); provinceMap.put("136", "guangzhou"); &#125; public String evaluate(String phoneNum) &#123; return provinceMap.get(phoneNum.substring(0, 3)) == null ? "huoxing" : provinceMap.get(phoneNum.substring(0, 3)); &#125; ## 2.æ‰“åŒ…ä¸Šä¼ , æ·»åŠ åˆ° classpath, åˆ›å»ºä¸´æ—¶å‡½æ•°## 3.åˆ›å»ºè¡¨,åŠ è½½æ•°æ®create table flow_t(pnum string,flow int)row format delimited fields terminated by ',';load data local inpath '/home/ap/ihivedata/flow.tmp' into table flow_t;## 4.ä½¿ç”¨0: jdbc:hive2://cs2:10000&gt; select pnum,tolow(pnum),flow from flow_t;+-------------+------------+-------+| pnum | _c1 | flow |+-------------+------------+-------+| 1364535532 | guangzhou | 10 || 1374535532 | huoxing | 42 || 1384535532 | huoxing | 34 || 1364535532 | guangzhou | 45 || 1384535532 | huoxing | 22 |+-------------+------------+-------+ 17.2.3 æœ‰äº›å¤æ‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788# è§£æž json æ•°æ®è¡¨ rating.json## 1. å†™ udf//ï£¿ï£¿ï£¿ï£¿ï£¿ com.rox.json.MovieRateBean ï£¿ï£¿ï£¿ï£¿package com.rox.json;import lombok.Getter;import lombok.Setter;@Getter@Setterpublic class MovieRateBean &#123; private String movie; private String rate; private String timeStamp; private String uid; @Override public String toString() &#123; return movie + "\t" + rate + "\t" + timeStamp + "\t" + uid; &#125;&#125;//ï£¿ï£¿ï£¿ï£¿ com.rox.json.JsonParser ï£¿ï£¿ï£¿ï£¿package com.rox.json;import java.io.IOException;import org.apache.hadoop.hive.ql.exec.UDF;import com.fasterxml.jackson.databind.ObjectMapper;public class JsonParser extends UDF &#123; public String evaluate(String jsonLine) &#123; ObjectMapper objectMapper = new ObjectMapper(); try &#123; MovieRateBean bean = objectMapper.readValue(jsonLine, MovieRateBean.class); return bean.toString(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; return ""; &#125;&#125;====================================================## 2.æ‰“åŒ…ä¸Šä¼ , æ·»åŠ åˆ° classpath, åˆ›å»ºä¸´æ—¶å‡½æ•°, æ£€æŸ¥æ˜¯å¦æˆåŠŸshow functions;## 3.åˆ›å»ºè¡¨,åŠ è½½æ•°æ®create table t_json(line string) row format delimited;load data local inpath '/home/ap/ihivedata/flow.log' into table t_json;## 4.æ£€æŸ¥æ•°æ®select * from t_json limit 10;## 5.è°ƒç”¨å‡½æ•°0: jdbc:hive2://cs2:10000&gt; select jsonparser(line)parsedline from t_json limit 10;+---------------------+| parsedline |+---------------------+| 1193 5 978300760 1 || 661 3 978302109 1 || 914 3 978301968 1 || 3408 4 978300275 1 || 2355 5 978824291 1 || 1197 3 978302268 1 || 1287 5 978302039 1 || 2804 5 978300719 1 || 594 4 978302268 1 || 919 4 978301368 1 |+---------------------+// ä½†æ˜¯è¿™æ ·åªæ˜¯æŠŠæ¯ä¸€è¡Œè§£æžå‡ºæ¥äº†, ## 6.åˆ é™¤åŽŸæ¥çš„è¡¨ drop table if exists t_rating;## 7.é‡æ–°åˆ›å»ºä¸€ä¸ªè¡¨create table t_rating(movieid string,rate int,timestring string,uid string)row format delimited fields terminated by '\t';## 8.æ ¹æ®æŸ¥å‡ºæ¥çš„æ¯ä¸€è¡Œ, æŒ‰ç…§ '\t'åˆ†å‰², ç„¶åŽå†æ’å…¥åˆ°è¡¨ä¸­create table t_rating asselect split(jsonparser(line),'\t')[0]as movieid, split(jsonparser(line),'\t')[1] as rate, split(jsonparser(line),'\t')[2] as timestring, split(jsonparser(line),'\t')[3] as uid from t_json limit 10;// ä½†æ˜¯æ‰§è¡Œç»“æžœä¼šæŠ¥é”™,ä¸çŸ¥é“ä¸ºå•¥,éš¾é“æ˜¯ java ä»£ç çš„é—®é¢˜? :TODO-------## 9.å†…ç½®jsonå‡½æ•°select get_json_object(line,'$.movie') as moive,get_json_object(line,'$.rate') as rate from rat_json limit 10; 17.3 Transformå®žçŽ°12345678910111213141516171819202122232425262728293031323334353637383940414243# 1ã€å…ˆåŠ è½½rating.jsonæ–‡ä»¶åˆ°hiveçš„ä¸€ä¸ªåŽŸå§‹è¡¨ t_jsoncreate table rat_json(line string) row format delimited;load data local inpath '/home/ap/rating.json' into table t_json;2ã€éœ€è¦è§£æžjsonæ•°æ®æˆå››ä¸ªå­—æ®µï¼Œæ’å…¥ä¸€å¼ æ–°çš„è¡¨ t_ratingdrop table if exists t_rating;# åˆ›å»ºè¡¨create table t_rating(movieid string,rate int,timestring string,uid string)row format delimited fields terminated by '\t';# æ’å…¥, ä¹Ÿå¯ä»¥ç›´æŽ¥åˆ›å»º create table xx as + select...insert overwrite table t_ratingselect get_json_object(line,'$.movie') as moiveid, get_json_object(line,'$.rate') as rate, get_json_object(line,'$.timeStamp') as timestring,get_json_object(line,'$.uid') as uid from t_json;3. å†™ä¸€ä¸ª python è„šæœ¬vi weekday_mapper.py#!/bin/pythonimport sysimport datetimefor line in sys.stdin: line = line.strip() movieid, rating, timestring,userid = line.split('\t') weekday = datetime.datetime.fromtimestamp(float(timestring)).isoweekday() print '\t'.join([movieid, rating, str(weekday),userid]) 4. ä¿å­˜æ–‡ä»¶, ç„¶åŽå°†æ–‡ä»¶åŠ å…¥ hive çš„ classpathhive&gt;add FILE /home/hadoop/weekday_mapper.py;5. æ­¤æ—¶å¯ä»¥ç›´æŽ¥åˆ›å»ºæ–°è¡¨hive&gt;create TABLE u_data_new asSELECT TRANSFORM (movieid, rate, timestring,uid) USING 'python weekday_mapper.py' AS (movieid, rate, weekday,uid)FROM t_rating;6. æŸ¥è¯¢ç»“æžœ## distinctçœ‹çœ‹æœ‰å¤šå°‘ä¸ªä¸é‡å¤çš„æ•°å­—select distinct(weekday) from u_data_new limit 10; 18. æ¡ˆä¾‹18.1 å¹¿å‘ŠæŽ¨é€-ç”¨æˆ·ç”»åƒçš„ä»‹ç»ä¸€ä¸ªå¹¿å‘ŠæŽ¨é€å¹³å°çš„é¡¹ç›®ç»“æž„ç¤ºæ„å›¾ 18.2 ç´¯è®¡æŠ¥è¡¨å®žçŽ°å¥—è·¯(é¢è¯•)é¢˜: æ±‚æ¯ä¸ªæœˆçš„ç´¯è®¡è®¿é—®æ¬¡æ•° æ­¤å¤„çš„è®¿é—®æ¬¡æ•°å¯ä»¥æ¢æˆå·¥èµ„,ç­‰ç­‰.. æœ‰å¦‚ä¸‹è®¿å®¢è®¿é—®æ¬¡æ•°ç»Ÿè®¡è¡¨ t_access_times è®¿å®¢ æœˆä»½ è®¿é—®æ¬¡æ•° A 2015-01 5 A 2015-01 15 B 2015-01 5 A 2015-01 8 B 2015-01 25 A 2015-01 5 A 2015-02 4 A 2015-02 6 B 2015-02 10 B 2015-02 5 â€¦â€¦ â€¦â€¦ â€¦â€¦ éœ€è¦è¾“å‡ºæŠ¥è¡¨ï¼št_access_times_accumulate è®¿å®¢ æœˆä»½ æœˆè®¿é—®æ€»è®¡ ç´¯è®¡è®¿é—®æ€»è®¡ A 2015-01 33 33 A 2015-02 10 43 â€¦â€¦. â€¦â€¦. â€¦â€¦. â€¦â€¦. B 2015-01 30 30 B 2015-02 15 45 â€¦â€¦. â€¦â€¦. â€¦â€¦. â€¦â€¦. è§£é¢˜ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081# å‡†å¤‡æ•°æ®vi t_access_timesA,2015-01,5A,2015-01,15B,2015-01,5A,2015-01,8B,2015-01,254A,2015-01,5A,2015-02,4A,2015-02,6B,2015-02,10B,2015-02,5----# å»ºè¡¨create table t_access_times(username string,month string,salary int)row format delimited fields terminated by ',';# åŠ è½½æ•°æ®load data local inpath '/home/ap/t_access_times' into table t_access_times;1ã€ç¬¬ä¸€æ­¥ï¼Œå…ˆæ±‚ä¸ªç”¨æˆ·çš„æœˆæ€»é‡‘é¢select username,month,sum(salary) as salary from t_access_times group by username,month;+-----------+----------+---------+--+| username | month | salary |+-----------+----------+---------+--+| A | 2015-01 | 33 || A | 2015-02 | 10 || B | 2015-01 | 30 || B | 2015-02 | 15 |+-----------+----------+---------+--+2ã€ç¬¬äºŒæ­¥ï¼Œå°†æœˆæ€»é‡‘é¢è¡¨ è‡ªå·±è¿žæŽ¥ è‡ªå·±è¿žæŽ¥create table aa as(select username,month,sum(salary) as salary from t_access_times group by username,month) A inner join (select username,month,sum(salary) as salary from t_access_times group by username,month) BA.username=B.username+-------------+----------+-----------+-------------+----------+-----------+--+| a.username | a.month | a.salary | b.username | b.month | b.salary |+-------------+----------+-----------+-------------+----------+-----------+--+| A | 2015-01 | 33 | A | 2015-01 | 33 || A | 2015-01 | 33 | A | 2015-02 | 10 || A | 2015-02 | 10 | A | 2015-01 | 33 || A | 2015-02 | 10 | A | 2015-02 | 10 || B | 2015-01 | 30 | B | 2015-01 | 30 || B | 2015-01 | 30 | B | 2015-02 | 15 || B | 2015-02 | 15 | B | 2015-01 | 30 || B | 2015-02 | 15 | B | 2015-02 | 15 |+-------------+----------+-----------+-------------+----------+-----------+--+3ã€ç¬¬ä¸‰æ­¥ï¼Œä»Žä¸Šä¸€æ­¥çš„ç»“æžœä¸­è¿›è¡Œåˆ†ç»„æŸ¥è¯¢ï¼Œåˆ†ç»„çš„å­—æ®µæ˜¯a.username a.monthæ±‚æœˆç´¯è®¡å€¼ï¼š å°†b.month &lt;= a.monthçš„æ‰€æœ‰b.salaryæ±‚å’Œå³å¯select A.username,A.month,max(A.salary) as salary,sum(B.salary) as accumulatefrom (select username,month,sum(salary) as salary from t_access_times group by username,month) A inner join (select username,month,sum(salary) as salary from t_access_times group by username,month) BonA.username=B.usernamewhere B.month &lt;= A.monthgroup by A.username,A.monthorder by A.username,A.month;+-------------+----------+---------+-------------+| a.username | a.month | salary | accumulate |+-------------+----------+---------+-------------+| A | 2015-01 | 33 | 33 || A | 2015-02 | 10 | 43 || B | 2015-01 | 259 | 259 || B | 2015-02 | 15 | 274 |+-------------+----------+---------+-------------+ 18.3 å¾…åšé¡¹ç›® 19.æ³¨æ„ç‚¹ ä½¿ç”¨èšåˆå‡½æ•°, åŽé¢ä¸€å®šè¦åˆ†ç»„(group by xxx), group by ä¼šè‡ªåŠ¨åŽ»é‡ å¦‚æžœ sql è¯­å¥ä¸­æœ‰ group by, é‚£ä¹ˆ select åŽé¢å¿…é¡»æœ‰ group by çš„å­—æ®µ, æˆ–èšåˆå‡½æ•° ä½¿ç”¨order by æŽ’åºæŸä¸ªå­—æ®µæ—¶, å¿…é¡»åœ¨ selectä¸­å‡ºçŽ°æ­¤å­—æ®µ, å¦åˆ™ä¼šæ‰¾ä¸åˆ° :TODO å¾…éªŒè¯]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Hive</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Hive</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MapReduce-ç®€å•æ€»ç»“]]></title>
    <url>%2F2018%2F06%2F12%2FHadoop%2F2-MapReduce%2FMapReduce-%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[MapReduceåœ¨ç¼–ç¨‹çš„æ—¶å€™ï¼ŒåŸºæœ¬ä¸Šä¸€ä¸ªå›ºåŒ–çš„æ¨¡å¼ï¼Œæ²¡æœ‰å¤ªå¤šå¯çµæ´»æ”¹å˜çš„åœ°æ–¹ï¼Œé™¤äº†ä»¥ä¸‹å‡ å¤„ï¼š è¾“å…¥æ•°æ®æŽ¥å£ï¼šInputFormat FileInputFormat (æ–‡ä»¶ç±»åž‹æ•°æ®è¯»å–çš„é€šç”¨æŠ½è±¡ç±») DBInputFormat ï¼ˆæ•°æ®åº“æ•°æ®è¯»å–çš„é€šç”¨æŠ½è±¡ç±»ï¼‰ é»˜è®¤ä½¿ç”¨çš„å®žçŽ°ç±»æ˜¯ï¼š TextInputFormat job.setInputFormatClass(TextInputFormat.class) TextInputFormatçš„åŠŸèƒ½é€»è¾‘æ˜¯ï¼šä¸€æ¬¡è¯»ä¸€è¡Œæ–‡æœ¬ï¼Œç„¶åŽå°†è¯¥è¡Œçš„èµ·å§‹åç§»é‡ä½œä¸ºkeyï¼Œè¡Œå†…å®¹ä½œä¸ºvalueè¿”å›ž é€»è¾‘å¤„ç†æŽ¥å£ï¼š Mapper å®Œå…¨éœ€è¦ç”¨æˆ·è‡ªå·±åŽ»å®žçŽ°å…¶ä¸­ map() setup() clean() mapè¾“å‡ºçš„ç»“æžœåœ¨shuffleé˜¶æ®µä¼šè¢«partitionä»¥åŠsortï¼Œæ­¤å¤„æœ‰ä¸¤ä¸ªæŽ¥å£å¯è‡ªå®šä¹‰ï¼š Partitioner æœ‰é»˜è®¤å®žçŽ° HashPartitionerï¼Œé€»è¾‘æ˜¯æ ¹æ®keyå’ŒnumReducesæ¥è¿”å›žä¸€ä¸ªåˆ†åŒºå·:key.hashCode()&amp;Integer.MAXVALUE % numReduces é€šå¸¸æƒ…å†µä¸‹ï¼Œç”¨é»˜è®¤çš„è¿™ä¸ªHashPartitionerå°±å¯ä»¥ï¼Œå¦‚æžœä¸šåŠ¡ä¸Šæœ‰ç‰¹åˆ«çš„éœ€æ±‚ï¼Œå¯ä»¥è‡ªå®šä¹‰ ç»§æ‰¿ Partitioner, é‡å†™getPartitionæ–¹æ³•, å…·ä½“è§è¿™é‡Œ Comparable å½“æˆ‘ä»¬ç”¨è‡ªå®šä¹‰çš„å¯¹è±¡ä½œä¸ºkeyæ¥è¾“å‡ºæ—¶ï¼Œå°±å¿…é¡»è¦å®žçŽ°WritableComparableæŽ¥å£ï¼Œoverrideå…¶ä¸­çš„compareTo()æ–¹æ³•, å…·ä½“è§è¿™é‡Œ reduceç«¯çš„æ•°æ®åˆ†ç»„æ¯”è¾ƒæŽ¥å£ ï¼š Groupingcomparator reduceTaskæ‹¿åˆ°è¾“å…¥æ•°æ®ï¼ˆä¸€ä¸ªpartitionçš„æ‰€æœ‰æ•°æ®ï¼‰åŽï¼Œé¦–å…ˆéœ€è¦å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå…¶åˆ†ç»„çš„é»˜è®¤åŽŸåˆ™æ˜¯keyç›¸åŒï¼Œç„¶åŽå¯¹æ¯ä¸€ç»„kvæ•°æ®è°ƒç”¨ä¸€æ¬¡reduce()æ–¹æ³•ï¼Œå¹¶ä¸”å°†è¿™ä¸€ç»„kvä¸­çš„ç¬¬ä¸€ä¸ªkvçš„keyä½œä¸ºå‚æ•°ä¼ ç»™reduceçš„keyï¼Œå°†è¿™ä¸€ç»„æ•°æ®çš„valueçš„è¿­ä»£å™¨ä¼ ç»™reduce()çš„valueså‚æ•° åˆ©ç”¨ä¸Šè¿°è¿™ä¸ªæœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å®žçŽ°ä¸€ä¸ªé«˜æ•ˆçš„åˆ†ç»„å–æœ€å¤§å€¼çš„é€»è¾‘ï¼š è‡ªå®šä¹‰ä¸€ä¸ªbeanå¯¹è±¡ç”¨æ¥å°è£…æˆ‘ä»¬çš„æ•°æ®ï¼Œç„¶åŽæ”¹å†™å…¶compareToæ–¹æ³•äº§ç”Ÿå€’åºæŽ’åºçš„æ•ˆæžœ ç„¶åŽè‡ªå®šä¹‰ä¸€ä¸ªGroupingcomparatorï¼Œå°†beanå¯¹è±¡çš„åˆ†ç»„é€»è¾‘æ”¹æˆæŒ‰ç…§æˆ‘ä»¬çš„ä¸šåŠ¡åˆ†ç»„idæ¥åˆ†ç»„ï¼ˆæ¯”å¦‚è®¢å•å·ï¼‰ è¿™æ ·ï¼Œæˆ‘ä»¬è¦å–çš„æœ€å¤§å€¼å°±æ˜¯reduce()æ–¹æ³•ä¸­ä¼ è¿›æ¥key é€»è¾‘å¤„ç†æŽ¥å£ï¼šReducer å®Œå…¨éœ€è¦ç”¨æˆ·è‡ªå·±åŽ»å®žçŽ°å…¶ä¸­ reduce() setup() clean() è¾“å‡ºæ•°æ®æŽ¥å£ï¼š OutputFormat æœ‰ä¸€ç³»åˆ—å­ç±» FileOutputformat DBoutputFormat â€¦.. é»˜è®¤å®žçŽ°ç±»æ˜¯TextOutputFormat åŠŸèƒ½é€»è¾‘æ˜¯ï¼š å°†æ¯ä¸€ä¸ªKVå¯¹å‘ç›®æ ‡æ–‡æœ¬æ–‡ä»¶ä¸­è¾“å‡ºä¸ºä¸€è¡Œ â€‹]]></content>
      <categories>
        <category>Hadoop</category>
        <category>MapReduce</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>MapReduce</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hiveå­¦ä¹ -1-å®‰è£…]]></title>
    <url>%2F2018%2F06%2F12%2FHadoop%2F3-Hive%2FHive%E5%AD%A6%E4%B9%A0-1%2F</url>
    <content type="text"><![CDATA[Hiveç®€ä»‹ HiveåŸºæœ¬æƒ…å†µHive æ˜¯å»ºç«‹åœ¨ Hadoop ä¸Šçš„æ•°æ®ä»“åº“åŸºç¡€æž„æž¶ ç”±facebookå¼€æºï¼Œæœ€åˆç”¨äºŽè§£å†³æµ·é‡ç»“æž„åŒ–çš„æ—¥å¿—æ•°æ®ç»Ÿ è®¡é—®é¢˜; ETL(Extraction-Transformation-Loading)å·¥å…· æž„å»ºåœ¨Hadoopä¹‹ä¸Šçš„æ•°æ®ä»“åº“; æ•°æ®è®¡ç®—ä½¿ç”¨MRï¼Œæ•°æ®å­˜å‚¨ä½¿ç”¨HDFS æ•°æ®åº“&amp;æ•°æ®ä»“åº“ çš„åŒºåˆ«ï¼š æ¦‚å¿µä¸Š æ•°æ®åº“ï¼šç”¨äºŽç®¡ç†ç²¾ç»†åŒ–æ•°æ®ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç”¨äºŽå­˜å‚¨ç»“æžœæ•°æ®ï¼Œåˆ†åº“åˆ†è¡¨è¿›è¡Œå­˜å‚¨ æ•°æ®ä»“åº“ï¼šå­˜å‚¨ã€æŸ¥è¯¢ã€åˆ†æžå¤§è§„æ¨¡æ•°æ® ã€‚æ›´åƒä¸€ä¸ªæ‰“åŒ…çš„è¿‡ç¨‹ï¼Œé‡Œé¢å­˜å‚¨çš„æ•°æ®æ²¡æœ‰ç»†åŒ–åŒºåˆ†ï¼Œç²’åº¦è¾ƒç²— ç”¨é€”ä¸Šï¼š æ•°æ®åº“ï¼šOLTPï¼Œon line Transation Processing è”æœºäº‹åŠ¡å¤„ç†ï¼Œå¢žåˆ æ”¹ æ•°æ®ä»“åº“ï¼šOLAPï¼Œon line analysis Processing è”æœºäº‹åŠ¡åˆ†æžå¤„ç†ï¼ŒæŸ¥è¯¢ï¼Œhiveä¸æ”¯æŒåˆ é™¤ã€ä¿®æ”¹ã€‚ æ”¯æŒæ’å…¥ã€‚ ä½¿ç”¨ä¸Šï¼š æ•°æ®åº“ï¼šæ ‡å‡†sql, hbase: éžæ ‡å‡†sql æ•°æ®ä»“åº“ï¼šæ–¹è¨€ç‰ˆçš„sqlï¼Œ HQL æ¨¡å¼ä¸Šï¼š æ•°æ®åº“ï¼šå†™æ¨¡å¼ æ•°æ®ä»“åº“ï¼šè¯»æ¨¡å¼ å¯ä»¥å°†ç»“æž„åŒ–çš„æ•°æ®æ˜ å°„æˆä¸€å¼ æ•°æ®åº“è¡¨ ç»“æž„åŒ–æ•°æ®æ˜ å°„æˆäºŒç»´è¡¨ å°†æ–‡æœ¬ä¸­æ¯ä¸€è¡Œæ•°æ®æ˜ å°„ä¸ºæ•°æ®åº“çš„æ¯ä¸€æ¡æ•°æ® å°†æ–‡æœ¬ä¸­æ¯ä¸€åˆ—æ•°æ®æ˜ å°„ä¸ºhiveçš„è¡¨å­—æ®µ æä¾›HQL æŸ¥è¯¢åŠŸèƒ½ hive query languageï¼Œ æ–¹è¨€ç‰ˆsql åº•å±‚æ•°æ®æ˜¯å­˜å‚¨åœ¨HDFSä¸Š hiveä¸Šå»ºçš„è¡¨ä»…ä»…ç›¸å½“äºŽå¯¹hdfsä¸Šçš„ç»“æž„åŒ–æ•°æ®è¿›è¡Œæ˜ å°„ç®¡ç† hiveä»…ä»…æ˜¯ä¸€ä¸ªç®¡ç†æ•°æ®çš„ä½œç”¨ï¼Œè€Œä¸ä¼šå­˜å‚¨æ•°æ® hiveæƒ³è¦ç®¡ç†hdfsä¸Šçš„æ•°æ®ï¼Œå°±è¦å»ºç«‹ä¸€ä¸ªå…³è”å…³ç³»ï¼Œå…³è”hiveä¸Šçš„è¡¨å’Œhdfsä¸Šçš„æ•°æ®è·¯å¾„ æ•°æ®æ˜¯ä¾èµ–äºŽä¸€ä¸ªå…ƒæ•°æ®åº“ å…ƒæ•°æ®åº“é‡‡ç”¨çš„æ˜¯å…³ç³»åž‹æ•°æ®åº“ï¼Œ çœŸå®žç”Ÿäº§ä¸­ä¸€èˆ¬ä½¿ç”¨mysqlä¸ºhiveçš„å…ƒæ•°æ®åº“ï¼Œhiveå†…ç½®é»˜è®¤çš„å…ƒæ•°æ®åº“æ˜¯ derby å…ƒæ•°æ®ï¼š HCalalog hiveä¸­çš„è¡¨å’Œhdfsçš„æ˜ å°„å…³ç³»ï¼Œä»¥åŠhiveè¡¨å±žæ€§ï¼ˆå†…éƒ¨è¡¨ï¼Œå¤–éƒ¨è¡¨ï¼Œè§†å›¾ï¼‰å’Œå­—æ®µä¿¡æ¯ å…ƒæ•°æ®ä¸€æ—¦ä¿®é¥°ï¼Œhiveçš„æ‰€æœ‰æ˜ å°„å…³ç³»ç­‰éƒ½æ²¡äº†ï¼Œå°±æ— æ³•ä½¿ç”¨äº† å¯ä¸ŽPigã€Prestoç­‰å…±äº« Hiveçš„æ˜¯æž„å»ºåœ¨Hadoopä¹‹ä¸Šçš„æ•°æ®ä»“åº“ æ•°æ®è®¡ç®—ä½¿ç”¨MRï¼Œæ•°æ®å­˜å‚¨ä½¿ç”¨HDFS é€šå¸¸ç”¨äºŽè¿›è¡Œç¦»çº¿æ•°æ®å¤„ç†(é‡‡ç”¨MapReduce) å¯è®¤ä¸ºæ˜¯ä¸€ä¸ªHQLâ€”-&gt;MRçš„è¯­è¨€ç¿»è¯‘å™¨ Hiveä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼š ç®€å•ï¼Œå®¹æ˜“ä¸Šæ‰‹ æä¾›äº†ç±»SQLæŸ¥è¯¢è¯­è¨€HQL ä¸ºè¶…å¤§æ•°æ®é›†è®¾è®¡çš„è®¡ç®—/æ‰©å±•èƒ½åŠ› MRä½œä¸ºè®¡ç®—å¼•æ“Žï¼ŒHDFSä½œä¸ºå­˜å‚¨ç³»ç»Ÿ ç»Ÿä¸€çš„å…ƒæ•°æ®ç®¡ç†(HCalalog) å¯ä¸ŽPigã€Prestoç­‰å…±äº« ç¼ºç‚¹ ä¸æ”¯æŒ åˆ é™¤ &amp; ä¿®æ”¹ delete&amp;updateï¼Œä¸æ”¯æŒäº‹åŠ¡ å› ä¸ºæ˜¯åŸºäºŽHDFS hiveåšçš„æœ€å¤šçš„æ˜¯æŸ¥è¯¢ Hiveçš„HQLè¡¨è¾¾çš„èƒ½åŠ›æœ‰é™ è¿­ä»£å¼ç®—æ³•æ— æ³•è¡¨è¾¾ æœ‰äº›å¤æ‚è¿ç®—ç”¨HQLä¸æ˜“è¡¨è¾¾ Hiveæ•ˆçŽ‡è¾ƒä½Žï¼ŒæŸ¥è¯¢å»¶æ—¶é«˜ Hiveè‡ªåŠ¨ç”ŸæˆMapReduceä½œä¸šï¼Œé€šå¸¸ä¸å¤Ÿæ™ºèƒ½ HQLè°ƒä¼˜å›°éš¾ï¼Œç²’åº¦è¾ƒç²— å¯æŽ§æ€§å·® Hiveä¸Žä¼ ç»Ÿå…³ç³»åž‹æ•°æ®åº“(RDBMSï¼‰å¯¹æ¯” Hiveçš„æž¶æž„ 1) ç”¨æˆ·æŽ¥å£ CLIï¼šCommand Line Interfaceï¼Œå³Shellç»ˆç«¯å‘½ä»¤è¡Œï¼Œä½¿ç”¨ Hive å‘½ä»¤è¡Œä¸Ž Hive è¿›è¡Œäº¤äº’ï¼Œæœ€å¸¸ç”¨ï¼ˆå­¦ä¹ ï¼Œè°ƒè¯•ï¼Œç”Ÿäº§ï¼‰ï¼ŒåŒ…æ‹¬ä¸¤ç§è¿è¡Œæ–¹å¼ï¼š hiveå‘½ä»¤æ–¹å¼ï¼šå‰æå¿…é¡»åœ¨hiveå®‰è£…èŠ‚ç‚¹ä¸Šæ‰§è¡Œ hiveserver2æ–¹å¼ï¼šhiveå®‰è£…èŠ‚ç‚¹å°†hiveå¯åŠ¨ä¸ºä¸€ä¸ªåŽå°è¿›ç¨‹ï¼Œå®¢æˆ·æœºè¿›è¡Œè¿žæŽ¥ï¼ˆç±»ä¼¼äºŽå¯åŠ¨äº†ä¸€ä¸ªhiveæœåŠ¡ç«¯ï¼‰ çœŸå®žç”Ÿäº§ä¸­å¸¸ç”¨ï¼ - 1) ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå…è®¸è¿œç¨‹è¿žæŽ¥; ç¬¬ä¸€ï¼šä¿®æ”¹ hdfs-site.xmlï¼ŒåŠ å…¥ä¸€æ¡é…ç½®ä¿¡æ¯ï¼Œå¯ç”¨ webhdfsï¼› ç¬¬äºŒï¼šä¿®æ”¹ core-site.xmlï¼ŒåŠ å…¥ä¸¤æ¡é…ç½®ä¿¡æ¯ï¼Œè®¾ç½® hadoopçš„ä»£ç†ç”¨æˆ·ã€‚ - 2) å¯åŠ¨æœåŠ¡è¿›ç¨‹ - å‰å°å¯åŠ¨ï¼šhiveserver2 - åŽå°å¯åŠ¨ - è®°å½•æ—¥å¿—ï¼šnohup hiveserver2 1&gt;/home/sigeon/hiveserver.log 2&gt;/home/sigeon/hiveserver.err &amp; 0ï¼šæ ‡å‡†æ—¥å¿—è¾“å…¥ 1ï¼šæ ‡å‡†æ—¥å¿—è¾“å‡º 2ï¼šé”™è¯¯æ—¥å¿—è¾“å‡º å¦‚æžœæˆ‘æ²¡æœ‰é…ç½®æ—¥å¿—çš„è¾“å‡ºè·¯å¾„ï¼Œæ—¥å¿—ä¼šç”Ÿæˆåœ¨å½“å‰å·¥ä½œç›®å½•ï¼Œé»˜è®¤çš„æ—¥å¿—åç§°å«åšï¼š nohup.xxx - ä¸è®°å½•æ—¥å¿—ï¼šnohup hiveserver2 1&gt;/dev/null 2&gt;/dev/null &amp; - [è¡¥å……ï¼š] - nohupå‘½ä»¤ï¼šno hang upçš„ç¼©å†™ï¼Œå³ä¸æŒ‚èµ·ï¼Œå¯ä»¥åœ¨ä½ é€€å‡ºå¸æˆ·/å…³é—­ç»ˆç«¯ä¹‹åŽç»§ç»­è¿è¡Œç›¸åº”çš„è¿›ç¨‹ã€‚ - è¯­æ³•ï¼šnohup &lt;command&gt; &amp; - 3) å¼€å¯beenlineå®¢æˆ·ç«¯å¹¶è¿žæŽ¥ï¼š - æ–¹æ³•ä¸€ï¼š - beenlineï¼Œå¼€å¯beenlineå®¢æˆ·ç«¯; - !connect jdbc:&lt;hive2://master:10000&gt;ï¼Œå›žè½¦ã€‚ç„¶åŽè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œè¿™ä¸ªç”¨æˆ·åæ˜¯å®‰è£… hadoop é›†ç¾¤çš„ç”¨æˆ·å - æ–¹æ³•äºŒï¼š - beeline -u jdbc:&lt;hive2://master:10000&gt; -n sigeon JDBC/ODBCï¼šæ˜¯ Hive çš„åŸºäºŽ JDBC æ“ä½œæä¾›çš„å®¢æˆ·ç«¯ï¼Œç”¨æˆ·ï¼ˆå¼€å‘å‘˜ï¼Œè¿ç»´äººå‘˜ï¼‰é€šè¿‡ è¿™è¿žæŽ¥è‡³ Hive server æœåŠ¡ Web UIï¼šé€šè¿‡æµè§ˆå™¨è®¿é—® Hiveï¼ŒåŸºæœ¬ä¸ä¼šä½¿ç”¨ 2) å…ƒæ•°æ®åº“ï¼šä¿å­˜å…ƒæ•°æ®ï¼Œä¸€èˆ¬ä¼šé€‰ç”¨å…³ç³»åž‹æ•°æ®åº“ï¼ˆå¦‚mysqlï¼ŒHive å’Œ MySQL ä¹‹é—´é€šè¿‡ MetaStore æœåŠ¡äº¤äº’ï¼‰ 3) ThriftæœåŠ¡ï¼šFacebook å¼€å‘çš„ä¸€ä¸ªè½¯ä»¶æ¡†æž¶ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œå¯æ‰©å±•ä¸”è·¨è¯­è¨€çš„æœåŠ¡çš„å¼€å‘ï¼Œ Hive é›†æˆäº†è¯¥æœåŠ¡ï¼Œèƒ½è®©ä¸åŒçš„ç¼–ç¨‹è¯­è¨€è°ƒç”¨ Hive çš„æŽ¥å£ 4) é©±åŠ¨Driver a. è§£é‡Šå™¨ï¼šè§£é‡Šå™¨çš„ä½œç”¨æ˜¯å°† HiveSQL è¯­å¥è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ b. ç¼–è¯‘å™¨ï¼šç¼–è¯‘å™¨æ˜¯å°†è¯­æ³•æ ‘ç¼–è¯‘ä¸ºé€»è¾‘æ‰§è¡Œè®¡åˆ’ c. ä¼˜åŒ–å™¨ï¼šä¼˜åŒ–å™¨æ˜¯å¯¹é€»è¾‘æ‰§è¡Œè®¡åˆ’è¿›è¡Œä¼˜åŒ– d. æ‰§è¡Œå™¨ï¼šæ‰§è¡Œå™¨æ˜¯è°ƒç”¨åº•å±‚çš„è¿è¡Œæ¡†æž¶æ‰§è¡Œé€»è¾‘æ‰§è¡Œè®¡åˆ’ Hiveçš„æ•°æ®ç»„ç»‡æ ¼å¼ 1)åº“ï¼šdatabase 2) è¡¨ a. å†…éƒ¨è¡¨ï¼ˆç®¡ç†è¡¨ï¼šmanaged_tableï¼‰ b. å¤–éƒ¨è¡¨ï¼ˆexternal_tableï¼‰ å†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨åŒºåˆ«ï¼š å†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨æ˜¯ä¸¤ä¸ªç›¸å¯¹çš„æ¦‚å¿µï¼Œä¸å¯èƒ½æœ‰ä¸€ä¸ªè¡¨åŒæ—¶æ˜¯å†…éƒ¨è¡¨åˆæ˜¯å¤–éƒ¨è¡¨ï¼› å†…éƒ¨è¡¨åˆ é™¤è¡¨çš„æ—¶å€™ä¼šåˆ é™¤åŽŸå§‹æ•°æ®å’Œå…ƒæ•°æ®ï¼Œè€Œå¤–éƒ¨è¡¨åˆ é™¤è¡¨çš„æ—¶å€™åªä¼šåˆ é™¤å…ƒæ•°æ®ä¸ä¼šåˆ é™¤åŽŸå§‹æ•°æ® ä¸€èˆ¬æƒ…å†µä¸‹å­˜å‚¨å…¬å…±æ•°æ®çš„è¡¨å­˜æ”¾ä¸ºå¤–éƒ¨è¡¨ å¤§å¤šæ•°æƒ…å†µï¼Œä»–ä»¬çš„åŒºåˆ«ä¸æ˜Žæ˜¾ã€‚å¦‚æžœæ•°æ®çš„æ‰€æœ‰å¤„ç†éƒ½åœ¨ Hive ä¸­è¿›è¡Œï¼Œé‚£ä¹ˆå€¾å‘äºŽ é€‰æ‹©å†…éƒ¨è¡¨ï¼›ä½†æ˜¯å¦‚æžœ Hive å’Œå…¶ä»–å·¥å…·è¦é’ˆå¯¹ç›¸åŒçš„æ•°æ®é›†è¿›è¡Œå¤„ç†ï¼Œå¤–éƒ¨è¡¨æ›´åˆé€‚ã€‚ ä½¿ç”¨å¤–éƒ¨è¡¨è®¿é—®å­˜å‚¨åœ¨ HDFS ä¸Šçš„åˆå§‹æ•°æ®ï¼Œç„¶åŽé€šè¿‡ Hive è½¬æ¢æ•°æ®å¹¶å­˜åˆ°å†…éƒ¨è¡¨ä¸­ï¼Œä½¿ç”¨å¤–éƒ¨è¡¨çš„åœºæ™¯æ˜¯é’ˆå¯¹ä¸€ä¸ªæ•°æ®é›†æœ‰å¤šä¸ªä¸åŒçš„ Schemaã€‚ c. åˆ†åŒºè¡¨ ä¸åŒäºŽhadoopä¸­çš„åˆ†åŒºï¼Œåˆ†åŒºè¡¨æ˜¯äººä¸ºåˆ’åˆ†çš„ hiveæœ€ç»ˆå­˜å‚¨æµ·é‡æ•°æ®ï¼Œæµ·é‡æ•°æ®æŸ¥è¯¢ä¸€å®šæ³¨æ„é¿å…å…¨è¡¨æ‰«æ æŸ¥è¯¢çš„æ—¶å€™ä¸ºäº†æå‡æˆ‘ä»¬çš„æŸ¥è¯¢æ€§èƒ½ï¼Œå‡ºçŽ°äº†åˆ†åŒºè¡¨ å°†æ•°æ®æŒ‰ç…§ç”¨æˆ·çš„ä¸šåŠ¡å­˜å‚¨åˆ°ä¸åŒçš„ç›®å½•ä¸‹ï¼Œåœ¨è¿›è¡Œæ•°æ®æŸ¥è¯¢æ—¶åªä¼šå¯¹æŒ‡å®šåˆ†åŒºä¸‹çš„æ•°æ®è¿›è¡Œæ‰«æä¸€èˆ¬æƒ…å†µä¸‹ç”Ÿäº§ä¸­ç”¨æ—¥æœŸä½œä¸ºåˆ†åŒºå­—æ®µ d. åˆ†æ¡¶è¡¨ ç±»ä¼¼äºŽhadoopä¸­çš„åˆ†åŒºï¼Œæ˜¯ç”±ç¨‹åºå†³å®šçš„ï¼Œåªèƒ½æŒ‡å®šæ¡¶çš„ä¸ªæ•°ï¼ˆåˆ†åŒºçš„ä¸ªæ•°ï¼‰ æ ¹æ®hashç®—æ³•å°†ä½™æ•°ä¸åŒçš„è¾“å‡ºåˆ°ä¸åŒçš„æ–‡ä»¶ä¸­ ä½œç”¨ï¼š 1ï¼‰æå‡joinçš„æ€§èƒ½æ€è€ƒè¿™ä¸ªé—®é¢˜ï¼šselect a.id,a.name,b.addr from a join b on a.id = b.id;å¦‚æžœ a è¡¨å’Œ b è¡¨å·²ç»æ˜¯ åˆ†æ¡¶è¡¨ï¼Œè€Œä¸”åˆ†æ¡¶çš„å­—æ®µæ˜¯ id å­—æ®µåšè¿™ä¸ª join æ“ä½œæ—¶ï¼Œè¿˜éœ€è¦å…¨è¡¨åšç¬›å¡å°”ç§¯ 2ï¼‰æå‡æ•°æ®æ ·æœ¬çš„æŠ½å–æ•ˆçŽ‡ï¼Œç›´æŽ¥æ‹¿ä¸€ä¸ªæ¡¶ä¸­çš„æ•°æ®ä½œä¸ºæ ·æœ¬æ•°æ® åˆ†åŒºè¡¨å’Œåˆ†æ¡¶è¡¨çš„åŒºåˆ«ï¼š Hive æ•°æ®è¡¨å¯ä»¥æ ¹æ®æŸäº›å­—æ®µè¿›è¡Œåˆ†åŒºæ“ä½œï¼Œç»†åŒ–æ•°æ®ç®¡ç†ï¼Œå¯ä»¥è®©éƒ¨åˆ†æŸ¥è¯¢æ›´å¿«ã€‚ åŒæ—¶è¡¨å’Œåˆ†åŒºä¹Ÿå¯ä»¥è¿›ä¸€æ­¥è¢«åˆ’åˆ†ä¸º Bucketsï¼Œåˆ†æ¡¶è¡¨çš„åŽŸç†å’Œ MapReduce ç¼–ç¨‹ä¸­çš„ HashPartitioner çš„åŽŸç†ç±»ä¼¼ åˆ†åŒºå’Œåˆ†æ¡¶éƒ½æ˜¯ç»†åŒ–æ•°æ®ç®¡ç†ï¼Œä½†æ˜¯åˆ†åŒºè¡¨æ˜¯æ‰‹åŠ¨æ·»åŠ åŒºåˆ†ï¼Œç”±äºŽ Hive æ˜¯è¯»æ¨¡å¼ï¼Œæ‰€ä»¥å¯¹æ·»åŠ è¿›åˆ†åŒºçš„æ•°æ®ä¸åšæ¨¡å¼æ ¡éªŒ åˆ†æ¡¶è¡¨ä¸­çš„æ•°æ®æ˜¯æŒ‰ç…§æŸäº›åˆ†æ¡¶å­—æ®µè¿›è¡Œ hash æ•£åˆ— å½¢æˆçš„å¤šä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æ•°æ®çš„å‡†ç¡®æ€§ä¹Ÿé«˜å¾ˆå¤š 3)è§†å›¾ï¼š hiveä¸­çš„è§†å›¾ä»…ä»…ç›¸å½“äºŽä¸€ä¸ªsqlè¯­å¥çš„åˆ«å åœ¨hiveä¸­ä»…ä»…å­˜åœ¨é€»è¾‘è§†å›¾ï¼Œä¸å­˜åœ¨ç‰©ç†è§†å›¾ ç‰©ç†è§†å›¾ï¼šè®²sqlè¯­å¥çš„æ‰§è¡Œç»“æžœå­˜åœ¨è§†å›¾ä¸­ é€»è¾‘è§†å›¾ï¼š ä»…ä»…æ˜¯å¯¹æŸ¥è¯¢ç»“æžœçš„å¼•ç”¨ 4)æ•°æ®å­˜å‚¨ï¼š åŽŸå§‹æ•°æ®ä¸­å­˜åœ¨HDFS å…ƒæ•°æ®å­˜åœ¨mysql Hiveå®‰è£…è£…hiveå…¶å®žä¸éš¾ï¼Œä¸»è¦æ˜¯å®‰è£…mysqlï¼Œè§£å†³mysqlçš„æƒé™é—®é¢˜ MySqlå®‰è£…RPM å®‰è£…MySQlï¼š æ£€æŸ¥ä»¥å‰æ˜¯å¦è£…è¿‡ MySQL 1rpm -qa|grep -i mysql å‘çŽ°æœ‰çš„è¯å°±éƒ½å¸è½½ 12rpm -e --nodeps mysql-libs-5.1.73-5.el6_6.x86_64rpm -e --nodeps .... åˆ é™¤è€ç‰ˆæœ¬ mysql çš„å¼€å‘å¤´æ–‡ä»¶å’Œåº“ 12rm -rf /usr/lib64/mysql# åœ¨æœç´¢ my.cnf æ–‡ä»¶ï¼Œæœ‰çš„è¯å°±åˆ æŽ‰ ä¸Šä¼ mysql å®‰è£…åŒ…åˆ° Linuxä¸­ï¼Œè§£åŽ‹ 12345678tar -xvf mysql-5.6.26-1.linux_glibc2.5.x86_64.rpm-bundle.tar# è§£åŽ‹å‡ºæ¥æœ‰è¿™äº›æ–‡ä»¶MySQL-devel-5.6.26-1.linux_glibc2.5.x86_64.rpmMySQL-embedded-5.6.26-1.linux_glibc2.5.x86_64.rpmMySQL-server-5.6.26-1.linux_glibc2.5.x86_64.rpmMySQL-shared-5.6.26-1.linux_glibc2.5.x86_64.rpmMySQL-shared-compat-5.6.26-1.linux_glibc2.5.x86_64.rpmMySQL-test-5.6.26-1.linux_glibc2.5.x86_64.rpm å®‰è£… server &amp; client 1234# serverrpm -ivh MySQL-server-5.6.26-1.linux_glibc2.5.x86_64.rpm# clientrpm -ivh MySQL-client-5.6.26-1.linux_glibc2.5.x86_64.rpm å¯åŠ¨Mysql 1sudo service mysql start ç™»å½•Mysqlå¹¶æ”¹å¯†ç ï¼Œç­‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566# åˆå§‹å¯†ç åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­cat /root/.mysql_sercert # ç™»å½•mysql -uroot -pxxxxx# åˆ é™¤é™¤äº†`%`ä¹‹å¤–çš„å…¶ä»–æ‰€æœ‰hostuse mysql;select host,user,password from user;delete from user where host in (&apos;localhost&apos;, &apos;127.0.0.1&apos;,&apos;::1&apos;, ...)# ä¿®æ”¹å¯†ç  UPDATE user SET Password = PASSWORD(&apos;psd&apos;) WHERE user = &apos;root&apos;;# ä¸º`%` å’Œ `*` æ·»åŠ è¿œç¨‹ç™»å½•æƒé™ #æ³¨æ„ï¼š å‰é¢çš„ mysql ç™»å½•ç”¨æˆ·åï¼Œ 123 æ˜¯ç™»å½•å¯†ç GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos; IDENTIFIED BY &apos;psd&apos; WITH GRANT OPTION;GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;*&apos; IDENTIFIED BY &apos;psd&apos; WITH GRANT OPTION;FLUSH PRIVILEGES;# é€€å‡ºç™»å½•exit;# æ­¤æ—¶å¯ä»¥å†ç™»å½•è¯•è¯•mysql -uroot -ppsd======================================# ä¿®æ”¹å­—ç¬¦é›†ä¸º utf-8# æ–°å»ºä¸€ä¸ªæ–‡ä»¶vi /etc/my.cnf # æ·»åŠ ä»¥ä¸‹å†…å®¹[client]default-character-set=utf8[mysql]default-character-set=utf8[mysqld]character-set-server=utf8# é‡å¯mysqlsudo service mysql restart======================================# å¿˜è®°å¯†ç ï¼Œä¿®æ”¹å¯†ç çš„æ–¹æ³•# åœæ­¢mysqlæœåŠ¡çš„è¿è¡Œservice mysql stop# è·³è¿‡æŽˆæƒè¡¨è®¿é—®mysqld_safe --user=mysql --skip-grant-tables --skip-networking &amp; # ç™»å½•mysqlmysql -u root mysql # æŽ¥ä¸‹æ¥å¯ä»¥ä¿®æ”¹å¯†ç äº† ##åœ¨mysql5.7ä»¥ä¸‹çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼šmysql&gt; UPDATE user SET Password=PASSWORD(&apos;newpassword&apos;) where USER=&apos;rootâ€™ï¼› ##åœ¨mysql5.7ç‰ˆæœ¬å¦‚ä¸‹ï¼šupdate mysql.user set authentication_string=password(&apos;newpassword&apos;) ;# ä¿®æ”¹å®Œäº†é‡å¯service mysql restart====================================== MySqlçš„å…¶å®ƒé”™è¯¯åœ¨è¿è¡Œschematool -dbType mysql -initSchemaæ‰‹åŠ¨åˆå§‹åŒ–å…ƒæ•°æ®åº“çš„æ—¶å€™ æŠ¥äº†ä¸€ä¸ªlog4jé‡å¤åŠ è½½çš„é—®é¢˜ è§£å†³ï¼šå¯ä»¥ä¸ç”¨ç†ç¬ é“¾æŽ¥mysql å¯†ç è¿‡æœŸé—®é¢˜ Your password has expired. è§£å†³ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950mysql -uroot -p123mysql&gt; use mysqlReading table information for completion of table and column namesYou can turn off this feature to get a quicker startup with -ADatabase changedmysql&gt; select host,user,password_expired from user;+-----------+------+------------------+| host | user | password_expired |+-----------+------+------------------+| % | root | N || cs1 | root | Y || 127.0.0.1 | root | Y || ::1 | root | Y |+-----------+------+------------------+4 rows in set (0.00 sec)-------------mysql&gt; update user set password_expired=&apos;N&apos; where host=&apos;::1&apos;;Query OK, 1 row affected (0.01 sec)Rows matched: 1 Changed: 1 Warnings: 0mysql&gt; update user set password_expired=&apos;N&apos; where host=&apos;cs1&apos;;Query OK, 1 row affected (0.00 sec)Rows matched: 1 Changed: 1 Warnings: 0mysql&gt; update user set password_expired=&apos;N&apos; where host=&apos;127.0.0.1&apos;;Query OK, 1 row affected (0.00 sec)Rows matched: 1 Changed: 1 Warnings: 0mysql&gt; FLUSH PRIVILEGES;Query OK, 0 rows affected (0.00 sec)mysql&gt; select host,user,password_expired from user;+-----------+------+------------------+| host | user | password_expired |+-----------+------+------------------+| % | root | N || cs1 | root | N || 127.0.0.1 | root | N || ::1 | root | N |+-----------+------+------------------+4 rows in set (0.00 sec)mysql&gt; exitBye[ap@cs1]~/apps/hive% sudo service mysql restart# å†é‡æ–°åˆå§‹åŒ–å°±å¥½äº† Yumå®‰è£… Mysql å› ä¸ºç¬”è€…æ²¡è£…è¿‡ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†æš‚ä¸”ä¸è¡¨ step2-å®‰è£…HiveMySqlå®‰è£…å¥½ä¹‹åŽï¼Œ å®‰è£…Hiveå°±å¾ˆç®€ç­”äº† æ³¨æ„: Hive æ˜¯æ“ä½œ Mysql çš„æ•°æ®åº“, ä¸€å®šè¦è®°å¾—æŠŠ mysql é©±åŠ¨æ–‡ä»¶æ”¾åˆ° hive ä¸‹çš„ lib ä¸­!!!å¯åŠ¨beeline å‰, è¦æŠŠ hiveserver2å¼€èµ·æ¥, å½“ç„¶, hdfs, mysql éƒ½è¦å¯åŠ¨èµ·æ¥123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132# 1.ä¸Šä¼ åˆ°Linux# 2.è§£åŽ‹å®‰è£…åŒ…åˆ°å®‰è£…ç›®å½•tar -zxvf apache-hive-2.3.2-bin.tar.gz -C ~/apps/# 3.æŠŠMySQLé©±åŠ¨åŒ…(mysql-connector-java-5.1.40-bin.jar)æ”¾ç½®åœ¨hive çš„æ ¹è·¯å¾„ä¸‹çš„ lib ç›®å½•ï¼Œæ­¤å¤„æ˜¯ ~/apps/apache-hive-2.3.2-bin/lib# 4.ä¿®æ”¹é…ç½®æ–‡ä»¶cd ~/apps/apache-hive-2.3.2-bin/conf# æ–°å»ºä¸€ä¸ª hive-site.xmltouch hive-site.xmlvi hive-site.xml+++++++++++++++++++++++++++++++++++++++++++æ·»åŠ å¦‚ä¸‹å†…å®¹++++++++++++&lt;configuration&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; &lt;value&gt;jdbc:mysql://localhost:3306/hivedb?createDatabaseIfNotExist=true&lt;/value&gt; &lt;description&gt;JDBC connect string for a JDBC metastore&lt;/description&gt; &lt;!-- æ³¨æ„:å¦‚æžœmysqlå’Œhive ä¸åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹,éœ€è¦ä½¿ç”¨mysqlèŠ‚ç‚¹çš„ hostname æˆ– ip --&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt; &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt; &lt;description&gt;Driver class name for a JDBC metastore&lt;/description&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt; &lt;value&gt;root&lt;/value&gt; &lt;description&gt;username to use against metastore database&lt;/description&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt; &lt;value&gt;123&lt;/value&gt; &lt;description&gt;password to use against metastore database&lt;/description&gt; &lt;/property&gt;&lt;/configuration&gt;+++++++++++++++++++++++++++++++++++++++++++æ·»åŠ å¦‚ä¸‹å†…å®¹+++++++++++ &lt;property&gt; &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; &lt;value&gt;/user/hive/warehouse&lt;/value&gt; &lt;description&gt;hive default warehouse, if nessecory, change it &lt;!-- è¿™ä¸ªæ˜¯é…ç½®hiveåœ¨HDFSä¸Š db çš„è·¯å­˜å‚¨å¾„çš„ï¼Œä¸é…é»˜è®¤é»˜è®¤å°±æ˜¯ä¸Šè¿°è·¯å¾„ --&gt; &lt;/description&gt; &lt;/property&gt;++++++++++++++++++++++++++# 5.é…ç½®çŽ¯å¢ƒå˜é‡ &amp; source## æ³¨æ„ï¼šapæ˜¯æˆ‘çš„ç”¨æˆ·å®¶ç›®å½•ï¼Œæ¢ä¸Šè‡ªå·±çš„ç”¨æˆ·å®¶ç›®å½•export HIVE_HOME=/home/ap/apps/apache-hive-2.3.2-bin export PATH=$PATH:$HIVE_HOME/bin# ç”¨bashçš„æ‰¾ .bash_profileï¼Œ é…ç½®æ‰€æœ‰çŽ¯å¢ƒå˜é‡source ~/.zshrc # 6.æ­¤æ—¶åŸºæœ¬å®‰è£…å®Œæˆäº†ï¼ŒéªŒè¯Hiveå®‰è£…hive --helo# 7.é‡ç‚¹æ¥äº†ï¼ åˆå§‹åŒ–å…ƒæ•°æ®åº“schematool -dbType mysql -initSchema&gt; è¿™é‡Œå¯èƒ½ä¼šé‡åˆ°å¾ˆå¤šé”™è¯¯ï¼ï¼ &gt; ä½†æ˜¯å¦‚æžœå‰é¢æŒ‰ç…§æˆ‘çš„æ–¹æ³•è£…çš„, åº”è¯¥å°±é—®é¢˜ä¸å¤§äº†&gt; ä¸»è¦æ˜¯ mysql è¿žæŽ¥æƒé™çš„é—®é¢˜ï¼ï¼# ä¸€å®šä¼šå‡ºçŽ°çš„2ä¸ª1&gt; æ‰¾ä¸åˆ° hiveå‘½ä»¤çš„ä¸€é•¿ä¸²çŽ¯å¢ƒå˜é‡ (ä¸ç”¨ç†ä¼š)2&gt; ä¸¤ä¸ªlog4jï¼ŒjaråŒ…é‡å¤çš„é—®é¢˜ (ä¸ç”¨ç†ä¼š)# 8.åˆå§‹åŒ–å®ŒæˆåŽï¼Œå¯ä»¥çœ‹ä¸‹æ•°æ®åº“ä¸­æœ‰æ²¡æœ‰ hivedb è¿™ä¸ªåº“ï¼ŒæˆåŠŸçš„è¯æ˜¯ä¼šæœ‰çš„## å¯åŠ¨hivehive --service cli &gt;hive: show databases;# å¦‚æžœèƒ½æ˜¾ç¤ºæ•°æ®åº“ï¼Œå°±æ²¡å•¥é—®é¢˜äº†# â¤ï¸9.Hiveçš„ä½¿ç”¨æ–¹å¼ä¹‹ HiveServer2/beelineæ­¤å¤„éœ€è¦ä¿®æ”¹ hadoop çš„é…ç½®æ–‡ä»¶# 9.1.é¦–å…ˆå…³é—­hdfs &amp; yarnæœåŠ¡ &amp; RunJar(hiveæœåŠ¡)ï¼Œä¿®æ”¹hadoopé…ç½®æ–‡ä»¶# 9.2.ä¿®æ”¹ hadoop é›†ç¾¤çš„ hdfs-site.xml é…ç½®æ–‡ä»¶:åŠ å…¥ä¸€æ¡é…ç½®ä¿¡æ¯ï¼Œè¡¨ç¤ºå¯ç”¨ webhdfs&lt;property&gt; &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt;# 9.3.ä¿®æ”¹ hadoop é›†ç¾¤çš„ core-site.xml é…ç½®æ–‡ä»¶:åŠ å…¥ä¸¤æ¡é…ç½®ä¿¡æ¯:è¡¨ç¤ºè®¾ç½® hadoop çš„ä»£ç†ç”¨æˆ·## æ³¨æ„ï¼š æ­¤å¤„çš„apæ˜¯é…ç½® hadoop çš„ç”¨æˆ·å&lt;property&gt; &lt;name&gt;hadoop.proxyuser.ap.hosts&lt;/name&gt; &lt;value&gt;*&lt;/value&gt; &lt;!-- è¡¨ç¤ºä»»æ„èŠ‚ç‚¹ä½¿ç”¨ hadoop é›†ç¾¤çš„ä»£ç†ç”¨æˆ· hadoop éƒ½èƒ½è®¿é—® hdfs é›†ç¾¤ --&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hadoop.proxyuser.ap.groups&lt;/name&gt; &lt;value&gt;*&lt;/value&gt; &lt;!-- è¡¨ç¤ºä»£ç†ç”¨æˆ·çš„ç»„æ‰€å±ž --&gt;&lt;/property&gt;ï£¿ï£¿ï£¿ æ³¨æ„ ï£¿ï£¿ï£¿ä¿®æ”¹å®ŒæˆåŽï¼Œ å‘ç»™hadoopé›†ç¾¤å…¶ä»–ä¸»æœºscp xxx.xx xxx.ss cs2:$PWDscp xxx.xx xxx.ss cs3:$PWD...# 9.4.é‡å¯hdfs &amp; yarnæœåŠ¡# 9.5.å¯åŠ¨ hiveserver2 æœåŠ¡## åŽå°å¯åŠ¨ï¼šnohup hiveserver2 1&gt;/home/ap/hiveserver.log 2&gt;/home/ap/hiveserver.err &amp; # æˆ–è€…:nohup hiveserver2 1&gt;/dev/null 2&gt;/dev/null &amp;# æˆ–è€…:nohup hiveserver2 &gt;/dev/null 2&gt;&amp;1 &amp;# ä»¥ä¸Š 3 ä¸ªå‘½ä»¤æ˜¯ç­‰ä»·çš„ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºè®°å½•æ—¥å¿—ï¼Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªè¡¨ç¤ºä¸è®°å½•æ—¥å¿—æ³¨æ„ï¼š nohup å¯ä»¥åœ¨ä½ é€€å‡ºå¸æˆ·/å…³é—­ç»ˆç«¯ä¹‹åŽç»§ç»­è¿è¡Œç›¸åº”çš„è¿›ç¨‹ã€‚ nohup å°±æ˜¯ä¸æŒ‚èµ·çš„æ„æ€(no hang up)ã€‚è¯¥å‘½ä»¤çš„ä¸€èˆ¬å½¢å¼ä¸º:nohup command &amp;# 9.6 å¯åŠ¨ beeline å®¢æˆ·ç«¯åŽ»è¿žæŽ¥æ–¹å¼1ï¼šæ‰§è¡Œå‘½ä»¤:beeline -u jdbc:hive2://cs2:10000 -n ap-u : æŒ‡å®šå…ƒæ•°æ®åº“çš„é“¾æŽ¥ä¿¡æ¯ -n : æŒ‡å®šç”¨æˆ·åå’Œå¯†ç æ–¹å¼2ï¼šå…ˆæ‰§è¡Œ beelineç„¶åŽæŒ‰å›¾æ‰€ç¤ºè¾“å…¥:# æ­¤å¤„çš„cs2æ˜¯åªå®‰è£…hiveçš„hostname!connect jdbc:hive2://cs2:10000 æŒ‰å›žè½¦ï¼Œç„¶åŽè¾“å…¥ç”¨æˆ·åï¼Œå¯†ç ï¼Œè¿™ä¸ª ç”¨æˆ·åå°±æ˜¯å®‰è£… hadoop é›†ç¾¤çš„ç”¨æˆ·åå’Œå¯†ç  ç™»å½•beeline :bee:æ–¹å¼1: ç›´æŽ¥ç™»å½• ç™»å½•å‰è¦å¼€å¯ RunJar è¿›ç¨‹, ä¹Ÿå°±æ˜¯ å¼€å¯hiveserver2 nohup hiveserver2 1&gt;/home/ap/hiveserver.log 2&gt;/home/ap/hiveserver.err &amp; beeline -u jdbc:hive2://cs2:10000 -n ap æ–¹å¼2: è¾“å…¥ç”¨æˆ·åå¯†ç ç™»å½• !connect jdbc:hive2://cs2:10000 ç™»å½• hivehive PS: LinuxçŽ¯å¢ƒå˜é‡å¤±æ•ˆ1234# å°±æ˜¯ç›´æŽ¥æŠŠçŽ¯å¢ƒå˜é‡è®¾ç½®ä¸º/bin:/usr/binï¼Œå› ä¸ºå¸¸ç”¨çš„å‘½ä»¤éƒ½åœ¨/binè¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚PATH=/bin:/usr/bin# æŽ¥ä¸‹æ¥ä¿®æ”¹ .bashr_profile æˆ–åˆ™ .zshrcä¸­çš„å†…å®¹å³å¯ï¼Œ ä¿®æ”¹å®Œäº†é‡æ–°source Hive â€“ DDLåº“çš„æ“ä½œ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ åº“çš„æ“ä½œ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿============================================================================# ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ å»ºåº“ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿CREATE (DATABASE|SCHEMA) [IF NOT EXISTS] database_name [COMMENT database_comment][LOCATION hdfs_path][WITH DBPROPERTIES (property_name=property_value, ...)];1ã€åˆ›å»ºæ™®é€šåº“create database dbname;2ã€åˆ›å»ºåº“çš„æ—¶å€™æ£€æŸ¥å­˜ä¸Žå¦create databse if not exists dbname;3ã€åˆ›å»ºåº“çš„æ—¶å€™å¸¦æ³¨é‡Šcreate database if not exists dbname comment &apos;create my db named dbname&apos;;4ã€æŸ¥çœ‹åˆ›å»ºåº“çš„è¯¦ç»†è¯­å¥show create database mydb;# ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ æŸ¥çœ‹åº“ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿1ã€æŸ¥çœ‹æœ‰å“ªäº›æ•°æ®åº“ show databases;2ã€æ˜¾ç¤ºæ•°æ®åº“çš„è¯¦ç»†å±žæ€§ä¿¡æ¯è¯­æ³•:desc database [extended] dbname; ç¤ºä¾‹:desc database extended myhive;3ã€æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨å“ªä¸ªåº“ select current_database();4ã€æŸ¥çœ‹åˆ›å»ºåº“çš„è¯¦ç»†è¯­å¥ show create database mydb;5ã€æŸ¥çœ‹ä»¥xxå¼€å¤´çš„åº“show databases like &apos;s*&apos;# ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ åˆ é™¤åº“ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿åˆ é™¤åº“æ“ä½œ: drop database dbname; drop database if exists dbname; é»˜è®¤æƒ…å†µä¸‹ï¼Œhive ä¸å…è®¸åˆ é™¤åŒ…å«è¡¨çš„æ•°æ®åº“ï¼Œæœ‰ä¸¤ç§è§£å†³åŠžæ³•:1ã€ æ‰‹åŠ¨åˆ é™¤åº“ä¸‹æ‰€æœ‰è¡¨ï¼Œç„¶åŽåˆ é™¤åº“2ã€ ä½¿ç”¨ cascade å…³é”®å­— drop database if exists dbname cascade; é»˜è®¤æƒ…å†µä¸‹å°±æ˜¯ restrictï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰, åŽ2è¡Œæ•ˆæžœä¸€æ · drop database if exists myhive drop database if exists myhive restrict# ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ åˆ‡æ¢åº“ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿åˆ‡æ¢åº“æ“ä½œ:- è¯­æ³•:use database_name - å®žä¾‹:use myhive; è¡¨çš„æ“ä½œåˆ›å»ºè¡¨å»ºè¡¨è¯­æ³• CREATE [EXTERNAL] TABLE [IF NOT EXISTS] &lt;table_name&gt;åˆ›å»ºå†…éƒ¨è¡¨ï¼›æ·»åŠ EXTERNALå‚æ•°ä¼šåˆ›å»ºå¤–éƒ¨è¡¨ (col_name data_type [COMMENT col_comment], ...)æ·»åŠ å­—æ®µå’Œå­—æ®µæè¿° [COMMENT table_comment]æ·»åŠ è¡¨æè¿° [PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)]æŒ‡å®šåˆ†åŒºå­—æ®µå’Œå­—æ®µæè¿°ï¼Œåˆ†åŒºå­—æ®µä¸èƒ½ä¸ºå»ºè¡¨å­—æ®µï¼ [CLUSTERED BY (col_name, col_name, ...)] SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS] æŒ‡å®šåˆ†æ¡¶å­—æ®µï¼Œåˆ†æ¡¶å­—æ®µå¿…é¡»ä¸ºå»ºè¡¨å­—æ®µï¼ æŒ‡å®šæŽ’åºå­—æ®µï¼Œæ­¤å­—æ®µä¹Ÿå¿…é¡»ä¸ºå»ºè¡¨å­—æ®µï¼ŒæŒ‡å®šçš„æ˜¯åˆ†æ¡¶å†…çš„æŽ’åº æŒ‡å®šåˆ†æ¡¶ä¸ªæ•°ï¼ˆhashåŽå†å–æ¨¡ï¼‰ [ROW FORMAT row_format]æŒ‡å®šåˆ†éš”ç¬¦ï¼Œrow_format æ ¼å¼ï¼šåˆ—åˆ†éš”ç¬¦ï¼š`delimited fields terminated by â€˜x&apos;` è¡Œåˆ†éš”ç¬¦ï¼š`line terminated by â€˜x&apos;` [STORED AS file_format]æŒ‡å®šå­˜å‚¨æ ¼å¼textfileï¼šæ–‡æœ¬æ ¼å¼ï¼Œé»˜è®¤ rcfileï¼šè¡Œåˆ—ç»“åˆæ ¼å¼ parquetï¼šåŽ‹ç¼©æ ¼å¼ [LOCATION hdfs_path]æŒ‡å®šè¡¨åœ¨hsfsä¸Šçš„å­˜å‚¨è·¯å¾„ï¼Œä¸æŒ‡å®šçš„è¯å°±æŒ‰é…ç½®çš„è·¯å¾„å­˜å‚¨ï¼Œå¦‚æžœä¹Ÿæ²¡æŒ‡å®šå°±åœ¨hiveé»˜è®¤çš„è·¯ç» /user/hive/warehouse å»ºè¡¨ä»£ç  a. åˆ›å»ºå†…éƒ¨è¡¨ create table mytable (id int, name string) row format delimited fields terminated by &#39;,&#39; stored as textfile; b. åˆ›å»ºå¤–éƒ¨è¡¨ create external table mytable2 (id int, name string) row format delimited fields terminated by &#39;,&#39; location &#39;/user/hive/warehouse/mytable2&#39;; c. åˆ›å»ºåˆ†åŒºè¡¨ create table table3(id int, name string) partitioned by(sex string) row format delimited fields terminated by &#39;,&#39; stored as textfile; æ’å…¥åˆ†åŒºæ•°æ®ï¼šload data local inpath &#39;/root/hivedata/mingxing.txt&#39; overwrite into table mytable3 partition(sex=&#39;girlâ€™); æŸ¥è¯¢è¡¨åˆ†åŒºï¼š show partitions mytable3 d. åˆ›å»ºåˆ†æ¡¶è¡¨ create table stu_buck(Sno int,Sname string,Sex string,Sage int,Sdept string) clustered by(Sno) sorted by(Sno DESC) into 4 buckets row format delimited fields terminated by &#39;,â€™; e. å¤åˆ¶è¡¨ create [external] table [if not exists] new_table like table_name; f. æŸ¥è¯¢è¡¨ create table table_a as select * from teble_b; æŸ¥çœ‹è¡¨ desc &lt;table_name&gt;ï¼šæ˜¾ç¤ºè¡¨çš„å­—æ®µä¿¡æ¯ desc formatted &lt;table_name&gt;ï¼šæ ¼å¼åŒ–æ˜¾ç¤ºè¡¨çš„è¯¦ç»†ä¿¡æ¯ desc extended &lt;table_name&gt;ï¼šæ˜¾ç¤ºè¡¨çš„è¯¦ç»†ä¿¡æ¯ ä¿®æ”¹è¡¨ é‡å‘½å ALTER TABLE old_name RENAME TO new_name ä¿®æ”¹å±žæ€§ ALTER TABLE table_name SET TBLPROPERTIES (&#39;comment&#39; = &#39;my new students tableâ€™); ä¸æ”¯æŒä¿®æ”¹è¡¨åï¼Œå’Œè¡¨çš„æ•°æ®å­˜å‚¨ç›®å½• å¢žåŠ /ä¿®æ”¹/æ›¿æ¢å­—æ®µ ALTER TABLE table_name ADD COLUMNS (col_spec [, col_spec ...])æ–°å¢žçš„å­—æ®µä½ç½®åœ¨æ‰€æœ‰åˆ—åŽé¢ ( partition åˆ—å‰ ) ALTER TABLE table_name CHANGE c_name new_c_name new_c_type [FIRST | AFTER c_name]æ³¨æ„ä¿®æ”¹å­—æ®µæ—¶ï¼Œç±»åž‹åªèƒ½ç”±å°ç±»åž‹è½¬ä¸ºå¤§ç±»åž‹ï¼Œä¸è®©å›žæŠ¥é”™ï¼›ï¼ˆåœ¨hive1.2.2ä¸­å¹¶æ²¡æœ‰æ­¤é™åˆ¶ï¼‰ ALTER TABLE table_name REPLACE COLUMNS (col_spec [, col_spec ...])REPLACE è¡¨ç¤ºæ›¿æ¢è¡¨ä¸­æ‰€æœ‰å­—æ®µ æ·»åŠ /åˆ é™¤åˆ†åŒº æ·»åŠ åˆ†åŒºï¼šALTER TABLE table_name ADD [IF NOT EXISTS] PARTITION (partition_col = col_value1 [ ... ] ) [LOCATION &#39;location1â€™] åˆ é™¤åˆ†åŒºï¼šALTER TABLE table_name DROP [IF EXISTS] PARTITION (partition_col = col_value1 [ ... ] ) ä¿®æ”¹åˆ†åŒºè·¯å¾„ï¼šALTER TABLE student_p PARTITION (part=&#39;bb&#39;) SET LOCATION &#39;/myhive_bbbbbâ€™; [è¡¥å……ï¼š] 1ã€ é˜²æ­¢åˆ†åŒºè¢«åˆ é™¤ï¼šalter table student_p partition (part=â€™aaâ€™) enable no_drop; 2ã€ é˜²æ­¢åˆ†åŒºè¢«æŸ¥è¯¢ï¼šalter table student_p partition (part=â€™aaâ€™) enable offline;enable å’Œ disable æ˜¯åå‘æ“ä½œ åˆ é™¤è¡¨ drop table if exists &lt;table_name&gt;; æ¸…ç©ºè¡¨ä¼šä¿ç•™è¡¨ç»“æž„ truncate table table_name; truncate table table_name partition(city=&#39;beijingâ€™); å…¶ä»–è¾…åŠ©å‘½ä»¤ a. æŸ¥çœ‹æ•°æ®åº“åˆ—è¡¨ show databases; show databases like &#39;my*&#39;; b. æŸ¥çœ‹æ•°æ®è¡¨ show tables; show tables in db_name; c. æŸ¥çœ‹æ•°æ®è¡¨çš„å»ºè¡¨è¯­å¥ show create table table_name; d. æŸ¥çœ‹ hive å‡½æ•°åˆ—è¡¨ show functions; e. æŸ¥çœ‹ hive è¡¨çš„åˆ†åŒº show partitions table_name; show partitions table_name partition(city=&#39;beijing&#39;) f. æŸ¥çœ‹è¡¨çš„è¯¦ç»†ä¿¡æ¯ï¼ˆå…ƒæ•°æ®ä¿¡æ¯ï¼‰ desc table_name; desc extended table_name; g. æŸ¥çœ‹æ•°æ®åº“çš„è¯¦ç»†å±žæ€§ä¿¡æ¯ desc formatted table_name; desc database db_name; desc database extended db_name; h. æ¸…ç©ºæ•°æ®è¡¨ truncate table table_name; Hive â€“ DMLè£…è½½æ•°æ® LOAD DATA [LOCAL] INPATH &#39;filepath&#39; [OVERWRITE] INTO TABLE table_name [PARTITION (partcol1=val1, partcol2=val2 ...)] æ³¨æ„ï¼š LOAD æ“ä½œåªæ˜¯å•çº¯çš„ å¤åˆ¶ï¼ˆæœ¬åœ°æ–‡ä»¶ï¼‰æˆ–è€… ç§»åŠ¨ï¼ˆhdfsæ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯å…¬å…±æ•°æ®ï¼Œéœ€è¦å»ºç«‹å¤–éƒ¨è¡¨ï¼‰æ“ä½œï¼Œå°†æ•°æ®æ–‡ä»¶ç§»åŠ¨åˆ° Hive è¡¨å¯¹åº”çš„ä½ç½® å¦‚æžœæŒ‡å®šäº† LOCAL å°±åŽ»æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­æŸ¥æ‰¾ï¼Œå¦åˆ™æŒ‰ inpath ä¸­çš„ uri åœ¨ hdfs ä¸ŠæŸ¥æ‰¾ inpath å­å¥ä¸­çš„æ–‡ä»¶è·¯å¾„ä¸‹ï¼Œä¸èƒ½å†æœ‰æ–‡ä»¶å¤¹ å¦‚æžœä½¿ç”¨äº† OVERWRITE å…³é”®å­—ï¼Œåˆ™ç›®æ ‡è¡¨ï¼ˆæˆ–è€…åˆ†åŒºï¼‰ä¸­çš„å†…å®¹ä¼šè¢«åˆ é™¤ï¼Œç„¶åŽå†å°† filepath æŒ‡å‘çš„æ–‡ä»¶/ç›®å½•ä¸­çš„å†…å®¹æ·»åŠ åˆ°è¡¨/åˆ†åŒºä¸­ã€‚ å¦‚æžœç›®æ ‡è¡¨ï¼ˆåˆ†åŒºï¼‰å·²ç»æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æ–‡ä»¶åå’Œ filepath ä¸­çš„æ–‡ä»¶åå†²çªï¼Œé‚£ä¹ˆçŽ°æœ‰çš„æ–‡ä»¶ä¼šè¢«æ–°æ–‡ä»¶æ‰€æ›¿ä»£ã€‚???ä¸æ˜¯è‡ªåŠ¨é‡å‘½åä¸ºxxx_copy_1 æ’å…¥æ•°æ® a. å•æ¡æ’å…¥ INSERT INTO TABLE table_name VALUES(value1, value2, ...); b. å•é‡æ’å…¥ INSERT INTO TABLE table_name [PARTITION (partcol1=val1, ...)] &lt;select_statement1 FROM from_statement&gt; c. å¤šé‡æ’å…¥ FROM from_statementä»ŽåŸºè¡¨ä¸­æŒ‰ä¸åŒçš„å­—æ®µæŸ¥è¯¢å¾—åˆ°çš„ç»“æžœåˆ†åˆ«æ’å…¥ä¸åŒçš„ hive è¡¨åªä¼šæ‰«æä¸€æ¬¡åŸºè¡¨ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½ INSERT INTO TABLE table_name1 [PARTITION (partcol1=val1, partcol2=val2 ...)] select_statement1 [WHERE where_statement] INSERT INTO TABLE table_name2 [PARTITION (partcol1=val1, partcol2=val2 ...)] select_statement2 [WHERE where_statement] [ â€¦ ]; d. åˆ†åŒºæ’å…¥ åˆ†åŒºæ’å…¥æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯é™æ€åˆ†åŒºï¼Œå¦ä¸€ç§æ˜¯åŠ¨æ€åˆ†åŒºã€‚ å¦‚æžœæ··åˆä½¿ç”¨é™æ€åˆ†åŒºå’ŒåŠ¨æ€åˆ†åŒºï¼Œ åˆ™é™æ€åˆ†åŒºå¿…é¡»å‡ºçŽ°åœ¨åŠ¨æ€åˆ†åŒºä¹‹å‰ã€‚ é™æ€åˆ†åŒº A)ã€åˆ›å»ºé™æ€åˆ†åŒºè¡¨ B)ã€ä»ŽæŸ¥è¯¢ç»“æžœä¸­å¯¼å…¥æ•°æ®ï¼ˆå•é‡æ’å…¥ï¼‰è®°å¾—åŠ è½½æ•°æ®å‰è¦æ·»åŠ åˆ†åŒºï¼Œç„¶åŽæŒ‡å®šè¦åŠ è½½åˆ°é‚£ä¸ªåˆ†åŒº C)ã€æŸ¥çœ‹æ’å…¥ç»“æžœ åŠ¨æ€åˆ†åŒº é™æ€åˆ†åŒºæ·»åŠ æ•°æ®å‰éœ€è¦æŒ‡å®šåˆ†åŒºï¼Œå½“åˆ†åŒºä¸ªæ•°ä¸ç¡®å®šçš„æ—¶å€™å°±å¾ˆä¸æ–¹ä¾¿äº†ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨åŠ¨æ€åˆ†åŒº é‡è¦ä¸”å¸¸ç”¨ï¼Œå°¤å…¶æ˜¯æŒ‰ç…§æ—¥æœŸåˆ†åŒºæ—¶ï¼ A)ã€åˆ›å»ºåˆ†åŒºè¡¨ B)ã€å‚æ•°è®¾ç½® hive-1.2ç‰ˆæœ¬ - set hive.exec.dynamic.partition=true; //åŠ¨æ€åˆ†åŒºå¼€å¯çŠ¶æ€ï¼Œé»˜è®¤å¼€å¯ - set hive.exec.dynamic.partition.mode=nonstrict; //åŠ¨æ€åˆ†åŒºæ‰§è¡Œæ¨¡å¼ï¼Œé»˜è®¤&quot;strict&quot;ï¼Œåœ¨è¿™ç§æ¨¡å¼ ä¸‹è¦æ±‚è‡³å°‘æœ‰ä¸€åˆ—åˆ†åŒºå­—æ®µæ˜¯é™æ€çš„ï¼Œè¿™æœ‰åŠ©äºŽé˜»æ­¢å› è®¾è®¡é”™è¯¯å¯¼è‡´æŸ¥è¯¢äº§ç”Ÿå¤§é‡çš„åˆ†åŒº - \# å¯é€‰è®¾ç½®é¡¹ å¦‚æžœè¿™äº›å‚æ•°è¢«æ›´æ”¹äº†åˆæƒ³è¿˜åŽŸï¼Œåˆ™æ‰§è¡Œä¸€æ¬¡ reset å‘½ä»¤å³å¯ - set hive.exec.max.dynamic.partitions.pernode=100; //æ¯ä¸ªèŠ‚ç‚¹ç”ŸæˆåŠ¨æ€åˆ†åŒºæœ€å¤§ä¸ªæ•° - set hive.exec.max.dynamic.partitions=1000; //ç”ŸæˆåŠ¨æ€åˆ†åŒºæœ€å¤§ä¸ªæ•°ï¼Œå¦‚æžœè‡ªåŠ¨åˆ†åŒºæ•°å¤§äºŽè¿™ä¸ªå‚æ•°ï¼Œå°†ä¼šæŠ¥é”™ - set hive.exec.max.created.files=100000; //ä¸€ä¸ªä»»åŠ¡æœ€å¤šå¯ä»¥åˆ›å»ºçš„æ–‡ä»¶æ•°ç›® - set dfs.datanode.max.xcievers=4096; //é™å®šä¸€æ¬¡æœ€å¤šæ‰“å¼€çš„æ–‡ä»¶æ•° set - hive.error.on.empty.partition=false; //è¡¨ç¤ºå½“æœ‰ç©ºåˆ†åŒºäº§ç”Ÿæ—¶ï¼Œæ˜¯å¦æŠ›å‡ºå¼‚å¸¸ - C)ã€åŠ¨æ€æ•°æ®æ’å…¥ - å•ä¸ªåˆ†åŒºå­—æ®µ - insert into table test2 partition (age) select name,address,school,age from students; - å¤šä¸ªåˆ†åŒºå­—æ®µ å¤šé‡åˆ†åŒºä¸­ç›®å½•ç»“æž„æ˜¯æŒ‰ç…§åˆ†åŒºå­—æ®µé¡ºåºè¿›è¡Œåˆ’åˆ†çš„ - insert into table student_ptn2 partition(department, age) select id, name, sex, department,age from students; åˆ†åŒºå­—æ®µéƒ½æ˜¯åŠ¨æ€çš„ - insert into table student_ptn2 partition(city=&apos;sa&apos;, zipcode) select id, name, sex, age, department, department as zipcode from students; ç¬¬ä¸€ä¸ªåˆ†åŒºå­—æ®µæ—¶é™æ€çš„ï¼Œç¬¬äºŒå­—departmentå­—æ®µåŠ¨æ€çš„ï¼Œé‡å‘½åä¸ºzipcodeï¼Ÿ - [æ³¨æ„ï¼š] - æŸ¥è¯¢è¯­å¥ select æŸ¥è¯¢å‡ºæ¥çš„åŠ¨æ€åˆ†åŒº age å’Œ zipcode å¿…é¡»æ”¾åœ¨ æœ€åŽï¼Œå’Œåˆ†åŒºå­—æ®µå¯¹åº”ï¼Œä¸ç„¶ç»“æžœä¼šå‡ºé”™ - D)ã€æŸ¥çœ‹æ’å…¥ç»“æžœ - select * from student_ptn2 where city=&apos;sa&apos; and zipcode=&apos;MA&apos;; e. åˆ†æ¡¶æ’å…¥ A)ã€åˆ›å»ºåˆ†æ¡¶è¡¨ B)ã€ä»ŽæŸ¥è¯¢ç»“æžœä¸­å¯¼å…¥æ•°æ®åªèƒ½ä½¿ç”¨insertæ–¹å¼ C)ã€æŸ¥çœ‹æ’å…¥ç»“æžœ # å‡ ä¸ªå‘½ä»¤ set hive.exec.reducers.bytes.per.reducer= // è®¾ç½®æ¯ä¸ªreducerçš„åžåé‡ï¼Œå•ä½byteï¼Œé»˜è®¤256M set hive.exec.reducers.max= //reduceTaskæœ€å¤šæ‰§è¡Œä¸ªæ•°ï¼Œé»˜è®¤1009 set mapreduce.job.reduces= //è®¾ç½®reducetaskå®žé™…è¿è¡Œæ•°ï¼Œé»˜è®¤-1ï¼Œä»£è¡¨æ²¡æœ‰è®¾ç½®ï¼Œå³reducetaské»˜è®¤æ•°ä¸º1 set hive.exec.mode.local.auto=true //è®¾ç½®hiveæœ¬åœ°æ¨¡å¼ å¯¼å‡ºæ•°æ®ï¼ˆäº†è§£ï¼‰ å•æ¨¡å¼å¯¼å‡º INSERT OVERWRITE [LOCAL] DIRECTORY directory1 &lt;select_statement&gt;; å¤šæ¨¡å¼å¯¼å‡º FROM from_statement INSERT OVERWRITE [LOCAL] DIRECTORY directory1 &lt;select_statement1&gt; [INSERT OVERWRITE [LOCAL] DIRECTORY directory2 &lt;select_statement2&gt;] ... æŸ¥è¯¢æ•°æ® Hive ä¸­çš„ SELECT åŸºç¡€è¯­æ³•å’Œæ ‡å‡† SQL è¯­æ³•åŸºæœ¬ä¸€è‡´ï¼Œæ”¯æŒ WHEREã€DISTINCTã€GROUP BYã€ ORDER BYã€HAVINGã€LIMITã€å­æŸ¥è¯¢ç­‰ï¼› 1ã€select * from db.table1è™½ç„¶å¯ä»¥ï¼Œä½†æ˜¯è¦å°½é‡é¿å… select * è¿™æ ·çš„å…¨è¡¨æ‰«ææ“ä½œï¼Œæ•ˆçŽ‡å¤ªä½Žåˆè´¹æ—¶ 2ã€select count(distinct uid) from db.table1 3ã€æ”¯æŒ selectã€union allã€joinï¼ˆleftã€rightã€full joinï¼‰ã€likeã€whereã€havingã€å„ç§èšåˆå‡½æ•°ã€ æ”¯æŒ json è§£æž 4ã€UDF/ UDAF/UDTF UDFï¼šUser Defined Functionï¼Œè‡ªå®šä¹‰å‡½æ•°ï¼Œä¸€å¯¹ä¸€ UDAFï¼šUser Defined Aggregate Functionï¼Œè‡ªå®šä¹‰èšåˆå‡½æ•°ï¼Œå¤šå¯¹ä¸€ï¼Œå¦‚sum()ï¼Œcount() UDTF ï¼šUser Defined Table Functionï¼Œè‡ªå®šä¹‰è¡¨å‡½æ•°ï¼Œä¸€å¯¹å¤šï¼Œå¦‚explode() 5ã€ä¸æ”¯æŒ update å’Œ delete 6ã€hive è™½ç„¶æ”¯æŒ in/existsï¼ˆè€ç‰ˆæœ¬æ˜¯ä¸æ”¯æŒçš„ï¼‰ï¼Œä½†æ˜¯ hive æŽ¨èä½¿ç”¨ semi join çš„æ–¹å¼æ¥ä»£æ›¿ å®žçŽ°ï¼Œè€Œä¸”æ•ˆçŽ‡æ›´é«˜ã€‚ åŠè¿žæŽ¥ å·¦åŠè¿žæŽ¥ï¼šleft semi joinï¼Œä»¥å·¦è¡¨ä¸ºåŸºè¡¨ï¼Œå³è¡¨æœ‰çš„ï¼Œåªæ˜¾ç¤ºå·¦è¡¨ç›¸åº”è®°å½•ï¼ˆå³ä¸€åŠï¼‰ å³åŠè¿žæŽ¥ï¼šright semi joinï¼Œä¸Žå·¦åŠè¿žæŽ¥ç›¸å å†…è¿žæŽ¥ï¼šinner joinï¼Œä¸¤è¡¨ä¸­éƒ½æœ‰çš„æ‰ä¼šè¿žæŽ¥ å¤–è¿žæŽ¥ å·¦å¤–è¿žæŽ¥ï¼šleft outer joinï¼Œåæ ‡ä¸ºåŸºè¡¨ï¼Œå³è¡¨æœ‰çš„ä¼šå…³è”ï¼Œå³è¡¨æ²¡æœ‰çš„ä»¥nullè¡¨ç¤ºï¼›å·¦è¡¨æ²¡æœ‰å³è¡¨æœ‰çš„ä¸ä¼šå…³è” å³å¤–è¿žæŽ¥ï¼šright outer joinï¼Œä¸Žå·¦å¤–è¿žæŽ¥ç›¸å å…¨å¤–è¿žæŽ¥ï¼šfull outer joinï¼Œä¸¤è¡¨åˆå¹¶ 7ã€æ”¯æŒ case â€¦ when â€¦ è¯­æ³•ç»“æž„ SELECT [ALL | DISTINCT] select_ condition, select_ condition, ... FROM table_name a [JOIN table_other b ON a.id = b.id]è¡¨è¿žæŽ¥ [WHERE where_condition]è¿‡æ»¤æ¡ä»¶ [GROUP BY col_list [HAVING condition]]åˆ†ç»„æ¡ä»¶ [CLUSTER BY col_list | [DISTRIBUTE BY col_list] [SORT BY col_list | ORDER BY col_list] [DESC]]æŽ’åºæ¡ä»¶ï¼š\1. order byï¼šå…¨å±€æŽ’åºï¼Œé»˜è®¤å‡åºï¼ŒDESCè¡¨ç¤ºé™åºã€‚åªæœ‰ä¸€ä¸ª reduce task çš„ç»“æžœï¼Œæ¯”å¦‚æ–‡ä»¶åæ˜¯ 000000_0ï¼Œä¼šå¯¼è‡´å½“è¾“å…¥è§„æ¨¡è¾ƒå¤§æ—¶ï¼Œéœ€è¦è¾ƒé•¿çš„è®¡ç®—æ—¶é—´ã€‚\2. sort byï¼šå±€éƒ¨æŽ’åºï¼Œå…¶åœ¨æ•°æ®è¿›å…¥ reducer å‰å®ŒæˆæŽ’åºã€‚å› æ­¤ï¼Œå¦‚æžœç”¨ sort by è¿›è¡ŒæŽ’åºï¼Œå¹¶ä¸”è®¾ç½® mapred.reduce.tasks &gt; 1ï¼Œåˆ™ sort by åªä¿è¯æ¯ä¸ª reducer çš„è¾“å‡ºæœ‰åºï¼Œä¸ä¿è¯å…¨å±€æœ‰åºã€‚\3. distribute byï¼šç±»ä¼¼äºŽåˆ†æ¡¶ï¼Œæ ¹æ®æŒ‡å®šçš„å­—æ®µå°†æ•°æ®åˆ†åˆ°ä¸åŒçš„ reducerï¼Œä¸”åˆ†å‘ç®—æ³•æ˜¯ hash æ•£åˆ—\4. cluster byï¼šé™¤äº†å…·æœ‰ Distribute by çš„åŠŸèƒ½å¤–ï¼Œè¿˜ä¼šå¯¹è¯¥å­—æ®µè¿›è¡ŒæŽ’åºã€‚æ³¨æ„ï¼šå¦‚æžœ distribute å’Œ sort å­—æ®µæ˜¯åŒä¸€ä¸ªæ—¶ï¼Œcluster by = distribute by + sort byï¼›å¦‚æžœåˆ†æ¡¶å­—æ®µå’ŒæŽ’åºå­—æ®µä¸ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨ clustered by [LIMIT number]æ˜¾ç¤ºç»“æžœçš„å‰å‡ ä¸ªè®°å½•]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Hive</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Hive</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¶ç„¶å‘çŽ°çš„å¥½æ­Œ]]></title>
    <url>%2F2018%2F06%2F11%2FSongs%2F%E5%81%B6%E7%84%B6%E5%8F%91%E7%8E%B0%E7%9A%84%E5%A5%BD%E6%AD%8C%2F</url>
    <content type="text"><![CDATA[Dealbreaker ä¸“è¾‘ï¼šChesapeake æ­Œæ‰‹ï¼šRachael Yamagata é“¾æŽ¥ï¼šhttp://music.163.com/#/m/song?id=18733198 You Wonâ€™t Let Me ä¸“è¾‘ï¼šChesapeake æ­Œæ‰‹ï¼šRachael Yamagata é“¾æŽ¥ï¼šhttp://music.163.com/#/song?id=18733192]]></content>
      <categories>
        <category>æ–‡è‰º</category>
        <category>Songs</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æ–‡è‰º</tag>
        <tag>Songs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[_HDFSåº”ç”¨åœºæ™¯&åŽŸç†&åŸºæœ¬æž¶æž„åŠä½¿ç”¨æ–¹æ³•]]></title>
    <url>%2F2018%2F06%2F11%2FHadoop%2F1-HDFS%2FHDFS%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%26%E5%8E%9F%E7%90%86%26%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[HDFSåŸºæœ¬æž¶æž„å’ŒåŽŸç†HDFSè®¾è®¡æ€æƒ³ HDFSæž¶æž„ HDFSæ•°æ®å—ï¼ˆblockï¼‰ æ³¨æ„ï¼š Hadoop2.xï¼Œblocké»˜è®¤å¤§å°æ˜¯128MB HDFSå†™æµç¨‹ åˆ›å»ºDistributed FileSystemç±» è¯¢é—® NameNode è¦å†™çš„æ–‡ä»¶å¯¹å¦å­˜åœ¨ ä¸å­˜åœ¨å°±å†™å…¥åˆ° FSDataOutputStream æµä¸­ æµå†™å‡ºåŽ»åˆ°ä¸€ä¸ª DataNode â€¦ HDFSè¯»æµç¨‹ å®¢æˆ·ç«¯å‘ NameNode è¯¢é—® block çš„ä½ç½® æŒ‰ç…§å®¢æˆ·ç«¯æŒ‰ç…§æ‹¿åˆ°çš„ä½ç½®ï¼Œå‘ä¸åŒçš„DataNode è¯·æ±‚æ•°æ® â€¦â€¦ HDFSå…¸åž‹ç‰©ç†æ‹“æ‰‘ HDFSå‰¯æœ¬æ”¾ç½®ç­–ç•¥ HDFSå¯é æ€§ç­–ç•¥ HDFSä¸é€‚åˆå­˜å‚¨å°æ–‡ä»¶ HDFSç¨‹åºè®¾è®¡HDFSè®¿é—®æ–¹å¼ HDFS Shellå‘½ä»¤æ¦‚è§ˆ HDFS Shellå‘½ä»¤â€”æ–‡ä»¶æ“ä½œå‘½ä»¤ HDFS Shellå‘½ä»¤â€”æ–‡ä»¶æ“ä½œå‘½ä»¤ HDFS Shellå‘½ä»¤â€”ç®¡ç†å‘½ä»¤ HDFS Shellå‘½ä»¤â€”ç®¡ç†è„šæœ¬ HDFS Shellå‘½ä»¤â€”æ–‡ä»¶ç®¡ç†å‘½ä»¤fsck æŸ¥çœ‹å¸®åŠ© ç”¨æ³•ç¤ºä¾‹ HDFS Shellå‘½ä»¤â€”æ•°æ®å‡è¡¡å™¨balancer ä¸€èˆ¬è®¾ç½®10% â€”â€” 15% å°±å·®ä¸å¤šäº† HDFS Shellå‘½ä»¤â€”è®¾ç½®ç›®å½•ä»½é¢ â€» HDFS Shellå‘½ä»¤â€”å¢žåŠ /ç§»é™¤èŠ‚ç‚¹ â€» HDFS JavaAPIä»‹ç» HDFS Javaç¨‹åºä¸¾ä¾‹ HDFS å¤šè¯­è¨€APIâ€”å€ŸåŠ©thriftä¹Ÿæ˜¯Apacheçš„é¡¶çº§é¡¹ç›® thriftæ‰§è¡Œæµç¨‹ hadoopfs.thriftæŽ¥å£å®šä¹‰ PHPè¯­è¨€è®¿é—®HDFS Pythonè¯­è¨€è®¿é—®HDFS Hadoop 2.0æ–°ç‰¹æ€§ HA(é«˜å¯ç”¨)ä¸ŽFederation(è”é‚¦) å¼‚æž„å±‚çº§å­˜å‚¨ç»“æž„èƒŒæ™¯ åŽŸç† HDFS ACLèƒŒæ™¯ï¼šçŽ°æœ‰æƒé™ç®¡ç†çš„å±€é™æ€§ åŸºäºŽPOSIX ACLçš„å®žçŽ° HDFSå¿«ç…§èƒŒæ™¯ åŸºæœ¬ä½¿ç”¨æ–¹æ³• HDFSç¼“å­˜èƒŒæ™¯ åŽŸç† å®žçŽ°æƒ…å†µ æ€»ç»“]]></content>
      <categories>
        <category>Hadoop</category>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>HDFS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…³äºŽhexoçš„æ—¶åºå›¾æ’ä»¶ hexo-filter-sequence çš„å·¨å‘]]></title>
    <url>%2F2018%2F06%2F10%2FTools%2FHexo%2F%E5%85%B3%E4%BA%8Ehexo%E7%9A%84%E6%97%B6%E5%BA%8F%E5%9B%BE%E6%8F%92%E4%BB%B6-hexo-filter-sequence-%E7%9A%84%E5%B7%A8%E5%9D%91%2F</url>
    <content type="text"><![CDATA[å‰è¨€åœ¨å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå‘çŽ°æ—¶åºå›¾è¿˜æ˜¯æŒºç®¡ç”¨çš„ï¼Œç®€æ´æ˜Žäº†ï¼ŒäºŽæ˜¯æƒ³ç”¨ä¸€ç”¨ã€‚ ç»“æžœå‘åˆ°ç«™ä¸Šï¼Œä¸æ˜¾ç¤ºã€‚ åœ¨ç½‘ä¸ŠæŸ¥äº†ä¸‹ï¼Œå‘çŽ°æ˜¯hexoæ‰€ä½¿ç”¨çš„Markdownæ¸²æŸ“è¯­æ³•ä¸æ”¯æŒã€‚ è¿™é‡Œåæ§½ä¸‹ï¼Œè¿™é‡Œæ¸²æŸ“çš„ç¡®å®žçƒ‚ï¼Œä½œè€…ä¸ºå•¥ä¸æ”¹æ”¹.. äºŽæ˜¯å¼€å§‹æ‰¾è§£å†³æ–¹æ¡ˆï¼Œå‘çŽ°å¤§å¤šæ•°éƒ½æŽ¨èäº†ä¸€ä¸ªå«hexo-filter-sequenceçš„æ’ä»¶ï¼Œæ•…å®‰è£…ä¹‹ã€‚ ç»“æžœæ­»æ´»è¿˜æ˜¯ä¸è¡Œã€‚ è£…äº†å…¶å®ƒçš„å‡ ä¸ªflowå›¾ï¼Œå´å¯ä»¥æ˜¾ç¤ºã€‚ å½“flowå›¾å’Œsequenceå›¾åŒæ—¶å­˜åœ¨çš„æ—¶å€™ï¼Œsequenceå¯ä»¥æ˜¾ç¤ºï¼Œä½†æ˜¯sequenceå•ç‹¬å­˜åœ¨æ—¶ï¼Œæ­»æ´»ä¸æ˜¾ç¤ºã€‚ éš¾ä¸æˆæœ‰å•¥ä¾èµ–ï¼Ÿå¿…é¡»å…ˆä½¿ç”¨flowæ‰èƒ½ä½¿ç”¨sequenceï¼Ÿé€»è¾‘ä¸Šä¸åº”è¯¥å•Šï¼ ä½†æ˜¯äº‹å®žå´æ˜¯è¿™æ ·ï¼ ç½‘ä¸Šæœ‰ä¸€ç¯‡å¤§ç¥žè¯´è¦æ”¹æºç æ‰è¡Œï¼Œå¼€å§‹æ²¡æ³¨æ„ï¼Œè§‰å¾—åº”è¯¥ä¸ä¼šå§ï¼Œè¿™ä¹ˆå¤šäººä½¿ç”¨ï¼Œæºç è¿˜ä¼šæœ‰é—®é¢˜ï¼Ÿï¼Ÿ ä»”ç»†ä¸€çœ‹æºç ï¼Œå¦ˆçš„ï¼ï¼å¿ƒé‡Œåƒä¸‡åŒ¹è‰æ³¥é©¬å‘¼å•¸è€Œè¿‡ï¼ æŠŠåˆå§‹åŒ– sequenceï¼Œå†™æˆäº†åˆå§‹åŒ– flowï¼ï¼ï¼ æŠŠ flow æ”¹æˆ sequenceï¼Œ å†æŠŠ js CDNæºæ¢æˆå›½å†…çš„ï¼ å¯ä»¥äº†ï¼ï¼ å†ä»”ç»†ä¸€çœ‹ï¼Œå‘çŽ°æœ€åŽä¸€æ¬¡æ›´æ–°æ˜¯åœ¨1å¹´å‰ï¼ å‘çˆ¹çš„ä½œè€…ï¼Œæµªè´¹äº†æˆ‘è‡³å°‘3-5ä¸ªå°æ—¶ï¼ï¼ ä¸‹é¢ä¸ºéƒ¨åˆ†æ‘˜æŠ„å®‰è£…hexo-filter-sequence æ’ä»¶: 1npm install --save hexo-filter-sequence é…ç½®ç«™ç‚¹é…ç½®æ–‡ä»¶ _config.yml ä¸­å¢žåŠ å¦‚ä¸‹é…ç½®: 123456789sequence: webfont: https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js raphael: https://cdn.bootcss.com/raphael/2.2.7/raphael.min.js underscore: https://cdn.bootcss.com/underscore.js/1.8.3/underscore-min.js sequence: https://cdn.bootcss.com/js-sequence-diagrams/1.0.6/sequence-diagram-min.js css: # optional, the url for css, such as hand drawn theme options: theme: simple css_class: æºç æºç ä¿®æ”¹åŽæ‰èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œè¿›å…¥æ’ä»¶ç›®å½•ä½œå¦‚ä¸‹ä¿®æ”¹ï¼š 12345678910111213141516// index.jsvar assign = require('deep-assign');var renderer = require('./lib/renderer');hexo.config.sequence = assign(&#123; webfont: 'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js', raphael: 'https://cdn.bootcss.com/raphael/2.2.7/raphael.min.js', underscore: 'https://cdn.bootcss.com/underscore.js/1.8.3/underscore-min.js', sequence: 'https://cdn.bootcss.com/js-sequence-diagrams/1.0.6/sequence-diagram-min.js', css: '', options: &#123; theme: 'simple' &#125;&#125;, hexo.config.sequence);hexo.extend.filter.register('before_post_render', renderer.render, 9); 12345678910// lib/renderer.js, 25 è¡Œif (sequences.length) &#123; var config = this.config.sequence; // resources data.content += '&lt;script src="' + config.webfont + '"&gt;&lt;/script&gt;'; data.content += '&lt;script src="' + config.raphael + '"&gt;&lt;/script&gt;'; data.content += '&lt;script src="' + config.underscore + '"&gt;&lt;/script&gt;'; data.content += '&lt;script src="' + config.sequence + '"&gt;&lt;/script&gt;'; ......&#125; ç¤ºä¾‹æ–°å»ºä»£ç å—ï¼Œå¢žåŠ å¦‚ä¸‹å†…å®¹ï¼š è¯¦æƒ…å‚è€ƒ Alice->Bob: Hello Bob, how are you? Note right of Bob: Bob thinks Bob-->Alice: I am good thanks!{"theme":"simple"} var code = document.getElementById("sequence-0-code").value; var options = JSON.parse(decodeURIComponent(document.getElementById("sequence-0-options").value)); var diagram = Diagram.parse(code); diagram.drawSVG("sequence-0", options);]]></content>
      <categories>
        <category>å·¥å…·</category>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>å·¥å…·</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MapReduce-åˆ†ç»„æµ…æŽ¢]]></title>
    <url>%2F2018%2F06%2F10%2FHadoop%2F2-MapReduce%2FMapReduce-%E5%88%86%E7%BB%84%E6%B5%85%E6%8E%A2%2F</url>
    <content type="text"><![CDATA[å‰è¨€æœ€è¿‘å­¦åˆ†ç»„çš„æ—¶å€™ï¼Œä¸€ç›´å¼„ä¸æ˜Žç™½ï¼Œæ€»æ„Ÿè§‰ä¸€å¤´é›¾æ°´ï¼Œé€šè¿‡è¿‘3ä¸ªå°æ—¶çš„æ–­ç‚¹è°ƒè¯•å’Œlogè¾“å‡ºã€‚ å¤§æ¦‚äº†è§£äº†ä¸€äº›è¡¨è±¡ï¼Œå…ˆè®°å½•ã€‚ æ¡ˆä¾‹æ˜¯è¿™ä¸ª æ±‚å‡ºæ¯é—¨è¯¾ç¨‹å‚è€ƒå­¦ç”Ÿæˆç»©æœ€é«˜å¹³å‡åˆ†çš„å­¦ç”Ÿçš„ä¿¡æ¯ï¼š è¯¾ç¨‹ï¼Œå§“åå’Œå¹³å‡åˆ†ï¼Œè¯¦ç»†è§MapReduceç¬”è®°-ç»ƒä¹ ç¬¬äºŒé¢˜ç¬¬3å°é¢˜ æ•°æ®æ ¼å¼æ˜¯è¿™æ ·çš„ï¼š ç¬¬ä¸€ä¸ªæ˜¯è¯¾ç¨‹åç§°ï¼Œæ€»å…±å››ä¸ªè¯¾ç¨‹ï¼Œcomputerï¼Œmathï¼Œenglishï¼Œalgorithmï¼Œ ç¬¬äºŒä¸ªæ˜¯å­¦ç”Ÿå§“åï¼ŒåŽé¢æ˜¯æ¯æ¬¡è€ƒè¯•çš„åˆ†æ•° math,huangxiaoming,85,75,85,99,66,88,75,91 english,huanglei,85,75,85,99,66,88,75,91 â€¦ ç»“è®º æ‰§è¡Œæµç¨‹ç»“è®º mapæ¯è¯»ä¸€è¡Œå°± write åˆ° context ä¸€æ¬¡ï¼ŒæŒ‰ç…§æŒ‡å®šçš„keyè¿›è¡Œåˆ†å‘ map æŠŠæ‰€æœ‰çš„æ•°æ®éƒ½è¯»å®Œäº†ä¹‹åŽï¼Œå¤§æ¦‚æ‰§è¡Œåˆ°67%çš„æ—¶å€™ï¼Œå¼€å§‹è¿›å…¥ CustomBeanï¼Œæ‰§è¡ŒCustomBeançš„compareTo()æ–¹æ³•ï¼Œä¼šæŒ‰ç…§è‡ªå·±å†™çš„è§„åˆ™ä¸€æ¡ä¸€æ¡æ•°æ®æ¯”è¾ƒ ä¸Šè¿°éƒ½æ¯”è¾ƒå®Œæ¯•ä¹‹åŽï¼Œmapé˜¶æ®µå°±ç»“æŸäº†ï¼Œæ­¤æ—¶æ¥åˆ°äº† reduceé˜¶æ®µï¼Œä½†æ˜¯æ˜¯åˆ°äº†67%äº† åˆ°äº†reduceé˜¶æ®µï¼Œç›´æŽ¥è¿›å…¥äº†MyGroupä¸­è‡ªå®šä¹‰çš„compareæ–¹æ³•ã€‚ MyGroupçš„compare()æ–¹æ³•ï¼Œå¦‚æžœè¿”å›žéž0ï¼Œ å°±ä¼šè¿›å…¥ reduce æ–¹æ³•å†™å‡ºåˆ°context MyGroupè¿›å…¥Reduceçš„æ¡ä»¶æ˜¯ MyReduceä¸­ï¼Œå¦‚æžœcompareçš„ç»“æžœä¸ç­‰äºŽ0ï¼Œä¹Ÿå°±æ˜¯æ¯”è¾ƒçš„2è€…ä¸ç›¸åŒï¼Œ æ­¤æ—¶å°±è¿›å…¥Reduceï¼Œ å†™å‡ºåˆ°ä¸Šä¸‹æ–‡ å¦‚æžœç›¸åŒï¼Œä¼šä¸€ç›´å¾€ä¸‹è¯»ï¼Œç›´åˆ°è¯»åˆ°ä¸åŒçš„ï¼Œ æ­¤æ—¶å†™å‡ºè¯»åˆ°ä¸Šä¸‹æ–‡ã€‚ å› ä¸ºMyGroupä¼šåœ¨Reduceé˜¶æ®µæ‰§è¡Œï¼Œè€ŒCustomBeanä¸­çš„compareTo()æ˜¯åœ¨mapé˜¶æ®µæ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦åœ¨CustomBeanä¸­å°±æŠŠç»„æŽ’å¥½åºï¼Œæ­¤æ—¶åˆ†ç»„åŠŸèƒ½æ‰èƒ½æ­£å¸¸è¿ä½œ æŒ‡å®šåˆ†ç»„ç±»MyGroupå’Œä¸æŒ‡å®šçš„åŒºåˆ«æŒ‡å®šä¸Žä¸æŒ‡å®šæ˜¯æŒ‡ï¼šåœ¨Driverç±»ä¸­ï¼Œæ˜¯å¦åŠ ä¸Šjob.setGroupingComparatorClass(MyGrouper.class);è¿™ä¸€å¥ã€‚ æŒ‡å®šåˆ†ç»„ç±»ï¼š ä¼šæŒ‰ç…§åˆ†ç»„ç±»ä¸­ï¼Œè‡ªå®šä¹‰çš„compare()æ–¹æ³•æ¯”è¾ƒï¼Œç›¸åŒçš„ä¸ºä¸€ç»„ï¼Œåˆ†å®Œä¸€ç»„å°±è¿›å…¥ä¸€æ¬¡reduceæ–¹æ³• ä¸æŒ‡å®šåˆ†ç»„ç±»ï¼šï¼ˆç›®å‰å­˜ç–‘ï¼‰ æ˜¯å¦æ˜¯æŒ‰ç…§keyè¿›è¡Œåˆ†ç»„ å¦‚æžœæ˜¯è‡ªå®šä¹‰ç±»ä¸ºkeyï¼Œæ˜¯å¦æ˜¯æŒ‰ç…§æ­¤keyä¸­å€¼ç›¸åŒçš„åˆ†ä¸ºä¸€ç»„ å¦‚æžœæ˜¯hadoopå†…ç½®ç±»ï¼Œæ˜¯å¦æ˜¯æŒ‰ç…§æ­¤ç±»çš„å€¼åˆ†ç»„ï¼ˆText-Stringçš„å€¼ï¼ŒIntWritable-intå€¼ç­‰..ï¼‰ ä¾ç„¶æ˜¯èµ°å¾—ä»¥ä¸Šè¿™å¥—åˆ†ç»„é€»è¾‘ï¼Œä¸€ç»„çš„æ•°æ®è¯»å®Œæ‰è¿›å…¥åˆ°Reduceé˜¶æ®µåšå½’å¹¶ Logä¿¡æ¯CustomBeanä¸­æ²¡æœ‰è¿›è¡Œåˆ†ç»„, ç»„å†…æŽ’åºçš„log123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129// ==================MyGroupä¸­compare()æ–¹æ³•=======================computer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---english// ======================reduceä¸­çš„æ‰§è¡Œlog============================================ç¬¬1æ¬¡è¿›å…¥reducecomputer huangjiaju 83.2---------in for write------computer liutao 83.0---------in for write------==================ç¬¬2æ¬¡è¿›å…¥reducemath huangxiaoming 83.0---------in for write------==================ç¬¬3æ¬¡è¿›å…¥reduceenglish huanglei 83.0---------in for write------==================ç¬¬4æ¬¡è¿›å…¥reducemath huangjiaju 82.28571428571429---------in for write------==================ç¬¬5æ¬¡è¿›å…¥reducealgorithm huangjiaju 82.28571428571429---------in for write------algorithm liutao 82.0---------in for write------==================ç¬¬6æ¬¡è¿›å…¥reducecomputer huanglei 74.42857142857143---------in for write------==================ç¬¬7æ¬¡è¿›å…¥reduceenglish liuyifei 74.42857142857143---------in for write------==================ç¬¬8æ¬¡è¿›å…¥reducealgorithm huanglei 74.42857142857143---------in for write------==================ç¬¬9æ¬¡è¿›å…¥reducemath huanglei 74.42857142857143---------in for write------==================ç¬¬10æ¬¡è¿›å…¥reducealgorithm huangzitao 72.75---------in for write------==================ç¬¬11æ¬¡è¿›å…¥reducemath liujialing 72.75---------in for write------==================ç¬¬12æ¬¡è¿›å…¥reducecomputer huangzitao 72.42857142857143---------in for write------==================ç¬¬13æ¬¡è¿›å…¥reduceenglish huangxiaoming 72.42857142857143---------in for write------==================ç¬¬14æ¬¡è¿›å…¥reducemath wangbaoqiang 72.42857142857143---------in for write------==================ç¬¬15æ¬¡è¿›å…¥reducecomputer huangxiaoming 72.42857142857143---------in for write------==================ç¬¬16æ¬¡è¿›å…¥reducemath xuzheng 69.28571428571429---------in for write------==================ç¬¬17æ¬¡è¿›å…¥reduceenglish zhaobenshan 69.28571428571429---------in for write------==================ç¬¬18æ¬¡è¿›å…¥reducecomputer huangbo 65.25---------in for write------computer xuzheng 65.0---------in for write------==================ç¬¬19æ¬¡è¿›å…¥reduceenglish zhouqi 64.18181818181819---------in for write------==================ç¬¬20æ¬¡è¿›å…¥reducecomputer liujialing 64.11111111111111---------in for write------==================ç¬¬21æ¬¡è¿›å…¥reducealgorithm liuyifei 62.142857142857146---------in for write------==================ç¬¬22æ¬¡è¿›å…¥reduceenglish liujialing 62.142857142857146---------in for write------==================ç¬¬23æ¬¡è¿›å…¥reducecomputer liuyifei 62.142857142857146---------in for write------==================ç¬¬24æ¬¡è¿›å…¥reduceenglish liuyifei 59.57142857142857---------in for write------english huangdatou 56.0---------in for write------==================ç¬¬25æ¬¡è¿›å…¥reducemath liutao 56.0---------in for write------==================ç¬¬26æ¬¡è¿›å…¥reducealgorithm huangdatou 56.0---------in for write------==================ç¬¬27æ¬¡è¿›å…¥reducecomputer huangdatou 56.0---------in for write------==================ç¬¬28æ¬¡è¿›å…¥reduceenglish huangbo 55.0---------in for write------ CustomBeanä¸­åšäº†åˆ†ç»„&amp;ç»„å†…æŽ’åº çš„123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120// **Beanä¸­ç›¸åŒçš„ç»„è¿›è¡Œåˆ†æ•°é™åºï¼Œ ç»„è¿›è¡Œå­—å…¸æŽ’åºï¼Œæ­¤æ—¶MyGroupä¸­æ‰§è¡Œçš„**algorithm---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---algorithmalgorithm---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---computercomputer---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---englishenglish---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---mathmath---MyGroupä¸­æ¯”è¾ƒ---math// ======================reduceä¸­æ‰§è¡Œ============================================ç¬¬1æ¬¡è¿›å…¥reducealgorithm huangjiaju 82.28571428571429---------in for write------algorithm liutao 82.0---------in for write------algorithm huanglei 74.42857142857143---------in for write------algorithm huangzitao 72.75---------in for write------algorithm liuyifei 62.142857142857146---------in for write------algorithm huangdatou 56.0---------in for write------===================ç¦»å¼€reduce==================ç¬¬2æ¬¡è¿›å…¥reducecomputer huangjiaju 83.2---------in for write------computer liutao 83.0---------in for write------computer huanglei 74.42857142857143---------in for write------computer huangzitao 72.42857142857143---------in for write------computer huangxiaoming 72.42857142857143---------in for write------computer huangbo 65.25---------in for write------computer xuzheng 65.0---------in for write------computer liujialing 64.11111111111111---------in for write------computer liuyifei 62.142857142857146---------in for write------computer huangdatou 56.0---------in for write------===================ç¦»å¼€reduce==================ç¬¬3æ¬¡è¿›å…¥reduceenglish huanglei 83.0---------in for write------english liuyifei 74.42857142857143---------in for write------english huangxiaoming 72.42857142857143---------in for write------english zhaobenshan 69.28571428571429---------in for write------english zhouqi 64.18181818181819---------in for write------english liujialing 62.142857142857146---------in for write------english liuyifei 59.57142857142857---------in for write------english huangdatou 56.0---------in for write------english huangbo 55.0---------in for write------===================ç¦»å¼€reduce==================ç¬¬4æ¬¡è¿›å…¥reducemath huangxiaoming 83.0---------in for write------math huangjiaju 82.28571428571429---------in for write------math huanglei 74.42857142857143---------in for write------math liujialing 72.75---------in for write------math wangbaoqiang 72.42857142857143---------in for write------math xuzheng 69.28571428571429---------in for write------math liutao 56.0---------in for write------===================ç¦»å¼€reduce// ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ å¦‚æžœåªå–ä¸€ä¸ªæ¯æ¬¡valuesçš„ç¬¬ä¸€ä¸ªçš„è¯ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿algorithm huangjiaju 82.28571428571429==================ç¬¬1æ¬¡è¿›å…¥reducecomputer huangjiaju 83.2==================ç¬¬2æ¬¡è¿›å…¥reduceenglish huanglei 83.0==================ç¬¬3æ¬¡è¿›å…¥reducemath huangxiaoming 83.0==================ç¬¬4æ¬¡è¿›å…¥reduce å…¶å®ƒç–‘ç‚¹ é€šè¿‡logå¯ä»¥çœ‹å‡ºæ¥ï¼Œ MyGroupæ˜¯åœ¨è¯»åˆ°äº†ä¸åŒçš„æ•°æ®ï¼Œæ‰ä¼šè¿›å…¥åˆ° reduce ç±»ä¸­å†™å‡ºï¼› ä½†æ˜¯ é€šè¿‡ æ–­ç‚¹è°ƒè¯•æ—¶ï¼Œ çŽ°è±¡æ˜¯ï¼Œç¬¬ä¸€æ¬¡è¯»åˆ°äº†2ä¸ªç›¸åŒçš„ï¼Œå°±åŽ»reduceåŽ»å†™å‡ºäº†ï¼› åŽé¢å†è¯»çš„å°±ä¸åšå†™å‡ºæ“ä½œï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡è¯»åˆ°2ä¸ªç›¸åŒçš„ï¼Œå†åœ¨reduceä¸­å†™å‡ºã€‚ title:ï£¿ï£¿ï£¿ï£¿ï£¿ æ‰§è¡Œæµç¨‹æ—¶åºå›¾ ï£¿ï£¿ï£¿ï£¿ï£¿ Mapper(map)->ScoreBean: k:ScoreBean(courseName,avgScore) Mapper(map)->ScoreBean: v:Text(stuName) Mapper(ScoreBean)->Reducer(MyGroup): courseæŒ‰å­—å…¸å‡åº Mapper(ScoreBean)->Reducer(MyGroup): courseå†…æˆç»©é™åº Reducer(MyGroup)->Reducer(reduce): æ ¹æ®è‡ªå®šä¹‰çš„åˆ†ç»„è§„åˆ™æŒ‰ç»„è¾“å‡º Reducer(MyGroup)->Reducer(reduce): ä¸€ç»„åªè°ƒç”¨reduceä¸€æ¬¡ Reducer(reduce)-->Reducer(reduce):{"theme":"simple"} var code = document.getElementById("sequence-0-code").value; var options = JSON.parse(decodeURIComponent(document.getElementById("sequence-0-options").value)); var diagram = Diagram.parse(code); diagram.drawSVG("sequence-0", options);]]></content>
      <categories>
        <category>Hadoop</category>
        <category>MapReduce</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>MapReduce</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[â–å¼€å§‹]]></title>
    <url>%2F2018%2F06%2F10%2FPoetry%2F%E5%BC%80%E5%A7%8B%2F</url>
    <content type="text"><![CDATA[æœˆäº®è½ä¸‹ä¸€ä¸¤ç‰‡ç¾½æ¯›åœ¨ç”°é‡Žä¸Šã€‚ é»‘æš—ä¸­çš„éº¦å­è†å¬ç€ã€‚ å¿«é™ä¸‹æ¥ã€‚ å¿«ã€‚ å°±åœ¨é‚£å„¿ï¼Œæœˆäº®çš„å­©å­ä»¬æ­£è¯•ç€ æŒ¥åŠ¨ç¿…è†€ã€‚ åœ¨ä¸¤æ£µæ ‘ä¹‹é—´ï¼Œèº«æä¿®é•¿çš„å¥³å­æŠ¬èµ·é¢åºžï¼Œ ç¾Žä¸½çš„å‰ªå½±ã€‚æŽ¥ç€ï¼Œå¥¹æ­¥å…¥ç©ºä¸­ï¼ŒæŽ¥ç€ï¼Œ å¥¹å®Œå…¨æ¶ˆå¤±åœ¨ç©ºä¸­ã€‚ æˆ‘ç‹¬è‡ªç«™åœ¨ä¸€æ£µæŽ¥éª¨æœ¨æ—ï¼Œä¸æ•¢å‘¼å¸ï¼Œ ä¹Ÿä¸æ•¢åŠ¨ã€‚ æˆ‘è†å¬ç€ã€‚ éº¦å­å‘åŽé ç€è‡ªå·±çš„é»‘æš—ï¼Œ è€Œæˆ‘é ç€æˆ‘çš„ã€‚ ä½œè€… / [ç¾Žå›½] è©¹å§†æ–¯Â·èµ–ç‰¹ ç¿»è¯‘ / å¼ æ–‡æ­¦ â–Beginning The moon drops one or two feathers into the fields. The dark wheat listens. Be still. Now. There they are, the moonâ€™s young, trying Their wings. Between trees, a slender woman lifts up the lovely shadow Of her face, and now she steps into the air, now she is gone Wholly, into the air. I stand alone by an elder tree, I do not dare breathe Or move. I listen. The wheat leans back toward its own darkness, And I lean toward mine. Author / James Wright]]></content>
      <categories>
        <category>æ–‡è‰º</category>
        <category>è¯—æ­Œ</category>
      </categories>
      <tags>
        <tag>è¯—æ­Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Markdowné«˜é˜¶è¯­æ³•]]></title>
    <url>%2F2018%2F06%2F10%2FTools%2FMarkdown%2FMarkdown%E9%AB%98%E9%98%B6%E8%AF%AD%E6%B3%95%2F</url>
    <content type="text"><![CDATA[æ—¶åºå›¾çš„å†™æ³• æµç¨‹å›¾çš„å†™æ³• ç±»å›¾çš„å†™æ³• st=>start: Start|past:>http://www.google.com[blank] e=>end: End:>http://www.google.com op1=>operation: My Operation|past op2=>operation: Stuff|current sub1=>subroutine: My Subroutine|invalid cond=>condition: Yes or No?|approved:>http://www.google.com c2=>condition: Good idea|rejected io=>inputoutput: catch something...|request st->op1(right)->cond cond(yes, right)->c2 cond(no)->sub1(left)->op1 c2(yes)->io->e c2(no)->op2->e{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12} var code = document.getElementById("flowchart-0-code").value; var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value)); var diagram = flowchart.parse(code); diagram.drawSVG("flowchart-0", options);mapper->Bob: Hello Bob, how are you? Note right of Bob: Bob thinks Bob-->reducer: I am good thanks!ad u? reducer->out: I'm fine too out->me: ok, you win me-->Bob: nono, not{"theme":"simple"} var code = document.getElementById("sequence-0-code").value; var options = JSON.parse(decodeURIComponent(document.getElementById("sequence-0-options").value)); var diagram = Diagram.parse(code); diagram.drawSVG("sequence-0", options);]]></content>
      <categories>
        <category>å·¥å…·</category>
        <category>Markdown</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>å·¥å…·</tag>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[About Sublime Text3]]></title>
    <url>%2F2018%2F06%2F09%2FTools%2FSublime%2F%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98%2F</url>
    <content type="text"><![CDATA[ä¸»é¢˜è¯¦æƒ…å‚è§è¿™ä¸ªç½‘ç«™ è¯¦ç»†æ“ä½œè§æ­¤ç«™]]></content>
      <categories>
        <category>å·¥å…·</category>
        <category>Sublime</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>å·¥å…·</tag>
        <tag>Sublime</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MapReduceç¬”è®°-Bugæ±‡æ€»]]></title>
    <url>%2F2018%2F06%2F09%2FHadoop%2F2-MapReduce%2FMapReduce-Bug%E6%B1%87%E6%80%BB%2F</url>
    <content type="text"><![CDATA[1ã€reduce è¾“å‡ºè·¯å¾„å¿…é¡»æ˜¯æ–°åˆ›å»ºçš„ã€‚ä¸èƒ½å·²ç»å­˜åœ¨1Exception in thread "main" org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://cs1:9000/flowout01 already exists 2ã€åœ¨åˆå§‹åŒ– job çš„æ—¶å€™ï¼Œ æ²¡æœ‰ä¼  conf ï¼Œ å¯¼è‡´åŽé¢ä¸€ç›´æ‰¾ä¸åˆ°æ–‡ä»¶ï¼Œ å› ä¸ºä¸çŸ¥é“åˆ°å“ªé‡ŒåŽ»æ‰¾3ã€Textå¯¼åŒ…å€’é”™, å¯¼çš„æ—¶å€™è¦æ³¨æ„åº”è¯¥æ˜¯è¿™ä¸ª import org.apache.hadoop.io.Text; 4ã€è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æŽ¥çš„æ—¶å€™ï¼ŒæŠŠ StringBuilder å†™åˆ°äº† reduce æ–¹æ³•å¤–ï¼Œ è¿™æ ·å¯¼è‡´ sb ä¼šè¶Šæ¥è¶Šå¤šï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ¯æ¬¡æ‹¼æŽ¥å®Œäº†æ¸…ç©ºç±»ä¼¼äºŽè¿™æ · 1234567891011121314A F,I,O,K,G,D,C,H,BB F,I,O,K,G,D,C,H,B,E,J,F,AC F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,FD F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,LE F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,HF F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,H,C,M,L,A,D,GG F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,H,C,M,L,A,D,G,MH F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,H,C,M,L,A,D,G,M,OI F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,H,C,M,L,A,D,G,M,O,O,CJ F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,H,C,M,L,A,D,G,M,O,O,C,OK F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,H,C,M,L,A,D,G,M,O,O,C,O,O,BL F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,H,C,M,L,A,D,G,M,O,O,C,O,O,B,D,EM F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,H,C,M,L,A,D,G,M,O,O,C,O,O,B,D,E,E,FO F,I,O,K,G,D,C,H,B,E,J,F,A,B,E,K,A,H,G,F,H,C,G,F,E,A,K,L,A,B,L,G,M,F,D,H,C,M,L,A,D,G,M,O,O,C,O,O,B,D,E,E,F,A,H,I,J,F 4ã€mapreduceæ‰§è¡Œé”™è¯¯Mapper.\é”™è¯¯ Mapper &amp; Reducer å†™æˆå†…éƒ¨ç±»çš„æ—¶å€™ï¼Œæœ‰æ²¡æœ‰åŠ ä¸Š static Beanç±»æœ‰æ²¡æœ‰æ— å‚æž„é€  5ã€æŽ’åºè¿‡ç¨‹ä¸­ï¼Œè‡ªå®šä¹‰äº†æŽ’åºç±»ï¼Œbeanç±»çš„ compareTo()æ–¹æ³•ï¼Œåªå†™äº†æŒ‰ç…§åˆ†æ•°å¤§å°æŽ’åºã€‚ä¼šå‡ºçŽ°å¦‚ä¸‹é”™è¯¯ï¼š è¯¾ç¨‹å¹¶æ²¡æœ‰åˆ†ç»„ æ²¡æœ‰åœ¨ç›¸åŒçš„ä¸€ç»„è¯¾ç¨‹ä¸­æ¯”è¾ƒåˆ†æ•°ï¼Œ è€Œæ˜¯æ¯”è¾ƒçš„æ‰€æœ‰çš„åˆ†æ•° 12345678computer huangjiaju 83.2math huangxiaoming 83.0english huanglei 83.0math huangjiaju 82.28571428571429algorithm huangjiaju 82.28571428571429computer huanglei 74.42857142857143english liuyifei 74.42857142857143... æ­¤æ—¶åº”è¯¥åœ¨Beanå¯¹è±¡ä¸­åšå¦‚ä¸‹äº‹æƒ… ç›¸åŒè¯¾ç¨‹çš„æŒ‰ç…§åˆ†æ•°é™åºæŽ’åº è¯¾ç¨‹åæŒ‰ç…§è‡ªç„¶ï¼ˆå‡åºï¼‰æŽ’åº æ¢è¨€ä¹‹ï¼Œå°±æ˜¯CustomBean å¯¹è±¡è¦è¾“å‡ºçš„æ•°æ®æ˜¯ ç»„åå‡åºæŽ’åºï¼Œç»„å†…æŒ‰æˆç»©é™åºæŽ’åº å…·ä½“åˆ†æžå‚é˜…]]></content>
      <categories>
        <category>Hadoop</category>
        <category>MapReduce</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>MapReduce</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MapReduceç¬”è®°-ç»ƒä¹ ]]></title>
    <url>%2F2018%2F06%2F09%2FHadoop%2F2-MapReduce%2FMapReduce-%E7%BB%83%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[æ±‚å¾®åšå…±åŒç²‰ä¸é¢˜ç›®æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š å¤š Job ä¸²è” 1234567891011121314A:B,C,D,F,E,OB:A,C,E,KC:F,A,D,ID:A,E,F,LE:B,C,D,M,LF:A,B,C,D,E,O,MG:A,C,D,E,FH:A,C,D,E,OI:A,OJ:B,OK:A,C,DL:D,E,FM:E,F,GO:A,H,I,J,K ä»¥ä¸Šæ˜¯æ•°æ®ï¼šA:B,C,D,F,E,Oè¡¨ç¤ºï¼šAç”¨æˆ· å…³æ³¨B,C,D,E,F,O æ±‚æ‰€æœ‰ä¸¤ä¸¤ç”¨æˆ·ä¹‹é—´çš„å…±åŒå…³æ³¨å¯¹è±¡ ç­”æ¡ˆï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299package com.rox.mapreduce.mr3._01_å¤šJobä¸²è”;import java.io.IOException;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.Reducer;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.jobcontrol.ControlledJob;import org.apache.hadoop.mapreduce.lib.jobcontrol.JobControl;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class CommonFansDemo &#123; @SuppressWarnings("deprecation") public static void main(String[] args) throws Exception &#123; // Job é€»è¾‘ // æŒ‡å®š HDFS ç›¸å…³çš„å‚æ•° Configuration conf = new Configuration(); conf.set("fs.defaultFS", "hdfs://cs1:9000"); System.setProperty("HADOOP_USER_NAME", "ap"); //ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ // æ–°å»ºä¸€ä¸ª job1 Job job1 = Job.getInstance(conf); // è®¾ç½® Jar åŒ…æ‰€åœ¨è·¯å¾„ job1.setJarByClass(CommonFansDemo.class); // æŒ‡å®š mapper ç±»å’Œ reducer ç±» job1.setMapperClass(MyMapper_Step1.class); job1.setReducerClass(MyReducer_Step1.class); // æŒ‡å®š maptask çš„è¾“å‡ºç±»åž‹ job1.setMapOutputKeyClass(Text.class); job1.setMapOutputValueClass(Text.class); // æŒ‡å®šæœ€ç»ˆçš„è¾“å‡ºç±»åž‹(reduceå­˜åœ¨æ—¶,å°±æ˜¯æŒ‡ ReduceTask çš„è¾“å‡ºç±»åž‹) job1.setOutputKeyClass(Text.class); job1.setOutputValueClass(Text.class); // æŒ‡å®šè¯¥ MapReduce ç¨‹åºæ•°æ®çš„è¾“å…¥è¾“å‡ºè·¯å¾„ FileInputFormat.setInputPaths(job1, new Path("/in/commonfriend")); FileOutputFormat.setOutputPath(job1, new Path("/out/job1")); //ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ // æ–°å»ºä¸€ä¸ª job2 Job job2 = Job.getInstance(conf); // è®¾ç½® Jar åŒ…æ‰€åœ¨è·¯å¾„ job2.setJarByClass(CommonFansDemo.class); // æŒ‡å®š mapper ç±»å’Œ reducer ç±» job2.setMapperClass(MyMapper_Step2.class); job2.setReducerClass(MyReducer_Step2.class); // æŒ‡å®š maptask çš„è¾“å‡ºç±»åž‹ job2.setMapOutputKeyClass(Text.class); job2.setMapOutputValueClass(Text.class); // æŒ‡å®šæœ€ç»ˆçš„è¾“å‡ºç±»åž‹(reduceå­˜åœ¨æ—¶,å°±æ˜¯æŒ‡ ReduceTask çš„è¾“å‡ºç±»åž‹) job2.setOutputKeyClass(Text.class); job2.setOutputValueClass(Text.class); // æŒ‡å®šè¯¥ MapReduce ç¨‹åºæ•°æ®çš„è¾“å…¥è¾“å‡ºè·¯å¾„ FileInputFormat.setInputPaths(job2, new Path("/out/job1")); FileOutputFormat.setOutputPath(job2, new Path("/out/job2")); //ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ /** * å°†å¤šä¸ª job å½“åšä¸€ä¸ªç»„ä¸­çš„ job æäº¤, å‚æ•°åæ˜¯ç»„å * æ³¨æ„: JobControl æ˜¯å®žçŽ°äº† Runnable æŽ¥å£çš„ */ JobControl jControl = new JobControl("common_friend"); // å°†åŽŸç”Ÿçš„ jobæºå¸¦é…ç½® è½¬æ¢ä¸ºå¯æŽ§çš„ job ControlledJob aJob = new ControlledJob(job1.getConfiguration()); ControlledJob bJob = new ControlledJob(job2.getConfiguration()); // æ·»åŠ ä¾èµ–å…³ç³» bJob.addDependingJob(aJob); // æ·»åŠ  job åˆ°ç»„ä¸­ jControl.addJob(aJob); jControl.addJob(bJob); // å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ Thread jobThread = new Thread(jControl); jobThread.start(); while (!jControl.allFinished()) &#123; Thread.sleep(500); &#125; jobThread.stop(); &#125; static class MyMapper_Step1 extends Mapper&lt;LongWritable, Text, Text, Text&gt; &#123; String[] user_attentions; String[] attentions; Text k = new Text(); Text v = new Text(); @Override protected void map(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, Text&gt;.Context context) throws IOException, InterruptedException &#123; user_attentions = value.toString().split(":"); attentions = user_attentions[1].trim().split(","); for (String att : attentions) &#123; k.set(att); v.set(user_attentions[0].trim()); context.write(k, v); &#125; &#125; &#125; /** * @author shixuanji * å°†ä¸¤ä¸¤ç²‰ä¸(æ™®é€šç”¨æˆ·)æ‹¼æŽ¥èµ·æ¥, æ ¼å¼a-f:c =&gt; a,b éƒ½å…±åŒå…³æ³¨äº† c * * A F,I,O,K,G,D,C,H,B B E,J,F,A C B,E,K,A,H,G,F D H,C,G,F,E,A,K,L E A,B,L,G,M,F,D,H F C,M,L,A,D,G */ static class MyMapper_Step2 extends Mapper&lt;LongWritable, Text, Text, Text&gt; &#123; String[] attenion_users; String[] users; Text k = new Text(); Text v = new Text(); @Override protected void map(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, Text&gt;.Context context) throws IOException, InterruptedException &#123; attenion_users = value.toString().split("\t"); users = attenion_users[1].trim().split(","); for (String u1 : users) &#123; for (String u2 : users) &#123; if (u1.compareTo(u2) &lt; 0) &#123; String users = u1 + "-" + u2; k.set(users); v.set(attenion_users[0].trim()); context.write(k, v); &#125; &#125; &#125; &#125; &#125; /** * @author shixuanji * éœ€è¦ç»Ÿè®¡çš„æ˜¯, æŸäººæ‹¥æœ‰çš„å…¨éƒ¨ç²‰ä¸ * key: ä¼ è¿‡æ¥çš„ key * value: ç”¨,åˆ†å‰² */ static class MyReducer_Step1 extends Reducer&lt;Text, Text, Text, Text&gt; &#123; Text k = new Text(); Text v = new Text(); @Override protected void reduce(Text key, Iterable&lt;Text&gt; values, Reducer&lt;Text, Text, Text, Text&gt;.Context context) throws IOException, InterruptedException &#123; // æ³¨æ„: è¿™é‡Œ sb ä¸èƒ½å†™åœ¨å¤–é¢,ä¼šä¸æ–­çš„æ‹¼æŽ¥ StringBuilder sb = new StringBuilder(); for (Text v : values) &#123; sb.append(v.toString()).append(","); &#125; k.set(key); v.set(sb.substring(0, sb.length() - 1)); context.write(k, v); &#125; &#125; /** * @author shixuanji * æ‹¿åˆ°çš„æ•°æ®: a-b c */ static class MyReducer_Step2 extends Reducer&lt;Text, Text, Text, Text&gt; &#123; Text k = new Text(); Text v = new Text(); @Override protected void reduce(Text key, Iterable&lt;Text&gt; values, Reducer&lt;Text, Text, Text, Text&gt;.Context context) throws IOException, InterruptedException &#123; StringBuilder sb = new StringBuilder(); for (Text attention : values) &#123; sb.append(attention.toString()).append(","); &#125; k.set(key); v.set(sb.substring(0, sb.length() - 1)); context.write(k, v); &#125; &#125;&#125;ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿// job1çš„è¾“å‡ºA F,I,O,K,G,D,C,H,BB E,J,F,AC B,E,K,A,H,G,FD H,C,G,F,E,A,K,LE A,B,L,G,M,F,D,HF C,M,L,A,D,GG MH OI O,CJ OK O,BL D,EM E,FO A,H,I,J,F// job2çš„è¾“å‡ºA-B E,CA-C D,FA-D F,EA-E C,D,BA-F O,B,E,D,CA-G E,F,D,CA-H O,E,D,CA-I OA-J B,OA-K D,CA-L D,F,EA-M E,FB-C AB-D E,AB-E CB-F A,E,CB-G C,A,EB-H A,E,CB-I AB-K C,AB-L EB-M EB-O A,KC-D A,FC-E DC-F D,AC-G F,A,DC-H D,AC-I AC-K A,DC-L F,DC-M FC-O I,AD-E LD-F E,AD-G A,F,ED-H E,AD-I AD-K AD-L F,ED-M F,ED-O AE-F C,B,M,DE-G C,DE-H C,DE-J BE-K D,CE-L DF-G A,D,C,EF-H A,E,C,D,OF-I O,AF-J O,BF-K C,A,DF-L E,DF-M EF-O AG-H A,C,D,EG-I AG-K C,A,DG-L D,E,FG-M F,EG-O AH-I O,AH-J OH-K A,D,CH-L E,DH-M EH-O AI-J OI-K AI-O AK-L DK-O AL-M F,E æ±‚å­¦ç”Ÿæˆç»©é¢˜ç›®1234567891011121314151617181920212223242526272829303132computer,huangxiaoming,85,86,41,75,93,42,85computer,xuzheng,54,52,86,91,42computer,huangbo,85,42,96,38english,zhaobenshan,54,52,86,91,42,85,75english,liuyifei,85,41,75,21,85,96,14algorithm,liuyifei,75,85,62,48,54,96,15computer,huangjiaju,85,75,86,85,85english,liuyifei,76,95,86,74,68,74,48english,huangdatou,48,58,67,86,15,33,85algorithm,huanglei,76,95,86,74,68,74,48algorithm,huangjiaju,85,75,86,85,85,74,86computer,huangdatou,48,58,67,86,15,33,85english,zhouqi,85,86,41,75,93,42,85,75,55,47,22english,huangbo,85,42,96,38,55,47,22algorithm,liutao,85,75,85,99,66computer,huangzitao,85,86,41,75,93,42,85math,wangbaoqiang,85,86,41,75,93,42,85computer,liujialing,85,41,75,21,85,96,14,74,86computer,liuyifei,75,85,62,48,54,96,15computer,liutao,85,75,85,99,66,88,75,91computer,huanglei,76,95,86,74,68,74,48english,liujialing,75,85,62,48,54,96,15math,huanglei,76,95,86,74,68,74,48math,huangjiaju,85,75,86,85,85,74,86math,liutao,48,58,67,86,15,33,85english,huanglei,85,75,85,99,66,88,75,91math,xuzheng,54,52,86,91,42,85,75math,huangxiaoming,85,75,85,99,66,88,75,91math,liujialing,85,86,41,75,93,42,85,75english,huangxiaoming,85,86,41,75,93,42,85algorithm,huangdatou,48,58,67,86,15,33,85algorithm,huangzitao,85,86,41,75,93,42,85,75 ä¸€ã€æ•°æ®è§£é‡Š æ•°æ®å­—æ®µä¸ªæ•°ä¸å›ºå®šï¼šç¬¬ä¸€ä¸ªæ˜¯è¯¾ç¨‹åç§°ï¼Œæ€»å…±å››ä¸ªè¯¾ç¨‹ï¼Œcomputerï¼Œmathï¼Œenglishï¼Œalgorithmï¼Œç¬¬äºŒä¸ªæ˜¯å­¦ç”Ÿå§“åï¼ŒåŽé¢æ˜¯æ¯æ¬¡è€ƒè¯•çš„åˆ†æ•° äºŒã€ç»Ÿè®¡éœ€æ±‚ï¼š1ã€ç»Ÿè®¡æ¯é—¨è¯¾ç¨‹çš„å‚åŠ è€ƒè¯•äººæ•°å’Œè¯¾ç¨‹å¹³å‡åˆ† 2ã€ç»Ÿè®¡æ¯é—¨è¯¾ç¨‹å‚è€ƒå­¦ç”Ÿçš„å¹³å‡åˆ†ï¼Œå¹¶ä¸”æŒ‰è¯¾ç¨‹å­˜å…¥ä¸åŒçš„ç»“æžœæ–‡ä»¶ï¼Œè¦æ±‚ä¸€é—¨è¯¾ç¨‹ä¸€ä¸ªç»“æžœæ–‡ä»¶ 3ã€æ±‚å‡ºæ¯é—¨è¯¾ç¨‹å‚è€ƒå­¦ç”Ÿæˆç»©æœ€é«˜å¹³å‡åˆ†çš„å­¦ç”Ÿçš„ä¿¡æ¯ï¼šè¯¾ç¨‹ï¼Œå§“åå’Œå¹³å‡åˆ† ç­”æ¡ˆç¬¬1å°é¢˜ç»Ÿè®¡æ¯é—¨è¯¾ç¨‹çš„å‚è€ƒäººæ•°å’Œè¯¾ç¨‹å¹³å‡åˆ† æ¶‰åŠçŸ¥è¯†ç‚¹: åŽ»é‡ï¼Œ è‡ªå®šä¹‰ç±» 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177// ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ ScoreBean ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿package com.rox.mapreduce.mr3._02_åˆ†ç»„ç»„ä»¶;import java.io.DataInput;import java.io.DataOutput;import java.io.IOException;import org.apache.hadoop.io.WritableComparable;import lombok.AllArgsConstructor;import lombok.Getter;import lombok.NoArgsConstructor;import lombok.Setter;@Getter@Setter@AllArgsConstructor@NoArgsConstructorpublic class ScoreBean implements WritableComparable&lt;ScoreBean&gt; &#123; private String courseName; private String stuName; private Double score; @Override public void write(DataOutput out) throws IOException &#123; out.writeUTF(courseName); out.writeUTF(stuName); out.writeDouble(score); &#125; @Override public void readFields(DataInput in) throws IOException &#123; this.courseName = in.readUTF(); this.stuName = in.readUTF(); this.score = in.readDouble(); &#125; @Override /** * å¦‚æžœæ˜¯ç›¸åŒè¯¾ç¨‹, æŒ‰ç…§åˆ†æ•°é™åºæŽ’åˆ—çš„ * å¦‚æžœæ˜¯ä¸åŒè¯¾ç¨‹, æŒ‰ç…§è¯¾ç¨‹åç§°å‡åºæŽ’åˆ— */ public int compareTo(ScoreBean o) &#123; // æµ‹è¯•ä¸€ä¸‹åªå†™æŒ‰åˆ†æ•°é™åºæŽ’åº// return o.getScore().compareTo(this.getScore()); /*// é¦–å…ˆåˆ†ç»„(åªåœ¨ç›¸åŒçš„ç»„å†…è¿›è¡Œæ¯”è¾ƒ) int nameRes = this.getCourseName().compareTo(o.getCourseName()); if (nameRes == 0) &#123; // è¯¾ç¨‹ç›¸åŒçš„æ—¶å€™æ‰è¿›è¡Œé™åºæŽ’åº int scoreRes = return scoreRes; &#125; return nameRes;*/ return 0; &#125; public String toString1() &#123; return stuName + "\t" + score; &#125; @Override public String toString() &#123; return courseName + "\t" + stuName + "\t" + score; &#125; public ScoreBean(String stuName, Double score) &#123; super(); this.stuName = stuName; this.score = score; &#125;&#125;// ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ ScorePlusDemo1 ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿package com.rox.mapreduce.mr3._02_åˆ†ç»„ç»„ä»¶;import java.io.IOException;import java.util.HashSet;import java.util.Set;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.Reducer;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class ScorePlusDemo1 &#123; public static void main(String[] args) throws IOException, ClassNotFoundException, InterruptedException &#123; Configuration conf = new Configuration(); conf.set("fs.defaultFS", "hdfs://cs1:9000"); System.setProperty("HADOOP_USER_NAME", "ap"); Job job = Job.getInstance(conf); job.setJarByClass(ScorePlusDemo1.class); job.setMapperClass(MyMapper.class); job.setReducerClass(MyReducer.class); job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(ScoreBean.class); job.setOutputKeyClass(Text.class); job.setOutputValueClass(Text.class); String inP = "/in/newScoreIn"; String outP = "/out/ans1"; FileInputFormat.setInputPaths(job, new Path(inP)); FileOutputFormat.setOutputPath(job, new Path(outP)); Path mypath = new Path(outP); FileSystem hdfs = mypath.getFileSystem(conf); if (hdfs.isDirectory(mypath)) &#123; hdfs.delete(mypath, true); &#125; Boolean waitForComp = job.waitForCompletion(true); System.exit(waitForComp?0:1); &#125; static class MyMapper extends Mapper&lt;LongWritable, Text, Text, ScoreBean&gt; &#123; Text k = new Text(); @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; // 1.æˆªå– String[] datas = value.toString().trim().split(","); String courseName = datas[0].trim(); String stuName = datas[1].trim(); int sum = 0; for (int i=2; i&lt;datas.length; i++) &#123; sum += Integer.parseInt(datas[i]); &#125; double avgScore = sum/(datas.length-2); ScoreBean sb = new ScoreBean(courseName, stuName, avgScore); k.set(courseName); context.write(k, sb); &#125; &#125; static class MyReducer extends Reducer&lt;Text, ScoreBean, Text, Text&gt; &#123; Text v = new Text(); @Override protected void reduce(Text key, Iterable&lt;ScoreBean&gt; values, Reducer&lt;Text, ScoreBean, Text, Text&gt;.Context context) throws IOException, InterruptedException &#123; Set&lt;String&gt; stuNames = new HashSet&lt;&gt;(); int count = 0; int sum = 0; for (ScoreBean sb : values) &#123; stuNames.add(sb.getStuName()); count ++; sum += sb.getScore(); &#125; int size = stuNames.size(); String val = size + "\t" + (double)sum/count; v.set(val); context.write(key, v); &#125; &#125;&#125;//ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ æ‰§è¡Œç»“æžœ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿algorithm 6 71.33333333333333computer 10 69.6english 8 66.0math 7 72.57142857142857 ç¬¬2å°é¢˜ç»Ÿè®¡æ¯é—¨è¯¾ç¨‹å‚è€ƒå­¦ç”Ÿçš„å¹³å‡åˆ†ï¼Œå¹¶ä¸”æŒ‰è¯¾ç¨‹å­˜å…¥ä¸åŒçš„ç»“æžœæ–‡ä»¶ï¼Œè¦æ±‚ä¸€é—¨è¯¾ç¨‹ä¸€ä¸ªç»“æžœæ–‡ä»¶ æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š åˆ†åŒº, å­—ç¬¦ä¸²ç»„åˆkeyï¼Œ Partitioner 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207package com.rox.mapreduce.mr3._02_åˆ†ç»„ç»„ä»¶;import java.io.IOException;import java.util.HashMap;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.DoubleWritable;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.Partitioner;import org.apache.hadoop.mapreduce.Reducer;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;/** * @author shixuanji * æ³¨æ„: æ­¤é¢˜å› ä¸ºæ•°æ®ä¸­æœ‰2æ¡ course å’Œ stuNameç›¸åŒçš„æ•°æ®(english liuyifei), æ‰€ä»¥å¿…é¡»å†åœ¨reduceä¸­ç»§ç»­åŽ»é‡ä¸€ä¸‹, å†è®¡ç®—ä¸€ä¸‹å¹³å‡åˆ† * * å¦åˆ™, å¯ä»¥ä¸ç”¨å†™reduce, å› ä¸ºMapperä¸­å·²ç»æŠŠé€»è¾‘å¤„ç†å®Œäº†,å¯ä»¥ç›´æŽ¥è¾“å‡º * æœ€ç»ˆè¾“å‡º: * computer liuyifei 43 * computer huanglei 63 * math liutao 64 * ... */public class ScorePlusDemo2 &#123; public static void main(String[] args) throws IOException, ClassNotFoundException, InterruptedException &#123; // æŒ‡å®šHDFSç›¸å…³å‚æ•° Configuration conf = new Configuration(); conf.set("fs.defaultFS", "hdfs://cs1:9000"); System.setProperty("HADOOP_USER_NAME", "ap"); // ï£¿ åˆ›å»º/é…ç½® Job Job job = Job.getInstance(conf); // è®¾ç½®JaråŒ…ç±»åž‹ job.setJarByClass(ScorePlusDemo2.class); // è®¾ç½®Map Reduceæ‰§è¡Œç±» job.setMapperClass(MyMapper.class); job.setReducerClass(MyReducer.class); // è®¾ç½®Mapè¾“å‡ºç±» job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(DoubleWritable.class); // Reduceè¾“å‡ºç±» job.setOutputKeyClass(Text.class); job.setOutputValueClass(DoubleWritable.class); // ï£¿ï£¿ï£¿ è®¾ç½®åˆ†åŒº ï£¿ï£¿ï£¿ job.setPartitionerClass(MyPartition.class); job.setNumReduceTasks(4); // è®¾ç½®è¾“å…¥ è¾“å‡ºè·¯å¾„ String inP = "/in/newScoreIn"; String outP = "/out/scorePlus2"; FileInputFormat.setInputPaths(job, new Path(inP)); FileOutputFormat.setOutputPath(job, new Path(outP)); // è®¾ç½®å¦‚æžœå­˜åœ¨è·¯å¾„å°±åˆ é™¤ Path mypath = new Path(outP); FileSystem hdfs = mypath.getFileSystem(conf); if (hdfs.isDirectory(mypath)) &#123; hdfs.delete(mypath, true); &#125; // ï£¿ æ‰§è¡Œjob boolean waitForCompletion = job.waitForCompletion(true); System.exit(waitForCompletion?0:-1); &#125; =============================================================== static class MyMapper extends Mapper&lt;LongWritable, Text, Text, DoubleWritable&gt; &#123; // æŠŠ è¯¾ç¨‹+å­¦ç”Ÿ ä½œä¸º key Text k = new Text(); //åªæœ‰è¾“å‡ºStringç±»åž‹çš„, æ‰éœ€è¦åœ¨è¿™é‡Œè®¾ç½®Text DoubleWritable v = new DoubleWritable(); @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; String[] datas = value.toString().trim().split(","); String kStr = datas[0].trim() + "\t" + datas[1].trim(); int sum = 0; for (int i = 2; i &lt; datas.length; i++) &#123; sum += Integer.parseInt(datas[i]); &#125; double avg = sum / (datas.length - 2); k.set(kStr); v.set(avg); context.write(k, v); &#125; &#125;=============================================================== /** * @author shixuanji * æ³¨æ„: æ­¤é¢˜å› ä¸ºæ•°æ®ä¸­æœ‰2æ¡ course å’Œ stuNameç›¸åŒçš„æ•°æ®, æ‰€ä»¥å¿…é¡»å†åœ¨reduceä¸­ * ç»§ç»­åŽ»é‡ä¸€ä¸‹, å†è®¡ç®—ä¸€ä¸‹å¹³å‡åˆ† * * å¦åˆ™, å¯ä»¥ä¸ç”¨å†™reduce, å› ä¸ºMapperä¸­å·²ç»æŠŠé€»è¾‘å¤„ç†å®Œäº†,å¯ä»¥ç›´æŽ¥è¾“å‡º */ static class MyReducer extends Reducer&lt;Text, DoubleWritable, Text, DoubleWritable&gt; &#123; DoubleWritable v = new DoubleWritable(); @Override protected void reduce(Text key, Iterable&lt;DoubleWritable&gt; values, Reducer&lt;Text, DoubleWritable, Text, DoubleWritable&gt;.Context context) throws IOException, InterruptedException &#123; /** * è€ƒè™‘åˆ°æœ‰ è¯¾ç¨‹, å­¦ç”Ÿåç›¸åŒ, åŽé¢çš„æ•°æ®ä¸åŒçš„æƒ…å†µ, è¿™é‡Œå†åšä¸€ä¸ªå¹³å‡æ±‚å’Œ * å¯ä»¥éªŒè¯æ‰“å°ä¸‹ */ int count = 0; Double sum = 0.0; for (DoubleWritable avg : values) &#123; if (count &gt; 0) &#123; // æœ‰keyå®Œå…¨ç›¸åŒçš„æƒ…å†µæ‰ä¼šè¿›åˆ°è¿™é‡Œ System.out.println("è¿™æ˜¯ç¬¬" +count +"æ¬¡, è¯´æ˜Žè¯¾ç¨‹å’Œå§“åæœ‰ç›¸åŒçš„ä¸¤æ¡æ•°æ®\nè¯¾ç¨‹å§“åæ˜¯: "+key.toString()); &#125; sum += avg.get(); count ++; &#125; Double finAvg = sum/count; v.set(finAvg); context.write(key, v); &#125; &#125;&#125;==============================================================================================================================/** * @author shixuanji * ç»§æ‰¿ Partitioner, å®žçŽ°è‡ªå®šä¹‰åˆ†åŒº */class MyPartition extends Partitioner&lt;Text, DoubleWritable&gt; &#123; private static HashMap&lt;String, Integer&gt; courseMap = new HashMap&lt;&gt;(); static &#123; courseMap.put("algorithm", 0); courseMap.put("computer", 1); courseMap.put("english", 2); courseMap.put("math", 3); &#125; @Override public int getPartition(Text key, DoubleWritable value, int numPartitions) &#123; // å–å‡ºMapè¾“å‡ºçš„keyä¸­çš„å‰åŠéƒ¨åˆ†--courseName Integer code = courseMap.get(key.toString().trim().split("\t")[0]); if (code != null) &#123; return code; &#125; return 5; &#125;&#125;=============================================================== =============================================================== ï£¿ï£¿ï£¿ï£¿ï£¿ æ‰§è¡Œç»“æžœ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿algorithm huangdatou 56.0algorithm huangjiaju 82.0algorithm huanglei 74.0algorithm huangzitao 72.0algorithm liutao 82.0algorithm liuyifei 62.0----------computer huangbo 65.0computer huangdatou 56.0computer huangjiaju 83.0computer huanglei 74.0computer huangxiaoming 72.0computer huangzitao 72.0computer liujialing 64.0computer liutao 83.0computer liuyifei 62.0computer xuzheng 65.0---------english huangbo 55.0english huangdatou 56.0english huanglei 83.0english huangxiaoming 72.0english liujialing 62.0english liuyifei 66.5english zhaobenshan 69.0english zhouqi 64.0------------math huangjiaju 82.0math huanglei 74.0math huangxiaoming 83.0math liujialing 72.0math liutao 56.0math wangbaoqiang 72.0math xuzheng 69.0 ç¬¬3å°é¢˜æ±‚å‡º æ¯é—¨è¯¾ç¨‹â‘ å‚ä¸Žè€ƒè¯•çš„å­¦ç”Ÿæˆç»© æœ€é«˜å¹³å±€åˆ†â‘¡ çš„å­¦ç”Ÿçš„ä¿¡æ¯ï¼šè¯¾ç¨‹ï¼Œå§“åå’Œå¹³å‡åˆ† è§£é¢˜æ€è·¯ï¼š é€šè¿‡é¢˜æ„å¾—å‡º2ä¸ªç»“è®º è¯¾ç¨‹è¦åˆ†ç»„ å¹³å‡åˆ†è¦æŽ’åº æŽ’åºçš„è¯ï¼Œäº¤ç»™keyæ¥åšæ— ç–‘æ˜¯æœ€å¥½çš„ï¼Œå› ä¸ºMapReduceä¼šè‡ªåŠ¨å¯¹keyè¿›è¡Œåˆ†ç»„&amp;æŽ’åº å› æ­¤å¯ä»¥æŠŠ è¯¾ç¨‹&amp;å¹³å‡åˆ† ä½œä¸ºä¸€ä¸ªè”åˆkey ä¸ºäº†æ“ä½œæ–¹ä¾¿ï¼Œå¯ä»¥å°è£…åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­åŽ»ï¼š ScoreBean åˆ†ç»„å’ŒæŽ’åºéœ€è¦åœ¨ ScoreBeané‡å†™çš„compareTo()æ–¹æ³•ä¸­å®Œæˆ å› ä¸ºæœ€åŽç»“æžœæ˜¯æ±‚æ¯é—¨è¯¾ç¨‹çš„æœ€é«˜å¹³å‡åˆ†ï¼Œå› æ­¤éœ€è¦å¯¹è¯¾ç¨‹è¿›è¡Œåˆ†ç»„ã€‚ æ­¤æ—¶åŽŸæœ¬çš„é»˜è®¤åˆ†ç»„ï¼ˆä»¥Beanå¯¹è±¡æ•´ä½“åˆ†ç»„ï¼‰å°±ä¸ç®¡ç”¨äº†ï¼Œéœ€è¦è‡ªå®šä¹‰åˆ†ç»„ è‡ªå®šä¹‰åˆ†ç»„è¦ç»§æ‰¿WritableComparatorï¼Œé‡å†™compare()æ–¹æ³•ï¼ŒæŒ‡å®šåˆ†ç»„çš„è§„åˆ™ã€‚ ScoreBeanå…ˆæŒ‰ç…§ç»„åˆ«è¿›è¡ŒæŽ’åºï¼Œåˆ°reduceä¸­æ—¶ï¼Œå·²ç»æ˜¯æŒ‰ç…§ç»„ï¼ŒæŽ’å¥½çš„æ•°æ®ï¼ŒMyGroup ä¼šæŠŠç›¸åŒçš„æ¯”è¾ƒç»“æžœæ”¾åˆ°åŒä¸€ä¸ªç»„ä¸­ï¼Œåˆ†å‘åˆ°reduce. reduceä¸­ï¼Œåªéœ€è¦å–å‡ºæ¯ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¾“å‡ºåˆ°ä¸Šä¸‹æ–‡å³å¯ å›¾ç¤º æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š mrä¸­keyçš„ä½œç”¨ï¼Œè‡ªå®šä¹‰å¯¹è±¡çš„ç”¨æ³•ï¼Œè‡ªå®šä¹‰åˆ†ç»„ï¼Œmrçš„æ‰§è¡Œæµç¨‹ åˆ©ç”¨â€œç­çº§å’Œå¹³å‡åˆ†â€ä½œä¸º keyï¼Œå¯ä»¥å°† map é˜¶æ®µè¯»å–åˆ°çš„æ‰€æœ‰å­¦ç”Ÿæˆç»©æ•°æ®æŒ‰ç…§ç­çº§ å’Œæˆç»©æŽ’å€’åºï¼Œå‘é€åˆ° reduce åœ¨ reduce ç«¯åˆ©ç”¨ GroupingComparator å°†ç­çº§ç›¸åŒçš„ kv èšåˆæˆç»„ï¼Œç„¶åŽå–ç¬¬ä¸€ä¸ªå³æ˜¯æœ€ å¤§å€¼ å…ˆè´´ä¸ªç»“è®ºï¼šæ‰§è¡Œæµç¨‹ç»“è®º mapæ¯è¯»ä¸€è¡Œå°± write åˆ° context ä¸€æ¬¡ï¼ŒæŒ‰ç…§æŒ‡å®šçš„keyè¿›è¡Œåˆ†å‘ map æŠŠæ‰€æœ‰çš„æ•°æ®éƒ½è¯»å®Œäº†ä¹‹åŽï¼Œå¤§æ¦‚æ‰§è¡Œåˆ°67%çš„æ—¶å€™ï¼Œå¼€å§‹è¿›å…¥ CustomBeanï¼Œæ‰§è¡ŒCustomBeançš„compareTo()æ–¹æ³•ï¼Œä¼šæŒ‰ç…§è‡ªå·±å†™çš„è§„åˆ™ä¸€æ¡ä¸€æ¡æ•°æ®æ¯”è¾ƒ ä¸Šè¿°éƒ½æ¯”è¾ƒå®Œæ¯•ä¹‹åŽï¼Œmapé˜¶æ®µå°±ç»“æŸäº†ï¼Œæ­¤æ—¶æ¥åˆ°äº† reduceé˜¶æ®µï¼Œä½†æ˜¯æ˜¯åˆ°äº†67%äº† åˆ°äº†reduceé˜¶æ®µï¼Œç›´æŽ¥è¿›å…¥äº†MyGroupä¸­è‡ªå®šä¹‰çš„compareæ–¹æ³•ã€‚ MyGroupçš„compare()æ–¹æ³•ï¼Œå¦‚æžœè¿”å›žéž0ï¼Œ å°±ä¼šè¿›å…¥ reduce æ–¹æ³•å†™å‡ºåˆ°context MyGroupè¿›å…¥Reduceçš„æ¡ä»¶æ˜¯ MyReduceä¸­ï¼Œå¦‚æžœcompareçš„ç»“æžœä¸ç­‰äºŽ0ï¼Œä¹Ÿå°±æ˜¯æ¯”è¾ƒçš„2è€…ä¸ç›¸åŒï¼Œ æ­¤æ—¶å°±è¿›å…¥Reduceï¼Œ å†™å‡ºåˆ°ä¸Šä¸‹æ–‡ å¦‚æžœç›¸åŒï¼Œä¼šä¸€ç›´å¾€ä¸‹è¯»ï¼Œç›´åˆ°è¯»åˆ°ä¸åŒçš„ï¼Œ æ­¤æ—¶å†™å‡ºè¯»åˆ°ä¸Šä¸‹æ–‡ã€‚ å› ä¸ºMyGroupä¼šåœ¨Reduceé˜¶æ®µæ‰§è¡Œï¼Œè€ŒCustomBeanä¸­çš„compareTo()æ˜¯åœ¨mapé˜¶æ®µæ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦åœ¨CustomBeanä¸­å°±æŠŠç»„æŽ’å¥½åºï¼Œæ­¤æ—¶åˆ†ç»„åŠŸèƒ½æ‰èƒ½æ­£å¸¸è¿ä½œ æŒ‡å®šåˆ†ç»„ç±»MyGroupå’Œä¸æŒ‡å®šçš„åŒºåˆ« æŒ‡å®šä¸Žä¸æŒ‡å®šæ˜¯æŒ‡ï¼šåœ¨Driverç±»ä¸­ï¼Œæ˜¯å¦åŠ ä¸Šjob.setGroupingComparatorClass(MyGrouper.class);è¿™ä¸€å¥ã€‚ æŒ‡å®šåˆ†ç»„ç±»ï¼š ä¼šæŒ‰ç…§åˆ†ç»„ç±»ä¸­ï¼Œè‡ªå®šä¹‰çš„compare()æ–¹æ³•æ¯”è¾ƒï¼Œç›¸åŒçš„ä¸ºä¸€ç»„ï¼Œåˆ†å®Œä¸€ç»„å°±è¿›å…¥ä¸€æ¬¡reduceæ–¹æ³• ä¸æŒ‡å®šåˆ†ç»„ç±»ï¼šï¼ˆç›®å‰å­˜ç–‘ï¼‰ æ˜¯å¦æ˜¯æŒ‰ç…§keyè¿›è¡Œåˆ†ç»„ å¦‚æžœæ˜¯è‡ªå®šä¹‰ç±»ä¸ºkeyï¼Œæ˜¯å¦æ˜¯æŒ‰ç…§æ­¤keyä¸­å€¼ç›¸åŒçš„åˆ†ä¸ºä¸€ç»„ å¦‚æžœæ˜¯hadoopå†…ç½®ç±»ï¼Œæ˜¯å¦æ˜¯æŒ‰ç…§æ­¤ç±»çš„å€¼åˆ†ç»„ï¼ˆText-Stringçš„å€¼ï¼ŒIntWritable-intå€¼ç­‰..ï¼‰ ä¾ç„¶æ˜¯èµ°å¾—ä»¥ä¸Šè¿™å¥—åˆ†ç»„é€»è¾‘ï¼Œä¸€ç»„çš„æ•°æ®è¯»å®Œæ‰è¿›å…¥åˆ°Reduceé˜¶æ®µåšå½’å¹¶ ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231//ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ ScoreBean2 ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿package com.rox.mapreduce.mr3._02_åˆ†ç»„ç»„ä»¶;import java.io.DataInput;import java.io.DataOutput;import java.io.IOException;import org.apache.hadoop.io.WritableComparable;import lombok.Getter;import lombok.Setter;@Getter@Setterpublic class ScoreBean2 implements WritableComparable&lt;ScoreBean2&gt; &#123; private String courseName; private Double score; @Override public void write(DataOutput out) throws IOException &#123; out.writeUTF(courseName); out.writeDouble(score); &#125; @Override public void readFields(DataInput in) throws IOException &#123; this.courseName = in.readUTF(); this.score = in.readDouble(); &#125; @Override /** * å¦‚æžœæ˜¯ç›¸åŒè¯¾ç¨‹, æŒ‰ç…§åˆ†æ•°é™åºæŽ’åˆ—çš„ * å¦‚æžœæ˜¯ä¸åŒè¯¾ç¨‹, æŒ‰ç…§è¯¾ç¨‹åç§°å‡åºæŽ’åˆ— */ public int compareTo(ScoreBean2 o) &#123; // æµ‹è¯•ä¸€ä¸‹åªå†™æŒ‰åˆ†æ•°é™åºæŽ’åº// return o.getScore().compareTo(this.getScore()); // é¦–å…ˆåˆ†ç»„(åªåœ¨ç›¸åŒçš„ç»„å†…è¿›è¡Œæ¯”è¾ƒ) int nameRes = this.getCourseName().compareTo(o.getCourseName()); if (nameRes == 0) &#123; // è¯¾ç¨‹ç›¸åŒçš„æ—¶å€™æ‰è¿›è¡Œé™åºæŽ’åº int scoreRes = o.getScore().compareTo(this.getScore()); return scoreRes; &#125; return nameRes; &#125; /** * å®žé™…ä¸ŠScoreBeanä¸­æ˜¯åŒ…å«æ‰€æœ‰çš„å‚æ•°çš„, è¿™é‡Œçš„è¾“å‡ºå¯ä»¥è‡ªå·±è®¾ç½® */ @Override public String toString() &#123; return courseName + "\t" + score; &#125; public ScoreBean2(String courseName, Double score) &#123; super(); this.courseName = courseName; this.score = score; &#125; public ScoreBean2() &#123; super(); &#125;&#125;//ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ ScorePlusDemo3 ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿package com.rox.mapreduce.mr3._02_åˆ†ç»„ç»„ä»¶;import java.io.IOException;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.io.WritableComparable;import org.apache.hadoop.io.WritableComparator;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.Reducer;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class ScorePlusDemo3 &#123; ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ main ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ public static void main(String[] args) throws Exception &#123; Configuration conf = new Configuration(); conf.set("fs.defaultFS", "hdfs://cs1:9000"); System.setProperty("HADOOP_USER_NAME", "ap"); Job job = Job.getInstance(conf); job.setJarByClass(ScorePlusDemo3.class); job.setMapperClass(MyMapper.class); job.setReducerClass(MyReducer.class); job.setMapOutputKeyClass(ScoreBean2.class); job.setMapOutputValueClass(Text.class); job.setGroupingComparatorClass(MyGrouper.class); job.setOutputKeyClass(Text.class); job.setOutputValueClass(NullWritable.class); String outP = "/out/scorePlus3"; FileInputFormat.setInputPaths(job, new Path("/in/newScoreIn")); FileOutputFormat.setOutputPath(job, new Path(outP)); // å¦‚æžœè¾“å‡ºç›®å½•å­˜åœ¨,å°±å…ˆåˆ é™¤ Path myPath = new Path(outP); FileSystem fs = myPath.getFileSystem(conf); if (fs.isDirectory(myPath)) &#123; fs.delete(myPath, true); &#125; boolean waitForCompletion = job.waitForCompletion(true); System.exit(waitForCompletion ? 0 : -1); &#125;ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ Mapper ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ /** * @author shixuanji * è¾“å‡º: key: course * value: score ... * æ€è·¯: * 1.ä¸åŒè¯¾ç¨‹è¦åˆ†å¼€å±•ç¤º, ä»¥ è¯¾ç¨‹+åˆ†æ•° ä½œä¸ºkey, åœ¨mapperä¸­å®ŒæˆæŽ’åº * 2.åœ¨reduceä¸­æŒ‰ç…§ MyGrouper å®Œæˆåˆ†ç»„ */ static public class MyMapper extends Mapper&lt;LongWritable, Text, ScoreBean2, Text&gt; &#123; private String[] datas; Text v = new Text(); @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; datas = value.toString().trim().split(","); int sum = 0; for (int i = 2; i &lt; datas.length; i++) &#123; sum += Integer.parseInt(datas[i]); &#125; double avg = (double) sum / (datas.length - 2); ScoreBean2 sb = new ScoreBean2(datas[0].trim(), avg); v.set(datas[1].trim()); context.write(sb, v); &#125; &#125;ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ Redecer ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ static public class MyReducer extends Reducer&lt;ScoreBean2, Text, Text, NullWritable&gt; &#123; Text k = new Text(); int count = 1; @Override protected void reduce(ScoreBean2 key, Iterable&lt;Text&gt; values, Context context) throws IOException, InterruptedException &#123; /** * å¦‚æžœæ²¡æœ‰å…¶å®ƒé—®é¢˜ * æ­¤æ—¶æ˜¯æŒ‰ç…§è¯¾ç¨‹åˆ†å¥½ç»„äº†, åŒä¸€ä¸ªè¯¾ç¨‹çš„æ‰€æœ‰å­¦ç”Ÿéƒ½è¿‡æ¥äº†, å¹¶ä¸”å­¦ç”Ÿæˆç»©æ˜¯æŽ’å¥½çš„, * å¦‚æžœæ­¤æ—¶æ±‚æœ€å¤§å€¼, åªéœ€è¦å–å‡ºç¬¬ä¸€ä¸ªå³å¯ */ // è¿›æ¥ä¸€æ¬¡åªå–ç¬¬ä¸€ä¸ª Text name = values.iterator().next(); k.set(key.getCourseName() + "\t" + name.toString() + "\t" + key.getScore()); context.write(k, NullWritable.get()); context.write(new Text("==================ç¬¬"+count+"æ¬¡è¿›å…¥reduce"), NullWritable.get()); /*context.write(new Text("==================ç¬¬"+count+"æ¬¡è¿›å…¥reduce"), NullWritable.get()); for (Text name : values) &#123; k.set(key.getCourseName() + "\t" + name.toString() + "\t" + key.getScore()); context.write(k, NullWritable.get()); context.write(new Text("---------in for write------"), NullWritable.get()); &#125;*/ count++; &#125; &#125;&#125;ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ MyGrouper ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿/** * @author shixuanji * è‡ªå®šä¹‰åˆ†ç»„ éœ€è¦ç»§æ‰¿ä¸€ä¸ªç±»WritableComparator * é‡å†™compareæ–¹æ³• */class MyGrouper extends WritableComparator &#123; // WritableComparator æ­¤æ–¹æ³•çš„é»˜è®¤æ— å‚æž„é€ æ˜¯ä¸ä¼šåˆ›å»ºå¯¹è±¡çš„, éœ€è¦è‡ªå·±é‡å†™ public MyGrouper() &#123; // ä¸­é—´çœåŽ»çš„å‚æ•°æ˜¯ Configuration, å¦‚æžœä¸ºç©º, ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ super(ScoreBean2.class, true); &#125; /** * æ­¤å¤„æ¯”è¾ƒçš„æ˜¯2ä¸ª WritableComparable å¯¹è±¡, éœ€è¦å¼ºè½¬ä¸€ä¸‹å…·ä½“çš„ç±»å¯¹è±¡ */ @SuppressWarnings("rawtypes") @Override public int compare(WritableComparable a, WritableComparable b) &#123; ScoreBean2 aBean = (ScoreBean2) a; ScoreBean2 bBean = (ScoreBean2) b; // è¿”å›žåˆ†ç»„è§„åˆ™ System.out.println(aBean.getCourseName()+"---MyGroupä¸­æ¯”è¾ƒ---"+(bBean.getCourseName())); return aBean.getCourseName().compareTo(bBean.getCourseName()); &#125;&#125;================================================================================ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ æ‰§è¡Œç»“æžœ ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿================================================================================algorithm huangjiaju 82.28571428571429==================ç¬¬1æ¬¡è¿›å…¥reducecomputer huangjiaju 83.2==================ç¬¬2æ¬¡è¿›å…¥reduceenglish huanglei 83.0==================ç¬¬3æ¬¡è¿›å…¥reducemath huangxiaoming 83.0==================ç¬¬4æ¬¡è¿›å…¥reduce MRå®žçŽ°ä¸¤ä¸ªè¡¨çš„æ•°æ®å…³è”Joiné¢˜ç›® è®¢å•æ•°æ®è¡¨t_orderï¼š flag=0id date pid amount1001 20150710 P0001 21002 20150710 P0001 31003 20150710 P0002 3Id:æ•°æ®è®°å½•idDate æ—¥æœŸPid å•†å“idAmount åº“å­˜æ•°é‡ 6.å•†å“ä¿¡æ¯è¡¨t_product flag=1pid name category_id priceP0001 å°ç±³5 C01 2000P0002 é”¤å­T1 C01 3500 mrå®žçŽ°ä¸¤ä¸ªè¡¨çš„æ•°æ®å…³è”id pid date amount name category_id price ç­”æ¡ˆ1 : Reducer ç«¯ å®žçŽ° Joinæ€è·¯ mapç«¯ è¯»å–åˆ°å½“å‰è·¯å¾„ä¸‹ï¼Œæ‰€æœ‰æ–‡ä»¶çš„åˆ‡ç‰‡ä¿¡æ¯ï¼Œ æ ¹æ®æ–‡ä»¶ååˆ¤æ–­æ˜¯é‚£å¼ è¡¨ åœ¨setupä¸­ï¼Œä»Žæ–‡ä»¶åˆ‡ç‰‡ä¸­èŽ·å–åˆ°æ–‡ä»¶å 123456// èŽ·å–è¯»å–åˆ°çš„åˆ‡ç‰‡ç›¸å…³ä¿¡æ¯,ä¸€ä¸ªåˆ‡ç‰‡å¯¹åº”ä¸€ä¸ª maptaskInputSplit inputSplit = context.getInputSplit();// è½¬æ¢ä¸ºæ–‡ä»¶åˆ‡ç‰‡FileSplit fs = (FileSplit)inputSplit;// èŽ·å–æ–‡ä»¶åfilename = fs.getPath().getName(); è¿™é‡Œæ€»å…±ä¼šèŽ·å¾—2ä¸ªæ–‡ä»¶åï¼ˆæŒ‡å®šç›®å½•å­˜äº†2ä¸ªæŒ‡å®šæ–‡ä»¶ï¼‰ï¼Œä¸€ä¸ªæ–‡ä»¶åå¯¹åº”ä¸€ä¸ªåˆ‡ç‰‡ å…³è”å­—æ®µä½œä¸ºkeyï¼Œ å…¶å®ƒçš„ä½œä¸ºvalueï¼Œåœ¨valueå‰é¢åŠ ä¸Šå½“å‰æ–‡ä»¶çš„åç§°æ ‡è®° reduceç«¯ é€šè¿‡æ ‡è®°åŒºåˆ†ä¸¤å¼ è¡¨ï¼ŒæŠŠè¯»å–åˆ°çš„ä¿¡æ¯ï¼Œåˆ†åˆ«å­˜å…¥2ä¸ªlistä¸­ éåŽ†å¤§çš„è¡¨ï¼Œä¸Žå°è¡¨è¿›è¡Œæ‹¼æŽ¥ï¼ˆå°è¡¨çš„ç›¸åŒpidè®°å½•åªä¼šæœ‰ä¸€æ¡ï¼‰ æ‹¼æŽ¥å®ŒæˆåŽå³å¯å†™å‡º ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161package com.rox.mapreduce.mr3._03_join2è¡¨çš„æ•°æ®å…³è”;import java.io.IOException;import java.util.ArrayList;import java.util.List;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.InputSplit;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.Reducer;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.input.FileSplit;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class ReduceJoinDemo &#123; public static void main(String[] args) throws Exception &#123; // æŒ‡å®šHDFSç›¸å…³å‚æ•° Configuration conf = new Configuration(); conf.set("fs.defaultFS", "hdfs://cs1:9000"); System.setProperty("HADOOP_USER_NAME", "ap"); // ï£¿ åˆ›å»º/é…ç½® Job Job job = Job.getInstance(conf); // è®¾ç½®JaråŒ…ç±»åž‹ job.setJarByClass(ReduceJoinDemo.class); // è®¾ç½®Map Reduceæ‰§è¡Œç±» job.setMapperClass(MyMapper.class); job.setReducerClass(MyReducer.class); // è®¾ç½®Mapè¾“å‡ºç±» job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(Text.class); // Reduceè¾“å‡ºç±» job.setOutputKeyClass(Text.class); job.setOutputValueClass(NullWritable.class); // è®¾ç½®è¾“å…¥ è¾“å‡ºè·¯å¾„ String inP = "/in/joindemo"; String outP = "/out/joinout1"; FileInputFormat.setInputPaths(job, new Path(inP)); FileOutputFormat.setOutputPath(job, new Path(outP)); // è®¾ç½®å¦‚æžœå­˜åœ¨è·¯å¾„å°±åˆ é™¤ Path mypath = new Path(outP); FileSystem hdfs = mypath.getFileSystem(conf); if (hdfs.isDirectory(mypath)) &#123; hdfs.delete(mypath, true); &#125; // ï£¿ æ‰§è¡Œjob boolean waitForCompletion = job.waitForCompletion(true); System.exit(waitForCompletion?0:-1); &#125; /** * @author shixuanji * æ€è·¯: è¯»å–2ä¸ªè¡¨ä¸­çš„æ•°æ®,è¿›è¡Œæ ‡è®°å‘é€ * key: ä¸¤è¡¨éœ€è¦å…³è”çš„å­—æ®µ * value: å…¶å®ƒå€¼, éœ€è¦æ ‡è®°ï¼Œ æ ‡è®°æ•°æ®çš„æ¥æº * * * **æ ¸å¿ƒï¼š å…³è”æ¡ä»¶** - æƒ³è¦åœ¨ reduce ç«¯å®Œæˆ joinï¼Œ è¦åœ¨ reduce ç«¯å¯ä»¥åŒæ—¶æŽ¥æ”¶åˆ°ä¸¤ä¸ªè¡¨ä¸­çš„æ•°æ® - è¦ä¿è¯åœ¨ Map ç«¯è¿›è¡Œè¯»æ–‡ä»¶çš„æ—¶å€™ï¼Œ è¯»åˆ°2ä¸ªè¡¨çš„æ•°æ®ï¼Œ å¹¶ä¸”éœ€è¦å¯¹2ä¸ªè¡¨çš„æ•°æ®è¿›è¡ŒåŒºåˆ† - å°†2ä¸ªè¡¨æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ è§£å†³: mapper å¼€å§‹æ‰§è¡Œæ—¶, åœ¨setupæ–¹æ³•ä¸­, ä»Žä¸Šä¸‹æ–‡ä¸­å–åˆ°æ–‡ä»¶å, æ ¹æ®æ–‡ä»¶åæ‰“æ ‡è®° */ static class MyMapper extends Mapper&lt;LongWritable, Text, Text, Text&gt; &#123; String filename = ""; Text k = new Text(); Text v = new Text(); @Override protected void setup( Mapper&lt;LongWritable, Text, Text, Text&gt;.Context context) throws IOException, InterruptedException &#123; // èŽ·å–è¯»å–åˆ°çš„åˆ‡ç‰‡ç›¸å…³ä¿¡æ¯,ä¸€ä¸ªåˆ‡ç‰‡å¯¹åº”ä¸€ä¸ª maptask InputSplit inputSplit = context.getInputSplit(); // è½¬æ¢ä¸ºæ–‡ä»¶åˆ‡ç‰‡ FileSplit fs = (FileSplit)inputSplit; // èŽ·å–æ–‡ä»¶å filename = fs.getPath().getName(); System.out.println("æœ¬æ¬¡èŽ·å–åˆ°çš„æ–‡ä»¶åä¸º-----"+filename); &#125; @Override protected void map(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, Text&gt;.Context context) throws IOException, InterruptedException &#123; // è§£æžå‡ºæ¥æ¯ä¸€è¡Œå†…å®¹, æ‰“æ ‡è®°, å‘é€ String[] infos = value.toString().split("\t"); if (filename.equals("order")) &#123; k.set(infos[2]); // è®¾ç½®æ ‡è®°å‰ç¼€ä¸º OR v.set("OR"+infos[0]+"\t"+infos[1]+"\t"+infos[3]); &#125;else &#123; k.set(infos[0]); // è®¾ç½®æ ‡è®°å‰ç¼€ä¸º PR v.set("PR"+infos[1]+"\t"+infos[2]+"\t"+infos[3]); &#125; context.write(k, v); &#125; &#125; static class MyReducer extends Reducer&lt;Text, Text, Text, NullWritable&gt; &#123; Text k = new Text(); @Override protected void reduce(Text key, Iterable&lt;Text&gt; values, Reducer&lt;Text, Text, Text, NullWritable&gt;.Context context) throws IOException, InterruptedException &#123; /** * é¦–å…ˆæ˜Žç¡® product å’Œ order æ˜¯ ä¸€å¯¹å¤šçš„å…³ç³» * æ ¹æ®å‰ç¼€ä¸åŒ,å–åˆ°2ä¸ªä¸åŒçš„è¡¨å­˜è¿›2ä¸ªå®¹å™¨ä¸­ * éåŽ†å¤šçš„è¡¨, ä¸Žä¸€è¿›è¡Œæ‹¼æŽ¥ * æœ€åŽå†™å‡ºåˆ°ä¸Šä¸‹æ–‡ * æœ€ç»ˆçš„è¾“å‡ºæ ¼å¼ id pid date amount name category_id price */ // å› ä¸ºæ¯æ¬¡éåŽ†åˆ°ä¸åŒçš„pid, éƒ½ä¼šèµ°è¿›æ¥ä¸€æ¬¡, listä¹Ÿä¼šæœ‰æ–°çš„è¾“å‡º,æ‰€ä»¥å¿…é¡»å®šä¹‰åœ¨é‡Œé¢,æ¯æ¬¡è¿›æ¥éƒ½è¦åˆå§‹åŒ– List&lt;String&gt; productList =new ArrayList&lt;&gt;(); List&lt;String&gt; orderList =new ArrayList&lt;&gt;(); for (Text v : values) &#123; String vStr = v.toString(); if (vStr.startsWith("OR")) &#123; orderList.add(vStr.substring(2)); &#125;else &#123; productList.add(vStr.substring(2)); &#125; &#125; // æ­¤æ—¶2ä¸ªlistæ·»åŠ å®Œäº†æœ¬æ¬¡ ç›¸åŒçš„ key(pid) çš„æ‰€æœ‰å•†å“ // éåŽ†å¤šçš„è¿›è¡Œæ‹¼æŽ¥ for (String or : orderList) &#123; // ç›¸åŒçš„ pidçš„ product åªæœ‰ä¸€ä¸ª, productListä¸­çš„æ•°é‡æ˜¯1 // ä½†æ˜¯ç›¸åŒpid çš„ è®¢å• å¯èƒ½æœ‰å¤šä¸ª String res = key.toString() + "\t" + or + productList.get(0); k.set(res); context.write(k, NullWritable.get()); &#125; &#125; &#125;&#125; â€» ç­”æ¡ˆ2 ï¼š Mapper ç«¯å®žçŽ° Join â€»æ€è·¯ åˆ›å»ºjobçš„æ—¶å€™,æŠŠå°è¡¨åŠ å…¥ç¼“å­˜ åœ¨mapçš„setupä¸­, è¯»å–ç¼“å­˜ä¸­çš„æ•°æ®, å­˜å…¥ä¸€ä¸ªæˆå‘˜å˜é‡ mapä¸­ mapæ–¹æ³•ä¸­,åªéœ€è¦è¯»ä¸€ä¸ªè¡¨, ç„¶åŽæ ¹æ®å…³è”æ¡ä»¶(å…³è”key: pid)æ¶ˆé™¤ç¬›å¡å°”é›†,è¿›è¡Œæ‹¼æŽ¥ mapç›´æŽ¥è¾“å‡º, ç”šè‡³éƒ½ä¸éœ€è¦reduce æ³¨æ„ç‚¹: éœ€è¦è¾¾æˆjaråŒ…è¿è¡Œ, ç›´æŽ¥ç”¨Eclipseä¼šæ‰¾ä¸åˆ°ç¼“å­˜ jaråŒ…æ‰§è¡Œæ–¹æ³• 12# å¦‚æžœä»£ç å†…éƒ¨æŒ‡å®šäº†è¾“å…¥è¾“å‡ºè·¯å¾„ï¼ŒåŽé¢çš„/inï¼Œ/outå‚æ•°å¯ä»¥ä¸åŠ hadoop jar xxxx.jar com.rox.xxx.xxxx(ä¸»æ–¹æ³•) /in/xx /out/xx å¦‚æžœæ²¡æœ‰Reduceæ–¹æ³• mainæ–¹æ³•ä¸­ï¼Œè®¾ç½®mapçš„å†™å‡ºkeyï¼Œvalue,åº”è¯¥ç”¨ setOutputKeyClass 123//// è®¾ç½®Mapè¾“å‡ºç±» (å› ä¸ºè¿™é‡Œæ²¡æœ‰Reduce, æ‰€ä»¥è¿™é‡Œæ˜¯æœ€ç»ˆè¾“å‡º,ä¸€å®šè¦æ³¨æ„!!!)//////////job.setOutputKeyClass(Text.class);job.setOutputValueClass(NullWritable.class); è¦è®¾ç½®reduce task çš„ä¸ªæ•°ä¸º0 1job.setNumReduceTasks(0); æŠŠå°æ–‡ä»¶åŠ è½½åˆ°ç¼“å­˜ä¸­çš„æ–¹æ³• 12////////////// å°†å°æ–‡ä»¶åŠ è½½åˆ°ç¼“å­˜ job.addCacheFile(new URI("/in/joindemo/product")); â€‹ ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120package com.rox.mapreduce.mr3._03_join;import java.io.BufferedReader;import java.io.FileReader;import java.io.IOException;import java.net.URI;import java.util.HashMap;import java.util.Map;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class MapJoinDemo &#123; public static void main(String[] args) throws Exception &#123; // æŒ‡å®šHDFSç›¸å…³å‚æ•° Configuration conf = new Configuration(); conf.set("fs.defaultFS", "hdfs://cs1:9000"); System.setProperty("HADOOP_USER_NAME", "ap"); // ï£¿ åˆ›å»º/é…ç½® Job Job job = Job.getInstance(conf); // è®¾ç½®JaråŒ…ç±»åž‹:è¿™é‡Œåƒä¸‡åˆ«å†™é”™äº† job.setJarByClass(MapJoinDemo.class); // è®¾ç½®Map Reduceæ‰§è¡Œç±» job.setMapperClass(MyMapper.class); ///////////// è®¾ç½®Mapè¾“å‡ºç±» (å› ä¸ºè¿™é‡Œæ²¡æœ‰Reduce, æ‰€ä»¥è¿™é‡Œæ˜¯æœ€ç»ˆè¾“å‡º,ä¸€å®šè¦æ³¨æ„!!!)////////// job.setOutputKeyClass(Text.class); job.setOutputValueClass(NullWritable.class); ////////////// è®¾ç½®reduceæ‰§è¡Œä¸ªæ•°ä¸º0 job.setNumReduceTasks(0); ////////////// å°†å°æ–‡ä»¶åŠ è½½åˆ°ç¼“å­˜ job.addCacheFile(new URI("/in/joindemo/product")); // è®¾ç½®è¾“å…¥ è¾“å‡ºè·¯å¾„ String inP = "/in/joindemo/order"; String outP = "/out/joinout2"; FileInputFormat.setInputPaths(job, new Path(inP)); FileOutputFormat.setOutputPath(job, new Path(outP)); // è®¾ç½®å¦‚æžœå­˜åœ¨è·¯å¾„å°±åˆ é™¤ Path mypath = new Path(outP); FileSystem hdfs = mypath.getFileSystem(conf); if (hdfs.isDirectory(mypath)) &#123; hdfs.delete(mypath, true); &#125; // ï£¿ æ‰§è¡Œjob System.exit(job.waitForCompletion(true)?0:-1); &#125; /** * @author shixuanji * æ€è·¯: * åˆ›å»ºjobçš„æ—¶å€™,æŠŠå°è¡¨åŠ å…¥ç¼“å­˜ * åœ¨mapçš„setupä¸­, è¯»å–ç¼“å­˜ä¸­çš„æ•°æ®, å­˜å…¥ä¸€ä¸ªæˆå‘˜å˜é‡ mapä¸­ * mapæ–¹æ³•ä¸­,åªéœ€è¦è¯»ä¸€ä¸ªè¡¨, ç„¶åŽæ ¹æ®å…³è”æ¡ä»¶(å…³è”key: pid)æ¶ˆé™¤ç¬›å¡å°”é›†,è¿›è¡Œæ‹¼æŽ¥ * ç›´æŽ¥è¾“å‡º, ç”šè‡³éƒ½ä¸éœ€è¦reduce * * æ³¨æ„ç‚¹: * éœ€è¦è¾¾æˆjaråŒ…è¿è¡Œ, ç›´æŽ¥ç”¨Eclipseä¼šæ‰¾ä¸åˆ°ç¼“å­˜ * æ ¼å¼: hadoop jaråŒ…æœ¬åœ°è·¯å¾„ jaråŒ…ä¸»æ–¹æ³•å…¨é™å®šå hadoopè¾“å…¥ hadoopè¾“å‡º */ static class MyMapper extends Mapper&lt;LongWritable, Text, Text, NullWritable&gt; &#123; // åˆ›å»ºè£…è½½å°è¡¨çš„map, keyå­˜å‚¨ å…³è”é”®, valueå­˜å…¶å®ƒ Map&lt;String, String&gt; proMap = new HashMap&lt;&gt;(); @Override protected void setup(Context context) throws IOException, InterruptedException &#123; // èŽ·å–ç¼“å­˜ä¸­å­˜å‚¨çš„å°è¡¨ (ä¸€èˆ¬æ˜¯ ä¸€å¯¹å¤šä¸­çš„ ä¸€), å› ä¸ºåªå­˜äº†1ä¸ª,æ‰€ä»¥ç›´æŽ¥å–ç¬¬0ä¸ª Path path = context.getLocalCacheFiles()[0]; String pString = path.toString(); // å¼€å¯inæµ, BufferedReader é€è¡Œè¯»å–æ–‡ä»¶ BufferedReader br = new BufferedReader(new FileReader(pString)); String line = null; while ((line = br.readLine()) != null) &#123; // æˆåŠŸè¯»å–ä¸€è¡Œ String[] infos = line.split("\t"); // å­˜è¿›proMap proMap.put(infos[0], infos[1] + "\t" + infos[2] + "\t" + infos[3]); &#125;// br.close(); &#125; /** * ç›´æŽ¥ä»Žè·¯å¾„è¯»å–å¤§æ–‡ä»¶ */ Text k = new Text(); @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; String[] infos = value.toString().split("\t"); String pid = infos[2]; //è¿›è¡Œå…³è” pidåˆ°mapä¸­åŒ¹é… å¦‚æžœåŒ…å« è¯æ˜ŽåŒ¹é…ä¸Šäº† // è‰¹, è¿™é‡Œpidä¹‹å‰åŠ äº† "", å¦ˆçš„,å½“ç„¶æ‰¾ä¸åˆ°å•¦!!! if (proMap.containsKey(pid)) &#123; String res = value.toString() + "\t" + proMap.get(pid); k.set(res); context.write(k, NullWritable.get()); &#125; &#125; &#125;&#125; title:ï£¿ï£¿ï£¿ï£¿ï£¿ æ‰§è¡Œæµç¨‹æ—¶åºå›¾ ï£¿ï£¿ï£¿ï£¿ï£¿ Mapper(map)->ScoreBean: k:ScoreBean(courseName,avgScore) Mapper(map)->ScoreBean: v:Text(stuName) Mapper(ScoreBean)->Reducer(MyGroup): courseæŒ‰å­—å…¸å‡åº Mapper(ScoreBean)->Reducer(MyGroup): courseå†…æˆç»©é™åº Reducer(MyGroup)->Reducer(reduce): æ ¹æ®è‡ªå®šä¹‰çš„åˆ†ç»„è§„åˆ™æŒ‰ç»„è¾“å‡º Reducer(MyGroup)->Reducer(reduce): ä¸€ç»„åªè°ƒç”¨reduceä¸€æ¬¡{"theme":"simple"} var code = document.getElementById("sequence-0-code").value; var options = JSON.parse(decodeURIComponent(document.getElementById("sequence-0-options").value)); var diagram = Diagram.parse(code); diagram.drawSVG("sequence-0", options);]]></content>
      <categories>
        <category>Hadoop</category>
        <category>MapReduce</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>MapReduce</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MapReduceç¬”è®°-3]]></title>
    <url>%2F2018%2F06%2F08%2FHadoop%2F2-MapReduce%2FMapReduce%E7%AC%94%E8%AE%B0-3%2F</url>
    <content type="text"><![CDATA[1.å¤š Job ä¸²è”1.æ¦‚å¿µå½“ç¨‹åºä¸­æœ‰å¤šä¸ª Jobï¼Œ å¹¶ä¸”å¤šä¸ª job ä¹‹é—´ç›¸äº’ä¾èµ–ï¼Œ a ï¼Œ job éœ€è¦ä¾èµ–å¦ä¸€ä¸ªbï¼Œjob çš„æ‰§è¡Œç»“æžœæ—¶å€™ï¼Œ æ­¤æ—¶éœ€è¦ä½¿ç”¨å¤š job ä¸²è” 2. æ¶‰åŠåˆ°æ˜¨å¤©çš„å¾®åšæ±‚å…±åŒç²‰ä¸é¢˜ç›® A:B,C,D,F,E,OB:A,C,E,KC:F,A,D,ID:A,E,F,LE:B,C,D,M,LF:A,B,C,D,E,O,MG:A,C,D,E,FH:A,C,D,E,OI:A,OJ:B,OK:A,C,DL:D,E,FM:E,F,GO:A,H,I,J,K ä»¥ä¸Šæ˜¯æ•°æ®ï¼šA:B,C,D,F,E,Oè¡¨ç¤ºï¼šAç”¨æˆ· å…³æ³¨B,C,D,E,F,O æ±‚æ‰€æœ‰ä¸¤ä¸¤ç”¨æˆ·ä¹‹é—´çš„å…±åŒå…³æ³¨å¯¹è±¡ æ³¨æ„ è¦å†™2ä¸ªMapReduceï¼Œ å¼€å¯2ä¸ªjob åŽä¸€ä¸ªjobä¾èµ–äºŽå‰ä¸€ä¸ªçš„æ‰§è¡Œç»“æžœ åŽä¸€ä¸ªjobçš„è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼Œå°±æ˜¯å‰ä¸€ä¸ªjobçš„è¾“å‡ºè·¯å¾„ 2ä¸ªjobéœ€è¦æ·»åŠ ä¾èµ– ä»£ç å‚è€ƒç»ƒä¹ -ç¬¬ä¸€é¢˜-æ±‚å¾®åšå…±åŒå¥½å‹ å¤š Job ä¸²è”éƒ¨åˆ†ä»£ç  åŸºæœ¬çš„å†™åˆ°ä¸€èµ·ï¼Œ job1ï¼Œ job2 ç”¨JobControlå¯¹è±¡ç®¡ç†å¤š jobï¼Œ ä¼šå°†å¤šä¸ª job å½“åšä¸€ä¸ªç»„ä¸­çš„ job æäº¤ï¼Œ å‚æ•°æŒ‡çš„æ˜¯ç»„åï¼Œ éšæ„èµ· åŽŸç”Ÿçš„ job è¦è½¬ä¸ºå¯æŽ§åˆ¶çš„ job 123456789101112131415161718// åˆ›å»º JobControl ç»„JobControl jc = new JobControl("common_friend");// job æ‹¿å¥½é…ç½®ï¼Œ åŠ å…¥ ControlledJob ç®¡ç†, å˜æˆå¯æŽ§åˆ¶çš„ jobControlledJob ajob = new ControlledJob(job1.getConfiguration());ControlledJob bjob = new ControlledJob(job2.getConfiguration());// æ·»åŠ ä¾èµ–å…³ç³»bjob.addDependingJob(ajob); // æ·»åŠ  jobè¿› JCjc.addJob(ajob);jc.addJob(bjob);// å¯åŠ¨çº¿ç¨‹Thread jobControlTread = new Thread(jc);jobControlTread.start();// åœ¨çº¿ç¨‹å®Œæˆä¹‹åŽå…³é—­while(!jc.allFinished()) &#123; Thread.sleep(500);&#125;jobControl.stop(); 2. åˆ†ç»„ç»„ä»¶mapâ€“åˆ†ç»„â€“reduce reduce æŽ¥æ”¶åˆ°çš„æ•°æ®æ˜¯æŒ‰ç…§ map è¾“å‡ºçš„ key è¿›è¡Œåˆ†ç»„çš„, åˆ†ç»„çš„æ—¶å€™æŒ‰ç…§ key ç›¸åŒçš„æ—¶å€™ä¸ºä¸€ç»„, é»˜è®¤éƒ½å®žçŽ°äº† WritableComparableæŽ¥å£ï¼Œ å…¶ä¸­çš„ compareToï¼ˆï¼‰æ–¹æ³•è¿”å›žä¸º0çš„æ—¶å€™ é»˜è®¤ä¸ºä¸€ç»„ï¼Œ è¿”å›žä¸ä¸º0ï¼Œ åˆ™åˆ†åˆ°ä¸‹ä¸€ç»„ è‡ªå®šä¹‰åˆ†ç»„ä½¿ç”¨åœºæ™¯ï¼š é»˜è®¤çš„æ•°æ®åˆ†ç»„ä¸èƒ½æ»¡è¶³éœ€æ±‚ ä¸€ã€æ•°æ®è§£é‡Š æ•°æ®å­—æ®µä¸ªæ•°ä¸å›ºå®šï¼šç¬¬ä¸€ä¸ªæ˜¯è¯¾ç¨‹åç§°ï¼Œæ€»å…±å››ä¸ªè¯¾ç¨‹ï¼Œcomputerï¼Œmathï¼Œenglishï¼Œalgorithmï¼Œç¬¬äºŒä¸ªæ˜¯å­¦ç”Ÿå§“åï¼ŒåŽé¢æ˜¯æ¯æ¬¡è€ƒè¯•çš„åˆ†æ•° äºŒã€ç»Ÿè®¡éœ€æ±‚ï¼š1ã€ç»Ÿè®¡æ¯é—¨è¯¾ç¨‹çš„å‚è€ƒäººæ•°å’Œè¯¾ç¨‹å¹³å‡åˆ† 2ã€ç»Ÿè®¡æ¯é—¨è¯¾ç¨‹å‚è€ƒå­¦ç”Ÿçš„å¹³å‡åˆ†ï¼Œå¹¶ä¸”æŒ‰è¯¾ç¨‹å­˜å…¥ä¸åŒçš„ç»“æžœæ–‡ä»¶ï¼Œè¦æ±‚ä¸€é—¨è¯¾ç¨‹ä¸€ä¸ªç»“æžœæ–‡ä»¶ 3ã€æ±‚å‡ºæ¯é—¨è¯¾ç¨‹å‚è€ƒå­¦ç”Ÿæˆç»©æœ€é«˜å¹³å‡åˆ†çš„å­¦ç”Ÿçš„ä¿¡æ¯ï¼šè¯¾ç¨‹ï¼Œå§“åå’Œå¹³å‡åˆ† ç¬¬ä¸‰é¢˜ï¼š è¦æ±‚å°±æ˜¯åˆ†ç»„æ±‚æœ€å¤§å€¼ï¼Œ ä¸¤ä»¶äº‹æƒ…ï¼š åˆ†ç»„ï¼Œ æŽ’åºï¼ˆshuffleï¼‰ æ€»ç»“ï¼š 1ã€åˆ©ç”¨â€œç­çº§å’Œå¹³å‡åˆ†â€ä½œä¸º keyï¼Œå¯ä»¥å°† map é˜¶æ®µè¯»å–åˆ°çš„æ‰€æœ‰å­¦ç”Ÿæˆç»©æ•°æ®æŒ‰ç…§ç­çº§ å’Œæˆç»©æŽ’å€’åºï¼Œå‘é€åˆ° reduce 2ã€åœ¨ reduce ç«¯åˆ©ç”¨ GroupingComparator å°†ç­çº§ç›¸åŒçš„ kv èšåˆæˆç»„ï¼Œç„¶åŽå–ç¬¬ä¸€ä¸ªå³æ˜¯æœ€ å¤§å€¼ å…·ä½“å‚è€ƒï¼šç»ƒä¹ -æ±‚å­¦ç”Ÿæˆç»©-ç¬¬ä¸‰å°é¢˜ 3. Reduce ä¸­çš„2ä¸ªå‘å‘1Iterable\åªèƒ½å¾ªçŽ¯éåŽ†ä¸€æ¬¡ è¿­ä»£å™¨æ¯æ¬¡å¾ªçŽ¯éåŽ†å®Œæˆï¼Œ æŒ‡é’ˆéƒ½ä¼šç§»åŠ¨åˆ°æœ€åŽä¸€ä¸ª ç³»ç»Ÿç±»åž‹ï¼Œæ²¡äº‹ è‡ªå®šä¹‰ç±»åž‹ ï¼Œæœ‰é—®é¢˜ï¼Ÿ å‘2è¿­ä»£å™¨ä¸­æ‰€æœ‰å¯¹è±¡å…¬ç”¨åŒä¸€ä¸ªåœ°å€ 4. Reduce ç«¯çš„ Joinç‰ºç‰²æ•ˆçŽ‡æ¢æ‰§è¡Œ æ€è·¯ï¼š æ ¸å¿ƒï¼š å…³è”æ¡ä»¶ æƒ³è¦åœ¨ reduce ç«¯å®Œæˆ joinï¼Œ è¦åœ¨ reduce ç«¯å¯ä»¥åŒæ—¶æŽ¥æ”¶åˆ°ä¸¤ä¸ªè¡¨ä¸­çš„æ•°æ® è¦ä¿è¯åœ¨ Map ç«¯è¿›è¡Œè¯»æ–‡ä»¶çš„æ—¶å€™ï¼Œ è¯»åˆ°2ä¸ªè¡¨çš„æ•°æ®ï¼Œ å¹¶ä¸”éœ€è¦å¯¹2ä¸ªè¡¨çš„æ•°æ®è¿›è¡ŒåŒºåˆ† å°†2ä¸ªè¡¨æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ Map ç«¯ è¯»å–ä¸¤ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œ è¿›è¡Œåˆ‡åˆ†ã€å‘é€ key ï¼š å…¬å…±å­—æ®µâ€“å…³è”å­—æ®µâ€“pid valueï¼š å‰©ä¸‹çš„å­—æ®µï¼Œ æ ‡è®°æ•°æ®çš„æ¥æºè¡¨ Reduce ç«¯ é€šè¿‡ç¼–è¾‘åˆ†ç¦»å‡º2ä¸ªè¡¨çš„æ•°æ® åˆ†åˆ«å­˜åˆ°2ä¸ªå®¹å™¨ä¸­ï¼ˆArrayListï¼‰ éåŽ†å¤§è¡¨ï¼Œæ‹¼æŽ¥å°è¡¨ ä»£ç å‚è€ƒç»ƒä¹ -ç¬¬ä¸‰é¢˜MRå®žçŽ°2ä¸ªè¡¨ä¹‹é—´çš„Join ç¼ºé™·1. ReduceTask çš„å¹¶è¡Œåº¦é—®é¢˜ï¼š å»ºè®®0.95*datanode çš„ä¸ªæ•° å¹¶è¡Œåº¦ä¸é«˜ï¼Œ æ€§èƒ½ä¸é«˜ 2. å®¹å™¨æ€§èƒ½ list ç­‰ï¼Œ ä¸æå€¡ï¼Œ reduce æŽ¥æ”¶çš„æ•°æ®ï¼Œ å¯èƒ½ä¼šå¾ˆå¤§ 3. ReduceTask å®¹æ˜“äº§ç”Ÿæ•°æ®å€¾æ–œ å‡è®¾æˆ‘ä»¬è®¾ç½®å¤šä¸ª ReduceTaskï¼Œ æ ¹æ®åˆ†åŒºè§„åˆ™ï¼Œ é»˜è®¤ hash ä»¥ keyå…³è”æ¡ä»¶åˆ†ï¼Œ ReduceTaskæ•°æ®å€¾æ–œï¼Œ æ¯ä¸ª ReduceTask åˆ†å·¥ä¸å‡ï¼Œ éžå¸¸å½±å“æ€§èƒ½ï¼Œæ²¡æœ‰åˆç†çš„åˆ©ç”¨é›†ç¾¤èµ„æº åœ¨çœŸå®žçš„ç”Ÿäº§ä¸­ä¸€å®šè¦å°½é‡çš„é¿å…æ•°æ®å€¾æ–œ æœ€å¥½çš„åšæ³•ï¼šå°†åˆ†åŒºè®¾è®¡çš„è¶³å¤Ÿå®Œç¾Žï¼Œéš¾åº¦æ¯”è¾ƒå¤§ å› æ­¤ï¼ŒReduceTask ä¸€èˆ¬ä¸ä¼šå®Œæˆ Johnå·¥ä½œ æ”¾åœ¨ Map ç«¯å®Œæˆå°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜äº† è¡¥å……ï¼šMapper ä¸­çš„æºç åˆ†æž123456789101112131415public void run(Context context) throws IOException, InterruptedException &#123; // åœ¨ maptask æ‰§è¡Œä¹‹å‰è°ƒç”¨ä¸€æ¬¡ï¼Œ ä¸€ä¸ª maptask åªä¼šè°ƒç”¨ä¸€æ¬¡ã€‚setup ä¸­é€šå¸¸ä¼šå¸® map ä¸­åˆå§‹åŒ–ä¸€äº›å˜é‡å’Œèµ„æºï¼Œ æ¯”å¦‚æ•°æ®åº“çš„è¿žæŽ¥ç­‰ã€‚ // ä¸»è¦ç›®çš„ï¼šå‡å°‘èµ„æºçš„åˆå§‹åŒ–æ¬¡æ•°è€Œæå‡ç¨‹åºçš„æ€§èƒ½ setup(context); try &#123; // èŽ·å–æ–‡ä»¶æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€è¡Œï¼Œ ä¸€è¡Œåªè°ƒç”¨ä¸€æ¬¡ while (context.nextKeyValue()) &#123; map(context.getCurrentKey(), context.getCurrentValue(), context); &#125; &#125; finally &#123; // maptask ä»»åŠ¡æ‰§è¡Œå®Œæˆä¹‹åŽä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œä¸€ä¸ª maptask åªä¼šè°ƒç”¨ä¸€æ¬¡ // å¸® map å¤„ç†ä¸€äº›å–„åŽå·¥ä½œï¼Œ æ¯”å¦‚ï¼šèµ„æºçš„å…³é—­ cleanup(context); &#125; &#125; 5. Map ç«¯çš„ Joinæ³¨æ„ç‚¹ï¼šè¿™ç§æ–¹å¼åªèƒ½é€šè¿‡ Jar åŒ…ä¸Šä¼ çš„æ–¹å¼ï¼Œç›´æŽ¥ç”¨ Eclipse ä¼šæ‰¾ä¸åˆ°ç¼“å­˜ ä¸ºäº†æå‡ Map ç«¯ Join æ€§èƒ½ï¼Œ æˆ‘ä»¬çš„ç­–ç•¥æ˜¯ï¼Œ å°†å°è¡¨çš„æ•°æ®åŠ è½½åˆ°æ¯ä¸ªè¿è¡Œçš„ MapTask çš„å†…å­˜ä¸­ã€‚ å¦‚æžœå°è¡¨è¢«åŠ è½½åˆ°äº†å†…å­˜ä¸­ï¼Œ æˆ‘ä»¬æ¯æ¬¡åœ¨ Map ç«¯åªéœ€è¦è¯»å–å¤§è¡¨ï¼Œå½“è¯»å–åˆ°å¤§è¡¨çš„æ¯ä¸€è¡Œæ•°æ®ï¼Œå¯ä»¥ç›´æŽ¥å’Œå†…å­˜ä¸­çš„å°è¡¨è¿›è¡Œå…³è”ã€‚ è¿™ä¸ªæ—¶å€™ï¼Œåªéœ€è¦ Map å°±å¯ä»¥å®Œæˆ Join æ“ä½œäº†ã€‚ 1. å¦‚ä½•å°†å°è¡¨åŠ å…¥åˆ°å†…å­˜ä¸­ï¼Ÿ12// å°†æŒ‡å®šè·¯å¾„æ–‡ä»¶åŠ è½½åˆ°ç¼“å­˜ä¸­job.addCacheFile(new URI("/xxx")); 2. Map ç«¯æ€Žæ ·è¯»å–ç¼“å­˜ä¸­çš„æ•°æ®æƒ³è¦åœ¨ Java ä¸­ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œç¼“å­˜ä¸­çš„æ•°æ®å¿…é¡»å°è£…åˆ° Java çš„å®¹å™¨ä¸­ 12// èŽ·å–ç¼“å­˜æ–‡ä»¶context.getLocalCacheFiles()[0] 3. ä»£ç å‚è€ƒç»ƒä¹ -ç¬¬3é¢˜ ä»£ç æ³¨æ„ç‚¹ï¼š setupï¼šä»Žç¼“å­˜è¯»å–ä¸€æ–‡ä»¶ï¼ˆå¤šå¯¹ä¸€çš„ä¸€ï¼‰åˆ° HashMap main æ–¹æ³•ä¸­æ³¨æ„ç‚¹ 12345// æŒ‡å®šæ–‡ä»¶åŠ å…¥ç¼“å­˜job.addCacheFile(new URI("/xxx")); // å¦‚æžœæ²¡æœ‰ReduceTaskï¼Œ è¦è®¾ç½®ä¸º0job.setNumReduceTasks(0); ç¤ºèŒƒä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384import java.io.BufferedReader;import java.io.FileInputStream;import java.io.IOException;import java.io.InputStreamReader;import java.net.URI;import java.util.HashMap;import java.util.Map;import org.apache.commons.lang.StringUtils;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class MapSideJoin &#123; public static class MapSideJoinMapper extends Mapper&lt;LongWritable, Text, Text, NullWritable&gt; &#123; // ç”¨ä¸€ä¸ªhashmapæ¥åŠ è½½ä¿å­˜äº§å“ä¿¡æ¯è¡¨ Map&lt;String, String&gt; pdInfoMap = new HashMap&lt;String, String&gt;(); Text k = new Text(); /** * é€šè¿‡é˜…è¯»çˆ¶ç±»Mapperçš„æºç ï¼Œå‘çŽ° setupæ–¹æ³•æ˜¯åœ¨maptaskå¤„ç†æ•°æ®ä¹‹å‰è°ƒç”¨ä¸€æ¬¡ å¯ä»¥ç”¨æ¥åšä¸€äº›åˆå§‹åŒ–å·¥ä½œ */ @Override protected void setup(Context context) throws IOException, InterruptedException &#123; BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream("pdts.txt"))); String line; while (StringUtils.isNotEmpty(line = br.readLine())) &#123; String[] fields = line.split(","); pdInfoMap.put(fields[0], fields[1]); &#125; br.close(); &#125; // ç”±äºŽå·²ç»æŒæœ‰å®Œæ•´çš„äº§å“ä¿¡æ¯è¡¨ï¼Œæ‰€ä»¥åœ¨mapæ–¹æ³•ä¸­å°±èƒ½å®žçŽ°joiné€»è¾‘äº† @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; String orderLine = value.toString(); String[] fields = orderLine.split("\t"); String pdName = pdInfoMap.get(fields[1]); k.set(orderLine + "\t" + pdName); context.write(k, NullWritable.get()); &#125; &#125; public static void main(String[] args) throws Exception &#123; Configuration conf = new Configuration(); Job job = Job.getInstance(conf); job.setJarByClass(MapSideJoin.class); job.setMapperClass(MapSideJoinMapper.class); job.setOutputKeyClass(Text.class); job.setOutputValueClass(NullWritable.class); FileInputFormat.setInputPaths(job, new Path("D:/srcdata/mapjoininput")); FileOutputFormat.setOutputPath(job, new Path("D:/temp/output")); // æŒ‡å®šéœ€è¦ç¼“å­˜ä¸€ä¸ªæ–‡ä»¶åˆ°æ‰€æœ‰çš„maptaskè¿è¡ŒèŠ‚ç‚¹å·¥ä½œç›®å½• /* job.addArchiveToClassPath(archive); */// ç¼“å­˜jaråŒ…åˆ°taskè¿è¡ŒèŠ‚ç‚¹çš„classpathä¸­ /* job.addFileToClassPath(file); */// ç¼“å­˜æ™®é€šæ–‡ä»¶åˆ°taskè¿è¡ŒèŠ‚ç‚¹çš„classpathä¸­ /* job.addCacheArchive(uri); */// ç¼“å­˜åŽ‹ç¼©åŒ…æ–‡ä»¶åˆ°taskè¿è¡ŒèŠ‚ç‚¹çš„å·¥ä½œç›®å½• /* job.addCacheFile(uri) */// ç¼“å­˜æ™®é€šæ–‡ä»¶åˆ°taskè¿è¡ŒèŠ‚ç‚¹çš„å·¥ä½œç›®å½• // å°†äº§å“è¡¨æ–‡ä»¶ç¼“å­˜åˆ°taskå·¥ä½œèŠ‚ç‚¹çš„å·¥ä½œç›®å½•ä¸­åŽ» job.addCacheFile(new URI("file:/D:/srcdata/mapjoincache/pdts.txt")); //mapç«¯joinçš„é€»è¾‘ä¸éœ€è¦reduceé˜¶æ®µï¼Œè®¾ç½®reducetaskæ•°é‡ä¸º0 job.setNumReduceTasks(0); boolean res = job.waitForCompletion(true); System.exit(res ? 0 : 1); &#125;&#125; 6. å¯¹æ¯”MapJoin çš„æ–¹å¼ï¼š å¤§ &amp; å°è¡¨ å› ä¸ºæœ‰ä¸€ä¸ªè¡¨éœ€è¦åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ³¨å®šåŠ è½½åˆ°å†…å­˜ä¸­çš„è¡¨ä¸èƒ½è¿‡å¤§ï¼ˆhive ä¸­é»˜è®¤æ˜¯256Mï¼‰ å¤§è¡¨ &amp; å¤§è¡¨ å¦‚ä½•è®¾è®¡ ReduceJoin ï¼š è§£å†³æ•°æ®å€¾æ–œçš„é—®é¢˜ï¼Œåˆç†è®¾è®¡åˆ†åŒºã€‚ â€”å¾ˆéš¾åšåˆ° å°†å…¶ä¸­ä¸€ä¸ªå¤§è¡¨è¿›è¡Œåˆ‡åˆ†ï¼Œåˆ‡åˆ†æˆå°è¡¨ï¼Œ æœ€ç»ˆæ‰§è¡Œ å¤§è¡¨ &amp; å°è¡¨ ä¼˜ç‚¹ å¹¶è¡Œåº¦é«˜ï¼Œä¸å­˜åœ¨æ•°æ®å€¾æ–œçš„é—®é¢˜ï¼Œè¿è¡Œæ•ˆçŽ‡é«˜ ä¼˜å…ˆé€‰æ‹©MapJoin :arrow_forward: 7. æŽ’åºç®—æ³• ï¼ˆå¾…æ•´ç†ï¼šTODOï¼‰1. å¿«é€ŸæŽ’åºè¾¹ç•Œå€¼å§‹ç»ˆæ˜¯ä¸å˜çš„ã€‚ 2. å½’å¹¶æŽ’åºä¸€èˆ¬æƒ…å†µé’ˆå¯¹æœ‰åºçš„ï¼Œå¤šä¸ªï¼Œ å°æ•°æ®é›† åº”ç”¨åœºæ™¯ï¼šæƒ³åˆ°äº†å¤šä¸ªReduce ä»»åŠ¡äº§ç”Ÿçš„å¤šä¸ªæ–‡ä»¶çš„åˆå¹¶ 1. å½’å¹¶æŽ’åºå‰ä¼ ï¼š åˆå¹¶å¤šä¸ªæ•°ç»„ 2. å½’å¹¶æŽ’åº ä¹‹ ä¸€ä¸ªå¤§æ•°æ®é›†â€”å½’â€”â€”â€”-åˆ‡åˆ†æˆå•ä¸ªçš„æ•°æ®é›† â€”-å¹¶â€”â€”â€” ä¸¤ä¸¤ç›¸å¹¶ï¼Œ å¹¶æˆæ–°çš„æ•°ç»„ï¼Œ å°çš„å…ˆæ”¾å…¥æ•°ç»„ï¼Œ å†æ”¾å¤§çš„ æ–°çš„æ•°ç»„å†ä¸æ–­æ‰§è¡Œ ä¸Šè¿°çš„ åˆå¹¶å¤šä¸ªæ•°ç»„ 8. â€» Shuffle è¿‡ç¨‹ â€» mapper é˜¶æ®µå¤„ç†çš„æ•°æ®å¦‚ä½•ä¼ é€’ç»™ reducer é˜¶æ®µï¼Œæ˜¯ MapReduce æ¡†æž¶ä¸­ æœ€å…³é”®çš„ä¸€ä¸ªæµç¨‹ï¼Œè¿™ä¸ªæµç¨‹å°±å« Shuffle Shuffle å³ æ•°æ®æ··æ´— â€”â€” æ ¸å¿ƒæœºåˆ¶ï¼šæ•°æ®åˆ†åŒºï¼ŒæŽ’åºï¼Œå±€éƒ¨èšåˆï¼Œç¼“å­˜ï¼Œæ‹‰å–ï¼Œå†åˆå¹¶ï¼ŒæŽ’åºï¼› çŽ¯å½¢ç¼“å†²åŒº å†…å­˜ä¸­çš„ä¸€ç§é¦–å°¾ç›¸è¿žçš„æ•°æ®ç»“æž„ï¼ˆåº•å±‚æ˜¯å­—èŠ‚æ•°ç»„ï¼‰ï¼Œkvbuffer åŒ…å«åŽŸå§‹æ•°æ®åŒºå’Œå…ƒæ•°æ®åŒºï¼Œä¸€ä¸ªmapTaskä»»åŠ¡å¯¹åº”ä¸€ä¸ªçŽ¯å½¢ç¼“å†²åŒº é»˜è®¤å¤§å° 100Mï¼Œé»˜è®¤é˜ˆ(yu)å€¼ 0.8ï¼Œå³å½“è¾¾åˆ° 80M åŽï¼Œä¼šè§¦å‘ spillæº¢å†™ æ“ä½œï¼Œå°†æ•°æ®å†™å…¥ç£ç›˜ï¼Œæ­¤æ—¶mapperè¾“å‡ºä¼šç»§ç»­å‘å‰©ä½™20Mä¸­å†™æ•°æ®ç¼“å†²åŒºå¤§å° mapred-site.xmlï¼šmapreduce.task.io.sort.mbé˜ˆå€¼ mapred-site.xmlï¼šmapreduce.map.sort.spill.percentè·¯å¾„ï¼šmapred-site.xmlï¼šmapreduce.cluster.local.dir å¦‚æžœæ­¤80Mæ•°æ®å†™å…¥ç£ç›˜å®Œæˆå‰ï¼Œå‰©ä½™20Mç¼“å†²åŒºä¹Ÿå†™å®Œï¼Œåˆ™ä¼šè¿›å…¥é˜»å¡žçŠ¶æ€ï¼Œç›´åˆ°æ˜¯spillå®Œæˆè…¾å‡ºç¼“å†²åŒºç©ºé—´ èµ¤é“ï¼ˆequtorï¼‰ï¼šçŽ¯å½¢ç¼“å†²åŒºä¸­åŽŸå§‹æ•°æ®å’Œå…ƒæ•°æ®çš„è¾¹ç•Œ åŽŸå§‹æ•°æ®ï¼šmapTaskè¾“å‡ºçš„æ•°æ® å…ƒæ•°æ® è®°å½•åŽŸå§‹æ•°æ®çš„æ•°æ®ï¼ŒåŒ…å«4éƒ¨åˆ†å†…å®¹ï¼Œå 16*4å­—èŠ‚ï¼› æ¯ä¸€æ¡å…ƒæ•°æ®å ç”¨ç©ºé—´æ˜¯ä¸€æ ·çš„ï¼ŒæŽ’åºå¯ä»¥é€šè¿‡äº¤æ¢å…ƒæ•°æ®å®žçŽ° åˆ†ç±» a. åŽŸå§‹æ•°æ®ä¸­keyçš„èµ·å§‹ä½ç½® b. åŽŸå§‹æ•°æ®ä¸­valueçš„èµ·å§‹ä½ç½® c. valueçš„é•¿åº¦ d. åˆ†åŒºä¿¡æ¯ï¼Œå³è¯¥æ¡ä¿¡æ¯å±žäºŽå“ªä¸ªåˆ†åŒº æ ¸å¿ƒæ“ä½œ \1. åˆ†åŒº partitionï¼ˆå¦‚æžœ reduceTask åªæœ‰ä¸€ä¸ªæˆ–è€…æ²¡æœ‰ï¼Œé‚£ä¹ˆ partition å°†ä¸èµ·ä½œç”¨ï¼‰ \2. Sort æ ¹æ® key æŽ’åºï¼ˆMapReduce ç¼–ç¨‹ä¸­çš„ sort æ˜¯ä¸€å®šä¼šåšçš„ï¼Œå¹¶ä¸” åªèƒ½æŒ‰ç…§ keyæŽ’åºï¼Œ å½“ç„¶ å¦‚æžœæ²¡æœ‰ reducer é˜¶æ®µï¼Œé‚£ä¹ˆå°±ä¸ä¼šå¯¹ key æŽ’åºï¼‰ \3. Combiner è¿›è¡Œå±€éƒ¨ value çš„åˆå¹¶ï¼ˆCombiner æ˜¯å¯é€‰çš„ç»„ä»¶ï¼Œä½œç”¨åªæ˜¯ä¸ºäº†æé«˜ä»»åŠ¡çš„æ‰§è¡Œæ•ˆçŽ‡ï¼‰ è¯¦ç»†è¿‡ç¨‹ \1. ä¸€ä¸ªå¤§æ–‡ä»¶éœ€è¦å¤„ç†ï¼Œå®ƒåœ¨åœ¨ HDFS ä¸Šæ˜¯ä»¥ block å—å½¢å¼å­˜æ”¾ï¼Œæ¯ä¸ª block é»˜è®¤ä¸º 128M å­˜ 3 ä»½ï¼›è¿è¡Œæ—¶æ¯ä¸ª map ä»»åŠ¡ä¼šå¤„ç†ä¸€ä¸ªåˆ‡å—ï¼ˆsplitï¼‰ï¼Œå¦‚æžœ block å¤§å’Œ split ç›¸åŒï¼Œæœ‰å¤šå°‘ä¸ª block å°±æœ‰å¤šå°‘ä¸ª map ä»»åŠ¡ï¼›æ‰€ä»¥å¯¹æ•´ä¸ªæ–‡ä»¶å¤„ç†æ—¶ä¼šæœ‰å¾ˆå¤š map ä»»åŠ¡è¿›è¡Œå¹¶è¡Œè®¡ç®—ã€‚ \2. æ¯ä¸ª map ä»»åŠ¡å¤„ç†å®Œè¾“å…¥çš„åˆ‡å—åŽä¼šæŠŠç»“æžœå†™å…¥åˆ°å†…å­˜çš„ä¸€ä¸ª çŽ¯å½¢ç¼“å†²åŒºï¼Œå†™å…¥è¿‡ç¨‹ä¸­ä¼šè¿›è¡Œç®€å•æŽ’åºï¼Œå½“ç¼“å†²åŒºçš„å¤§å°é˜€å€¼ï¼Œä¸€ä¸ªåŽå°çš„çº¿ç¨‹å°±ä¼šå¯åŠ¨æŠŠç¼“å†²åŒºä¸­çš„æ•°æ®æº¢å†™ï¼ˆspillï¼‰åˆ°æœ¬åœ°ç£ç›˜ä¸­ï¼ŒåŒæ—¶Mapperç»§ç»­æ—¶å‘çŽ¯å½¢ç¼“å†²åŒºä¸­å†™å…¥æ•°æ®ã€‚ æ•°æ®æº¢å†™å…¥åˆ°ç£ç›˜ä¹‹å‰ï¼Œé¦–å…ˆä¼šæ ¹æ® reducer çš„æ•°é‡åˆ’åˆ†æˆåŒæ•°é‡çš„åˆ†åŒºï¼ˆpartitionï¼‰ï¼Œæ¯ä¸ªåˆ†åŒºä¸­çš„éƒ½æ•°æ®ä¼šæœ‰åŽå°çº¿ç¨‹æ ¹æ® map ä»»åŠ¡çš„è¾“å‡ºç»“æžœ key è¿›è¡ŒæŽ’åºï¼› å¦‚æžœæœ‰ combinerï¼Œå®ƒä¼šåœ¨ ç¼“å†²åŒºæº¢å†™åˆ°ç£ç›˜ä¹‹å‰ å’Œ mapTaskæŽ’å¥½åºçš„è¾“å‡ºä¸Š è¿è¡Œï¼Œä½¿å†™åˆ°æœ¬åœ°ç£ç›˜å’Œä¼ ç»™ reducer çš„æ•°æ®æ›´å°‘ï¼›Combinerå³æ˜¯æŠŠåŒä¸€åˆ†åŒºä¸­çš„åŒä¸€keyçš„æ•°æ®è¿›è¡Œåˆå¹¶ï¼Œæ•´ä¸ªshuffleè¿‡ç¨‹ä¼šè°ƒç”¨ä¸¤ä¸ªCombiner ! æœ€åŽåœ¨æœ¬åœ°ç”Ÿæˆåˆ†å¥½åŒºä¸”æŽ’å¥½åºçš„å°æ–‡ä»¶ã€‚ æ³¨æ„ï¼šå¦‚æžœ map å‘çŽ¯å½¢ç¼“å†²åŒºå†™å…¥æ•°æ®çš„é€Ÿåº¦å¤§äºŽå‘æœ¬åœ°å†™å…¥æ•°æ®çš„é€Ÿåº¦ï¼ŒçŽ¯å½¢ç¼“å†²åŒºä¼šè¢«å†™æ»¡ï¼Œå‘çŽ¯å½¢ç¼“å†²åŒºå†™å…¥æ•°æ®çš„çº¿ç¨‹ä¼šé˜»å¡žç›´è‡³ç¼“å†²åŒºä¸­çš„å†…å®¹å…¨éƒ¨æº¢å†™åˆ°ç£ç›˜åŽå†æ¬¡å¯åŠ¨ï¼Œåˆ°é˜€å€¼åŽä¼šå‘æœ¬åœ°ç£ç›˜æ–°å»ºä¸€ä¸ªæº¢å†™æ–‡ä»¶ï¼› \3. map ä»»åŠ¡å®Œæˆä¹‹å‰ï¼Œä¼šæŠŠæœ¬åœ°ç£ç›˜æº¢å†™çš„æ‰€æœ‰æ–‡ä»¶ ä¸åœåœ° åˆå¹¶ï¼ˆmergeï¼‰æˆå¾—åˆ°ä¸€ä¸ªç»“æžœæ–‡ä»¶ï¼Œåˆå¹¶å¾—åˆ°çš„ç»“æžœæ–‡ä»¶ä¼šæ ¹æ®å°æº¢å†™æ–‡ä»¶çš„åˆ†åŒºè€Œåˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºçš„æ•°æ®ä¼šå†æ¬¡æ ¹æ® key è¿›è¡Œ æŽ’åºï¼Œå¾—åˆ°çš„ç»“æžœæ–‡ä»¶æ˜¯åˆ†å¥½åŒºä¸”æŽ’å¥½åºçš„ï¼ˆå¯ä»¥åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶çš„æº¢å†™æ–‡ä»¶æ•°é‡é»˜è®¤ä¸º10ï¼‰ï¼›é»˜è®¤åˆå¹¶æº¢å†™æ–‡ä»¶æ•°é‡ mapred-site.xmlï¼šmapreduce.task.io.sort.factor \4. reduce ä»»åŠ¡å¯åŠ¨ï¼ŒReducer ä¸­çš„ä¸€ä¸ªçº¿ç¨‹å®šæœŸå‘ MRAppMaster è¯¢é—® Mapper è¾“å‡ºç»“æžœæ–‡ä»¶ä½ç½®ï¼ŒMapper ç»“æŸåŽä¼šå‘ MRAppMaster æ±‡æŠ¥ä¿¡æ¯ï¼Œä»Žè€Œ Reducer ä¼šå¾—çŸ¥ Mapper çŠ¶æ€å¹¶å¾—åˆ° map ç»“æžœæ–‡ä»¶ç›®å½•ï¼›reduceä»»åŠ¡æ•°é…ç½®a) mapred-site.xmlï¼šmapreduce.job.reducesb) job.setNumReduceTasks(num) \6. å½“æœ‰ä¸€ä¸ª Mapper ç»“æŸæ—¶ï¼Œreduce ä»»åŠ¡è¿›å…¥å¤åˆ¶é˜¶æ®µï¼Œreduce ä»»åŠ¡é€šè¿‡ http åè®®ï¼ˆhadoop å†…ç½®äº†nettyå®¹å™¨ï¼‰æŠŠæ‰€æœ‰ Mapper ç»“æžœæ–‡ä»¶çš„ å¯¹åº”çš„åˆ†åŒºæ•°æ® æ‹‰å–ï¼ˆfetchï¼‰è¿‡æ¥ï¼ŒReducer å¯ä»¥å¹¶è¡Œå¤ åˆ¶ Mapper çš„ ç»“æžœ ï¼Œ é»˜è®¤çº¿ç¨‹æ•°ä¸º5ï¼› æ‰€æœ‰ Reducer å¤åˆ¶å®Œæˆ map ç»“æžœæ–‡ä»¶åŽï¼Œç”±äºŽ Reducer å¯èƒ½ä¼šå¤±è´¥ï¼ŒNodeManager å¹¶ä¸ä¼šåœ¨ç¬¬ä¸€ä¸ª map ç»“æžœæ–‡ä»¶å¤åˆ¶å®ŒæˆåŽå°±åˆ é™¤å®ƒï¼Œè€Œæ˜¯ç›´åˆ°ä½œä¸šå®ŒæˆåŽ MRAppMaster é€šçŸ¥ NodeManager è¿›è¡Œåˆ é™¤ï¼› å¦å¤–å¦‚æžœ map ç»“æžœæ–‡ä»¶ç›¸å½“å°ï¼Œåˆ™ä¼šè¢«ç›´æŽ¥å¤åˆ¶åˆ° reduce NodeManager çš„å†…å­˜ï¼›ä¸€æ—¦ç¼“å†²åŒºè¾¾åˆ° reduce çš„é˜ˆå€¼å¤§å° 0.66 æˆ– å†™å…¥åˆ° reduce NodeManager å†… å­˜ ä¸­ æ–‡ ä»¶ ä¸ª æ•° è¾¾ åˆ° map è¾“å‡ºé˜ˆå€¼ 1000ï¼Œreduce å°±ä¼šæŠŠ map ç»“æžœæ–‡ä»¶åˆå¹¶ï¼ˆmergeï¼‰æº¢å†™åˆ°æœ¬åœ°ï¼›é»˜è®¤çº¿ç¨‹æ•° mapred-site.xmlï¼šmapreduce.reduce.shuffle.parallelcopiesç¼“å†²åŒºå¤§å° mapred-site.xml:mapreduce.reduce.shuffle.input.buffer.percentï¼Œé»˜è®¤0.7é˜ˆå€¼ï¼šmapred-site.xml:mapreduce.reduce.shuffle.merge.percentï¼Œé»˜è®¤0.66mapè¾“å‡ºé˜ˆå€¼1000ï¼šmapred-site.xml:mapreduce.reduce.merge.inmem.threshold \7. å¤åˆ¶é˜¶æ®µå®ŒæˆåŽï¼ŒReducer è¿›å…¥ Merge é˜¶æ®µï¼Œå¾ªçŽ¯åœ°åˆå¹¶ map ç»“æžœæ–‡ä»¶ï¼Œç»´æŒå…¶é¡ºåºæŽ’åºï¼Œåˆå¹¶å› å­é»˜è®¤ä¸º 10ï¼Œç»è¿‡ä¸æ–­åœ° Merge åŽå¾—åˆ°ä¸€ä¸ªâ€æœ€ç»ˆæ–‡ä»¶â€ï¼Œå¯èƒ½å­˜å‚¨åœ¨ç£ç›˜ä¹Ÿå¯èƒ½å­˜åœ¨å†…å­˜ä¸­ï¼› \8. â€œæœ€ç»ˆæ–‡ä»¶â€è¾“å…¥åˆ° reduce è¿›è¡Œè®¡ç®—ï¼Œè®¡ç®—ç»“æžœè¾“å…¥åˆ° HDFSã€‚ [ æ³¨æ„ ] æº¢å†™å‰ä¼šå…ˆæŒ‰ç…§åˆ†åŒºè¿›è¡ŒæŽ’åºï¼Œå†æŒ‰keyè¿›è¡ŒæŽ’åºï¼Œé‡‡ç”¨ å¿«é€ŸæŽ’åºæŽ’åºæ˜¯æŒ‰ç…§åŽŸå§‹æ•°æ®æŽ’åºï¼Œä½†æ˜¯ç”±äºŽåŽŸå§‹æ•°æ®ä¸å¥½ç§»åŠ¨ä¸”åŽŸå§‹æ•°æ®åŒ…å«äº†åŽŸå§‹æ•°æ®çš„ä½ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥ç§»åŠ¨çš„å…¶å®žæ˜¯å…ƒæ•°æ®ï¼›å†™å…¥æ—¶è¯»çš„æ˜¯å…ƒæ•°æ®ï¼ŒçœŸæ­£å†™å…¥çš„æ—¶åŽŸå§‹æ•°æ® æœ€åŽçš„æ•°æ®å¦‚æžœä¸å¤Ÿ80Mï¼Œä¹Ÿä¼šè¢«å¼ºåˆ¶flushåˆ°ç£ç›˜ æ¯ä¸ªmapTaskä»»åŠ¡ç”Ÿæˆçš„ç£ç›˜å°æ•°æ®æœ€åŽéƒ½ä¼šmergeæˆä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œé‡‡ç”¨ å½’å¹¶æŽ’åº Shuffle ä¸­çš„ç¼“å†²åŒºå¤§å°ä¼šå½±å“åˆ° mapreduce ç¨‹åºçš„æ‰§è¡Œæ•ˆçŽ‡ï¼ŒåŽŸåˆ™ä¸Šè¯´ï¼Œç¼“å†²åŒºè¶Šå¤§ï¼Œç£ ç›˜ioçš„æ¬¡æ•°è¶Šå°‘ï¼Œæ‰§è¡Œé€Ÿåº¦å°±è¶Šå¿«ã€‚ 10ã€è‡ªå®šä¹‰è¾“å…¥ InputFormat é»˜è®¤çš„æ–‡ä»¶åŠ è½½ï¼šTextInputFormat é»˜è®¤çš„æ–‡ä»¶è¯»å–ï¼šLineRecordReader æºç è¿½è¸ªè¿‡ç¨‹ï¼šcontext â€“&gt; mappercontext â€“&gt; mapcontext â€“&gt; reader â€“&gt; input â€“&gt; real â€“&gt; inputFormat.createRecordReaderï¼ˆsplitï¼ŒtaskContextï¼‰ï¼Œç„¶åŽæŸ¥æ‰¾ inputFormat â€“&gt; createRecordReaderï¼ˆsplitï¼ŒtaskContextï¼‰ï¼ŒinputFormat â€“&gt; TextInputFormatå®žä¾‹å¯¹è±¡ æ¡ˆä¾‹ï¼šå¤šä¸ªå°æ–‡ä»¶åˆå¹¶ word1.txt ~word10.txt æ¯æ¬¡è¯»å–ä¸€ä¸ªå°æ–‡ä»¶ è‡ªå®šä¹‰è¾“å…¥ï¼Œéœ€è¦åˆ›å»ºä¸¤ä¸ªç±»ï¼Œå¹¶é€šè¿‡Jobå¯¹è±¡æŒ‡å®šè‡ªå®šä¹‰è¾“å…¥ \1. åˆ›å»ºXxxInputFormatç±»ï¼Œç»§æ‰¿FileInputFormat&lt;&gt;ï¼Œé‡å†™ createRecordReader() æ–¹æ³• \2. åˆ›å»ºXxxRecordReaderç±»ï¼Œç»§æ‰¿RecordReader&lt;&gt;ï¼Œé‡å†™ä»¥ä¸‹æ–¹æ³•ï¼š initialize()ï¼šåˆå§‹åŒ–æ–¹æ³•ï¼Œç±»ä¼¼äºŽsetup()ï¼Œå¯¹å±žæ€§ã€é“¾æŽ¥æˆ–æµè¿›è¡Œåˆå§‹åŒ– getCurrentKey()ï¼šè¿”å›žkey getCurrentValue()ï¼šè¿”å›žvalue getProgress()ï¼šè¿”å›žæ–‡ä»¶æ‰§è¡Œè¿›åº¦ nextKeyValue()ï¼šè¿”å›žæ–‡ä»¶æ˜¯å¦è¯»å–ç»“æŸ close()ï¼šè¿›è¡Œä¸€äº›èµ„æºçš„é‡Šæ”¾ \3. åœ¨mapreduceç±»çš„main()æ–¹æ³•ä¸­æŒ‡å®šè‡ªå®šä¹‰è¾“å…¥ï¼šjob.setInputFormatClass(XxxInputFormat.class); ä»£ç  123456789101112131415161718192021222324252627282930313233package com.rox.mapreduce.mr4._02_inputformat;import java.io.IOException;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.InputSplit;import org.apache.hadoop.mapreduce.JobContext;import org.apache.hadoop.mapreduce.RecordReader;import org.apache.hadoop.mapreduce.TaskAttemptContext;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;public class WholeFileInputFormat extends FileInputFormat&lt;NullWritable, Text&gt; &#123; /** * è®¾ç½®æ¯ä¸ªå°æ–‡ä»¶ä¸å¯åˆ†ç‰‡,ä¿è¯ä¸€ä¸ªå°æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªkey-vé”®å€¼å¯¹ */ @Override protected boolean isSplitable(JobContext context, Path filename) &#123; return false; &#125; @Override public RecordReader&lt;NullWritable, Text&gt; createRecordReader(InputSplit split, TaskAttemptContext context) throws IOException, InterruptedException &#123; WholeFileRecordReader reader = new WholeFileRecordReader(); reader.initialize(split, context); return reader; &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576package com.rox.mapreduce.mr4._02_inputformat;import java.io.IOException;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FSDataInputStream;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.IOUtils;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.InputSplit;import org.apache.hadoop.mapreduce.RecordReader;import org.apache.hadoop.mapreduce.TaskAttemptContext;import org.apache.hadoop.mapreduce.lib.input.FileSplit;public class WholeFileRecordReader extends RecordReader&lt;NullWritable, Text&gt;&#123; private FileSplit fileSplit; private Configuration conf; private Text value = new Text(); private boolean processed = false; // æ ‡è¯†æ–‡ä»¶æ˜¯å¦è¯»å–å®Œæˆ /** * åˆå§‹åŒ–æ–¹æ³• */ @Override public void initialize(InputSplit split, TaskAttemptContext context) throws IOException, InterruptedException &#123; this.fileSplit=(FileSplit)split; this.conf = context.getConfiguration(); &#125; @Override public boolean nextKeyValue() throws IOException, InterruptedException &#123; if (!processed) &#123; byte[] contents = new byte[(int)fileSplit.getLength()]; Path file = fileSplit.getPath(); FileSystem fs = file.getFileSystem(conf); FSDataInputStream in = null; try &#123; in = fs.open(file); // æŠŠè¾“å…¥æµä¸Šçš„æ•°æ®å…¨éƒ¨è¯»å–åˆ°contentså­—èŠ‚æ•°ç»„ä¸­ IOUtils.readFully(in, contents, 0, contents.length); // æŠŠè¯»å–åˆ°çš„æ•°æ®è®¾ç½®åˆ°valueé‡Œ value.set(contents,0,contents.length); &#125; finally &#123; IOUtils.closeStream(in); &#125; processed = true; return true; &#125; return false; &#125; @Override public NullWritable getCurrentKey() throws IOException, InterruptedException &#123; return NullWritable.get(); &#125; @Override public Text getCurrentValue() throws IOException, InterruptedException &#123; return value; &#125; @Override public float getProgress() throws IOException, InterruptedException &#123; return processed ? 1.0f : 0.0f; &#125; @Override public void close() throws IOException &#123; &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114package com.rox.mapreduce.mr4._02_inputformat;import java.io.IOException;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.conf.Configured;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.InputSplit;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.Reducer;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.input.FileSplit;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;import org.apache.hadoop.util.Tool;import org.apache.hadoop.util.ToolRunner;public class SmallFilesConvertToBigMR extends Configured implements Tool &#123; public static void main(String[] args) throws Exception &#123; int exitCode = ToolRunner.run(new SmallFilesConvertToBigMR(), args); System.exit(exitCode); &#125; @Override public int run(String[] args) throws Exception &#123; Configuration conf = new Configuration(); conf.set("fs.defaultFS", "hdfs://cs1:9000"); System.setProperty("HADOOP_USER_NAME", "ap"); Job job = Job.getInstance(conf, "combine small files to bigfile"); job.setJarByClass(SmallFilesConvertToBigMR.class); job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(Text.class); job.setMapperClass(SmallFilesConvertToBigMRMapper.class); job.setReducerClass(SmallFilesConvertToBigMRReducer.class); job.setOutputKeyClass(NullWritable.class); job.setOutputValueClass(Text.class);////////ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ job.setInputFormatClass(WholeFileInputFormat.class); // job.setOutputFormatClass(SequenceFileOutputFormat.class); Path input = new Path("/in/joindemo"); Path output = new Path("/out/bigfile"); FileInputFormat.setInputPaths(job, input); FileSystem fs = FileSystem.get(conf); if (fs.exists(output)) &#123; fs.delete(output, true); &#125; FileOutputFormat.setOutputPath(job, output); int status = job.waitForCompletion(true) ? 0 : 1; return status; &#125; static class SmallFilesConvertToBigMRMapper extends Mapper&lt;NullWritable, Text, Text, Text&gt; &#123; private Text filenameKey; @Override protected void setup( Mapper&lt;NullWritable, Text, Text, Text&gt;.Context context) throws IOException, InterruptedException &#123; InputSplit split = context.getInputSplit(); Path path = ((FileSplit) split).getPath(); filenameKey = new Text(path.toString()); &#125; @Override protected void map(NullWritable key, Text value, Mapper&lt;NullWritable, Text, Text, Text&gt;.Context context) throws IOException, InterruptedException &#123; context.write(filenameKey, value); &#125; &#125; static class SmallFilesConvertToBigMRReducer extends Reducer&lt;Text, Text, NullWritable, Text&gt; &#123; @Override protected void reduce(Text filename, Iterable&lt;Text&gt; bytes, Context context) throws IOException, InterruptedException &#123; context.write(NullWritable.get(), bytes.iterator().next()); &#125; &#125;&#125; 11ã€è‡ªå®šä¹‰è¾“å‡º OutputFormat é»˜è®¤çš„æ–‡ä»¶åŠ è½½ï¼šTextOutputFormat é»˜è®¤çš„æ–‡ä»¶è¯»å–ï¼šLineRecordWriter æºç è¿½è¸ªè¿‡ç¨‹ ç•¥ æ¡ˆä¾‹ï¼šå°†è€ƒè¯•æˆç»©åˆæ ¼çš„è¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸åŠæ ¼çš„è¾“å‡ºåˆ°å¦ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ˆæ³¨æ„ï¼Œä¸åŒäºŽåˆ†åŒºï¼Œåˆ†åŒºåªæ˜¯é‡ç»“æžœè¾“å‡ºåˆ°åŒä¸€æ–‡ä»¶å¤¹ä¸‹ä¸åŒæ–‡ä»¶ï¼‰ è‡ªå®šä¹‰è¾“å‡ºï¼Œéœ€è¦åˆ›å»ºä¸¤ä¸ªç±»ï¼Œå¹¶é€šè¿‡Jobå¯¹è±¡æŒ‡å®šè‡ªå®šä¹‰è¾“å…¥ \1. åˆ›å»ºXxxOutputFormatç±»ï¼Œç»§æ‰¿FileOutputFormat&lt;&gt;ï¼Œé‡å†™getRecordWriter()æ–¹æ³• \2. åˆ›å»ºXxxRecordWriterç±»ï¼Œç»§æ‰¿RecordWriter&lt;&gt;ï¼Œé‡å†™ä»¥ä¸‹æ–¹æ³•ï¼š write()ï¼šçœŸæ­£å‘å¤–å†™å‡ºçš„æ–¹æ³•ï¼Œéœ€è¦å°†ç»“æžœè¾“å‡ºåˆ°å‡ ä¸ªä¸åŒæ–‡ä»¶å¤¹ï¼Œå°±éœ€è¦åˆ›å»ºå‡ ä¸ªè¾“å‡ºæµ è€Œè¾“å‡ºæµé€šè¿‡FileSystemå¯¹è±¡èŽ·å–ï¼ŒFileSystemå¯¹è±¡èŽ·å–éœ€è¦é…ç½®æ–‡ä»¶ ä¸€èˆ¬å¯ä»¥é€šè¿‡æž„é€ æ–¹æ³•ç›´æŽ¥ä¼ å…¥FileSystemå¯¹è±¡ close()ï¼šé‡Šæ”¾èµ„æº \3. åœ¨mapreduceç±»çš„main()æ–¹æ³•ä¸­æŒ‡å®šè‡ªå®šä¹‰è¾“å…¥ï¼šjob.setOutputFormatClass(XxxOutputFormat.class); ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475package com.rox.mapreduce.outputformat;import java.io.IOException;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class MultipleOutputMR &#123; public static void main(String[] args) throws Exception &#123; // æŒ‡å®šHDFSç›¸å…³å‚æ•° Configuration conf = new Configuration(); conf.set("fs.defaultFS", "hdfs://cs1:9000"); System.setProperty("HADOOP_USER_NAME", "ap"); // ï£¿ åˆ›å»º/é…ç½® Job Job job = Job.getInstance(conf); // è®¾ç½®JaråŒ…ç±»åž‹:è¿™é‡Œåƒä¸‡åˆ«å†™é”™äº† job.setJarByClass(MultipleOutputMR.class); // è®¾ç½®Map Reduceæ‰§è¡Œç±» job.setMapperClass(MultipleOutputMRMapper.class); // è®¾ç½®Mapè¾“å‡ºç±» job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(NullWritable.class); ////////////// è®¾ç½®reduceæ‰§è¡Œä¸ªæ•°ä¸º0 job.setNumReduceTasks(0); ///////////// è®¾ç½®MapOutputFormatClass job.setOutputFormatClass(MyOutputFormat.class); // è®¾ç½®è¾“å…¥ è¾“å‡ºè·¯å¾„ String inP = "/in/newScoreIn"; String outP = "/out/myoutformat/mulWriteSuc"; FileInputFormat.setInputPaths(job, new Path(inP)); FileOutputFormat.setOutputPath(job, new Path(outP)); // è®¾ç½®å¦‚æžœå­˜åœ¨è·¯å¾„å°±åˆ é™¤ Path mypath = new Path(outP); FileSystem hdfs = mypath.getFileSystem(conf); if (hdfs.exists(mypath)) &#123; hdfs.delete(mypath, true); &#125; // ï£¿ æ‰§è¡Œjob System.exit(job.waitForCompletion(true)?0:-1); &#125; static class MultipleOutputMRMapper extends Mapper&lt;LongWritable, Text, Text, NullWritable&gt; &#123; @Override protected void map(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, NullWritable&gt;.Context context) throws IOException, InterruptedException &#123; // å‚è€ƒæ¬¡æ•°&gt;7æ¬¡ ç®—åˆæ ¼ String[] splits = value.toString().split(","); if (splits.length &gt; 9) &#123; context.write(new Text("1::"+value.toString()), NullWritable.get()); &#125;else &#123; context.write(new Text("2::"+value.toString()), NullWritable.get()); &#125; &#125; &#125;&#125; 123456789101112131415161718192021222324252627282930313233package com.rox.mapreduce.outputformat;import java.io.IOException;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FSDataOutputStream;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.RecordWriter;import org.apache.hadoop.mapreduce.TaskAttemptContext;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class MyOutputFormat extends FileOutputFormat&lt;Text, NullWritable&gt; &#123; @Override public RecordWriter&lt;Text, NullWritable&gt; getRecordWriter( TaskAttemptContext job) throws IOException, InterruptedException &#123; Configuration configuration = job.getConfiguration(); FileSystem fs = FileSystem.get(configuration); Path p1 = new Path("/out/myoutformat/out1"); Path p2 = new Path("/out/myoutformat/out2"); FSDataOutputStream out1 = fs.create(p1); FSDataOutputStream out2 = fs.create(p2); return new MyRecordWriter(out1,out2); &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243package com.rox.mapreduce.outputformat;import java.io.IOException;import org.apache.hadoop.fs.FSDataOutputStream;import org.apache.hadoop.io.IOUtils;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.RecordWriter;import org.apache.hadoop.mapreduce.TaskAttemptContext;public class MyRecordWriter extends RecordWriter&lt;Text, NullWritable&gt; &#123; FSDataOutputStream fsout = null; FSDataOutputStream fsout1 = null; public MyRecordWriter(FSDataOutputStream fsout, FSDataOutputStream fsout1) &#123; super(); this.fsout = fsout; this.fsout1 = fsout1; &#125; @Override public void write(Text key, NullWritable value) throws IOException, InterruptedException &#123; String[] strs = key.toString().split("::"); if (strs[0].equals("1")) &#123; fsout.write((strs[1]+"\n").getBytes()); &#125;else &#123; fsout1.write((strs[1]+"\n").getBytes()); &#125; &#125; @Override public void close(TaskAttemptContext context) throws IOException, InterruptedException &#123; IOUtils.closeStream(fsout); IOUtils.closeStream(fsout1); &#125;&#125; 12. å€’æŽ’ç´¢å¼•å»ºç«‹æ¦‚å¿µï¼š å€’æŽ’ç´¢å¼•ï¼ˆInverted Indexï¼‰ï¼Œä¹Ÿå¸¸è¢«ç§°ä¸ºåå‘ç´¢å¼•ã€ç½®å…¥æ¡£æ¡ˆæˆ–åå‘æ¡£æ¡ˆï¼Œæ˜¯ä¸€ç§ç´¢å¼•æ–¹æ³•ï¼Œè¢«ç”¨æ¥å­˜å‚¨åœ¨å…¨æ–‡æœç´¢ä¸‹æŸä¸ªå•è¯åœ¨ä¸€ä¸ªæ–‡æ¡£æˆ–è€…ä¸€ç»„æ–‡æ¡£ä¸­çš„å­˜å‚¨ä½ç½®çš„æ˜ å°„ã€‚å®ƒæ˜¯æ–‡æ¡£æ£€ç´¢ç³»ç»Ÿä¸­æœ€å¸¸ç”¨çš„æ•°æ®ç»“æž„ã€‚äº†è§£è¯¦æƒ…å¯è‡ªè¡Œç™¾åº¦ éœ€æ±‚ï¼šæœ‰å¤§é‡çš„æ–‡æœ¬ï¼ˆæ–‡æ¡£ã€ç½‘é¡µï¼‰ï¼Œéœ€è¦å»ºç«‹æœç´¢ç´¢å¼• , è¦æ±‚ç»Ÿè®¡æ¯ä¸€ä¸ªå•è¯åœ¨æ¯ä¸ªæ–‡ä»¶ä¸­å‡ºçŽ°çš„æ¬¡æ•°, å¦‚ä¸‹ æ€è·¯ å…ˆæ ¹æ®å•è¯&amp;æ–‡ä»¶åä¸º key, è¾“å‡ºä¸€ä¸ªæ–‡ä»¶ æ‹†åˆ†æ–‡ä»¶è¡Œ, ä»¥å•è¯ä¸º key, value å†æ‹¼æŽ¥ ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140// ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ InverIndexStepOne ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿package cn.itcast.bigdata.mr.inverindex;import java.io.IOException;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.IntWritable;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.Reducer;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.input.FileSplit;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class InverIndexStepOne &#123; static class InverIndexStepOneMapper extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt; &#123; Text k = new Text(); IntWritable v = new IntWritable(1); @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; String line = value.toString(); String[] words = line.split(" "); FileSplit inputSplit = (FileSplit) context.getInputSplit(); String fileName = inputSplit.getPath().getName(); for (String word : words) &#123; k.set(word + "--" + fileName); context.write(k, v); &#125; &#125; &#125; static class InverIndexStepOneReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; &#123; @Override protected void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException &#123; int count = 0; for (IntWritable value : values) &#123; count += value.get(); &#125; context.write(key, new IntWritable(count)); &#125; &#125; public static void main(String[] args) throws Exception &#123; Configuration conf = new Configuration(); Job job = Job.getInstance(conf); job.setJarByClass(InverIndexStepOne.class); job.setOutputKeyClass(Text.class); job.setOutputValueClass(IntWritable.class); FileInputFormat.setInputPaths(job, new Path("D:/srcdata/inverindexinput")); FileOutputFormat.setOutputPath(job, new Path("D:/temp/out")); // FileInputFormat.setInputPaths(job, new Path(args[0])); // FileOutputFormat.setOutputPath(job, new Path(args[1])); job.setMapperClass(InverIndexStepOneMapper.class); job.setReducerClass(InverIndexStepOneReducer.class); job.waitForCompletion(true); &#125;&#125;// ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ IndexStepTwo ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿ï£¿package cn.itcast.bigdata.mr.inverindex;import java.io.IOException;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.Reducer;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;public class IndexStepTwo &#123; public static class IndexStepTwoMapper extends Mapper&lt;LongWritable, Text, Text, Text&gt;&#123; @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; String line = value.toString(); String[] files = line.split("--"); context.write(new Text(files[0]), new Text(files[1])); &#125; &#125; public static class IndexStepTwoReducer extends Reducer&lt;Text, Text, Text, Text&gt;&#123; @Override protected void reduce(Text key, Iterable&lt;Text&gt; values, Context context) throws IOException, InterruptedException &#123; StringBuffer sb = new StringBuffer(); for (Text text : values) &#123; sb.append(text.toString().replace("\t", "--&gt;") + "\t"); &#125; context.write(key, new Text(sb.toString())); &#125; &#125; public static void main(String[] args) throws Exception &#123; if (args.length &lt; 1 || args == null) &#123; args = new String[]&#123;"D:/temp/out/part-r-00000", "D:/temp/out2"&#125;; &#125; Configuration config = new Configuration(); Job job = Job.getInstance(config); job.setMapperClass(IndexStepTwoMapper.class); job.setReducerClass(IndexStepTwoReducer.class);// job.setMapOutputKeyClass(Text.class);// job.setMapOutputValueClass(Text.class); job.setOutputKeyClass(Text.class); job.setOutputValueClass(Text.class); FileInputFormat.setInputPaths(job, new Path(args[0])); FileOutputFormat.setOutputPath(job, new Path(args[1])); System.exit(job.waitForCompletion(true) ? 1:0); &#125;&#125; 13ã€Yarn1ã€Yarnå›¾ç¤ºç®€ä»‹ åœ¨Hadoop1.xæ—¶ï¼Œ åªæœ‰ä¸¤ä¸ªä¸»è¦ç»„ä»¶ï¼šhdfsï¼ˆæ–‡ä»¶å­˜å‚¨ï¼‰ï¼Œ MapReduceï¼ˆè®¡ç®—ï¼‰ æ‰€æœ‰çš„è®¡ç®—ç›¸å…³çš„å…¨éƒ¨æ”¾åœ¨MapReduceä¸Š JobTracker: æ•´ä¸ªè®¡ç®—ç¨‹åºçš„è€å¤§ èµ„æºè°ƒåº¦ï¼šéšæœºè°ƒåº¦ ç›‘æŽ§ç¨‹åºè¿è¡Œçš„çŠ¶æ€ï¼Œå¯åŠ¨è¿è¡Œç¨‹åº å­˜åœ¨å•ç‚¹æ•…éšœé—®é¢˜ TaskTrackerï¼šè´Ÿè´£è®¡ç®—ç¨‹åºçš„æ‰§è¡Œ å¼ºè¡Œçš„å°†è®¡ç®—èµ„æºåˆ†æˆ2éƒ¨åˆ† MapSlot ReduceSlot æ¯ä¸€éƒ¨åˆ†èµ„æºåªèƒ½è·‘å¯¹åº”çš„ä»»åŠ¡ ç¼ºé™·ï¼š å•ç‚¹æ•…éšœ èµ„æºè°ƒåº¦éšæœºï¼Œä¼šé€ æˆèµ„æºæµªè´¹ JobTrackerçš„è¿è¡ŒåŽ‹åŠ›è¿‡å¤§ Hadoop2.xï¼š åˆ†ç†å‡ºYarnï¼Œä¸“é—¨è´Ÿè´£é›†ç¾¤çš„èµ„æºç®¡ç†å’Œè°ƒåº¦ Yarnçš„è¿›ç¨‹ï¼šResourceManager: æ•´ä¸ªèµ„æºè°ƒåº¦çš„è€å¤§ æŽ¥å—hadoopå®¢æˆ·ç«¯çš„è¯·æ±‚ æŽ¥å—NodeManager çš„çŠ¶æ€æŠ¥å‘Šï¼Œ NMçš„èµ„æºçŠ¶æ€å’Œå­˜æ´»çŠ¶æ€ èµ„æºè°ƒåº¦ï¼Œæ•´ä¸ªè®¡ç®—ç¨‹åºçš„èµ„æºè°ƒåº¦ï¼Œè°ƒåº¦çš„è¿è¡Œèµ„æºå’ŒèŠ‚ç‚¹ å†…éƒ¨ç»„ä»¶ï¼š ASMâ€”â€”ApplicationsManager æ‰€æœ‰åº”ç”¨ç¨‹åºçš„ç®¡ç†è€…ï¼Œè´Ÿè´£è°ƒåº¦åº”ç”¨ç¨‹åº Schedulerâ€”â€”è°ƒåº¦å™¨æ¦‚å¿µ è°ƒåº¦çš„æ˜¯ä»€ä¹ˆæ—¶å€™æ‰§è¡Œå“ªä¸ªè®¡ç®—ç¨‹åº è°ƒåº¦å™¨ï¼š FIFO: first in first out å…ˆæäº¤çš„å…ˆæ‰§è¡Œï¼ŒåŽæäº¤çš„åŽæ‰§è¡Œ å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ— FAIR: å…¬å¹³è°ƒåº¦å™¨ å¤§å®¶å¹³åˆ†èµ„æºè¿è¡Œ å‡è®¾åˆšå¼€å§‹åªæœ‰ä¸€ä¸ªä»»åŠ¡ï¼Œå èµ„æº100%ï¼Œæ­¤æ—¶åˆæ¥äº†ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™æ˜¯è¿›è¡Œèµ„æºå¹³åˆ†ï¼Œæ¯äºº50% å†…éƒ¨ä¹Ÿæ˜¯ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ— CAPACITY: å¯ä»¥æŒ‰éœ€è¿›è¡Œé…ç½®ï¼Œä½¿ç”¨èµ„æº å†…éƒ¨å¯ç»´æŠ¤å¤šä¸ªé˜Ÿåˆ—ï¼Œå¤šä¸ªé˜Ÿåˆ—ä¹‹é—´å¯ä»¥è¿›è¡Œèµ„æºåˆ†é… ä¾‹å¦‚ï¼šåˆ†é…ä¸¤ä¸ªé˜Ÿåˆ— é˜Ÿåˆ—1ï¼š60% é˜Ÿåˆ—2ï¼š40% æ¯ä¸ªé˜Ÿåˆ—ä¸­éƒ½æ˜¯æ‰§è¡ŒFIFOçš„ NodeManagerï¼š è´Ÿè´£çœŸæ­£çš„æä¾›èµ„æºï¼Œè¿è¡Œè®¡ç®—ç¨‹åº æŽ¥å—ResourceManagerçš„å‘½ä»¤ æä¾›èµ„æºè¿è¡Œè®¡ç®—ç¨‹åº MRAppMaster: å•ä¸ªè®¡ç®—ç¨‹åºçš„è€å¤§, ç±»ä¼¼äºŽé¡¹ç›®ç»ç† è´Ÿè´£å¸®åŠ©å½“å‰è®¡ç®—ç¨‹åºå‘ResourceManagerç”³è¯·èµ„æº è´Ÿè´£å¯åŠ¨ MapTask å’Œ ReduceTask ä»»åŠ¡ Container: æŠ½è±¡èµ„æºå®¹å™¨ï¼Œå°è£…è¿™ä¸€å®šçš„cpuï¼Œio å’Œç½‘ç»œèµ„æºï¼ˆé€»è¾‘æ¦‚å¿µï¼‰ æ˜¯è¿è¡ŒMapTaskï¼ŒReduceTaskç­‰çš„è¿è¡Œèµ„æºå•ä½ 1ä¸ªsplit â€”â€” 1ä¸ªMapTask (ReduceTask) â€”â€” 1ä¸ªContainer â€”â€” æ˜¾ç¤ºä¸ºYarnChildï¼Œåº•å±‚è¿è¡Œçš„èµ„æºå•ä½å°±æ˜¯Container 2ã€Yarnè¿è¡Œè¿‡ç¨‹ MRAppMasterä¼šåœ¨æ‰€æœ‰çš„MapTaskæ‰§è¡Œåˆ°0.8çš„æ—¶å€™ï¼Œå¼€å¯ReduceTaskä»»åŠ¡ YARN ä½œä¸šæ‰§è¡Œæµç¨‹: ç”¨æˆ·å‘ YARN ä¸­æäº¤åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…æ‹¬ MRAppMaster ç¨‹åºï¼Œå¯åŠ¨ MRAppMaster çš„å‘½ä»¤ï¼Œ ç”¨æˆ·ç¨‹åºç­‰ã€‚ ResourceManager ä¸ºè¯¥ç¨‹åºåˆ†é…ç¬¬ä¸€ä¸ª Containerï¼Œå¹¶ä¸Žå¯¹åº”çš„ NodeManager é€šè®¯ï¼Œè¦æ±‚ å®ƒåœ¨è¿™ä¸ª Container ä¸­å¯åŠ¨åº”ç”¨ç¨‹åº MRAppMasterã€‚ MRAppMaster é¦–å…ˆå‘ ResourceManager æ³¨å†Œï¼Œè¿™æ ·ç”¨æˆ·å¯ä»¥ç›´æŽ¥é€šè¿‡ ResourceManager æŸ¥çœ‹åº”ç”¨ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ï¼Œç„¶åŽå°†ä¸ºå„ä¸ªä»»åŠ¡ç”³è¯·èµ„æºï¼Œå¹¶ç›‘æŽ§å®ƒçš„è¿è¡ŒçŠ¶æ€ï¼Œç›´åˆ°è¿è¡Œç»“ æŸï¼Œé‡å¤ 4 åˆ° 7 çš„æ­¥éª¤ã€‚ MRAppMaster é‡‡ç”¨è½®è¯¢çš„æ–¹å¼é€šè¿‡ RPC åè®®å‘ ResourceManager ç”³è¯·å’Œé¢†å–èµ„æºã€‚ ä¸€æ—¦ MRAppMaster ç”³è¯·åˆ°èµ„æºåŽï¼Œä¾¿ä¸Žå¯¹åº”çš„ NodeManager é€šè®¯ï¼Œè¦æ±‚å®ƒå¯åŠ¨ä»»åŠ¡ã€‚ NodeManager ä¸ºä»»åŠ¡è®¾ç½®å¥½è¿è¡ŒçŽ¯å¢ƒ(åŒ…æ‹¬çŽ¯å¢ƒå˜é‡ã€JAR åŒ…ã€äºŒè¿›åˆ¶ç¨‹åºç­‰)åŽï¼Œå°† ä»»åŠ¡å¯åŠ¨å‘½ä»¤å†™åˆ°ä¸€ä¸ªè„šæœ¬ä¸­ï¼Œå¹¶é€šè¿‡è¿è¡Œè¯¥è„šæœ¬å¯åŠ¨ä»»åŠ¡ã€‚ å„ä¸ªä»»åŠ¡é€šè¿‡æŸä¸ª RPC åè®®å‘ MRAppMaster æ±‡æŠ¥è‡ªå·±çš„çŠ¶æ€å’Œè¿›åº¦ï¼Œä»¥è®© MRAppMaster éšæ—¶æŽŒæ¡å„ä¸ªä»»åŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼Œä»Žè€Œå¯ä»¥åœ¨ä»»åŠ¡è´¥çš„æ—¶å€™é‡æ–°å¯åŠ¨ä»»åŠ¡ã€‚ 8ã€åº”ç”¨ç¨‹åºè¿è¡Œå®ŒæˆåŽï¼ŒMRAppMaster å‘ ResourceManager æ³¨é”€å¹¶å…³é—­è‡ªå·±ã€‚ 3ã€Jobçš„æäº¤è¿‡ç¨‹(å¾…æ•´ç†) å®¢æˆ·ç«¯å‘rmå‘é€ æäº¤jobè¯·æ±‚ rmå‘å®¢æˆ·ç«¯å‘é€ å…±äº«èµ„æºè·¯å¾„ å’Œ applicationId å®¢æˆ·ç«¯å°†ç¨‹åºè¿è¡Œéœ€è¦çš„å…±äº«èµ„æºæ”¾è¿›å…±äº«èµ„æºè·¯å¾„åŒ…æ‹¬ï¼šç¨‹åºjaråŒ…ï¼Œxmlé…ç½®æ–‡ä»¶ï¼Œsplitåˆ‡ç‰‡ä¿¡æ¯ å®¢æˆ·ç«¯å‘rmå‘é€èµ„æºæ”¾ç½®æˆåŠŸçš„æŠ¥å‘Šï¼Œå¹¶çœŸæ­£ æäº¤åº”ç”¨ç¨‹åº rmæŽ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¼šè¿”å›žä¸€ä¸ªç©ºé—²çš„èµ„æºèŠ‚ç‚¹(æ¯”å¦‚ï¼šnode01) åˆ°èµ„æºèŠ‚ç‚¹(node01)ä¸Šå¯åŠ¨container å¯åŠ¨MRAppMaster åˆ›å»ºä½œä¸šç°¿ è®°å½• maptask å’Œ reducetask çš„ è¿è¡ŒçŠ¶æ€å’Œè¿›åº¦ ç­‰ä¿¡æ¯ mrappmasteråŽ»å…±äº«èµ„æºè·¯å¾„ä¸‹ ,èŽ·å– åˆ‡ç‰‡ å’Œ é…ç½®æ–‡ä»¶ ç­‰ä¿¡æ¯ mrappmaster å‘ rm ç”³è¯·maptask å’Œ reducetaskçš„èµ„æº rm åœ¨å¤„ç† mrappmaster è¯·æ±‚æ—¶ï¼Œä¼š ä¼˜å…ˆå¤„ç†æœ‰å…³maptaskçš„è¯·æ±‚ rm å‘ mrappmaster è¿”å›žç©ºé—²èŠ‚ç‚¹ï¼ˆæ•°æ®æœ¬åœ°ä¼˜å…ˆåŽŸåˆ™ï¼‰ï¼Œè¿è¡Œmaptask æˆ– reducetaskä¼˜å…ˆè¿”å›žæœ‰æ•°æ®çš„èŠ‚ç‚¹ã€‚ å¯¹è±¡èŠ‚ç‚¹éœ€è¦åˆ°hdfs å…±äº«è·¯å¾„ä¸‹ä¸‹è½½ç¨‹åºjaråŒ…ç­‰ å…±äº«èµ„æº åˆ°æœ¬åœ° mrappmaster åˆ° å¯¹åº”çš„èŠ‚ç‚¹ä¸Šï¼Œå¯åŠ¨container å’Œ maptask maptaskéœ€è¦å‘ mrappmaster æ±‡æŠ¥è‡ªèº«çš„ è¿è¡ŒçŠ¶æ€å’Œè¿›åº¦ mrappmaster ç›‘æŽ§åˆ°æ‰€æœ‰çš„maptask è¿è¡Œè¿›åº¦åˆ° 80%ï¼Œå¯åŠ¨reducetaskï¼ˆå¯åŠ¨å‰ï¼Œä¹Ÿä¼šä¸‹è½½å…±äº«èµ„æºè·¯å¾„ä¸‹çš„å“åº”æ–‡ä»¶ï¼Œç¨‹åºjaråŒ…ï¼Œé…ç½®æ–‡ä»¶ç­‰ï¼‰ reducetask æ—¶åˆ»å’Œ mrappmaster é€šä¿¡ï¼Œæ±‡æŠ¥è‡ªèº«çš„ è¿è¡ŒçŠ¶æ€å’Œè¿›åº¦ æ•´ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œmaptaskè¿è¡Œå®Œæˆ ï¼Œ éƒ½ä¼šå‘mrappmaster ç”³è¯·æ³¨é”€ è‡ªå·± å½“æ‰€æœ‰çš„maptask å’Œ reducetask è¿è¡Œå®Œæˆ ï¼Œ mrappmaster å°±ä¼šå‘rm ç”³è¯·æ³¨é”€ï¼Œè¿›è¡Œèµ„æºå›žæ”¶ 4.MapReduce&amp;yarnçš„å·¥ä½œæœºåˆ¶â€“jobæäº¤æµç¨‹â€“å¸æ˜Ÿå¤§æ³• ç–‘ç‚¹: MRAppMaster çš„æ•°é‡é—®é¢˜ ç»è¿‡ç ”ç©¶, åº”è¯¥æ˜¯æ¯ä¸ª job ä¼šäº§ç”Ÿä¸€ä¸ª MRAppMaster 5.MapReduceå…¨åŽŸç†å‰–æžâ€”å…­è„‰ç¥žå‰‘å…¨å›¾ ç»†èŠ‚å›¾ 6. maptaskä»»åŠ¡åˆ†é…åˆ‡ç‰‡æœºåˆ¶ 7. å®Œæ•´æµç¨‹å›¾ 14. å…³äºŽ Driver é…ç½®çš„æ³¨æ„ç‚¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.IntWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.lib.input.CombineTextInputFormat;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;/** * ç›¸å½“äºŽä¸€ä¸ªyarné›†ç¾¤çš„å®¢æˆ·ç«¯ * éœ€è¦åœ¨æ­¤å°è£…æˆ‘ä»¬çš„mrç¨‹åºçš„ç›¸å…³è¿è¡Œå‚æ•°ï¼ŒæŒ‡å®šjaråŒ… * æœ€åŽæäº¤ç»™yarn * @author * */public class WordcountDriver &#123; public static void main(String[] args) throws Exception &#123; Configuration conf = new Configuration(); //æ˜¯å¦è¿è¡Œä¸ºæœ¬åœ°æ¨¡å¼ï¼Œå°±æ˜¯çœ‹è¿™ä¸ªå‚æ•°å€¼æ˜¯å¦ä¸ºlocalï¼Œé»˜è®¤å°±æ˜¯local /*conf.set("mapreduce.framework.name", "local");*/ //æœ¬åœ°æ¨¡å¼è¿è¡Œmrç¨‹åºæ—¶ï¼Œè¾“å…¥è¾“å‡ºçš„æ•°æ®å¯ä»¥åœ¨æœ¬åœ°ï¼Œä¹Ÿå¯ä»¥åœ¨hdfsä¸Š //åˆ°åº•åœ¨å“ªé‡Œï¼Œå°±çœ‹ä»¥ä¸‹ä¸¤è¡Œé…ç½®ä½ ç”¨å“ªè¡Œï¼Œé»˜è®¤å°±æ˜¯file:/// /*conf.set("fs.defaultFS", "hdfs://mini1:9000/");*/ /*conf.set("fs.defaultFS", "file:///");*/ //è¿è¡Œé›†ç¾¤æ¨¡å¼ï¼Œå°±æ˜¯æŠŠç¨‹åºæäº¤åˆ°yarnä¸­åŽ»è¿è¡Œ //è¦æƒ³è¿è¡Œä¸ºé›†ç¾¤æ¨¡å¼ï¼Œä»¥ä¸‹3ä¸ªå‚æ•°è¦æŒ‡å®šä¸ºé›†ç¾¤ä¸Šçš„å€¼ /*conf.set("mapreduce.framework.name", "yarn"); conf.set("yarn.resourcemanager.hostname", "mini1"); conf.set("fs.defaultFS", "hdfs://mini1:9000/");*/ Job job = Job.getInstance(conf); job.setJar("c:/wc.jar"); //æŒ‡å®šæœ¬ç¨‹åºçš„jaråŒ…æ‰€åœ¨çš„æœ¬åœ°è·¯å¾„ /*job.setJarByClass(WordcountDriver.class);*/ //æŒ‡å®šæœ¬ä¸šåŠ¡jobè¦ä½¿ç”¨çš„mapper/Reducerä¸šåŠ¡ç±» job.setMapperClass(WordcountMapper.class); job.setReducerClass(WordcountReducer.class); //æŒ‡å®šmapperè¾“å‡ºæ•°æ®çš„kvç±»åž‹ job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(IntWritable.class); //æŒ‡å®šæœ€ç»ˆè¾“å‡ºçš„æ•°æ®çš„kvç±»åž‹ job.setOutputKeyClass(Text.class); job.setOutputValueClass(IntWritable.class); //æŒ‡å®šéœ€è¦ä½¿ç”¨combinerï¼Œä»¥åŠç”¨å“ªä¸ªç±»ä½œä¸ºcombinerçš„é€»è¾‘ /*job.setCombinerClass(WordcountCombiner.class);*/ job.setCombinerClass(WordcountReducer.class); //å¦‚æžœä¸è®¾ç½®InputFormatï¼Œå®ƒé»˜è®¤ç”¨çš„æ˜¯TextInputformat.class job.setInputFormatClass(CombineTextInputFormat.class); CombineTextInputFormat.setMaxInputSplitSize(job, 4194304); CombineTextInputFormat.setMinInputSplitSize(job, 2097152); //æŒ‡å®šjobçš„è¾“å…¥åŽŸå§‹æ–‡ä»¶æ‰€åœ¨ç›®å½• FileInputFormat.setInputPaths(job, new Path(args[0])); //æŒ‡å®šjobçš„è¾“å‡ºç»“æžœæ‰€åœ¨ç›®å½• FileOutputFormat.setOutputPath(job, new Path(args[1])); // æŒ‡å®šéœ€è¦ç¼“å­˜ä¸€ä¸ªæ–‡ä»¶åˆ°æ‰€æœ‰çš„maptaskè¿è¡ŒèŠ‚ç‚¹å·¥ä½œç›®å½• /* job.addArchiveToClassPath(archive); */// ç¼“å­˜jaråŒ…åˆ°taskè¿è¡ŒèŠ‚ç‚¹çš„classpathä¸­ /* job.addFileToClassPath(file); */// ç¼“å­˜æ™®é€šæ–‡ä»¶åˆ°taskè¿è¡ŒèŠ‚ç‚¹çš„classpathä¸­ /* job.addCacheArchive(uri); */// ç¼“å­˜åŽ‹ç¼©åŒ…æ–‡ä»¶åˆ°taskè¿è¡ŒèŠ‚ç‚¹çš„å·¥ä½œç›®å½• /* job.addCacheFile(uri) */// ç¼“å­˜æ™®é€šæ–‡ä»¶åˆ°taskè¿è¡ŒèŠ‚ç‚¹çš„å·¥ä½œç›®å½• // å°†äº§å“è¡¨æ–‡ä»¶ç¼“å­˜åˆ°taskå·¥ä½œèŠ‚ç‚¹çš„å·¥ä½œç›®å½•ä¸­åŽ» job.addCacheFile(new URI("file:/D:/srcdata/mapjoincache/pdts.txt")); //mapç«¯joinçš„é€»è¾‘ä¸éœ€è¦reduceé˜¶æ®µï¼Œè®¾ç½®reducetaskæ•°é‡ä¸º0 job.setNumReduceTasks(0); //å°†jobä¸­é…ç½®çš„ç›¸å…³å‚æ•°ï¼Œä»¥åŠjobæ‰€ç”¨çš„javaç±»æ‰€åœ¨çš„jaråŒ…ï¼Œæäº¤ç»™yarnåŽ»è¿è¡Œ /*job.submit();*/ boolean res = job.waitForCompletion(true); System.exit(res?0:1); &#125;&#125; 15. GroupingComparator åˆ†ç»„æŽ’åºè§ç»ƒä¹  æˆ–è€…github æ³¨æ„ç‚¹: åˆ†åŒºçš„æ•°é‡ 12345678910111213import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.mapreduce.Partitioner;public class ItemIdPartitioner extends Partitioner&lt;OrderBean, NullWritable&gt;&#123; @Override public int getPartition(OrderBean bean, NullWritable value, int numReduceTasks) &#123; //ç›¸åŒidçš„è®¢å•beanï¼Œä¼šå‘å¾€ç›¸åŒçš„partition //è€Œä¸”ï¼Œäº§ç”Ÿçš„åˆ†åŒºæ•°ï¼Œæ˜¯ä¼šè·Ÿç”¨æˆ·è®¾ç½®çš„reduce taskæ•°ä¿æŒä¸€è‡´ return (bean.getItemid().hashCode() &amp; Integer.MAX_VALUE) % numReduceTasks; &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364import java.io.DataInput;import java.io.DataOutput;import java.io.IOException;import org.apache.hadoop.io.DoubleWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.io.WritableComparable;public class OrderBean implements WritableComparable&lt;OrderBean&gt;&#123; private Text itemid; private DoubleWritable amount; public OrderBean() &#123; &#125; public OrderBean(Text itemid, DoubleWritable amount) &#123; set(itemid, amount); &#125; public void set(Text itemid, DoubleWritable amount) &#123; this.itemid = itemid; this.amount = amount; &#125; public Text getItemid() &#123; return itemid; &#125; public DoubleWritable getAmount() &#123; return amount; &#125; @Override public int compareTo(OrderBean o) &#123; int cmp = this.itemid.compareTo(o.getItemid()); if (cmp == 0) &#123; cmp = -this.amount.compareTo(o.getAmount()); &#125; return cmp; &#125; @Override public void write(DataOutput out) throws IOException &#123; out.writeUTF(itemid.toString()); out.writeDouble(amount.get()); &#125; @Override public void readFields(DataInput in) throws IOException &#123; String readUTF = in.readUTF(); double readDouble = in.readDouble(); this.itemid = new Text(readUTF); this.amount= new DoubleWritable(readDouble); &#125; @Override public String toString() &#123; return itemid.toString() + "\t" + amount.get(); &#125;&#125; 1234567891011121314151617181920212223242526package cn.itcastcat.bigdata.secondarysort;import org.apache.hadoop.io.WritableComparable;import org.apache.hadoop.io.WritableComparator;/** * åˆ©ç”¨reduceç«¯çš„GroupingComparatoræ¥å®žçŽ°å°†ä¸€ç»„beançœ‹æˆç›¸åŒçš„key * @author duanhaitao@itcast.cn * */public class ItemidGroupingComparator extends WritableComparator &#123; //ä¼ å…¥ä½œä¸ºkeyçš„beançš„classç±»åž‹ï¼Œä»¥åŠåˆ¶å®šéœ€è¦è®©æ¡†æž¶åšåå°„èŽ·å–å®žä¾‹å¯¹è±¡ protected ItemidGroupingComparator() &#123; super(OrderBean.class, true); &#125; @Override public int compare(WritableComparable a, WritableComparable b) &#123; OrderBean abean = (OrderBean) a; OrderBean bbean = (OrderBean) b; //æ¯”è¾ƒä¸¤ä¸ªbeanæ—¶ï¼ŒæŒ‡å®šåªæ¯”è¾ƒbeanä¸­çš„orderid return abean.getItemid().compareTo(bbean.getItemid( &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081import java.io.IOException;import org.apache.commons.lang.StringUtils;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.DoubleWritable;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.Mapper;import org.apache.hadoop.mapreduce.Reducer;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;import com.sun.xml.bind.v2.schemagen.xmlschema.List;/** * * @author duanhaitao@itcast.cn * */public class SecondarySort &#123; static class SecondarySortMapper extends Mapper&lt;LongWritable, Text, OrderBean, NullWritable&gt;&#123; OrderBean bean = new OrderBean(); @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; String line = value.toString(); String[] fields = StringUtils.split(line, ","); bean.set(new Text(fields[0]), new DoubleWritable(Double.parseDouble(fields[2]))); context.write(bean, NullWritable.get()); &#125; &#125; static class SecondarySortReducer extends Reducer&lt;OrderBean, NullWritable, OrderBean, NullWritable&gt;&#123; //åˆ°è¾¾reduceæ—¶ï¼Œç›¸åŒidçš„æ‰€æœ‰beanå·²ç»è¢«çœ‹æˆä¸€ç»„ï¼Œä¸”é‡‘é¢æœ€å¤§çš„é‚£ä¸ªä¸€æŽ’åœ¨ç¬¬ä¸€ä½ @Override protected void reduce(OrderBean key, Iterable&lt;NullWritable&gt; values, Context context) throws IOException, InterruptedException &#123; context.write(key, NullWritable.get()); &#125; &#125; public static void main(String[] args) throws Exception &#123; Configuration conf = new Configuration(); Job job = Job.getInstance(conf); job.setJarByClass(SecondarySort.class); job.setMapperClass(SecondarySortMapper.class); job.setReducerClass(SecondarySortReducer.class); job.setOutputKeyClass(OrderBean.class); job.setOutputValueClass(NullWritable.class); FileInputFormat.setInputPaths(job, new Path("c:/wordcount/gpinput")); FileOutputFormat.setOutputPath(job, new Path("c:/wordcount/gpoutput")); //åœ¨æ­¤è®¾ç½®è‡ªå®šä¹‰çš„Groupingcomparatorç±» job.setGroupingComparatorClass(ItemidGroupingComparator.class); //åœ¨æ­¤è®¾ç½®è‡ªå®šä¹‰çš„partitionerç±» job.setPartitionerClass(ItemIdPartitioner.class); job.setNumReduceTasks(2); job.waitForCompletion(true); &#125;&#125;]]></content>
      <categories>
        <category>Hadoop</category>
        <category>MapReduce</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>MapReduce</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MapReduceç¬”è®°-2 ä¸‰å¤§ç»„ä»¶-Partitioneråˆ†åŒº,sortæŽ’åº,Combinerå±€éƒ¨åˆ†åŒº]]></title>
    <url>%2F2018%2F06%2F07%2FHadoop%2F2-MapReduce%2FMapReduce%E7%AC%94%E8%AE%B0-2%2F</url>
    <content type="text"><![CDATA[1. Combiner ç»„ä»¶1. äº§ç”Ÿç¼˜ç”±ï¼šCombiner æ˜¯ MapReduce ç¨‹åºä¸­ Mapper å’Œ Reducer ä¹‹å¤–çš„ä¸€ç§ç»„ä»¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨ maptask ä¹‹åŽç»™ maptask çš„ç»“æžœè¿›è¡Œå±€éƒ¨æ±‡æ€»ï¼Œä»¥å‡è½» reducetask çš„è®¡ç®—è´Ÿè½½ï¼Œå‡å°‘ç½‘ç»œä¼ è¾“ Combiner ç»„ä»¶çš„ä½œç”¨ï¼š å‡å°‘ reduce ç«¯çš„æ•°æ®é‡ å‡å°‘ shuffle è¿‡ç¨‹çš„æ•°æ®é‡ åœ¨ map ç«¯åšäº†ä¸€æ¬¡åˆå¹¶ï¼Œæé«˜åˆ†å¸ƒå¼è®¡ç®—ç¨‹åºçš„æ•´ä½“æ€§èƒ½ Combiner ç»„ä»¶å¸® reduce åˆ†æ‹…åŽ‹åŠ›ï¼Œ å› æ­¤å…¶ä¸šåŠ¡é€»è¾‘å’Œ reduce ä¸­çš„ä¸šåŠ¡é€»è¾‘ç›¸ä¼¼ 2.è‡ªå®šä¹‰ Combiner ç»„ä»¶ï¼šé»˜è®¤æƒ…å†µä¸‹æ²¡æœ‰ Combiner ç»„ä»¶ï¼ŒCombiner ä½œç”¨æ—¶é—´ç‚¹ â€” mapâ€“combinerâ€“reduce ç»§æ‰¿ Reduce ç±» public class MyCombiner extends Reducer&lt;å‰ä¸¤ä¸ªï¼š map çš„è¾“å‡ºï¼Œ åŽä¸¤ä¸ªï¼š reduce çš„è¾“å…¥&gt;{} æˆ‘ä»¬åœ¨å†™ MapReduce ç¨‹åºçš„æ—¶å€™ï¼Œ map çš„è¾“å‡ºå°±æ˜¯ reduce çš„è¾“å…¥ ä¹Ÿå°±æ˜¯è¯´ï¼Œ è¿™ä¸ª MyCombiner() çš„å‰ä¸¤ä¸ªæ³›åž‹å’ŒåŽä¸¤ä¸ªæ³›åž‹çš„ç±»åž‹ä¸€è‡´ é‡å†™ reduce æ–¹æ³• Combiner æœ¬è´¨ä¸Šç›¸å½“äºŽ åœ¨ map ç«¯è¿›è¡Œäº†ä¸€æ¬¡ reduce æ“ä½œï¼Œ é€šå¸¸æƒ…å†µä¸‹ç›´æŽ¥ä½¿ç”¨ reducer çš„ç±»ä½œä¸º Combiner çš„ç±»ï¼Œä¸å†å•ç‹¬å†™ Combiner ä»£ç é€»è¾‘ åœ¨ Job ä¸­åŠ ä¸Šjob.setCombinerClass(WorldcountReduce.class)ï¼Œ å°±ä¼šè°ƒç”¨ Combiner Combiner ä½¿ç”¨åŽŸåˆ™ æœ‰æˆ–æ²¡æœ‰éƒ½ä¸èƒ½å½±å“ä¸šåŠ¡é€»è¾‘ï¼Œéƒ½ä¸èƒ½å½±å“æœ€ç»ˆç»“æžœã€‚æ¯”å¦‚ç´¯åŠ ï¼Œæœ€å¤§å€¼ç­‰ï¼Œæ±‚å¹³å‡å€¼å°±ä¸èƒ½ç”¨ã€‚ 2ã€MapReduce ä¸­çš„åºåˆ—åŒ–2.1ã€æ¦‚è¿°Java çš„åºåˆ—åŒ–æ˜¯ä¸€ä¸ªé‡é‡çº§åºåˆ—åŒ–æ¡†æž¶ï¼ˆSerializableï¼‰ï¼Œä¸€ä¸ªå¯¹è±¡è¢«åºåˆ—åŒ–åŽï¼Œä¼šé™„å¸¦å¾ˆå¤šé¢ å¤–çš„ä¿¡æ¯ï¼ˆå„ç§æ ¡éªŒä¿¡æ¯ï¼Œheaderï¼Œç»§æ‰¿ä½“ç³»ç­‰ï¼‰ï¼Œä¸ä¾¿äºŽåœ¨ç½‘ç»œä¸­é«˜æ•ˆä¼ è¾“ï¼› Hadoop è‡ªå·±å¼€å‘äº†ä¸€å¥—åºåˆ—åŒ–æœºåˆ¶ï¼ˆå‚ä¸Žåºåˆ—åŒ–çš„å¯¹è±¡çš„ç±»éƒ½è¦å®žçŽ° Writable æŽ¥å£ï¼‰ï¼Œç²¾ç®€ï¼Œé«˜æ•ˆ Java åŸºæœ¬ç±»åž‹ &amp; Hadoop ç±»åž‹å¯¹ç…§è¡¨123456789101112131415161718// Java &amp; Hadoopç±»åž‹å‚ç…§hadoopæ•°æ®ç±»åž‹ &lt;------------&gt; javaæ•°æ®ç±»åž‹: å¸ƒå°”åž‹ï¼š BooleanWritable &lt;------------&gt; boolean æ•´åž‹ï¼š ByteWritable &lt;------------&gt; byte ShortWritable &lt;------------&gt; short IntWritable &lt;------------&gt; int LongWritable &lt;------------&gt; long æµ®ç‚¹åž‹ï¼š FloatWritable &lt;------------&gt; float DoubleWritable &lt;------------&gt; double å­—ç¬¦ä¸²ï¼ˆæ–‡æœ¬ï¼‰ï¼š Text &lt;------------&gt; String æ•°ç»„ï¼š ArrayWritable &lt;------------&gt; Array mapé›†åˆï¼š MapWritable &lt;------------&gt; map 2.2ã€è‡ªå®šä¹‰å¯¹è±¡å®žçŽ° MapReduce æ¡†æž¶çš„åºåˆ—åŒ–è¦å®žçŽ°WritableComparableæŽ¥å£ï¼Œå› ä¸º MapReduce æ¡†æž¶ä¸­çš„ shuffle è¿‡ç¨‹ä¸€å®šä¼šå¯¹ key è¿›è¡ŒæŽ’åº 123456789101112131415161718//åºåˆ—åŒ–æ–¹æ³•@Overridepublic void write(DataOutput out) throws IOException &#123; out.writeUTF(phone); out.writeLong(upfFlow); out.writeLong(downFlow); out.writeLong(sumFlow);&#125;//ååºåˆ—åŒ–æ–¹æ³•//æ³¨æ„ï¼š å­—æ®µçš„ååºåˆ—åŒ–é¡ºåºä¸Žåºåˆ—åŒ–æ—¶çš„é¡ºåºä¿æŒä¸€è‡´,ä¸¦ä¸”ç±»åž‹ä¹Ÿä¸€è‡´@Overridepublic void readFields(DataInput in) throws IOException &#123; this.phone = in.readUTF(); this.upfFlow = in.readLong(); this.downFlow = in.readLong(); this.sumFlow = in.readLong();&#125; 3. MapReduceä¸­çš„Sort â€“TODOã€‚ã€‚MapTask â€“&gt; ReduceTask ä¹‹é—´ï¼Œ æ¡†æž¶é»˜è®¤æ·»åŠ äº†æŽ’åº æŽ’åºçš„è§„åˆ™æ˜¯æŒ‰ç…§Map ç«¯è¾“å‡ºçš„ key çš„å­—å…¸é¡ºåºè¿›è¡ŒæŽ’åº 1ã€ å¦‚æžœæ²¡æœ‰é‡å†™ WritableComparable æ—¶ï£¿ æŒ‰å•è¯ç»Ÿè®¡ä¸­è¯é¢‘å‡ºçŽ°çš„æ­¤å¤„è¿›è¡ŒæŽ’åºï¼Œ æŒ‰ç…§å‡ºçŽ°çš„æ¬¡æ•°ï¼Œ ä»Žä½Žåˆ°é«˜ å¦‚æžœæƒ³è¦å¯¹è¯é¢‘è¿›è¡ŒæŽ’åºï¼Œ é‚£ä¹ˆè¯é¢‘åº”è¯¥æ”¾åœ¨ map è¾“å‡º key çš„ä½ç½® ä»£ç å®žçŽ°ï¼š 1234567ï£¿ï£¿ï£¿ï£¿ Map ï£¿ï£¿ï£¿ï£¿//è¯é¢‘ä¸º keyï¼Œ å…¶å®ƒä¸º valueï£¿ï£¿ï£¿ï£¿ Reduce ï£¿ï£¿ï£¿ï£¿// å°† map è¾“å…¥çš„ç»“æžœåè½¬(k,v æ¢ä½ç½®), è¾“å‡ºæœ€ç»ˆç»“æžœ// æœ€åŽè¾“å‡ºè¿˜æ˜¯æŒ‰ç…§å·¦è¾¹è¯, å³è¾¹æ¬¡æ•°// psï¼š å¦‚æžœå€’åºæŽ’çš„æ—¶å€™, map çš„æ—¶å€™å‘çš„æ—¶å€™ åŠ ä¸Š-, reduce å‘çš„æ—¶å€™, å†åŠ ä¸Š-, è½¬æˆ IntWritable 2ã€è‡ªå®šä¹‰æŽ’åºè¦å®žçŽ°WritableComparableæŽ¥å£ è‡ªå®šä¹‰çš„ç±»å¿…é¡»æ”¾åœ¨ key çš„ä½ç½® å®žçŽ°WritableComparableæŽ¥å£ï¼Œ é‡å†™ compareTo()æ–¹æ³• å¾…æ‰©å±•â€¦ ä½œä¸šï¼š å¢žå¼ºéœ€æ±‚ï¼š æŒ‰ç…§æ€»æµé‡æŽ’åºï¼Œ æ€»æµé‡ç›¸åŒæ—¶ï¼Œ æŒ‰ç…§æ‰‹æœºå·ç æŽ’åº 4ã€MapReduce ä¸­çš„æ•°æ®åˆ†å‘ç»„ä»¶ Partitionerï¼ˆåˆ†åŒºï¼‰éœ€æ±‚ï¼š æ ¹æ®å½’å±žåœ°è¾“å‡ºæµé‡ç»Ÿè®¡æ•°æ®ç»“æžœåˆ°ä¸åŒæ–‡ä»¶ï¼Œä»¥ä¾¿äºŽåœ¨æŸ¥è¯¢ç»Ÿè®¡ç»“æžœæ—¶å¯ä»¥å®šä½åˆ° çœçº§èŒƒå›´è¿›è¡Œ æ€è·¯ï¼šMapReduce ä¸­ä¼šå°† map è¾“å‡ºçš„ kv å¯¹ï¼ŒæŒ‰ç…§ç›¸åŒ key åˆ†ç»„ï¼Œç„¶åŽåˆ†å‘ç»™ä¸åŒçš„ reducetask æ‰§è¡Œæ—¶æœº: åœ¨Mapè¾“å‡º kv å¯¹ä¹‹åŽ, æ‰€æºå¸¦çš„ k,v å‚æ•°ï¼Œè·Ÿ Map è¾“å‡ºç›¸åŒ MapReduce é»˜è®¤çš„åˆ†å‘è§„åˆ™ä¸ºï¼šæ ¹æ® key çš„ hashcode%reducetask æ•°æ¥åˆ†å‘ï¼Œæ‰€ä»¥ï¼šå¦‚æžœè¦æŒ‰ç…§æˆ‘ä»¬è‡ª å·±çš„éœ€æ±‚è¿›è¡Œåˆ†ç»„ï¼Œåˆ™éœ€è¦æ”¹å†™æ•°æ®åˆ†å‘ï¼ˆåˆ†åŒºï¼‰ç»„ä»¶ Partitioner Partitioné‡ç‚¹æ€»ç»“ï¼š Partition çš„ key value, å°±æ˜¯Mapperè¾“å‡ºçš„key value public abstract int getPartition(KEY key, VALUE value, int numPartitions); è¾“å…¥æ˜¯Mapçš„ç»“æžœå¯¹&lt;key, value&gt;å’ŒReducerçš„æ•°ç›®ï¼Œè¾“å‡ºåˆ™æ˜¯åˆ†é…çš„Reducerï¼ˆæ•´æ•°ç¼–å·ï¼‰ã€‚å°±æ˜¯æŒ‡å®šMapprè¾“å‡ºçš„é”®å€¼å¯¹åˆ°å“ªä¸€ä¸ªreducerä¸ŠåŽ»ã€‚ç³»ç»Ÿç¼ºçœçš„Partitioneræ˜¯HashPartitionerï¼Œå®ƒä»¥keyçš„Hashå€¼å¯¹Reducerçš„æ•°ç›®å–æ¨¡ï¼Œå¾—åˆ°å¯¹åº”çš„Reducerã€‚è¿™æ ·ä¿è¯å¦‚æžœæœ‰ç›¸åŒçš„keyå€¼ï¼Œè‚¯å®šè¢«åˆ†é…åˆ°åŒä¸€ä¸ªreducreä¸Šã€‚å¦‚æžœæœ‰Nä¸ªreducerï¼Œç¼–å·å°±ä¸º0,1,2,3â€¦â€¦(N-1)ã€‚ MapReduce ä¸­ä¼šå°† map è¾“å‡ºçš„ kv å¯¹ï¼ŒæŒ‰ç…§ç›¸åŒ key åˆ†ç»„ï¼Œç„¶åŽåˆ†å‘ç»™ä¸åŒçš„ reducetask é»˜è®¤çš„åˆ†å‘è§„åˆ™ä¸º:æ ¹æ® key çš„ hashcode%reducetask æ•°æ¥åˆ†å‘ï¼Œæ‰€ä»¥:å¦‚æžœè¦æŒ‰ç…§æˆ‘ä»¬è‡ª å·±çš„éœ€æ±‚è¿›è¡Œåˆ†ç»„ï¼Œåˆ™éœ€è¦æ”¹å†™æ•°æ®åˆ†å‘(åˆ†ç»„)ç»„ä»¶ Partitioner, è‡ªå®šä¹‰ä¸€ä¸ª CustomPartitioner ç»§æ‰¿æŠ½è±¡ç±»:Partitioner å› æ­¤ï¼Œ Partitioner çš„æ‰§è¡Œæ—¶æœºï¼Œ æ˜¯åœ¨Mapè¾“å‡º kv å¯¹ä¹‹åŽ Partitioner å®žçŽ°è¿‡ç¨‹ å…ˆåˆ†æžä¸€ä¸‹å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œç¡®å®šå¤§æ¦‚æœ‰å¤šå°‘ä¸ªåˆ†åŒº é¦–å…ˆä¹¦å†™ä¸€ä¸ªç±»ï¼Œå®ƒè¦ç»§æ‰¿ org.apache.hadoop.mapreduce.Partitionerè¿™ä¸ªæŠ½è±¡ç±» é‡å†™public int getPartitionè¿™ä¸ªæ–¹æ³•ï¼Œæ ¹æ®å…·ä½“é€»è¾‘ï¼Œè¯»æ•°æ®åº“æˆ–è€…é…ç½®è¿”å›žç›¸åŒçš„æ•°å­— åœ¨mainæ–¹æ³•ä¸­è®¾ç½®Partionerçš„ç±»ï¼Œjob.setPartitionerClass(DataPartitioner.class); è®¾ç½®Reducerçš„æ•°é‡ï¼Œjob.setNumReduceTasks(6); å…¸åž‹çš„ Partitioner ä»£ç å®žçŽ°12345678910111213141516171819202122import java.util.HashMap;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Partitioner;public class ProvincePartitioner extends Partitioner&lt;Text, FlowBean&gt; &#123; private static HashMap&lt;String, Integer&gt; provincMap = new HashMap&lt;String, Integer&gt;(); static &#123; provincMap.put("138", 0); provincMap.put("139", 1); provincMap.put("136", 2); provincMap.put("137", 3); provincMap.put("135", 4); &#125; @Override public int getPartition(Text key, FlowBean value, int numPartitions) &#123; Integer code = provincMap.get(key.toString().substring(0, 3)); if (code != null) &#123; return code; &#125; return 5; &#125;&#125; 5ã€å…¨å±€è®¡æ•°å™¨1. æ¡†æž¶å†…ç½®è®¡æ•°å™¨ï¼š Hadoopå†…ç½®çš„è®¡æ•°å™¨ï¼Œä¸»è¦ç”¨æ¥è®°å½•ä½œä¸šçš„æ‰§è¡Œæƒ…å†µ å†…ç½®è®¡æ•°å™¨åŒ…æ‹¬ MapReduceæ¡†æž¶è®¡æ•°å™¨ï¼ˆMap-Reduce Frameworkï¼‰ æ–‡ä»¶ç³»ç»Ÿè®¡æ•°å™¨ï¼ˆFielSystemCountersï¼‰ ä½œä¸šè®¡æ•°å™¨ï¼ˆJob Countersï¼‰ æ–‡ä»¶è¾“å…¥æ ¼å¼è®¡æ•°å™¨ï¼ˆFile Output Format Countersï¼‰ æ–‡ä»¶è¾“å‡ºæ ¼å¼è®¡æ•°å™¨ï¼ˆFile Input Format Counters) è®¡æ•°å™¨ç”±ç›¸å…³çš„taskè¿›è¡Œç»´æŠ¤ï¼Œå®šæœŸä¼ é€’ç»™tasktrackerï¼Œå†ç”±tasktrackerä¼ ç»™jobtrackerï¼› æœ€ç»ˆçš„ä½œä¸šè®¡æ•°å™¨å®žé™…ä¸Šæ˜¯æœ‰jobtrackerç»´æŠ¤ï¼Œæ‰€ä»¥è®¡æ•°å™¨å¯ä»¥è¢«å…¨å±€æ±‡æ€»ï¼ŒåŒæ—¶ä¹Ÿä¸å¿…åœ¨æ•´ä¸ªç½‘ç»œä¸­ä¼ é€’ åªæœ‰å½“ä¸€ä¸ªä½œä¸šæ‰§è¡ŒæˆåŠŸåŽï¼Œæœ€ç»ˆçš„è®¡æ•°å™¨çš„å€¼æ‰æ˜¯å®Œæ•´å¯é çš„ï¼› 2. è‡ªå®šä¹‰çš„è®¡æ•°å™¨åº”ç”¨åœºæ™¯ ç”¨æ¥ç»Ÿè®¡è¿è¡Œè¿‡ç¨‹ä¸­çš„è¿›åº¦å’ŒçŠ¶æ€ï¼Œ ç±»ä¼¼äºŽ job è¿è¡Œçš„ä¸€ä¸ªæŠ¥å‘Šã€æ—¥å¿— è¦å°†æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸åˆè§„æ•°æ®è¡Œè¿›è¡Œå…¨å±€è®¡æ•°ï¼Œç±»ä¼¼è¿™ ç§éœ€æ±‚å¯ä»¥å€ŸåŠ© MapReduce æ¡†æž¶ä¸­æä¾›çš„å…¨å±€è®¡æ•°å™¨æ¥å®žçŽ° è®¡æ•°å™¨çš„å€¼å¯ä»¥åœ¨mapperæˆ–reducerä¸­å¢žåŠ  ä½¿ç”¨æ–¹å¼ å®šä¹‰æžšä¸¾ç±» 1234enum Temperature&#123; MISSING, TOTAL &#125; åœ¨mapæˆ–è€…reduceä¸­ä½¿ç”¨è®¡æ•°å™¨ 123456// 1.è‡ªå®šä¹‰è®¡æ•°å™¨Counter counter = context.getCounter(Temperature.TOTAL); // 2.ä¸ºè®¡æ•°å™¨èµ‹åˆå§‹å€¼counter.setValue(long value);// 3.è®¡æ•°å™¨å·¥ä½œcounter.increment(long incr); èŽ·å–è®¡æ•°å™¨ 123Counters counters=job.getCounters(); Counter counter=counters.findCounter(LOG_PROCESSOR_COUNTER.BAD_RECORDS_LONG);// æŸ¥æ‰¾æžšä¸¾è®¡æ•°å™¨ï¼Œå‡å¦‚Enumçš„å˜é‡ä¸ºBAD_RECORDS_LONG long value=counter.getValue();//èŽ·å–è®¡æ•°å€¼ è®¡æ•°å™¨ä½¿ç”¨å®Œæ•´ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162/** * @Description å‡å¦‚ä¸€ä¸ªæ–‡ä»¶ï¼Œè§„èŒƒçš„æ ¼å¼æ˜¯3ä¸ªå­—æ®µï¼Œâ€œ\tâ€ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå…¶ä¸­æœ‰2æ¡å¼‚å¸¸æ•°æ®ï¼Œä¸€æ¡æ•°æ®æ˜¯åªæœ‰2ä¸ªå­—æ®µï¼Œä¸€æ¡æ•°æ®æ˜¯æœ‰4ä¸ªå­—æ®µ*/public class MyCounter &#123; // \té”® private static String TAB_SEPARATOR = "\t"; public static class MyCounterMap extends Mapper&lt;LongWritable, Text, Text, Text&gt; &#123; // å®šä¹‰æžšä¸¾å¯¹è±¡ public static enum LOG_PROCESSOR_COUNTER &#123; BAD_RECORDS_LONG, BAD_RECORDS_SHORT &#125;; protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; String arr_value[] = value.toString().split(TAB_SEPARATOR); if (arr_value.length &gt; 3) &#123; /* è‡ªå®šä¹‰è®¡æ•°å™¨ */ context.getCounter("ErrorCounter", "toolong").increment(1); /* æžšä¸¾è®¡æ•°å™¨ */ context.getCounter(LOG_PROCESSOR_COUNTER.BAD_RECORDS_LONG).increment(1); &#125; else if (arr_value.length &lt; 3) &#123; // è‡ªå®šä¹‰è®¡æ•°å™¨ context.getCounter("ErrorCounter", "tooshort").increment(1); // æžšä¸¾è®¡æ•°å™¨ context.getCounter(LOG_PROCESSOR_COUNTER.BAD_RECORDS_SHORT).increment(1); &#125; &#125; &#125; @SuppressWarnings("deprecation") public static void main(String[] args) throws IOException, InterruptedException, ClassNotFoundException &#123; String[] args0 = &#123; "hdfs://hadoop2:9000/buaa/counter/counter.txt", "hdfs://hadoop2:9000/buaa/counter/out/" &#125;; // è¯»å–é…ç½®æ–‡ä»¶ Configuration conf = new Configuration(); // å¦‚æžœè¾“å‡ºç›®å½•å­˜åœ¨ï¼Œåˆ™åˆ é™¤ Path mypath = new Path(args0[1]); FileSystem hdfs = mypath.getFileSystem(conf); if (hdfs.isDirectory(mypath)) &#123; hdfs.delete(mypath, true); &#125; // æ–°å»ºä¸€ä¸ªä»»åŠ¡ Job job = new Job(conf, "MyCounter"); // ä¸»ç±» job.setJarByClass(MyCounter.class); // Mapper job.setMapperClass(MyCounterMap.class); // è¾“å…¥ç›®å½• FileInputFormat.addInputPath(job, new Path(args0[0])); // è¾“å‡ºç›®å½• FileOutputFormat.setOutputPath(job, new Path(args0[1])); // æäº¤ä»»åŠ¡ï¼Œå¹¶é€€å‡º System.exit(job.waitForCompletion(true) ? 0 : 1); &#125;&#125; æ³¨æ„ç‚¹ï¼šåœ¨æ²¡æœ‰ ReduceTask çš„æ—¶å€™ï¼Œ job.setNumReduceTasks(0); å…³äºŽè®¡æ•°å™¨ï¼Œè¯¦æƒ…å¯å‚è€ƒ]]></content>
      <categories>
        <category>Hadoop</category>
        <category>MapReduce</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>MapReduce</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MapReduceç¬”è®°-1 WordCount, MapReduceè¿è¡Œæœºåˆ¶]]></title>
    <url>%2F2018%2F06%2F06%2FHadoop%2F2-MapReduce%2FMapReduce%E7%AC%94%E8%AE%B0-1%2F</url>
    <content type="text"><![CDATA[å‚è€ƒé“¾æŽ¥: hdfs ç¬”è®° mapreduce ç¬”è®° 1ã€MapReduce å…¥é—¨1.1ã€MapReduceæ¦‚å¿µhadoop çš„å››å¤§ç»„ä»¶ï¼š HDFSï¼šåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿ MapReduceï¼šåˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿ YARNï¼šhadoop çš„èµ„æºè°ƒåº¦ç³»ç»Ÿ Commonï¼šä»¥ä¸Šä¸‰å¤§ç»„ä»¶çš„åº•å±‚æ”¯æ’‘ç»„ä»¶ï¼Œä¸»è¦æä¾›åŸºç¡€å·¥å…·åŒ…å’Œ RPC æ¡†æž¶ç­‰ MapReduce æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è¿ç®—ç¨‹åºçš„ç¼–ç¨‹æ¡†æž¶ï¼Œæ˜¯ç”¨æˆ·å¼€å‘â€œåŸºäºŽ Hadoop çš„æ•°æ®åˆ†æžåº”ç”¨â€ çš„æ ¸å¿ƒæ¡†æž¶ MapReduce æ ¸å¿ƒåŠŸèƒ½ ï¼šå°†ç”¨æˆ·ç¼–å†™çš„ä¸šåŠ¡é€»è¾‘ä»£ç å’Œè‡ªå¸¦é»˜è®¤ç»„ä»¶æ•´åˆæˆä¸€ä¸ªå®Œæ•´çš„åˆ†å¸ƒ å¼è¿ç®—ç¨‹åºï¼Œå¹¶å‘è¿è¡Œåœ¨ä¸€ä¸ª Hadoop é›†ç¾¤ä¸Š 1.2ã€ä¸ºä»€ä¹ˆéœ€è¦ MapReduceï¼Ÿå¼•å…¥ MapReduce æ¡†æž¶åŽï¼Œå¼€å‘äººå‘˜å¯ä»¥å°†ç»å¤§éƒ¨åˆ†å·¥ä½œé›†ä¸­åœ¨ä¸šåŠ¡é€»è¾‘çš„å¼€å‘ä¸Šï¼Œè€Œå°† åˆ†å¸ƒå¼è®¡ç®—ä¸­çš„å¤æ‚æ€§äº¤ç”±æ¡†æž¶æ¥å¤„ç† Hadoop å½“ä¸­çš„ MapReduce åˆ†å¸ƒå¼ç¨‹åºè¿ç®—æ¡†æž¶çš„æ•´ä½“ç»“æž„å¦‚ä¸‹ï¼š MRAppMasterï¼šMapReduce Application Masterï¼Œåˆ†é…ä»»åŠ¡ï¼Œåè°ƒä»»åŠ¡çš„è¿è¡Œ MapTaskï¼šé˜¶æ®µå¹¶å‘ä»»ï¼Œè´Ÿè´£ mapper é˜¶æ®µçš„ä»»åŠ¡å¤„ç† YARNChild ReduceTaskï¼šé˜¶æ®µæ±‡æ€»ä»»åŠ¡ï¼Œè´Ÿè´£ reducer é˜¶æ®µçš„ä»»åŠ¡å¤„ç† YARNChild 1.3ã€MapReduce çš„ç¼–å†™è§„èŒƒMapReduce ç¨‹åºç¼–å†™è§„èŒƒï¼š ç”¨æˆ·ç¼–å†™çš„ç¨‹åºåˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼šMapperï¼ŒReducerï¼ŒDriver(æäº¤è¿è¡Œ MR ç¨‹åºçš„å®¢æˆ·ç«¯) Mapper çš„è¾“å…¥æ•°æ®æ˜¯ KV å¯¹çš„å½¢å¼ï¼ˆKV çš„ç±»åž‹å¯è‡ªå®šä¹‰ï¼‰ Mapper çš„è¾“å‡ºæ•°æ®æ˜¯ KV å¯¹çš„å½¢å¼ï¼ˆKV çš„ç±»åž‹å¯è‡ªå®šä¹‰ï¼‰ Mapper ä¸­çš„ä¸šåŠ¡é€»è¾‘å†™åœ¨ map()æ–¹æ³•ä¸­ map()æ–¹æ³•ï¼ˆmaptask è¿›ç¨‹ï¼‰å¯¹æ¯ä¸€ä¸ª&lt;K,V&gt;è°ƒç”¨ä¸€æ¬¡ Reducer çš„è¾“å…¥æ•°æ®ç±»åž‹å¯¹åº” Mapper çš„è¾“å‡ºæ•°æ®ç±»åž‹ï¼Œä¹Ÿæ˜¯ KV å¯¹çš„å½¢å¼ Reducer çš„ä¸šåŠ¡é€»è¾‘å†™åœ¨ reduce()æ–¹æ³•ä¸­ Reducetask è¿›ç¨‹å¯¹æ¯ä¸€ç»„ç›¸åŒ k çš„&lt;K,V&gt;ç»„è°ƒç”¨ä¸€æ¬¡ reduce()æ–¹æ³• ç”¨æˆ·è‡ªå®šä¹‰çš„ Mapper å’Œ Reducer éƒ½è¦ç»§æ‰¿å„è‡ªçš„çˆ¶ç±» æ•´ä¸ªç¨‹åºéœ€è¦ä¸€ä¸ª Drvier æ¥è¿›è¡Œæäº¤ï¼Œæäº¤çš„æ˜¯ä¸€ä¸ªæè¿°äº†å„ç§å¿…è¦ä¿¡æ¯çš„ job å¯¹è±¡ 1.4ã€WordCount ç¨‹åº1ã€ä¸šåŠ¡é€»è¾‘ maptaské˜¶æ®µå¤„ç†æ¯ä¸ªæ•°æ®åˆ†å—çš„å•è¯ç»Ÿè®¡åˆ†æžï¼Œæ€è·¯æ˜¯æ¯é‡åˆ°ä¸€ä¸ªå•è¯åˆ™æŠŠå…¶è½¬æ¢æˆä¸€ä¸ª key-valueå¯¹ï¼Œæ¯”å¦‚å•è¯ helloï¼Œå°±è½¬æ¢æˆ&lt;â€™helloâ€™,1&gt;å‘é€ç»™ reducetaskåŽ»æ±‡æ€» reducetaské˜¶æ®µå°†æŽ¥å— maptaskçš„ç»“æžœï¼Œæ¥åšæ±‡æ€»è®¡æ•° 2ã€å…·ä½“ä»£ç å®žçŽ°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465ï£¿ï£¿ï£¿ï£¿ Map ï£¿ï£¿ï£¿ï£¿static class WordCountMapper extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt; &#123; @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; // è®¡ç®—ä»»åŠ¡ä»£ç ï¼šåˆ‡å‰²å•è¯ï¼Œè¾“å‡ºæ¯ä¸ªå•è¯è®¡ 1 çš„ key-value å¯¹ String[] words = value.toString().split(" "); for (String word : words) &#123; context.write(new Text(word), new IntWritable(1)); &#125; &#125;&#125;ï£¿ï£¿ï£¿ï£¿ Reduce ï£¿ï£¿ï£¿ï£¿static class WordCountReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; &#123; @Override protected void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException &#123; // æ±‡æ€»è®¡ç®—ä»£ç ï¼šå¯¹æ¯ä¸ª key ç›¸åŒçš„ä¸€ç»„ key-value åšæ±‡æ€»ç»Ÿè®¡ int sum = 0; for (IntWritable v : values) &#123; sum += v.get(); &#125; context.write(key, new IntWritable(sum)); &#125;&#125;ï£¿ï£¿ï£¿ï£¿ main ï£¿ï£¿ï£¿ï£¿public static void main(String[] args) throws Exception &#123; // æŒ‡å®š hdfs ç›¸å…³çš„å‚æ•° Configuration conf = new Configuration(); conf.set("fs.defaultFS", "hdfs://hadoop02:9000"); System.setProperty("HADOOP_USER_NAME", "hadoop"); // æ–°å»ºä¸€ä¸ª job ä»»åŠ¡ Job job = Job.getInstance(conf); // è®¾ç½® jar åŒ…æ‰€åœ¨è·¯å¾„ job.setJarByClass(WordCountMR.class); // æŒ‡å®š mapper ç±»å’Œ reducer ç±» job.setMapperClass(WordCountMapper.class); job.setReducerClass(WordCountReducer.class); // æŒ‡å®š maptask çš„è¾“å‡ºç±»åž‹ job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(IntWritable.class); // æŒ‡å®š reducetask çš„è¾“å‡ºç±»åž‹ job.setOutputKeyClass(Text.class); job.setOutputValueClass(IntWritable.class); // æŒ‡å®šè¯¥ mapreduce ç¨‹åºæ•°æ®çš„è¾“å…¥å’Œè¾“å‡ºè·¯å¾„ Path inputPath = new Path("/wordcount/input"); Path outputPath = new Path("/wordcount/output"); FileInputFormat.setInputPaths(job, inputPath); FileOutputFormat.setOutputPath(job, outputPath); // æœ€åŽæäº¤ä»»åŠ¡ boolean waitForCompletion = job.waitForCompletion(true); System.exit(waitForCompletion?0:1);&#125; 1.5 å°æ–‡ä»¶ä¼˜åŒ– éœ€è¦è®¾ç½®æœ€å¤§å€¼å’Œæœ€å°å€¼, ä¼šåˆ‡åˆ†æ–‡ä»¶, åœ¨æœ€å¤§å€¼ä¸Žæœ€å°å€¼ä¹‹é—´ 2ã€MapReduce ç¨‹åºçš„æ ¸å¿ƒè¿è¡Œæœºåˆ¶2.1ã€æ¦‚è¿°ä¸€ä¸ªå®Œæ•´çš„ MapReduce ç¨‹åºåœ¨åˆ†å¸ƒå¼è¿è¡Œæ—¶æœ‰ä¸¤ç±»å®žä¾‹è¿›ç¨‹ï¼š MRAppMasterï¼šè´Ÿè´£æ•´ä¸ªç¨‹åºçš„è¿‡ç¨‹è°ƒåº¦åŠçŠ¶æ€åè°ƒ Yarnchildï¼šè´Ÿè´£ map é˜¶æ®µçš„æ•´ä¸ªæ•°æ®å¤„ç†æµç¨‹ Yarnchildï¼šè´Ÿè´£ reduce é˜¶æ®µçš„æ•´ä¸ªæ•°æ®å¤„ç†æµç¨‹ ä»¥ä¸Šä¸¤ä¸ªé˜¶æ®µ MapTask å’Œ ReduceTask çš„è¿›ç¨‹éƒ½æ˜¯ YarnChild ï¼Œ å¹¶ä¸æ˜¯è¯´è¿™ MapTask å’Œ ReduceTask å°±è·‘åœ¨åŒä¸€ä¸ª YarnChild è¿›è¡Œé‡Œ 2.2ã€MapReduce ç¨‹åºçš„è¿è¡Œæµç¨‹ ä¸€ä¸ª mr ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œæœ€å…ˆå¯åŠ¨çš„æ˜¯ MRAppMasterï¼ŒMRAppMaster å¯åŠ¨åŽæ ¹æ®æœ¬æ¬¡ job çš„æè¿°ä¿¡æ¯ï¼Œè®¡ç®—å‡ºéœ€è¦çš„ maptask å®žä¾‹æ•°é‡ï¼Œç„¶åŽå‘é›†ç¾¤ç”³è¯·æœºå™¨å¯åŠ¨ç›¸åº”æ•°é‡çš„ maptask è¿›ç¨‹ maptask è¿›ç¨‹å¯åŠ¨ä¹‹åŽï¼Œæ ¹æ®ç»™å®šçš„æ•°æ®åˆ‡ç‰‡(å“ªä¸ªæ–‡ä»¶çš„å“ªä¸ªåç§»é‡èŒƒå›´)èŒƒå›´è¿›è¡Œæ•° æ®å¤„ç†ï¼Œä¸»ä½“æµç¨‹ä¸ºï¼š åˆ©ç”¨å®¢æˆ·æŒ‡å®šçš„ InputFormat æ¥èŽ·å– RecordReader è¯»å–æ•°æ®ï¼Œå½¢æˆè¾“å…¥ KV å¯¹ å°†è¾“å…¥ KV å¯¹ä¼ é€’ç»™å®¢æˆ·å®šä¹‰çš„ map()æ–¹æ³•ï¼Œåšé€»è¾‘è¿ç®—ï¼Œå¹¶å°† map()æ–¹æ³•è¾“å‡ºçš„ KV å¯¹æ”¶ é›†åˆ°ç¼“å­˜ å°†ç¼“å­˜ä¸­çš„ KV å¯¹æŒ‰ç…§ K åˆ†åŒºæŽ’åºåŽä¸æ–­æº¢å†™åˆ°ç£ç›˜æ–‡ä»¶ MRAppMaster ç›‘æŽ§åˆ°æ‰€æœ‰ maptask è¿›ç¨‹ä»»åŠ¡å®Œæˆä¹‹åŽï¼ˆçœŸå®žæƒ…å†µæ˜¯ï¼ŒæŸäº› maptask è¿› ç¨‹å¤„ç†å®ŒæˆåŽï¼Œå°±ä¼šå¼€å§‹å¯åŠ¨ reducetask åŽ»å·²å®Œæˆçš„ maptask å¤„ fetch æ•°æ®ï¼‰ï¼Œä¼šæ ¹æ®å®¢æˆ·æŒ‡ å®šçš„å‚æ•°å¯åŠ¨ç›¸åº”æ•°é‡çš„ reducetask è¿›ç¨‹ï¼Œå¹¶å‘ŠçŸ¥ reducetask è¿›ç¨‹è¦å¤„ç†çš„æ•°æ®èŒƒå›´ï¼ˆæ•°æ® åˆ†åŒºï¼‰ Reducetask è¿›ç¨‹å¯åŠ¨ä¹‹åŽï¼Œæ ¹æ® MRAppMaster å‘ŠçŸ¥çš„å¾…å¤„ç†æ•°æ®æ‰€åœ¨ä½ç½®ï¼Œä»Žè‹¥å¹²å° maptask è¿è¡Œæ‰€åœ¨æœºå™¨ä¸ŠèŽ·å–åˆ°è‹¥å¹²ä¸ª maptask è¾“å‡ºç»“æžœæ–‡ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°è¿›è¡Œé‡æ–°å½’å¹¶æŽ’åºï¼Œ ç„¶åŽæŒ‰ç…§ç›¸åŒ key çš„ KV ä¸ºä¸€ä¸ªç»„ï¼Œè°ƒç”¨å®¢æˆ·å®šä¹‰çš„ reduce()æ–¹æ³•è¿›è¡Œé€»è¾‘è¿ç®—ï¼Œå¹¶æ”¶é›†è¿ ç®—è¾“å‡ºçš„ç»“æžœ KVï¼Œç„¶åŽè°ƒç”¨å®¢æˆ·æŒ‡å®šçš„ OutputFormat å°†ç»“æžœæ•°æ®è¾“å‡ºåˆ°å¤–éƒ¨å­˜å‚¨ 2.3ã€MapTask å¹¶è¡Œåº¦å†³å®šæœºåˆ¶å°†å¾…å¤„ç†æ•°æ®æ‰§è¡Œé€»è¾‘åˆ‡ç‰‡ï¼ˆå³æŒ‰ç…§ä¸€ä¸ªç‰¹å®šåˆ‡ç‰‡å¤§å°ï¼Œå°†å¾…å¤„ç†æ•°æ®åˆ’åˆ†æˆé€»è¾‘ä¸Šçš„å¤š ä¸ª splitï¼‰ï¼Œç„¶åŽæ¯ä¸€ä¸ª split åˆ†é…ä¸€ä¸ª mapTask å¹¶è¡Œå®žä¾‹å¤„ç†ã€‚ è¿™æ®µé€»è¾‘åŠå½¢æˆçš„åˆ‡ç‰‡è§„åˆ’æè¿°æ–‡ä»¶ï¼Œæ˜¯ç”± FileInputFormat å®žçŽ°ç±»çš„ getSplits()æ–¹æ³•å®Œæˆçš„ã€‚ è¯¥æ–¹æ³•è¿”å›žçš„æ˜¯ Listï¼ŒInputSplit å°è£…äº†æ¯ä¸€ä¸ªé€»è¾‘åˆ‡ç‰‡çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬é•¿åº¦å’Œä½ç½® ä¿¡æ¯ï¼Œè€Œ getSplits()æ–¹æ³•è¿”å›žä¸€ç»„ InputSplitã€‚ 2.4ã€åˆ‡ç‰‡æœºåˆ¶ FileInputFormat ä¸­é»˜è®¤çš„åˆ‡ç‰‡æœºåˆ¶ ç®€å•åœ°æŒ‰ç…§æ–‡ä»¶çš„å†…å®¹é•¿åº¦è¿›è¡Œåˆ‡ç‰‡ åˆ‡ç‰‡å¤§å°ï¼Œé»˜è®¤ç­‰äºŽ block å¤§å° åˆ‡ç‰‡æ—¶ä¸è€ƒè™‘æ•°æ®é›†æ•´ä½“ï¼Œè€Œæ˜¯é€ä¸ªé’ˆå¯¹æ¯ä¸€ä¸ªæ–‡ä»¶å•ç‹¬åˆ‡ç‰‡ æ¯”å¦‚å¾…å¤„ç†æ•°æ®æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š File1.txt 200M File2.txt 100M ç»è¿‡ getSplits()æ–¹æ³•å¤„ç†ä¹‹åŽï¼Œå½¢æˆçš„åˆ‡ç‰‡ä¿¡æ¯æ˜¯ï¼š File1.txt-split1 0-128M File1.txt-split2 129M-200M File2.txt-split1 0-100M FileInputFormat ä¸­åˆ‡ç‰‡çš„å¤§å°çš„å‚æ•°é…ç½®1234567891011// é€šè¿‡åˆ†æžæºç ï¼Œåœ¨ FileInputFormat ä¸­ï¼Œè®¡ç®—åˆ‡ç‰‡å¤§å°çš„é€»è¾‘ï¼šlong splitSize = computeSplitSize(blockSize, minSize, maxSize)ï¼Œç¿»è¯‘ä¸€ä¸‹å°±æ˜¯æ±‚è¿™ä¸‰ä¸ªå€¼çš„ä¸­ é—´å€¼// åˆ‡ç‰‡ä¸»è¦ç”±è¿™å‡ ä¸ªå€¼æ¥è¿ç®—å†³å®šï¼šblocksizeï¼šé»˜è®¤æ˜¯ 128Mï¼Œå¯é€šè¿‡ dfs.blocksize ä¿®æ”¹minSizeï¼šé»˜è®¤æ˜¯ 1ï¼Œå¯é€šè¿‡ mapreduce.input.fileinputformat.split.minsize ä¿®æ”¹maxsizeï¼šé»˜è®¤æ˜¯ Long.MaxValueï¼Œå¯é€šè¿‡ mapreduce.input.fileinputformat.split.maxsize ä¿®æ”¹//å› æ­¤ï¼Œå¦‚æžœ maxsize è°ƒçš„æ¯” blocksize å°ï¼Œåˆ™åˆ‡ç‰‡ä¼šå°äºŽ blocksize; å¦‚æžœ minsize è°ƒçš„æ¯” blocksize å¤§ï¼Œåˆ™åˆ‡ç‰‡ä¼šå¤§äºŽ blocksize// ä½†æ˜¯ï¼Œä¸è®ºæ€Žä¹ˆè°ƒå‚æ•°ï¼Œéƒ½ä¸èƒ½è®©å¤šä¸ªå°æ–‡ä»¶â€œåˆ’å…¥â€ä¸€ä¸ª split 2.5ã€MapTask å¹¶è¡Œåº¦ç»éªŒä¹‹è°ˆå¦‚æžœç¡¬ä»¶é…ç½®ä¸º 2*12core + 64Gï¼Œæ°å½“çš„ map å¹¶è¡Œåº¦æ˜¯å¤§çº¦æ¯ä¸ªèŠ‚ç‚¹ 20-100 ä¸ª mapï¼Œæœ€å¥½ æ¯ä¸ª map çš„æ‰§è¡Œæ—¶é—´è‡³å°‘ä¸€åˆ†é’Ÿã€‚ å¦‚æžœ job çš„æ¯ä¸ª map æˆ–è€… reduce task çš„è¿è¡Œæ—¶é—´éƒ½åªæœ‰ 30-40 ç§’é’Ÿï¼Œé‚£ä¹ˆå°±å‡å°‘è¯¥ job çš„ map æˆ–è€… reduce æ•°ï¼Œæ¯ä¸€ä¸ª task(map|reduce)çš„ setup å’ŒåŠ å…¥åˆ°è°ƒåº¦å™¨ä¸­è¿›è¡Œè°ƒåº¦ï¼Œè¿™ä¸ª ä¸­é—´çš„è¿‡ç¨‹å¯èƒ½éƒ½è¦èŠ±è´¹å‡ ç§’é’Ÿï¼Œæ‰€ä»¥å¦‚æžœæ¯ä¸ª task éƒ½éžå¸¸å¿«å°±è·‘å®Œäº†ï¼Œå°±ä¼šåœ¨ task çš„å¼€ å§‹å’Œç»“æŸçš„æ—¶å€™æµªè´¹å¤ªå¤šçš„æ—¶é—´ã€‚ é…ç½® task çš„ JVM é‡ç”¨å¯ä»¥æ”¹å–„è¯¥é—®é¢˜ï¼š mapred.job.reuse.jvm.num.tasksï¼Œé»˜è®¤æ˜¯ 1ï¼Œè¡¨ç¤ºä¸€ä¸ª JVM ä¸Šæœ€å¤šå¯ä»¥é¡ºåºæ‰§è¡Œçš„ task æ•°ç›®ï¼ˆå±žäºŽåŒä¸€ä¸ª Jobï¼‰æ˜¯ 1ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ª task å¯ä¸€ä¸ª JVMã€‚ è¿™ä¸ªå€¼å¯ä»¥åœ¨ mapred-site.xml ä¸­è¿›è¡Œæ›´æ”¹ï¼Œå½“è®¾ç½®æˆå¤šä¸ªï¼Œå°±æ„å‘³ç€è¿™å¤šä¸ª task è¿è¡Œåœ¨åŒä¸€ä¸ª JVM ä¸Šï¼Œä½†ä¸æ˜¯åŒæ—¶æ‰§è¡Œï¼Œ æ˜¯æŽ’é˜Ÿé¡ºåºæ‰§è¡Œ å¦‚æžœ input çš„æ–‡ä»¶éžå¸¸çš„å¤§ï¼Œæ¯”å¦‚ 1TBï¼Œå¯ä»¥è€ƒè™‘å°† hdfs ä¸Šçš„æ¯ä¸ª blocksize è®¾å¤§ï¼Œæ¯”å¦‚ è®¾æˆ 256MB æˆ–è€… 512MB 2.6ã€ReduceTask å¹¶è¡Œåº¦å†³å®šæœºåˆ¶reducetask çš„å¹¶è¡Œåº¦åŒæ ·å½±å“æ•´ä¸ª job çš„æ‰§è¡Œå¹¶å‘åº¦å’Œæ‰§è¡Œæ•ˆçŽ‡ï¼Œä½†ä¸Ž maptask çš„å¹¶å‘æ•°ç”± åˆ‡ç‰‡æ•°å†³å®šä¸åŒï¼ŒReducetask æ•°é‡çš„å†³å®šæ˜¯å¯ä»¥ç›´æŽ¥æ‰‹åŠ¨è®¾ç½®ï¼š 12// è®¾ç½® ReduceTask çš„å¹¶è¡Œåº¦job.setNumReduceTasks(4); é»˜è®¤å€¼æ˜¯ 1ï¼Œ æ‰‹åŠ¨è®¾ç½®ä¸º 4ï¼Œè¡¨ç¤ºè¿è¡Œ 4 ä¸ª reduceTaskï¼Œ è®¾ç½®ä¸º 0ï¼Œè¡¨ç¤ºä¸è¿è¡Œ reduceTask ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ reducer é˜¶æ®µï¼Œåªæœ‰ mapper é˜¶æ®µ å¦‚æžœæ•°æ®åˆ†å¸ƒä¸å‡åŒ€ï¼Œå°±æœ‰å¯èƒ½åœ¨ reduce é˜¶æ®µäº§ç”Ÿæ•°æ®å€¾æ–œ æ³¨æ„ï¼šreducetask æ•°é‡å¹¶ä¸æ˜¯ä»»æ„è®¾ç½®ï¼Œè¿˜è¦è€ƒè™‘ä¸šåŠ¡é€»è¾‘éœ€æ±‚ï¼Œæœ‰äº›æƒ…å†µä¸‹ï¼Œéœ€è¦è®¡ç®—å…¨å±€æ±‡æ€»ç»“æžœï¼Œå°±åªèƒ½æœ‰ 1 ä¸ª reducetask å°½é‡ä¸è¦è¿è¡Œå¤ªå¤šçš„ reducetaskã€‚å¯¹å¤§å¤šæ•° job æ¥è¯´ï¼Œæœ€å¥½ rduce çš„ä¸ªæ•°æœ€å¤šå’Œé›†ç¾¤ä¸­çš„ reduce æŒå¹³ï¼Œæˆ–è€…æ¯”é›†ç¾¤çš„ reduce slots å°ã€‚è¿™ä¸ªå¯¹äºŽå°é›†ç¾¤è€Œè¨€ï¼Œå°¤å…¶é‡è¦ã€‚ æœ€å¥½çš„ReduceTask ä¸ªæ•°æ˜¯ï¼šdatanode ä¸ªæ•° * 0.75~0.95 å·¦å³ 2.7 å®¢æˆ·ç«¯æäº¤ MR ç¨‹åº Job çš„æµç¨‹ 3. æ˜¨æ—¥å¤ä¹ 1.MapReduce çš„ wc ç¼–ç¨‹ æ‰‹å†™ä»£ç  Mapper Reducer Driver 2.MapTask çš„å¹¶è¡Œåº¦ åœ¨ç¨‹åºæ‰§è¡Œçš„æ—¶å€™è¿è¡Œçš„ maptask çš„æ€»ä¸ªæ•° 3.ReduceTaskçš„å¹¶è¡Œåº¦é—®é¢˜ ReduceTask çš„å¹¶è¡Œåº¦è®¾ç½®ä¾èµ–äºŽè‡ªå·±ä¼ å…¥çš„å‚æ•° ä¸€èˆ¬ç»éªŒï¼š ReduceTask çš„ä¸ªæ•°åº”è¯¥ = datanode çš„é˜¶æ®µæ•° * ï¼ˆ0.75~0.95ï¼‰ ReduceTask åœ¨è®¾ç½®çš„æ—¶å€™çš„å¹¶è¡Œåº¦æœ‰ä¸€å®šçš„ç“¶é¢ˆ åˆ†åŒºï¼š å†³å®š ReduceTask ä¸­çš„æ•°æ®æ€Žä¹ˆåˆ†é…çš„ é»˜è®¤åˆ†åŒºæ–¹å¼ è‡ªå®šä¹‰åˆ†åŒº]]></content>
      <categories>
        <category>Hadoop</category>
        <category>MapReduce</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>MapReduce</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[â–Do Not Go Gentle into That Good Night]]></title>
    <url>%2F2018%2F06%2F04%2FPoetry%2F%E4%B8%8D%E8%A6%81%E6%B8%A9%E5%92%8C%E7%9A%84%E8%B5%B0%E8%BF%9B%E9%82%A3%E4%B8%AA%E8%89%AF%E5%A4%9C%2F</url>
    <content type="text"><![CDATA[Do not go gentle into that good night, Old age should burn and rave at close of the day; Rage, rage against the dying of the light. Though wise men at their end know dark is right, Because their words had forked no lightning they Do not go gentle into that good night. Good men, the last wave by, crying how bright Their frail deeds might have danced in a green bay, Rage, rage against the dying of the light. Wild men, who caught and sang the sun in flight, And learn, too late, they grieved it on its way, Do not go gentle into that good night. Grave men, near death, who see with blinding sight Blind eyes could blaze like meteors and be gay, Rage, rage against the dying of the light. And you, my father, there on the sad height, Curse, bless, me now with your fierce tears, I pray. Do not go gentle into that good night. Rage, rage against the dying of the light. ã€Šä¸è¦æ¸©å’Œåœ°èµ°è¿›é‚£ä¸ªè‰¯å¤œã€‹ -å·«å®å¤è¯‘æœ¬ â€‹ ä¸è¦æ¸©å’Œåœ°èµ°è¿›é‚£ä¸ªè‰¯å¤œï¼Œ è€å¹´åº”å½“åœ¨æ—¥æš®æ—¶ç‡ƒçƒ§å’†å“®ï¼› æ€’æ–¥ï¼Œæ€’æ–¥å…‰æ˜Žçš„æ¶ˆé€ã€‚ è™½ç„¶æ™ºæ…§çš„äººä¸´ç»ˆæ—¶æ‡‚å¾—é»‘æš—æœ‰ç†ï¼Œ å› ä¸ºä»–ä»¬çš„è¯æ²¡æœ‰è¿›å‘å‡ºé—ªç”µï¼Œä»–ä»¬ ä¹Ÿå¹¶ä¸æ¸©å’Œåœ°èµ°è¿›é‚£ä¸ªè‰¯å¤œã€‚ å–„è‰¯çš„äººï¼Œå½“æœ€åŽä¸€æµªè¿‡åŽ»ï¼Œé«˜å‘¼ä»–ä»¬è„†å¼±çš„å–„è¡Œ å¯èƒ½æ›¾ä¼šå¤šä¹ˆå…‰è¾‰åœ°åœ¨ç»¿è‰²çš„æµ·æ¹¾é‡Œèˆžè¹ˆï¼Œ æ€’æ–¥ï¼Œæ€’æ–¥å…‰æ˜Žçš„æ¶ˆé€ã€‚ ç‹‚æš´çš„äººæŠ“ä½å¹¶æ­Œå”±è¿‡ç¿±ç¿”çš„å¤ªé˜³ï¼Œ æ‡‚å¾—ï¼Œä½†ä¸ºæ—¶å¤ªæ™šï¼Œä»–ä»¬ä½¿å¤ªé˜³åœ¨é€”ä¸­æ‚²ä¼¤ï¼Œ ä¹Ÿå¹¶ä¸æ¸©å’Œåœ°èµ°è¿›é‚£ä¸ªè‰¯å¤œã€‚ ä¸¥è‚ƒçš„äººï¼ŒæŽ¥è¿‘æ­»äº¡ï¼Œç”¨ç‚«ç›®çš„è§†è§‰çœ‹å‡º å¤±æ˜Žçš„è·Ÿç›å¯ä»¥åƒæµæ˜Ÿä¸€æ ·é—ªè€€æ¬¢æ¬£ï¼Œ æ€’æ–¥ï¼Œæ•æ–¥å…‰æ˜Žçš„æ¶ˆé€ã€‚ æ‚¨å•Šï¼Œæˆ‘çš„çˆ¶äº²ï¼Œåœ¨é‚£æ‚²å“€çš„é«˜å¤„ã€‚ çŽ°åœ¨ç”¨æ‚¨çš„çƒ­æ³ªè¯…å’’æˆ‘ï¼Œç¥ç¦æˆ‘å§ã€‚æˆ‘æ±‚æ‚¨ ä¸è¦æ¸©å’Œåœ°èµ°è¿›é‚£ä¸ªè‰¯å¤œã€‚ æ€’æ–¥ï¼Œæ€’æ–¥å…‰æ˜Žçš„æ¶ˆé€ ã€Šä¸è¦æ¸©é¡ºåœ°èµ°å…¥é‚£é•¿å¤œã€‹ -å’Œèœå¤´è¯‘æœ¬ ç™½æ—¥å°†å°½ï¼Œæš®å¹´ä»åº”ç‡ƒçƒ§å’†å“® ç‹‚æ€’å§ï¼Œç‹‚æ€’å§ï¼ å¯¹æŠ—ç€å…‰æ˜Žæ¸é€ è™½ç„¶æ™ºè€…æ·±çŸ¥ äººä¹‹å°†æ­»ï¼Œé»‘æš—è‡ªæœ‰å…¶æ—¶ åªå› ä»–ä»¬æ‰€è¨€æœªæ›¾è£‚å¤©å¦‚ç”µ ä»–ä»¬ä¸è¦æ¸©é¡ºåœ°èµ°å…¥é‚£é•¿å¤œ éšç€æœ€åŽä¸€æµªï¼Œå–„äººåœ¨å“­å–Š å“­å–Šé‚£è„†å¼±çš„å–„è¡Œ å®ƒæœ¬åº”ä½•å…¶æ¬¢å¿« åœ¨ç»¿è‰²å³¡æ¹¾é‡Œèµ·èˆž ç‹‚æ€’å§ï¼Œç‹‚æ€’å§ï¼ å¯¹æŠ—ç€å…‰æ˜Žæ¸é€ã€‚ ç‹‚äººæ›¾æŠ“ä½é£žé©°çš„å¤ªé˜³ æ”¾å£°æ­Œå”± å¤ªæ™šï¼Œä»–ä»¬æ‰æ„Ÿåˆ°å…¶ä¸­çš„ä¼¤æ„Ÿ ä¸è¦æ¸©é¡ºåœ°èµ°è¿›é‚£é•¿å¤œ ä¸¥è‚ƒçš„äººè¡Œå°†æ­»åŽ»æ—¶ ç”¨é‚£æ¸æ¸å¤±ç¥žçš„ç›®å…‰åŽ»çœ‹ ç›²çž³å´å¦‚æµæ˜Ÿç’€ç’¨ï¼Œæ¬¢æ¬£æº¢æ»¡ ç‹‚æ€’å§ï¼Œç‹‚æ€’å§ï¼ å¯¹æŠ—ç€å…‰æ˜Žæ¸é€ è¿˜æœ‰ä½ å•Šï¼Œæˆ‘çš„çˆ¶äº²ï¼Œè¿œåœ¨æ‚²ä¼¤çš„é«˜åœ° æˆ‘æ³è¯·ä½ çŽ°åœ¨ å°±è®©ä½ è¯…å’’ï¼Œä½ çš„ç¥ç¦ éšç€çƒ­æ³ªè½ä¸‹ ä¸è¦æ¸©é¡ºåœ°èµ°è¿›é‚£é•¿å¤œ ç‹‚æ€’å§ï¼Œç‹‚æ€’å§ï¼ å¯¹æŠ—è¿™å…‰æ˜Žæ¸é€ â€‹ ã€Š ç»ä¸å‘é»‘å¤œè¯·å®‰ã€‹ -é«˜æ™“æ¾è¯‘æœ¬ ç»ä¸å‘é»‘å¤œè¯·å®‰ è€æœ½è¯·äºŽç™½æ—¥å°½å¤´æ¶…æ§ƒ å’†å“®äºŽå…‰ä¹‹æ¶ˆæ•£ å…ˆå“²è™½è´¥äºŽå¹½æš— è¯—æ­Œç»ˆä¸èƒ½å°†è‹ç©¹ç‚¹ç‡ƒ ç»ä¸å‘é»‘å¤œè¯·å®‰ è´¤è€…èˆžè¹ˆäºŽç¢§æ¹¾ ä¸ºæƒŠæ¶›æ·¹æ²¡çš„å–„è¡Œå“­å–Š å’†å“®äºŽå…‰ä¹‹æ¶ˆæ•£ ç‹‚è€…å¦‚å¤¸çˆ¶é€æ—¥ é«˜æ­Œä¸­é¡¿è§‰è¿Ÿæ¥çš„ä¼¤æ„Ÿ ç»ä¸å‘é»‘å¤œè¯·å®‰ é€è€…äºŽä¸´ç»ˆè¿·å¹» ç›²çž³æ€’æ”¾å‡ºæµæ˜Ÿçš„ç¿çƒ‚ å’†å“®äºŽå…‰ä¹‹æ¶ˆæ•£ é‚£ä¹ˆæ‚¨ï¼Œæˆ‘åž‚åž‚å°†æ­»çš„çˆ¶äº² è¯·æŽ¬æœ€åŽä¸€æ§çƒ­æ³ªé™ä¸´ è¯·è¯…å’’ï¼Œè¯·ä¿ä½‘ æˆ‘ç¥ˆæ„¿ï¼Œç»ä¸å‘ é»‘å¤œè¯·å®‰ï¼Œå’†å“® äºŽå…‰ä¹‹æ¶ˆæ•£]]></content>
      <categories>
        <category>æ–‡è‰º</category>
        <category>è¯—æ­Œ</category>
      </categories>
      <tags>
        <tag>è¯—æ­Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoopå­¦ä¹ ç¬”è®°-3 HDFS åŽŸç†å‰–æž]]></title>
    <url>%2F2018%2F06%2F03%2FHadoop%2F1-HDFS%2FHDFS-2-%E5%8E%9F%E7%90%86%E5%89%96%E6%9E%90%2F</url>
    <content type="text"><![CDATA[1. HDFSä½“ç³»ç»“æž„ä¸»ä»Žã€‚ã€‚ã€‚ 2.NameNodeæ¦‚å¿µ [x] æ˜¯æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ç®¡ç†èŠ‚ç‚¹ã€‚å®ƒç»´æŠ¤ç€æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ç›®å½•æ ‘ï¼Œæ–‡ä»¶/ç›®å½•çš„å…ƒä¿¡æ¯å’Œæ¯ä¸ªæ–‡ä»¶å¯¹åº”çš„æ•°æ®å—åˆ—è¡¨ã€‚æŽ¥æ”¶ç”¨æˆ·çš„æ“ä½œè¯·æ±‚ã€‚ [x] åœ¨hdfs-site.xmlä¸­çš„dfs.namenode.name.dirå±žæ€§ [x] æ–‡ä»¶åŒ…æ‹¬ï¼š [x] æ–‡ä»¶åŒ…æ‹¬: â‘ fsimage:å…ƒæ•°æ®é•œåƒæ–‡ä»¶ã€‚å­˜å‚¨æŸä¸€æ—¶æ®µNameNodeå†…å­˜å…ƒæ•°æ®ä¿¡æ¯ã€‚ â‘¡edits:æ“ä½œæ—¥å¿—æ–‡ä»¶ã€‚ â‘¢fstime:ä¿å­˜æœ€è¿‘ä¸€æ¬¡checkpointçš„æ—¶é—´ ä»¥ä¸Šè¿™äº›æ–‡ä»¶æ˜¯ä¿å­˜åœ¨linuxçš„æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ æŸ¥çœ‹ fsimage å’Œ editsçš„å†…å®¹ æŸ¥çœ‹ NameNodeä¸­ fsimage çš„å†…å®¹ æŸ¥çœ‹ fsimageé•œåƒæ–‡ä»¶å†…å®¹Usage: bin/hdfs oiv [OPTIONS] -i INPUTFILE -o OUTPUTFILE 1234567891011121314# å¯ä»¥çŸ¥é“æ•°æ®å­˜åœ¨é‚£ä¸ªå“ªä¸ª fsimage é•œåƒä¸­------------------------------------# ä½¿ç”¨ç¦»çº¿çš„æŸ¥çœ‹å™¨ è¾“å‡ºåˆ°ç½‘é¡µæŸ¥çœ‹oiv -i hadoopdata/namenode/current/fsimage_0000000000000000250 -o 0000000000000000250# å‡ºçŽ°è¿™æ ·çš„æç¤ºINFO offlineImageViewer.WebImageViewer: WebImageViewer started. Listening on /127.0.0.1:5978. Press Ctrl+C to stop the viewer.# å¦èµ·ä¸€ä¸ªçª—å£æŸ¥çœ‹hadoop fs -ls -R webhdfs://127.0.0.1:5978------------------------------------# ä¹Ÿå¯ä»¥å¯¼å‡ºåˆ° xml æ–‡ä»¶bin/hdfs oiv -p XML -i tmp/dfs/name/current/fsimage_0000000000000000055 -o fsimage.xml æŸ¥çœ‹editsæ–‡ä»¶ï¼Œ ä¹Ÿå¯ä»¥å¯¼å‡ºåˆ° xml 12# æŸ¥çœ‹edtiså†…å®¹bin/hdfs oev -i tmp/dfs/name/current/edits_0000000000000000057-0000000000000000186 -o edits.xml 3. Datanodeæä¾›çœŸå®žæ–‡ä»¶æ•°æ®çš„å­˜å‚¨æœåŠ¡ Datanode èŠ‚ç‚¹çš„æ•°æ®åˆ‡å—å­˜å‚¨ä½ç½® ~/hadoopdata/datanode/current/BP-1070660005-192.168.170.131-1527865615372/current/finalized/subdir0/subdir0 12345678[ap@cs2]~/hadoopdata/datanode/current/BP-1070660005-192.168.170.131-1527865615372/current/finalized/subdir0/subdir0% llæ€»ç”¨é‡ 213340-rw-r--r-- 1 ap ap 134217728 6æœˆ 2 13:35 blk_1073741842-rw-r--r-- 1 ap ap 1048583 6æœˆ 2 13:35 blk_1073741842_1018.meta-rw-r--r-- 1 ap ap 82527955 6æœˆ 2 13:35 blk_1073741843-rw-r--r-- 1 ap ap 644759 6æœˆ 2 13:35 blk_1073741843_1019.meta-rw-r--r-- 1 ap ap 13 6æœˆ 3 02:12 blk_1073741850-rw-r--r-- 1 ap ap 11 6æœˆ 3 02:12 blk_1073741850_1028.meta æ–‡ä»¶å—ï¼ˆblockï¼‰ï¼šæœ€åŸºæœ¬çš„å­˜å‚¨å•ä½ã€‚å¯¹äºŽæ–‡ä»¶å†…å®¹è€Œè¨€ï¼Œä¸€ä¸ªæ–‡ä»¶çš„é•¿åº¦å¤§å°æ˜¯sizeï¼Œé‚£ä¹ˆä»Žæ–‡ä»¶çš„ï¼åç§»å¼€å§‹ï¼ŒæŒ‰ç…§å›ºå®šçš„å¤§å°ï¼Œé¡ºåºå¯¹æ–‡ä»¶è¿›è¡Œåˆ’åˆ†å¹¶ç¼–å·ï¼Œåˆ’åˆ†å¥½çš„æ¯ä¸€ä¸ªå—ç§°ä¸€ä¸ªBlockã€‚HDFSé»˜è®¤Blockå¤§å°æ˜¯128MBï¼Œä»¥ä¸€ä¸ª256MBæ–‡ä»¶ï¼Œå…±æœ‰256/128=2ä¸ªBlock. ä¸åŒäºŽæ™®é€šæ–‡ä»¶ç³»ç»Ÿçš„æ˜¯ï¼ŒHDFSä¸­ï¼Œå¦‚æžœä¸€ä¸ªæ–‡ä»¶å°äºŽä¸€ä¸ªæ•°æ®å—çš„å¤§å°ï¼Œå¹¶ä¸å ç”¨æ•´ä¸ªæ•°æ®å—å­˜å‚¨ç©ºé—´, æŒ‰æ–‡ä»¶å¤§å°çš„å®žé™…å®¹é‡å­˜å‚¨ Replicationã€‚å¤šå¤æœ¬ã€‚é»˜è®¤æ˜¯ä¸‰ä¸ªã€‚ hdfs-site.xmlçš„dfs.replicationå±žæ€§ æ‰‹åŠ¨è®¾ç½®æŸä¸ªæ–‡ä»¶çš„å‰¯æœ¬æ•°ä¸º3ä¸ª bin/hdfs dfs -setrep 3 /a.txt 4. æ•°æ®å­˜å‚¨ï¼š å†™æ–‡ä»¶è§£æž [x] ç–‘ç‚¹ï¼š HDFS clientä¸Šä¼ æ•°æ®åˆ°HDFSæ—¶ï¼Œä¼šé¦–å…ˆåœ¨æœ¬åœ°ç¼“å­˜æ•°æ®ï¼Œå½“æ•°æ®è¾¾åˆ°ä¸€ä¸ªblockå¤§å°æ—¶ï¼Œè¯·æ±‚NameNodeåˆ†é…ä¸€ä¸ªblockã€‚NameNodeä¼šæŠŠblockæ‰€åœ¨çš„DataNodeçš„åœ°å€å‘Šè¯‰HDFS clientã€‚HDFS clientä¼šç›´æŽ¥å’ŒDataNodeé€šä¿¡ï¼ŒæŠŠæ•°æ®å†™åˆ°DataNodeèŠ‚ç‚¹ä¸€ä¸ªblockæ–‡ä»¶ä¸­ã€‚ é—®é¢˜ï¼š å¦‚æžœä¸€ç›´å†™çš„æ•°æ®éƒ½æ²¡æœ‰è¾¾åˆ°ä¸€ä¸ª block å¤§å°ï¼Œ é‚£æ€Žä¹ˆå­˜å‚¨ï¼Ÿï¼Ÿ å†™æ–‡ä»¶çš„è¿‡ç¨‹ï¼š é¦–å…ˆè°ƒç”¨FileSystemå¯¹è±¡çš„openæ–¹æ³•ï¼Œå…¶å®žæ˜¯ä¸€ä¸ªDistributedFileSystemçš„å®žä¾‹ DistributedFileSystemé€šè¿‡rpcèŽ·å¾—æ–‡ä»¶çš„ç¬¬ä¸€æ‰¹ä¸ªblockçš„locationsï¼ŒåŒä¸€blockæŒ‰ç…§é‡å¤æ•°ä¼šè¿”å›žå¤šä¸ªlocationsï¼Œè¿™äº›locationsæŒ‰ç…§hadoopæ‹“æ‰‘ç»“æž„æŽ’åºï¼Œè·ç¦»å®¢æˆ·ç«¯è¿‘çš„æŽ’åœ¨å‰é¢. å‰ä¸¤æ­¥ä¼šè¿”å›žä¸€ä¸ªFSDataInputStreamå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šè¢«å°è£…æˆDFSInputStreamå¯¹è±¡ï¼ŒDFSInputStreamå¯ä»¥æ–¹ä¾¿çš„ç®¡ç†datanodeå’Œnamenodeæ•°æ®æµã€‚å®¢æˆ·ç«¯è°ƒç”¨readæ–¹æ³•ï¼ŒDFSInputStreamæœ€ä¼šæ‰¾å‡ºç¦»å®¢æˆ·ç«¯æœ€è¿‘çš„datanodeå¹¶è¿žæŽ¥ã€‚ æ•°æ®ä»Ždatanodeæºæºä¸æ–­çš„æµå‘å®¢æˆ·ç«¯ã€‚ å¦‚æžœç¬¬ä¸€å—çš„æ•°æ®è¯»å®Œäº†ï¼Œå°±ä¼šå…³é—­æŒ‡å‘ç¬¬ä¸€å—çš„datanodeè¿žæŽ¥ï¼ŒæŽ¥ç€è¯»å–ä¸‹ä¸€å—ã€‚è¿™äº›æ“ä½œå¯¹å®¢æˆ·ç«¯æ¥è¯´æ˜¯é€æ˜Žçš„ï¼Œå®¢æˆ·ç«¯çš„è§’åº¦çœ‹æ¥åªæ˜¯è¯»ä¸€ä¸ªæŒç»­ä¸æ–­çš„æµã€‚ å¦‚æžœç¬¬ä¸€æ‰¹blockéƒ½è¯»å®Œäº†ï¼ŒDFSInputStreamå°±ä¼šåŽ»namenodeæ‹¿ä¸‹ä¸€æ‰¹blocksçš„locationï¼Œç„¶åŽç»§ç»­è¯»ï¼Œå¦‚æžœæ‰€æœ‰çš„å—éƒ½è¯»å®Œï¼Œè¿™æ—¶å°±ä¼šå…³é—­æŽ‰æ‰€æœ‰çš„æµã€‚ å¦‚æžœåœ¨è¯»æ•°æ®çš„æ—¶å€™ï¼ŒDFSInputStreamå’Œdatanodeçš„é€šè®¯å‘ç”Ÿå¼‚å¸¸ï¼Œå°±ä¼šå°è¯•æ­£åœ¨è¯»çš„blockçš„æŽ’ç¬¬äºŒè¿‘çš„datanode,å¹¶ä¸”ä¼šè®°å½•å“ªä¸ªdatanodeå‘ç”Ÿé”™è¯¯ï¼Œå‰©ä½™çš„blocksè¯»çš„æ—¶å€™å°±ä¼šç›´æŽ¥è·³è¿‡è¯¥datanodeã€‚DFSInputStreamä¹Ÿä¼šæ£€æŸ¥blockæ•°æ®æ ¡éªŒå’Œï¼Œå¦‚æžœå‘çŽ°ä¸€ä¸ªåçš„block,å°±ä¼šå…ˆæŠ¥å‘Šåˆ°namenodeèŠ‚ç‚¹ï¼Œç„¶åŽDFSInputStreamåœ¨å…¶ä»–çš„datanodeä¸Šè¯»è¯¥blockçš„é•œåƒ è¯¥è®¾è®¡çš„æ–¹å‘å°±æ˜¯å®¢æˆ·ç«¯ç›´æŽ¥è¿žæŽ¥datanodeæ¥æ£€ç´¢æ•°æ®å¹¶ä¸”namenodeæ¥è´Ÿè´£ä¸ºæ¯ä¸€ä¸ªblockæä¾›æœ€ä¼˜çš„datanodeï¼Œnamenodeä»…ä»…å¤„ç†block locationçš„è¯·æ±‚ï¼Œè¿™äº›ä¿¡æ¯éƒ½åŠ è½½åœ¨namenodeçš„å†…å­˜ä¸­ï¼Œhdfsé€šè¿‡datanodeé›†ç¾¤å¯ä»¥æ‰¿å—å¤§é‡å®¢æˆ·ç«¯çš„å¹¶å‘è®¿é—®ã€‚ 5. æ•°æ®å­˜å‚¨ï¼š è¯»æ–‡ä»¶è§£æž è¯»æ–‡ä»¶çš„è¿‡ç¨‹ é¦–å…ˆè°ƒç”¨FileSystemå¯¹è±¡çš„openæ–¹æ³•ï¼Œå…¶å®žæ˜¯ä¸€ä¸ªDistributedFileSystemçš„å®žä¾‹ DistributedFileSystemé€šè¿‡rpcèŽ·å¾—æ–‡ä»¶çš„ç¬¬ä¸€æ‰¹ä¸ªblockçš„locationsï¼ŒåŒä¸€blockæŒ‰ç…§é‡å¤æ•°ä¼šè¿”å›žå¤šä¸ªlocationsï¼Œè¿™äº›locationsæŒ‰ç…§hadoopæ‹“æ‰‘ç»“æž„æŽ’åºï¼Œè·ç¦»å®¢æˆ·ç«¯è¿‘çš„æŽ’åœ¨å‰é¢. å‰ä¸¤æ­¥ä¼šè¿”å›žä¸€ä¸ªFSDataInputStreamå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šè¢«å°è£…æˆDFSInputStreamå¯¹è±¡ï¼ŒDFSInputStreamå¯ä»¥æ–¹ä¾¿çš„ç®¡ç†datanodeå’Œnamenodeæ•°æ®æµã€‚å®¢æˆ·ç«¯è°ƒç”¨readæ–¹æ³•ï¼ŒDFSInputStreamæœ€ä¼šæ‰¾å‡ºç¦»å®¢æˆ·ç«¯æœ€è¿‘çš„datanodeå¹¶è¿žæŽ¥ã€‚ æ•°æ®ä»Ždatanodeæºæºä¸æ–­çš„æµå‘å®¢æˆ·ç«¯ã€‚ å¦‚æžœç¬¬ä¸€å—çš„æ•°æ®è¯»å®Œäº†ï¼Œå°±ä¼šå…³é—­æŒ‡å‘ç¬¬ä¸€å—çš„datanodeè¿žæŽ¥ï¼ŒæŽ¥ç€è¯»å–ä¸‹ä¸€å—ã€‚è¿™äº›æ“ä½œå¯¹å®¢æˆ·ç«¯æ¥è¯´æ˜¯é€æ˜Žçš„ï¼Œå®¢æˆ·ç«¯çš„è§’åº¦çœ‹æ¥åªæ˜¯è¯»ä¸€ä¸ªæŒç»­ä¸æ–­çš„æµã€‚ å¦‚æžœç¬¬ä¸€æ‰¹blockéƒ½è¯»å®Œäº†ï¼ŒDFSInputStreamå°±ä¼šåŽ»namenodeæ‹¿ä¸‹ä¸€æ‰¹blocksçš„locationï¼Œç„¶åŽç»§ç»­è¯»ï¼Œå¦‚æžœæ‰€æœ‰çš„å—éƒ½è¯»å®Œï¼Œè¿™æ—¶å°±ä¼šå…³é—­æŽ‰æ‰€æœ‰çš„æµã€‚ å¦‚æžœåœ¨è¯»æ•°æ®çš„æ—¶å€™ï¼ŒDFSInputStreamå’Œdatanodeçš„é€šè®¯å‘ç”Ÿå¼‚å¸¸ï¼Œå°±ä¼šå°è¯•æ­£åœ¨è¯»çš„blockçš„æŽ’ç¬¬äºŒè¿‘çš„datanode,å¹¶ä¸”ä¼šè®°å½•å“ªä¸ªdatanodeå‘ç”Ÿé”™è¯¯ï¼Œå‰©ä½™çš„blocksè¯»çš„æ—¶å€™å°±ä¼šç›´æŽ¥è·³è¿‡è¯¥datanodeã€‚DFSInputStreamä¹Ÿä¼šæ£€æŸ¥blockæ•°æ®æ ¡éªŒå’Œï¼Œå¦‚æžœå‘çŽ°ä¸€ä¸ªåçš„block,å°±ä¼šå…ˆæŠ¥å‘Šåˆ°namenodeèŠ‚ç‚¹ï¼Œç„¶åŽDFSInputStreamåœ¨å…¶ä»–çš„datanodeä¸Šè¯»è¯¥blockçš„é•œåƒ è¯¥è®¾è®¡çš„æ–¹å‘å°±æ˜¯å®¢æˆ·ç«¯ç›´æŽ¥è¿žæŽ¥datanodeæ¥æ£€ç´¢æ•°æ®å¹¶ä¸”namenodeæ¥è´Ÿè´£ä¸ºæ¯ä¸€ä¸ªblockæä¾›æœ€ä¼˜çš„datanodeï¼Œnamenodeä»…ä»…å¤„ç†block locationçš„è¯·æ±‚ï¼Œè¿™äº›ä¿¡æ¯éƒ½åŠ è½½åœ¨namenodeçš„å†…å­˜ä¸­ï¼Œhdfsé€šè¿‡datanodeé›†ç¾¤å¯ä»¥æ‰¿å—å¤§é‡å®¢æˆ·ç«¯çš„å¹¶å‘è®¿é—®ã€‚ 6.Hadoop Archives ï¼ˆHAR filesï¼‰Hadoop Archives (HAR files)æ˜¯åœ¨0.18.0ç‰ˆæœ¬ä¸­å¼•å…¥çš„ï¼Œå®ƒçš„å‡ºçŽ°å°±æ˜¯ä¸ºäº†ç¼“è§£å¤§é‡å°æ–‡ä»¶æ¶ˆè€—namenodeå†…å­˜çš„é—®é¢˜ã€‚HARæ–‡ä»¶æ˜¯é€šè¿‡åœ¨HDFSä¸Šæž„å»ºä¸€ä¸ªå±‚æ¬¡åŒ–çš„æ–‡ä»¶ç³»ç»Ÿæ¥å·¥ä½œã€‚ä¸€ä¸ªHARæ–‡ä»¶æ˜¯é€šè¿‡hadoopçš„archiveå‘½ä»¤æ¥åˆ›å»ºï¼Œè€Œè¿™ä¸ªå‘½ä»¤å®ž é™…ä¸Šä¹Ÿæ˜¯è¿è¡Œäº†ä¸€ä¸ªMapReduceä»»åŠ¡æ¥å°†å°æ–‡ä»¶æ‰“åŒ…æˆHARã€‚å¯¹äºŽclientç«¯æ¥è¯´ï¼Œä½¿ç”¨HARæ–‡ä»¶æ²¡æœ‰ä»»ä½•å½±å“ã€‚æ‰€æœ‰çš„åŽŸå§‹æ–‡ä»¶éƒ½ ï¼ˆusing har://URLï¼‰ã€‚ä½†åœ¨HDFSç«¯å®ƒå†…éƒ¨çš„æ–‡ä»¶æ•°å‡å°‘äº†ã€‚ é€šè¿‡HARæ¥è¯»å–ä¸€ä¸ªæ–‡ä»¶å¹¶ä¸ä¼šæ¯”ç›´æŽ¥ä»ŽHDFSä¸­è¯»å–æ–‡ä»¶é«˜æ•ˆï¼Œè€Œä¸”å®žé™…ä¸Šå¯èƒ½è¿˜ä¼šç¨å¾®ä½Žæ•ˆä¸€ç‚¹ï¼Œå› ä¸ºå¯¹æ¯ä¸€ä¸ªHARæ–‡ä»¶çš„è®¿é—®éƒ½éœ€è¦å®Œæˆä¸¤å±‚ indexæ–‡ä»¶çš„è¯»å–å’Œæ–‡ä»¶æœ¬èº«æ•°æ®çš„è¯»å–ã€‚å¹¶ä¸”å°½ç®¡HARæ–‡ä»¶å¯ä»¥è¢«ç”¨æ¥ä½œä¸ºMapReduce jobçš„inputï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç‰¹æ®Šçš„æ–¹æ³•æ¥ä½¿mapså°†HARæ–‡ä»¶ä¸­æ‰“åŒ…çš„æ–‡ä»¶å½“ä½œä¸€ä¸ªHDFSæ–‡ä»¶å¤„ç†ã€‚ æ‰“åŒ…å‡ºæ¥çš„ har æ–‡ä»¶åœ¨xxx.har/part-0 ä¸­ï¼Œ contentz-size è·ŸåŽŸæ¥çš„æ–‡ä»¶æ€»å¤§å°ä¸€æ · åˆ›å»ºæ–‡ä»¶ hadoop archive -archiveName xxx.har -p /src /destæŸ¥çœ‹å†…å®¹ hadoop fs -lsr har:///dest/xxx.har å¯ä»¥åŽŸå°ä¸åŠ¨çš„æ˜¾ç¤ºå‡ºæ¥ 123456789101112131415# æ‰“åŒ…æˆ harhadoop archive -archiveName test.har -p /user/test /# æŸ¥çœ‹har æ–‡ä»¶[ap@cs1]~% hadoop fs -count /test.har/part-0 0(ç›®å½•æ•°) 1(æ–‡ä»¶æ•°) 72(æ–‡ä»¶å¤§å°) /test.har/part-0 (æ–‡ä»¶å)# æŸ¥çœ‹æ‰“åŒ…å‰æ–‡ä»¶[ap@cs1]~% hadoop fs -count /user/test 1 2 72 /user/test # æŸ¥çœ‹ har æ–‡ä»¶ï¼Œ æŠŠæ‰“åŒ…å‰çš„åŽŸæœ¬æ–‡ä»¶éƒ½æ˜¾ç¤ºå‡ºæ¥äº†[ap@cs1]~% hadoop fs -ls -R har:///test.har-rw-r--r-- 3 ap supergroup 50 2018-06-03 04:24 har:///test.har/a.txt-rw-r--r-- 3 ap supergroup 22 2018-06-03 04:24 har:///test.har/b.txt æ³¨æ„ç‚¹ï¼š å­˜å‚¨å±‚é¢ï¼šä¸ºäº†è§£å†³å°æ–‡ä»¶è¿‡å¤šå¯¼è‡´çš„ Namenode åŽ‹åŠ›è¿‡å¤§é—®é¢˜ï¼Œ æŠŠå¾ˆå¤šå°æ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ª har æ–‡ä»¶ã€‚ ä½¿ç”¨å±‚é¢ï¼š ä½†æ˜¯å®žé™…å¤„ç†çš„æ—¶å€™ï¼Œ è¿˜æ˜¯ä¼šè¿˜åŽŸå‡ºåŽŸæœ¬çš„å°æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œ ä¸ä¼šæŠŠ har æ–‡ä»¶å½“æˆä¸€ä¸ª HDFS æ–‡ä»¶å¤„ç†ã€‚ HDFS ä¸Šä¸æ”¯æŒ tarï¼Œ åªæ”¯æŒ haræ‰“åŒ… 7.HDFS çš„ HA]]></content>
      <categories>
        <category>Hadoop</category>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>HDFS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[â–å›žç­”]]></title>
    <url>%2F2018%2F06%2F03%2FPoetry%2F%E5%9B%9E%E7%AD%94%2F</url>
    <content type="text"><![CDATA[å‘é„™æ˜¯å‘é„™è€…çš„é€šè¡Œè¯ï¼Œé«˜å°šæ˜¯é«˜å°šè€…çš„å¢“å¿—é“­ï¼Œçœ‹å§ï¼Œåœ¨é‚£é•€é‡‘çš„å¤©ç©ºä¸­ï¼Œé£˜æ»¡äº†æ­»è€…å¼¯æ›²çš„å€’å½±ã€‚ å†°å·çºªè¿‡åŽ»äº†ï¼Œä¸ºä»€ä¹ˆåˆ°å¤„éƒ½æ˜¯å†°å‡Œï¼Ÿå¥½æœ›è§’å‘çŽ°äº†ï¼Œä¸ºä»€ä¹ˆæ­»æµ·é‡Œåƒå¸†ç›¸ç«žï¼Ÿ æˆ‘æ¥åˆ°è¿™ä¸ªä¸–ç•Œä¸Šï¼Œåªå¸¦ç€çº¸ã€ç»³ç´¢å’Œèº«å½±ï¼Œä¸ºäº†åœ¨å®¡åˆ¤ä¹‹å‰ï¼Œå®£è¯»é‚£äº›è¢«åˆ¤å†³çš„å£°éŸ³ã€‚ å‘Šè¯‰ä½ å§ï¼Œä¸–ç•Œæˆ‘â€“ä¸â€“ç›¸â€“ä¿¡ï¼çºµä½¿ä½ è„šä¸‹æœ‰ä¸€åƒåæŒ‘æˆ˜è€…ï¼Œé‚£å°±æŠŠæˆ‘ç®—ä½œç¬¬ä¸€åƒé›¶ä¸€åã€‚ æˆ‘ä¸ç›¸ä¿¡å¤©æ˜¯è“çš„ï¼Œæˆ‘ä¸ç›¸ä¿¡é›·çš„å›žå£°ï¼Œæˆ‘ä¸ç›¸ä¿¡æ¢¦æ˜¯å‡çš„ï¼Œæˆ‘ä¸ç›¸ä¿¡æ­»æ— æŠ¥åº”ã€‚ å¦‚æžœæµ·æ´‹æ³¨å®šè¦å†³å ¤ï¼Œå°±è®©æ‰€æœ‰çš„è‹¦æ°´éƒ½æ³¨å…¥æˆ‘å¿ƒä¸­ï¼Œå¦‚æžœé™†åœ°æ³¨å®šè¦ä¸Šå‡ï¼Œå°±è®©äººç±»é‡æ–°é€‰æ‹©ç”Ÿå­˜çš„å³°é¡¶ã€‚ æ–°çš„è½¬æœºå’Œé—ªé—ªæ˜Ÿæ–—ï¼Œæ­£åœ¨ç¼€æ»¡æ²¡æœ‰é®æ‹¦çš„å¤©ç©ºã€‚é‚£æ˜¯äº”åƒå¹´çš„è±¡å½¢æ–‡å­—ï¼Œé‚£æ˜¯æœªæ¥äººä»¬å‡è§†çš„çœ¼ç›ã€‚ ä½œè€… / åŒ—å²›]]></content>
      <categories>
        <category>æ–‡è‰º</category>
        <category>è¯—æ­Œ</category>
      </categories>
      <tags>
        <tag>è¯—æ­Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoopå­¦ä¹ ç¬”è®°-2 HDFSåŸºç¡€å…¥é—¨]]></title>
    <url>%2F2018%2F06%2F02%2FHadoop%2F1-HDFS%2FHDFS-1-%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[Hadoopçš„æ ¸å¿ƒç»„ä»¶ ä¹‹ HDFSHDFS1. HDFSæ˜¯ä»€ä¹ˆ: åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ 2. HDFS è®¾è®¡æ€æƒ³ åˆ†è€Œæ²»ä¹‹, åˆ‡åˆ†å­˜å‚¨, å½“ä¸€ä¸ªæ–‡ä»¶è¿‡å¤§çš„æ—¶å€™, ä¸€ä¸ªèŠ‚ç‚¹å­˜å‚¨ä¸äº†, é‡‡ç”¨åˆ‡åˆ†å­˜å‚¨ åˆ†å—å­˜å‚¨: æ¯ä¸€ä¸ªå—å«åš block å¦‚æžœä¸€ä¸ª8Tçš„æ•°æ®, è¿™ä¸ªæ€Žä¹ˆåˆ†åˆé€‚??? è®¾ç½®åˆ†å—çš„æ—¶å€™è¦è€ƒè™‘ä¸€ä¸ªäº‹æƒ… : è´Ÿè½½å‡è¡¡ å—çš„å¤§å°ä¸èƒ½å¤ªå¤§, å¤ªå¤§ä¼šé€ æˆè´Ÿè½½ä¸å‡è¡¡ hadoop2.x ä¸­é»˜è®¤çš„åˆ‡åˆ†çš„å—çš„å¤§å°æ˜¯: 128M, 1.xä¸­é»˜è®¤çš„æ˜¯64M å¦‚æžœä¸€ä¸ªæ–‡ä»¶ä¸è¶³128M, ä¹Ÿä¼šå•ç‹¬å­˜ä¸€ä¸ªå¿«, å¿«çš„å¤§å°å°±æ˜¯å­˜å‚¨æ•°æ®çš„å®žé™…å¤§å° è¿™ä¸ªåˆ†å—å­˜å‚¨æ€æƒ³ä¸­, å¦‚æžœä¸€ä¸ªå—çš„å­˜å‚¨èŠ‚ç‚¹å®•æœºäº†, è¿™ä¸ªæ—¶å€™, æ•°æ®çš„å®‰å…¨æ€§å¾—ä¸åˆ°ä¿è¯äº† HDFSä¸­é»˜è®¤å—çš„å­˜å‚¨é‡‡ç”¨å¤‡ä»½æœºåˆ¶ é»˜è®¤çš„å¤‡ä»½ä¸ªæ•°æ˜¯3ä¸ª(æ€»å…±å­˜çš„, å­˜åˆ°datanodeä¸Šçš„, namenodeä¸å­˜), ä¹‹å‰è‡ªå·±é…çš„æ˜¯2ä¸ª, æ‰€æœ‰å¤‡ä»½ç›¸åŒåœ°ä½æ˜¯ç›¸åŒçš„. ç›¸åŒçš„æ•°æ®å—çš„å¤‡ä»½ä¸€å®šå­˜å‚¨åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Š å¦‚æžœèŠ‚ç‚¹æ€»å…±2ä¸ª, dfs.replication=3 å‰¯æœ¬ä¸ªæ•°æ˜¯3ä¸ª, å®žé™…å­˜å‚¨2ä¸ª, å¦ä¸€ä¸ªè¿›è¡Œè®°è´¦, å½“é›†ç¾¤èŠ‚ç‚¹ä¸ªæ•°å¤§äºŽ3ä¸ªæ—¶, ä¼šå¤åˆ¶è¿™ä¸ªå‰¯æœ¬, æœ€ç»ˆè¾¾åˆ°3ä¸ª å‡è®¾é›†ç¾¤ä¸­çš„èŠ‚ç‚¹4ä¸ª, å‰¯æœ¬3ä¸ª, æœ‰ä¸€ä¸ªå‰¯æœ¬çš„æœºå™¨å®•æœºäº†, è¿™ä¸ªæ—¶å€™å‘çŽ°å‰¯æœ¬çš„ä¸ªæ•° å°äºŽ è®¾å®šçš„ä¸ªæ•°, å°±ä¼šè¿›è¡Œå¤åˆ¶, è¾¾åˆ°3ä¸ªå‰¯æœ¬, å¦‚æžœ è¿™ä¸ªæ—¶å€™, åˆšæ‰å®•æœºçš„èŠ‚ç‚¹åˆæ¢å¤äº†, è¿™ä¸ªæ—¶å€™é›†ç¾¤å‰¯æœ¬ä¸ªæ•°ä¸º4äº†, é›†ç¾¤ä¼šç­‰å¾…ä¸€æ®µæ—¶é—´, å¦‚æžœå‘çŽ°è¿˜æ˜¯4ä¸ª, å°±ä¼šåˆ é™¤ä¸€ä¸ªå‰¯æœ¬, è¾¾åˆ°3ä¸ª(è®¾å®šå€¼) å¤‡ä»½è¶Šå¤šè¶Šå¥½å—? ç†è®ºä¸Šå‰¯æœ¬æ•°è¶Šå¤š, æ•°æ®å®‰å…¨æ€§è¶Šé«˜ ä½†æ˜¯å‰¯æœ¬æ•°è¶Šå¤š, ä¼šå ç”¨è¿‡å¤šçš„å­˜å‚¨èµ„æº, ä¼šé€ æˆé›†ç¾¤çš„ç»´æŠ¤å˜å¾—è¶Šå›°éš¾ 100 ä¸ªèŠ‚ç‚¹, 50ä¸ªå‰¯æœ¬, åœ¨è¿™50ä¸ªå‰¯æœ¬ä¸­, éšæ—¶éƒ½æœ‰å¯èƒ½å®•æœº, hdfså°±éœ€è¦ç»´æŠ¤å‰¯æœ¬ ä¸€èˆ¬æƒ…å†µä¸‹, 3ä¸ªå°±å¯ä»¥äº† hadoopæ˜¯åŸºäºŽå»‰ä»·çš„pcæœºè®¾è®¡çš„, ä¼šé€ æˆæœºå™¨éšæ—¶å¯èƒ½å®•æœº HDFSçš„ç›®å½•ç»“æž„ hdfsçš„ç›®å½•ç»“æž„ä¸Žlinux æ“ä½œç³»ç»Ÿç±»ä¼¼, ä»¥ /ä¸ºè·ŸèŠ‚ç‚¹, æˆ‘ä»¬å°†è¿™ä¸ªç›®å½•ðŸŒ²ç§°ä¸ºæŠ½è±¡ç›®å½•æ ‘ å› ä¸ºhdfsçš„ç›®å½•ç»“æž„ä»£è¡¨çš„æ˜¯æ‰€æœ‰æ•°æ®èŠ‚ç‚¹çš„æŠ½è±¡å‡ºæ¥çš„ç›®å½•, ä¸ä»£è¡¨ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ hdfs: /hadoop.zip 500M è¢«åˆ†æˆ4ä¸ªå—å­˜å‚¨ hdfsä¸­å­˜å‚¨çš„æ•°æ®å— æ˜¯æœ‰ç¼–å·çš„, blk_1, blk_2, blk_3, blk_4 /spark.zip 300M 3ä¸ªå—, blk_5 blk_6 blk_7 åº•å±‚å­˜å‚¨çš„æ—¶å€™, æ¯ä¸€ä¸ªblockéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„id hdfsçš„æ•°æ®åº•å±‚å­˜å‚¨çš„æ—¶å€™å—, è¿˜æ˜¯å­˜åœ¨çœŸæ­£çš„ç‰©ç†èŠ‚ç‚¹ä¸Š. 2. HDFS çš„æ•´ä½“ç»“æž„ä¸»ä»Žç»“æž„: ä¸€ä¸ªä¸»èŠ‚ç‚¹, å¤šä¸ªä»ŽèŠ‚ç‚¹ namenode: ç”¨äºŽå­˜å‚¨å…ƒæ•°æ®, åŒ…æ‹¬: æŠ½è±¡ç›®å½•æ ‘ å­˜å‚¨æ•°æ®å’Œblockçš„å¯¹åº”å…³ç³» blockå­˜å‚¨çš„ä½ç½® å¤„ç†å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ è¯»: ä¸‹è½½ å†™: ä¸Šä¼  datanode è´Ÿè´£çœŸæ­£çš„æ•°æ®å­˜å‚¨, å­˜å‚¨æ•°æ®çš„block çœŸæ­£å¤„ç†è¯»å†™ secondarynamenode: å†·å¤‡ä»½èŠ‚ç‚¹: åŠ©ç† å½“namenodeå®•æœºçš„æ—¶å€™, secondarynamenodeä¸èƒ½ä¸»åŠ¨åˆ‡æ¢ä¸º namenode, ä½†æ˜¯ secondarynamenodeä¸­å­˜å‚¨çš„æ•°æ®ä¸Žnamenodeç›¸åŒ. ä¸»è¦ä½œç”¨: namenodeå®•æœºçš„æ—¶å€™, å¸®åŠ©namenodeæ¢å¤ å¸®åŠ©namenodeåšä¸€äº›äº‹æƒ…, åˆ†æ‹…namenodeçš„åŽ‹åŠ› 3. HDFSä¼˜ç¼ºç‚¹: ä¼˜ç‚¹: å¯æž„å»ºåœ¨å»‰ä»·æœºå™¨ä¸Š, æˆæœ¬ä½Ž, é€šè¿‡å¤šå‰¯æœ¬æé«˜å¯é æ€§, æä¾›äº†å®¹é”™å’Œæ¢å¤æœºåˆ¶ é«˜å®¹é”™æ€§ å®¹é”™æ€§: æ•°æ®è®¿é—®ä¸Š, ä¸€ä¸ªèŠ‚ç‚¹æ•°æ®ä¸¢å¤±, ä¸å½±å“æ•´ä½“çš„æ•°æ®è®¿é—® æ•°æ®è‡ªåŠ¨ä¿å­˜å¤šä¸ªå‰¯æœ¬, å‰¯æœ¬ä¸¢å¤±åŽ, è‡ªåŠ¨æ¢å¤, æœ€ç»ˆæ¢å¤åˆ°ç”¨æˆ·é…ç½®çš„å‰¯æœ¬ä¸ªæ•° é€‚åˆæ‰¹å¤„ç†, é€‚åˆç¦»çº¿æ•°æ®å¤„ç† ç§»åŠ¨è®¡ç®—è€Œéžæ•°æ®, æ•°æ®ä½ç½®æš´éœ²ç»™è®¡ç®—æ¡†æž¶ é€‚åˆå¤§æ•°æ®å¤„ç† GB, TB ç”šè‡³ PB çº§æ•°æ®, ç™¾ä¸‡è§„æ¨¡ä»¥ä¸Šçš„æ–‡ä»¶æ•°é‡, 10k+ èŠ‚ç‚¹è§„æ¨¡ æµå¼æ–‡ä»¶è®¿é—®, ä¸æ”¯æŒæ•°æ®ä¿®æ”¹, hdfsç”¨äºŽæ•°æ®å­˜å‚¨ ä¸€æ¬¡æ€§å†™å…¥, å¤šæ¬¡è¯»å–, ä¿è¯æ•°æ®ä¸€è‡´æ€§ ç¼ºç‚¹: ä¸æ”¯æŒä½Žå»¶è¿Ÿçš„æ•°æ®è®¿é—®, ä¸æ”¯æŒ å®žæ—¶/è¿‘å®žæ—¶ æ•°æ®è®¿é—®, å› ä¸ºæ¶‰åŠåˆ°å¤šè½®RPCè°ƒç”¨ å‘ NameNode å¯»å€.. æ‹¿åˆ°åœ°å€åŽï¼Œ å‘ DataNode è¯·æ±‚æ•°æ®.. ä¸æ“…é•¿å­˜å‚¨å¤§é‡çš„å°æ–‡ä»¶â€“kbçº§åˆ«çš„ å¯»å€æ—¶é—´å¯èƒ½å¤§äºŽè¯»å–æ•°æ®çš„æ—¶é—´, ä¸åˆ’ç®— è¿›è¡Œæ•°æ®è®¿é—®çš„æ—¶å€™å…ˆæ‰¾å…ƒæ•°æ® å…ƒæ•°æ®æ˜¯å’Œblockå¯¹åº”çš„, 1ä¸ªblockå—å¯¹åº”ä¸€æ¡å…ƒæ•°æ® 1000wä¸ª1kbçš„æ–‡ä»¶, å­˜äº†1000wä¸ªå— â€” 1000wå…ƒæ•°æ® åœ¨è¿›è¡Œæ•°æ®è®¿é—®çš„æ—¶å€™å¯èƒ½èŠ±äº† 1s çš„æ—¶é—´, æ€»ä½“ä¸Šä¸åˆ’ç®— è¿™æ ·ä¼šé€ æˆå…ƒæ•°æ®å­˜å‚¨é‡è¿‡å¤§, å¢žåŠ namenodeçš„åŽ‹åŠ› åœ¨hdfsä¸­ä¸€èˆ¬æƒ…å†µä¸‹, ä¸€æ¡å…ƒæ•°æ®å¤§å° 150byte å·¦å³ 1000wæ¡å…ƒæ•°æ® â€” 1000w * 150, 1.5Gå·¦å³ ä¸æ”¯æŒæ–‡ä»¶å†…å®¹ä¿®æ”¹, ä»…ä»…æ”¯æŒæ–‡ä»¶æœ«å°¾è¿½åŠ  appendï¼Œ ä¸€ä¸ªæ–‡ä»¶åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªå†™è€…ï¼Œä¸æ”¯æŒå¹¶å‘æ“ä½œ ==4. HDFS çš„ å¸¸ç”¨å‘½ä»¤:==HDFSå½’æ ¹ç»“åº•å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ, ç±»ä¼¼äºŽ linux, éœ€è¦ç”¨å‘½ä»¤æ¥æ“ä½œ 1. hapdoop fs å‘½ä»¤ hadoop fs / hdfs dfs æ•ˆæžœæ˜¯ä¸€æ ·çš„ åœ¨hadoopä¸­æŸ¥çœ‹, åªæœ‰ç»å¯¹è·¯å¾„çš„è®¿é—®æ–¹å¼ æŸ¥çœ‹å¸®åŠ© hadoop fs -help æŸ¥çœ‹æ‰€æœ‰ hadoop fsçš„å¸®åŠ© hadoop fs -help ls æŸ¥çœ‹ fsä¸‹çš„ lsçš„å¸®åŠ© åˆ—å‡ºæ ¹ç›®å½•: hadoop fs -ls / hadoop fs -ls -R / é€’å½’å±•ç¤º hadoop fs -ls -R -h /å‹å¥½å±•ç¤ºï¼Œ å±•ç¤ºæ–‡ä»¶å¤§å°å•ä½ å¦‚æžœä¸æŒ‡å®šç›®å½•ï¼Œ ä¼šé»˜è®¤æ‰¾å½“å‰ç”¨æˆ·xxå¯¹åº”çš„/user/xxçš„ç›®å½• é€’å½’åˆ›å»º -mkdir -p: hadoop fs -mkdir -p /aa/bb/cc/dd ä¸åŠ  -p ä¸ºæ™®é€šåˆ›å»º åˆ›å»ºç©ºæ–‡ä»¶-touchz ç±»ä¼¼äºŽ Linux ä¸‹çš„ touch ä¸Šä¼  put: [-put [-f][-p] [-l] &lt;localsrc&gt; ... &lt;dst&gt;] ä¸Šä¼ ä¸€ä¸ª: hadoop fs -put hadoop-2.7.6.tar.gz /ss ä¸Šä¼ å¤šä¸ª: hadoop fs -put aa.txt bb.txt /ss ä¸‹è½½ get hadoop fs -get hdfsè·¯å¾„ æœ¬åœ°è·¯å¾„ åˆå¹¶ä¸‹è½½ getmerge hadoop fs -getmerge /ss/aa.txt /ss/bb.txt /home/ap/cc.txt ä¼šå°†æœ€åŽä¸€ä¸ªè·¯å¾„ä¹‹å‰8çš„å½“åšéœ€è¦åˆå¹¶çš„æ–‡ä»¶, æœ€åŽä¸€ä¸ªè·¯å¾„ä¸­æŒ‡å®šçš„æ–‡ä»¶å°±æ˜¯åˆå¹¶ç”Ÿæˆçš„æ–‡ä»¶ æŸ¥çœ‹æ–‡ä»¶å†…å®¹ cat -cat æŸ¥çœ‹æ–‡ä»¶å†…å®¹ -textä¹Ÿæ˜¯ç±»ä¼¼ åˆ é™¤æ–‡ä»¶ rm rm -rf (é”™è¯¯çš„) rm -r(é€’å½’) -f(å¼ºåˆ¶) æ–‡ä»¶hadoop fs -rm -f /ss/aa.txt æ–‡ä»¶å¤¹ hadoop fs -rm -f -r /aa mv ä¿®æ”¹åå­—, ç§»åŠ¨ ç§»åŠ¨çš„æ–‡ä»¶ä»Ž hdfs åˆ° hdfs hadoop fs -mv .. .. cp å¤åˆ¶ hadoop fs -cp /hdfsfile /hdfsfile: ä»Ž hdfs å¤åˆ¶åˆ° hdfs å‚æ•° -p ï¼š å¤åˆ¶åŽä¿æŒæ–‡ä»¶çš„åŽŸæœ¬å±žæ€§, æ—¶é—´æˆ³ï¼Œ æƒé™ç­‰ Passing -p preserves status [topax] (timestamps, ownership, permission, ACLs, XAttr). å‚æ•° -f : å·²æœ‰åŒåæ–‡ä»¶çš„è¯ï¼Œ ç›´æŽ¥è¦†ç›– åœ¨æœ«å°¾è¿½åŠ : -appendToFile æœ¬åœ°æ–‡ä»¶ hdfsæ–‡ä»¶` å°†æœ¬åœ°æ–‡ä»¶bb.txt è¿½åŠ åˆ° htfdçš„ /aa/aa.txt ä¸Š hadoop fs -appendToFile aa.txt /ss/bb.txt ä»Žå‘½ä»¤è¡Œè¿½åŠ  , ä½†æ˜¯ä¸çŸ¥é“æ€Žä¹ˆç»“æŸï¼Œ å…ˆå­˜ç–‘ï¼Ÿï¼Ÿ hadoop fs -appendToFile - /a.txt` è¿™ä¸ªè¿½åŠ æ˜¯åœ¨åŽŸå§‹å—çš„æœ«å°¾è¿½åŠ çš„. ä¼šæ”¹å˜é›†ç¾¤ä¸Šçš„æ–‡ä»¶ å¦‚æžœè¶…è¿‡128Mæ‰ä¼šè¿›è¡Œåˆ‡åˆ†, ä½†è¿™ä¸ªå‘½ä»¤ä¸€èˆ¬ä¸ä¼šä½¿ç”¨ æŸ¥çœ‹æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹æ•°é‡ count DIR_COUNT FILE_COUNT CONTENT_SIZE FILE_NAME 8 3 176.5 K /tmp hadoop fs -count -h /tmp: -h æ˜¯å‹å¥½å±•ç¤º hdfs dfs -count -h /tmp: ä¸Žä¸Šé¢æ•ˆæžœä¸€æ · hdfs dfs -count -q -h /tmp: æŸ¥çœ‹æ–‡ä»¶é…é¢ï¼Œ å…·ä½“çœ‹ help duï¼š å±•ç¤ºæ–‡ä»¶å¤§å°ï¼Œ å¦‚æžœå‚æ•°æ˜¯æ–‡ä»¶å¤¹ï¼Œ åˆ™å±•ç¤ºæ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶çš„å¤§å° hadoop fs -du -h /tmp hadoop fs -du -s -h /tmp: s åº”è¯¥æ˜¯ sum çš„æ„æ€ï¼Œ å±•ç¤ºæ‰€æœ‰æ–‡ä»¶å¤§å°çš„æ€»å’Œ å±•ç¤ºæ–‡ä»¶æœ€åŽ1kbå†…å®¹-tail Show the last 1KB of the file. hadoop fs -tail /dd.txt` -f Shows appended data as the file grows. åº”ç”¨åœºæ™¯ï¼š ç›‘æŽ§æ—¥å¿— ä¿®æ”¹æ–‡ä»¶æƒé™ chmod 12345678910111213141516# 1. ç›´æŽ¥ä½¿ç”¨åè¿›åˆ¶æ•°å­—ä¿®æ”¹ [ap@cs2]~/test% hadoop fs -ls /drwxr-xr-x - ap supergroup 0 2018-06-01 08:55 /aa# -Rï¼š /aa ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶é€’å½’ä¿®æ”¹æƒé™[ap@cs2]~/test% hadoop fs -chmod -R 777 /aa[ap@cs2]~/test% hadoop fs -ls /drwxrwxrwx - ap supergroup 0 2018-06-01 08:55 /aa# 2. é’ˆå¯¹ç”¨æˆ·ç»„ä¿®æ”¹ï¼Œæ³¨æ„ï¼Œä¿®æ”¹2ä¸ªä¸åŒç»„æƒé™ï¼Œ ç”¨ï¼Œéš”å¼€hadoop fs -chmod u+x,g+x /a.txt # 3. æœ€å¸¸ç”¨çš„æ–‡ä»¶æƒé™ï¼Œ æ˜¯ 644(-rw-r--r--) å’Œ 755(-rwxr-xr-x) æ–‡ä»¶åˆ›å»ºé»˜è®¤å°±æ˜¯644# 4. u+x ä¸Ž +x çš„åŒºåˆ« å‰è€…æŒ‡å®šåŠ åœ¨å“ªç»„ç”¨æˆ·ä¸Šï¼Œ åŽè€…æ˜¯æ‰€æœ‰ç»„éƒ½åŠ  ä¿®æ”¹ç”¨æˆ·æƒé™ chown 1hadoop fs -chown -R ç”¨æˆ·å:ç»„å hdfsç›®å½•/æ–‡ä»¶ 2. hdfs dfsadminå‘½ä»¤ ç®¡ç†å‘˜å¯¹å½“å‰èŠ‚ç‚¹çš„ä¸€äº›æ“ä½œ hdfs dfsadmin -report æŠ¥å‘Šå½“å‰çš„ä¸€äº›çŠ¶æ€ -live æ´»è·ƒçš„ -dead æ­»çš„ -decommissioning é€€å½¹çš„ **hdfs dfsadmin -safemode å®‰å…¨æ¨¡å¼ ç³»ç»Ÿåˆšå¯åŠ¨çš„æ—¶å€™ï¼Œ ä¼šæœ‰30ç§’çš„å®‰å…¨æ¨¡å¼å¼€å¯çŠ¶æ€ï¼Œ è¿‡äº†30ç§’å°±å…³äº† enter è¿›å…¥ leave ç¦»å¼€ get æŸ¥çœ‹ hdfs dfsadmin è®¾ç½®é…é¢ -setQuota ï¼š é…é¢æ˜¯é™å®šçš„æ–‡ä»¶&amp;æ–‡ä»¶å¤¹çš„æ•°é‡ A quota of 1 would force the directory to remain empty. ç©ºæ–‡ä»¶æœ¬èº«ç®—ä¸€ä¸ªæ–‡ä»¶ bin/hdfs dfsadmin -setQuota 10 lisi -clrQuota -setSpaceQuotaï¼š ç©ºé—´é…é¢é™å®šçš„æ˜¯å¤§å° bin/hdfs dfsadmin -setSpaceQuota 4k /lisi/ -clrSpaceQuota hdfs dfs -count -q -h /user: åŠ ä¸Š -q æ˜¯æŸ¥çœ‹é…é¢ 3. httpFSè®¿é—®ä½¿ç”¨ REST çš„å½¢å¼ï¼Œ å¯ä»¥åœ¨æµè§ˆå™¨ä¸Šç›´æŽ¥è®¿é—®é›†ç¾¤ï¼Œ å¯ä»¥åœ¨éž Linux å¹³å°è®¿é—® 123456789101112131415161718192021# ç¼–è¾‘æ–‡ä»¶httpfs-env.sh# æ‰“å¼€æ­¤å¥æ³¨é‡Š, ä½¿ç”¨å†…åµŒçš„ tomcatexport HTTPFS_HTTP_PORT=14000# ç¼–è¾‘æ–‡ä»¶core-site.xml&lt;property&gt; &lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt; &lt;value&gt;*&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt; &lt;value&gt;*&lt;/value&gt;&lt;/property&gt;ç¼–è¾‘æ–‡ä»¶hdfs-site.xml&lt;property&gt; &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt;&lt;/property&gt;é‡æ–°å¯åŠ¨namenodeï¼Œæ‰§è¡Œ sbin/httpfs.sh start# æ‰§è¡Œå‘½ä»¤curl -i "http://cs1:14000/webhdfs/v1?user.name=root&amp;op=LISTSTATUS" æ›´å¤šå‘½ä»¤å‚è€ƒ ç›¸å…³çŸ¥è¯†ç‚¹ è¿™äº›å‘½ä»¤åœ¨é›†ç¾¤ä¸­çš„ä»»ä½•èŠ‚ç‚¹éƒ½å¯ä»¥åš, hdfsæ–‡ä»¶ç³»ç»Ÿä¸­, çœ‹åˆ°çš„ç›®å½•ç»“æž„åªæ˜¯ä¸€ä¸ªæŠ½è±¡ç›®å½•, å®žé™…å­˜å‚¨åœ¨é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¸Š aa.txt , å¤§å°150M, hadoop fs -put aa.txt / ä¼šåœ¨æ ¹ç›®å½•ä¸‹çœ‹åˆ° /aa.txt, ä½†æ˜¯ aa.txt çœŸå®žå­˜å‚¨çš„æ—¶å€™, ä¼šå…ˆè¿›è¡Œåˆ†å—, åˆ†2å—, è¿›è¡Œå­˜å‚¨, å‡è®¾é›†ç¾¤ä¸­5ä¸ªå­˜å‚¨èŠ‚ç‚¹, è¿™2ä¸ªå—å­˜å‚¨åœ¨å“ªä¸ªèŠ‚ç‚¹, ç”±namenodeè¿›è¡Œåˆ†é… å›¾å½¢ç•Œé¢ç‚¹è¿›åŽ», å¯ä»¥çœ‹åˆ°å­˜å‚¨çš„å— Linuxçš„æƒé™ç®¡ç†å‘½ä»¤: ä¿®æ”¹ æ–‡ä»¶/æ–‡ä»¶å¤¹ æƒé™çš„ chmod: å¯è¯»: r , =4 å¯å†™: w, =2 å¯æ‰§è¡Œ: x, =1 æœ€å¤§æƒé™æ˜¯7 -rw-rw-râ€“ æ–‡ä»¶å±žæ€§ d:ç›®å½• -:æ–‡ä»¶ l:é“¾æŽ¥ ç¬¬ä¸€ç»„: æœ¬ç”¨æˆ·, ç¬¬äºŒç»„: æœ¬ç»„ç”¨æˆ·, ç¬¬ä¸‰ç»„: å…¶å®ƒç”¨æˆ· chmod 711 æ”¹ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶æƒé™ä¸º711 chmod -R 711 ç›®å½• ä¿®æ”¹æ–‡ä»¶æ‰€å±žç”¨æˆ·å’Œç»„ chown chown -R root:root ss/æŠŠssçš„æ–‡ä»¶å¤¹å…¨éƒ¨æ”¹æˆrootç”¨æˆ·å’Œrootç»„ 5ã€EclipseæŸ¥çœ‹Hadoopæ–‡ä»¶ä¿¡æ¯è¯¦æƒ…å¯ä»¥æŸ¥çœ‹ å…¶ä¸­å¯èƒ½é‡åˆ°çš„bugï¼Œå‚è§ å…¶ä¸­ï¼Œ Eclipseç«¯æ— æ³•ç›´æŽ¥åˆ é™¤æ–‡ä»¶çš„é—®é¢˜ï¼Œä¼¼ä¹Žå¯ä»¥é€šè¿‡åœ¨hdfs-site.xml ä¸­ä¿®æ”¹è®¿é—®æƒé™æ¥å®žçŽ°ï¼Œ è¿˜æœªå°è¯• 1234&lt;property&gt; &lt;name&gt;dfs.permissions&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;/property&gt; 6. é€šè¿‡ Java APIçš„æ–¹å¼æ“ä½œ HDFS]]></content>
      <categories>
        <category>Hadoop</category>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>HDFS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HashMapçš„å®žçŽ°åŽŸç†]]></title>
    <url>%2F2018%2F06%2F02%2FJava%2FHashMap%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[1.ä»€ä¹ˆæ˜¯HashMap Hash: æ•£åˆ—å°†ä¸€ä¸ªä»»æ„çš„é•¿åº¦é€šè¿‡æŸç§(hashå‡½æ•°)ç®—æ³•è½¬æ¢æˆä¸€ä¸ªå›ºå®šå€¼ Map: åœ°å›¾, (x,y)å­˜å‚¨ åº•å±‚å°±æ˜¯ä¸€ä¸ªæ•°ç»„ç»“æž„, æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹åˆæ˜¯ä¸€ä¸ªé“¾è¡¨, å½“æ–°å»ºä¸€ä¸ªHashMapçš„æ—¶å€™, å°±ä¼šåˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ æ€»ç»“: é€šè¿‡ hash å‡ºæ¥å€¼, ç„¶åŽé€šè¿‡å€¼å®šä½åˆ°æŸä¸ª map, ç„¶åŽvalue å­˜å‚¨åˆ°è¿™ä¸ª mapä¸­, valueåªä¸è¿‡æ˜¯ key çš„é™„å±ž. 2.æºç åˆ†æžå…ˆç»™å‡ºç»“è®ºæ•°æ®ç»“æž„: åº•å±‚æ˜¯æ•°ç»„ Entry å°±æ˜¯æ•°ç»„ä¸­çš„å…ƒç´  æ¯ä¸ªMap.Entryå…¶å®žå°±æ˜¯ä¸€ä¸ªkey-valueå¯¹, å®ƒæŒæœ‰ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨Entry&lt;K,V&gt; next;, è¿™å°±æž„æˆäº†é“¾è¡¨ å­˜å–å®žçŽ°: å­˜å‚¨put : è¿‡ç¨‹ å…ˆæ ¹æ® key çš„ hashCode é‡æ–°è®¡ç®— hash å€¼, æ ¹æ® hash å€¼å¾—åˆ°è¿™ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®(ä¸‹æ ‡) å¦‚æžœæ•°ç»„è¯¥ä½ç½®ä¸Šå·²ç»å­˜æ”¾æœ‰å…¶ä»–å…ƒç´ äº†, é‚£ä¹ˆåœ¨è¿™ä¸ªä½ç½®ä¸Šçš„å…ƒç´ å°†ä»¥é“¾è¡¨çš„å½¢å¼å­˜æ”¾, æ–°åŠ å…¥çš„æ”¾åœ¨é“¾å¤´, æœ€å…ˆåŠ å…¥çš„æ”¾åœ¨é“¾å°¾. å¦‚æžœæ•°ç»„è¯¥ä½ç½®ä¸Šæ²¡æœ‰å…ƒç´ , å°±ç›´æŽ¥å°†è¯¥å…ƒç´ æ”¾åˆ°æ•°ç»„ä¸­çš„è¯¥ä½ç½®ä¸Š. æ³¨æ„ç‚¹ å½“ç³»ç»Ÿå†³å®šå­˜å‚¨ HashMap ä¸­çš„ key-value å¯¹æ—¶ï¼Œå®Œå…¨æ²¡æœ‰è€ƒè™‘ Entry ä¸­çš„ valueï¼Œä»…ä»…åªæ˜¯æ ¹æ® keyæ¥è®¡ç®—å¹¶å†³å®šæ¯ä¸ªEntryçš„å­˜å‚¨ä½ç½®ã€‚å½“ç³»ç»Ÿå†³å®šäº† keyçš„å­˜å‚¨ä½ç½®ä¹‹åŽï¼Œvalueéšä¹‹ä¿å­˜åœ¨é‚£é‡Œå³å¯ã€‚ å¯¹äºŽäºŽä»»æ„ç»™å®šçš„å¯¹è±¡ï¼Œåªè¦å®ƒçš„ hashCode()è¿”å›žå€¼ç›¸åŒï¼Œé‚£ä¹ˆç¨‹åºè°ƒç”¨ hash(int h)æ–¹æ³•æ‰€è®¡ç®—å¾—åˆ°çš„hash ç å€¼æ€»æ˜¯ç›¸åŒçš„ã€‚ æœ¬è´¨ä¸Šå°±æ˜¯æŠŠ hash å€¼å¯¹æ•°ç»„é•¿åº¦å–æ¨¡è¿ç®—ï¼Œ è¿™æ ·ä¸€æ¥ï¼Œå…ƒç´ çš„åˆ†å¸ƒç›¸å¯¹æ¥è¯´æ˜¯æ¯”è¾ƒå‡åŒ€çš„ ä½†æ˜¯ç³»ç»Ÿæ˜¯ç”¨çš„ä½è¿ç®—ï¼Œ æ–¹æ³•æ›´å·§å¦™ï¼Œ æ¶ˆè€—æ›´å° è¯»å–get è¿‡ç¨‹ é¦–å…ˆè®¡ç®— key çš„ hashCodeï¼Œæ‰¾åˆ°æ•°ç»„ä¸­å¯¹åº”ä½ç½®çš„æŸä¸€å…ƒç´ ï¼Œç„¶åŽé€šè¿‡key çš„ equals æ–¹æ³•åœ¨å¯¹åº”ä½ç½®çš„é“¾è¡¨ä¸­æ‰¾åˆ°éœ€è¦çš„å…ƒç´ ã€‚ å­˜å‚¨å®žçŽ°æ€»ç»“: HashMap åœ¨åº•å±‚å°† key-value å½“æˆä¸€ä¸ªæ•´ä½“è¿›è¡Œå¤„ç†ï¼Œè¿™ä¸ªæ•´ä½“å°±æ˜¯ä¸€ä¸ª Entry å¯¹è±¡ã€‚ HashMap åº•å±‚é‡‡ç”¨ä¸€ä¸ª Entry[] æ•°ç»„æ¥ä¿å­˜æ‰€æœ‰çš„ key- value å¯¹ï¼Œå½“éœ€è¦å­˜å‚¨ä¸€ä¸ª Entry å¯¹è±¡æ—¶ï¼Œä¼šæ ¹æ® hash ç®—æ³•æ¥å†³å®šå…¶åœ¨æ•°ç»„ä¸­çš„å­˜å‚¨ä½ç½®ï¼Œåœ¨æ ¹æ® equals æ–¹æ³•å†³å®šå…¶åœ¨è¯¥æ•°ç»„ä½ç½®ä¸Šçš„é“¾è¡¨ä¸­çš„å­˜å‚¨ä½ç½®ï¼› å½“éœ€è¦å–å‡ºä¸€ä¸ª Entry æ—¶ï¼Œä¹Ÿä¼šæ ¹æ® hash ç®—æ³•æ‰¾åˆ°å…¶åœ¨æ•°ç»„ä¸­çš„å­˜å‚¨ä½ç½®ï¼Œå†æ ¹æ® equals æ–¹æ³•ä»Žè¯¥ä½ç½®ä¸Šçš„é“¾è¡¨ä¸­å–å‡ºè¯¥ Entryã€‚ 3. HashMap çš„æ€§èƒ½å‚æ•°123456789101112131415161718192021222324252627282930313233343536/** * æ¡¶è¡¨é»˜è®¤å®¹é‡ 16, å¿…é¡»æ˜¯ 2 çš„å€æ•°ï¼Œ ä¾¿äºŽåŽé¢çš„ ä½è¿ç®— * æŽ§åˆ¶hashcode ä¸è¶…16èŒƒå›´, a.hashcode = xx % 16 (hashcode å–æ¨¡ æ¡¶ä¸ªæ•°) */static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16/** * MUST be a power of two &lt;= 1&lt;&lt;30. * æ¡¶è¡¨æœ€å¤§ 2^30 */static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;/** * æ‰©å®¹å› å­ï¼ˆè´Ÿè½½å› å­ï¼‰: 0.75 * æ‰©å®¹: æ¯æ¬¡2å€ */static final float DEFAULT_LOAD_FACTOR = 0.75f;/** * é“¾è¡¨: hashç®—æ³•å€¼ç›¸åŒçš„æ—¶å€™, ä¼šæŠŠå€¼ç›¸åŒçš„æ”¾åœ¨ä¸€ä¸ªé“¾è¡¨ä¸Š, é“¾è¡¨ä¸Šçš„å…ƒç´ ä¸ªæ•° * è¶…è¿‡8ä¸ªæ—¶, é“¾è¡¨è½¬åŒ–ä¸ºäºŒå‰æ ‘, æå‡æŸ¥è¯¢æ•ˆçŽ‡ */static final int TREEIFY_THRESHOLD = 8;/** * å°äºŽ6ä¸ªï¼Œ åˆå˜å›žé“¾è¡¨ */static final int UNTREEIFY_THRESHOLD = 6;/** * The smallest table capacity for which bins may be treeified. * (Otherwise the table is resized if too many nodes in a bin.) * Should be at least 4 * TREEIFY_THRESHOLD to avoid conflicts * between resizing and treeification thresholds. */static final int MIN_TREEIFY_CAPACITY = 64;]]></content>
      <categories>
        <category>Java</category>
        <category>çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[â–æ— é¢˜]]></title>
    <url>%2F2018%2F06%2F02%2FPoetry%2F%E6%97%A0%E9%A2%98%2F</url>
    <content type="text"><![CDATA[åœ¨æ·®æµ·ä¸­è·¯çœ‹æ²¹ç”»ï¼Œè¦æŠŠå¤©ç©ºè°ƒå¼± è®©æ²¹èœèŠ±æš—ä¸‹åŽ»ï¼Œçœ‹çœ‰å¼æ¸…ç§€ä¹‹äººç¦»å¼€èº«ä½“ ç©¿è¿‡è¡—å··ä¸­æ¶‚æŠ¹è¿‡çš„äººç¾¤ï¼Œæ‚„æ‚„æŠ•äº†æ°´ã€‚ åœ¨æ·®æµ·ä¸­è·¯1411å·ï¼Œæ˜¥å…‰é®è”½äº†æš—ç–¾ é¸Ÿé¸£å¸¦æ¥é€¼ä»„å’Œé£žè¡Œæ„Ÿï¼Œä¸€ä¸ªäººçš„èº«ä½“åƒéº»ç»³ è£¸éœ²åœ¨æ–°é²œç©ºæ°”ä¸­ï¼Œéª¨å¤´å¼€è£‚å‡ºèŠ±æœµã€‚ çœ¼åº•çš„äº‘åˆç™½åˆé»‘ï¼Œè†ç›–çš„é’è‰²æ„ˆçˆ±æ„ˆæ·± ç©¿è¿‡æ­»åŽæ½­æ°´çš„å¯‚é™ï¼ŒèƒŒéƒ¨é•¿å‡ºçš„é±¼é³ž ä¸€å¹´æ¯”ä¸€å¹´è–„ï¼Œæœˆäº®ä¸€æ—¥æ¯”ä¸€æ—¥æ—§ã€‚ ä¸Žæ˜¥é£Žäº¤æ¢èº«ä½“ï¼Œä¸Žç´ ä¸ç›¸è¯†ä¹‹äººæŠ±å¤´ç—›å“­ ä¸Žæˆ‘ï¼Œè®¸ä¸‹å†æ­»ä¸€æ¬¡çš„è¯ºè¨€ï¼Œè¿™ä¹ˆå¤šå¹´äº† å¥¹è¯´ï¼Œæˆ‘çˆ±ä½ ä¾æ—§ï¼Œèƒœè¿‡ç”»ä¸­äººã€‚ ä½œè€… / éšå±…çš„äº‹]]></content>
      <categories>
        <category>æ–‡è‰º</category>
        <category>è¯—æ­Œ</category>
      </categories>
      <tags>
        <tag>è¯—æ­Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoopç›¸å…³ä¹¦ç±]]></title>
    <url>%2F2018%2F06%2F02%2FHadoop%2F0-Hadoop%2FHadoop%E7%9B%B8%E5%85%B3%E4%B9%A6%E7%B1%8D%2F</url>
    <content type="text"><![CDATA[Hadoopæ¡†æž¶ä½“ç³»ç›¸å…³ä¹¦ç±æŽ¨è1. [Hadoopæƒå¨æŒ‡å—] ç¬¬å››ç‰ˆ é¡¾åæ€ä¹‰, å¾ˆæƒå¨ ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ðŸ˜ 2. [HBaseæƒå¨æŒ‡å—] ç¥ä½ ðŸ´åˆ°æˆåŠŸ ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ðŸ´ 3. [Hiveç¼–ç¨‹æŒ‡å—] å°èœœèœ‚, å—¡å—¡å—¡. ðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸ ðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸðŸ 4. [zookeeperåˆ†å¸ƒå¼è¿‡ç¨‹ååŒæŠ€æœ¯è¯¦è§£] è¿™æ˜¯ä¸ªå•¥åŠ¨ç‰©?? ðŸ±?? ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ± ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±ðŸ±]]></content>
      <categories>
        <category>Hadoop</category>
        <category>Books</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>Books</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoopå­¦ä¹ ç¬”è®°-1 ç®€ä»‹&å®‰è£…]]></title>
    <url>%2F2018%2F05%2F31%2FHadoop%2F0-Hadoop%2FHadoop%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-1-%E7%AE%80%E4%BB%8B%26%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%2F</url>
    <content type="text"><![CDATA[å¼•å…¥é¢è¯•é¢˜1. æœ‰ä¸€ä¸ªå¾ˆå¤§çš„(4T)çš„æ–‡ä»¶, æ–‡ä»¶ä¸­å­˜å‚¨çš„æ˜¯ip, æ¯è¡Œå­˜å‚¨ä¸€ä¸ª, è¦æ±‚æ±‚å‡ºå‡ºçŽ°æ­¤å¤„æœ€å¤šçš„é‚£ä¸ªip1234567891011121314151617181920212223242526272829303132333435å¦‚æžœè¿™ä¸ªæ–‡ä»¶æ˜¯å°æ–‡ä»¶ï¼š ioæµ+é›†åˆ å®žçŽ°æ€è·¯ï¼š åˆ›å»ºä¸€ä¸ªæµè¿›è¡Œæ–‡ä»¶è¯»å– è¯»å–å‡ºæ¥çš„æ•°æ®å­˜å‚¨åˆ°mapé›†åˆä¸­ keyï¼šip value:æ¬¡æ•° ç»Ÿè®¡é€»è¾‘ï¼š åˆ¤æ–­è¯»å–çš„ipæ˜¯å¦å·²ç»å­˜åœ¨åœ¨mapä¸­ å­˜åœ¨ï¼šå–å‡ºvalue+1 ä¸å­˜åœ¨ï¼šå°†ipä½œä¸ºkey 1ä½œä¸ºvalue æ€Žä¹ˆæ±‚ipå‡ºçŽ°æ¬¡æ•°æœ€å¤šçš„ éåŽ†map éåŽ†keyï¼Œå–å‡ºvalueæ‰¾å‡ºæœ€å¤§å€¼ valueæœ€å¤§çš„keyå°±æ˜¯è¦æ‰¾çš„ipæˆ‘çš„æ–‡ä»¶è¶³å¤Ÿå¤§ï¼šå¤§åˆ°ä¸€å°æœºå™¨è£…ä¸ä¸‹ æ•°ç»„ é›†åˆ å˜é‡------&gt;åŸºäºŽå†…å­˜çš„ æ€Žä¹ˆåŠžï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ æœåŠ¡å™¨çš„2T 1.åœ¨æœ€æ—©çš„æ—¶å€™æˆ‘ä»¬çš„æ€ç»´æ¨¡å¼å°±æ˜¯çºµå‘æ‰©å±•ï¼Œå¢žåŠ å•ä¸ªèŠ‚ç‚¹çš„æ€§èƒ½ 8T æ‘©å°”å®šå¾‹ï¼šç¡¬ä»¶æ€§èƒ½18-24ä¸ªæœˆä¼šæå‡ä¸€å€ 4T------2h 4T------1h å‰ææ˜¯æ•°æ®é‡ä¸å‘ç”Ÿæ”¹å˜ ä½†æ˜¯å¾€å¾€æ•°æ®é‡çš„å˜åŒ–é€Ÿåº¦è¿œè¿œå¤§äºŽæœåŠ¡å™¨æ€§èƒ½çš„æå‡é€Ÿåº¦ ç»è¿‡18ä¸ªæœˆ æœåŠ¡å™¨æ€§èƒ½æå‡äº†ä¸€å€ æ•°æ®é‡------æå‡äº†10å€ 4T------2h 40t-----20h ç›®å‰åªéœ€è¦10h çºµå‘æ‰©å±•ä¸å¯è¡Œï¼Ÿ æ¨ªå‘æ‰©å±•ï¼šå¦‚æžœä¸€å°æœºå™¨å¤„ç†ä¸äº†æ•°æ® ä½¿ç”¨å¤šå°æœºå™¨ 4T------2h 4t----4ä¸ªæœºå™¨----0.5å°æ—¶ åˆ†è€Œæ²»ä¹‹çš„æ€æƒ³ï¼š ä¸€ä¸ªæœºå™¨è®¡ç®—æ€§èƒ½æœ‰é™ è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨å¤šå°æœºå™¨å…±åŒè®¡ç®— æ¯å°æœºå™¨æ‰¿æ‹…ä¸€éƒ¨åˆ†è®¡ç®—é‡ æœ€ç»ˆå®žçŽ°ï¼š 1.å…ˆå°†è¿™ä¸ªè¶³å¤Ÿå¤§çš„æ–‡ä»¶è¿›è¡Œåˆ‡åˆ† åˆ‡åˆ†æˆäº†å¤šä¸ªå°æ–‡ä»¶ 2.å°†å¤šä¸ªå°æ–‡ä»¶åˆ†å‘ç»™å¤šä¸ªæœºå™¨è¿›è¡Œç»Ÿè®¡æ¯ä¸ªipå‡ºçŽ°çš„æ¬¡æ•° æ¯ä¸ªæ±‚å‡ºå‡ºçŽ°æ¬¡æ•°æœ€å¤šçš„ip 3.åˆå¹¶æ±‚å‡ºæœ€ç»ˆçš„æœ€å¤§å€¼ 2. æœ‰ä¸¤ä¸ªå¾ˆå¤§çš„æ–‡ä»¶, ä¸¤ä¸ªæ–‡ä»¶ä¸­å­˜å‚¨çš„éƒ½æ˜¯url, æ±‚å‡ºä¸¤ä¸ªæ–‡ä»¶ä¸­ç›¸åŒçš„url12345678910111213141516171819202122å¦‚æžœæ–‡ä»¶æ˜¯å°æ–‡ä»¶ï¼š ioæµ+é›†åˆï¼ˆsetï¼‰ å®žçŽ°é€»è¾‘ï¼š 1.å…ˆåˆ›å»ºä¸¤ä¸ªæ–‡ä»¶è¯»å–æµï¼Œç”¨æ¥è¯»å–ä¸¤ä¸ªæ–‡ä»¶ 2.åˆ›å»ºä¸¤ä¸ªé›†åˆset1 set2 3.è¿›è¡Œæ–‡ä»¶è¯»å–å¹¶åˆ†åˆ«set1 set2ä¸­ 4.å¾ªçŽ¯éåŽ†å…¶ä¸­ä¸€ä¸ªset1ï¼Œåˆ¤æ–­set1ä¸­å–å‡ºçš„æ¯ä¸ªurlæ˜¯å¦åœ¨set2ä¸­ set2.contains(url)å¤§æ–‡ä»¶çš„æ—¶å€™æ€Žä¹ˆåŠžï¼Ÿ æˆ‘ä»¬ä¹Ÿé‡‡ç”¨åˆ†è€Œæ²»ä¹‹çš„æ€æƒ³ï¼šå°†ä¸¤ä¸ªå¤§æ–‡ä»¶éƒ½è¿›è¡Œåˆ‡åˆ†ï¼Œæ¯ä¸ªå¤§æ–‡ä»¶éƒ½åˆ‡æˆå¤šä¸ªå°æ–‡ä»¶ ä¸€ä¸ªå¤§ä»»åŠ¡=4*4ä¸ªå°ä»»åŠ¡ è¿™æ ·è™½ç„¶å¯ä»¥è¾¾åˆ°ç›®çš„ä½†æ˜¯æ•ˆçŽ‡å¤ªä½Žï¼Ÿæ€Žä¹ˆåŠžï¼Ÿ æŽ’åºï¼Œåˆ‡åˆ†ï¼ˆè§„åˆ™åŒä¸€ï¼‰ æœ€ç»ˆå°†ä»»åŠ¡å‡å°‘åˆ°4ä¸ª ä½†æ˜¯å¤§æ–‡ä»¶æŽ’åºä»ç„¶æ˜¯ä¸€ä¸ªéžå¸¸æ¶ˆè€—æ€§èƒ½çš„äº‹æƒ…ï¼Œå¦‚æžœä¸éœ€è¦æŽ’åºå°±å¯åšåˆ°è¿™ä¸ªæ•ˆæžœå°½é‡ä¸è¦æŽ’åº æ€Žä¹ˆåŠžï¼Ÿ hashç®—æ³•çš„ç›®çš„----ã€‹ç»™æ¯ä¸€ä¸ªå¯¹è±¡ç”Ÿæˆä¸€ä¸ªâ€œå”¯ä¸€â€çš„hashå€¼0-Integer_MAX æ˜¯å¦å¯ä»¥è¿ç”¨hashç®—æ³•è§£å†³è¿™ä¸ªé—®é¢˜ url.hashCode()%åˆ†æ®µçš„ä¸ªæ•° ä¸¤ä¸ªæ–‡ä»¶åˆ†æ®µè§„åˆ™ä¸€å®šç›¸åŒå—ï¼Ÿ url.hashCode()è‚¯å®šä¸€æ · åˆ†æ®µä¸ªæ•°ä¸€å®šç›¸åŒå—ï¼Ÿå¯ä»¥ä¸ä¸€æ · å¦‚æžœä¸ä¸€æ ·çš„è¯ å¿…é¡»æˆå€æ•°å…³ç³» æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆï¼š åˆ†è€Œæ²»ä¹‹+åˆ†æ®µè§„åˆ™ åˆ†æ®µï¼šåˆ†åŒº 3. æœ‰ä¸€ä¸ªå¾ˆå°çš„æ–‡ä»¶, å­˜å‚¨çš„éƒ½æ˜¯url, æ¯è¡Œä¸€ä¸ª, æ€Žæ ·å¿«é€Ÿåˆ¤æ–­ç»™å®šçš„ä¸€ä¸ªurlæ˜¯å¦åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å°æ–‡ä»¶: IO + é›†åˆ(set) åˆ›å»ºio å’Œ é›†åˆ è¿›è¡Œæ–‡ä»¶è¯»å–æ”¾åœ¨ seté›†åˆä¸­ set.contains(url) ==&gt; true:å­˜åœ¨, false: ä¸å­˜åœ¨ å¤§æ–‡ä»¶: æ€è·¯1: ç”¨hashCode() è¿›è¡Œåˆ†åŒº, ç„¶åŽç”¨è¦æŸ¥æ‰¾çš„ url å–æ¨¡å®šä½ ä½†æ˜¯è¿™æ ·å®šä½åˆ°äº†è¿˜æ˜¯è¦ä¸€ä¸ªä¸ªæ‰¾ æ€è·¯2: æ•°ç»„çš„æŸ¥è¯¢æ€§èƒ½æ¯”è¾ƒé«˜, æ•°ç»„å¯ä»¥é€šè¿‡ä¸‹æ ‡ åŸºæ•°æŽ’åº æ•°ç»„çš„ç´¢å¼•ä»£è¡¨çš„æ˜¯æ•°æ®çš„åŽŸå§‹å€¼, æ•°ç»„ä¸­å­˜å‚¨çš„å€¼, æ˜¯åŽŸå§‹å€¼å‡ºçŽ°çš„æ¬¡æ•° æ”¾åˆ°å¯¹åº”ä¸‹æ ‡çš„ä½ç½®, å€¼åªå­˜å‡ºçŽ°çš„æ¬¡æ•° å¦‚æžœæ•°ç»„ä¸­å¯¹åº”çš„ä¸‹è¡¨å­˜å‚¨çš„å€¼ä¸º0, ä»£è¡¨æ­¤ä¸‹æ ‡çš„å€¼æ²¡æœ‰å‡ºçŽ°è¿‡, å°±ä¸éœ€è¦è¾“å‡º ç¼ºç‚¹: æ•°æ®èŒƒå›´è¿‡å¤§æ—¶, æ•°ç»„é•¿åº¦ä¸å¥½åˆ›å»º æ•°ç»„çš„ç±»åž‹ä¸å¥½ç¡®å®š å¦‚æžœæ•°æ®æ¯”è¾ƒåˆ†æ•£æ—¶, ä¼šé€ æˆèµ„æºæµªè´¹ ç»ƒä¹ : å†™ä¸€ä¸ªåŸºæ•°æŽ’åº, éšæœºç”Ÿæˆçš„20ä¸ªæ•°, è¿ç”¨åŸºæ•°æŽ’åºæŽ’åº å¯¹äºŽæœ¬é¢˜ ä¸éœ€è¦ç»Ÿè®¡æ¬¡æ•°, å­˜åœ¨æ ‡è®°ä¸º1, ä¸å­˜åœ¨å°±æ˜¯0 æ‰€ä»¥å­˜çš„æ—¶å€™æœ€å¥½ç”¨booleanå­˜, ç”¨ä½æ•°ç»„ bit[] å¯ä»¥è®¾è®¡å¤šä¸ªhashç®—æ³•, ç”¨æ¥æ ¡éªŒæŸä¸€ç§hashCodeç›¸åŒçš„æƒ…å†µ å½±å“è¯¯åˆ¤çŽ‡3è¦ç´ : hashç®—æ³•ä¸ªæ•° k - æ•°æ®é‡n - æ•°ç»„é•¿åº¦ m å¸ƒéš†è¿‡æ»¤å™¨ å…¬å¼: k = 0.7*(m/n), æ­¤æ—¶çš„è¯¯åˆ¤çŽ‡æœ€å° å¤§æ•°æ®åŸºæœ¬ä»‹ç»æ•°æ® æ•°æ®å°±æ˜¯æ•°å€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šè¿‡è§‚å¯Ÿã€å®žéªŒæˆ–è®¡ç®—å¾—å‡ºçš„ç»“æžœã€‚æ•°æ®æœ‰å¾ˆå¤šç§ï¼Œæœ€ç®€å•çš„å°±æ˜¯æ•°å­—ã€‚ æ•°æ®ä¹Ÿå¯ä»¥æ˜¯æ–‡å­—ã€å›¾åƒã€å£°éŸ³ç­‰ã€‚æ•°æ®å¯ä»¥ç”¨äºŽç§‘å­¦ç ”ç©¶ã€è®¾è®¡ã€æŸ¥è¯ç­‰ã€‚ ç»“æž„åˆ’åˆ†: ç»“æž„åŒ– åŠç»“æž„åŒ– éžç»“æž„åŒ– å¤§æ•°æ®ç‰¹ç‚¹: 4V æ•°æ®é‡å¤§ 1 Byte =8 bit1 KB = 1,024 Bytes = 8192 bit1 MB = 1,024 KB = 1,048,576 Bytes1 GB = 1,024 MB = 1,048,576 KB1 TB = 1,024 GB = 1,048,576 MB ï¼ˆæ™®é€šç”¨æˆ·æ•°æ®çº§åˆ«ï¼‰1 PB = 1,024 TB = 1,048,576 GBï¼ˆä¼ä¸šçº§æ•°æ®çº§åˆ«ï¼‰1 EB = 1,024 PB = 1,048,576 TB1 ZB = 1,024 EB = 1,048,576 PBï¼ˆå…¨çƒæ•°æ®æ€»é‡çº§åˆ«ï¼‰ æ•°æ®å¢žé•¿é€Ÿåº¦å¿« æ•°æ®ç§ç±»å¤š æ–‡å­— å›¾ç‰‡ éŸ³é¢‘ è§†é¢‘.. æ•°æ®çš„ä»·å€¼å¯†åº¦ä½Ž æ•´ä½“ä»·å€¼é«˜ æ•°æ®æ¥æº å…¬å¸ä¸­çš„è‡ªå·±çš„ä¸šåŠ¡æ•°æ® æ·˜å® äº¬ä¸œ ç¬¬ä¸‰æ–¹ çˆ¬è™« çˆ¬æ•°æ® æ•°æ®å¤„ç† ç¼ºå¤±æ•°æ®çš„å¤„ç† è€ƒè™‘ç¼ºå¤±æ•°æ®æ˜¯å¦å½±å“æ•´ä½“çš„ä¸šåŠ¡é€»è¾‘ ä¸å½±å“ åˆ é™¤ å¦‚æžœæ˜¯å’Œé’±ç›¸å…³çš„æ•°æ® â€”-æ…Žé‡ ä¸èƒ½è½»æ˜“åˆ é™¤ æ•æ„Ÿæ•°æ® è„±æ•å¤„ç† â€“ åŠ å¯† æ•°æ®ä»·å€¼ äººç‰©ç”»åƒ æ ¹æ®æ ¹æ®ç”¨æˆ·æ•°æ®ç»™ç”¨æˆ·åšä¸€ä¸ªå…¨æ–¹ä½çš„åˆ†æžç”»åƒ å±žæ€§ï¼š äººè„‰ æ¶ˆè´¹æ°´å¹³ æ€§æ ¼ç‰¹ç‚¹ â€¦. å‡ ä¸ªæ¦‚å¿µé›†ç¾¤: å¤šä¸ªæœºå™¨å…±åŒåä½œå®ŒæˆåŒä¸€ä¸ªä»»åŠ¡, æ¯ä¸€ä¸ªæœºå™¨å«åšèŠ‚ç‚¹, å¤šä¸ªæœºå™¨å…±åŒç»„æˆçš„ç¾¤ä½“å«åšé›†ç¾¤ é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä¹‹é—´é€šè¿‡å±€åŸŸç½‘æˆ–å…¶ä»–æ–¹å¼é€šè®¯ åˆ†å¸ƒå¼: åˆ†è€Œæ²»ä¹‹ , ä¸€ä¸ªä»»åŠ¡å‘—åˆ†æˆå¤šä¸ªå­ä»»åŠ¡æ¨¡å—, æ¯ä¸ªä»»åŠ¡è·‘åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Š åŽŸæ¥ä¸€ä¸ªäººå¹²çš„äº‹æƒ…, çŽ°åœ¨å¤§å®¶åˆ†å·¥åŠ³åŠ¨ åˆ†å¸ƒå¼çš„æ–‡ä»¶ç³»ç»Ÿ , åˆ†å¸ƒå¼æ•°æ®åº“, åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿ è´Ÿè½½å‡è¡¡: Nginx æ¯ä¸ªèŠ‚ç‚¹åˆ†é…åˆ°çš„ä»»åŠ¡åŸºæœ¬å‡è¡¡ è´Ÿè½½å‡è¡¡æ˜¯è·Ÿæ¯ä¸ªèŠ‚ç‚¹è‡ªèº«çš„é…ç½®ç­‰åŒ¹é…çš„ ä¸å­˜åœ¨ç»å¯¹çš„å‡è¡¡ Hadoopæ¦‚å¿µ ä¸€ä¸ªåˆ†å¸ƒå¼çš„å¼€æºæ¡†æž¶ æ”¯æŒæˆåƒä¸Šä¸‡çš„èŠ‚ç‚¹, æ¯ä¸ªèŠ‚ç‚¹ä¾é æœ¬åœ°çš„è®¡ç®—å’Œå­˜å‚¨ åœ¨åº”ç”¨å±‚é¢æä¾›é«˜å¯ç”¨æ€§ å°†ç¡¬ä»¶é”™è¯¯çœ‹æˆä¸€ä¸ªå¸¸æ€ Hadoopçš„æ¨¡å— Common æ”¯æŒå…¶ä»– Hadoop æ¨¡å—çš„å…¬å…±å®žç”¨ç¨‹åº å°è£…: å·¥å…·ç±», RPCæ¡†æž¶ HDFS Hadoopçš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ, è´Ÿè´£æµ·é‡æ•°æ®çš„å­˜å‚¨ å°†æ–‡ä»¶åˆ‡åˆ†æˆæŒ‡å®šå¤§å°çš„æ•°æ®å—å¹¶ä»¥å¤šå‰¯æœ¬çš„å­˜å‚¨å½¢å¼å­˜å‚¨åœ¨å¤šä¸ªæœºå™¨ä¸Š æ•°æ®åˆ‡åˆ†, å¤šå‰¯æœ¬, å®¹é”™ç­‰æ“ä½œå¯¹ç”¨æˆ·æ˜¯é€æ˜Žçš„ æž¶æž„: ä¸»ä»Žæž¶æž„ ( Javaè¿›ç¨‹) ä¸»: namenode ä¸€ä¸ª ä»Ž: datenode å¤šä¸ª åŠ©ç†: SecondaryNamenode åˆ†æ‹…ä¸»è¿›ç¨‹çš„åŽ‹åŠ› YARN é›†ç¾¤çš„èµ„æºè°ƒåº¦æ¡†æž¶, è´Ÿè´£é›†ç¾¤çš„èµ„æºç®¡ç† æž¶æž„: ä¸»ä»Žæž¶æž„ ä¸»: ResourceManager â€“ è´Ÿè´£ç»Ÿç­¹èµ„æº ä»Ž: NodeManager MapReduce åˆ†å¸ƒå¼è®¡ç®—æ¡†æž¶, æœ‰è®¡ç®—ä»»åŠ¡çš„æ—¶å€™æ‰ä¼šæœ‰å“åº”çš„è¿›ç¨‹ Hadoopçš„æ­å»ºæ­å»ºå‰çš„å‡†å¤‡123456789101112131415161718192021222324252627282930313233343536373839404142æ­å»ºå‡†å¤‡ï¼š1ï¼‰ipé…ç½®2ï¼‰ä¸»æœºå vi /etc/sysconfig/network3ï¼‰ä¸»æœºæ˜ å°„4ï¼‰å…³é—­é˜²ç«å¢™å’Œsellinux service iptables stop vi /etc/selinux/config SELINUX=disabled5ï¼‰å°†ç³»ç»Ÿçš„å¯åŠ¨çº§åˆ«æ”¹ä¸º3 vi /etc/inittab6ï¼‰åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œå¹¶ä¸ºæ™®é€šç”¨æˆ·æ·»åŠ sudolersæƒé™ åˆ›å»ºç”¨æˆ·ï¼šuseradd ç”¨æˆ·å passwd ç”¨æˆ·å vi /etc/sudoers hadoop ALL=(ALL) ALL7ï¼‰é…ç½®å…å¯†ç™»å½• å…ˆåˆ‡æ¢åˆ°æ™®é€šç”¨æˆ· 1ï¼‰ç”Ÿæˆç§˜é’¥ ssh-keygen 2)å‘é€ç§˜é’¥ ssh-copy-id hadoop(ä¸»æœºå) éªŒè¯ï¼šssh hadoop 8ï¼‰å®‰è£…jdk å¸è½½jdkï¼š rpm -qa|grep jdk rpm -e java-1.7.0-openjdk-1.7.0.99-2.6.5.1.el6.x86_64 --nodeps9ï¼‰æ—¶é—´åŒæ­¥ ä¼ªåˆ†å¸ƒå¼ä¸éœ€è¦ åˆ†å¸ƒå¼éœ€è¦ï¼Œå¿…é¡»åš10)é€‰æ‹©å®‰è£…ç‰ˆæœ¬ï¼š ä¸é€‰å¤ªé™ˆæ—§çš„ç‰ˆæœ¬ä¹Ÿä¸é€‰æœ€æ–°çš„ç‰ˆæœ¬ 2.7.6 11)å®‰è£… ä¸€å®šåˆ‡æ¢ç”¨æˆ· æ™®é€šç”¨æˆ· æ–¹å¼1: ä¼ªåˆ†å¸ƒå¼æ‰€æœ‰è¿›ç¨‹å…¨éƒ¨è¿è¡Œåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162631ï¼‰ä¸Šä¼ 2ï¼‰è§£åŽ‹3ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶ é…ç½®æ–‡ä»¶çš„ç›®å½•ï¼šHADOOP_HOME/etc/hadoop éœ€è¦ä¿®æ”¹6ä¸ªé…ç½®æ–‡ä»¶ï¼š 1ï¼‰hadoop-env.sh export JAVA_HOME=/home/hadoop/jdk1.8.0_73/ 2)core-site.xml æ ¸å¿ƒé…ç½®æ–‡ä»¶ &lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;value&gt;hdfs://hadoop:9000&lt;/value&gt; &lt;/property&gt; 3)hdfs-site.xml &lt;property&gt; &lt;name&gt;dfs.replication&lt;/name&gt; &lt;value&gt;1&lt;/value&gt; &lt;/property&gt; 4)yarn-site.xml &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt; 5)mapred-site.xml &lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt; 6)slaves é…ç½®çš„æ˜¯ä»ŽèŠ‚ç‚¹çš„ä¿¡æ¯ 7)é…ç½®çŽ¯å¢ƒå˜é‡ export JAVA_HOME=/home/hadoop/jdk1.8.0_73 export HADOOP_HOME=/home/hadoop/hadoop-2.7.6 export PATH=$PATH:$JAVA_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin source /etc/rpofile éªŒè¯ hadoop version 8)å…ˆè¿›è¡Œæ ¼å¼åŒ– hadoop namenode -format 9)å¯åŠ¨ start-all.sh ä¸å»ºè®® å»ºè®®ä»¥ä¸‹å‘½ä»¤ï¼š start-dfs.sh start-yarn.sh 10ï¼‰éªŒè¯ jps 6ä¸ªè¿›ç¨‹ 3909 Jps 3736 ResourceManager 3401 DataNode 3306 NameNode 3836 NodeManager 3597 SecondaryNameNode é¡µé¢ï¼š hdfsï¼šnamenodeçš„ipï¼š50070 yarn:resourcemanagerçš„ipï¼š8088 æ–¹å¼2: å®Œå…¨åˆ†å¸ƒå¼å‚è€ƒæ–‡æ¡£ å„ä¸ªèŠ‚ç‚¹çš„å®‰è£…çš„æ™®é€šç”¨æˆ·åå¿…é¡»ç›¸åŒ å¯†ç ä¹Ÿå¾—ç›¸åŒ, æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦æ“ä½œ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879æ­å»ºå‡†å¤‡ï¼š 1ï¼‰ipé…ç½® 2ï¼‰ä¸»æœºå vi /etc/sysconfig/network 3ï¼‰ä¸»æœºæ˜ å°„ 4ï¼‰å…³é—­é˜²ç«å¢™å’Œsellinux service iptables stop vi /etc/selinux/config SELINUX=disabled 5ï¼‰å°†ç³»ç»Ÿçš„å¯åŠ¨çº§åˆ«æ”¹ä¸º3 6ï¼‰åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œå¹¶ä¸ºæ™®é€šç”¨æˆ·æ·»åŠ sudolersæƒé™ åˆ›å»ºç”¨æˆ·ï¼šuseradd ç”¨æˆ·å passwd ç”¨æˆ·å vi /etc/sudoers hadoop ALL=(ALL) ALL 7ï¼‰é…ç½®å…å¯†ç™»å½• å…ˆåˆ‡æ¢åˆ°æ™®é€šç”¨æˆ· æ¯å°æœºå™¨éƒ½éœ€è¦æ‰§è¡Œä¸‹é¢çš„æ“ä½œ å„ä¸ªèŠ‚ç‚¹ä¹‹é—´éƒ½åšä¸€ä¸‹ a. ç”Ÿæˆç§˜é’¥ ssh-keygen b. å‘é€ç§˜é’¥ ssh-copy-id hadoop(ä¸»æœºå) c. éªŒè¯ï¼šå„ä¸ªèŠ‚ç‚¹ä¹‹é—´éƒ½éœ€è¦åšç›¸äº’éªŒè¯ ssh hadoop01 ssh hadoop02 ssh hadoop03 8ï¼‰å®‰è£…jdk å¸è½½jdkï¼š rpm -qa|grep jdk rpm -e java-1.7.0-openjdk-1.7.0.99-2.6.5.1.el6.x86_64 --nodeps 9ï¼‰æ—¶é—´åŒæ­¥ ä¼ªåˆ†å¸ƒå¼ä¸éœ€è¦ åˆ†å¸ƒå¼éœ€è¦ï¼Œå¿…é¡»åš 1)ä¸èƒ½è”ç½‘çš„æ—¶å€™ æ‰‹åŠ¨æŒ‡å®š date -s æ—¶é—´ æˆ–è€…æ‰‹åŠ¨æ­å»ºä¸€ä¸ªæ—¶é—´æœåŠ¡å™¨ 2ï¼‰èƒ½è”ç½‘çš„æ—¶å€™ æ‰¾ä¸€ä¸ªå…¬ç½‘ä¸­çš„å…¬ç”¨çš„æ—¶é—´æœåŠ¡å™¨ æ‰€æœ‰èŠ‚ç‚¹çš„æ—¶é—´å’Œå…¬ç½‘ä¸­çš„æ—¶é—´æœåŠ¡å™¨ä¿æŒä¸€è‡´ ntpdate å…¬ç½‘çš„æ—¶é—´æœåŠ¡å™¨åœ°å€ å®Œå…¨åˆ†å¸ƒå¼å¿…é¡»è¦åš æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦æ‰§è¡Œ 10) é€‰æ‹©å®‰è£…ç‰ˆæœ¬ï¼š ä¸é€‰å¤ªé™ˆæ—§çš„ç‰ˆæœ¬ä¹Ÿä¸é€‰æœ€æ–°çš„ç‰ˆæœ¬ 2.7.6 11) å®‰è£… ä¸€å®šåˆ‡æ¢ç”¨æˆ· æ™®é€šç”¨æˆ· å…ˆåœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šæ‰§è¡Œæ‰€æœ‰çš„ä¿®æ”¹ åœ¨è¿œç¨‹å‘é€åˆ°å…¶ä»–èŠ‚ç‚¹ 1ï¼‰ä¸Šä¼  2ï¼‰è§£åŽ‹d 3ï¼‰é…ç½®çŽ¯å¢ƒå˜é‡ 4ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶ 6ä¸ªé…ç½®æ–‡ä»¶ é›†ç¾¤è§„åˆ’ .... .... 5)è¿œç¨‹å‘é€ scp -r hadoop-2.7.6 hadoop02:$PWD scp -r hadoop-2.7.6 hadoop03:$PWD scp -r /home/ap/apps/hadoop-2.7.6/etc/hadoop ap@cs1:/home/ap/apps/hadoop-2.7.6/etc è¿œç¨‹å‘é€/etc/pofile æ‰§è¡Œsource /etc/pofile 6ï¼‰è¿›è¡Œæ ¼å¼åŒ– å¿…é¡»åœ¨namenodeçš„èŠ‚ç‚¹ï¼ˆhdfsçš„ä¸»èŠ‚ç‚¹ï¼‰ hadoop namenode -format ä¸é…ç½®ç›®å½•é»˜è®¤/tmp ä¸´æ—¶ç›®å½• å¯ä»¥éšæ—¶å›žæ”¶çš„ 7)å¯åŠ¨ å¯åŠ¨hdfs start-dfs.sh åœ¨ä»»æ„èŠ‚ç‚¹éƒ½å¯ä»¥ å¯åŠ¨yarn start-yarn.sh åœ¨yarnçš„ä¸»èŠ‚ç‚¹æ‰§è¡Œ jpså‘½ä»¤æŸ¥çœ‹ ç½‘é¡µï¼š hdfs: hadoop01:50070 yarn hadoop03:8088 8) åŽ»æŽ‰è­¦å‘Šï¼ˆåœ¨/etc/profileæˆ–è€… .bash_profile æˆ–è€… .zshrcä¸­æ·»åŠ ï¼‰ export HADOOP_HOME_WARN_SUPPRESS=1 æµ‹è¯•yarné›†ç¾¤æ˜¯å¦å¯åŠ¨æˆåŠŸ (æäº¤MapReduceä¾‹å­ç¨‹åºè¯•è·‘) ls apps/hadoop-2.7.6/share/hadoop/mapreduce bin/hadoop jar hadoop-mapreduce-examples-2.6.5.jar pi 5 5 å¯èƒ½é‡åˆ°çš„é”™è¯¯æ­å»ºè¿‡ç¨‹ä¸­ ä¸»æœºæ‰¾ä¸åˆ° /etc/sysconfig/network /etc/hosts é‡å¯æœºå™¨ ä½•æ—¶åŒ–çš„æ—¶å€™æŠ¥é”™ é…ç½®æ–‡ä»¶é”™è¯¯, æ ¹æ®é”™è¯¯åŽ»ç›¸åº”æ–‡ä»¶è¿›è¡Œè°ƒæ•´, ä¿®æ”¹å®Œæ¯•åŽ, é‡æ–°æ ¼å¼åŒ–ç›´åˆ°æ ¼å¼åŒ–æˆåŠŸ å¯åŠ¨è¿‡ç¨‹ä¸­æŸäº›è¿›ç¨‹å¯åŠ¨ä¸äº†æŽªè¾ž1: æš´åŠ› å…¨éƒ¨å…³é—­é›†ç¾¤é‡æ–°å¯åŠ¨ stop-dfs.sh åœ¨ä»»æ„èŠ‚ç‚¹æ‰§è¡Œ stop-yarn.sh åœ¨yarnçš„ä¸»èŠ‚ç‚¹å¯åŠ¨ é‡æ–°å¯åŠ¨, ç›´æŽ¥å¯åŠ¨å°±å¯ä»¥äº† start-dfs.sh start-yarn.sh æŽªæ–½2: å•ç‹¬å¯åŠ¨æŸäº›è¿›ç¨‹å•ç‹¬å¯åŠ¨hdfsçš„ç›¸å…³è¿›ç¨‹ hadoop-daemon.sh start hdfs è¿‡ç¨‹ hadoop-daemon.sh start namenode hadoop-daemon.sh start secondarynamenode å•ç‹¬å¯åŠ¨yarnçš„ç›¸å…³å‘½ä»¤ yarn-daemon.sh start yarn çš„ç›¸å…³è¿‡ç¨‹ yarn-daemon.sh start resourcemanager ==æ­å»ºè¿‡ç¨‹ä¸­çš„æ³¨æ„äº‹é¡¹== é›†ç¾¤çš„åªèƒ½æˆåŠŸçš„æ ¼å¼åŒ–ä¸€æ¬¡, ä¸æˆåŠŸçš„è¦ä¸€ç›´åˆ°æ ¼å¼åŒ–æˆåŠŸ, æˆåŠŸåŽå°±ä¸èƒ½å†æ¬¡æ ¼å¼åŒ– æ ¼å¼åŒ–çš„è¿‡ç¨‹ä¸­: åˆ›å»ºå‡ºæ¥namenodeå­˜å‚¨çš„ç›¸å…³ç›®å½• versionæ–‡ä»¶: è®°å½•ä»ªé›†ç¾¤çš„ç‰ˆæœ¬ä¿¡æ¯çš„, æ¯æ ¼å¼åŒ–ä¸€æ¬¡, å°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ä¿¡æ¯ 123456namespaceID=1163449973clusterID=CID-47f10077-2aef-4df6-a364-1a735515a100 #è®°å½•é›†ç¾¤çš„ç‰ˆæœ¬ä¿¡æ¯çš„cTime=0storageType=NAME_NODEblockpoolID=BP-1527239677-192.168.75.162-1527817150436layoutVersion=-63 å¯åŠ¨hdfsçš„æ—¶å€™: ç”Ÿæˆdatanodeçš„ç›¸å…³æ•°æ®ä¿¡æ¯ version: è®°å½•datanode ç›¸å…³ç‰ˆæœ¬çš„ä¿¡æ¯ 1clusterID=CID-47f10077-2aef-4df6-a364-1a735515a100 ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„clusterIDç›¸åŒçš„æ—¶å€™, datanode æ‰ä¼šè®¤ä¸ºæ˜¯åŒä¸€ä¸ªé›†ç¾¤çš„ æƒ³è¦é‡å¤æ ¼å¼åŒ–, åˆ†3æ­¥èµ° åœæ­¢æ‰€æœ‰æœåŠ¡ åˆ é™¤ namenode çš„æ•°æ®ç›®å½• rm -rf /home/ap/data/hadoopdata/name åˆ é™¤ datanode çš„æ•°æ®ç›®å½• rm -rf /home/ap/data/hadoopdata/data æ­¤æ—¶æ‰å¯ä»¥é‡æ–°æ ¼å¼åŒ–, å¦åˆ™ä¼šé€ æˆ datanode å¯åŠ¨ä¸äº†, æ³¨æ„, å…³é—­é˜²ç«å¢™, å…³é—­vpn ä¹Ÿå¯ä»¥ä¸€æ­¥åˆ°ä½ rm -rf /home/ap/data å†é‡æ–°æ ¼å¼åŒ– é›†ç¾¤æ­å»ºè¿‡ç¨‹ä¸­çŽ¯å¢ƒå˜é‡çš„é…ç½®(jdk. hadoopâ€¦) åœ¨Linuxä¸­ä¿®æ”¹çŽ¯å¢ƒå˜é‡çš„åœ°æ–¹æœ‰3ä¸ª /etc/profile ç³»ç»ŸçŽ¯å¢ƒå˜é‡, é’ˆå¯¹æ‰€æœ‰ç”¨æˆ·çš„ ~/.bashrc ç”¨æˆ·çŽ¯å¢ƒå˜é‡ ~/.bash_profile ç”¨æˆ·çŽ¯å¢ƒå˜é‡ è¿™3ä¸ªé…ç½®æ–‡ä»¶çš„åŠ è½½é¡ºåº /etc/profile &gt; .bashrc &gt; .bash_profile ç”Ÿæ•ˆ: æœ€åŽä¸€æ¬¡åŠ è½½çš„ç”Ÿæ•ˆ æ—¶é—´åŒæ­¥é—®é¢˜ åªè¦æ˜¯å®Œå…¨åˆ†å¸ƒå¼çš„, å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´ä¸€å®šè¦åšæ—¶é—´åŒæ­¥, ç›®çš„: è¦å’Œ åŒ—äº¬/ä¸Šæµ· æ—¶é—´ä¿æŒä¸€è‡´? no é›†ç¾¤èƒŒéƒ¨å„ä¸ªèŠ‚ç‚¹ä¹‹é—´æ—¶é—´ä¿æŒä¸€è‡´ yes why ? é›†ç¾¤å†…éƒ¨å„ä¸ªèŠ‚ç‚¹ä¹‹é—´éœ€è¦é€šä¿¡, å°¤å…¶æ˜¯datanode å’Œ namenodeä¹‹é—´, ä»–ä»¬ä¹‹é—´çš„é€šä¿¡ä¾é å¿ƒè·³æœºåˆ¶, ä»–ä»¬ä¹‹é—´çš„å¿ƒè·³å­˜åœ¨ä¸€ä¸ªæ—¶é—´æŽ§åˆ¶, è¿™ä¸ªæ—¶é—´æ˜¯ 630s, ä»–ä»¬ä¹‹å‰éœ€è¦åšæ—¶é—´åŒæ­¥ é›†ç¾¤çš„å®‰è£…æ¨¡å¼1. å•æœºæ¨¡å¼ ç›´æŽ¥è§£åŽ‹çš„æ–¹å¼, ä»€ä¹ˆéƒ½ä¸é…ç½®, å¹¶ä¸”åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Š æ²¡æœ‰åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ, æ‰€æœ‰çš„æ–‡ä»¶éƒ½æ˜¯æ¥è‡ªæœ¬åœ°, åªèƒ½å¯¹æœ¬åœ°çš„æ–‡ä»¶è¿›è¡Œè¯»å†™ å‡ ä¹Žæ²¡äººç”¨, æµ‹è¯•æ—¶å¶å°”ä¼šç”¨ 2. ä¼ªåˆ†å¸ƒå¼ å¯ä»¥çœ‹åšè·‘åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„å®Œå…¨åˆ†å¸ƒå¼ æœ‰åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ, åªä¸è¿‡è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ ==3. å®Œå…¨åˆ†å¸ƒå¼==å‚è€ƒæ–‡æ¡£ è§„åˆ’ ç›®å‰ç–‘ç‚¹: NodeManageræ˜¯æ ¹æ®ä»€ä¹ˆé…ç½®åˆ°æ¯å°æœºå™¨ä¸Šçš„?? æ ¹æ®è¡¨å¾, å¯èƒ½æ˜¯æ ¹æ® slaveæ–‡ä»¶ ä¸»æœºå / IP HDFS YARN cts1 / 192.168.56.131 NameNode ç©ºçš„ cts2 / 192.168.56.132 DataNode NodeManager cts3 / 192.168.56.133 DataNode + Secondary NameNode NodeManager cts4 / 192.168.56.134 DataNode NodeManager +ResourceManager hdfs ä¸ºä¾‹ : åœ¨å®è§‚çœ‹å°±æ˜¯ä¸€ä¸ªå¤§çš„èŠ‚ç‚¹, åŽå°é‡‡ç”¨çš„ç¡¬ä»¶é…ç½®æ˜¯ä¸‰å¤©æœºå™¨çš„ç¡¬ä»¶é…ç½®ä¹‹å’Œ, ä½†æ˜¯å¯¹ç”¨æˆ·æ¥è®²å®Œå…¨æ„Ÿè§‰ä¸åˆ° åœ¨å®Œå…¨åˆ†å¸ƒå¼ä¸­, æœ‰ä¸»èŠ‚ç‚¹, æœ‰ä»ŽèŠ‚ç‚¹ ä¸»èŠ‚ç‚¹ namenodeåªæœ‰ä¸€ä¸ª, ä»ŽèŠ‚ç‚¹æœ‰å¤šä¸ª, çœŸå®žç”Ÿäº§ä¸­, namenodeä¼šå•ç‹¬åšä¸€ä¸ªèŠ‚ç‚¹ å¦‚æžœé›†ç¾¤ä¸­namenodeå®•æœº, æ•´ä¸ªé›†ç¾¤è¿˜å¯ä»¥ä½¿ç”¨å—? ä¸å¯ä»¥ namenode: ä¸»è¦ä½œç”¨å­˜å‚¨å…ƒæ•°æ® (ç®¡ç†æ•°æ®çš„æ•°æ®, å­˜å‚¨çš„å°±æ˜¯datanodeå­˜å‚¨æ•°æ®çš„æè¿°) datanode: è´Ÿè´£é›†ç¾¤ä¸­çœŸæ­£å¤„ç†æ•°æ®å­˜å­˜å‚¨çš„ å¦‚æžœnamenode å®•æœº, é›†ç¾¤æ— æ³•ä½¿ç”¨, è¿™ä¹Ÿæ˜¯å®Œå…¨åˆ†å¸ƒå¼çš„ä¸€å¤§ç¼ºç‚¹, å­˜åœ¨å•ç‚¹æ•…éšœé—®é¢˜ ä¸€èˆ¬ç”Ÿäº§ä¸­ä¸å¤ªä½¿ç”¨, å­¦ä¹ , æµ‹è¯•, èŠ‚ç‚¹ä¸ªæ•°æ¯”è¾ƒå°‘çš„æ—¶å€™, æœ‰æ—¶å€™ä¹Ÿä¼šä½¿ç”¨è¿™ç§æ¨¡å¼ èŠ‚ç‚¹æ•°ç›®è¶Šå¤š, namenodeå®•æœºçš„å¯èƒ½æ€§è¶Šå¤§, åŽ‹åŠ›å¤ªå¤§ åŠ©ç†secondarynamenode: åªæ˜¯ä¸€ä¸ªåŠ©ç†, åªæ˜¯åˆ†æ‹…namenodeçš„åŽ‹åŠ›, ä½†æ˜¯ä¸èƒ½ä»£æ›¿ æž¶æž„: ä¸€ä¸»å¤šä»Ž ==4. é«˜å¯ç”¨== æ¦‚å¿µ: é›†ç¾¤å¯ä»¥æŒç»­å¯¹å¤–æä¾›æœåŠ¡, åšåˆ° 7*24 å°æ—¶ä¸é—´æ–­ ä¾èµ–äºŽzookeeper, æ­å»ºæ”¾åœ¨ zookeeperè¯¾ç¨‹ä¹‹åŽ é›†ç¾¤æž¶æž„: åŒä¸»å¤šä»Ž æœ‰2ä¸ª namenode, ä½†æ˜¯åœ¨åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªæ˜¯ æ´»è·ƒçš„ namenode, æˆ‘ä»¬æŠŠè¿™ä¸ªæ´»è·ƒçš„namenode æˆä¸º active çš„, å¦å¤–ä¸€ä¸ªæ˜¯å¤„ç†çƒ­å¤‡ä»½çŠ¶æ€, æˆ‘ä»¬å°†è¿™ä¸ªèŠ‚ç‚¹å« standby, ä½†æ˜¯2ä¸ªä¸»èŠ‚ç‚¹å­˜å‚¨çš„å…ƒæ•°æ®æ˜¯ä¸€æ¨¡ä¸€æ ·çš„, å½“ active namenodeå®•æœºçš„æ—¶å€™, standbyçš„namenode å¯ä»¥ç«‹é©¬åˆ‡æ¢ä¸º active çš„namenode, å¯¹å¤–æä¾›æœåŠ¡, å°±å¯ä»¥åšåˆ° é›†ç¾¤æŒç»­å¯¹å¤–æä¾›æœåŠ¡çš„åŠŸèƒ½ å¦‚æžœè¿‡ä¸€æ®µæ—¶é—´, å®•æœºçš„ namenode åˆæ´»è¿‡æ¥äº†, å®•æœºçš„ namenode åªèƒ½æ˜¯å˜æˆ standby çš„ ç¼ºé™·: åœ¨åŒä¸€æ—¶é—´ä¸­, é›†ç¾¤ä¸­åªæœ‰ä¸€ä¸ªactive çš„ namenode, ä¹Ÿå°±æ˜¯è¯´ é›†ç¾¤ä¸­æœ‰ä¸»èŠ‚ç‚¹èƒ½åŠ›çš„èŠ‚ç‚¹ åªæœ‰ä¸€ä¸ª, å¦‚æžœé›†ç¾¤ä¸­, èŠ‚ç‚¹ä¸ªæ•°è¿‡å¤š(1000) çš„æ—¶å€™, ä¼šé€ æˆnamenodeçš„å´©æºƒ, namenodeå­˜å‚¨çš„æ˜¯å…ƒæ•°æ®, å…ƒæ•°æ®è¿‡å¤šçš„æ—¶å€™, ä¼šé€ æˆnamenodeçš„å´©æºƒ(ä¸¤ä¸ªéƒ½å´©æºƒ), æ²¡æœ‰çœŸæ­£çš„åˆ†æ‹…namenode çš„åŽ‹åŠ› å®žé™…ç”Ÿäº§å¤šä½¿ç”¨é«˜å¯ç”¨ 5. è”é‚¦æœºåˆ¶ åŒä¸€ä¸ªé›†ç¾¤ä¸­å¯ä»¥æœ‰å¤šä¸ªä¸»èŠ‚ç‚¹, è¿™äº›ä¸»èŠ‚ç‚¹çš„åœ°ä½æ˜¯ä¸€æ ·çš„. åŒä¸€æ—¶é—´, å¯ä»¥æœ‰å¤šä¸ªæ´»è·ƒçš„ namenode è¿™äº› namenode å…±åŒä½¿ç”¨é›†ç¾¤ä¸­æ‰€æœ‰çš„ datanode, æ¯ä¸ªnamenode åªè´Ÿè´£ç®¡ç†é›†ç¾¤ä¸­çš„ datanodeä¸Šçš„ä¸€éƒ¨åˆ†æ•°æ® ä¸€èˆ¬è¶…å¤§é›†ç¾¤æ­å»ºçš„æ—¶å€™: è”é‚¦ + é«˜å¯ç”¨ è¶…å¤§é›†ç¾¤ä½¿ç”¨ æ¯ä¸ªnamenodeè¿›è¡Œæ•°æ®ç®¡ç†é çš„Block Pool IDç›¸åŒ ä¸åŒçš„namenodeç®¡ç†çš„æ•°æ®Block Pool ID ä¸åŒ]]></content>
      <categories>
        <category>Hadoop</category>
        <category>hadoop</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoopä½“ç³»æ¦‚è§ˆ]]></title>
    <url>%2F2018%2F05%2F31%2FHadoop%2F0-Hadoop%2FHadoop%E4%BD%93%E7%B3%BB%E6%A6%82%E8%A7%88%2F</url>
    <content type="text"><![CDATA[Hadoopæ ¸å¿ƒç»„ä»¶æ•´ä½“ç›´è§‚æ¦‚è§ˆ 1. åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸHDFS1.1 åŸºæœ¬æ¦‚å¿µ å°†æ–‡ä»¶åˆ‡åˆ†æˆæŒ‡å®šå¤§å°çš„æ•°æ®å—å¹¶ä»¥å¤šå‰¯æœ¬çš„å­˜å‚¨å½¢å¼å­˜å‚¨åœ¨å¤šä¸ªæœºå™¨ä¸Š æ•°æ®åˆ‡åˆ†, å¤šå‰¯æœ¬, å®¹é”™ç­‰æ“ä½œå¯¹ç”¨æˆ·æ˜¯é€æ˜Žçš„ 1.2 å›¾ç¤º 1.3 HDFSæž¶æž„ Datanode å®šæœŸå‘ Namenode å‘ Hearbeat å…ƒæ•°æ®ä¿¡æ¯ï¼š å¤šä»½å¤‡ä»½ 1.4 HDFSçš„ IO æ“ä½œ ä¸Šé¢çš„æ˜¯è¯» å®¢æˆ·ç«¯å…ˆå‘ NameNode å¯»å€ ç„¶åŽå†æ‰¾ DataNode æ‹¿æ•°æ® ä¸‹é¢çš„æ˜¯å†™ HDFS ä¸æ”¯æŒä¿®æ”¹ï¼Œ æ²¡æœ‰ leader è§’è‰²ï¼Œ ä¸æ”¯æŒå¹¶å‘å†™ï¼Œ åªèƒ½æ”¯æŒéžå¹¶å‘çš„è¿½åŠ  HBase æ”¯æŒå¹¶å‘å†™å’Œä¿®æ”¹ åˆ é™¤ï¼š åˆ é™¤çš„æ˜¯å…ƒæ•°æ®ï¼ˆç´¢å¼•ä¿¡æ¯ï¼‰ Datanode ä¼šå®šæœŸå‘ Namenode å‘é€å¿ƒè·³ï¼Œ åŒæ­¥ä¿¡æ¯ï¼Œ å½“ Namenode å‘çŽ° Datanode ä¸Šæ²¡æœ‰è‡ªå·±å­˜å‚¨çš„ä¿¡æ¯æ—¶ï¼Œå°±ä¼šæŠŠè¿™éƒ¨åˆ†ä¿¡æ¯åˆ é™¤æŽ‰ã€‚ 1.5 HDFS å‰¯æœ¬å­˜æ”¾ç­–ç•¥ å¤åˆ¶å› å­ä¸º3æ—¶çš„ å­˜æ”¾ç­–ç•¥ å¦‚æžœå†™å…¥è€…åœ¨ä¸€ä¸ª datanode ä¸Šï¼Œ åˆ™æŠŠä¸€ä»½æ‹·è´æ”¾åœ¨æœ¬åœ°æœºå™¨ä¸Šï¼Œ å¦åˆ™éšæœºæ”¾åˆ°ä¸€ä¸ª datande ä¸Š å¦ä¸€ä¸ªå‰¯æœ¬æ”¾åœ¨ä¸åŒçš„ï¼ˆè¿œç¨‹ï¼‰æœºæž¶çš„èŠ‚ç‚¹ä¸Šï¼Œ æœ€åŽä¸€ä¸ªå‰¯æœ¬å­˜æ”¾åœ¨åŒä¸€ä¸ªæœºæž¶çš„ä¸åŒèŠ‚ç‚¹ä¸Š è¿™ä¸€ç­–ç•¥å‰Šå‡äº†æœºæž¶é—´çš„å†™å…¥æµé‡ï¼Œé€šå¸¸æé«˜äº†å†™å…¥æ€§èƒ½ å¤åˆ¶å› å­å¤§äºŽ3ï¼Œ åˆ™éšæœºç¡®å®šç¬¬4ä¸ªå’Œå…¶å®ƒçš„å‰¯æœ¬ä½ç½®ï¼ŒåŒæ—¶å°†æ¯ä¸ªæ‹·è´çš„æ•°ç›®ä¿æŒåœ¨ä¸Šé™ä»¥ä¸‹(åŸºæœ¬ä¸Šæ˜¯(å‰¯æœ¬æ•° - 1) / racks + 2)ã€‚ 2. èµ„æºè°ƒåº¦ç³»ç»Ÿ YARN2.1 åŸºæœ¬æ¦‚å¿µ YARN: Yet Another Resource Negotiator è´Ÿè´£æ•´ä¸ªé›†ç¾¤èµ„æºçš„ç®¡ç†å’Œè°ƒåº¦ YAENç‰¹ç‚¹: æ‰©å±•æ€§ &amp; å®¹é”™æ€§ &amp; å¤šæ¡†æž¶èµ„æºç»Ÿä¸€è°ƒåº¦ 2.2 å›¾ç¤º 3. åˆ†å¸ƒå¼è®¡ç®—æ¡†æž¶ MapReduce3.1 åŸºæœ¬æ¦‚å¿µ æºäºŽGoogleçš„MapReduceè®ºæ–‡, è®ºæ–‡å‘è¡¨äºŽ2004å¹´12æœˆ MapReduceæ˜¯Google MapReduceçš„å…‹éš†ç‰ˆ MapReduceçš„ç‰¹ç‚¹: æ‰©å±•æ€§ &amp; å®¹é”™æ€§ &amp; æµ·é‡æ•°æ®ç¦»çº¿å¤„ç† 3.2 å›¾ç¤º Hadoopä¼˜åŠ¿1. é«˜å¯é æ€§ æ•°æ®å­˜å‚¨: æ•°æ®å—å¤šå‰¯æœ¬ æ•°æ®è®¡ç®—: é‡æ–°è°ƒåº¦ä½œä¸šè®¡ç®— 2. é«˜æ‰©å±•æ€§ å­˜å‚¨/è®¡ç®—èµ„æºä¸å¤Ÿæ—¶, å¯ä»¥æ¨ªå‘çš„çº¿æ€§æ‰©å±•æœºå™¨ ä¸€ä¸ªé›†ç¾¤ä¸­å¯ä»¥åŒ…å«æ•°ä»¥åƒè®¡çš„èŠ‚ç‚¹ 3. å…¶å®ƒ å­˜å‚¨åœ¨å»‰ä»·æœºå™¨ä¸Š, é™ä½Žæˆæœ¬ æˆç†Ÿçš„ç”Ÿæ€åœˆ Hadoopçš„å‘å±•å²è§æ–‡ç« : Hadoopåå¹´è§£è¯»ä¸Žå‘å±•é¢„æµ‹ Hadoopå®˜ç½‘ Hadoopç”Ÿæ€ç³»ç»Ÿ1. å›¾ç¤º 2. ç‰¹ç‚¹ å¼€æº, ç¤¾åŒºæ´»è·ƒ å›Šæ‹¬äº†å¤§æ•°æ®å¤„ç†çš„æ–¹æ–¹é¢é¢ æˆç†Ÿçš„ç”Ÿæ€åœˆ Hadoopå¸¸ç”¨å‘è¡Œç‰ˆåŠé€‰åž‹ Apache Hadoop CDH : Cloudera Distributed Hadoop ï¼ˆå›½å†…ç”¨çš„æ¯”è¾ƒå¤šï¼‰ HDP : Hortonworks Data Platform ä½¿ç”¨: CDHä½¿ç”¨å æ¯” 60-70 hadoop: hadoop-2.6.0-cdh5.7.0 hive : hive-1.1.0-cdh5.7.0]]></content>
      <categories>
        <category>Hadoop</category>
        <category>hadoop</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Hadoop</tag>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaåŸºç¡€å¢žå¼º-2 å¹¶å‘ç¼–ç¨‹]]></title>
    <url>%2F2018%2F05%2F30%2FJava%2FJava%E5%9F%BA%E7%A1%80%E5%A2%9E%E5%BC%BA-2%2F</url>
    <content type="text"><![CDATA[1. å¤šçº¿ç¨‹åŸºæœ¬çŸ¥è¯†1.1 å¤šçº¿ç¨‹è¿è¡Œçš„åŽŸç† åŽŸç†ï¼šCPU åœ¨çº¿ç¨‹ä¸­åšæ—¶é—´ç‰‡çš„åˆ‡æ¢ã€‚ ä¸€ä¸ª(å¤šæ ¸ä¸­çš„ä¸€ä¸ª) CPU åœ¨åœ¨è¿è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­æŸä¸ªæ—¶åˆ»ç‚¹ä¸Šï¼Œåªèƒ½è¿è¡Œä¸€ä¸ªç¨‹åºã€‚è€Œ CPU å¯ä»¥åœ¨ å¤šä¸ªç¨‹åºä¹‹é—´è¿›è¡Œé«˜é€Ÿçš„åˆ‡æ¢ (è½®è¯¢åˆ¶)ã€‚è€Œåˆ‡æ¢é¢‘çŽ‡å’Œé€Ÿåº¦å¤ªå¿«ï¼Œå¯¼è‡´äººçš„è‚‰çœ¼çœ‹ä¸åˆ°ã€‚ 1.2 å®žçŽ°çº¿ç¨‹çš„ä¸¤ç§æ–¹å¼ ç»§æ‰¿ Thread å£°æ˜Žå®žçŽ°RunnableæŽ¥å£ è¿˜å¯ä»¥å®žçŽ°CallableæŽ¥å£ 1.3 çº¿ç¨‹çš„çŠ¶æ€å›¾è§£ æ–°å»ºçŠ¶æ€ï¼ˆNewï¼‰ï¼šæ–°åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚ å°±ç»ªçŠ¶æ€ï¼ˆRunnableï¼‰ï¼šçº¿ç¨‹å¯¹è±¡åˆ›å»ºåŽï¼Œå…¶ä»–çº¿ç¨‹è°ƒç”¨äº†è¯¥å¯¹è±¡çš„ start()æ–¹æ³•ã€‚è¯¥çŠ¶æ€ çš„çº¿ç¨‹ä½äºŽå¯è¿è¡Œçº¿ç¨‹æ± ä¸­ï¼Œå˜å¾—å¯è¿è¡Œï¼Œç­‰å¾…èŽ·å– CPU çš„ä½¿ç”¨æƒã€‚ è¿è¡ŒçŠ¶æ€ï¼ˆRunningï¼‰ï¼šå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹èŽ·å–äº† CPUï¼Œæ‰§è¡Œç¨‹åºä»£ç ã€‚ é˜»å¡žçŠ¶æ€ï¼ˆBlockedï¼‰ï¼šé˜»å¡žçŠ¶æ€æ˜¯çº¿ç¨‹å› ä¸ºæŸç§åŽŸå› æ”¾å¼ƒ CPU ä½¿ç”¨æƒï¼Œæš‚æ—¶åœæ­¢è¿è¡Œã€‚ ç›´åˆ°çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œæ‰æœ‰æœºä¼šè½¬åˆ°è¿è¡ŒçŠ¶æ€ã€‚é˜»å¡žçš„æƒ…å†µåˆ†ä¸‰ç§ï¼š ç­‰å¾…é˜»å¡žï¼šè¿è¡Œçš„çº¿ç¨‹æ‰§è¡Œ wait()æ–¹æ³•ï¼ŒJVM ä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥ç­‰å¾…æ± ä¸­ã€‚(wait ä¼šé‡Š æ”¾æŒæœ‰çš„é”) åŒæ­¥é˜»å¡žï¼šè¿è¡Œçš„çº¿ç¨‹åœ¨èŽ·å–å¯¹è±¡çš„åŒæ­¥é”æ—¶ï¼Œè‹¥è¯¥åŒæ­¥é”è¢«åˆ«çš„çº¿ç¨‹å ç”¨ï¼Œåˆ™ JVM ä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥é”æ± ä¸­ã€‚ å…¶ä»–é˜»å¡žï¼šè¿è¡Œçš„çº¿ç¨‹æ‰§è¡Œ sleep()æˆ– join()æ–¹æ³•ï¼Œæˆ–è€…å‘å‡ºäº† I/O è¯·æ±‚æ—¶ï¼ŒJVM ä¼šæŠŠ è¯¥çº¿ç¨‹ç½®ä¸ºé˜»å¡žçŠ¶æ€ã€‚å½“ sleep()çŠ¶æ€è¶…æ—¶ã€join()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ã€æˆ–è€… I/O å¤„ç†å®Œæ¯• æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚ï¼ˆæ³¨æ„ï¼šsleep æ˜¯ä¸ä¼šé‡Šæ”¾æŒæœ‰çš„é”ï¼‰ æ­»äº¡çŠ¶æ€ï¼ˆDeadï¼‰ï¼šçº¿ç¨‹æ‰§è¡Œå®Œäº†æˆ–è€…å› å¼‚å¸¸é€€å‡ºäº† run()æ–¹æ³•ï¼Œè¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚ 1.4 å‡ ä¸ªé‡è¦çš„æ–¹æ³•çš„åŒºåˆ«ï¼š sleep(timeout)ï¼šå½“å‰çº¿ç¨‹è¿›å…¥é˜»å¡žçŠ¶æ€ï¼Œæš‚åœæ‰§è¡Œä¸€å®šæ—¶é—´ï¼Œä¸ä¼šé‡Šæ”¾é”æ ‡è®° join()ï¼šjoin()æ–¹æ³•ä¼šä½¿å½“å‰çº¿ç¨‹ç­‰å¾…è°ƒç”¨ join()æ–¹æ³•çš„çº¿ç¨‹ç»“æŸåŽæ‰èƒ½ç»§ç»­æ‰§è¡Œ yield()ï¼šè°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹é‡å›žå¯æ‰§è¡ŒçŠ¶æ€ï¼Œä¸ä¼šé‡Šæ”¾é”æ ‡è®°ï¼Œå¯ä»¥ç†è§£ä¸ºäº¤å‡º CPU æ—¶é—´ç‰‡ï¼Œ ä½†æ˜¯ä¸ä¸€å®šæœ‰æ•ˆæžœï¼Œå› ä¸ºæœ‰å¯èƒ½åˆè¢«é©¬ä¸Šæ‰§è¡Œã€‚è¯¥æ–¹æ³•çš„çœŸæ­£ä½œç”¨æ˜¯ä½¿å…·æœ‰ç›¸åŒæˆ–è€…æ›´é«˜ä¼˜ å…ˆçº§çš„æ–¹æ³•å¾—åˆ°æ‰§è¡Œæœºä¼šã€‚ wait(timeout)ï¼šwait æ–¹æ³•é€šå¸¸å’Œ notify()/notifyAll()æ­é…ä½¿ç”¨ï¼Œå½“å‰çº¿ç¨‹æš‚åœæ‰§è¡Œï¼Œä¼šé‡Šæ”¾é” æ ‡è®°ã€‚è¿›å…¥å¯¹è±¡ç­‰å¾…æ± ã€‚ç›´åˆ°è°ƒç”¨ notify()æ–¹æ³•ä¹‹åŽï¼Œçº¿ç¨‹è¢«ç§»åŠ¨åˆ°é”æ ‡è®°ç­‰å¾…æ± ã€‚åªæœ‰é” æ ‡è®°ç­‰å¾…æ± çš„çº¿ç¨‹æ‰èƒ½èŽ·å¾—é” 1.5 Joinçš„ç”¨æ³•è”åˆçº¿ç¨‹: çº¿ç¨‹çš„joinæ–¹æ³•è¡¨ç¤ºä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹å®ŒæˆåŽæ‰æ‰§è¡Œã€‚æœ‰äººä¹ŸæŠŠè¿™ç§æ–¹å¼ç§°ä¸ºè”åˆçº¿ç¨‹ï¼Œå°±æ˜¯è¯´æŠŠå½“å‰çº¿ç¨‹å’Œå½“å‰çº¿ç¨‹æ‰€åœ¨çš„çº¿ç¨‹è”åˆæˆä¸€ä¸ªçº¿ç¨‹ã€‚joinæ–¹æ³•è¢«è°ƒç”¨ä¹‹åŽï¼Œçº¿ç¨‹å¯¹è±¡å¤„äºŽé˜»å¡žçŠ¶æ€ã€‚ é€‚ç”¨äºŽAçº¿ç¨‹éœ€è¦ç­‰åˆ°Bçº¿ç¨‹æ‰§è¡Œå®Œæ¯•,å†æ‹¿Bçº¿ç¨‹çš„ç»“æžœå†ç»§ç»­è¿è¡ŒAçº¿ç¨‹. è¯´äººè¯: Açº¿ç¨‹éœ€è¦æ‹¿åˆ°Bçº¿ç¨‹çš„æ‰§è¡Œç»“æžœ,æ‰èƒ½ç»§ç»­å¾€ä¸‹. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081class Join extends Thread&#123; @Override public void run() &#123; for (int i = 0; i &lt; 50; i++) &#123; System.out.println("This is join: " + i); &#125; &#125;public class JoinThread &#123; public static void main(String[] args) throws InterruptedException &#123; System.out.println("begin..."); Join joinThread = new Join();//åˆ›å»ºjoinçº¿ç¨‹å¯¹è±¡ for (int i = 0; i &lt; 50; i++) &#123; System.out.println("main: " +i); if (i == 10)&#123; //å¯åŠ¨joinå¯¹è±¡ joinThread.start(); &#125; if (i == 20)&#123; System.out .println("------------------------------------------"); joinThread.join();//åœ¨æ­¤å¤„å¼ºåˆ¶è¿è¡Œè¯¥çº¿ç¨‹ &#125; &#125; &#125;&#125; ===================æ‰§è¡Œç»“æžœ===================begin...main: 0main: 1main: 2main: 3main: 4main: 5main: 6main: 7main: 8main: 9main: 10main: 11main: 12main: 13This is join: 0main: 14This is join: 1This is join: 2This is join: 3main: 15This is join: 4main: 16main: 17main: 18main: 19main: 20------------------------------------------This is join: 5This is join: 6This is join: 7This is join: 8This is join: 9This is join: 10......This is join: 44This is join: 45This is join: 46This is join: 47This is join: 48This is join: 49main: 21main: 22main: 23main: 24main: 25main: 26main: 27main: 28main: 29main: 30 2. JavaåŒæ­¥å…³é”®è¯è§£é‡Š2.1. synchronizedå±žäºŽ JVM çº§åˆ«åŠ é”ï¼Œåº•å±‚å®žçŽ°æ˜¯ï¼š åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œåœ¨æŒ‡ä»¤çº§åˆ«åŠ å…¥ä¸€äº›æ ‡è¯†æ¥å®žçŽ°çš„ã€‚ 1. é”å¯¹è±¡æ³¨æ„ç‚¹: å¿…é¡»æ˜¯é”çš„åŒä¸€ä¸ªå¯¹è±¡ 2. é”èŽ·å–å’Œé‡Šæ”¾ é”çš„èŽ·å–æ˜¯ç”±JVMå†³å®šçš„, ç”¨æˆ·æ— æ³•æ“ä½œ é”çš„é‡Šæ”¾ä¹Ÿæ˜¯ç”±JVMå†³å®šçš„ Synchronized æ— æ³•ä¸­æ–­æ­£åœ¨é˜»å¡žé˜Ÿåˆ—æˆ–è€…ç­‰å¾…é˜Ÿåˆ—çš„çº¿ç¨‹ã€‚ 3. ä»€ä¹ˆæ—¶å€™ä¼šé‡Šæ”¾ èŽ·å–é”çš„çº¿ç¨‹æ‰§è¡Œå®Œäº†è¯¥ä»£ç å—ï¼Œç„¶åŽçº¿ç¨‹é‡Šæ”¾å¯¹é”çš„å æœ‰ï¼› çº¿ç¨‹æ‰§è¡Œå‘ç”Ÿå¼‚å¸¸ï¼Œæ­¤æ—¶ JVM ä¼šè®©çº¿ç¨‹è‡ªåŠ¨é‡Šæ”¾é”ã€‚ 4.æ ¼å¼ 1234// åŠ åŒæ­¥æ ¼å¼ï¼šsynchronized(éœ€è¦ä¸€ä¸ªä»»æ„çš„å¯¹è±¡ï¼ˆé”ï¼‰)&#123; ä»£ç å—ä¸­æ”¾æ“ä½œå…±äº«æ•°æ®çš„ä»£ç ã€‚&#125; 5.çº¿ç¨‹æ‰§è¡Œäº’æ–¥ä»£ç çš„è¿‡ç¨‹ èŽ·å¾—äº’æ–¥é” æ¸…ç©ºå·¥ä½œå†…å­˜ ä»Žä¸»å†…å­˜æ‹·è´å˜é‡çš„æœ€æ–°å‰¯æœ¬åˆ°å·¥ä½œå†…å­˜ æ‰§è¡Œä»£ç  å°†æ›´æ–°åŽçš„å…±äº«å˜é‡çš„å€¼åˆ·æ–°åˆ°ä¸»å†…å­˜ é‡Šæ”¾äº’æ–¥é” Lock -&gt; ä¸»å†…å­˜ -&gt; å·¥ä½œå†…å­˜ -&gt; ä¸»å†…å­˜ -&gt; unlock 2.2 Lockæ‰‹åŠ¨èŽ·å–æˆ–é‡Šæ”¾é”, æä¾›äº†æ¯” synchronized æ›´å¤šçš„åŠŸèƒ½ Lock é”æ˜¯ Java ä»£ç çº§åˆ«æ¥å®žçŽ°çš„ï¼Œç›¸å¯¹äºŽ synchronized åœ¨åŠŸèƒ½æ€§ä¸Šï¼Œæœ‰æ‰€åŠ å¼ºï¼Œä¸»è¦æ˜¯ï¼Œå…¬å¹³é”ï¼Œè½® è¯¢é”ï¼Œå®šæ—¶é”ï¼Œå¯ä¸­æ–­é”ç­‰ï¼Œè¿˜å¢žåŠ äº†å¤šè·¯é€šçŸ¥æœºåˆ¶ï¼ˆConditionï¼‰ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªé”æ¥ç®¡ç†å¤š ä¸ªåŒæ­¥å—ã€‚å¦å¤–åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¿…é¡»æ‰‹åŠ¨çš„é‡Šæ”¾é”ã€‚Lock é”çš„å®žçŽ°ï¼Œä¸»è¦æ˜¯å€ŸåŠ©äºŽé˜Ÿåˆ—åŒ æ­¥å™¨ï¼ˆæˆ‘ä»¬å¸¸å¸¸è§åˆ°çš„ AQSï¼‰æ¥å®žçŽ°ã€‚å®ƒåŒ…æ‹¬ä¸€ä¸ª int å˜é‡æ¥è¡¨ç¤ºçŠ¶æ€ï¼›ä¸€ä¸ª FIFO é˜Ÿåˆ—ï¼Œæ¥ å­˜å‚¨èŽ·å–èµ„æºçš„æŽ’é˜Ÿçº¿ç¨‹ã€‚ åŸºæœ¬ä½¿ç”¨ 12345678910111213class X &#123; // åˆ›å»ºä¸€æŠŠé” private final ReentrantLock lock = new ReentrantLock(); // éœ€è¦åšåŒæ­¥çš„æ–¹æ³• public void m() &#123; lock.lock(); //èŽ·å–ðŸ”, åŠ é” try &#123; // ä»£ç  &#125; finally &#123; lock.unlock(); // é‡Šæ”¾ðŸ” &#125; &#125;&#125; 1. lock å’Œ synchronized çš„åŒºåˆ« Lock ä¸æ˜¯ Java è¯­è¨€å†…ç½®çš„ï¼Œsynchronized æ˜¯ Java è¯­è¨€çš„å…³é”®å­—ï¼Œå› æ­¤æ˜¯å†…ç½®ç‰¹æ€§ã€‚Lock æ˜¯ä¸€ä¸ªç±»ï¼Œé€šè¿‡è¿™ä¸ªç±»å¯ä»¥å®žçŽ°åŒæ­¥è®¿é—®ï¼› Lock å’Œ synchronized æœ‰ä¸€ç‚¹éžå¸¸å¤§çš„ä¸åŒï¼Œé‡‡ç”¨ synchronized ä¸éœ€è¦ç”¨æˆ·åŽ»æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œ å½“ synchronized æ–¹æ³•æˆ–è€… synchronized ä»£ç å—æ‰§è¡Œå®Œä¹‹åŽï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è®©çº¿ç¨‹é‡Šæ”¾å¯¹é”çš„å  ç”¨ï¼›è€Œ Lock åˆ™å¿…é¡»è¦ç”¨æˆ·åŽ»æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œå¦‚æžœæ²¡æœ‰ä¸»åŠ¨é‡Šæ”¾é”ï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´å‡ºçŽ°æ­»é”çŽ° è±¡ã€‚ 2. Lock æŽ¥å£ä¸­æ–¹æ³•çš„ä½¿ç”¨ ReentrantLock ç±» ReentrantLock æ˜¯å”¯ä¸€å®žçŽ°äº† Lock æŽ¥å£çš„ç±»ï¼Œå¹¶ä¸” ReentrantLock æä¾›äº†æ›´å¤šçš„æ–¹æ³•ï¼ŒReentrantLockï¼Œæ„æ€æ˜¯â€œå¯é‡å…¥é”â€ã€‚ lock()ã€tryLock()ã€tryLock(long time, TimeUnit unit)ã€lockInterruptibly()æ˜¯ç”¨æ¥èŽ·å–é”çš„ã€‚ unLock()æ–¹æ³•æ˜¯ç”¨æ¥é‡Šæ”¾é”çš„ã€‚ å››ä¸ªèŽ·å–é”æ–¹æ³•çš„åŒºåˆ« lock()ï¼Œé˜»å¡žæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯å¹³å¸¸ä½¿ç”¨å¾—æœ€å¤šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯ç”¨æ¥èŽ·å–é”ã€‚å¦‚æžœé”å·²è¢« å…¶ä»–çº¿ç¨‹èŽ·å–ï¼Œåˆ™è¿›è¡Œç­‰å¾…ã€‚ç”±äºŽåœ¨å‰é¢è®²åˆ°å¦‚æžœé‡‡ç”¨ Lockï¼Œå¿…é¡»ä¸»åŠ¨åŽ»é‡Šæ”¾é”ï¼Œå¹¶ä¸”åœ¨ å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨é‡Šæ”¾é”ã€‚å› æ­¤ä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨ Lock å¿…é¡»åœ¨ try{}catch{}å—ä¸­è¿›è¡Œï¼Œå¹¶ ä¸”å°†é‡Šæ”¾é”çš„æ“ä½œæ”¾åœ¨ finally å—ä¸­è¿›è¡Œï¼Œä»¥ä¿è¯é”ä¸€å®šè¢«è¢«é‡Šæ”¾ï¼Œé˜²æ­¢æ­»é”çš„å‘ç”Ÿã€‚ tryLock()ï¼Œéžé˜»å¡žæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯æœ‰è¿”å›žå€¼çš„ï¼Œå®ƒè¡¨ç¤ºç”¨æ¥å°è¯•èŽ·å–é”ï¼Œå¦‚æžœèŽ·å–æˆåŠŸï¼Œ åˆ™è¿”å›ž trueï¼Œå¦‚æžœèŽ·å–å¤±è´¥ï¼ˆå³é”å·²è¢«å…¶ä»–çº¿ç¨‹èŽ·å–ï¼‰ï¼Œåˆ™è¿”å›ž falseï¼Œä¹Ÿå°±è¯´è¿™ä¸ªæ–¹æ³•æ— è®º å¦‚ä½•éƒ½ä¼šç«‹å³è¿”å›žã€‚åœ¨æ‹¿ä¸åˆ°é”æ—¶ä¸ä¼šä¸€ç›´åœ¨é‚£ç­‰å¾…ã€‚ tryLock(long time, TimeUnit unit)ï¼Œé˜»å¡žæ–¹æ³•ï¼Œé˜»å¡žç»™å®šæ—¶é•¿ï¼Œè¯¥æ–¹æ³•å’Œ tryLock()æ–¹æ³•æ˜¯ ç±»ä¼¼çš„ï¼Œåªä¸è¿‡åŒºåˆ«åœ¨äºŽè¿™ä¸ªæ–¹æ³•åœ¨æ‹¿ä¸åˆ°é”æ—¶ä¼šç­‰å¾…ä¸€å®šçš„æ—¶é—´ï¼Œåœ¨æ—¶é—´æœŸé™ä¹‹å†…å¦‚æžœè¿˜ æ‹¿ä¸åˆ°é”ï¼Œå°±è¿”å›ž falseã€‚å¦‚æžœä¸€å¼€å§‹æ‹¿åˆ°é”æˆ–è€…åœ¨ç­‰å¾…æœŸé—´å†…æ‹¿åˆ°äº†é”ï¼Œåˆ™è¿”å›ž trueã€‚ lockInterruptibly()è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒç‰¹æ®Šï¼Œå½“é€šè¿‡è¿™ä¸ªæ–¹æ³•åŽ»èŽ·å–é”æ—¶ï¼Œå¦‚æžœçº¿ç¨‹æ­£åœ¨ç­‰å¾… èŽ·å–é”ï¼Œåˆ™è¿™ä¸ªçº¿ç¨‹èƒ½å¤Ÿå“åº”ä¸­æ–­ï¼Œå³ä¸­æ–­çº¿ç¨‹çš„ç­‰å¾…çŠ¶æ€ã€‚ä¹Ÿå°±ä½¿è¯´ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶é€š è¿‡ lock.lockInterruptibly()æƒ³èŽ·å–æŸä¸ªé”æ—¶ï¼Œå‡è‹¥æ­¤æ—¶çº¿ç¨‹ A èŽ·å–åˆ°äº†é”ï¼Œè€Œçº¿ç¨‹ B åªæœ‰åœ¨ç­‰ å¾…ï¼Œé‚£ä¹ˆå¯¹çº¿ç¨‹ B è°ƒç”¨ threadB.interrupt()æ–¹æ³•èƒ½å¤Ÿä¸­æ–­çº¿ç¨‹ B çš„ç­‰å¾…è¿‡ç¨‹ã€‚ 2.3 Lock ä¸Ž synchronized çš„é€‰æ‹© Lock æ˜¯ä¸€ä¸ªæŽ¥å£ï¼Œè€Œ synchronized æ˜¯ Java ä¸­çš„å…³é”®å­—ï¼Œsynchronized æ˜¯å†…ç½®çš„è¯­è¨€å®žçŽ°ï¼› synchronized åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¼šè‡ªåŠ¨é‡Šæ”¾çº¿ç¨‹å æœ‰çš„é”ï¼Œå› æ­¤ä¸ä¼šå¯¼è‡´æ­»é”çŽ°è±¡å‘ç”Ÿï¼› è€Œ Lock åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¦‚æžœæ²¡æœ‰ä¸»åŠ¨é€šè¿‡ unLock()åŽ»é‡Šæ”¾é”ï¼Œåˆ™å¾ˆå¯èƒ½é€ æˆæ­»é”çŽ°è±¡ï¼Œå›  æ­¤ä½¿ç”¨ Lock æ—¶éœ€è¦åœ¨ finally å—ä¸­é‡Šæ”¾é”ï¼› Lock å¯ä»¥è®©ç­‰å¾…é”çš„çº¿ç¨‹å“åº”ä¸­æ–­ï¼Œè€Œ synchronized å´ä¸è¡Œï¼Œä½¿ç”¨ synchronized æ—¶ï¼Œç­‰ å¾…çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…ä¸‹åŽ»ï¼Œä¸èƒ½å¤Ÿå“åº”ä¸­æ–­ï¼› é€šè¿‡ Lock å¯ä»¥çŸ¥é“æœ‰æ²¡æœ‰æˆåŠŸèŽ·å–é”ï¼Œè€Œ synchronized å´æ— æ³•åŠžåˆ°ã€‚ Lock å¯ä»¥æé«˜å¤šä¸ªçº¿ç¨‹è¿›è¡Œè¯»æ“ä½œçš„æ•ˆçŽ‡ã€‚ 2.4 è¯»å†™é” çº¿ç¨‹è¿›å…¥è¯»é”çš„å‰ææ¡ä»¶ï¼š æ²¡æœ‰å…¶ä»–çº¿ç¨‹çš„å†™é”, æ²¡æœ‰å†™è¯·æ±‚æˆ–è€…æœ‰å†™è¯·æ±‚ï¼Œä½†è°ƒç”¨çº¿ç¨‹å’ŒæŒæœ‰é”çš„çº¿ç¨‹æ˜¯åŒä¸€ä¸ª çº¿ç¨‹è¿›å…¥å†™é”çš„å‰ææ¡ä»¶ï¼š æ²¡æœ‰å…¶ä»–çº¿ç¨‹çš„è¯»é”, æ²¡æœ‰å…¶ä»–çº¿ç¨‹çš„å†™é” ReentrantReadWriteLock ä¸Ž ReentrantLock éƒ½æ˜¯å•ç‹¬çš„å®žçŽ°ï¼Œå½¼æ­¤ä¹‹é—´æ²¡æœ‰ç»§æ‰¿æˆ–å®žçŽ°çš„å…³ç³»ã€‚ ReadWriteLock ç±»123456// API// å¯ä»¥åŒºåˆ«å¯¹å¾…è¯»ã€å†™çš„æ“ä½œpublic interface ReadWriteLock &#123; Lock readLock(); Lock writeLock();&#125; ReentrantReadWriteLock ç±» ReentrantReadWriteLock é‡Œé¢æä¾›äº†å¾ˆå¤šä¸°å¯Œçš„æ–¹æ³•ï¼Œä¸è¿‡æœ€ä¸»è¦çš„æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼šreadLock()å’Œ writeLock()ç”¨æ¥èŽ·å–è¯»é”å’Œå†™é”ã€‚ æ³¨æ„ï¼šä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœæœ‰ä¸€ä¸ªçº¿ç¨‹å·²ç»å ç”¨äº†è¯»é”ï¼Œåˆ™æ­¤æ—¶å…¶ä»–çº¿ç¨‹å¦‚æžœè¦ç”³è¯·å†™ é”ï¼Œåˆ™ç”³è¯·å†™é”çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…é‡Šæ”¾è¯»é”ã€‚ å¦‚æžœæœ‰ä¸€ä¸ªçº¿ç¨‹å·²ç»å ç”¨äº†å†™é”ï¼Œåˆ™æ­¤æ—¶å…¶ä»–çº¿ç¨‹å¦‚æžœç”³è¯·å†™é”æˆ–è€…è¯»é”ï¼Œåˆ™ç”³è¯·çš„çº¿ç¨‹ ä¼šä¸€ç›´ç­‰å¾…é‡Šæ”¾å†™é”ã€‚ 2.5 æ­»é”æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„çŽ°è±¡ï¼Œ è‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æŽ¨è¿›ä¸‹åŽ»ã€‚è¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå› ä¸ºæ­»é”ä¼šè®©ä½ çš„ç¨‹åºæŒ‚èµ· æ— æ³•å®Œæˆä»»åŠ¡ã€‚ æ­»é”çš„å‘ç”Ÿå¿…é¡»æ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼š äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚ è¯·æ±‚ä¸Žä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡žæ—¶ï¼Œå¯¹å·²èŽ·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚ ä¸å‰¥å¤ºæ¡ä»¶ï¼šè¿›ç¨‹å·²èŽ·å¾—çš„èµ„æºï¼Œåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å¼ºè¡Œå‰¥å¤ºã€‚ å¾ªçŽ¯ç­‰å¾…æ¡ä»¶ï¼šè‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æŽ¥çš„å¾ªçŽ¯ç­‰å¾…èµ„æºå…³ç³»ã€‚ é¿å…æ­»é”æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯é˜»æ­¢å¾ªçŽ¯ç­‰å¾…æ¡ä»¶ï¼Œå°†ç³»ç»Ÿä¸­æ‰€æœ‰çš„èµ„æºè®¾ç½®æ ‡å¿—ä½ã€æŽ’åºï¼Œè§„ å®šæ‰€æœ‰çš„è¿›ç¨‹ç”³è¯·èµ„æºå¿…é¡»ä»¥ä¸€å®šçš„é¡ºåºï¼ˆå‡åºæˆ–é™åºï¼‰åšæ“ä½œæ¥é¿å…æ­»é” 2.6 Volatile ç‰¹æ®ŠåŸŸå˜é‡å¤šçº¿ç¨‹ç¼–ç¨‹ï¼Œæˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜é›†ä¸­åœ¨ä¸‰ä¸ªæ–¹é¢ï¼š åŽŸå­æ€§ã€‚æœ€ç®€å•çš„ä¾‹å­å°±æ˜¯ï¼Œi++,åœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹ï¼Œæœ€ç»ˆçš„ç»“æžœæ˜¯ä¸ç¡®å®šçš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿå°± æ˜¯å› ä¸ºè¿™ä¹ˆä¸€ä¸ª++æ“ä½œï¼Œè¢«ç¼–è¯‘ä¸ºè®¡ç®—æœºåº•å±‚æŒ‡ä»¤åŽï¼Œæ˜¯å¤šä¸ªæŒ‡ä»¤æ¥å®Œæˆçš„ã€‚é‚£ä¹ˆé‡åˆ°å¹¶å‘ çš„æƒ…å†µï¼Œå°±ä¼šå¯¼è‡´å½¼æ­¤â€œè¦†ç›–â€çš„æƒ…å†µã€‚ å¯è§æ€§ã€‚é€šä¿—è§£é‡Šå°±æ˜¯ï¼Œåœ¨ A çº¿ç¨‹å¯¹ä¸€ä¸ªå˜é‡åšäº†ä¿®æ”¹ï¼Œåœ¨ B çº¿ç¨‹ä¸­ï¼Œèƒ½æ­£ç¡®çš„è¯»å–åˆ° ä¿®æ”¹åŽçš„ç»“æžœã€‚ç©¶å…¶åŽŸç†ï¼Œæ˜¯ cpu ä¸æ˜¯ç›´æŽ¥å’Œç³»ç»Ÿå†…å­˜é€šä¿¡ï¼Œè€Œæ˜¯æŠŠå˜é‡è¯»å–åˆ° L1ï¼ŒL2 ç­‰ å†…éƒ¨çš„ç¼“å­˜ä¸­ï¼Œä¹Ÿå«ä½œç§æœ‰çš„æ•°æ®å·¥ä½œæ ˆã€‚ä¿®æ”¹ä¹Ÿæ˜¯åœ¨å†…éƒ¨ç¼“å­˜ä¸­ï¼Œä½†æ˜¯ä½•æ—¶åŒæ­¥åˆ°ç³»ç»Ÿå†… å­˜æ˜¯ä¸èƒ½ç¡®å®šçš„ï¼Œæœ‰äº†è¿™ä¸ªæ—¶é—´å·®ï¼Œåœ¨å¹¶å‘çš„æ—¶å€™ï¼Œå°±å¯èƒ½ä¼šå¯¼è‡´ï¼Œè¯»åˆ°çš„å€¼ï¼Œä¸æ˜¯æœ€æ–°å€¼ã€‚ æŒ‡ä»¤é‡æŽ’ã€‚è¿™é‡Œåªè¯´æŒ‡ä»¤é‡æŽ’åºï¼Œè™šæ‹Ÿæœºåœ¨æŠŠä»£ç ç¼–è¯‘ä¸ºæŒ‡ä»¤åŽæ‰§è¡Œï¼Œå‡ºäºŽä¼˜åŒ–çš„ç›®çš„ï¼Œ åœ¨ä¿è¯ç»“æžœä¸å˜çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šè°ƒæ•´æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚ valotileï¼Œèƒ½æ»¡è¶³ä¸Šè¿°çš„å¯è§æ€§å’Œæœ‰åºæ€§ã€‚ä½†æ˜¯æ— æ³•ä¿è¯åŽŸå­æ€§ã€‚ å¯è§æ€§ï¼Œæ˜¯åœ¨ä¿®æ”¹åŽï¼Œå¼ºåˆ¶æŠŠå¯¹å˜é‡çš„ä¿®æ”¹åŒæ­¥åˆ°ç³»ç»Ÿå†…å­˜ã€‚è€Œå…¶ä»– cpu åœ¨è¯»å–è‡ªå·±çš„å†…éƒ¨ ç¼“å­˜ä¸­çš„å€¼çš„æ—¶å€™ï¼Œå‘çŽ°æ˜¯ valotile ä¿®é¥°çš„ï¼Œä¼šæŠŠå†…éƒ¨ç¼“å­˜ä¸­çš„å€¼ï¼Œç½®ä¸ºæ— æ•ˆï¼Œç„¶åŽä»Žç³»ç»Ÿ å†…å­˜è¯»å–ã€‚ æœ‰åºæ€§ï¼Œæ˜¯é€šè¿‡å†…å­˜å±éšœæ¥å®žçŽ°çš„ã€‚æ‰€è°“çš„å†…å­˜å±éšœï¼Œå¯ä»¥ç†è§£ä¸ºï¼Œåœ¨æŸäº›æŒ‡ä»¤ä¸­ï¼Œæ’å…¥å± éšœæŒ‡ä»¤ï¼Œç”¨ä»¥ç¡®ä¿ï¼Œåœ¨å‘å±éšœæŒ‡ä»¤åŽé¢ç»§ç»­æ‰§è¡Œçš„æ—¶å€™ï¼Œå…¶å‰é¢çš„æ‰€æœ‰æŒ‡ä»¤å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚ 3. Javaå¤šçº¿ç¨‹ä¸­å¸¸è§çš„é¢è¯•é¢˜1. sleep(),wait(),join(),yield()å››ä¸ªæ–¹æ³•çš„åŒºåˆ«æ€»ç»“ï¼š 1ï¼‰ï¼šsleep()ï¼ŒThread ç±»ä¸­çš„æ–¹æ³•ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹è¿›å…¥é˜»å¡žçŠ¶æ€ï¼Œä¸é‡Šæ”¾é” 2ï¼‰ï¼šwait()ï¼ŒObject ç±»ä¸­çš„æ–¹æ³•ï¼Œè¡¨ç¤ºçº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œé‡Šæ”¾é”ï¼Œæ‰€ä»¥ä¸€èˆ¬èƒ½è°ƒç”¨è¿™ä¸ªæ–¹ æ³•çš„éƒ½æ˜¯åŒæ­¥ä»£ç å—ï¼Œæˆ–è€…èŽ·å–äº†é”çš„çº¿ç¨‹ä»£ç ï¼Œé€šå¸¸å’Œ notify()å’Œ notifyAll()æ–¹æ³•ç»“åˆä½¿ç”¨ 3ï¼‰ï¼šjoin()ï¼ŒThread ç±»ä¸­çš„æ–¹æ³•ï¼Œå‡å¦‚åœ¨ a çº¿ç¨‹ä¸­è°ƒç”¨ b çº¿ç¨‹å¯¹è±¡çš„ join()æ–¹æ³•ï¼Œè¡¨ç¤ºå½“å‰ a çº¿ç¨‹é˜»å¡žï¼Œç›´åˆ° b çº¿ç¨‹è¿è¡Œç»“æŸ 4ï¼‰ï¼šyield()ï¼ŒThread ç±»ä¸­çš„æ–¹æ³•ï¼Œè¡¨ç¤ºçº¿ç¨‹å›žå¯æ‰§è¡ŒçŠ¶æ€ã€‚è·Ÿ sleep æ–¹æ³•ä¸€æ ·ï¼Œä¹Ÿä¸äº¤å‡ºé”ï¼Œ åªä¸è¿‡ä¸å¸¦æ—¶é—´å‚æ•°ï¼Œæ˜¯æŒ‡äº¤å‡º cpu 2. Thread å’Œ Runnable çš„åŒºåˆ«æ€»ç»“ï¼š å®žçŽ° Runnable æŽ¥å£æ¯”ç»§æ‰¿ Thread ç±»æ‰€å…·æœ‰çš„ä¼˜åŠ¿ï¼š 1ï¼‰ï¼šé€‚åˆå¤šä¸ªç›¸åŒçš„ç¨‹åºä»£ç çš„çº¿ç¨‹åŽ»å¤„ç†åŒä¸€ä¸ªèµ„æº 2ï¼‰ï¼šå¯ä»¥é¿å… java ä¸­çš„å•ç»§æ‰¿çš„é™åˆ¶ 3ï¼‰ï¼šå¢žåŠ ç¨‹åºçš„å¥å£®æ€§ï¼Œä»£ç å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œä»£ç å’Œæ•°æ®ç‹¬ç«‹ 4ï¼‰ï¼šçº¿ç¨‹æ± åªèƒ½æ”¾å…¥å®žçŽ° Runable æˆ– callable ç±»çº¿ç¨‹ï¼Œä¸èƒ½ç›´æŽ¥æ”¾å…¥ç»§æ‰¿ Thread çš„ç±» â€¦]]></content>
      <categories>
        <category>Java</category>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaåŸºç¡€å¢žå¼º-1 é›†åˆåå°„è®¾è®¡æ¨¡å¼æŽ’åº]]></title>
    <url>%2F2018%2F05%2F29%2FJava%2FJava%E5%9F%BA%E7%A1%80%E5%A2%9E%E5%BC%BA-1%2F</url>
    <content type="text"><![CDATA[1ã€é›†åˆæ¡†æž¶1.1 ã€é›†åˆæ¡†æž¶ä½“ç³»å›¾ Java çš„é›†åˆæ¡†æž¶ä¸»è¦åˆ†ä¸ºäº”å¤§ç±»ä½“ç³»ï¼š1ã€Collectionï¼ˆå¸¸ç”¨çš„ List å’Œ Setï¼Œå’Œä¸å¸¸ç”¨çš„ Queue å’Œ Vector å’Œ Stackï¼‰ï¼Œå•å…ƒç´ é›†åˆ2ã€Mapï¼ˆå¸¸ç”¨çš„ HashMap å’Œ TreeMapï¼Œä¸å¸¸ç”¨çš„ HashTableï¼‰ï¼ŒKey-Value æ˜ å°„3ã€Iteratorï¼ˆè¿­ä»£å™¨ï¼‰4ã€å·¥å…·ç±»ï¼ˆCollections å’Œ Arraysï¼‰5ã€Comparable å’Œ Comparator æ¯”è¾ƒå™¨ Java ä¸­çš„é›†åˆå’Œæ•°ç»„çš„åŒºåˆ«:1ã€æ•°ç»„é•¿åº¦åœ¨åˆå§‹åŒ–æ—¶æŒ‡å®šï¼Œæ„å‘³ç€åªèƒ½ä¿å­˜å®šé•¿çš„æ•°æ®ã€‚è€Œé›†åˆå¯ä»¥ä¿å­˜æ•°é‡ä¸ç¡®å®šçš„ æ•°æ®ã€‚åŒæ—¶å¯ä»¥ä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„æ•°æ®ï¼ˆå³å…³è”æ•°ç»„ï¼Œé”®å€¼å¯¹ key-valueï¼‰ã€‚ 2ã€æ•°ç»„å…ƒç´ å³å¯ä»¥æ˜¯åŸºæœ¬ç±»åž‹çš„å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ã€‚é›†åˆé‡Œåªèƒ½ä¿å­˜å¯¹è±¡ï¼ˆå®žé™…ä¸Šåªæ˜¯ä¿å­˜å¯¹è±¡çš„å¼•ç”¨å˜é‡ï¼‰ï¼ŒåŸºæœ¬æ•°æ®ç±»åž‹çš„å˜é‡è¦è½¬æ¢æˆå¯¹åº”çš„åŒ…è£…ç±»æ‰èƒ½æ”¾å…¥é›†åˆç±»ä¸­ã€‚ Collection æŽ¥å£ä¸­çš„æ–¹æ³•ï¼š Map æŽ¥å£ä¸­çš„æ–¹æ³•ï¼š 1.2ã€å¸¸ç”¨é›†åˆç‰¹æ€§æ¦‚è¿°1.2.1 List ç³» List ç‰¹ç‚¹ï¼šå…ƒç´ æœ‰æ”¾å…¥é¡ºåºï¼Œå…ƒç´ å¯é‡å¤ List æŽ¥å£æœ‰ä¸‰ä¸ªå®žçŽ°ç±»ï¼šLinkedListï¼ŒArrayListï¼ŒVector LinkedListï¼šåº•å±‚åŸºäºŽé“¾è¡¨å®žçŽ°ï¼Œé“¾è¡¨å†…å­˜æ˜¯æ•£ä¹±çš„ï¼Œæ¯ä¸€ä¸ªå…ƒç´ å­˜å‚¨æœ¬èº«å†…å­˜åœ°å€çš„åŒæ—¶è¿˜ å­˜å‚¨ä¸‹ä¸€ä¸ªå…ƒç´ çš„åœ°å€ã€‚é“¾è¡¨å¢žåˆ å¿«ï¼ŒæŸ¥æ‰¾æ…¢ ArrayList å’Œ Vector åº•å±‚éƒ½æ˜¯åŸºäºŽæ•°ç»„å®žçŽ°çš„ï¼ŒæŸ¥è¯¢å¿«ï¼Œå¢žåˆ æ…¢ï¼ŒåŒºåˆ«æ˜¯ ArrayList æ˜¯éžçº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆçŽ‡é«˜ï¼›Vector æ˜¯åŸºäºŽçº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆçŽ‡ä½Ž ArrayList çš„åˆå§‹åŒ–å¤§å°æ˜¯ 10ï¼Œæ‰©å®¹ç­–ç•¥æ˜¯ 1.5 å€åŽŸå…ƒç´ æ•°é‡çš„å¤§å° æ•°ç»„ åˆå§‹å®¹é‡+æ‰©å®¹ (jdk10)12345678910111213141516171819// åˆå§‹å®¹é‡private static final int DEFAULT_CAPACITY = 10;// æ‰©å®¹private int newCapacity(int minCapacity) &#123; // overflow-conscious code int oldCapacity = elementData.length; int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); if (newCapacity - minCapacity &lt;= 0) &#123; if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) return Math.max(DEFAULT_CAPACITY, minCapacity); if (minCapacity &lt; 0) // overflow throw new OutOfMemoryError(); return minCapacity; &#125; return (newCapacity - MAX_ARRAY_SIZE &lt;= 0) ? newCapacity : hugeCapacity(minCapacity); &#125; é€‰æ‹©æ ‡å‡†ï¼š å¦‚æžœæ¶‰åŠåˆ°â€œåŠ¨æ€æ•°ç»„â€ã€â€œæ ˆâ€ã€â€œé˜Ÿåˆ—â€ã€â€œé“¾è¡¨â€ç­‰ç»“æž„ï¼Œåº”è¯¥è€ƒè™‘ç”¨ Listï¼Œå…·ä½“çš„é€‰æ‹©å“ª ä¸ª Listï¼Œæ ¹æ®ä¸‹é¢çš„æ ‡å‡†æ¥å–èˆã€‚ 1ã€å¯¹äºŽéœ€è¦å¿«é€Ÿæ’å…¥ï¼Œåˆ é™¤å…ƒç´ ï¼Œåº”è¯¥ä½¿ç”¨ LinkedListã€‚ï¼ˆå¢žåˆ æ”¹ï¼‰ 2ã€å¯¹äºŽéœ€è¦å¿«é€Ÿéšæœºè®¿é—®å…ƒç´ ï¼Œåº”è¯¥ä½¿ç”¨ ArrayListã€‚ï¼ˆæŸ¥è¯¢ï¼‰ 3ã€å¯¹äºŽâ€œå•çº¿ç¨‹çŽ¯å¢ƒâ€æˆ–è€…â€œå¤šçº¿ç¨‹çŽ¯å¢ƒï¼Œä½† List ä»…ä»…åªä¼šè¢«å•ä¸ªçº¿ç¨‹æ“ä½œâ€ï¼Œæ­¤æ—¶åº”è¯¥ä½¿ ç”¨éžåŒæ­¥çš„ç±»(å¦‚ ArrayList)ã€‚å¯¹äºŽâ€œå¤šçº¿ç¨‹çŽ¯å¢ƒï¼Œä¸” List å¯èƒ½åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹æ“ä½œâ€ï¼Œæ­¤æ—¶ï¼Œ åº”è¯¥ä½¿ç”¨åŒæ­¥çš„ç±»(å¦‚ Vector)ã€‚ LinkedList add(E e)1234567891011121314151617# add(E e) æºç public boolean add(E e) &#123; linkLast(e); return true;&#125; void linkLast(E e) &#123; final Node&lt;E&gt; l = last; final Node&lt;E&gt; newNode = new Node&lt;&gt;(l, e, null); last = newNode; if (l == null) first = newNode; else l.next = newNode; size++; modCount++;&#125; 1.2.2ã€Set ç³» Set ç‰¹ç‚¹ï¼šå…ƒç´ æ”¾å…¥æ— é¡ºåºï¼Œå…ƒç´ ä¸å¯é‡å¤ Set æŽ¥å£çš„å®žçŽ°ç±»ï¼šHashSetï¼ŒTreeSetï¼ŒLinkedHashSet HashSetï¼ˆåº•å±‚ç”± HashMap å®žçŽ°ï¼‰åº•å±‚é€šè¿‡ hashCode()å’Œ equals()è¿›è¡ŒåŽ»é‡ã€‚ HashSet å†…éƒ¨åˆ¤æ–­ç›¸ç­‰çš„æ ‡å‡†HashSet åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ ç›¸ç­‰çš„æ ‡å‡†ï¼š â€‹ ä¸¤ä¸ªå¯¹è±¡é€šè¿‡ equals()æ–¹æ³•æ¯”è¾ƒç›¸ç­‰ï¼Œå¹¶ä¸”ä¸¤ä¸ªå¯¹è±¡çš„ hashCode()æ–¹æ³•è¿”å›žå€¼ä¹Ÿç›¸ç­‰ HashSet ä¸­åˆ¤æ–­é›†åˆå…ƒç´ ç›¸ç­‰ï¼Œä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒå…·ä½“åˆ†ä¸ºå¦‚ä¸‹å››ä¸ªæƒ…å†µï¼š å¦‚æžœæœ‰ä¸¤ä¸ªå…ƒç´ é€šè¿‡ equal()æ–¹æ³•æ¯”è¾ƒè¿”å›ž falseï¼Œå¹¶ä¸”å®ƒä»¬çš„ hashCode()æ–¹æ³•è¿”å›žä¸ç›¸ç­‰ï¼Œ HashSet å°†ä¼šæŠŠå®ƒä»¬å­˜å‚¨åœ¨ä¸åŒçš„ä½ç½®ã€‚ å¦‚æžœæœ‰ä¸¤ä¸ªå…ƒç´ é€šè¿‡ equal()æ–¹æ³•æ¯”è¾ƒè¿”å›ž trueï¼Œå¹¶ä¸”å®ƒä»¬çš„ hashCode()æ–¹æ³•è¿”å›žä¸ç›¸ç­‰ï¼Œ HashSet å°†ä¼šæŠŠå®ƒä»¬å­˜å‚¨åœ¨ä¸åŒçš„ä½ç½®ã€‚ å¦‚æžœä¸¤ä¸ªå¯¹è±¡é€šè¿‡ equals()æ–¹æ³•æ¯”è¾ƒä¸ç›¸ç­‰ï¼ŒhashCode()æ–¹æ³•æ¯”è¾ƒç›¸ç­‰ï¼ŒHashSet å°†ä¼šæŠŠå®ƒä»¬å­˜å‚¨åœ¨ç›¸åŒçš„ä½ç½®ï¼Œåœ¨è¿™ä¸ªä½ç½®ä»¥é“¾è¡¨å¼ç»“æž„æ¥ä¿å­˜å¤šä¸ªå¯¹è±¡ã€‚è¿™æ˜¯å› ä¸ºå½“å‘ HashSet é›†åˆä¸­å­˜å…¥ä¸€ä¸ªå…ƒç´ æ—¶ï¼ŒHashSet ä¼šè°ƒç”¨å¯¹è±¡çš„ hashCode()æ–¹æ³•æ¥å¾—åˆ°å¯¹è±¡çš„ hashCode å€¼ï¼Œ ç„¶åŽæ ¹æ®è¯¥ hashCode å€¼æ¥å†³å®šè¯¥å¯¹è±¡å­˜å‚¨åœ¨ HashSet ä¸­å­˜å‚¨ä½ç½®ã€‚ å¦‚æžœæœ‰ä¸¤ä¸ªå…ƒç´ é€šè¿‡ equal()æ–¹æ³•æ¯”è¾ƒè¿”å›ž trueï¼Œå¹¶ä¸”å®ƒä»¬çš„ hashCode()æ–¹æ³•è¿”å›ž trueï¼ŒHashSet å°†ä¸äºˆæ·»åŠ ã€‚ LinkedHashSetï¼Œæ˜¯ HashSet çš„å­ç±»ï¼Œåœ¨æ’å…¥å…ƒç´ çš„æ—¶å€™ï¼ŒåŒæ—¶ä½¿ç”¨é“¾è¡¨ç»´æŒæ’å…¥å…ƒç´ çš„é¡ºåº SortedSet æŽ¥å£æœ‰ä¸€ä¸ªå®žçŽ°ç±»ï¼šTreeSetï¼ˆåº•å±‚ç”±å¹³è¡¡äºŒå‰æ ‘å®žçŽ°ï¼‰ç¡®ä¿é›†åˆä¸­çš„å…ƒç´ éƒ½æ˜¯å‡ºäºŽæŽ’åºçŠ¶æ€ æ³¨æ„ LinkedHashSet å’Œ SortedSet åŒºåˆ«ï¼Œå‰è€…å­˜æ’å…¥é¡ºåºï¼ŒåŽè€…å­˜æ’å…¥ä¹‹åŽçš„é¡ºåº å¦å¤–: JDK5 : æ¡¶è¡¨ + é“¾è¡¨ JDK8 : æ¡¶è¡¨ + é“¾è¡¨ + äºŒå‰æ ‘ - **äºŒå‰æ ‘**: æ£€ç´¢æ·±åº¦ &gt; 8 çš„æ—¶å€™, è½¬åŒ–ä¸ºäºŒå‰æ ‘, å‡å°‘æŸ¥è¯¢æ·±åº¦ HashSet â€” HashMap çš„æºç å®žçŽ°123456789101112131415161718192021222324252627282930313233343536373839/** * The default initial capacity - MUST be a power of two. * æ¡¶è¡¨é»˜è®¤å®¹é‡ 16 * æŽ§åˆ¶hashcode ä¸è¶…16èŒƒå›´, a.hashcode = xx % 16 (hashcode å–æ¨¡ æ¡¶ä¸ªæ•°) */static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16/** * MUST be a power of two &lt;= 1&lt;&lt;30. * æ¡¶è¡¨æœ€å¤§ 2^30 */static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;/** * æ‰©å®¹å› å­: 0.75 * æ‰©å®¹: æ¯æ¬¡2å€ */static final float DEFAULT_LOAD_FACTOR = 0.75f;/** * é“¾è¡¨: hashç®—æ³•å€¼ç›¸åŒçš„æ—¶å€™, ä¼šæŠŠå€¼ç›¸åŒçš„æ”¾åœ¨ä¸€ä¸ªé“¾è¡¨ä¸Š, é“¾è¡¨ä¸Šçš„å…ƒç´ ä¸ªæ•° * è¶…è¿‡8ä¸ªæ—¶, è½¬åŒ–ä¸ºäºŒå‰æ ‘, æå‡æŸ¥è¯¢æ•ˆçŽ‡ */static final int TREEIFY_THRESHOLD = 8;/** * The bin count threshold for untreeifying a (split) bin during a * resize operation. Should be less than TREEIFY_THRESHOLD, and at * most 6 to mesh with shrinkage detection under removal. */static final int UNTREEIFY_THRESHOLD = 6;/** * The smallest table capacity for which bins may be treeified. * (Otherwise the table is resized if too many nodes in a bin.) * Should be at least 4 * TREEIFY_THRESHOLD to avoid conflicts * between resizing and treeification thresholds. */static final int MIN_TREEIFY_CAPACITY = 64; TreeSetçš„é»˜è®¤æŽ’åº TreeSetæ˜¯æœ‰åºçš„ä¸å¯é‡å¤çš„, æœ‰åºæ˜¯æŒ‡å…ƒç´ å€¼çš„å¤§å° æ•°å€¼ç±»åž‹: æŒ‰ç…§å¤§å°è¿›è¡Œå‡åºæŽ’åº å­—ç¬¦ä¸²ç±»åž‹: æŒ‰ç…§å­—å…¸é¡ºåºè¿›è¡Œå‡åºæŽ’åº å­—ç¬¦ä¸²ä»Žå·¦åˆ°å³, ä¸€ä½ä¸€ä½çš„æ¯”è¾ƒ è‡ªå®šä¹‰TreeSetç±»åž‹: å®žçŽ° compareToæ–¹æ³•, è¿”å›žä¸º0çš„æƒ…å†µä¼šé»˜è®¤è¦†ç›– 1.2.2ã€Map ç³»Map ç‰¹ç‚¹ï¼šå­˜å‚¨çš„å…ƒç´ æ˜¯é”®å€¼å¯¹ï¼Œåœ¨ JDK1.8 ç‰ˆæœ¬ä¸­æ˜¯ Nodeï¼Œåœ¨è€ç‰ˆæœ¬ä¸­æ˜¯ Entry Map æŽ¥ å£ æœ‰ äº” ä¸ª å¸¸ç”¨ å®ž çŽ° ç±» ï¼š HashMap ï¼Œ HashTable ï¼Œ LinkeHashMap ï¼Œ TreeMap ï¼Œ ConcurrentHashMap 1. HashMap &amp; Hashtable çš„åŒºåˆ«HashMap 1. éžçº¿ç¨‹å®‰å…¨, æ•ˆçŽ‡é«˜ 2. keyä¸å¯ä»¥é‡å¤ 3. keyå¯ä»¥ä¸ºnull, ä½†åªèƒ½æœ‰ä¸€ä¸ªkeyä¸ºnull Hashtable çº¿ç¨‹å®‰å…¨, æ•ˆçŽ‡ä½Ž keyä¸å¯ä»¥é‡å¤ ä¸å¯ä»¥ä¸ºnull 2. concurrentHash ç®€å•åˆ†æžæ˜¯ä»Ž JDK1.5 ä¹‹åŽæä¾›çš„ä¸€ä¸ª HashTable çš„æ›¿ä»£å®žçŽ°ï¼Œé‡‡ ä¸€ä¸ª map ä¸­çš„å…ƒç´ åˆ†æˆå¾ˆå¤šçš„ segmentï¼Œé€šè¿‡ lock æœºåˆ¶å¯ä»¥å¯¹æ¯ä¸ª segment åŠ è¯»å†™é”ï¼Œä»Ž è€Œæé«˜ map çš„æ•ˆçŽ‡ï¼Œåº•å±‚å®žçŽ°é‡‡ç”¨æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„å­˜å‚¨ç»“æž„ Javaå¹¶å‘åŒ…ä¸­çš„, æ—¢æ˜¯çº¿ç¨‹å®‰å…¨çš„, åˆä¸è‡³äºŽæ•ˆçŽ‡è¿‡ä½Ž æ€Žä¹ˆå®žçŽ°: åˆ†æ®µé”æœºåˆ¶ åˆ†æ®µé”: åªåŠ è½½åœ¨æŸä¸€æ®µæ•°æ®ä¸Š MySql: æŸ¥è¯¢ - 95%, å¢žåˆ æ”¹ - 5% è¯»é”: å…±äº«é”, ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ“ä½œçš„æ—¶å€™ä¸åº”å¸çº³å¦ä¸€ä¸ªçº¿ç¨‹çš„ç»“æž„ å†™é”: æŽ’å®ƒé”, ä¸€ä¸ªçº¿ç¨‹åœ¨è¿›è¡Œæ“ä½œçš„æ—¶å€™ä¸å…è®¸å…¶ä»–ä»»ä½•çº¿ç¨‹çš„æ“ä½œ 3. put &amp; get çš„æµç¨‹put çš„å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š é€šè¿‡ hashcode æ–¹æ³•è®¡ç®—å‡º key çš„ hash å€¼ é€šè¿‡ hash%length è®¡ç®—å‡ºå­˜å‚¨åœ¨ table ä¸­çš„ indexï¼ˆæºç ä¸­æ˜¯ä½¿ç”¨ hash&amp;(length-1)ï¼Œè¿™æ ·ç»“ æžœç›¸åŒï¼Œä½†æ˜¯æ›´å¿«ï¼‰ å¦‚æžœæ­¤æ—¶ table[index]çš„å€¼ä¸ºç©ºï¼Œé‚£ä¹ˆå°±ç›´æŽ¥å­˜å‚¨ï¼Œå¦‚æžœä¸ä¸ºç©ºé‚£ä¹ˆå°±é“¾æŽ¥åˆ°è¿™ä¸ªæ•°æ‰€åœ¨ çš„é“¾è¡¨çš„å¤´éƒ¨ã€‚ï¼ˆåœ¨ JDK1.8 ä¸­ï¼Œå¦‚æžœé“¾è¡¨é•¿åº¦å¤§äºŽ 8 å°±è½¬åŒ–æˆçº¢é»‘æ ‘ï¼‰ get çš„å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š é€šè¿‡ hashcode è®¡ç®—å‡º key çš„ hash å€¼ é€šè¿‡ hash%length è®¡ç®—å‡ºå­˜å‚¨åœ¨ table ä¸­çš„ indexï¼ˆæºç ä¸­æ˜¯ä½¿ç”¨ hash&amp;(length-1)ï¼Œè¿™æ ·ç»“ æžœç›¸åŒï¼Œä½†æ˜¯æ›´å¿«ï¼‰ éåŽ† table[index]æ‰€åœ¨çš„é“¾è¡¨ï¼Œåªæœ‰å½“ key ä¸Žè¯¥èŠ‚ç‚¹ä¸­çš„ key çš„å€¼ç›¸åŒæ—¶æ‰å–å‡ºã€‚ 1.3 æŽŒæ¡é‡ç‚¹List: ArrayList, LinkList Set: HashSet, TreeSet éœ€è¦æŽŒæ¡çš„æ–¹æ³•: add , get, contains Map: HashMap, TreeMap éœ€è¦æŽŒæ¡çš„æ–¹æ³•: put get mapçš„å¾ªçŽ¯éåŽ† containsKeyâ€¦. ä»¥ä¸Šçš„éƒ½éœ€è¦è·Ÿä¸‹æºç  1.4 åŠŸèƒ½æ–¹æ³•1.4.1 List çš„åŠŸèƒ½æ–¹æ³•ArrayList: ç”±æ•°ç»„å®žçŽ°çš„ Listã€‚å…è®¸å¯¹å…ƒç´ è¿›è¡Œå¿«é€Ÿéšæœºè®¿é—®ï¼Œä½†æ˜¯å‘ List ä¸­é—´æ’å…¥ä¸Žç§» é™¤å…ƒç´ çš„é€Ÿåº¦å¾ˆæ…¢ã€‚ListIterator åªåº”è¯¥ç”¨æ¥ç”±åŽå‘å‰éåŽ† ArrayListï¼Œè€Œä¸æ˜¯ç”¨æ¥æ’å…¥å’Œç§»é™¤ å…ƒç´ ã€‚å› ä¸ºé‚£æ¯” LinkedList å¼€é”€è¦å¤§å¾ˆå¤šã€‚ LinkedList : å¯¹é¡ºåºè®¿é—®è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå‘ List ä¸­é—´æ’å…¥ä¸Žåˆ é™¤çš„å¼€é”€å¹¶ä¸å¤§ã€‚éšæœºè®¿é—®åˆ™ ç›¸å¯¹è¾ƒæ…¢ã€‚(ä½¿ç”¨ ArrayList ä»£æ›¿ã€‚)è¿˜å…·æœ‰ä¸‹åˆ—æ–¹ æ³•ï¼šaddFirst(), addLast(), getFirst(), getLast(), removeFirst() å’Œ removeLast(), è¿™äº›æ–¹æ³• (æ²¡æœ‰åœ¨ä»»ä½•æŽ¥å£æˆ–åŸºç±»ä¸­å®šä¹‰è¿‡)ä½¿å¾— LinkedList å¯ä»¥å½“ä½œå †æ ˆã€é˜Ÿåˆ—å’ŒåŒå‘é˜Ÿåˆ—ä½¿ç”¨ã€‚ 1.4.2 Setçš„åŠŸèƒ½æ–¹æ³•Set : å­˜å…¥ Set çš„æ¯ä¸ªå…ƒç´ éƒ½å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œå› ä¸º Set ä¸ä¿å­˜é‡å¤å…ƒç´ ã€‚åŠ å…¥ Set çš„å…ƒç´  å¿…é¡»å®šä¹‰ equals()æ–¹æ³•ä»¥ç¡®ä¿å¯¹è±¡çš„å”¯ä¸€æ€§ã€‚Set ä¸Ž Collection æœ‰å®Œå…¨ä¸€æ ·çš„æŽ¥å£ã€‚Set æŽ¥å£ ä¸ä¿è¯ç»´æŠ¤å…ƒç´ çš„æ¬¡åºã€‚ HashSet : ä¸ºå¿«é€ŸæŸ¥æ‰¾è®¾è®¡çš„ Setã€‚å­˜å…¥ HashSet çš„å¯¹è±¡å¿…é¡»å®šä¹‰ hashCode()ã€‚ TreeSet : ä¿å­˜æ¬¡åºçš„ Setï¼Œåº•å±‚ä¸ºæ ‘ç»“æž„ã€‚ä½¿ç”¨å®ƒå¯ä»¥ä»Ž Set ä¸­æå–æœ‰åºçš„åºåˆ—ã€‚ LinkedHashSet : å…·æœ‰ HashSet çš„æŸ¥è¯¢é€Ÿåº¦ï¼Œä¸”å†…éƒ¨ä½¿ç”¨é“¾è¡¨ç»´æŠ¤å…ƒç´ çš„é¡ºåº(æ’å…¥çš„æ¬¡ åº ã€‚äºŽæ˜¯åœ¨ä½¿ç”¨è¿­ä»£å™¨éåŽ† Set æ—¶ï¼Œç»“æžœä¼šæŒ‰å…ƒç´ æ’å…¥çš„æ¬¡åºæ˜¾ç¤ºã€‚ 1.4.3 Map çš„åŠŸèƒ½æ–¹æ³•Map : ç»´æŠ¤â€œé”®å€¼å¯¹â€çš„å…³è”æ€§ï¼Œä½¿ä½ å¯ä»¥é€šè¿‡â€œé”®â€æŸ¥æ‰¾â€œå€¼â€ HashMap : Map åŸºäºŽæ•£åˆ—è¡¨çš„å®žçŽ°ã€‚æ’å…¥å’ŒæŸ¥è¯¢â€œé”®å€¼å¯¹â€çš„å¼€é”€æ˜¯å›ºå®šçš„ã€‚å¯ä»¥é€šè¿‡ æž„é€ å™¨è®¾ç½®å®¹é‡ capacity å’Œè´Ÿè½½å› å­ load factorï¼Œä»¥è°ƒæ•´å®¹å™¨çš„æ€§èƒ½ã€‚ LinkedHashMap : ç±»ä¼¼äºŽ HashMapï¼Œä½†æ˜¯è¿­ä»£éåŽ†å®ƒæ—¶ï¼Œå–å¾—â€œé”®å€¼å¯¹â€çš„é¡ºåºæ˜¯å…¶æ’ å…¥æ¬¡åºï¼Œæˆ–è€…æ˜¯æœ€è¿‘æœ€å°‘ä½¿ç”¨(LRU)çš„æ¬¡åºã€‚åªæ¯” HashMap æ…¢ä¸€ç‚¹ã€‚è€Œåœ¨è¿­ä»£è®¿é—®æ—¶å‘è€Œæ›´ å¿«ï¼Œå› ä¸ºå®ƒä½¿ç”¨é“¾è¡¨ç»´æŠ¤å†…éƒ¨æ¬¡åºã€‚ TreeMap : åŸºäºŽçº¢é»‘æ ‘æ•°æ®ç»“æž„çš„å®žçŽ°ã€‚æŸ¥çœ‹â€œé”®â€æˆ–â€œé”®å€¼å¯¹â€æ—¶ï¼Œå®ƒä»¬ä¼šè¢«æŽ’åº(æ¬¡ åºç”± Comparabel æˆ– Comparator å†³å®š)ã€‚TreeMap çš„ç‰¹ç‚¹åœ¨ äºŽï¼Œä½ å¾—åˆ°çš„ç»“æžœæ˜¯ç»è¿‡æŽ’åºçš„ã€‚ TreeMap æ˜¯å”¯ä¸€çš„å¸¦æœ‰ subMap()æ–¹æ³•çš„ Mapï¼Œå®ƒå¯ä»¥è¿”å›žä¸€ä¸ªå­æ ‘ã€‚ WeakHashMap : å¼±é”®(weak key)Mapï¼ŒMap ä¸­ä½¿ç”¨çš„å¯¹è±¡ä¹Ÿè¢«å…è®¸é‡Šæ”¾: è¿™æ˜¯ä¸ºè§£å†³ç‰¹ æ®Šé—®é¢˜è®¾è®¡çš„ã€‚å¦‚æžœæ²¡æœ‰ map ä¹‹å¤–çš„å¼•ç”¨æŒ‡å‘æŸä¸ªâ€œé”®â€ï¼Œåˆ™æ­¤â€œé”®â€å¯ä»¥è¢«åžƒåœ¾æ”¶é›†å™¨å›ž æ”¶ã€‚ IdentifyHashMap : ä½¿ç”¨==ä»£æ›¿ equals()å¯¹â€œé”®â€ä½œæ¯”è¾ƒçš„ hash mapã€‚ä¸“ä¸ºè§£å†³ç‰¹æ®Šé—®é¢˜ è€Œè®¾è®¡ã€‚ 2ã€åå°„2.1 åå°„åå°„: å°† Java ç±»ä¸­çš„å„ä¸ªæˆåˆ† (å±žæ€§, æ–¹æ³•, æž„é€ æ–¹æ³•) æ˜ å°„æˆå¯¹åº”çš„ç±» åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æ‰€å±žçš„ç±» Classã€‚ åœ¨è¿è¡Œæ—¶åˆ¤æ–­æž„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡ Constructorã€‚ åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡ Field å’Œæ–¹æ³• Methodã€‚ åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚method.invoke(object, args) åå°„çš„å¥½å¤„ æé«˜äº†æ•´ä¸ªä»£ç çš„çµæ´»æ€§ ä¸éœ€è¦çŸ¥é“ç»†èŠ‚ åå°„ç”¨çš„æœ€å¤šçš„æ—¶å€™, å°±æ˜¯å†™æ¡†æž¶çš„æ—¶å€™ åå°„ä¸­éœ€è¦æŽŒæ¡3ä¸ªç±»: Constructor: æž„é€ å™¨çš„æè¿°ç±» Field: å±žæ€§çš„æè¿°ç±» Method: æ–¹æ³•çš„æè¿°ç±» Java é¢„å®šä¹‰ç±»åž‹ æ˜¯å¦æ˜¯é¢„å®šä¹‰ç±»åž‹: isPromitive(), 8ç§åŸºæœ¬æ•°æ®ç±»åž‹ + void éƒ½æ˜¯é¢„å®šä¹‰ç±»åž‹ å¼•ç”¨ç±»åž‹, åŒ…è£…ç±»ä¸æ˜¯é¢„å®šä¹‰ç±»åž‹. 12System.out.println(int.class.isPrimitive()); // trueSystem.out.println(Integer.class.isPrimitive()); // false 2.2 ClassClass : ç”¨äºŽæè¿°æ‰€æœ‰ç±»çš„ç±», Class ç±»æè¿°äº†ç±»çš„å±žæ€§ä¿¡æ¯ï¼Œå¦‚ç±»åã€è®¿é—®æƒé™ã€åŒ…åã€å­— æ®µåç§°åˆ—è¡¨ã€æ–¹æ³•åç§°åˆ—è¡¨ç­‰, Classå°±æ˜¯åå°„çš„åŸºç¡€. èŽ·å–Classçš„3ç§æ–¹å¼ 1. `Class.forName`(&quot;ç±»åå­—ç¬¦ä¸²&quot;) (æ³¨æ„ï¼šç±»åå­—ç¬¦ä¸²å¿…é¡»æ˜¯å…¨ç§°ï¼ŒåŒ…å+ç±»å) - å¦‚æžœ `.class`å·²ç»è¢«åŠ è½½åˆ°å†…å­˜äº†, ç›´æŽ¥è¿”å›ž - å¦‚æžœæ²¡æœ‰çš„è¯, å°±å…ˆåŠ è½½åˆ°å†…å­˜ 2. `ç±»å.class` 3. `å®žä¾‹å¯¹è±¡.getClass()` 2.3 Constructor1234567891011121314151617181920212223242526// API// è¡¥å……: å¯å˜å‚æ•° Class&lt;?&gt;... parameterTypespublic Constructor&lt;T&gt; getConstructor(Class&lt;?&gt;... parameterTypes) &#123;&#125;public Constructor&lt;?&gt;[] getConstructors() throws SecurityException &#123;&#125; ================//ä½¿ç”¨=============================////////èŽ·å–æž„é€ æ–¹æ³•//////////// èŽ·å–æŸä¸ªç±»çš„æ‰€æœ‰æž„é€ æ–¹æ³•ï¼šConstructor[] constructor = Class.forName("java.lang.String").getConstructors();// èŽ·å–æŸä¸ªç‰¹æ®Šï¼ˆç‰¹å®šå‚æ•°ï¼‰çš„æž„é€ æ–¹æ³•ï¼šConstructor constructor = Class.forName("java.lang.String").getConstructor(StringBuffer.class);////////åˆ›å»ºå®žä¾‹å¯¹è±¡//////////// é€šå¸¸æ–¹å¼ï¼Œç›´æŽ¥è°ƒç”¨æž„é€ æ–¹æ³•ï¼šString str = new String("huangbo");// åå°„æ–¹å¼ï¼šè°ƒç”¨å®žå‚æž„é€ String str = (String)constructor.newInstance(new StringBuffer("huangbo"));// åå°„æ–¹å¼ï¼šè°ƒç”¨ç©ºå‚æž„é€ String obj = (String)Class.forName("java.lanng.String").newInstance();åªæœ‰ä¸¤ä¸ªç±»æ‹¥æœ‰ newInstance()æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ Class ç±»å’Œ Constructor ç±» Class ç±»ä¸­çš„ newInstance() æ–¹æ³•æ˜¯ä¸å¸¦å‚æ•°çš„ï¼ŒConstructor ç±»ä¸­çš„ newInstance()æ–¹æ³•æ˜¯å¸¦å‚æ•°çš„(Object)ï¼Œéœ€è¦æä¾› å¿…è¦çš„å‚æ•° 2.4 FieldFieldç±»ä»£è¡¨æŸä¸ªç±»ä¸­çš„ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œè®¾æœ‰ä¸€ä¸ª obj å¯¹è±¡ï¼ŒField å¯¹è±¡ä¸æ˜¯ obj å…·ä½“çš„å˜é‡å€¼ï¼Œ è€Œæ˜¯æŒ‡ä»£çš„æ˜¯ obj æ‰€å±žç±»çš„å“ªä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥é€šè¿‡ Field(å¯¹è±¡).get(obj)èŽ·å–ç›¸åº”çš„å˜é‡å€¼ 123456789101112131415// APIpublic Field[] getFields() throws SecurityException &#123;&#125;public Field getField(String name) &#123;&#125;================//ä½¿ç”¨=============================// getField æ–¹æ³•åªèƒ½èŽ·å–å£°æ˜Žä¸º public çš„å˜é‡ï¼Œå¯¹äºŽç§æœ‰å˜é‡ï¼Œå¯ä»¥é€šè¿‡ getDeclaredField()æ–¹æ³•èŽ· å– private å˜é‡Field field = obj.getClass().getDeclaredField();// å°† private å˜é‡è®¾ç½®ä¸ºå¯è®¿é—®ï¼›ç»§æ‰¿è‡ªçˆ¶ç±»AccessibleObject çš„æ–¹æ³•æ‰å¯èŽ·å–å˜é‡å€¼field.setAccessible(true); // èŽ·å¾—å¯¹è±¡å€¼, ä¼ å…¥å¯¹è±¡field.get(obj); // åå°„æ›¿æ¢,è®¾ç½®å¯¹è±¡å€¼// ä¼ å…¥å¯¹è±¡,å€¼// æŠŠ obj å¯¹è±¡çš„ field å±žæ€§çš„å€¼æ›¿æ¢ä¸º newValuefield.set(obj,newValue) 2.5 MethodMethod ç±»ä»£è¡¨æŸä¸ªç±»ä¸­çš„æˆå‘˜æ–¹æ³• Method å¯¹è±¡ä¸æ˜¯å…·ä½“çš„æ–¹æ³•ï¼Œè€Œæ˜¯æ¥ä»£è¡¨ç±»ä¸­å“ªä¸€ä¸ªæ–¹æ³•ï¼Œä¸Žå¯¹è±¡æ— å…³ 123456789101112// èŽ·å–: å¾—åˆ°ç±»ä¸­æŸä¸€ä¸ªæ–¹æ³•ï¼šMethod methodCharAt = Class.forName("java.lang.String").getMethod("charAt",int.class)// getMethod æ–¹æ³•ç”¨äºŽå¾—åˆ°ä¸€ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œè¯¥æ–¹æ³•æŽ¥å—çš„å‚æ•°é¦–å…ˆè¦æœ‰è¯¥æ–¹æ³•åï¼ˆString ç±»åž‹ï¼‰ï¼Œ// ç„¶åŽé€šè¿‡å‚æ•°åˆ—è¡¨æ¥åŒºåˆ†é‡è½½é‚£ä¸ªæ–¹æ³•ï¼Œå‚æ•°ç±»åž‹ç”¨ Class å¯¹è±¡æ¥è¡¨ç¤º(å¦‚ä¸º int å°±ç”¨ int.class) // è°ƒç”¨æ–¹æ³•ï¼š//æ™®é€šæ–¹å¼ï¼šstr.charAt(1)//åå°„æ–¹å¼ï¼šmethodCharAt.invoke(str,1)// ä»¥ä¸Šä¸¤ç§è°ƒç”¨æ–¹å¼ç­‰ä»· 3. è®¾è®¡æ¨¡å¼è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰ä»£è¡¨äº†é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­æœ€ä½³çš„å®žè·µï¼Œé€šå¸¸è¢«æœ‰ç»éªŒçš„é¢å‘å¯¹è±¡çš„ è½¯ä»¶å¼€å‘äººå‘˜æ‰€é‡‡ç”¨ã€‚è®¾è®¡æ¨¡å¼æ˜¯è½¯ä»¶å¼€å‘äººå‘˜åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­é¢ä¸´çš„ä¸€èˆ¬é—®é¢˜çš„è§£å†³æ–¹ æ¡ˆã€‚è¿™äº›è§£å†³æ–¹æ¡ˆæ˜¯ä¼—å¤šè½¯ä»¶å¼€å‘äººå‘˜ç»è¿‡ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´çš„è¯•éªŒå’Œé”™è¯¯æ€»ç»“å‡ºæ¥çš„ã€‚ è®¾è®¡æ¨¡å¼åªä¸è¿‡é’ˆå¯¹æŸäº›å…·ä½“åœºæ™¯æä¾›äº†ä¸€äº›æ•ˆçŽ‡è¾ƒé«˜çš„ä»¥å¤æ‚åº¦æ¢çµæ´»æ€§çš„æ‰‹æ®µè€Œå·² æŽ¨èå­¦ä¹ ç«™ç‚¹ 3.1 è®¾è®¡æ¨¡å¼ â€“ å…­å¤§åŽŸåˆ™æ€»åŽŸåˆ™ï¼šå¼€é—­åŽŸåˆ™ï¼ˆOpen Close Principleï¼‰ å¼€é—­åŽŸåˆ™å°±æ˜¯è¯´å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚åœ¨ç¨‹åºéœ€è¦è¿›è¡Œæ‹“å±•çš„æ—¶å€™ï¼Œä¸èƒ½åŽ»ä¿®æ”¹åŽŸæœ‰çš„ ä»£ç ï¼Œè€Œæ˜¯è¦æ‰©å±•åŽŸæœ‰ä»£ç ï¼Œå®žçŽ°ä¸€ä¸ªçƒ­æ’æ‹”çš„æ•ˆæžœã€‚æ‰€ä»¥ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼šä¸ºäº†ä½¿ç¨‹åºçš„ æ‰©å±•æ€§å¥½ï¼Œæ˜“äºŽç»´æŠ¤å’Œå‡çº§ã€‚æƒ³è¦è¾¾åˆ°è¿™æ ·çš„æ•ˆæžœï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æŽ¥å£å’ŒæŠ½è±¡ç±»ç­‰ï¼ŒåŽé¢çš„ å…·ä½“è®¾è®¡ä¸­æˆ‘ä»¬ä¼šæåˆ°è¿™ç‚¹ã€‚ å…­å¤§åŽŸåˆ™ï¼š å•ä¸€èŒè´£åŽŸåˆ™ ä¸è¦å­˜åœ¨å¤šäºŽä¸€ä¸ªå¯¼è‡´ç±»å˜æ›´çš„åŽŸå› ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªç±»åº”è¯¥å®žçŽ°å•ä¸€çš„èŒè´£ï¼Œå¦‚è‹¥ä¸ç„¶ï¼Œå°± åº”è¯¥æŠŠç±»æ‹†åˆ†ã€‚ é‡Œæ°æ›¿æ¢åŽŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰ é‡Œæ°æ›¿æ¢åŽŸåˆ™ä¸­ï¼Œå­ç±»å¯¹çˆ¶ç±»çš„æ–¹æ³•å°½é‡ä¸è¦é‡å†™å’Œé‡è½½ã€‚å› ä¸ºçˆ¶ç±»ä»£è¡¨äº†å®šä¹‰å¥½çš„ç»“æž„ï¼Œé€šè¿‡è¿™ä¸ªè§„èŒƒçš„æŽ¥å£ä¸Žå¤–ç•Œäº¤äº’ï¼Œå­ç±»ä¸åº”è¯¥éšä¾¿ç ´åå®ƒã€‚ ä¾èµ–å€’è½¬åŽŸåˆ™ï¼ˆDependence Inversion Principleï¼‰ è¿™ä¸ªæ˜¯å¼€é—­åŽŸåˆ™çš„åŸºç¡€ï¼Œå…·ä½“å†…å®¹ï¼šé¢å‘æŽ¥å£ç¼–ç¨‹ï¼Œä¾èµ–äºŽæŠ½è±¡è€Œä¸ä¾èµ–äºŽå…·ä½“ã€‚å†™ä»£ç  æ—¶ç”¨åˆ°å…·ä½“ç±»æ—¶ï¼Œä¸ä¸Žå…·ä½“ç±»äº¤äº’ï¼Œè€Œä¸Žå…·ä½“ç±»çš„ä¸Šå±‚æŽ¥å£äº¤äº’ã€‚ æŽ¥å£éš”ç¦»åŽŸåˆ™ï¼ˆInterface Segregation Principleï¼‰ è¿™ä¸ªåŽŸåˆ™çš„æ„æ€æ˜¯ï¼šæ¯ä¸ªæŽ¥å£ä¸­ä¸å­˜åœ¨å­ç±»ç”¨ä¸åˆ°å´å¿…é¡»å®žçŽ°çš„æ–¹æ³•ï¼Œå¦‚æžœä¸ç„¶ï¼Œå°±è¦å°† æŽ¥å£æ‹†åˆ†ã€‚ä½¿ç”¨å¤šä¸ªéš”ç¦»çš„æŽ¥å£ï¼Œæ¯”ä½¿ç”¨å•ä¸ªæŽ¥å£ï¼ˆå¤šä¸ªæŽ¥å£æ–¹æ³•é›†åˆåˆ°ä¸€ä¸ªçš„æŽ¥å£ï¼‰è¦å¥½ã€‚ è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆæœ€å°‘çŸ¥é“åŽŸåˆ™ï¼‰ï¼ˆDemeter Principleï¼‰ å°±æ˜¯è¯´ï¼šä¸€ä¸ªç±»å¯¹è‡ªå·±ä¾èµ–çš„ç±»çŸ¥é“çš„è¶Šå°‘è¶Šå¥½ ã€‚ä¹Ÿå°±æ˜¯è¯´æ— è®ºè¢«ä¾èµ–çš„ç±»å¤šä¹ˆå¤æ‚ï¼Œéƒ½ åº”è¯¥å°†é€»è¾‘å°è£…åœ¨æ–¹æ³•çš„å†…éƒ¨ï¼Œé€šè¿‡ public æ–¹æ³•æä¾›ç»™å¤–éƒ¨ã€‚è¿™æ ·å½“è¢«ä¾èµ–çš„ç±»å˜åŒ–æ—¶ï¼Œæ‰ èƒ½æœ€å°çš„å½±å“è¯¥ç±»ã€‚ åˆæˆå¤ç”¨åŽŸåˆ™ï¼ˆComposite Reuse Principleï¼‰ åŽŸåˆ™æ˜¯å°½é‡é¦–å…ˆä½¿ç”¨åˆæˆ/èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿ã€‚ 3.2 è®¾è®¡æ¨¡å¼ â€“ åˆ†ç±»æ€»ä½“æ¥è¯´è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰å¤§ç±»ï¼š åˆ›å»ºåž‹æ¨¡å¼ï¼Œå…±äº”ç§ï¼šå·¥åŽ‚æ–¹æ³•æ¨¡å¼ã€æŠ½è±¡å·¥åŽ‚æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€åŽŸåž‹æ¨¡å¼ã€‚ ç»“æž„åž‹æ¨¡å¼ï¼Œå…±ä¸ƒç§ï¼šé€‚é…å™¨æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€ä»£ç†æ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€æ¡¥æŽ¥æ¨¡å¼ã€ç»„åˆ æ¨¡å¼ã€äº«å…ƒæ¨¡å¼ã€‚ è¡Œä¸ºåž‹æ¨¡å¼ï¼Œå…±åä¸€ç§ï¼šç­–ç•¥æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€è¿­ä»£å­æ¨¡å¼ã€è´£ä»»é“¾æ¨¡ å¼ã€å‘½ä»¤æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€è®¿é—®è€…æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€‚ 3.3 å¸¸è§è®¾è®¡æ¨¡å¼3.3.1 å•ä¾‹æ¨¡å¼(æ‰‹å†™)å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ Java ä¸­æœ€ç®€å•çš„,ä¹Ÿæ˜¯æœ€æœ€æœ€å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚è¿™ç§ç±» åž‹çš„è®¾è®¡æ¨¡å¼å±žäºŽåˆ›å»ºåž‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚ æ³¨æ„: å•ä¾‹ç±»åªèƒ½æœ‰ä¸€ä¸ªå®žä¾‹ã€‚ å•ä¾‹ç±»å¿…é¡»è‡ªå·±åˆ›å»ºè‡ªå·±çš„å”¯ä¸€å®žä¾‹ã€‚ å•ä¾‹ç±»å¿…é¡»ç»™æ‰€æœ‰å…¶ä»–å¯¹è±¡æä¾›è¿™ä¸€å®žä¾‹ã€‚ å…±æœ‰å…­ç§å®žçŽ°ï¼š 1ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨ 1234567891011public class Singleton &#123; private static Singleton instance; private Singleton ()&#123;&#125; public static Singleton getInstance() &#123; if (instance == null) &#123; instance = new Singleton(); &#125; return instance; &#125; &#125; 2ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ 12345678910public class Singleton &#123; private static Singleton instance; private Singleton ()&#123;&#125; public static synchronized Singleton getInstance() &#123; if (instance == null) &#123; instance = new Singleton(); &#125; return instance; &#125; &#125; 3ã€é¥¿æ±‰å¼ 1234567public class Singleton &#123; private static Singleton instance = new Singleton(); private Singleton ()&#123;&#125; public static Singleton getInstance() &#123; return instance; &#125; &#125; 4ã€åŒæ£€é”/åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³ double-checked lockingï¼‰ â€“é¢è¯•å¿…å¤‡ 1234567891011121314public class Singleton &#123; private volatile static Singleton singleton; private Singleton ()&#123;&#125; public static Singleton getSingleton() &#123; if (singleton == null) &#123; synchronized (Singleton.class) &#123; if (singleton == null) &#123; singleton = new Singleton(); &#125; &#125; &#125; return singleton; &#125; &#125; 5ã€ç™»è®°å¼/é™æ€å†…éƒ¨ç±» 123456789public class Singleton &#123; private static class SingletonHolder &#123; private static final Singleton INSTANCE = new Singleton(); &#125; private Singleton ()&#123;&#125; public static final Singleton getInstance() &#123; return SingletonHolder.INSTANCE; &#125; &#125; 6ã€æžšä¸¾ 12345public enum Singleton &#123; INSTANCE; public void whateverMethod() &#123; &#125; &#125; è¯¦ç»†è¯·çœ‹ 3.3.2 è£…é¥°å™¨æ¨¡å¼(æ‰‹å†™)é¦–å…ˆçœ‹ä¸€æ®µä»£ç  ä»£ç åˆ†æž: æž„é€ ä¸€ä¸ªç¼“å†²çš„å­—ç¬¦è¾“å…¥æµã€‚åŒ…è£…äº†ä¸€ä¸ªæ–‡ä»¶å­—ç¬¦è¾“å…¥æµã€‚ äº‹å®žä¸Šï¼ŒBufferedReader å°±æ˜¯ç”¨æ¥å¢žå¼º FileReader çš„è¯»å–çš„åŠŸèƒ½çš„ã€‚ FileReader åªæœ‰ read()æ–¹æ³•ï¼Œ ä½†æ˜¯ BufferedReader ä¸­å´å¢žåŠ äº†ä¸€ä¸ª readLine()çš„é€è¡Œè¯»å– çš„åŠŸèƒ½ æ‰€ä»¥è¿™å°±ç›¸å½“äºŽæ˜¯ BufferedReader è£…é¥°äº† FileReaderï¼Œè®© FileReader å˜å¾—æ›´å¼ºå¤§ è£…é¥°å™¨æ¨¡å¼æ¦‚å¿µ è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰å…è®¸å‘ä¸€ä¸ªçŽ°æœ‰çš„å¯¹è±¡æ·»åŠ æ–°çš„åŠŸèƒ½ï¼ŒåŒæ—¶åˆä¸æ”¹å˜å…¶ç»“ æž„ã€‚è¿™ç§ç±»åž‹çš„è®¾è®¡æ¨¡å¼å±žäºŽç»“æž„åž‹æ¨¡å¼ï¼Œå®ƒæ˜¯ä½œä¸ºçŽ°æœ‰çš„ç±»çš„ä¸€ä¸ªåŒ…è£…ã€‚ è¿™ç§æ¨¡å¼åˆ›å»ºäº†ä¸€ä¸ªè£…é¥°ç±»ï¼Œç”¨æ¥åŒ…è£…åŽŸæœ‰çš„ç±»ï¼Œå¹¶åœ¨ä¿æŒç±»æ–¹æ³•ç­¾åå®Œæ•´æ€§çš„å‰æä¸‹ï¼Œ æä¾›äº†é¢å¤–çš„åŠŸèƒ½ã€‚ è£…é¥°å™¨æ¨¡å¼å®žçŽ°æ–¹å¼1. å®šä¹‰åŒ…è£…ç±» 2. å°†è¦è£…é¥°çš„æ¨¡å¼ä½œä¸ºå‚æ•°ä¼ å…¥åŒ…è£…ç±» 3. å®žçŽ°è¦åŠ å¼ºçš„æ–¹æ³• 3.3.2 ä»£ç†æ¨¡å¼1. é™æ€ä»£ç†é™æ€ä»£ç†çš„ç¼ºç‚¹å¾ˆæ˜Žæ˜¾ï¼šä¸€ä¸ªä»£ç†ç±»åªèƒ½å¯¹ä¸€ä¸ªä¸šåŠ¡æŽ¥å£çš„å®žçŽ°ç±»è¿›è¡ŒåŒ…è£…ï¼Œå¦‚æžœæœ‰å¤šä¸ªä¸š åŠ¡æŽ¥å£çš„è¯å°±è¦å®šä¹‰å¾ˆå¤šå®žçŽ°ç±»å’Œä»£ç†ç±»æ‰è¡Œã€‚ â€¦ 2. åŠ¨æ€ä»£ç†ç¬¬ä¸€ç§ï¼šJDK åŠ¨æ€ä»£ç†å®žçŽ° JDK åŠ¨æ€ä»£ç†æ‰€ç”¨åˆ°çš„ä»£ç†ç±»åœ¨ç¨‹åºè°ƒç”¨åˆ°ä»£ç†ç±»å¯¹è±¡æ—¶æ‰ç”± JVM çœŸæ­£åˆ›å»ºï¼ŒJVM æ ¹æ®ä¼  è¿›æ¥çš„ä¸šåŠ¡å®žçŽ°ç±»å¯¹è±¡ä»¥åŠæ–¹æ³•åï¼ŒåŠ¨æ€åœ°åˆ›å»ºäº†ä¸€ä¸ªä»£ç†ç±»çš„ class æ–‡ä»¶å¹¶è¢«å­—èŠ‚ç å¼•æ“Ž æ‰§è¡Œï¼Œç„¶åŽé€šè¿‡è¯¥ä»£ç†ç±»å¯¹è±¡è¿›è¡Œæ–¹æ³•è°ƒç”¨ã€‚æˆ‘ä»¬éœ€è¦åšçš„ï¼Œåªéœ€æŒ‡å®šä»£ç†ç±»çš„é¢„å¤„ç†ã€ è°ƒç”¨åŽæ“ä½œå³å¯ã€‚ åªèƒ½å¯¹å®žçŽ°äº†æŽ¥å£çš„ç±»ç”Ÿæˆä»£ç†ï¼Œè€Œä¸æ˜¯é’ˆå¯¹ç±»ï¼Œè¯¥ç›®æ ‡ç±»åž‹å®žçŽ°çš„æŽ¥å£éƒ½å°†è¢«ä»£ç†ã€‚åŽŸç† æ˜¯é€šè¿‡åœ¨è¿è¡ŒæœŸé—´åˆ›å»ºä¸€ä¸ªæŽ¥å£çš„å®žçŽ°ç±»æ¥å®Œæˆå¯¹ç›®æ ‡å¯¹è±¡çš„ä»£ç†ã€‚å…·ä½“å®žçŽ°æ­¥éª¤ï¼š å®šä¹‰ä¸€ä¸ªå®žçŽ°æŽ¥å£ InvocationHandler çš„ç±» é€šè¿‡æž„é€ å‡½æ•°æˆ–è€…é™æ€å·¥åŽ‚æ–¹æ³•ç­‰ï¼Œæ³¨å…¥è¢«ä»£ç†ç±» å®žçŽ° invoke(Object proxy, Method method, Object[] args)æ–¹æ³• åœ¨ä¸»å‡½æ•°ä¸­èŽ·å¾—è¢«ä»£ç†ç±»çš„ç±»åŠ è½½å™¨ ä½¿ç”¨ Proxy.newProxyInstance(classLoader, interfaces, args)äº§ç”Ÿä¸€ä¸ªä»£ç†å¯¹è±¡ é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨å„ç§æ–¹æ³• 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859=============//å®žçŽ°InvocationHandler====================import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;/** * @author shixuanji * åŠ¨æ€ä»£ç†: JDK * 1. å®žçŽ°ä¸€ä¸ªæŽ¥å£ InvocationHandler * 2. å°†ä»£ç†å¯¹è±¡ä½œä¸ºå±žæ€§ä¼ å…¥ ä»£ç†æ‰€æœ‰çš„ç±» * 3. é‡å†™ invoke()æ–¹æ³• * */public class ProxyDynamicStudentDao implements InvocationHandler &#123; private Object o; public ProxyDynamicStudentDao(Object o) &#123; this.o = o; &#125; /* * @param proxy: ä»£ç†å¯¹è±¡, åŸºæœ¬ä¸ç”¨ ???åº”è¯¥æ˜¯ä»£ç†å¯¹è±¡æŠŠ, è€å¸ˆå†™çš„è¢«ä»£ç†å¯¹è±¡ * @param method: æ‹¦æˆªä¸‹æ¥çš„è¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³• - åå°„ä¸­æè¿°æ–¹æ³•çš„ç±» * @param args: è¢«ä»£ç†å¯¹è±¡ä¸šåŠ¡æ–¹æ³•çš„å‚æ•° */ public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; String methodName = method.getName().toString(); if (methodName.equals("insert")) &#123; // xxx &#125; else &#123; //ssssss &#125; // åšçš„äº‹æƒ…å°±æ˜¯å¯¹ä»£ç†æ–¹æ³•çš„æ–¹æ³•çš„å¢žå¼º // å¢žå¼º System.out.println("å¼€å§‹æ‰§è¡Œ"); // ä¸šåŠ¡æ–¹æ³•è°ƒç”¨, ä¸€å®šè¦è°ƒç”¨è¢«ä»£ç†å¯¹è±¡çš„ // obj: å¯¹è±¡ // args:æ–¹æ³•çš„å‚æ•° Object res = method.invoke(o, args); // å¢žå¼º System.out.println("æ‰§è¡Œå®Œäº†"); return res; &#125;&#125;============== // ä½¿ç”¨========================/*** å‚æ•°1: è¢«ä»£ç†å¯¹è±¡çš„ç±»åŠ è½½å™¨ * å‚æ•°2: è¦å®žçŽ°çš„æŽ¥å£* å‚æ•°3: ä»£ç†ç±»å¯¹è±¡ * * èƒ½.å‡ºæ¥ä»€ä¹ˆçœ‹ å·¦è¾¹æŽ¥æ”¶ç€* è¿è¡Œæ—¶çœ‹ çœŸæ­£åˆ›å»ºçš„å¯¹è±¡*/// ç›®å‰çœ‹æ¥ ä»£ç†å®žä¾‹åªèƒ½æ˜¯æŽ¥å£BaseDAO newProxyInstance = (BaseDAO)Proxy.newProxyInstance(StudentDAO.class.getClassLoader(), StudentDAO.class.getInterfaces(), new ProxyDynamicStudentDao(new StudentDAO()));newProxyInstance.insert(new Teacher()); ç¬¬äºŒç§ï¼šCGLIB åŠ¨æ€ä»£ç†å®žçŽ°ï¼š CGLIB æ˜¯é’ˆå¯¹ç±»æ¥å®žçŽ°ä»£ç†çš„ï¼ŒåŽŸç†æ˜¯å¯¹æŒ‡å®šçš„ä¸šåŠ¡ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œå¹¶è¦†ç›–å…¶ä¸­ä¸šåŠ¡æ–¹æ³• å®žçŽ°ä»£ç†ã€‚å› ä¸ºé‡‡ç”¨çš„æ˜¯ç»§æ‰¿ï¼Œæ‰€ä»¥ä¸èƒ½å¯¹ final ä¿®é¥°çš„ç±»è¿›è¡Œä»£ç†ï¼Œfinal çš„æ–¹æ³•ä¹Ÿä¸èƒ½ é’ˆå¯¹ç±»å®žçŽ°ä»£ç†ï¼Œå¯¹æ˜¯å¦å®žçŽ°æŽ¥å£æ— è¦æ±‚ã€‚åŽŸç†æ˜¯å¯¹æŒ‡å®šçš„ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œè¦†ç›–å…¶ä¸­çš„æ–¹ æ³•ï¼Œå› ä¸ºæ˜¯ç»§æ‰¿ï¼Œæ‰€ä»¥è¢«ä»£ç†çš„ç±»æˆ–æ–¹æ³•æœ€å¥½ä¸è¦å£°æ˜Žä¸º final ç±»åž‹ã€‚å…·ä½“å®žçŽ°æ­¥éª¤ï¼š 1ã€å®šä¹‰ä¸€ä¸ªå®žçŽ°äº† MethodInterceptor æŽ¥å£çš„ç±» 2ã€å®žçŽ°å…¶ intercept()æ–¹æ³•ï¼Œåœ¨å…¶ä¸­è°ƒç”¨ proxy.invokeSuper() 3. é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†çš„åŒºåˆ«é™æ€ä»£ç†ï¼šè‡ªå·±ç¼–å†™åˆ›å»ºä»£ç†ç±»ï¼Œç„¶åŽå†è¿›è¡Œç¼–è¯‘ï¼Œåœ¨ç¨‹åºè¿è¡Œå‰ï¼Œä»£ç†ç±»çš„.class æ–‡ä»¶å°± å·²ç»å­˜åœ¨äº†ã€‚ åŠ¨æ€ä»£ç†ï¼šåœ¨å®žçŽ°é˜¶æ®µä¸ç”¨å…³å¿ƒä»£ç†è°ï¼Œè€Œåœ¨è¿è¡Œé˜¶æ®µï¼ˆé€šè¿‡åå°„æœºåˆ¶ï¼‰æ‰æŒ‡å®šä»£ç†å“ªä¸€ä¸ª å¯¹è±¡ã€‚ 3.4 é‡ç‚¹æŽŒæ¡3.4.1. è£…é¥°è€…æ¨¡å¼ å’Œ é™æ€ä»£ç†æ¨¡å¼ åŒºåˆ«åœ¨ä»£ç ä¸Šçš„åŒºåˆ«: ä¸€èˆ¬æƒ…å†µä¸‹, è£…é¥°è€…æ¨¡å¼è¢«è£…é¥°çš„å¯¹è±¡ä¸€èˆ¬æ˜¯ä»Žå¤–éƒ¨ä¼ å…¥, è£…é¥°çš„æ˜¯ä¸€ç±»çš„äº‹åŠ¡, åªè¦æ˜¯æŸä¸€ç±»çš„(Class)éƒ½å¯ä»¥ é™æ€ä»£ç†æ¨¡å¼è¢«ä»£ç†å¯¹è±¡çš„åˆå§‹åŒ–ä¸€èˆ¬æ˜¯å†…éƒ¨åˆ›å»ºçš„, ä»£ç†çš„æ˜¯ä¸€ä¸ªç±»çš„å¯¹è±¡. ä»ŽåŠŸèƒ½ä¸Š: è£…é¥°è€…æ¨¡å¼, ç”¨äºŽå¯¹è¢«è£…é¥°è€…ä¸šåŠ¡é€»è¾‘å®žçŽ°æˆ–å¢žå¼º, å¯¹æ–¹æ³•åæ²¡æœ‰è¦æ±‚ é™æ€ä»£ç†: ä¸»è¦ç”¨äºŽæƒé™æŽ§åˆ¶, æ—¥å¿—æ‰“å°, é”™è¯¯é¢„è­¦ç­‰åŠŸèƒ½ 3.4.2. ä¸‰ç§è®¾è®¡æ¨¡å¼å¿…é¡»æŽŒæ¡çš„ å•ä¾‹è®¾è®¡æ¨¡å¼ è£…é¥°è€…æ¨¡å¼ åŠ¨æ€ä»£ç†æ¨¡å¼ 3.4.3. æ‰‹å†™ä»£ç  å†’æ³¡æŽ’åº å¿«é€ŸæŽ’åº è®¾è®¡æ¨¡å¼ hadoop çš„ wordcount scala çš„ wordcount spark çš„ wordcount 4. æŽ’åºç®—æ³• æ ¸å¿ƒæ¦‚å¿µï¼šç®—æ³•å¤æ‚åº¦ã€ç¨³å®šæ€§ ç®—æ³•å¤æ‚åº¦ï¼šç®—æ³•å¤æ‚åº¦æ˜¯æŒ‡ç®—æ³•åœ¨ç¼–å†™æˆå¯æ‰§è¡Œç¨‹åºåŽï¼Œè¿è¡Œæ—¶æ‰€éœ€è¦çš„èµ„æºï¼Œèµ„æºåŒ…æ‹¬ æ—¶é—´èµ„æºå’Œå†…å­˜èµ„æºã€‚åº”ç”¨äºŽæ•°å­¦å’Œè®¡ç®—æœºå¯¼è®ºã€‚ ç¨³å®šæ€§ï¼šä¸€ä¸ªæŽ’åºç®—æ³•æ˜¯ç¨³å®šçš„ï¼Œå°±æ˜¯å½“æœ‰ä¸¤ä¸ªç›¸ç­‰è®°å½•çš„å…³é”®å­— R å’Œ Sï¼Œä¸”åœ¨åŽŸæœ¬çš„åˆ—è¡¨ ä¸­ R å‡ºçŽ°åœ¨ S ä¹‹å‰ï¼Œåœ¨æŽ’åºè¿‡çš„åˆ—è¡¨ä¸­ R ä¹Ÿå°†ä¼šæ˜¯åœ¨ S ä¹‹å‰ã€‚ 4.1. æŽ’åºåˆ†ç±»æŒ‰ç…§æŽ’åºç»“æžœæ˜¯å¦ç¨³å®šæ€§åˆ†ç±»ï¼š ç¨³å®šæŽ’åºï¼šæ’å…¥æŽ’åºï¼Œå†’æ³¡æŽ’åºï¼Œå½’å¹¶æŽ’åºï¼Œè®¡æ•°æŽ’åºï¼ŒåŸºæ•°æŽ’åºï¼Œæ¡¶æŽ’åºï¼ˆå¦‚æžœæ¡¶å†… æŽ’åºé‡‡ç”¨çš„æ˜¯ç¨³å®šæ€§æŽ’åºï¼‰ éžç¨³å®šæŽ’åºï¼šé€‰æ‹©æŽ’åºï¼Œå¿«é€ŸæŽ’åºï¼Œå †æŽ’åºã€‚ æŒ‰ç…§æŽ’åºè¿‡ç¨‹ä¸­æ˜¯å¦éœ€è¦é¢å¤–ç©ºé—´ï¼š åŽŸåœ°æŽ’åºï¼šæ’å…¥æŽ’åºï¼Œé€‰æ‹©æŽ’åºï¼Œå†’æ³¡æŽ’åºï¼Œå¿«é€ŸæŽ’åºï¼Œå †æŽ’åºã€‚ éžåŽŸåœ°æŽ’åºï¼šå½’å¹¶æŽ’åºï¼Œè®¡æ•°æŽ’åºï¼ŒåŸºæ•°æŽ’åºï¼Œæ¡¶æŽ’åºã€‚ æŒ‰ç…§æŽ’åºçš„ä¸»è¦æ“ä½œåˆ†ç±»ï¼š äº¤æ¢ç±»ï¼šå†’æ³¡æŽ’åºã€å¿«é€ŸæŽ’åºï¼›æ­¤ç±»çš„ç‰¹ç‚¹æ˜¯é€šè¿‡ä¸æ–­çš„æ¯”è¾ƒå’Œäº¤æ¢è¿›è¡ŒæŽ’åºï¼› æ’å…¥ç±»ï¼šç®€å•æ’å…¥æŽ’åºã€å¸Œå°”æŽ’åºï¼›æ­¤ç±»çš„ç‰¹ç‚¹æ˜¯é€šè¿‡æ’å…¥çš„æ‰‹æ®µè¿›è¡ŒæŽ’åºï¼› é€‰æ‹©ç±»ï¼šç®€å•é€‰æ‹©æŽ’åºã€å †æŽ’åºï¼›æ­¤ç±»çš„ç‰¹ç‚¹æ˜¯çœ‹å‡†äº†å†ç§»åŠ¨ï¼› å½’å¹¶ç±»ï¼šå½’å¹¶æŽ’åºï¼›æ­¤ç±»çš„ç‰¹ç‚¹æ˜¯å…ˆåˆ†å‰²åŽåˆå¹¶ï¼› æŒ‰ç…§æ˜¯å¦éœ€è¦æ¯”è¾ƒåˆ†ç±»ï¼š æ¯”è¾ƒæŽ’åºï¼Œæ—¶é—´å¤æ‚åº¦ O(nlogn) ~ O(n^2)ï¼Œä¸»è¦æœ‰ï¼šå†’æ³¡æŽ’åºï¼Œé€‰æ‹©æŽ’åºï¼Œæ’å…¥æŽ’åºï¼Œ å½’å¹¶æŽ’åºï¼Œå †æŽ’åºï¼Œå¿«é€ŸæŽ’åºç­‰ã€‚ éžæ¯”è¾ƒæŽ’åºï¼Œæ—¶é—´å¤æ‚åº¦å¯ä»¥è¾¾åˆ° O(n)ï¼Œä¸»è¦æœ‰ï¼šè®¡æ•°æŽ’åºï¼ŒåŸºæ•°æŽ’åºï¼Œæ¡¶æŽ’åºç­‰ã€‚ 4.2 å¸¸è§æŽ’åºçš„æ—¶é—´å¤æ‚åº¦ æœ‰è¶£çš„æŽ’åºç®—æ³•è§†é¢‘ 4.3 å¸¸è§æŽ’åºç®—æ³•çš„æ ¸å¿ƒå®žçŽ°4.3.1 å†’æ³¡æŽ’åº 4.3.2 å½’å¹¶æŽ’åº 4.3.3 å¿«é€ŸæŽ’åº]]></content>
      <categories>
        <category>Java</category>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå­¦ä¹ ç¬”è®°-5]]></title>
    <url>%2F2018%2F05%2F28%2FLinux%2FLinux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-5%2F</url>
    <content type="text"><![CDATA[1.Shellæ“ä½œæ—¥æœŸæ—¶é—´dateåœ¨ç±»UNIXç³»ç»Ÿä¸­ï¼Œæ—¥æœŸè¢«å­˜å‚¨ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œå…¶å¤§å°ä¸ºè‡ªä¸–ç•Œæ ‡å‡†æ—¶é—´ï¼ˆUTCï¼‰1970å¹´1æœˆ1æ—¥0æ—¶0åˆ†0ç§’èµ·æµé€çš„ç§’æ•°ã€‚ è¯­æ³• 1date(é€‰é¡¹)(å‚æ•°) é€‰é¡¹ 12345-d&lt;å­—ç¬¦ä¸²&gt;ï¼šæ˜¾ç¤ºå­—ç¬¦ä¸²æ‰€æŒ‡çš„æ—¥æœŸä¸Žæ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åŽå¿…é¡»åŠ ä¸ŠåŒå¼•å·ï¼›-s&lt;å­—ç¬¦ä¸²&gt;ï¼šæ ¹æ®å­—ç¬¦ä¸²æ¥è®¾ç½®æ—¥æœŸä¸Žæ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åŽå¿…é¡»åŠ ä¸ŠåŒå¼•å·ï¼›-uï¼šæ˜¾ç¤ºGMT, å³ç›®å‰çš„æ ¼æž—å¨æ²»æ—¶é—´ï¼›--helpï¼šåœ¨çº¿å¸®åŠ©ï¼›--versionï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚ å‚æ•° &lt;+æ—¶é—´æ—¥æœŸæ ¼å¼&gt;ï¼šæŒ‡å®šæ˜¾ç¤ºæ—¶ä½¿ç”¨çš„æ—¥æœŸæ—¶é—´æ ¼å¼ã€‚ æ—¥æœŸæ ¼å¼å­—ç¬¦ä¸²åˆ—è¡¨ 123456789101112131415161718192021222324%r æ—¶é—´ï¼Œ12å°æ—¶åˆ¶%s ä»Ž1970å¹´1æœˆ1æ—¥0ç‚¹åˆ°ç›®å‰ç»åŽ†çš„ç§’æ•°%S ç§’ï¼ˆ00ï½ž59ï¼‰ %T æ—¶é—´ï¼ˆ24å°æ—¶åˆ¶ï¼‰ï¼ˆhh:mm:ssï¼‰%X æ˜¾ç¤ºæ—¶é—´çš„æ ¼å¼ï¼ˆï¼…Hæ—¶ï¼…Måˆ†ï¼…Sç§’ï¼‰%Z æŒ‰å­—æ¯è¡¨æŽ’åºçš„æ—¶åŒºç¼©å†™%a æ˜ŸæœŸåç¼©å†™%A æ˜ŸæœŸåå…¨ç§°%b æœˆåç¼©å†™%B æœˆåå…¨ç§°%c æ—¥æœŸå’Œæ—¶é—´%d æŒ‰æœˆè®¡çš„æ—¥æœŸï¼ˆ01ï½ž31ï¼‰%D æ—¥æœŸï¼ˆmm/dd/yyï¼‰ %h å’Œ%bé€‰é¡¹ç›¸åŒ%j ä¸€å¹´çš„ç¬¬å‡ å¤©ï¼ˆ001~366ï¼‰%m æœˆä»½ï¼ˆ01ï½ž12ï¼‰%w ä¸€ä¸ªæ˜ŸæœŸçš„ç¬¬å‡ å¤©ï¼ˆ0ä»£è¡¨æ˜ŸæœŸå¤©ï¼‰%W ä¸€å¹´çš„ç¬¬å‡ ä¸ªæ˜ŸæœŸï¼ˆ00ï½ž53ï¼Œæ˜ŸæœŸä¸€ä¸ºç¬¬ä¸€å¤©ï¼‰%x æ˜¾ç¤ºæ—¥æœŸçš„æ ¼å¼ï¼ˆmm/dd/yyï¼‰%y å¹´ä»½çš„æœ€åŽä¸¤ä¸ªæ•°å­—ï¼ˆ1999åˆ™æ˜¯99ï¼‰%Y å¹´ä»½ï¼ˆæ¯”å¦‚1970ã€1996ç­‰ï¼‰%C ä¸–çºªï¼Œé€šå¸¸ä¸ºçœç•¥å½“å‰å¹´ä»½çš„åŽä¸¤ä½æ•°å­—%U ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ï¼Œä»¥å‘¨æ—¥ä¸ºæ¯æ˜ŸæœŸç¬¬ä¸€å¤©%e æŒ‰æœˆè®¡çš„æ—¥æœŸï¼Œæ·»åŠ ç©ºæ ¼ï¼Œç­‰äºŽ%_d å®žä¾‹ æ ¼å¼åŒ–è¾“å‡º 12date +"%Y-%m-%d"2009-12-07 è¾“å‡ºæ˜¨å¤©æ—¥æœŸï¼š 12date -d "1 day ago" +"%Y-%m-%d"2012-11-19 2ç§’åŽè¾“å‡ºï¼š 12date -d "2 second" +"%Y-%m-%d %H:%M.%S"2012-11-20 14:21.31 ä¼ è¯´ä¸­çš„ 1234567890 ç§’ï¼š 12date -d "1970-01-01 1234567890 seconds" +"%Y-%m-%d %H:%m:%S"2009-02-13 23:02:30 æ™®é€šè½¬æ ¼å¼ï¼š 12date -d "2009-12-12" +"%Y/%m/%d %H:%M.%S"2009/12/12 00:00.00 apacheæ ¼å¼è½¬æ¢ï¼š 12date -d "Dec 5, 2009 12:00:37 AM" +"%Y-%m-%d %H:%M.%S"2009-12-05 00:00.37 æ ¼å¼è½¬æ¢åŽæ—¶é—´æ¸¸èµ°ï¼š 12date -d "Dec 5, 2009 12:00:37 AM 2 year ago" +"%Y-%m-%d %H:%M.%S"2007-12-05 00:00.37 åŠ å‡æ“ä½œï¼š 1234567date +%Y%m%d //æ˜¾ç¤ºå‰å¤©å¹´æœˆæ—¥date -d "+1 day" +%Y%m%d //æ˜¾ç¤ºå‰ä¸€å¤©çš„æ—¥æœŸdate -d "-1 day" +%Y%m%d //æ˜¾ç¤ºåŽä¸€å¤©çš„æ—¥æœŸdate -d "-1 month" +%Y%m%d //æ˜¾ç¤ºä¸Šä¸€æœˆçš„æ—¥æœŸdate -d "+1 month" +%Y%m%d //æ˜¾ç¤ºä¸‹ä¸€æœˆçš„æ—¥æœŸdate -d "-1 year" +%Y%m%d //æ˜¾ç¤ºå‰ä¸€å¹´çš„æ—¥æœŸdate -d "+1 year" +%Y%m%d //æ˜¾ç¤ºä¸‹ä¸€å¹´çš„æ—¥æœŸ è®¾å®šæ—¶é—´ï¼š 1234567date -s //è®¾ç½®å½“å‰æ—¶é—´ï¼Œåªæœ‰rootæƒé™æ‰èƒ½è®¾ç½®ï¼Œå…¶ä»–åªèƒ½æŸ¥çœ‹date -s 20120523 //è®¾ç½®æˆ20120523ï¼Œè¿™æ ·ä¼šæŠŠå…·ä½“æ—¶é—´è®¾ç½®æˆç©º00:00:00date -s 01:01:01 //è®¾ç½®å…·ä½“æ—¶é—´ï¼Œä¸ä¼šå¯¹æ—¥æœŸåšæ›´æ”¹date -s "01:01:01 2012-05-23" //è¿™æ ·å¯ä»¥è®¾ç½®å…¨éƒ¨æ—¶é—´date -s "01:01:01 20120523" //è¿™æ ·å¯ä»¥è®¾ç½®å…¨éƒ¨æ—¶é—´date -s "2012-05-23 01:01:01" //è¿™æ ·å¯ä»¥è®¾ç½®å…¨éƒ¨æ—¶é—´date -s "20120523 01:01:01" //è¿™æ ·å¯ä»¥è®¾ç½®å…¨éƒ¨æ—¶é—´ æœ‰æ—¶éœ€è¦æ£€æŸ¥ä¸€ç»„å‘½ä»¤èŠ±è´¹çš„æ—¶é—´ï¼Œä¸¾ä¾‹ï¼š 12345678#!/bin/bashstart=$(date +%s)nmap man.linuxde.net &amp;&gt; /dev/nullend=$(date +%s)difference=$(( end - start ))echo $difference seconds. è®¡ç®—æ´»äº†å¤šå°‘å¹´ 1echo $[($(date +%s -d $[date])-$(date +%s -d "19900318"))/86400/365] date -då…¶å®ƒçš„ä¸€äº›ç”¨æ³•. 123456789101112131415161718192021222324252627## èŽ·å–ä¸‹ä¸€å¤©çš„æ—¶é—´[root@hadoop ~]# date -d next-day '+%Y-%m-%d %H:%M:%S'[root@hadoop ~]# date -d 'next day' '+%Y-%m-%d %H:%M:%S'å¦å¤–ä¸€ç§å†™æ³•ï¼š[root@hadoop ~]# date '+%Y-%m-%d %H:%M:%S' -d tomorrow## èŽ·å–ä¸Šä¸€å¤©çš„æ—¶é—´ [root@hadoop ~]# date -d last-day '+%Y-%m-%d %H:%M:%S'å¦å¤–ä¸€ç§å†™æ³•ï¼š[root@hadoop ~]# date '+%Y-%m-%d %H:%M:%S' -d yesterday## èŽ·å–ä¸‹ä¸€æœˆçš„æ—¶é—´[root@hadoop ~]# date -d next-month '+%Y-%m-%d %H:%M:%S'## èŽ·å–ä¸Šä¸€æœˆçš„æ—¶é—´ [root@hadoop ~]# date -d last-month '+%Y-%m-%d %H:%M:%S'## èŽ·å–ä¸‹ä¸€å¹´çš„æ—¶é—´[root@hadoop ~]# date -d next-year '+%Y-%m-%d %H:%M:%S'## èŽ·å–ä¸Šä¸€å¹´çš„æ—¶é—´ [root@hadoop ~]# date -d last-year '+%Y-%m-%d %H:%M:%S'## èŽ·å–ä¸Šä¸€å‘¨çš„æ—¥æœŸæ—¶é—´ï¼š[root@hadoop ~]# date -d next-week '+%Y-%m-%d %H:%M:%S'[root@hadoop ~]# date -d next-monday '+%Y-%m-%d %H:%M:%S'[root@hadoop ~]# date -d next-thursday '+%Y-%m-%d %H:%M:%S' é‚£ä¹ˆç±»ä¼¼çš„ï¼Œå…¶å®žï¼Œlast-yearï¼Œlast-monthï¼Œlast-dayï¼Œlast-weekï¼Œlast-hourï¼Œlast-minuteï¼Œlast-secondéƒ½æœ‰å¯¹åº”çš„å®žçŽ°ã€‚ç›¸åçš„ï¼Œlastå¯¹åº”nextï¼Œè‡ªå·±å¯ä»¥æ ¹æ®å®žé™…æƒ…å†µçµæ´»ç»„ç»‡ æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹â€˜â€“dateâ€™ï¼Œå®ƒå¸®æˆ‘å®žçŽ°ä»»æ„æ—¶é—´å‰åŽçš„è®¡ç®—ï¼Œæ¥çœ‹å…·ä½“çš„ä¾‹å­ï¼š 1234567## èŽ·å–ä¸€å¤©ä»¥åŽçš„æ—¥æœŸæ—¶é—´[root@hadoop ~]# date '+%Y-%m-%d %H:%M:%S' --date='1 day'[root@hadoop ~]# date '+%Y-%m-%d %H:%M:%S' --date='-1 day ago'## èŽ·å–ä¸€å¤©ä»¥å‰çš„æ—¥æœŸæ—¶é—´[root@hadoop ~]# date '+%Y-%m-%d %H:%M:%S' --date='-1 day'[root@hadoop ~]# date '+%Y-%m-%d %H:%M:%S' --date='1 day ago' ä¸Šé¢çš„ä¾‹å­æ˜¾ç¤ºå‡ºæ¥äº†ä½¿ç”¨çš„æ ¼å¼ï¼Œä½¿ç”¨ç²¾é«“åœ¨äºŽæ”¹å˜å‰é¢çš„å­—ç¬¦ä¸²æ˜¾ç¤ºæ ¼å¼ï¼Œæ”¹å˜æ•°æ®ï¼Œæ”¹å˜è¦æ“ä½œçš„æ—¥æœŸå¯¹åº”å­—æ®µï¼Œé™¤äº†å¤©ä¹Ÿæœ‰å¯¹åº”çš„å…¶ä»–å®žçŽ°ï¼šyearï¼Œmonthï¼Œweekï¼Œdayï¼Œhourï¼Œminuteï¼Œsecondï¼Œmondayï¼ˆæ˜ŸæœŸï¼Œä¸ƒå¤©éƒ½å¯ï¼‰ date èƒ½ç”¨æ¥æ˜¾ç¤ºæˆ–è®¾å®šç³»ç»Ÿçš„æ—¥æœŸå’Œæ—¶é—´ï¼Œåœ¨æ˜¾ç¤ºæ–¹é¢ï¼Œä½¿ç”¨è€…èƒ½è®¾å®šæ¬²æ˜¾ç¤ºçš„æ ¼å¼ï¼Œæ ¼å¼è®¾å®šä¸ºä¸€ä¸ªåŠ å·åŽæŽ¥æ•°ä¸ªæ ‡è®°ï¼Œå…¶ä¸­å¯ç”¨çš„æ ‡è®°åˆ—è¡¨å¦‚ä¸‹ï¼š ä½¿ç”¨èŒƒä¾‹ï¼š 1[root@hadoop ~]# date '+%Y-%m-%d %H:%M:%S' æ—¥æœŸæ–¹é¢ 12345678910111213141516%a : æ˜ŸæœŸå‡  (Sun..Sat) %A : æ˜ŸæœŸå‡  (Sunday..Saturday) %b : æœˆä»½ (Jan..Dec) %B : æœˆä»½ (January..December) %c : ç›´æŽ¥æ˜¾ç¤ºæ—¥æœŸå’Œæ—¶é—´ %d : æ—¥ (01..31) %D : ç›´æŽ¥æ˜¾ç¤ºæ—¥æœŸ (mm/dd/yy) %h : åŒ %b %j : ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤© (001..366) %m : æœˆä»½ (01..12) %U : ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ (00..53) (ä»¥ Sunday ä¸ºä¸€å‘¨çš„ç¬¬ä¸€å¤©çš„æƒ…å½¢) %w : ä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤© (0..6) %W : ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ (00..53) (ä»¥ Monday ä¸ºä¸€å‘¨çš„ç¬¬ä¸€å¤©çš„æƒ…å½¢) %x : ç›´æŽ¥æ˜¾ç¤ºæ—¥æœŸ (mm/dd/yyyy) %y : å¹´ä»½çš„æœ€åŽä¸¤ä½æ•°å­— (00.99) %Y : å®Œæ•´å¹´ä»½ (0000..9999) æ—¶é—´æ–¹é¢ 123456789101112131415%%: æ‰“å°å‡º%%n : ä¸‹ä¸€è¡Œ%t : è·³æ ¼%H : å°æ—¶(00..23)%k : å°æ—¶(0..23)%l : å°æ—¶(1..12)%M : åˆ†é’Ÿ(00..59)%p : æ˜¾ç¤ºæœ¬åœ°AMæˆ–PM%P : æ˜¾ç¤ºæœ¬åœ°amæˆ–pm%r : ç›´æŽ¥æ˜¾ç¤ºæ—¶é—´(12 å°æ—¶åˆ¶ï¼Œæ ¼å¼ä¸º hh:mm:ss [AP]M)%s : ä»Ž 1970 å¹´ 1 æœˆ 1 æ—¥ 00:00:00 UTC åˆ°ç›®å‰ä¸ºæ­¢çš„ç§’æ•°%S : ç§’(00..61)%T : ç›´æŽ¥æ˜¾ç¤ºæ—¶é—´(24å°æ—¶åˆ¶)%X : ç›¸å½“äºŽ%H:%M:%S %p%Z : æ˜¾ç¤ºæ—¶åŒº è‹¥æ˜¯ä¸ä»¥åŠ å·ä½œä¸ºå¼€å¤´ï¼Œåˆ™è¡¨ç¤ºè¦è®¾å®šæ—¶é—´ï¼Œè€Œæ—¶é—´æ ¼å¼ä¸º MMDDhhmm[[CC]YY][.ss] 1234567MM ä¸ºæœˆä»½ï¼Œ DD ä¸ºæ—¥ï¼Œhh ä¸ºå°æ—¶ï¼Œmm ä¸ºåˆ†é’Ÿï¼ŒCC ä¸ºå¹´ä»½å‰ä¸¤ä½æ•°å­—ï¼ŒYY ä¸ºå¹´ä»½åŽä¸¤ä½æ•°å­—ï¼Œss ä¸ºç§’æ•° æœ‰ç”¨çš„å°æŠ€å·§12345678910111213141516171819202122## èŽ·å–ç›¸å¯¹æŸä¸ªæ—¥æœŸå‰åŽçš„æ—¥æœŸï¼šcts1 ~ # date -d 'may 14 -2 weeks'2018å¹´ 04æœˆ 30æ—¥ æ˜ŸæœŸä¸€ 00:00:00 CST## æŠŠæ—¶é—´å½“ä¸­æ— ç”¨çš„0åŽ»æŽ‰ï¼Œæ¯”å¦‚ï¼š01:02:25ä¼šå˜æˆ1:2:25cts1 ~ # date '+%-H:%-M:%-S'19:18:22## æ˜¾ç¤ºæ–‡ä»¶æœ€åŽè¢«æ›´æ”¹çš„æ—¶é—´cts1 ~ # date "+%Y-%m-%d %H:%M:%S" -r install.log2018-05-23 10:11:14## æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²æ—¥æœŸä¹‹é—´ç›¸éš”çš„å¤©æ•°[root@hadoop ~]# expr '(' $(date +%s -d "2016-08-08") - $(date +%s -d "2016-09-09") ')' / 86400expr `expr $(date +%s -d "2016-08-08") - $(date +%s -d "2016-09-09")` / 86400## shellä¸­åŠ å‡æŒ‡å®šé—´éš”å•ä½cts1 ~ # A=`date +%Y-%m-%d`cts1 ~ # B=`date +%Y-%m-%d -d "$A +48 hours"`cts1 ~ # echo $B2018-05-30 2. æ–‡æœ¬å¤„ç†wcåŠŸèƒ½ï¼š ç»Ÿè®¡æ–‡ä»¶è¡Œæ•°ã€å­—èŠ‚ã€å­—ç¬¦æ•° é€‰é¡¹1234567-c # ç»Ÿè®¡å­—èŠ‚æ•°ï¼Œæˆ–--bytesæˆ–â€”â€”charsï¼šåªæ˜¾ç¤ºBytesæ•°ï¼›ã€‚-l # ç»Ÿè®¡è¡Œæ•°ï¼Œæˆ–â€”â€”linesï¼šåªæ˜¾ç¤ºåˆ—æ•°ï¼›ã€‚-m # ç»Ÿè®¡å­—ç¬¦æ•°ã€‚è¿™ä¸ªæ ‡å¿—ä¸èƒ½ä¸Ž -c æ ‡å¿—ä¸€èµ·ä½¿ç”¨ã€‚-w # ç»Ÿè®¡å­—æ•°ï¼Œæˆ–â€”â€”wordsï¼šåªæ˜¾ç¤ºå­—æ•°ã€‚ä¸€ä¸ªå­—è¢«å®šä¹‰ä¸ºç”±ç©ºç™½ã€è·³æ ¼æˆ–æ¢è¡Œå­—ç¬¦åˆ†éš”çš„å­—ç¬¦ä¸²ã€‚-L # æ‰“å°æœ€é•¿è¡Œçš„é•¿åº¦ã€‚-help # æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯--version # æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ ä¾‹å­123456789101112131415161718192021222324wc -l * # ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶è¡Œæ•°wc -l *.js # ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ .js åŽç¼€çš„æ–‡ä»¶è¡Œæ•°find . * | xargs wc -l # å½“å‰ç›®å½•ä»¥åŠå­ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶è¡Œæ•° wc test.txt # æŸ¥çœ‹æ–‡ä»¶çš„å­—èŠ‚æ•°ã€å­—æ•°ã€è¡Œæ•°# æŸ¥çœ‹æ–‡ä»¶çš„å­—èŠ‚æ•°ã€å­—æ•°ã€è¡Œæ•°wc test.txt# è¾“å‡ºç»“æžœ7 8 70 test.txtè¡Œæ•° å•è¯æ•° å­—èŠ‚æ•° æ–‡ä»¶å# ç”¨wcå‘½ä»¤åªæ‰“å°ç»Ÿè®¡æ–‡ä»¶è¡Œæ•°ä¸æ‰“å°æ–‡ä»¶åwc -l test.txt # è¾“å‡ºç»“æžœ7 test.txt# ç”¨æ¥ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶æ•°ls -l | wc -l# è¾“å‡ºç»“æžœ8# ç»Ÿè®¡æ–‡ä»¶å­—æ•°ï¼šcts1 ~ # wc -w date.txt30 date.txt sortsortå‘½ä»¤ æ˜¯åœ¨Linuxé‡Œéžå¸¸æœ‰ç”¨ï¼Œå®ƒå°†æ–‡ä»¶è¿›è¡ŒæŽ’åºï¼Œå¹¶å°†æŽ’åºç»“æžœæ ‡å‡†è¾“å‡ºã€‚sortå‘½ä»¤æ—¢å¯ä»¥ä»Žç‰¹å®šçš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä»Žstdinä¸­èŽ·å–è¾“å…¥ã€‚ é€‰é¡¹123456789101112131415-bï¼šå¿½ç•¥æ¯è¡Œå‰é¢å¼€å§‹å‡ºçš„ç©ºæ ¼å­—ç¬¦ï¼›-cï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²ç»æŒ‰ç…§é¡ºåºæŽ’åºï¼›-dï¼šæŽ’åºæ—¶ï¼Œå¤„ç†è‹±æ–‡å­—æ¯ã€æ•°å­—åŠç©ºæ ¼å­—ç¬¦å¤–ï¼Œå¿½ç•¥å…¶ä»–çš„å­—ç¬¦ï¼›-fï¼šæŽ’åºæ—¶ï¼Œå°†å°å†™å­—æ¯è§†ä¸ºå¤§å†™å­—æ¯ï¼›-iï¼šæŽ’åºæ—¶ï¼Œé™¤äº†040è‡³176ä¹‹é—´çš„ASCIIå­—ç¬¦å¤–ï¼Œå¿½ç•¥å…¶ä»–çš„å­—ç¬¦ï¼›-mï¼šå°†å‡ ä¸ªæŽ’åºå·çš„æ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼›-Mï¼šå°†å‰é¢3ä¸ªå­—æ¯ä¾ç…§æœˆä»½çš„ç¼©å†™è¿›è¡ŒæŽ’åºï¼›-nï¼šä¾ç…§æ•°å€¼çš„å¤§å°æŽ’åºï¼›-o&lt;è¾“å‡ºæ–‡ä»¶&gt;ï¼šå°†æŽ’åºåŽçš„ç»“æžœå­˜å…¥åˆ¶å®šçš„æ–‡ä»¶ï¼›-rï¼šä»¥ç›¸åçš„é¡ºåºæ¥æŽ’åºï¼›-t&lt;åˆ†éš”å­—ç¬¦&gt;ï¼šæŒ‡å®šæŽ’åºæ—¶æ‰€ç”¨çš„æ ä½åˆ†éš”å­—ç¬¦ï¼›-gï¼šæŒ‰ç…§å¸¸è§„æ•°å€¼æŽ’åº-kï¼šä½ç½®1,ä½ç½®2æ ¹æ®å…³é”®å­—æŽ’åºï¼Œåœ¨ä»Žç¬¬ä½ç½®1å¼€å§‹ï¼Œä½ç½®2ç»“æŸ+&lt;èµ·å§‹æ ä½&gt;-&lt;ç»“æŸæ ä½&gt;ï¼šä»¥æŒ‡å®šçš„æ ä½æ¥æŽ’åºï¼ŒèŒƒå›´ç”±èµ·å§‹æ ä½åˆ°ç»“æŸæ ä½çš„å‰ä¸€æ ä½ã€‚ å®žä¾‹ sortå°†æ–‡ä»¶/æ–‡æœ¬çš„æ¯ä¸€è¡Œä½œä¸ºä¸€ä¸ªå•ä½ï¼Œç›¸äº’æ¯”è¾ƒï¼Œæ¯”è¾ƒåŽŸåˆ™æ˜¯ä»Žé¦–å­—ç¬¦å‘åŽï¼Œä¾æ¬¡æŒ‰ASCIIç å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæœ€åŽå°†ä»–ä»¬æŒ‰å‡åºè¾“å‡ºã€‚ 123456789101112131415root@[mail text]# cat sort.txtaaa:10:1.1ccc:30:3.3ddd:40:4.4bbb:20:2.2eee:50:5.5eee:50:5.5[root@mail text]# sort sort.txtaaa:10:1.1bbb:20:2.2ccc:30:3.3ddd:40:4.4eee:50:5.5eee:50:5.5 å¿½ç•¥ç›¸åŒè¡Œä½¿ç”¨-ué€‰é¡¹æˆ–è€…uniqï¼š 1234567891011121314151617181920212223[root@mail text]# cat sort.txtaaa:10:1.1ccc:30:3.3ddd:40:4.4bbb:20:2.2eee:50:5.5eee:50:5.5[root@mail text]# sort -u sort.txtaaa:10:1.1bbb:20:2.2ccc:30:3.3ddd:40:4.4eee:50:5.5æˆ–è€…[root@mail text]# uniq sort.txtaaa:10:1.1ccc:30:3.3ddd:40:4.4bbb:20:2.2eee:50:5.5 sortçš„-nã€-rã€-kã€-té€‰é¡¹çš„ä½¿ç”¨ï¼š 123456789101112131415161718192021222324252627282930313233[root@mail text]# cat sort.txtAAA:BB:CCaaa:30:1.6ccc:50:3.3ddd:20:4.2bbb:10:2.5eee:40:5.4eee:60:5.1#å°†BBåˆ—æŒ‰ç…§æ•°å­—ä»Žå°åˆ°å¤§é¡ºåºæŽ’åˆ—ï¼š[root@mail text]# sort -nk 2 -t: sort.txtAAA:BB:CCbbb:10:2.5ddd:20:4.2aaa:30:1.6eee:40:5.4ccc:50:3.3eee:60:5.1#å°†CCåˆ—æ•°å­—ä»Žå¤§åˆ°å°é¡ºåºæŽ’åˆ—ï¼š[root@mail text]# sort -nrk 3 -t: sort.txteee:40:5.4eee:60:5.1ddd:20:4.2ccc:50:3.3bbb:10:2.5aaa:30:1.6AAA:BB:CC# -næ˜¯æŒ‰ç…§æ•°å­—å¤§å°æŽ’åºï¼Œ-ræ˜¯ä»¥ç›¸åé¡ºåºï¼Œ-kæ˜¯æŒ‡å®šéœ€è¦æŽ’åºçš„æ ä½ï¼Œ-tæŒ‡å®šæ ä½åˆ†éš”ç¬¦ä¸ºå†’å·# å¤šåˆ—æŽ’åºï¼šä»¥:åˆ†éš”ï¼ŒæŒ‰ç¬¬äºŒåˆ—æ•°å€¼æŽ’å€’åºï¼Œç¬¬ä¸‰åˆ—æ­£åº[linux@linux ~]$ sort -n -t: -k2,2r -k3 sort.txt -ké€‰é¡¹çš„å…·ä½“è¯­æ³•æ ¼å¼ï¼š x,x è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ 123FStart.CStart Modifie,FEnd.CEnd Modifier-------Start--------,-------End-------- FStart.CStart é€‰é¡¹ , FEnd.CEnd é€‰é¡¹ è¿™ä¸ªè¯­æ³•æ ¼å¼å¯ä»¥è¢«å…¶ä¸­çš„é€—å·,åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼Œ Start éƒ¨åˆ†å’Œ End éƒ¨åˆ†ã€‚Startéƒ¨åˆ†ä¹Ÿç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­çš„Modifieréƒ¨åˆ†å°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´è¿‡çš„ç±»ä¼¼nå’Œrçš„é€‰é¡¹éƒ¨åˆ†ã€‚æˆ‘ä»¬é‡ç‚¹è¯´è¯´Startéƒ¨åˆ†çš„FStartå’ŒC.Startã€‚C.Startä¹Ÿæ˜¯å¯ä»¥çœç•¥çš„ï¼Œçœç•¥çš„è¯å°±è¡¨ç¤ºä»Žæœ¬åŸŸçš„å¼€å¤´éƒ¨åˆ†å¼€å§‹ã€‚FStart.CStartï¼Œå…¶ä¸­FStartå°±æ˜¯è¡¨ç¤ºä½¿ç”¨çš„åŸŸï¼Œè€ŒCStartåˆ™è¡¨ç¤ºåœ¨FStartåŸŸä¸­ä»Žç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ç®—â€œæŽ’åºé¦–å­—ç¬¦â€ã€‚åŒç†ï¼Œåœ¨Endéƒ¨åˆ†ä¸­ï¼Œä½ å¯ä»¥è®¾å®šFEnd.CEndï¼Œå¦‚æžœä½ çœç•¥.CEndï¼Œåˆ™è¡¨ç¤ºç»“å°¾åˆ°â€œåŸŸå°¾â€ï¼Œå³æœ¬åŸŸçš„æœ€åŽä¸€ä¸ªå­—ç¬¦ã€‚æˆ–è€…ï¼Œå¦‚æžœä½ å°†CEndè®¾å®šä¸º0(é›¶)ï¼Œä¹Ÿæ˜¯è¡¨ç¤ºç»“å°¾åˆ°â€œåŸŸå°¾â€ã€‚ ä»Žå…¬å¸è‹±æ–‡åç§°çš„ç¬¬äºŒä¸ªå­—æ¯å¼€å§‹è¿›è¡ŒæŽ’åºï¼š 1234567# å…ˆåˆ›å»ºæ­¤txtæ–‡ä»¶# å†æŽ’åº$ sort -t ' ' -k 1.2 facebook.txtbaidu 100 5000sohu 100 4500google 110 5000guge 50 3000 -t &#39; &#39;, é¦–å…ˆç”¨&#39; &#39;ç©ºæ ¼, æŠŠå­—æ®µåˆ†å‰²æˆäº†3ä¸ªåŸŸ. ä½¿ç”¨äº†-k 1.2ï¼Œè¡¨ç¤ºå¯¹ç¬¬ä¸€ä¸ªåŸŸçš„ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹åˆ°æœ¬åŸŸçš„æœ€åŽä¸€ä¸ªå­—ç¬¦ä¸ºæ­¢çš„å­—ç¬¦ä¸²è¿›è¡ŒæŽ’åºã€‚ä½ ä¼šå‘çŽ°baiduå› ä¸ºç¬¬äºŒä¸ªå­—æ¯æ˜¯aè€Œååˆ—æ¦œé¦–ã€‚sohuå’Œ googleç¬¬äºŒä¸ªå­—ç¬¦éƒ½æ˜¯oï¼Œä½†sohuçš„håœ¨googleçš„oå‰é¢ï¼Œæ‰€ä»¥ä¸¤è€…åˆ†åˆ«æŽ’åœ¨ç¬¬äºŒå’Œç¬¬ä¸‰ã€‚gugeåªèƒ½å±ˆå±…ç¬¬å››äº†ã€‚ åªé’ˆå¯¹å…¬å¸è‹±æ–‡åç§°çš„ç¬¬äºŒä¸ªå­—æ¯è¿›è¡ŒæŽ’åºï¼Œå¦‚æžœç›¸åŒçš„æŒ‰ç…§å‘˜å·¥å·¥èµ„è¿›è¡Œé™åºæŽ’åºï¼š 12345$ sort -t ' ' -k 1.2,1.2 -nrk 3,3 facebook.txtbaidu 100 5000google 110 5000sohu 100 4500guge 50 3000 ç”±äºŽåªå¯¹ç¬¬äºŒä¸ªå­—æ¯è¿›è¡ŒæŽ’åºï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨äº†-k 1.2,1.2çš„è¡¨ç¤ºæ–¹å¼ï¼Œè¡¨ç¤ºæˆ‘ä»¬â€œåªâ€å¯¹ç¬¬äºŒä¸ªå­—æ¯è¿›è¡ŒæŽ’åºã€‚ï¼ˆå¦‚æžœä½ é—®â€œæˆ‘ä½¿ç”¨-k 1.2æ€Žä¹ˆä¸è¡Œï¼Ÿâ€ï¼Œå½“ç„¶ä¸è¡Œï¼Œå› ä¸ºä½ çœç•¥äº†Endéƒ¨åˆ†ï¼Œè¿™å°±æ„å‘³ç€ä½ å°†å¯¹ä»Žç¬¬äºŒä¸ªå­—æ¯èµ·åˆ°æœ¬åŸŸæœ€åŽä¸€ä¸ªå­—ç¬¦ä¸ºæ­¢çš„å­—ç¬¦ä¸²è¿›è¡ŒæŽ’åºï¼‰ã€‚å¯¹äºŽå‘˜å·¥å·¥èµ„è¿›è¡ŒæŽ’ åºï¼Œæˆ‘ä»¬ä¹Ÿä½¿ç”¨äº†-k 3,3ï¼Œè¿™æ˜¯æœ€å‡†ç¡®çš„è¡¨è¿°ï¼Œè¡¨ç¤ºæˆ‘ä»¬â€œåªâ€å¯¹æœ¬åŸŸè¿›è¡ŒæŽ’åºï¼Œå› ä¸ºå¦‚æžœä½ çœç•¥äº†åŽé¢çš„3ï¼Œå°±å˜æˆäº†æˆ‘ä»¬â€œå¯¹ç¬¬3ä¸ªåŸŸå¼€å§‹åˆ°æœ€åŽä¸€ä¸ªåŸŸä½ç½®çš„å†…å®¹è¿›è¡ŒæŽ’åºâ€ äº†ã€‚ uniquniqå‘½ä»¤ ç”¨äºŽæŠ¥å‘Šæˆ–å¿½ç•¥æ–‡ä»¶ä¸­çš„é‡å¤è¡Œï¼Œä¸€èˆ¬ä¸Žsortå‘½ä»¤ç»“åˆä½¿ç”¨ã€‚ é€‰é¡¹123456-cæˆ–â€”â€”countï¼šåœ¨æ¯åˆ—æ—è¾¹æ˜¾ç¤ºè¯¥è¡Œé‡å¤å‡ºçŽ°çš„æ¬¡æ•°ï¼›-dæˆ–--repeatedï¼šä»…æ˜¾ç¤ºé‡å¤å‡ºçŽ°çš„è¡Œåˆ—ï¼›-f&lt;æ ä½&gt;æˆ–--skip-fields=&lt;æ ä½&gt;ï¼šå¿½ç•¥æ¯”è¾ƒæŒ‡å®šçš„æ ä½ï¼›-s&lt;å­—ç¬¦ä½ç½®&gt;æˆ–--skip-chars=&lt;å­—ç¬¦ä½ç½®&gt;ï¼šå¿½ç•¥æ¯”è¾ƒæŒ‡å®šçš„å­—ç¬¦ï¼›-uæˆ–â€”â€”uniqueï¼šä»…æ˜¾ç¤ºå‡ºä¸€æ¬¡çš„è¡Œåˆ—ï¼›-w&lt;å­—ç¬¦ä½ç½®&gt;æˆ–--check-chars=&lt;å­—ç¬¦ä½ç½®&gt;ï¼šæŒ‡å®šè¦æ¯”è¾ƒçš„å­—ç¬¦ã€‚ å‚æ•° è¾“å…¥æ–‡ä»¶ï¼šæŒ‡å®šè¦åŽ»é™¤çš„é‡å¤è¡Œæ–‡ä»¶ã€‚å¦‚æžœä¸æŒ‡å®šæ­¤é¡¹ï¼Œåˆ™ä»Žæ ‡å‡†è¯»å–æ•°æ®ï¼› è¾“å‡ºæ–‡ä»¶ï¼šæŒ‡å®šè¦åŽ»é™¤é‡å¤è¡ŒåŽçš„å†…å®¹è¦å†™å…¥çš„è¾“å‡ºæ–‡ä»¶ã€‚å¦‚æžœä¸æŒ‡å®šæ­¤é€‰é¡¹ï¼Œåˆ™å°†å†…å®¹æ˜¾ç¤ºåˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ï¼ˆæ˜¾ç¤ºç»ˆç«¯ï¼‰ã€‚ å®žä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758[root]# cat sort.txt : åŽŸæœ¬è¡Œaaa:10:1.1ccc:30:3.3ddd:40:4.4bbb:20:2.2eee:50:5.5eee:50:5.5[root]# uniq sort.txt : ä¸å±•ç¤ºé‡å¤è¡Œaaa:10:1.1ccc:30:3.3ddd:40:4.4bbb:20:2.2eee:50:5.5[cts1:Desktop][cts1:Desktop][root]# sort sort.txt | uniq : ä¸å±•ç¤ºé‡å¤è¡Œaaa:10:1.1bbb:20:2.2ccc:30:3.3ddd:40:4.4eee:50:5.5[cts1:Desktop][root]# uniq -u sort.txt : åˆ é™¤é‡å¤è¡Œaaa:10:1.1ccc:30:3.3ddd:40:4.4bbb:20:2.2[cts1:Desktop][root]# sort sort.txt | uniq -u : æŽ’åºå¹¶åˆ é™¤é‡å¤è¡Œaaa:10:1.1bbb:20:2.2ccc:30:3.3ddd:40:4.4[cts1:Desktop][root]# sort sort.txt | uniq -c : å±•ç¤ºæ¯è¡Œå‡ºçŽ°çš„æ¬¡æ•° 1 aaa:10:1.1 1 bbb:20:2.2 1 ccc:30:3.3 1 ddd:40:4.4 2 eee:50:5.5[cts1:Desktop][root]# sort sort.txt | uniq -d : åªå±•ç¤ºé‡å¤è¡Œeee:50:5.5# æ±‚a.txtå’Œb.txtçš„å·®é›† ## é¦–å…ˆa b åŽ»æŽ‰é‡å¤çš„, å†è·Ÿa båŽ»é‡, æŠŠbå…¶å®ƒçš„éƒ¨åˆ†ä¹ŸåŽ»æŽ‰cts1 Desktop # cat a b b | sort | uniq -uab# æ±‚b.txtå’Œa.txtçš„å·®é›† ## åŒä¸Šcts1 Desktop # cat b a a | sort | uniq -uef cutcutå‘½ä»¤ ç”¨æ¥æ˜¾ç¤ºè¡Œä¸­çš„æŒ‡å®šéƒ¨åˆ†ï¼Œåˆ é™¤æ–‡ä»¶ä¸­æŒ‡å®šå­—æ®µã€‚cutç»å¸¸ç”¨æ¥æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ï¼Œç±»ä¼¼äºŽä¸‹çš„typeå‘½ä»¤ã€‚ è¯´æ˜Žï¼šè¯¥å‘½ä»¤æœ‰ä¸¤é¡¹åŠŸèƒ½ï¼Œå…¶ä¸€æ˜¯ç”¨æ¥æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ï¼Œå®ƒä¾æ¬¡è¯»å–ç”±å‚æ•°fileæ‰€æŒ‡ æ˜Žçš„æ–‡ä»¶ï¼Œå°†å®ƒä»¬çš„å†…å®¹è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸Šï¼›å…¶äºŒæ˜¯è¿žæŽ¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œå¦‚cut fl f2 &gt; f3å°†æŠŠæ–‡ä»¶flå’Œå‡ çš„å†…å®¹åˆå¹¶èµ·æ¥ï¼Œç„¶åŽé€šè¿‡è¾“å‡ºé‡å®šå‘ç¬¦â€œ&gt;â€çš„ä½œç”¨ï¼Œå°†å®ƒä»¬æ”¾å…¥æ–‡ä»¶f3ä¸­ã€‚ å½“æ–‡ä»¶è¾ƒå¤§æ—¶ï¼Œæ–‡æœ¬åœ¨å±å¹•ä¸Šè¿…é€Ÿé—ªè¿‡ï¼ˆæ»šå±ï¼‰ï¼Œç”¨æˆ·å¾€å¾€çœ‹ä¸æ¸…æ‰€æ˜¾ç¤ºçš„å†…å®¹ã€‚å› æ­¤ï¼Œä¸€èˆ¬ç”¨moreç­‰å‘½ä»¤åˆ†å±æ˜¾ç¤ºã€‚ä¸ºäº†æŽ§åˆ¶æ»šå±ï¼Œå¯ä»¥æŒ‰Ctrl+Sé”®ï¼Œåœæ­¢æ»šå±ï¼›æŒ‰Ctrl+Qé”®å¯ä»¥æ¢å¤æ»šå±ã€‚æŒ‰Ctrl+Cï¼ˆä¸­æ–­ï¼‰é”®å¯ä»¥ç»ˆæ­¢è¯¥å‘½ä»¤çš„æ‰§è¡Œï¼Œå¹¶ä¸”è¿”å›žShellæç¤ºç¬¦çŠ¶æ€ã€‚ é€‰é¡¹123456789-bï¼šä»…æ˜¾ç¤ºè¡Œä¸­æŒ‡å®šç›´æŽ¥èŒƒå›´çš„å†…å®¹ï¼›-cï¼šä»…æ˜¾ç¤ºè¡Œä¸­æŒ‡å®šèŒƒå›´çš„å­—ç¬¦ï¼› -dï¼šæŒ‡å®šå­—æ®µçš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤çš„å­—æ®µåˆ†éš”ç¬¦ä¸ºâ€œTABâ€ï¼› -fï¼šæ˜¾ç¤ºæŒ‡å®šå­—æ®µçš„å†…å®¹ï¼›-nï¼šä¸Žâ€œ-bâ€é€‰é¡¹è¿žç”¨ï¼Œä¸åˆ†å‰²å¤šå­—èŠ‚å­—ç¬¦ï¼›--complementï¼šè¡¥è¶³è¢«é€‰æ‹©çš„å­—èŠ‚ã€å­—ç¬¦æˆ–å­—æ®µï¼›--out-delimiter=&lt;å­—æ®µåˆ†éš”ç¬¦&gt;ï¼šæŒ‡å®šè¾“å‡ºå†…å®¹æ˜¯çš„å­—æ®µåˆ†å‰²ç¬¦ï¼›--helpï¼šæ˜¾ç¤ºæŒ‡ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼›--versionï¼šæ˜¾ç¤ºæŒ‡ä»¤çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚ å‚æ•°æ–‡ä»¶ï¼šæŒ‡å®šè¦è¿›è¡Œå†…å®¹è¿‡æ»¤çš„æ–‡ä»¶ã€‚ å®žä¾‹ä¾‹å¦‚æœ‰ä¸€ä¸ªå­¦ç”ŸæŠ¥è¡¨ä¿¡æ¯ï¼ŒåŒ…å«Noã€Nameã€Markã€Percentï¼š 12345[root@localhost text]# cat cut.txt No Name Mark Percent01 tom 69 9102 jack 71 8703 alex 68 98 -fä½¿ç”¨-f é€‰é¡¹æå–æŒ‡å®šå­—æ®µ 12345[root@localhost text]# cut -d ' ' -f1 cut.txt No010203 12345[root@localhost text]# cut -d ' ' -f2,3 test.txt Name Marktom 69jack 71alex 68 â€“complementé€‰é¡¹æå–æŒ‡å®šå­—æ®µä¹‹å¤–çš„åˆ—ï¼ˆæ‰“å°é™¤äº†ç¬¬äºŒåˆ—ä¹‹å¤–çš„åˆ—ï¼‰ï¼š 12345cut -d ' ' -f2 --complement cut.txtNo Mark Percent01 69 9102 71 8703 68 98 æŒ‡å®šå­—æ®µçš„å­—ç¬¦æˆ–è€…å­—èŠ‚èŒƒå›´ &amp; ä¾‹å­cutå‘½ä»¤å¯ä»¥å°†ä¸€ä¸²å­—ç¬¦ä½œä¸ºåˆ—æ¥æ˜¾ç¤ºï¼Œå­—ç¬¦å­—æ®µçš„è®°æ³•ï¼š N- ï¼šä»Žç¬¬Nä¸ªå­—èŠ‚ã€å­—ç¬¦ã€å­—æ®µåˆ°ç»“å°¾ï¼› N-M ï¼šä»Žç¬¬Nä¸ªå­—èŠ‚ã€å­—ç¬¦ã€å­—æ®µåˆ°ç¬¬Mä¸ªï¼ˆåŒ…æ‹¬Måœ¨å†…ï¼‰å­—èŠ‚ã€å­—ç¬¦ã€å­—æ®µï¼› -M ï¼šä»Žç¬¬1ä¸ªå­—èŠ‚ã€å­—ç¬¦ã€å­—æ®µåˆ°ç¬¬Mä¸ªï¼ˆåŒ…æ‹¬Måœ¨å†…ï¼‰å­—èŠ‚ã€å­—ç¬¦ã€å­—æ®µã€‚ ä¸Šé¢æ˜¯è®°æ³•ï¼Œç»“åˆä¸‹é¢é€‰é¡¹å°†æ‘¸ä¸ªèŒƒå›´çš„å­—èŠ‚ã€å­—ç¬¦æŒ‡å®šä¸ºå­—æ®µï¼š -b è¡¨ç¤ºå­—èŠ‚ï¼› -c è¡¨ç¤ºå­—ç¬¦ï¼› -f è¡¨ç¤ºå®šä¹‰å­—æ®µã€‚ å®žä¾‹123456789101112131415161718192021222324252627282930[root@localhost text]# cat test.txt abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz# æ‰“å°ç¬¬1ä¸ªåˆ°ç¬¬3ä¸ªå­—ç¬¦ï¼šcut -c1-3 test.txt abcabcabcabcabc# æ‰“å°å‰2ä¸ªå­—ç¬¦ï¼šcut -c-2 test.txt ababababab# æ‰“å°ä»Žç¬¬5ä¸ªå­—ç¬¦å¼€å§‹åˆ°ç»“å°¾ï¼šcut -c5- test.txt efghijklmnopqrstuvwxyzefghijklmnopqrstuvwxyzefghijklmnopqrstuvwxyzefghijklmnopqrstuvwxyzefghijklmnopqrstuvwxyz grep(æ–‡æœ¬ç”Ÿæˆå™¨)grep ï¼ˆglobal search regular expression(RE) and print out the lineï¼Œå…¨é¢æœç´¢æ­£åˆ™è¡¨è¾¾å¼å¹¶æŠŠè¡Œæ‰“å°å‡ºæ¥ï¼‰æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ï¼Œå®ƒèƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢æ–‡æœ¬ï¼Œå¹¶æŠŠåŒ¹é…çš„è¡Œæ‰“å°å‡ºæ¥ã€‚ç”¨äºŽè¿‡æ»¤/æœç´¢çš„ç‰¹å®šå­—ç¬¦ã€‚å¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼èƒ½å¤šç§å‘½ä»¤é…åˆä½¿ç”¨ï¼Œä½¿ç”¨ä¸Šååˆ†çµæ´»ã€‚ é€‰é¡¹123456789101112131415161718192021222324252627-a --text # ä¸è¦å¿½ç•¥äºŒè¿›åˆ¶æ•°æ®ã€‚-A &lt;æ˜¾ç¤ºè¡Œæ•°&gt; --after-context=&lt;æ˜¾ç¤ºè¡Œæ•°&gt; # é™¤äº†æ˜¾ç¤ºç¬¦åˆèŒƒæœ¬æ ·å¼çš„é‚£ä¸€è¡Œä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹åŽçš„å†…å®¹ã€‚-b --byte-offset # åœ¨æ˜¾ç¤ºç¬¦åˆèŒƒæœ¬æ ·å¼çš„é‚£ä¸€è¡Œä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹å‰çš„å†…å®¹ã€‚-B&lt;æ˜¾ç¤ºè¡Œæ•°&gt; --before-context=&lt;æ˜¾ç¤ºè¡Œæ•°&gt; # é™¤äº†æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹å‰çš„å†…å®¹ã€‚-c --count # è®¡ç®—ç¬¦åˆèŒƒæœ¬æ ·å¼çš„åˆ—æ•°ã€‚-C&lt;æ˜¾ç¤ºè¡Œæ•°&gt; --context=&lt;æ˜¾ç¤ºè¡Œæ•°&gt;æˆ–-&lt;æ˜¾ç¤ºè¡Œæ•°&gt; # é™¤äº†æ˜¾ç¤ºç¬¦åˆèŒƒæœ¬æ ·å¼çš„é‚£ä¸€åˆ—ä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥åˆ—ä¹‹å‰åŽçš„å†…å®¹ã€‚-d&lt;è¿›è¡ŒåŠ¨ä½œ&gt; --directories=&lt;åŠ¨ä½œ&gt; # å½“æŒ‡å®šè¦æŸ¥æ‰¾çš„æ˜¯ç›®å½•è€Œéžæ–‡ä»¶æ—¶ï¼Œå¿…é¡»ä½¿ç”¨è¿™é¡¹å‚æ•°ï¼Œå¦åˆ™grepå‘½ä»¤å°†å›žæŠ¥ä¿¡æ¯å¹¶åœæ­¢åŠ¨ä½œã€‚-e&lt;èŒƒæœ¬æ ·å¼&gt; --regexp=&lt;èŒƒæœ¬æ ·å¼&gt; # æŒ‡å®šå­—ç¬¦ä¸²ä½œä¸ºæŸ¥æ‰¾æ–‡ä»¶å†…å®¹çš„èŒƒæœ¬æ ·å¼ã€‚-E --extended-regexp # å°†èŒƒæœ¬æ ·å¼ä¸ºå»¶ä¼¸çš„æ™®é€šè¡¨ç¤ºæ³•æ¥ä½¿ç”¨ï¼Œæ„å‘³ç€ä½¿ç”¨èƒ½ä½¿ç”¨æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ã€‚-f&lt;èŒƒæœ¬æ–‡ä»¶&gt; --file=&lt;è§„åˆ™æ–‡ä»¶&gt; # æŒ‡å®šèŒƒæœ¬æ–‡ä»¶ï¼Œå…¶å†…å®¹æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªèŒƒæœ¬æ ·å¼ï¼Œè®©grepæŸ¥æ‰¾ç¬¦åˆèŒƒæœ¬æ¡ä»¶çš„æ–‡ä»¶å†…å®¹ï¼Œæ ¼å¼ä¸ºæ¯ä¸€åˆ—çš„èŒƒæœ¬æ ·å¼ã€‚-F --fixed-regexp # å°†èŒƒæœ¬æ ·å¼è§†ä¸ºå›ºå®šå­—ç¬¦ä¸²çš„åˆ—è¡¨ã€‚-G --basic-regexp # å°†èŒƒæœ¬æ ·å¼è§†ä¸ºæ™®é€šçš„è¡¨ç¤ºæ³•æ¥ä½¿ç”¨ã€‚-h --no-filename # åœ¨æ˜¾ç¤ºç¬¦åˆèŒƒæœ¬æ ·å¼çš„é‚£ä¸€åˆ—ä¹‹å‰ï¼Œä¸æ ‡ç¤ºè¯¥åˆ—æ‰€å±žçš„æ–‡ä»¶åç§°ã€‚-H --with-filename # åœ¨æ˜¾ç¤ºç¬¦åˆèŒƒæœ¬æ ·å¼çš„é‚£ä¸€åˆ—ä¹‹å‰ï¼Œæ ‡ç¤ºè¯¥åˆ—çš„æ–‡ä»¶åç§°ã€‚-i --ignore-case # å¿½ç•¥å­—ç¬¦å¤§å°å†™çš„å·®åˆ«ã€‚-l --file-with-matches # åˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„èŒƒæœ¬æ ·å¼çš„æ–‡ä»¶åç§°ã€‚-L --files-without-match # åˆ—å‡ºæ–‡ä»¶å†…å®¹ä¸ç¬¦åˆæŒ‡å®šçš„èŒƒæœ¬æ ·å¼çš„æ–‡ä»¶åç§°ã€‚-n --line-number # åœ¨æ˜¾ç¤ºç¬¦åˆèŒƒæœ¬æ ·å¼çš„é‚£ä¸€åˆ—ä¹‹å‰ï¼Œæ ‡ç¤ºå‡ºè¯¥åˆ—çš„ç¼–å·ã€‚-q --quietæˆ–--silent # ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚-R/-r --recursive # æ­¤å‚æ•°çš„æ•ˆæžœå’ŒæŒ‡å®šâ€œ-d recurseâ€å‚æ•°ç›¸åŒã€‚-s --no-messages # ä¸æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚-v --revert-match # åè½¬æŸ¥æ‰¾ã€‚-V --version # æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚ -w --word-regexp # åªæ˜¾ç¤ºå…¨å­—ç¬¦åˆçš„åˆ—ã€‚-x --line-regexp # åªæ˜¾ç¤ºå…¨åˆ—ç¬¦åˆçš„åˆ—ã€‚-y # æ­¤å‚æ•°æ•ˆæžœè·Ÿâ€œ-iâ€ç›¸åŒã€‚-o # åªè¾“å‡ºæ–‡ä»¶ä¸­åŒ¹é…åˆ°çš„éƒ¨åˆ†ã€‚ grepä¸­çš„æ­£åˆ™è¡¨è¾¾å¼12345678910111213141516171819202122232425&lt;sup&gt; # é”šå®šè¡Œçš„å¼€å§‹ å¦‚ï¼š'&lt;/sup&gt;grep'åŒ¹é…æ‰€æœ‰ä»¥grepå¼€å¤´çš„è¡Œã€‚ $ # é”šå®šè¡Œçš„ç»“æŸ å¦‚ï¼š'grep$'åŒ¹é…æ‰€æœ‰ä»¥grepç»“å°¾çš„è¡Œã€‚ . # åŒ¹é…ä¸€ä¸ªéžæ¢è¡Œç¬¦çš„å­—ç¬¦ å¦‚ï¼š'gr.p'åŒ¹é…gråŽæŽ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œç„¶åŽæ˜¯pã€‚ * # åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå…ˆå‰å­—ç¬¦ å¦‚ï¼š'*grep'åŒ¹é…æ‰€æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åŽç´§è·Ÿgrepçš„è¡Œã€‚ .* # ä¸€èµ·ç”¨ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚ [] # åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚'[Gg]rep'åŒ¹é…Grepå’Œgrepã€‚ [&lt;sup&gt;] # åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š'[&lt;/sup&gt;A-FH-Z]rep'åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿrepçš„è¡Œã€‚ \ # è½¬ä¹‰\(..\) # æ ‡è®°åŒ¹é…å­—ç¬¦ï¼Œå¦‚'\(love\)'ï¼Œloveè¢«æ ‡è®°ä¸º1ã€‚ \&lt; # é”šå®šå•è¯çš„å¼€å§‹ï¼Œå¦‚:'\&lt;grep'åŒ¹é…åŒ…å«ä»¥grepå¼€å¤´çš„å•è¯çš„è¡Œã€‚ \&gt; # é”šå®šå•è¯çš„ç»“æŸï¼Œå¦‚'grep\&gt;'åŒ¹é…åŒ…å«ä»¥grepç»“å°¾çš„å•è¯çš„è¡Œã€‚ x\&#123;m\&#125; # é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š'o\&#123;5\&#125;'åŒ¹é…åŒ…å«5ä¸ªoçš„è¡Œã€‚ x\&#123;m,\&#125; # é‡å¤å­—ç¬¦x,è‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š'o\&#123;5,\&#125;'åŒ¹é…è‡³å°‘æœ‰5ä¸ªoçš„è¡Œã€‚ x\&#123;m,n\&#125; # é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºŽnæ¬¡ï¼Œå¦‚ï¼š'o\&#123;5,10\&#125;'åŒ¹é…5--10ä¸ªoçš„è¡Œã€‚ \w # åŒ¹é…æ–‡å­—å’Œæ•°å­—å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯[A-Za-z0-9]ï¼Œå¦‚ï¼š'G\w*p'åŒ¹é…ä»¥GåŽè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªæ–‡å­—æˆ–æ•°å­—å­—ç¬¦ï¼Œç„¶åŽæ˜¯pã€‚ \W # \wçš„åç½®å½¢å¼ï¼ŒåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéžå•è¯å­—ç¬¦ï¼Œå¦‚ç‚¹å·å¥å·ç­‰ã€‚ \b # å•è¯é”å®šç¬¦ï¼Œå¦‚: '\bgrep\b'åªåŒ¹é…grepã€‚å¢žå½•. # ä»»æ„ä¸€ä¸ªå­—ç¬¦a* # ä»»æ„å¤šä¸ªa(0ä¸ªæˆ–å¤šä¸ª)a? # 0ä¸ªæˆ–1ä¸ªaa+ # ä¸€ä¸ªæˆ–å¤šä¸ªa[A-Z][ABC] grepå‘½ä»¤å¸¸è§ç”¨æ³• åœ¨æ–‡ä»¶ä¸­æœç´¢ä¸€ä¸ªå•è¯ï¼Œå‘½ä»¤ä¼šè¿”å›žä¸€ä¸ªåŒ…å« â€œmatch_patternâ€ çš„æ–‡æœ¬è¡Œï¼š 12grep match_pattern file_namegrep "match_pattern" file_name åœ¨å¤šä¸ªæ–‡ä»¶ä¸­æŸ¥æ‰¾ 1grep "match_pattern" file_1 file_2 file_3 ... è¾“å‡ºé™¤ â€œmatch_patternâ€ ä¹‹å¤–çš„æ‰€æœ‰è¡Œ &gt;&gt; -v é€‰é¡¹ï¼š 1grep -v "match_pattern" file_name æ ‡è®°åŒ¹é…é¢œè‰² â€“color=auto é€‰é¡¹ï¼š 12345678910grep "match_pattern" file_name --color=autoeg: æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ä¸­çš„ `a`cts1 Desktop # grep "\(a\)" ./* --color=auto---./a:a./abc.txt:abcdefghijklmnopqrstuvwxyz./abc.txt:abcdefghijklmnopqrstuvwxyz./abc.txt:abcdefghijklmnopqrstuvwxyz... ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ -E é€‰é¡¹ï¼š123grep -E "[1-9]+"æˆ–egrep "[1-9]+" åªè¾“å‡ºæ–‡ä»¶ä¸­åŒ¹é…åˆ°çš„éƒ¨åˆ† -o é€‰é¡¹ï¼š 12345echo this is a test line. | grep -o -E "[a-z]+\."line.echo this is a test line. | egrep -o "[a-z]+\."line. ç»Ÿè®¡æ–‡ä»¶æˆ–è€…æ–‡æœ¬ä¸­åŒ…å«åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œæ•° -c é€‰é¡¹ï¼š 1grep -c "text" file_name è¾“å‡ºåŒ…å«åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œæ•° -n é€‰é¡¹ï¼š 123456grep "text" -n file_nameæˆ–cat file_name | grep "text" -n#å¤šä¸ªæ–‡ä»¶grep "text" -n file_1 file_2 æ‰“å°æ ·å¼åŒ¹é…æ‰€ä½äºŽçš„å­—ç¬¦æˆ–å­—èŠ‚åç§» 1234echo gun is not unix | grep -b -o "not"7:not#ä¸€è¡Œä¸­å­—ç¬¦ä¸²çš„å­—ç¬¦ä¾¿å®œæ˜¯ä»Žè¯¥è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹è®¡ç®—ï¼Œèµ·å§‹å€¼ä¸º0ã€‚é€‰é¡¹ **-b -o** ä¸€èˆ¬æ€»æ˜¯é…åˆä½¿ç”¨ã€‚ æœç´¢å¤šä¸ªæ–‡ä»¶å¹¶æŸ¥æ‰¾åŒ¹é…æ–‡æœ¬åœ¨å“ªäº›æ–‡ä»¶ä¸­ 1grep -l "text" file1 file2 file3... grepé€’å½’æœç´¢æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384# åœ¨å¤šçº§ç›®å½•ä¸­å¯¹æ–‡æœ¬è¿›è¡Œé€’å½’æœç´¢grep "text" . -r -n# .è¡¨ç¤ºå½“å‰ç›®å½•ã€‚# å¿½ç•¥åŒ¹é…æ ·å¼ä¸­çš„å­—ç¬¦å¤§å°å†™echo "hello world" | grep -i "HELLO"hello# é€‰é¡¹ -e åˆ¶åŠ¨å¤šä¸ªåŒ¹é…æ ·å¼ï¼šecho this is a text line | grep -e "is" -e "line" -oisline#ä¹Ÿå¯ä»¥ä½¿ç”¨ **-f** é€‰é¡¹æ¥åŒ¹é…å¤šä¸ªæ ·å¼ï¼Œåœ¨æ ·å¼æ–‡ä»¶ä¸­é€è¡Œå†™å‡ºéœ€è¦åŒ¹é…çš„å­—ç¬¦ã€‚cat patfileaaabbb# ç”¨æ–‡ä»¶åç§°åŒ¹é…, å®žé™…ä¸Šå°±æ˜¯åŒ¹é…æ–‡ä»¶ä¸­çš„å†…å®¹echo aaa bbb ccc ddd eee | grep -f patfile -oaaabbb# åœ¨grepæœç´¢ç»“æžœä¸­åŒ…æ‹¬æˆ–è€…æŽ’é™¤æŒ‡å®šæ–‡ä»¶ï¼š---#åªåœ¨ç›®å½•ä¸­æ‰€æœ‰çš„.phpå’Œ.htmlæ–‡ä»¶ä¸­é€’å½’æœç´¢å­—ç¬¦"main()"grep "main()" . -r --include *.&#123;php,html&#125;#åœ¨æœç´¢ç»“æžœä¸­æŽ’é™¤æ‰€æœ‰READMEæ–‡ä»¶grep "main()" . -r --exclude "README"#åœ¨æœç´¢ç»“æžœä¸­æŽ’é™¤filelistæ–‡ä»¶åˆ—è¡¨é‡Œçš„æ–‡ä»¶grep "main()" . -r --exclude-from filelist---# ä½¿ç”¨0å€¼å­—èŠ‚åŽç¼€çš„grepä¸Žxargsï¼š---# æµ‹è¯•æ–‡ä»¶ï¼šecho "aaa" &gt; file1echo "bbb" &gt; file2echo "aaa" &gt; file3grep "aaa" file* -lZ | xargs -0 rm#æ‰§è¡ŒåŽä¼šåˆ é™¤file1å’Œfile3ï¼Œgrepè¾“å‡ºç”¨-Zé€‰é¡¹æ¥æŒ‡å®šä»¥0å€¼å­—èŠ‚ä½œä¸ºç»ˆç»“ç¬¦æ–‡ä»¶åï¼ˆ\0ï¼‰ï¼Œxargs -0 è¯»å–è¾“å…¥å¹¶ç”¨0å€¼å­—èŠ‚ç»ˆç»“ç¬¦åˆ†éš”æ–‡ä»¶åï¼Œç„¶åŽåˆ é™¤åŒ¹é…æ–‡ä»¶ï¼Œ-Zé€šå¸¸å’Œ-lç»“åˆä½¿ç”¨ã€‚# å¥½å§, æš‚æ—¶æˆ‘ä¹Ÿæ²¡æ‡‚æ˜¯å•¥æ„æ€...---# grepé™é»˜è¾“å‡ºï¼šgrep -q "test" filename# ä¸ä¼šè¾“å‡ºä»»ä½•ä¿¡æ¯ï¼Œå¦‚æžœå‘½ä»¤è¿è¡ŒæˆåŠŸè¿”å›ž0ï¼Œå¤±è´¥åˆ™è¿”å›žéž0å€¼ã€‚ä¸€èˆ¬ç”¨äºŽæ¡ä»¶æµ‹è¯•ã€‚# æ‰“å°å‡ºåŒ¹é…æ–‡æœ¬ä¹‹å‰æˆ–è€…ä¹‹åŽçš„è¡Œï¼š# æ˜¾ç¤ºåŒ¹é…æŸä¸ªç»“æžœä¹‹åŽçš„3è¡Œï¼Œä½¿ç”¨ -A é€‰é¡¹ï¼šseq 10 | grep "5" -A 35678# æ˜¾ç¤ºåŒ¹é…æŸä¸ªç»“æžœä¹‹å‰çš„3è¡Œï¼Œä½¿ç”¨ -B é€‰é¡¹ï¼šseq 10 | grep "5" -B 32345# æ˜¾ç¤ºåŒ¹é…æŸä¸ªç»“æžœçš„å‰ä¸‰è¡Œå’ŒåŽä¸‰è¡Œï¼Œä½¿ç”¨ -C é€‰é¡¹ï¼šseq 10 | grep "5" -C 32345678# å¦‚æžœåŒ¹é…ç»“æžœæœ‰å¤šä¸ªï¼Œä¼šç”¨â€œ--â€ä½œä¸ºå„åŒ¹é…ç»“æžœä¹‹é—´çš„åˆ†éš”ç¬¦ï¼šecho -e "a\nb\nc\na\nb\nc" | grep a -A 1ab--ab grepå…¶å®ƒå¸¸ç”¨ç”¨æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546# ç»Ÿè®¡å‡ºçŽ°æŸä¸ªå­—ç¬¦ä¸²çš„è¡Œçš„æ€»è¡Œæ•° '-c'cts1 Desktop # echo "hello" &gt;&gt; hello.shcts1 Desktop # grep -c 'hello' hello.sh1# æŸ¥è¯¢ä¸åŒ…å«helloçš„è¡Œ, å¸¦æœ‰helloçš„æ•´è¡Œéƒ½ä¸ä¼šè¢«æŸ¥è¯¢åˆ° '-v'cts1 Desktop # grep -v 'hello' hello.sh....# `.*`çš„ç”¨æ³•, å‰åŽéƒ½æ˜¯ `.*` , åªè¦åŒ…å« parrten çš„ æ•´è¡Œ éƒ½ä¼šè¢«æŸ¥å‡ºæ¥grep '.*hello.*' hello.sh# ä»»ä½•ç”± 'h..p'åŒ…å«çš„éƒ½ä¼šè¢«æŸ¥å‡ºæ¥. æŸ¥çš„å½“å‰è¡Œ, .* ä»£è¡¨ä»»æ„å­—ç¬¦cts1 Desktop # grep 'h.*p' /etc/passwdgopher:x:13:30:gopher:/var/gopher:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nolo# æ­£åˆ™è¡¨è¾¾ä»¥ ro å¼€å¤´cts1 Desktop # grep '^ro' /etc/passwdroot:x:0:0:root:/root:/bin/zsh# æ­£åˆ™è¡¨è¾¾ä»¥ t ç»“å°¾cts1 Desktop # grep 't$' /etc/passwdhalt:x:7:0:halt:/sbin:/sbin/halt# '[Gg]rep'åŒ¹é…Grepå’Œgrep## æ­¤å¤„æ˜¯åŒ¹é… ä»¥ h || r å¼€å¤´çš„cts1 Desktop # grep '^[hr]' /etc/passwdroot:x:0:0:root:/root:/bin/zshhalt:x:7:0:halt:/sbin:/sbin/haltrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin# åŒ¹é…éžhä¹‹å¤–å…¶ä»–çš„, å’Œ r å¼€å¤´çš„, ä¹Ÿå°±æ˜¯åŒ¹é… hä»¥å¤–çš„cts1 Desktop # grep '^[hr]' /etc/passwdroot:x:0:0:root:/root:/bin/zshhalt:x:7:0:halt:/sbin:/sbin/haltrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin# åŒ¹é… h-r ä»¥å¤–çš„cts1 Desktop # grep '&lt;sup&gt;[&lt;/sup&gt;h-r]' /etc/passwdbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologin... sed(æµç¼–è¾‘å™¨)sedå«åšæµç¼–è¾‘å™¨ï¼Œåœ¨shellè„šæœ¬å’ŒMakefileä¸­ä½œä¸ºè¿‡æ»¤ä¸€ä½¿ç”¨éžå¸¸æ™®éï¼Œä¹Ÿå°±æ˜¯æŠŠå‰ä¸€ä¸ªç¨‹åºçš„è¾“å‡ºå¼•å…¥sedçš„è¾“å…¥ï¼Œç»è¿‡ä¸€ç³»åˆ—ç¼–è¾‘å‘½ä»¤è½¬æ¢æˆä¸ºå¦ä¸€ç§æ ¼å¼è¾“å‡ºã€‚sedæ˜¯ä¸€ç§åœ¨çº¿ç¼–è¾‘å™¨ï¼Œå®ƒä¸€æ¬¡å¤„ç†ä¸€è¡Œå†…å®¹ï¼Œå¤„ç†æ—¶ï¼ŒæŠŠå½“å‰å¤„ç†çš„è¡Œå­˜å‚¨åœ¨ä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œç§°ä¸ºâ€æ¨¡å¼ç©ºé—´â€,æŽ¥ç€ç”¨sedå‘½ä»¤å¤„ç†ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå¤„ç†å®ŒæˆåŽï¼ŒæŠŠç¼“å†²åŒºçš„å†…å®¹é€å¾€å±å¹•ã€‚æŽ¥ç€å¤„ç†ä¸‹ä¸€è¡Œï¼Œè¿™æ ·ä¸æ–­é‡å¤ï¼Œç›´åˆ°æ–‡ä»¶æœ«å°¾ã€‚æ–‡ä»¶å†…å®¹å¹¶æ²¡æœ‰æ”¹å˜ï¼Œé™¤éžä½ ä½¿ç”¨é‡å®šå‘å­˜å‚¨è¾“å‡ºã€‚ é€‰é¡¹12345678910111213-nï¼šä¸€èˆ¬sedå‘½ä»¤ä¼šæŠŠæ‰€æœ‰æ•°æ®éƒ½è¾“å‡ºåˆ°å±å¹•ï¼Œå¦‚æžœåŠ å…¥-né€‰é¡¹çš„è¯ï¼Œåˆ™åªä¼šæŠŠç»è¿‡sedå‘½ä»¤å¤„ç†çš„è¡Œè¾“å‡ºåˆ°å±å¹•ã€‚-e&lt;script&gt;æˆ–--expression=&lt;script&gt;ï¼šä»¥é€‰é¡¹ä¸­çš„æŒ‡å®šçš„scriptæ¥å¤„ç†è¾“å…¥çš„æ–‡æœ¬æ–‡ä»¶ï¼› å…è®¸å¯¹è¾“å…¥æ•°æ®åº”ç”¨å¤šæ¡sedå‘½ä»¤ç¼–è¾‘ã€‚-iï¼šç”¨sedçš„ä¿®æ”¹ç»“æžœç›´æŽ¥ä¿®æ”¹è¯»å–æ•°æ®çš„æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ç”±å±å¹•è¾“å‡ºã€‚-f&lt;scriptæ–‡ä»¶&gt;æˆ–--file=&lt;scriptæ–‡ä»¶&gt;ï¼šä»¥é€‰é¡¹ä¸­æŒ‡å®šçš„scriptæ–‡ä»¶æ¥å¤„ç†è¾“å…¥çš„æ–‡æœ¬æ–‡ä»¶ï¼›-næˆ–--quietæˆ–â€”â€”silentï¼šä»…æ˜¾ç¤ºscriptå¤„ç†åŽçš„ç»“æžœï¼›--versionï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚# åŠ¨ä½œ:aï¼šè¿½åŠ ï¼Œåœ¨å½“å‰è¡ŒåŽæ·»åŠ ä¸€è¡Œæˆ–å¤šè¡Œã€‚cï¼šè¡Œæ›¿æ¢ï¼Œç”¨cåŽé¢çš„å­—ç¬¦ä¸²æ›¿æ¢åŽŸæ•°æ®è¡Œã€‚iï¼šæ’å…¥ï¼Œåœ¨å½“å‰è¡Œå‰æ’å…¥ä¸€è¡Œæˆ–å¤šè¡Œã€‚pï¼šæ‰“å°ï¼Œè¾“å‡ºæŒ‡å®šçš„è¡Œã€‚sï¼šå­—ç¬¦ä¸²æ›¿æ¢ï¼Œç”¨ä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢å¦å¤–ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚æ ¼å¼ä¸º**\'**è¡ŒèŒƒå›´s/æ—§å­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²/g**\'** (å¦‚æžœä¸åŠ gçš„è¯ï¼Œåˆ™è¡¨ç¤ºåªæ›¿æ¢æ¯è¡Œç¬¬ä¸€ä¸ªåŒ¹é…çš„ä¸²) sedå…ƒå­—ç¬¦é›†(æ­£åˆ™)12345678910111213**&lt;sup&gt;** åŒ¹é…è¡Œå¼€å§‹ï¼Œå¦‚ï¼š/&lt;/sup&gt;sed/åŒ¹é…æ‰€æœ‰ä»¥sedå¼€å¤´çš„è¡Œã€‚**$** åŒ¹é…è¡Œç»“æŸï¼Œå¦‚ï¼š/sed$/åŒ¹é…æ‰€æœ‰ä»¥sedç»“å°¾çš„è¡Œã€‚**.** åŒ¹é…ä¸€ä¸ªéžæ¢è¡Œç¬¦çš„ä»»æ„å­—ç¬¦ï¼Œå¦‚ï¼š/s.d/åŒ¹é…såŽæŽ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œæœ€åŽæ˜¯dã€‚**** * åŒ¹é…0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ï¼Œå¦‚ï¼š/*sed/åŒ¹é…æ‰€æœ‰æ¨¡æ¿æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åŽç´§è·Ÿsedçš„è¡Œã€‚**[]** åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚/[ss]ed/åŒ¹é…sedå’ŒSedã€‚ **[&lt;sup&gt;]** åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š/[&lt;/sup&gt;A-RT-Z]ed/åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿedçš„è¡Œã€‚**\(..\)** åŒ¹é…å­ä¸²ï¼Œä¿å­˜åŒ¹é…çš„å­—ç¬¦ï¼Œå¦‚s/\(love\)able/\1rsï¼Œloveableè¢«æ›¿æ¢æˆloversã€‚**&amp;** ä¿å­˜æœç´¢å­—ç¬¦ç”¨æ¥æ›¿æ¢å…¶ä»–å­—ç¬¦ï¼Œå¦‚s/love/ **&amp;** /ï¼Œloveè¿™æˆ **love** ã€‚**\&lt;** åŒ¹é…å•è¯çš„å¼€å§‹ï¼Œå¦‚:/\&lt;love/åŒ¹é…åŒ…å«ä»¥loveå¼€å¤´çš„å•è¯çš„è¡Œã€‚**\&gt;** åŒ¹é…å•è¯çš„ç»“æŸï¼Œå¦‚/love\&gt;/åŒ¹é…åŒ…å«ä»¥loveç»“å°¾çš„å•è¯çš„è¡Œã€‚**x\&#123;m\&#125;** é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š/0\&#123;5\&#125;/åŒ¹é…åŒ…å«5ä¸ª0çš„è¡Œã€‚**x\&#123;m,\&#125;** é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š/0\&#123;5,\&#125;/åŒ¹é…è‡³å°‘æœ‰5ä¸ª0çš„è¡Œã€‚**x\&#123;m,n\&#125;** é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºŽnæ¬¡ï¼Œå¦‚ï¼š/0\&#123;5,10\&#125;/åŒ¹é…5~10ä¸ª0çš„è¡Œã€‚ å®žä¾‹ åˆ é™¤: då‘½ä»¤ sed â€˜2dâ€™ sed.txt â€”â€“åˆ é™¤sed.txtæ–‡ä»¶çš„ç¬¬äºŒè¡Œã€‚ sed â€˜2,$dâ€™ sed.txt â€”â€“åˆ é™¤sed.txtæ–‡ä»¶çš„ç¬¬äºŒè¡Œåˆ°æœ«å°¾æ‰€æœ‰è¡Œã€‚ sed â€˜$dâ€™ sed.txt â€”â€“åˆ é™¤sed.txtæ–‡ä»¶çš„æœ€åŽä¸€è¡Œã€‚ sed â€˜/test/d â€˜ sed.txt â€”â€“åˆ é™¤sed.txtæ–‡ä»¶æ‰€æœ‰åŒ…å«testçš„è¡Œã€‚ sed â€˜/[A-Za-z]/d â€˜ sed.txt â€”â€“åˆ é™¤sed.txtæ–‡ä»¶æ‰€æœ‰åŒ…å«å­—æ¯çš„è¡Œã€‚ æ•´è¡Œæ›¿æ¢: cå‘½ä»¤ å°†ç¬¬äºŒè¡Œæ›¿æ¢æˆhello world sed \â€™2c hello world\â€™ sed.txt å­—ç¬¦ä¸²æ›¿æ¢ï¼šså‘½ä»¤ sed â€˜s/hello/hi/gâ€™ sed.txt ## åœ¨æ•´è¡ŒèŒƒå›´å†…æŠŠhelloæ›¿æ¢ä¸ºhiã€‚å¦‚æžœæ²¡æœ‰gæ ‡è®°ï¼Œåˆ™åªæœ‰æ¯è¡Œç¬¬ä¸€ä¸ªåŒ¹é…çš„helloè¢«æ›¿æ¢æˆhiã€‚ sed â€˜s/hello/hi/2â€™ sed.txt ## æ­¤ç§å†™æ³•è¡¨ç¤ºåªæ›¿æ¢æ¯è¡Œçš„ç¬¬2ä¸ªhelloä¸ºhi sed â€˜s/hello/hi/2gâ€™ sed.txt ## æ­¤ç§å†™æ³•è¡¨ç¤ºåªæ›¿æ¢æ¯è¡Œçš„ç¬¬2ä¸ªä»¥åŽçš„helloä¸ºhiï¼ˆåŒ…æ‹¬ç¬¬2ä¸ªï¼‰ sed -n â€˜s/^hello/hi/pâ€™ sed.txt ## (-n)é€‰é¡¹å’Œpæ ‡å¿—ä¸€èµ·ä½¿ç”¨è¡¨ç¤ºåªæ‰“å°é‚£äº›å‘ç”Ÿæ›¿æ¢çš„è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœæŸä¸€è¡Œå¼€å¤´çš„helloè¢«æ›¿æ¢æˆhiï¼Œå°±æ‰“å°å®ƒã€‚ sed -n â€˜2,4pâ€™ sed.txt ## æ‰“å°è¾“å‡ºsed.txtä¸­çš„ç¬¬2è¡Œå’Œç¬¬4è¡Œ sed -n â€˜s/hello/&amp;-hi/gpâ€™ sed.txt sed â€˜s/^192.168.0.1/&amp;-localhost/â€˜ sed.txt sed â€˜s/^192.168.0.1/[&amp;]/â€˜ sed.txt ## &amp;ç¬¦å·è¡¨ç¤ºè¿½åŠ ä¸€ä¸ªä¸²åˆ°æ‰¾åˆ°çš„ä¸²åŽ, &amp;ä»£è¡¨å‰ä¸€ä¸ªä¸²ã€‚ æ‰€æœ‰ä»¥192.168.0.1å¼€å¤´çš„è¡Œéƒ½ä¼šè¢«æ›¿æ¢æˆå®ƒè‡ªå·²åŠ  -localhostï¼Œå˜æˆ192.168.0.1-localhostã€‚ ç¬¬ä¸‰å¥è¡¨ç¤ºç»™IPåœ°å€æ·»åŠ ä¸­æ‹¬å· sed -n â€˜s/(liu)jialing/\1tao/pâ€™ sed.txt sed -n â€˜s/(liu)jia(ling)/\1tao\2ss/pâ€™ sed.txt ## liuè¢«æ ‡è®°ä¸º\1ï¼Œæ‰€ä»¥liuä¼šè¢«ä¿ç•™ä¸‹æ¥ï¼ˆ\1 == liuï¼‰ ## lingè¢«æ ‡è®°ä¸º\2ï¼Œæ‰€ä»¥lingä¹Ÿä¼šè¢«ä¿ç•™ä¸‹æ¥ï¼ˆ\2 == lingï¼‰ ## æ‰€ä»¥æœ€åŽçš„ç»“æžœå°±æ˜¯\1tao\2ss == â€œliuâ€ + â€œtaoâ€ + â€œlingâ€ + â€œssâ€ æ­¤å¤„åˆ‡è®°ï¼š\1ä»£è¡¨çš„æ˜¯è¢«ç¬¬ä¸€ä¸ª()åŒ…å«çš„å†…å®¹ï¼Œ\1ä»£è¡¨çš„æ˜¯è¢«ç¬¬ä¸€ä¸ª()åŒ…å«çš„å†…å®¹ï¼Œâ€¦â€¦ ä¸Šé¢å‘½ä»¤çš„æ„æ€å°±æ˜¯ï¼šè¢«æ‹¬å·åŒ…å«çš„å­—ç¬¦ä¸²ä¼šä¿ç•™ä¸‹æ¥ï¼Œç„¶åŽè·Ÿå…¶ä»–çš„å­—ç¬¦ä¸²æ¯”å¦‚taoå’Œssç»„æˆæ–°çš„å­—ç¬¦ä¸²liutaolingss sed â€˜s#hello#hi#gâ€™ sed.txt ## ä¸è®ºä»€ä¹ˆå­—ç¬¦ï¼Œç´§è·Ÿç€så‘½ä»¤çš„éƒ½è¢«è®¤ä¸ºæ˜¯æ–°çš„åˆ†éš”ç¬¦ï¼Œæ‰€ä»¥ï¼Œâ€#â€åœ¨è¿™é‡Œæ˜¯åˆ†éš”ç¬¦ï¼Œä»£æ›¿äº†é»˜è®¤çš„â€/â€œåˆ†éš”ç¬¦ã€‚è¡¨ç¤ºæŠŠæ‰€æœ‰helloæ›¿æ¢æˆhiã€‚ é€‰å®šè¡Œçš„èŒƒå›´ï¼šé€—å· sed -n â€˜/today/,/hello/pâ€™ sed.txt ## æ‰€æœ‰åœ¨æ¨¡æ¿todayå’Œhelloæ‰€ç¡®å®šçš„èŒƒå›´å†…çš„è¡Œéƒ½è¢«æ‰“å°ã€‚éƒ½æ‰¾ç¬¬ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»Žç¬¬ä¸€ä¸ªtodayåˆ°ç¬¬ä¸€ä¸ªhello sed -n â€˜5,/^hello/pâ€™ sed.txt sed -n â€˜/^hello/,8pâ€™ sed.txt ## æ‰“å°ä»Žç¬¬äº”è¡Œå¼€å§‹åˆ°ç¬¬ä¸€ä¸ªåŒ…å«ä»¥helloå¼€å§‹çš„è¡Œä¹‹é—´çš„æ‰€æœ‰è¡Œã€‚ sed â€˜/today/,/hello/s/$/www/â€˜ sed.txt ## å¯¹äºŽæ¨¡æ¿todayå’Œhelloä¹‹é—´çš„è¡Œï¼Œæ¯è¡Œçš„æœ«å°¾ç”¨å­—ç¬¦ä¸²wwwæ›¿æ¢ã€‚ sed â€˜/today/,/hello/s/^/www/â€˜ sed.txt ## å¯¹äºŽæ¨¡æ¿todayå’Œhelloä¹‹é—´çš„è¡Œï¼Œæ¯è¡Œçš„å¼€å¤´ç”¨å­—ç¬¦ä¸²wwwæ›¿æ¢ã€‚ sed â€˜/^[A-Za-z]/s/5/five/gâ€™ sed.txt ## å°†ä»¥å­—æ¯å¼€å¤´çš„è¡Œä¸­çš„æ•°å­—5æ›¿æ¢æˆfive å¤šç‚¹ç¼–è¾‘ï¼šeå‘½ä»¤ sed -e â€˜1,5dâ€™ -e â€˜s/hello/hi/â€˜ sed.txt ## (-e)é€‰é¡¹å…è®¸åœ¨åŒä¸€è¡Œé‡Œæ‰§è¡Œå¤šæ¡å‘½ä»¤ã€‚å¦‚ä¾‹å­æ‰€ç¤ºï¼Œç¬¬ä¸€æ¡å‘½ä»¤åˆ é™¤1è‡³5è¡Œï¼Œç¬¬äºŒæ¡å‘½ä»¤ç”¨helloæ›¿æ¢hiã€‚å‘½ä»¤çš„æ‰§è¡Œé¡ºåºå¯¹ç»“æžœæœ‰å½±å“ã€‚å¦‚æžœä¸¤ä¸ªå‘½ä»¤éƒ½æ˜¯æ›¿æ¢å‘½ä»¤ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªæ›¿æ¢å‘½ä»¤å°†å½±å“ç¬¬äºŒä¸ªæ›¿æ¢å‘½ä»¤çš„ç»“æžœã€‚ sed â€“expression=â€™s/hello/hi/â€˜ â€“expression=â€™/today/dâ€™ sed.txt ## ä¸€ä¸ªæ¯”-eæ›´å¥½çš„å‘½ä»¤æ˜¯â€“expressionã€‚å®ƒèƒ½ç»™sedè¡¨è¾¾å¼èµ‹å€¼ã€‚ ä»Žæ–‡ä»¶è¯»å…¥ï¼šrå‘½ä»¤ sed â€˜/hello/r fileâ€™ sed.txt ## fileé‡Œçš„å†…å®¹è¢«è¯»è¿›æ¥ï¼Œæ˜¾ç¤ºåœ¨ä¸ŽhelloåŒ¹é…çš„è¡Œä¸‹é¢ï¼Œå¦‚æžœåŒ¹é…å¤šè¡Œï¼Œåˆ™fileçš„å†…å®¹å°†æ˜¾ç¤ºåœ¨æ‰€æœ‰åŒ¹é…è¡Œçš„ä¸‹é¢ã€‚ å†™å…¥æ–‡ä»¶ï¼šwå‘½ä»¤ sed -n â€˜/hello/w fileâ€™ sed.txt ## åœ¨huangbo.txtä¸­æ‰€æœ‰åŒ…å«helloçš„è¡Œéƒ½è¢«å†™å…¥fileé‡Œã€‚ è¿½åŠ å‘½ä»¤ï¼šaå‘½ä»¤ sed â€˜/^hello/a\â€”&gt;this is a exampleâ€™ sed.txt ## â€˜â€”&gt;this is a exampleâ€™è¢«è¿½åŠ åˆ°ä»¥helloå¼€å¤´çš„è¡Œ(å¦èµ·ä¸€è¡Œ)åŽé¢ï¼Œsedè¦æ±‚å‘½ä»¤aåŽé¢æœ‰ä¸€ä¸ªåæ–œæ ã€‚ æ’å…¥ï¼šiå‘½ä»¤ sed â€˜/will/i\some thing new â€”â€”â€”â€”â€”â€”â€”â€”-â€˜ sed.txt ## å¦‚æžœtestè¢«åŒ¹é…ï¼Œåˆ™æŠŠåæ–œæ åŽé¢çš„æ–‡æœ¬æ’å…¥åˆ°åŒ¹é…è¡Œçš„å‰é¢ã€‚ ä¸‹ä¸€ä¸ªï¼šnå‘½ä»¤ sed â€˜/hello/{n; s/aa/bb/;}â€™ sed.txt æ›¿æ¢ä¸‹ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªaa sed â€˜/hello/{n; s/aa/bb/g;}â€™ sed.txt æ›¿æ¢ä¸‹ä¸€è¡Œçš„å…¨éƒ¨aa ## å¦‚æžœhelloè¢«åŒ¹é…ï¼Œåˆ™ç§»åŠ¨åˆ°åŒ¹é…è¡Œçš„ä¸‹ä¸€è¡Œï¼Œæ›¿æ¢è¿™ä¸€è¡Œçš„aaï¼Œå˜ä¸ºbbï¼Œå¹¶æ‰“å°è¯¥è¡Œï¼Œç„¶åŽç»§ç»­ã€‚ é€€å‡ºï¼šqå‘½ä»¤ sed â€˜10qâ€™ sed.txt ## æ‰“å°å®Œç¬¬10è¡ŒåŽï¼Œé€€å‡ºsedã€‚ åŒæ ·çš„å†™æ³•ï¼š sed -n â€˜1,10p â€˜ sed.txt awk(æŠ¥è¡¨ç”Ÿæˆå™¨)Awkæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¤„ç†æ–‡æœ¬çš„ç¼–ç¨‹è¯­è¨€å·¥å…·ï¼Œå…¶åç§°å¾—è‡ªäºŽå®ƒçš„åˆ›å§‹äººAlfred Ahoã€Peter Weinbergerå’ŒBrian Kernighan å§“æ°çš„é¦–ä¸ªå­—æ¯ï¼Œç›¸å¯¹äºŽgrepçš„æŸ¥æ‰¾ï¼Œsedçš„ç¼–è¾‘ï¼Œawkåœ¨å…¶å¯¹æ•°æ®åˆ†æžå¹¶ç”ŸæˆæŠ¥å‘Šæ—¶ï¼Œæ˜¾å¾—å°¤ä¸ºå¼ºå¤§ã€‚AWK æä¾›äº†æžå…¶å¼ºå¤§çš„åŠŸèƒ½ï¼šå¯ä»¥è¿›è¡Œæ ·å¼è£…å…¥ã€æµæŽ§åˆ¶ã€æ•°å­¦è¿ç®—ç¬¦ã€è¿›ç¨‹æŽ§åˆ¶è¯­å¥ç”šè‡³äºŽå†…ç½®çš„å˜é‡å’Œå‡½æ•°ã€‚ç®€å•æ¥è¯´awkå°±æ˜¯æ‰«ææ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œï¼ŒæŸ¥æ‰¾ä¸Žå‘½ä»¤è¡Œä¸­æ‰€ç»™å®šå†…å®¹ç›¸åŒ¹é…çš„æ¨¡å¼ã€‚å¦‚æžœå‘çŽ°åŒ¹é…å†…å®¹ï¼Œåˆ™è¿›è¡Œä¸‹ä¸€ä¸ªç¼–ç¨‹æ­¥éª¤ã€‚å¦‚æžœæ‰¾ä¸åˆ°åŒ¹é…å†…å®¹ï¼Œåˆ™ç»§ç»­å¤„ç†ä¸‹ä¸€è¡Œã€‚ è¯­æ³•12awk [options] 'script' var=value file(s)awk [options] -f scriptfile var=value file(s) â€¦ TODO å¾…è¡¥å…… å®žä¾‹ å‡è®¾last -n 5çš„è¾“å‡ºå¦‚ä¸‹: 123456root@cts1:~ # last -n 5root pts/1 192.168.170.1 Mon May 28 09:28 still logged inroot pts/1 192.168.170.1 Sun May 27 20:53 - 07:21 (10:28)root pts/0 192.168.170.1 Sun May 27 19:39 still logged inreboot system boot 2.6.32-573.el6.x Sun May 27 19:34 - 14:48 (19:13)root pts/1 192.168.170.1 Sat May 26 20:43 - 22:36 (01:53) åªæ˜¾ç¤ºäº”ä¸ªæœ€è¿‘ç™»å½•çš„è´¦å·ï¼š 12345678root@cts1:~ # last -n 5 | awk '&#123;print $1&#125;'rootrootrootrebootroot# awkå·¥ä½œæµç¨‹æ˜¯è¿™æ ·çš„ï¼šè¯»å…¥æœ‰'\n'æ¢è¡Œç¬¦åˆ†å‰²çš„ä¸€æ¡è®°å½•ï¼Œç„¶åŽå°†è®°å½•æŒ‰æŒ‡å®šçš„åŸŸåˆ†éš”ç¬¦åˆ’åˆ†åŸŸï¼Œå¡«å……åŸŸï¼Œ$0åˆ™è¡¨ç¤ºæ‰€æœ‰åŸŸ,$1è¡¨ç¤ºç¬¬ä¸€ä¸ªåŸŸ,$nè¡¨ç¤ºç¬¬nä¸ªåŸŸã€‚é»˜è®¤åŸŸåˆ†éš”ç¬¦æ˜¯"ç©ºç™½é”®" æˆ– "[tab]é”®",æ‰€ä»¥$1è¡¨ç¤ºç™»å½•ç”¨æˆ·ï¼Œ$3è¡¨ç¤ºç™»å½•ç”¨æˆ·ip,ä»¥æ­¤ç±»æŽ¨ æ˜¾ç¤º/etc/passwdçš„è´¦æˆ·ï¼š 12345678root@cts1:~ # cat /etc/passwd | awk -F':' '&#123;print $1&#125;'rootbindaemon...# è¿™ç§æ˜¯awk+actionçš„ç¤ºä¾‹ï¼Œæ¯è¡Œéƒ½ä¼šæ‰§è¡Œaction&#123;print $1&#125;ã€‚# -FæŒ‡å®šåŸŸåˆ†éš”ç¬¦ä¸º':' æ˜¾ç¤º/etc/passwdçš„è´¦æˆ·å’Œè´¦æˆ·å¯¹åº”çš„shell,è€Œè´¦æˆ·ä¸Žshellä¹‹é—´ä»¥tabé”®åˆ†å‰² 12345root@cts1:~ # cat /etc/passwd | awk -F':' '&#123;print $1"\t"$7&#125;'root /bin/zshbin /sbin/nologindaemon /sbin/nologin... BEGIN and END å¦‚æžœåªæ˜¯æ˜¾ç¤º/etc/passwdçš„è´¦æˆ·å’Œè´¦æˆ·å¯¹åº”çš„shell,è€Œè´¦æˆ·ä¸Žshellä¹‹é—´ä»¥é€—å·åˆ†å‰²,è€Œä¸”åœ¨æ‰€æœ‰è¡Œæ·»åŠ åˆ—åname,shell,åœ¨æœ€åŽä¸€è¡Œæ·»åŠ â€blue,/bin/noshâ€ã€‚ 123456789101112131415161718root@cts1:~ # cat /etc/passwd |awk -F ':' 'BEGIN &#123;print "name,shell"&#125; &#123;print $1","$7&#125; END &#123;print "blue,/bin/nosh"&#125;'---name,shellroot,/bin/zshbin,/sbin/nologin...mysql,/bin/bashblue,/bin/nosh-------------------------root@cts1:~ # cat /etc/passwd | awk -F ':' 'BEGIN &#123;print "name \t shell"&#125; &#123;print$1"\t"$7&#125; END &#123;print "blue,/bin/bash"&#125;'---name shellroot /bin/zshbin /sbin/nologin...mysql /bin/bashblue,/bin/bash awkå·¥ä½œæµç¨‹æ˜¯è¿™æ ·çš„ï¼šå…ˆæ‰§è¡ŒBEGINï¼Œç„¶åŽè¯»å–æ–‡ä»¶ï¼Œè¯»å…¥æœ‰/næ¢è¡Œç¬¦åˆ†å‰²çš„ä¸€æ¡è®°å½•ï¼Œç„¶åŽå°†è®°å½•æŒ‰æŒ‡å®šçš„åŸŸåˆ†éš”ç¬¦åˆ’åˆ†åŸŸï¼Œå¡«å……åŸŸï¼Œ$0åˆ™è¡¨ç¤ºæ‰€æœ‰åŸŸ,$1è¡¨ç¤ºç¬¬ä¸€ä¸ªåŸŸ,$nè¡¨ç¤ºç¬¬nä¸ªåŸŸ,éšåŽå¼€å§‹æ‰§è¡Œæ¨¡å¼æ‰€å¯¹åº”çš„åŠ¨ä½œactionã€‚æŽ¥ç€å¼€å§‹è¯»å…¥ç¬¬äºŒæ¡è®°å½•â€¢â€¢â€¢â€¢â€¢â€¢ç›´åˆ°æ‰€æœ‰çš„è®°å½•éƒ½è¯»å®Œï¼Œæœ€åŽæ‰§è¡ŒENDæ“ä½œã€‚ æœç´¢/etc/passwdæœ‰rootå…³é”®å­—çš„æ‰€æœ‰è¡Œ 1234567891011121314151. root@cts1:~ # awk -F: '/root/' /etc/passwd --- root:x:0:0:root:/root:/bin/zsh operator:x:11:0:operator:/root:/sbin/nologin # è¿™ç§æ˜¯patternçš„ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ¹é…äº†pattern(è¿™é‡Œæ˜¯root)çš„è¡Œæ‰ä¼šæ‰§è¡Œaction(æ²¡æœ‰æŒ‡å®šactionï¼Œé»˜è®¤è¾“å‡ºæ¯è¡Œçš„å†…å®¹)ã€‚2. æœç´¢æ”¯æŒæ­£åˆ™ï¼Œä¾‹å¦‚æ‰¾rootå¼€å¤´çš„: awk -F: '/^root/' /etc/passwd# æœç´¢/etc/passwdæœ‰rootå…³é”®å­—çš„æ‰€æœ‰è¡Œï¼Œå¹¶æ˜¾ç¤ºå¯¹åº”çš„shellroot@cts1:~ # awk -F ':' '/root/&#123;print $7&#125;' /etc/passwd/bin/zsh/sbin/nologin# è¿™é‡ŒæŒ‡å®šäº†action&#123;print $7&#125; awkå¸¸è§å†…ç½®å˜é‡ FILENAMEï¼šawkæµè§ˆçš„æ–‡ä»¶å FNRï¼šæµè§ˆæ–‡ä»¶çš„è®°å½•æ•°ï¼Œä¹Ÿå°±æ˜¯è¡Œæ•°ã€‚awkæ˜¯ä»¥è¡Œä¸ºå•ä½å¤„ç†çš„ï¼Œæ‰€ä»¥æ¯è¡Œå°±æ˜¯ä¸€ä¸ªè®°å½• NRï¼šawkè¯»å–æ–‡ä»¶æ¯è¡Œå†…å®¹æ—¶çš„è¡Œå· NFï¼šæµè§ˆè®°å½•çš„åŸŸçš„ä¸ªæ•°ã€‚å¯ä»¥ç”¨å®ƒæ¥è¾“å‡ºæœ€åŽä¸€ä¸ªåŸŸ FSï¼šè®¾ç½®è¾“å…¥åŸŸåˆ†éš”ç¬¦ï¼Œç­‰ä»·äºŽå‘½ä»¤è¡Œ-Fé€‰é¡¹ OFSï¼šè¾“å‡ºåŸŸåˆ†éš”ç¬¦ ç»Ÿè®¡/etc/passwd:æ–‡ä»¶åï¼Œæ¯è¡Œçš„è¡Œå·ï¼Œæ¯è¡Œçš„åˆ—æ•°ï¼Œå¯¹åº”çš„å®Œæ•´è¡Œå†…å®¹ 1234root@cts1:~ # awk -F ':' '&#123;print "filename:" FILENAME ",linenumber:" NR ",columns:" NF ",linecontent:"$0&#125;' /etc/passwd---filename:/etc/passwd,linenumber:1,columns:7,linecontent:root:x:0:0:root:/root:/bin/zshfilename:/etc/passwd,linenumber:2,columns:7,linecontent:bin:x:1:1:bin:/bin:/sbin/nologin ä½¿ç”¨printfæ›¿ä»£print,å¯ä»¥è®©ä»£ç æ›´åŠ ç®€æ´ï¼Œæ˜“è¯» 1234root@cts1:~ # awk -F ':' '&#123;printf("filename:%s,linenumber:%s,columns:%s,linecontent:%s\n",FILENAME,NR,NF,$0)&#125;' /etc/passwd---filename:/etc/passwd,linenumber:1,columns:7,linecontent:root:x:0:0:root:/root:/bin/zshfilename:/etc/passwd,linenumber:2,columns:7,linecontent:bin:x:1:1:bin:/bin:/sbin/nologin æŒ‡å®šè¾“å…¥åˆ†éš”ç¬¦ï¼ŒæŒ‡å®šè¾“å‡ºåˆ†éš”ç¬¦ï¼š 12345root@cts1:~ # awk 'BEGIN &#123;FS=":"; OFS="\t"&#125; &#123;print $1, $2&#125;' /etc/passwd---root xbin x... å®žç”¨ä¾‹å­ 1234567891011121314# Aï¼šæ‰“å°æœ€åŽä¸€åˆ—ï¼šawk -F: '&#123;print $NF&#125;' /etc/passwdawk -F: '&#123;printf("%s\n",$NF);&#125;' /etc/passwd# Bï¼šç»Ÿè®¡æ–‡ä»¶è¡Œæ•°ï¼šawk 'BEGIN &#123;x=0&#125; &#123;x++&#125; END &#123;print x&#125;' /etc/passwd# Cï¼šæ‰“å°9*9ä¹˜æ³•è¡¨ï¼šawk 'BEGIN&#123;for(n=0;n++&lt;9;)&#123;for(i=0;i++&lt;n;)printf i"*"n"="i*n" ";print ""&#125;&#125;'awk 'BEGIN &#123;for(i=1;i&lt;=9;i++)&#123;for(j=1;j&lt;=i;j++)&#123;printf i"*"j"="i*j" ";&#125;print ""&#125;&#125;'awk 'BEGIN &#123;for(i=9;i&gt;=1;i--)&#123;for(j=i;j&gt;=1;j--)&#123;printf i"*"j"="i*j" ";&#125;print ""&#125;&#125;'# D: è®¡ç®—1-100 ä¹‹å’Œecho "sum" | awk 'BEGIN &#123;sum=0;&#125; &#123;i=0;while(i&lt;101)&#123;sum+=i;i++&#125;&#125; END &#123;print sum&#125;' æ›´å¤šè¯¦ç»†ç”¨æ³•å‚è§å®˜ç½‘ findåŠŸèƒ½ï¼š æœç´¢æ–‡ä»¶ç›®å½•å±‚æ¬¡ç»“æž„ æ ¼å¼ï¼š find path -option actions find &lt;è·¯å¾„&gt; &lt;é€‰é¡¹&gt; [è¡¨è¾¾å¼] å¸¸ç”¨å¯é€‰é¡¹ï¼š1234567891011121314151617-name æ ¹æ®æ–‡ä»¶åæŸ¥æ‰¾ï¼Œæ”¯æŒ(\'\* \' , \'? \')-type æ ¹æ®æ–‡ä»¶ç±»åž‹æŸ¥æ‰¾(f-æ™®é€šæ–‡ä»¶ï¼Œc-å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œb-å—è®¾å¤‡æ–‡ä»¶ï¼Œl-é“¾æŽ¥æ–‡ä»¶ï¼Œd-ç›®å½•)-perm æ ¹æ®æ–‡ä»¶çš„æƒé™æŸ¥æ‰¾ï¼Œæ¯”å¦‚ 755-user æ ¹æ®æ–‡ä»¶æ‹¥æœ‰è€…æŸ¥æ‰¾-group æ ¹æ®æ–‡ä»¶æ‰€å±žç»„å¯»æ‰¾æ–‡ä»¶-size æ ¹æ®æ–‡ä»¶å°å¤§å¯»æ‰¾æ–‡ä»¶ -o è¡¨è¾¾å¼ æˆ–-a è¡¨è¾¾å¼ ä¸Ž-not è¡¨è¾¾å¼ éž ç±»åž‹å‚æ•°åˆ—è¡¨ï¼š1234567- **f** æ™®é€šæ–‡ä»¶- **l** ç¬¦å·è¿žæŽ¥- **d** ç›®å½•- **c** å­—ç¬¦è®¾å¤‡- **b** å—è®¾å¤‡- **s** å¥—æŽ¥å­—- **p** Fifo ç¤ºä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556[linux@linux txt]$ ll ## å‡†å¤‡çš„æµ‹è¯•æ–‡ä»¶total 248-rw-rw-r--. 1 linux linux 235373 Apr 18 00:10 hw.txt-rw-rw-r--. 1 linux linux 0 Apr 22 05:43 LINUX.pdf-rw-rw-r--. 1 linux linux 3 Apr 22 05:50 liujialing.jpg-rw-rw-r--. 1 linux linux 0 Apr 22 05:43 mingxing.pdf-rw-rw-r--. 1 linux linux 57 Apr 22 04:40 mingxing.txt-rw-rw-r--. 1 linux linux 66 Apr 22 05:15 sort.txt-rw-rw-r--. 1 linux linux 214 Apr 18 10:08 test.txt-rw-rw-r--. 1 linux linux 24 Apr 22 05:27 uniq.txt[linux@linux txt]$ find /home/linux/txt/ -name "*.txt" ## æŸ¥æ‰¾æ–‡ä»¶åtxtç»“å°¾çš„æ–‡ä»¶/home/linux/txt/uniq.txt/home/linux/txt/mingxing.txt/home/linux/txt/test.txt/home/linux/txt/hw.txt/home/linux/txt/sort.txt## å¿½ç•¥å¤§å°å†™æŸ¥æ‰¾æ–‡ä»¶ååŒ…å«linux[linux@linux txt]$ find /home/linux/txt -iname "*linux*" /home/linux/txt/LINUX.pdf## æŸ¥æ‰¾æ–‡ä»¶åç»“å°¾æ˜¯.txtæˆ–è€….jpgçš„æ–‡ä»¶[linux@linux txt]$ find /home/linux/txt/ \( -name "*.txt" -o -name "*.jpg" \) /home/linux/txt/liujialing.jpg/home/linux/txt/uniq.txt/home/linux/txt/mingxing.txt/home/linux/txt/test.txt/home/linux/txt/hw.txt/home/linux/txt/sort.txtå¦ä¸€ç§å†™æ³•ï¼šfind /home/linux/txt/ -name "*.txt" -o -name "*.jpg"# ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æ–¹å¼åŽ»æŸ¥æ‰¾ä¸Šé¢æ¡ä»¶çš„æ–‡ä»¶ï¼š[linux@linux txt]$ find /home/linux/txt/ -regex ".*\(\.txt\|\.jpg\)$"/home/linux/txt/liujialing.jpg/home/linux/txt/uniq.txt/home/linux/txt/mingxing.txt/home/linux/txt/test.txt/home/linux/txt/hw.txt/home/linux/txt/sort.txt## æŸ¥æ‰¾.jpgç»“å°¾çš„æ–‡ä»¶ï¼Œç„¶åŽåˆ æŽ‰[linux@linux txt]$ find /home/linux/txt -type f -name "*.jpg" -delete[linux@linux txt]$ lltotal 248-rw-rw-r--. 1 linux linux 235373 Apr 18 00:10 hw.txt-rw-rw-r--. 1 linux linux 0 Apr 22 05:43 LINUX.pdf-rw-rw-r--. 1 linux linux 0 Apr 22 05:43 mingxing.pdf-rw-rw-r--. 1 linux linux 57 Apr 22 04:40 mingxing.txt-rw-rw-r--. 1 linux linux 66 Apr 22 05:15 sort.txt-rw-rw-r--. 1 linux linux 214 Apr 18 10:08 test.txt-rw-rw-r--. 1 linux linux 24 Apr 22 05:27 uniq.txt## æŸ¥æ‰¾5å¤©ä»¥å†…åˆ›å»ºçš„ .sh æ–‡ä»¶, å¹¶æ˜¾ç¤ºåˆ›å»º/æ›´æ”¹æ—¶é—´find / -name "*sh" -mtime -5 |xargs ls -l 3. Shellæ“ä½œå­—ç¬¦ä¸²å­—ç¬¦ä¸²æˆªå–Linuxä¸­æ“ä½œå­—ç¬¦ä¸²ï¼Œä¹Ÿæ˜¯ä¸€é¡¹å¿…å¤‡çš„æŠ€èƒ½ã€‚å…¶ä¸­å°¤ä»¥æˆªå–å­—ç¬¦ä¸²æ›´åŠ é¢‘ç¹ï¼Œä¸‹é¢ä¸ºå¤§å®¶ä»‹ç»å‡ ç§å¸¸ç”¨æ–¹å¼ï¼Œæˆªå–å­—ç¬¦ä¸² é¢„å…ˆå®šä¹‰ä¸€ä¸ªå˜é‡ï¼šWEBSITE=â€™http://hadoop//centos/huangbo.html&#39; #æˆªå–ï¼Œ*ä»»æ„çš„, åˆ é™¤//å·¦è¾¹å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬åˆ¶å®šçš„åˆ†éš”ç¬¦ï¼‰ï¼Œä¿ç•™å³è¾¹å­—ç¬¦ä¸² root@cts1:~ # echo ${WEBSITE#*//}hadoop//centos/huangbo.html ##æˆªå–ï¼Œåˆ é™¤å·¦è¾¹å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬æŒ‡å®šçš„åˆ†éš”ç¬¦ï¼‰ï¼Œä¿ç•™å³è¾¹å­—ç¬¦ä¸²ï¼Œå’Œä¸Šè¾¹ä¸€ä¸ª#ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸€ç›´æ‰¾åˆ°æœ€åŽï¼Œè€Œä¸æ˜¯åƒä¸€ä¸ª#é‚£æ ·æ‰¾åˆ°ä¸€ä¸ªå°±æ»¡è¶³æ¡ä»¶é€€å‡ºäº†ã€‚ root@cts1:~ # echo ${WEBSITE##*//}centos/huangbo.html %æˆªå–ï¼Œåˆ é™¤å³è¾¹å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬åˆ¶å®šçš„åˆ†éš”ç¬¦ï¼‰ï¼Œä¿ç•™å·¦è¾¹å­—ç¬¦ä¸² root@cts1:~ # echo ${WEBSITE%//*}http://hadoop %%æˆªå–ï¼Œåˆ é™¤å³è¾¹å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬æŒ‡å®šçš„åˆ†éš”ç¬¦ï¼‰ï¼Œä¿ç•™å·¦è¾¹å­—ç¬¦ä¸²ï¼Œå’Œä¸Šè¾¹ä¸€ä¸ª%ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸€ç›´æ‰¾åˆ°æœ€å‰ï¼Œè€Œä¸æ˜¯åƒä¸€ä¸ª%é‚£æ ·æ‰¾åˆ°ä¸€ä¸ªå°±æ»¡è¶³æ¡ä»¶é€€å‡ºäº†ã€‚ root@cts1:~ # echo ${WEBSITE%%//*}http: ä»Žå·¦è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä»¥åŠæˆªå–çš„å­—ç¬¦çš„ä¸ªæ•° root@cts1:~ # echo ${WEBSITE:2:2}tp ä»Žå·¦è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¸€ç›´åˆ°ç»“æŸ root@cts1:~ # echo ${WEBSITE:2}tp://hadoop//centos/huangbo.html ä»Žå³è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä»¥åŠå­—ç¬¦çš„ä¸ªæ•°, ä»Ž-4å¼€å§‹, è¿˜æ˜¯å¾€å³è¾¹æˆªå– root@cts1:~ # echo ${WEBSITE:0-4:2 ht ä»Žå³è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¸€ç›´åˆ°ç»“æŸ root@cts1:~ # echo ${WEBSITE:0-4}html åˆ©ç”¨awkè¿›è¡Œå­—ç¬¦ä¸²æˆªå– echo $WEBSITE | awk â€˜{print substr($1,2,6)}â€™ ttp:// åˆ©ç”¨cutè¿›è¡Œå­—ç¬¦ä¸²æˆªå– root@cts1:~ # echo $WEBSITE | cut -b 1-4 http èŽ·å–æœ€åŽå‡ ä¸ªå­—ç¬¦ root@cts1:~ # echo ${WEBSITE:(-3)} tml æˆªå–ä»Žå€’æ•°ç¬¬3ä¸ªå­—ç¬¦åŽçš„2ä¸ªå­—ç¬¦ root@cts1:~ # echo ${WEBSITE:(-3):2}tm å­—ç¬¦ä¸²æ›¿æ¢ä½¿ç”¨æ ¼å¼ ${parameter/pattern/string} ä¾‹å­12345678910# å®šä¹‰å˜é‡VARï¼š[linux@linux ~]$ VAR="hello tom, hello kitty, hello xiaoming"# æ›¿æ¢ç¬¬ä¸€ä¸ªhello, ç”¨`/`ï¼š[linux@linux ~]$ echo $&#123;VAR/hello/hi&#125;hi tom, hello kitty, hello xiaoming# æ›¿æ¢æ‰€æœ‰hello, ç”¨'//'ï¼š[linux@linux ~]$ echo $&#123;VAR//hello/hi&#125;hi tom, hi kitty, hi xiaoming èŽ·å–å­—ç¬¦ä¸²é•¿åº¦åœ¨æ­¤ä¸ºå¤§å®¶æä¾›äº”ç§æ–¹å¼èŽ·å–æŸå­—ç¬¦ä¸²çš„é•¿åº¦ 123456789101112131415161718192021222324252627282930313233343536# åœ¨æ­¤ä¸ºå¤§å®¶æä¾›äº”ç§æ–¹å¼èŽ·å–æŸå­—ç¬¦ä¸²çš„é•¿åº¦# 1. ä½¿ç”¨wc -Lå‘½ä»¤+----------------------------------------------------+| echo $&#123;WEBSITE&#125; |wc -L || || 35 |+----------------------------------------------------+# 2. ä½¿ç”¨exprçš„æ–¹å¼åŽ»è®¡ç®—+---------------------------------------------------+| expr length $&#123;WEBSITE&#125; || || 35 |+---------------------------------------------------+# 3. é€šè¿‡awk + lengthçš„æ–¹å¼èŽ·å–å­—ç¬¦ä¸²é•¿åº¦+---------------------------------------------------------------------------+|echo $&#123;WEBSITE&#125; | awk '&#123;print length($0)&#125;' || || 35 |+---------------------------------------------------------------------------+# 4. é€šè¿‡awkçš„æ–¹å¼è®¡ç®—ä»¥**\"\"**åˆ†éš”çš„å­—æ®µä¸ªæ•°+-------------------------------------------------------------------------+| echo $&#123;WEBSITE&#125; |awk -F "" '&#123;print NF&#125;' || || 35 |+-------------------------------------------------------------------------+# 5. é€šè¿‡\#çš„æ–¹å¼èŽ·å–å­—ç¬¦ä¸²ï¼ˆæœ€ç®€å•ï¼Œæœ€å¸¸ç”¨ï¼‰+----------------------------------------------+| echo $&#123;#WEBSITE&#125; || || 35 |+----------------------------------------------+ 4. è„šæœ¬è‡ªåŠ¨å®‰è£…MySqlè¿™é‡Œå…ˆåšä¸ªè®°å½•, ä¹‹åŽä¼šæ•´ç†ä¸€ä»½æ›´è¯¦ç»†çš„æ–‡æ¡£å‡ºæ¥.1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465#!/bin/bash## auto install mysql## å‡å¦‚æ˜¯ç¬¬äºŒæ¬¡è£…ï¼Œé‚£ä¹ˆè¦å…ˆåœæŽ‰æœåŠ¡ï¼Œå¹¶ä¸”å¸è½½ä¹‹å‰çš„mysqlservice mysql stopEXISTS_RPMS=`rpm -qa | grep -i mysql`echo $&#123;EXISTS_RPMS&#125;for RPM in $&#123;EXISTS_RPMS&#125;do rpm -e --nodeps $&#123;RPM&#125;done## åˆ é™¤æ®‹ç•™æ–‡ä»¶rm -fr /usr/lib/mysqlrm -fr /usr/include/mysqlrm -f /etc/my.cnfrm -fr /var/lib/mysql## ä»ŽæœåŠ¡å™¨èŽ·å–å®‰è£…mysqlçš„rpmåŒ…wget http://linux/soft/MySQL-client-5.6.26-1.linux_glibc2.5.x86_64.rpmwget http://linux/soft/MySQL-server-5.6.26-1.linux_glibc2.5.x86_64.rpm## åˆ é™¤ä¹‹å‰çš„å¯†ç æ–‡ä»¶ï¼Œä»¥å…äº§ç”Ÿå¹²æ‰°rm -rf /root/.mysql_secret## å®‰è£…æœåŠ¡å™¨rpm -ivh MySQL-server-5.6.26-1.linux_glibc2.5.x86_64.rpm## èŽ·å–åˆ°ç”Ÿæˆçš„éšæœºå¯†ç ##PSWD=`cat /root/.mysql_secret | awk -F ':' '&#123;print substr($4,2,16)&#125;'`PSWD=` grep -v '^$' /root/.mysql_secret | awk -F ':' '&#123;print substr($4,2,16)&#125;'`##PSWD=$&#123;PWD:1:16&#125;## å®‰è£…å®¢æˆ·ç«¯rpm -ivh MySQL-client-5.6.26-1.linux_glibc2.5.x86_64.rpm## ç„¶åŽåˆ é™¤åˆšåˆšä¸‹ä¸‹æ¥çš„rpmåŒ…rm -rf MySQL-client-5.6.26-1.linux_glibc2.5.x86_64.rpmrm -rf MySQL-server-5.6.26-1.linux_glibc2.5.x86_64.rpm## æç¤ºå®‰è£…çš„æ­¥éª¤éƒ½å®Œæˆäº†ã€‚echo "install mysql server and client is done .!!!!!!"## æ‰“å°å‡ºæ¥åˆšåˆšç”Ÿæˆçš„mysqlåˆå§‹å¯†ç echo "random password is:$&#123;PSWD&#125;"## å¼€å¯mysqlæœåŠ¡service mysql start# æ‰‹åŠ¨ç¬¬ä¸€æ¬¡ç™»é™†ï¼Œç„¶åŽæ”¹æŽ‰å¯†ç [root@hadoop bin]# mysql -uroot -pZjVIWvOGD18bT7oXmysql&gt; set PASSWORD=PASSWORD('root');# çŽ°åœ¨å°±å¯ä»¥å†™è„šæœ¬é“¾æŽ¥mysqlè¿›è¡Œæ“ä½œäº†[root@hadoop bin]# vi initMysql.sh#!/bin/bashmysql -uroot -proot &lt;&lt; EOF GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root' WITH GRANT OPTION; FLUSH PRIVILEGES; use mysql; select host, user, password from user;EOF]]></content>
      <categories>
        <category>Linux</category>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå­¦ä¹ ç¬”è®°-4]]></title>
    <url>%2F2018%2F05%2F28%2FLinux%2FLinux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-4%2F</url>
    <content type="text"><![CDATA[1ã€Linux shellç®€ä»‹1.1ã€Shellæ¦‚è¿°Shellæœ¬èº«æ˜¯ä¸€ä¸ªç”¨Cè¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œå®ƒæ˜¯ç”¨æˆ·ä½¿ç”¨Unix/Linuxçš„æ¡¥æ¢ï¼Œç”¨æˆ·çš„å¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯é€šè¿‡Shellå®Œæˆçš„ã€‚ Shellæ—¢æ˜¯ä¸€ç§å‘½ä»¤è¯­è¨€ï¼Œåˆæ˜¯ä¸€ç§ç¨‹åºè®¾è®¡è¯­è¨€ï¼š ä½œä¸ºå‘½ä»¤è¯­è¨€ï¼Œå®ƒäº¤äº’å¼åœ°è§£é‡Šå’Œæ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ï¼› ä½œä¸ºç¨‹åºè®¾è®¡è¯­è¨€ï¼Œå®ƒå®šä¹‰äº†å„ç§å˜é‡å’Œå‚æ•°ï¼Œå¹¶æä¾›äº†è®¸å¤šåœ¨é«˜çº§è¯­è¨€ä¸­æ‰å…·æœ‰çš„æŽ§åˆ¶ç»“æž„ï¼ŒåŒ…æ‹¬å¾ªçŽ¯å’Œåˆ†æ”¯ã€‚ Shellå®ƒè™½ç„¶ä¸æ˜¯Unix/Linuxç³»ç»Ÿå†…æ ¸çš„ä¸€éƒ¨åˆ†ï¼Œä½†å®ƒè°ƒç”¨äº†ç³»ç»Ÿæ ¸å¿ƒçš„å¤§éƒ¨åˆ†åŠŸèƒ½æ¥æ‰§è¡Œç¨‹åºã€å»ºç«‹æ–‡ä»¶å¹¶ä»¥å¹¶è¡Œçš„æ–¹å¼åè°ƒå„ä¸ªç¨‹åºçš„è¿è¡Œã€‚Shellæ˜¯ç”¨æˆ·ä¸Žå†…æ ¸è¿›è¡Œäº¤äº’æ“ä½œçš„ä¸€ç§æŽ¥å£ï¼Œç›®å‰æœ€æµè¡Œçš„Shellç§°ä¸ºbash Shellï¼ˆBourne Again Shellï¼‰ Shellæ˜¯ä¸€é—¨ç¼–ç¨‹è¯­è¨€(è§£é‡Šåž‹çš„ç¼–ç¨‹è¯­è¨€)ï¼Œå³shellè„šæœ¬(å°±æ˜¯åœ¨ç”¨linuxçš„shellå‘½ä»¤ç¼–ç¨‹)ï¼ŒShellè„šæœ¬ç¨‹åºä»Žè„šæœ¬ä¸­ä¸€è¡Œä¸€è¡Œè¯»å–å¹¶æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œç›¸å½“äºŽä¸€ä¸ªç”¨æˆ·æŠŠè„šæœ¬ä¸­çš„å‘½ä»¤ä¸€è¡Œä¸€è¡Œæ•²åˆ°Shellæç¤ºç¬¦ä¸‹æ‰§è¡Œ Shellæ˜¯ä¸€ç§è„šæœ¬è¯­è¨€ï¼Œé‚£ä¹ˆï¼Œå°±å¿…é¡»æœ‰è§£é‡Šå™¨æ¥æ‰§è¡Œè¿™äº›è„šæœ¬ Unix/Linuxä¸Šå¸¸è§çš„Shellè„šæœ¬è§£é‡Šå™¨æœ‰bashã€shã€cshã€kshç­‰ï¼Œä¹ æƒ¯ä¸ŠæŠŠå®ƒä»¬ç§°ä½œä¸€ç§Shellã€‚æˆ‘ä»¬å¸¸è¯´æœ‰å¤šå°‘ç§Shellï¼Œå…¶å®žè¯´çš„æ˜¯Shellè„šæœ¬è§£é‡Šå™¨ï¼Œå¯ä»¥é€šè¿‡cat /etc/shellså‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿä¸­å®‰è£…çš„shellï¼Œä¸åŒçš„shellå¯èƒ½æ”¯æŒçš„å‘½ä»¤è¯­æ³•æ˜¯ä¸ç›¸åŒçš„ shæ˜¯Unix æ ‡å‡†é»˜è®¤çš„shellï¼Œç”±Steve Bourneå¼€å‘ï¼Œæ˜¯Bourne Shellçš„ç¼©å†™ã€‚ bashæ˜¯Linuxæ ‡å‡†é»˜è®¤çš„shellï¼Œæœ¬æ•™ç¨‹ä¹ŸåŸºäºŽbashè®²è§£ã€‚bashç”±Brian Foxå’ŒChet Rameyå…±åŒå®Œæˆï¼Œæ˜¯Bourne Again Shellçš„ç¼©å†™ã€‚ Shellæœ¬èº«æ”¯æŒçš„å‘½ä»¤å¹¶ä¸å¤šï¼Œå†…éƒ¨å‘½ä»¤ä¸€å…±æœ‰40ä¸ªï¼Œä½†æ˜¯å®ƒå¯ä»¥è°ƒç”¨å…¶ä»–çš„ç¨‹åºï¼Œæ¯ä¸ªç¨‹åºå°±æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œè¿™ä½¿å¾—Shellå‘½ä»¤çš„æ•°é‡å¯ä»¥æ— é™æ‰©å±•ï¼Œå…¶ç»“æžœå°±æ˜¯Shellçš„åŠŸèƒ½éžå¸¸å¼ºå¤§ï¼Œå®Œå…¨èƒ½å¤Ÿèƒœä»»Linuxçš„æ—¥å¸¸ç®¡ç†å·¥ä½œï¼Œå¦‚æ–‡æœ¬æˆ–å­—ç¬¦ä¸²æ£€ç´¢ã€æ–‡ä»¶çš„æŸ¥æ‰¾æˆ–åˆ›å»ºã€å¤§è§„æ¨¡è½¯ä»¶çš„è‡ªåŠ¨éƒ¨ç½²ã€æ›´æ”¹ç³»ç»Ÿè®¾ç½®ã€ç›‘æŽ§æœåŠ¡å™¨æ€§èƒ½ã€å‘é€æŠ¥è­¦é‚®ä»¶ã€æŠ“å–ç½‘é¡µå†…å®¹ã€åŽ‹ç¼©æ–‡ä»¶ç­‰ã€‚ 1.2ã€ShellåŸºæœ¬æ ¼å¼ä»£ç å†™åœ¨æ™®é€šæ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œé€šå¸¸ä»¥.shç»“å°¾ï¼Œè™½ç„¶ä¸æ˜¯å¼ºåˆ¶è¦æ±‚ï¼Œä½†å¸Œæœ›å¤§å®¶æœ€å¥½è¿™ä¹ˆåš 12345vi helloworld.sh--------------------------#!/bin/bash ## è¡¨ç¤ºç”¨å“ªä¸€ç§shellè§£æžå™¨æ¥è§£æžæ‰§è¡Œæˆ‘ä»¬çš„è¿™ä¸ªè„šæœ¬ç¨‹åºï¼Œè¿™å¥è¯åªå¯¹è‡ªæ‰§è¡Œæœ‰æ•ˆï¼Œå¯¹äºŽä½¿ç”¨sh helloworld.shæ— æ•ˆecho "hello world" ## æ³¨é‡Šä¹Ÿå¯ä»¥å†™åœ¨è¿™é‡Œ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±å†™å¥½äº†ä¸€ä¸ªshellè„šæœ¬ï¼Œç¬¬ä¸€è¡Œæ˜¯å›ºå®šéœ€è¦çš„ï¼Œè¡¨æ˜Žç”¨å“ªä¸€ç§shellè§£æžå™¨æ¥æ‰§è¡Œæˆ‘ä»¬çš„è¿™ä¸ªè„šæœ¬ç¨‹åºã€‚æœ¬è´¨ä¸Šï¼Œshellè„šæœ¬é‡Œé¢çš„ä»£ç éƒ½æ˜¯å°±æ˜¯ä¸€äº›æµç¨‹æŽ§åˆ¶è¯­å¥åŠ ä¸€äº›ç‰¹æ®Šè¯­æ³•å†åŠ shell**å‘½ä»¤**ç»„æˆã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å½“åšæ¯ä¸€ä¸ªå‘½ä»¤å°±æ˜¯shellç¼–ç¨‹å½“ä¸­çš„å…³é”®å­—ã€‚ 1.3ã€Shellæ‰§è¡Œæ–¹å¼1 ã€sh æ–¹å¼æˆ–è€…bash æ–¹å¼ sh helloworld.sh bash helloworld.sh ## ç›´æŽ¥æŒ‡å®šç”¨ç³»ç»Ÿé»˜è®¤çš„bash shellè§£é‡Šæ‰§è¡Œ 2 ã€source æ–¹å¼æˆ–è€…. æ–¹å¼ sourceå‘½ä»¤ä¹Ÿç§°ä¸ºâ€œç‚¹å‘½ä»¤â€ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç‚¹ç¬¦å·ï¼ˆ.ï¼‰,æ˜¯bashçš„å†…éƒ¨å‘½ä»¤ã€‚ åŠŸèƒ½ï¼šä½¿Shellè¯»å…¥æŒ‡å®šçš„Shellç¨‹åºæ–‡ä»¶å¹¶ä¾æ¬¡æ‰§è¡Œæ–‡ä»¶ä¸­çš„æ‰€æœ‰è¯­å¥ sourceå‘½ä»¤é€šå¸¸ç”¨äºŽé‡æ–°æ‰§è¡Œåˆšä¿®æ”¹çš„åˆå§‹åŒ–æ–‡ä»¶ï¼Œä½¿ä¹‹ç«‹å³ç”Ÿæ•ˆï¼Œè€Œä¸å¿…æ³¨é”€å¹¶é‡æ–°ç™»å½•ã€‚ ç”¨æ³•ï¼š . helloworld.sh source helloworld.sh 3 ã€ç›´æŽ¥æ‰§è¡Œè¯¥è„šæœ¬æ–‡ä»¶ å¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸è¿‡è¿™ä¸¤ç§æ–¹å¼çš„æ‰§è¡Œï¼Œéƒ½éœ€è¦è¯¥æ–‡ä»¶æœ‰æ‰§è¡Œæƒé™ æ‰€ä»¥åœ¨æ‰§è¡Œä¹‹å‰ï¼Œæˆ‘ä»¬è¦æ›´æ”¹ä»–çš„æ‰§è¡Œæƒé™ 1ã€ åˆ‡æ¢åˆ°è¯¥æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„ç„¶åŽæ‰§è¡Œå‘½ä»¤ï¼š ./helloworld.sh 2ã€ ç›´æŽ¥ä»¥ç»å¯¹è·¯å¾„æ–¹å¼æ‰§è¡Œ /home/linux/hellworld.sh 1.4ã€Shellæ³¨é‡Šå•è¡Œæ³¨é‡Šï¼šShellè„šæœ¬ä¸­ä»¥#å¼€å¤´çš„ä»£ç å°±æ˜¯æ³¨é‡Š # xxx å¤šè¡Œæ³¨é‡Šï¼šShellè„šæœ¬ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨å¤šè¡Œæ³¨é‡Šï¼š:&lt;&lt;! xxx ! 2ã€ShellåŸºæœ¬è¯­æ³•2.1ã€å˜é‡2.1.1ã€ç³»ç»Ÿå˜é‡Linux Shellä¸­çš„å˜é‡åˆ†ä¸ºâ€œç³»ç»Ÿå˜é‡â€å’Œâ€œç”¨æˆ·è‡ªå®šä¹‰å˜é‡â€ ç³»ç»Ÿå˜é‡å¯ä»¥é€šè¿‡setå‘½ä»¤æŸ¥çœ‹ï¼Œç”¨æˆ·çŽ¯å¢ƒå˜é‡å¯ä»¥é€šè¿‡envæŸ¥çœ‹ï¼š å¸¸ç”¨ç³»ç»Ÿå˜é‡ï¼š\$PWD \$SHELL \$USER $HOME 2.1.2ã€è‡ªå®šä¹‰å˜é‡12345678910111213141516171819# 1.æ³¨æ„, å˜é‡ä¸­é—´ä¸èƒ½æœ‰ç©ºæ ¼A=123 echo $A# 2.å˜é‡ä¸­é—´æœ‰ç©ºæ ¼çš„è¯è¦åŠ å¼•å· - åŒå¼•å·ä¸­é—´å¯ä»¥å¼•ç”¨å˜é‡ a=zs b="this is $a" echo $b this is zs - å•å¼•å·å¼•ç”¨å˜é‡ä¼šåŽŸæ ·è¾“å‡º b='this is $a' echo $b this is $a # 3. è¦åœ¨å˜é‡åŽç›´æŽ¥è¿žæŽ¥å­—ç¬¦, è¦ç”¨&#123;&#125;æŠŠå˜é‡æ‹¬èµ·æ¥ $&#123;å˜é‡å&#125;å…¶å®ƒå­—ç¬¦ echo $&#123;A&#125;ddd helloddd 2.1.3ã€å˜é‡é«˜çº§ç”¨æ³• æ’¤é”€å˜é‡ï¼šunset ABC å£°æ˜Žé™æ€å˜é‡ï¼šreadonly ABC= â€˜abcâ€™ ç‰¹ç‚¹æ˜¯è¿™ç§å˜é‡æ˜¯åªè¯»çš„ï¼Œä¸èƒ½unset åœ¨ä¸€ä¸ª .sh ä¸­. ä»¥ç»å¯¹è·¯å¾„çš„å½¢å¼è°ƒå¦ä¸€ä¸ª .sh ä½¿ç”¨exportå…³é”®å­— export A=â€A in a.shâ€ æ„å‘³ç€æŠŠå˜é‡æå‡ä¸ºå½“å‰shell è¿›ç¨‹ä¸­çš„å…¨å±€çŽ¯å¢ƒå˜é‡ï¼Œå¯ä¾›å…¶ä»–å­shell ç¨‹åºä½¿ç”¨ï¼Œ A å˜é‡å°±æˆäº†a.sh è„šæœ¬æ‰€åœ¨bash è¿›ç¨‹çš„å…¨å±€å˜é‡ï¼Œè¯¥è¿›ç¨‹çš„æ‰€æœ‰å­è¿›ç¨‹éƒ½èƒ½è®¿é—®åˆ°å˜é‡A é€šè¿‡ . /root/bin/b.sh æˆ– source /root/bin/b.sh æ¥è°ƒç”¨ æ€»ç»“ï¼š a.shä¸­ç›´æŽ¥è°ƒç”¨b.shï¼Œä¼šè®©b.shåœ¨Aæ‰€åœ¨çš„bashè¿›ç¨‹çš„â€œå­è¿›ç¨‹â€ç©ºé—´ä¸­æ‰§è¡Œ è€Œå­è¿›ç¨‹ç©ºé—´åªèƒ½è®¿é—®çˆ¶è¿›ç¨‹ä¸­ç”¨exportå®šä¹‰çš„å˜é‡ ä¸€ä¸ªshellè¿›ç¨‹æ— æ³•å°†è‡ªå·±å®šä¹‰çš„å˜é‡æå‡åˆ°çˆ¶è¿›ç¨‹ç©ºé—´ä¸­åŽ» sourceæˆ–è€…â€œ.â€å·æ‰§è¡Œè„šæœ¬æ—¶ï¼Œä¼šè®©è„šæœ¬åœ¨è°ƒç”¨è€…æ‰€åœ¨çš„shellè¿›ç¨‹ç©ºé—´ä¸­æ‰§è¡Œ 2.1.4ã€åå¼•å·èµ‹å€¼ a=`ls -l /root/bin` ##åå¼•å·ï¼Œè¿è¡Œé‡Œé¢çš„å‘½ä»¤ï¼Œå¹¶æŠŠç»“æžœè¿”å›žç»™å˜é‡a å¦å¤–ä¸€ç§å†™æ³•ï¼ša=$(ls -l /root/bin) 2.1.5ã€å˜é‡æœ‰ç”¨æŠ€å·§ å½¢å¼ è¯´æ˜Ž ${var} å˜é‡æœ¬æ¥çš„å€¼ ${var:-word} å¦‚æžœå˜é‡ var ä¸ºç©ºæˆ–å·²è¢«åˆ é™¤(unset)ï¼Œé‚£ä¹ˆè¿”å›ž wordï¼Œä½†ä¸æ”¹å˜ var çš„å€¼ ${var:+word} å¦‚æžœå˜é‡ var è¢«å®šä¹‰ï¼Œé‚£ä¹ˆè¿”å›žwordï¼Œä½†ä¸æ”¹å˜ var çš„å€¼ ${var:=word} å¦‚æžœå˜é‡ var ä¸ºç©ºæˆ–å·²è¢«åˆ é™¤(unset)ï¼Œé‚£ä¹ˆè¿”å›ž wordï¼Œå¹¶å°† var çš„å€¼è®¾ç½®ä¸º word ${var:?message} å¦‚æžœå˜é‡ var ä¸ºç©ºæˆ–å·²è¢«åˆ é™¤(unset)ï¼Œé‚£ä¹ˆå°†æ¶ˆæ¯ message é€åˆ°æ ‡å‡†é”™è¯¯è¾“å‡ºï¼Œå¯ä»¥ç”¨æ¥æ£€æµ‹å˜é‡ var æ˜¯å¦å¯ä»¥è¢«æ­£å¸¸èµ‹å€¼ã€‚ è‹¥æ­¤æ›¿æ¢å‡ºçŽ°åœ¨Shellè„šæœ¬ä¸­ï¼Œé‚£ä¹ˆè„šæœ¬å°†åœæ­¢è¿è¡Œ 2.1.6 ç‰¹æ®Šå˜é‡ $? è¡¨ç¤ºä¸Šä¸€ä¸ªå‘½ä»¤é€€å‡ºçš„çŠ¶æ€ç  $$ è¡¨ç¤ºå½“å‰è¿›ç¨‹ç¼–å· $0 è¡¨ç¤ºå½“å‰è„šæœ¬åç§° $n è¡¨ç¤ºn ä½ç½®çš„è¾“å…¥å‚æ•°ï¼ˆn**ä»£è¡¨æ•°å­—ï¼Œn&gt;=1 ï¼‰** $# è¡¨ç¤ºå‚æ•°çš„ä¸ªæ•°ï¼Œå¸¸ç”¨äºŽå¾ªçŽ¯ $* å’Œ$@ éƒ½è¡¨ç¤ºå‚æ•°åˆ—è¡¨ æ³¨æ„ï¼š$*ä¸Ž$@åŒºåˆ« $* å’Œ $@ éƒ½è¡¨ç¤ºä¼ é€’ç»™å‡½æ•°æˆ–è„šæœ¬çš„æ‰€æœ‰å‚æ•°** ä¸è¢«åŒå¼•å·â€ â€œåŒ…å«æ—¶ $* å’Œ $@ éƒ½ä»¥\$1 \$2 â€¦ \$n çš„å½¢å¼ç»„æˆå‚æ•°åˆ—è¡¨ å½“å®ƒä»¬è¢«åŒå¼•å·â€ â€œåŒ…å«æ—¶ â€œ$*â€œ ä¼šå°†æ‰€æœ‰çš„å‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä»¥â€\$1 \$2 â€¦ \$nâ€çš„å½¢å¼ç»„æˆä¸€ä¸ªæ•´ä¸²ï¼› $* ä¼šå°†å„ä¸ªå‚æ•°åˆ†å¼€ï¼Œä»¥â€\$1â€ â€œ\$2â€ â€¦ â€œ\$nâ€ çš„å½¢å¼ç»„æˆä¸€ä¸ªå‚æ•°åˆ—è¡¨ 2.1.7 å˜é‡çš„å…¶ä»–æ³¨æ„ç‚¹ ä½¿ç”¨å˜é‡ ä½¿ç”¨ä¸€ä¸ªå®šä¹‰è¿‡çš„å˜é‡, åªéœ€è¦åœ¨å˜é‡åå‰é¢åŠ  $ ç¬¦å· å¦‚æžœå˜é‡åŽé¢ç›´æŽ¥è·Ÿä¸Šäº†å­—ç¬¦ä¸², å°±å¿…é¡»è¦åŠ èŠ±æ‹¬å· æŽ¨èç»™æ‰€æœ‰å˜é‡åŠ ä¸ŠèŠ±æ‹¬å·, è¿™ä¸ªæ˜¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ å·²å®šä¹‰çš„éžåªè¯»å˜é‡, å¯ä»¥è¢«é‡æ–°å®šä¹‰ åªè¯»å˜é‡ ä½¿ç”¨ readonly å‘½ä»¤å¯ä»¥å°†å˜é‡å®šä¹‰ä¸ºåªè¯»å˜é‡ï¼Œåªè¯»å˜é‡çš„å€¼ä¸èƒ½è¢«æ”¹å˜ã€‚ 1234567#!/bin/bashmyUrl="http://www.w3cschool.cc"readonly myUrlmyUrl="http://www.runoob.com"---# ä¼šæŠ¥é”™zsh: read-only variable: myUrl åˆ é™¤å˜é‡, åªè¯»å˜é‡ä¸èƒ½åˆ é™¤, å˜é‡è¢«åˆ é™¤åŽä¸èƒ½å†æ¬¡ä½¿ç”¨ 1unset variable_name å˜é‡ç±»åž‹ 1) å±€éƒ¨å˜é‡ å±€éƒ¨å˜é‡åœ¨è„šæœ¬æˆ–å‘½ä»¤ä¸­å®šä¹‰ï¼Œä»…åœ¨å½“å‰shellå®žä¾‹ä¸­æœ‰æ•ˆï¼Œå…¶ä»–shellå¯åŠ¨çš„ç¨‹åºä¸èƒ½è®¿é—®å±€éƒ¨å˜é‡ã€‚ 2) çŽ¯å¢ƒå˜é‡ æ‰€æœ‰çš„ç¨‹åºï¼ŒåŒ…æ‹¬shellå¯åŠ¨çš„ç¨‹åºï¼Œéƒ½èƒ½è®¿é—®çŽ¯å¢ƒå˜é‡ï¼Œæœ‰äº›ç¨‹åºéœ€è¦çŽ¯å¢ƒå˜é‡æ¥ä¿è¯å…¶æ­£å¸¸è¿è¡Œã€‚å¿…è¦çš„æ—¶å€™shellè„šæœ¬ä¹Ÿå¯ä»¥å®šä¹‰çŽ¯å¢ƒå˜é‡ã€‚ 3) shellå˜é‡ shellå˜é‡æ˜¯ç”±shellç¨‹åºè®¾ç½®çš„ç‰¹æ®Šå˜é‡ã€‚shellå˜é‡ä¸­æœ‰ä¸€éƒ¨åˆ†æ˜¯çŽ¯å¢ƒå˜é‡ï¼Œæœ‰ä¸€éƒ¨åˆ†æ˜¯å±€éƒ¨å˜é‡ï¼Œè¿™äº›å˜é‡ä¿è¯äº†shellçš„æ­£å¸¸è¿è¡Œ 2.18 å­—ç¬¦ä¸²èŽ·å–å­—ç¬¦ä¸²é•¿åº¦12string="abcd"echo $&#123;#string&#125; #è¾“å‡º 4 æå–å­å­—ç¬¦ä¸²ä»¥ä¸‹å®žä¾‹ä»Žå­—ç¬¦ä¸²ç¬¬ 2 ä¸ªå­—ç¬¦å¼€å§‹æˆªå– 4 ä¸ªå­—ç¬¦ï¼š 12string="runoob is a great site"echo $&#123;string:1:4&#125; # è¾“å‡º unoo æŸ¥æ‰¾å­å­—ç¬¦ä¸²æŸ¥æ‰¾å­—ç¬¦ â€œi æˆ– sâ€œ çš„ä½ç½®ï¼š 12string="runoob is a great company"echo `expr index "$string" is` # è¾“å‡º 8 2.19 Shell æ•°ç»„ bashæ”¯æŒä¸€ç»´æ•°ç»„ï¼ˆä¸æ”¯æŒå¤šç»´æ•°ç»„ï¼‰ï¼Œå¹¶ä¸”æ²¡æœ‰é™å®šæ•°ç»„çš„å¤§å°ã€‚ ç±»ä¼¼ä¸ŽCè¯­è¨€ï¼Œæ•°ç»„å…ƒç´ çš„ä¸‹æ ‡ç”±0å¼€å§‹ç¼–å·ã€‚èŽ·å–æ•°ç»„ä¸­çš„å…ƒç´ è¦åˆ©ç”¨ä¸‹æ ‡ï¼Œä¸‹æ ‡å¯ä»¥æ˜¯æ•´æ•°æˆ–ç®—æœ¯è¡¨è¾¾å¼ï¼Œå…¶å€¼åº”å¤§äºŽæˆ–ç­‰äºŽ0ã€‚ å®šä¹‰æ•°ç»„åœ¨Shellä¸­ï¼Œç”¨æ‹¬å·æ¥è¡¨ç¤ºæ•°ç»„ï¼Œæ•°ç»„å…ƒç´ ç”¨â€ç©ºæ ¼â€ç¬¦å·åˆ†å‰²å¼€ã€‚å®šä¹‰æ•°ç»„çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š 1æ•°ç»„å=(å€¼1 å€¼2 ... å€¼n) è¿˜å¯ä»¥å•ç‹¬å®šä¹‰æ•°ç»„çš„å„ä¸ªåˆ†é‡ï¼š 123array_name[0]=value0array_name[1]=value1array_name[n]=valuen å¯ä»¥ä¸ä½¿ç”¨è¿žç»­çš„ä¸‹æ ‡ï¼Œè€Œä¸”ä¸‹æ ‡çš„èŒƒå›´æ²¡æœ‰é™åˆ¶ã€‚ èŽ·å–æ•°ç»„çš„é•¿åº¦ èŽ·å–æ•°ç»„é•¿åº¦çš„æ–¹æ³•ä¸ŽèŽ·å–å­—ç¬¦ä¸²é•¿åº¦çš„æ–¹æ³•ç›¸åŒï¼Œä¾‹å¦‚ï¼š 123456# å–å¾—æ•°ç»„å…ƒç´ çš„ä¸ªæ•°length=$&#123;#array_name[@]&#125;# æˆ–è€…length=$&#123;#array_name[*]&#125;# å–å¾—æ•°ç»„å•ä¸ªå…ƒç´ çš„é•¿åº¦lengthn=$&#123;#array_name[n]&#125; 2.2ã€è¿ç®—ç¬¦2.2.1ã€ç®—æ•°è¿ç®—ç¬¦1. ç”¨expr12345678æ ¼å¼ expr m + n æ³¨æ„exprè¿ç®—ç¬¦é—´è¦æœ‰ç©ºæ ¼ä¾‹å¦‚è®¡ç®—ï¼ˆ2ï¼‹3ï¼‰Ã—4 çš„å€¼1ã€åˆ†æ­¥è®¡ç®— S=`expr 2 + 3` expr $S \* 4 ## *å·éœ€è¦è½¬ä¹‰2ã€ä¸€æ­¥å®Œæˆè®¡ç®— expr `expr 2 + 3 ` \* 4 echo `expr \`expr 2 + 3\` \* 4` ç”¨exprè¿˜å¯ä»¥è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå­å­—ç¬¦ä¸²å‡ºçŽ°çš„ä½ç½®ï¼Œæˆªå–å­—ç¬¦ä¸²ç­‰ç­‰ 123456789cts1 ~ # name='woshishuaige'cts1 ~ # expr length name4cts1 ~ # expr length $name12cts1 ~ # expr index $name shuai3cts1 ~ # expr substr $name 6 2sh è¯¦æƒ…è¯·ç¿»é˜…: expr â€“help 2. ç”¨(())12345678((1+2))(((2+3)*4))count=1((count++))((++count))echo $count# ä½†æ˜¯è¦æƒ³å–åˆ°è¿ç®—ç»“æžœï¼Œéœ€è¦ç”¨$å¼•ç”¨a=$((1+2)) 3. ç”¨\$[]12345SS=$[2+3]echo $SSSS=$[2*3]echo $SSecho $[(2 + 3)*3] 4. ç”¨let1234first=1second=2let third=first+secondecho $&#123;third&#125; 5. ç”¨ | bcä»¥ä¸Šå‘½ä»¤éƒ½åªå¯¹æ•´å½¢æ•°å€¼æœ‰æ•ˆï¼Œä¸é€‚ç”¨äºŽæµ®ç‚¹æ•° å¦‚æžœæœ‰æµ®ç‚¹æ•°å‚ä¸Žè¿ç®—ï¼Œå¯ä»¥å°†echoä¸Žbcå‘½ä»¤ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œä»£ç å¦‚ä¸‹ 123456echo "1.212*3" | bc ## ç®€å•æµ®ç‚¹è¿ç®—echo "scale=2;3/8" | bc ##å°†è¾“å‡ºç»“æžœè®¾ç½®ä¸º2ä½echo "obase=2;127" | bc ##è¾“å‡ºè¿ç®—ç»“æžœçš„äºŒè¿›åˆ¶echo "obase=10;ibase=2;101111111" | bc ##å°†äºŒè¿›åˆ¶è½¬æ¢æˆåè¿›åˆ¶echo "10^10" | bc ##æ±‚å¹‚æŒ‡æ•°echo "sqrt(100)" | bc ##å¼€å¹³æ–¹ é™¤äº†ç”¨bcåšå°½èŒè½¬æ¢ä»¥å¤–ï¼Œè¿˜å¯ä»¥è¿™æ ·åšï¼š 12345echo $((base#number)) è¡¨ç¤ºæŠŠä»»æ„baseè¿›åˆ¶çš„æ•°numberè½¬æ¢æˆåè¿›åˆ¶ä¾‹å­ï¼šecho $((8#377)) è¿”å›ž255echo $((025)) è¿”å›ž21 ï¼Œ å…«è¿›åˆ¶echo $((0xA4)) è¿”å›ž164 ï¼Œ åå…­è¿›åˆ¶ ä½¿ç”¨bcè¿˜å¯ä»¥ç”¨æ¥æ¯”è¾ƒæµ®ç‚¹æ•°çš„å¤§å°ï¼š 12345678910111213[root@hadoop02 bin]# echo "1.2 &lt; 2" |bc1[root@hadoop02 bin]# echo "1.2 &gt; 2" |bc0[root@hadoop02 bin]# echo "1.2 == 2.2" |bc0[root@hadoop02 bin]# echo "1.2 != 2.2" |bc1çœ‹å‡ºè§„å¾‹äº†å˜›ï¼Ÿè¿ç®—å¦‚æžœä¸ºçœŸè¿”å›ž 1ï¼Œå¦åˆ™è¿”å›ž 0ï¼Œå†™ä¸€ä¸ªä¾‹å­ï¼š[root@hadoop02 bin]# [ $(echo "2.2 &gt; 2" |bc) -eq 1 ] &amp;&amp; echo yes || echo noyes[root@hadoop02 bin]# [ $(echo "2.2 &lt; 2" |bc) -eq 1 ] &amp;&amp; echo yes || echo nono 2.2.2ã€å…³ç³»è¿ç®—ç¬¦ä¸‹é¢ç»™å‡ºä¸€å¼ å…³ç³»è¿ç®—ç¬¦çš„åˆ—è¡¨ï¼š è¿ç®—ç¬¦ ç­‰åŒè¿ç®—ç¬¦ è¯´æ˜Ž -eq = æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å›žtrue -ne != æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å›žtrue -ge &gt;= æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§ç­‰äºŽå³è¾¹çš„ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -gt &gt; æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºŽå³è¾¹çš„ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -le &lt;= æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºŽç­‰äºŽå³è¾¹çš„ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -lt &lt; æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºŽå³è¾¹çš„ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue 2.2.3ã€å¸ƒå°”è¿ç®—ç¬¦ è¿ç®—ç¬¦ ç­‰åŒè¿ç®—ç¬¦ è¯´æ˜Ž ! ! éžè¿ç®—ï¼Œè¡¨è¾¾å¼ä¸º true åˆ™è¿”å›žfalseï¼Œå¦åˆ™è¿”å›žtrue -a &amp;&amp; ä¸Žè¿ç®—ï¼Œä¸¤ä¸ªè¡¨è¾¾å¼éƒ½ä¸ºtrue æ‰è¿”å›žtrue -o \ \ æˆ–è¿ç®—ï¼Œæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ä¸ºtrue åˆ™è¿”å›žtrue 2.2.4ã€å­—ç¬¦ä¸²è¿ç®—ç¬¦ è¿ç®—ç¬¦ è¯´æ˜Ž = æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å›žtrue != æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å›žtrue -z æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º0ï¼Œä¸º0è¿”å›žtrue -n æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º0ï¼Œä¸ä¸º0è¿”å›žtrue str æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºè¿”å›žtrue 2.2.5ã€æ–‡ä»¶è¿ç®—ç¬¦ è¿ç®—ç¬¦ è¯´æ˜Ž -d æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯ç›®å½•ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -f æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æ™®é€šæ–‡ä»¶ï¼ˆæ—¢ä¸æ˜¯ç›®å½•ï¼Œä¹Ÿä¸æ˜¯è®¾å¤‡æ–‡ä»¶ï¼‰ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -e æ£€æµ‹æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç›®å½•ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -s æ£€æµ‹æ–‡ä»¶æ˜¯å¦ä¸ºç©ºï¼ˆæ–‡ä»¶å¤§å°æ˜¯å¦å¤§äºŽ0ï¼‰ï¼Œä¸ä¸ºç©ºè¿”å›žtrue -r æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯è¯»ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -w æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯å†™ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -x æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -b æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å—è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue -c æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¿”å›žtrue 2.3ã€æµç¨‹æŽ§åˆ¶2.3.1ã€ifif.. then ..elif.. then.. else..fi123456789101112131415161718192021222324252627282930313233343536# ifè¯­æ³•æ ¼å¼ï¼šif conditionthen statements [elif condition then statements. ..] [else statements ] fi# ç¤ºä¾‹ç¨‹åºï¼š[root@hadoop02 bin]# vi g.sh#!/bin/bash## read a value for NAME from stdinread -p "please input your name:" NAME## printf '%s\n' $NAMEif [ $NAME = root ]thenecho "hello $&#123;NAME&#125;, welcome !"elif [ $NAME = hadoop ]then echo "hello $&#123;NAME&#125;, welcome !"else echo "I donâ€™t know you !"fi## è§„åˆ™è§£é‡Š[ condition ] (æ³¨ï¼šconditionå‰åŽè¦æœ‰ç©ºæ ¼)#éžç©ºè¿”å›žtrueï¼Œå¯ä½¿ç”¨$?éªŒè¯ï¼ˆ0ä¸ºtrueï¼Œ&gt;1ä¸ºfalseï¼‰[ hadoop ]#ç©ºè¿”å›žfalse[ ]# æ³¨æ„[ ]å†…éƒ¨çš„=å‘¨è¾¹çš„ç©ºæ ¼ ä¸‰å…ƒè¿ç®—ç¬¦12[ condition ] &amp;&amp; echo OK || echo notok# æ¡ä»¶æ»¡è¶³ï¼Œæ‰§è¡Œ&amp;&amp;åŽé¢çš„è¯­å¥ï¼›æ¡ä»¶ä¸æ»¡è¶³ï¼Œæ‰§è¡Œ||åŽé¢çš„è¯­å¥ æ¡ä»¶åˆ¤æ–­ç»„åˆ æ¡ä»¶åˆ¤æ–­ç»„åˆæœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š [] å’Œ [[]] æ³¨æ„å®ƒä»¬çš„åŒºåˆ«ï¼š [[ ]] ä¸­é€»è¾‘ç»„åˆå¯ä»¥ä½¿ç”¨ &amp;&amp; || ç¬¦å· [] é‡Œé¢é€»è¾‘ç»„åˆå¯ä»¥ç”¨ -a -o å¸¸ç”¨åˆ¤æ–­è¿ç®—ç¬¦1. å­—ç¬¦ä¸²æ¯”è¾ƒ = åˆ¤æ–­ç›¸ç­‰!= åˆ¤æ–­ä¸ç›¸ç­‰-z å­—ç¬¦ä¸²é•¿åº¦æ˜¯ä¸º0è¿”å›žtrue-n å­—ç¬¦ä¸²é•¿åº¦æ˜¯ä¸ä¸º0è¿”å›žtrue 2. æ•´æ•°æ¯”è¾ƒ -lt å°äºŽ less than -le å°äºŽç­‰äºŽ -eq ç­‰äºŽ -gt å¤§äºŽ great than -ge å¤§äºŽç­‰äºŽ -ne ä¸ç­‰äºŽ 3. æ–‡ä»¶åˆ¤æ–­ -d æ˜¯å¦ä¸ºç›®å½• if [ -d /bin ]; then echo ok; else echo notok;fi -f æ˜¯å¦ä¸ºæ–‡ä»¶ if [ -f /bin/ls ]; then echo ok; else echo notok;fi -e æ˜¯å¦å­˜åœ¨ if [ -e /bin/ls ]; then echo ok; else echo notok;fi 2.3.2ã€while1234567891011121314151617181920212223242526while expressiondo command â€¦â€¦done----------------------i=1while ((i&lt;=3))do echo $i let i++done----------------------#!/bin/bashi=1while [ $i -le 3 ]do echo $i let i++done# å‘½ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæŽ§åˆ¶è¿”å›žå¾ªçŽ¯é¡¶éƒ¨ï¼Œä»Žå¤´å¼€å§‹ç›´è‡³æµ‹è¯•æ¡ä»¶ä¸ºå‡# æ¢ç§æ–¹å¼ï¼šå¾ªçŽ¯ä½“ä¼šä¸€ç›´æ‰§è¡Œï¼Œç›´åˆ°æ¡ä»¶è¡¨è¾¾å¼expressionä¸ºfalse# æ³¨æ„ï¼šä¸Šè¿°let i++ å¯ä»¥å†™æˆ i=$(($i+1))æˆ–è€…i=$((i+1)) 2.3.3ã€caseCaseè¯­æ³•ï¼ˆé€šè¿‡ä¸‹é¢è¿™ä¸ªä¾‹å­å±•ç¤ºï¼‰ï¼š 12345678910case $1 instart) echo "starting" ;;stop) echo "stoping" ;;*) echo "Usage: &#123;start|stop&#125;"esac 2.3.4ã€forè¯­æ³•æ ¼å¼ï¼š 1234567for å˜é‡ in åˆ—è¡¨docommandâ€¦â€¦done# åˆ—è¡¨æ˜¯ä¸€ç»„å€¼ï¼ˆæ•°å­—ã€å­—ç¬¦ä¸²ç­‰ï¼‰ç»„æˆçš„åºåˆ—ï¼Œæ¯ä¸ªå€¼é€šè¿‡ç©ºæ ¼åˆ†éš”ã€‚æ¯å¾ªçŽ¯ä¸€æ¬¡ï¼Œå°±å°†åˆ—è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªå€¼èµ‹ç»™å˜é‡ ä¸‰ç§æ–¹å¼ 12345678# æ–¹å¼1for N in 1 2 3; do echo $N; done# æ–¹å¼2for N in &#123;1..3&#125;; do echo $N; done# æ–¹å¼3for ((i=0; i&lt;=2; i++)); do echo "welcome $i times"; done 2.3.5ã€utilè¯­æ³•ç»“æž„ï¼š 123456789101112131415161718192021222324until expressiondo command â€¦â€¦done# expressionä¸€èˆ¬ä¸ºæ¡ä»¶è¡¨è¾¾å¼ï¼Œå¦‚æžœè¿”å›žå€¼ä¸º falseï¼Œåˆ™ç»§ç»­æ‰§è¡Œå¾ªçŽ¯ä½“å†…çš„è¯­å¥ï¼Œå¦åˆ™è·³å‡ºå¾ªçŽ¯ã€‚# æ¢ç§æ–¹å¼è¯´ï¼šå¾ªçŽ¯ä½“ä¼šä¸€ç›´æ‰§è¡Œï¼Œç›´åˆ°æ¡ä»¶è¡¨è¾¾å¼expressionä¸ºtrue## ç¤ºä¾‹#!/bin/bash## vi util.sha=0until [ ! $a -lt 3 ]do echo $a a=`expr $a + 1`done----è¾“å‡º: 012 2.4ã€æ•°ç»„åœ¨Shellä¸­ï¼Œç”¨æ‹¬å·æ¥è¡¨ç¤ºæ•°ç»„ï¼Œæ•°ç»„å…ƒç´ ç”¨â€œç©ºæ ¼â€ç¬¦å·åˆ†å‰²å¼€ã€‚å®šä¹‰æ•°ç»„çš„ä¸€èˆ¬å½¢å¼ä¸º 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061array_name=(value1 ... valuen)ä¾‹å­ï¼šmingxing=(huangbo xuzheng wangbaoqiang)ä¹Ÿå¯ä»¥å•ç‹¬å®šä¹‰ï¼šmingxing[3]=liujialingè¯»å–æ•°ç»„å…ƒç´ çš„æ ¼å¼æ˜¯ï¼š$&#123;array_name[index]&#125;============================================# èŽ·å–æ•°ç»„ä¸‹æ ‡ï¼š å‰é¢åŠ  `!`[linux@linux ~]$ echo $&#123;!mingxing[@]&#125; æˆ–è€…[linux@linux ~]$ echo $&#123;!mingxing[*]&#125;---è¾“å‡º: 0 1 2 3============================================# è¾“å‡ºæ•°ç»„çš„æ‰€æœ‰å…ƒç´ ï¼šç›´æŽ¥å–å€¼[linux@linux ~]$ echo $&#123;mingxing[*]&#125;[linux@linux ~]$ echo $&#123;mingxing[@]&#125;============================================# èŽ·å–æ•°ç»„çš„é•¿åº¦ï¼š`#` [linux@linux ~]$ echo $&#123;#mingxing[*]&#125;[linux@linux ~]$ echo $&#123;#mingxing[@]&#125;============================================# æ•°ç»„å¯¹æŽ¥: æ·»åŠ æ–°çš„å€¼[linux@linux ~]$ mingxing+=(liuyifei liuyufeng)============================================# åˆ é™¤æ•°ç»„å…ƒç´ ï¼Œä½†æ˜¯ä¼šä¿ç•™æ•°ç»„å¯¹åº”ä½ç½®ï¼Œå°±æ˜¯è¯¥å€¼çš„ä¸‹æ ‡ä¾ç„¶ä¼šä¿ç•™ï¼Œä¼šç©ºç€ï¼Œä¹‹åŽï¼Œè¿˜å¯ä»¥å¡«å……å…¶ä»–çš„å€¼è¿›æ¥ã€‚# åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼šä¹‹åŽ $&#123;mingxing[0]&#125; å°±æ˜¯ç©ºå€¼äº†[linux@linux ~]$ unset mingxing[0]============================================# éåŽ†æ•°ç»„ï¼š#!/bin/bashIP=(192.168.1.1 192.168.1.2 192.168.1.3)# ç¬¬ä¸€ç§æ–¹å¼for ((i=0;i&lt;$&#123;#IP[*]&#125;;i++))doecho $&#123;IP[$i]&#125;done#ç¬¬äºŒç§æ–¹å¼for ip in $&#123;IP[*]&#125;do echo $ipdone============================================# æ•°ç»„çš„åˆ†ç‰‡ï¼š$&#123;arr[@]:number1:number2&#125;è¿™é‡Œnumber1ä»Žä¸‹æ ‡number1å¼€å§‹å–å€¼ï¼Œnumber2å¾€åŽå–å‡ ä¸ªå…ƒç´ ï¼Œå³å–åˆ°çš„æ–°çš„æ•°ç»„çš„é•¿åº¦---cts1 ~ # arr=(1 2 3 4 5 6 7)cts1 ~ # echo "&#123;arr[@]:0:3&#125; --- $&#123;arr[@]:0:3&#125; "&#123;arr[@]:0:3&#125; --- 1 2 3cts1 ~ # echo "&#123;arr[@]:3:3&#125; --- $&#123;arr[@]:3:3&#125; "&#123;arr[@]:3:3&#125; --- 4 5 6cts1 ~ # echo "&#123;arr[@]:4:3&#125; --- $&#123;arr[@]:4:3&#125; "&#123;arr[@]:4:3&#125; --- 5 6 7 2.5ã€å‡½æ•°ä½¿ç”¨å‡½æ•°çš„è¯­æ³•ä½¿ç”¨ç¤ºä¾‹ : 1234567891011121314[root@hadoop02 bin]# vi i.sh #!/bin/shhello()&#123; echo "`date +%Y-%m-%d`" # return 2&#125;helloecho â€œhuangboâ€ # echo $?A="mazhonghua"echo $A---æ‰§è¡Œç»“æžœ----â€œhuangboâ€mazhonghua å‡½æ•°çš„è°ƒç”¨æ–¹å¼å°±æ˜¯ç›´æŽ¥å†™å‡½æ•°åå°±OKäº† 123æ³¨æ„ï¼š1ã€å¿…é¡»åœ¨è°ƒç”¨å‡½æ•°åœ°æ–¹ä¹‹å‰ï¼Œå…ˆå£°æ˜Žå‡½æ•°ï¼Œshellè„šæœ¬æ˜¯é€è¡Œè¿è¡Œã€‚ä¸ä¼šåƒå…¶å®ƒè¯­è¨€ä¸€æ ·å…ˆé¢„ç¼–è¯‘2ã€å‡½æ•°è¿”å›žå€¼ï¼Œåªèƒ½é€šè¿‡$? ç³»ç»Ÿå˜é‡èŽ·å¾—ï¼Œå¯ä»¥æ˜¾ç¤ºåŠ ï¼šreturn è¿”å›žï¼Œå¦‚æžœä¸åŠ ï¼Œå°†ä»¥æœ€åŽä¸€æ¡å‘½ä»¤è¿è¡Œç»“æžœï¼Œä½œä¸ºè¿”å›žå€¼ã€‚ returnåŽè·Ÿæ•°å€¼n(0-255) è„šæœ¬è°ƒè¯•ï¼š ä½¿ç”¨-xé€‰é¡¹è·Ÿè¸ªè„šæœ¬è°ƒè¯•shellè„šæœ¬ï¼Œèƒ½æ‰“å°å‡ºæ‰€æ‰§è¡Œçš„æ¯ä¸€è¡Œå‘½ä»¤ä»¥åŠå½“å‰çŠ¶æ€ sh -x i.sh æˆ–è€…åœ¨ä»£ç ä¸­åŠ å…¥ï¼šset -x 12345678910111213cts1 Desktop # sh -x i.sh+ hello++ date +%Y-%m-%d+ echo 2018-05-292018-05-29+ return 2+ echo $'\342\200\234huangbo\342\200\235'â€œhuangboâ€+ echo 00+ A=mazhonghua+ echo mazhonghuamazhonghua 2.6ã€å‡½æ•°å‚æ•°ç›´æŽ¥ä¸Šä»£ç  123456789101112131415161718192021222324vim funcWithParam.sh--------shæ–‡ä»¶--------#!/bin/bash# filename=funcWithParamfuncWithParam()&#123; echo "ç¬¬ä¸€ä¸ªå‚æ•°ä¸º $1 !" echo "ç¬¬äºŒä¸ªå‚æ•°ä¸º $2 !" echo "ç¬¬åä¸ªå‚æ•°ä¸º $10 !" echo "ç¬¬åä¸ªå‚æ•°ä¸º $&#123;10&#125; !" echo "ç¬¬åä¸€ä¸ªå‚æ•°ä¸º $&#123;11&#125; !" echo "å‚æ•°æ€»æ•°æœ‰ $# ä¸ª!" echo "ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²è¾“å‡ºæ‰€æœ‰å‚æ•° $* !"&#125;funcWithParam 1 2 3 4 5 6 7 8 9 34 73--------------------# è°ƒç”¨cts1 Desktop # sh funcWithParam.shç¬¬ä¸€ä¸ªå‚æ•°ä¸º 1 !ç¬¬äºŒä¸ªå‚æ•°ä¸º 2 !ç¬¬åä¸ªå‚æ•°ä¸º 10 !ç¬¬åä¸ªå‚æ•°ä¸º 34 !ç¬¬åä¸€ä¸ªå‚æ•°ä¸º 73 !å‚æ•°æ€»æ•°æœ‰ 11 ä¸ª!ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²è¾“å‡ºæ‰€æœ‰å‚æ•° 1 2 3 4 5 6 7 8 9 34 73 ! 2.7ã€è·¨è„šæœ¬è°ƒç”¨å‡½æ•°ç¼–å†™ä¸€ä¸ªbase.shè„šæœ¬ï¼Œé‡Œé¢æ”¾æ”¾ä¸€ä¸ªtestå‡½æ•° 123456vim base.sh------#!/bin/bashtest()&#123; echo "hello"&#125; å†ç¼–å†™ä¸€ä¸ªother.shè„šæœ¬ï¼Œé‡Œé¢å¼•å…¥base.shè„šæœ¬ï¼Œå¹¶ä¸”è°ƒç”¨testå‡½æ•°ï¼š 12345678910111213vim other.sh--------#!/bin/bashsource base.sh ## å¼•å…¥è„šæœ¬test ##è°ƒç”¨å¼•å…¥è„šæœ¬å½“ä¸­çš„testå‡½æ•°============================================# æ‰§è¡Œcts1 Desktop # sh other.shother.sh: line 2: ./base.sh: æƒé™ä¸å¤Ÿcts1 Desktop # chmod 755 other.sh base.shcts1 Desktop # ./other.shhello 3ã€Shellç»¼åˆæ¡ˆä¾‹3.1ã€æ‰“å°9*9ä¹˜æ³•è¡¨ç¤ºä¾‹ä»£ç ï¼š 12345678910111213141516171819202122232425#!/bin/bashfor((i=1;i&lt;=9;++i))do for((j=1;j&lt;=i;j++)) do echo -ne "$i*$j=$((i*j))\t" done echodone# è§£é‡Š-n ä¸åŠ æ¢è¡Œç¬¦-e è§£é‡Šè½¬ä¹‰ç¬¦echo æ¢è¡Œæ•ˆæžœ: 1*1=12*1=2 2*2=43*1=3 3*2=6 3*3=94*1=4 4*2=8 4*3=12 4*4=165*1=5 5*2=10 5*3=15 5*4=20 5*5=256*1=6 6*2=12 6*3=18 6*4=24 6*5=30 6*6=367*1=7 7*2=14 7*3=21 7*4=28 7*5=35 7*6=42 7*7=498*1=8 8*2=16 8*3=24 8*4=32 8*5=40 8*6=48 8*7=56 8*8=649*1=9 9*2=18 9*3=27 9*4=36 9*5=45 9*6=54 9*7=63 9*8=72 9*9=81 3.2ã€è‡ªåŠ¨éƒ¨ç½²é›†ç¾¤çš„JDK1ã€ éœ€æ±‚æè¿° 12å…¬å¸å†…æœ‰ä¸€ä¸ªNä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ï¼Œéœ€è¦ç»Ÿä¸€å®‰è£…ä¸€äº›è½¯ä»¶ï¼ˆjdkï¼‰éœ€è¦å¼€å‘ä¸€ä¸ªè„šæœ¬ï¼Œå®žçŽ°å¯¹é›†ç¾¤ä¸­çš„Nå°èŠ‚ç‚¹æ‰¹é‡è‡ªåŠ¨ä¸‹è½½ã€å®‰è£…jdk 2ã€ æ€è·¯ æ€è€ƒä¸€ä¸‹ï¼šæˆ‘ä»¬çŽ°åœ¨æœ‰ä¸€ä¸ªJDKå®‰è£…åŒ…åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šã€‚é‚£æˆ‘ä»¬è¦å®žçŽ°è¿™ä¸ªç›®æ ‡ï¼š 1231ã€ æŠŠåŒ…ä¼ åˆ°æ¯å°æœåŠ¡å™¨ï¼Œæˆ–è€…é€šè¿‡æœ¬åœ°yumæºçš„æ–¹å¼åŽ»æœåŠ¡å™¨å–2ã€ ç»™æ¯å°ä¸€å°æœºå™¨å‘é€ä¸€ä¸ªå®‰è£…è„šæœ¬ï¼Œå¹¶ä¸”è®©è„šæœ¬è‡ªå·±æ‰§è¡Œ3. è¦å†™ä¸€ä¸ªå¯åŠ¨è„šæœ¬ï¼Œç”¨æ¥æ‰§è¡Œä»¥ä¸Šä¸¤éƒ¨æ“ä½œ 3ã€ Expect**çš„ä½¿ç”¨** è›‹ç–¼ç‚¹ï¼šå‡å¦‚åœ¨æ²¡æœ‰é…ç½®SSHå…å¯†ç™»å½•çš„å‰æä¸‹ï¼Œæˆ‘ä»¬è¦è¦æ˜¯scpå‘½ä»¤ä»Žä¸€å°æœºå™¨æ‹·è´æ–‡ä»¶å¤¹åˆ°å¦å¤–çš„æœºå™¨ï¼Œä¼šæœ‰äººæœºäº¤äº’è¿‡ç¨‹ï¼Œé‚£æˆ‘ä»¬æ€Žä¹ˆè®©æœºå™¨è‡ªå·±å®žçŽ°äººæœºäº¤äº’ï¼Ÿ çµä¸¹å¦™è¯ï¼šexpect å‘½ä»¤ æè¿° set å¯ä»¥è®¾ç½®è¶…æ—¶ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å˜é‡ timeout è¶…æ—¶ç­‰å¾…æ—¶é—´ï¼Œé»˜è®¤ 10s spawn æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ send æ‰§è¡Œäº¤äº’ï¼Œç›¸å½“äºŽæ‰‹åŠ¨è¾“å…¥ expect â€œâ€ï¼ˆexpectå†…éƒ¨å‘½ä»¤ï¼‰ åŒ¹é…è¾“å‡ºçš„å†…å®¹ exp_continue ç»§ç»­æ‰§è¡Œä¸‹é¢åŒ¹é… æ€è·¯ï¼šæ¨¡æ‹Ÿè¯¥äººæœºäº¤äº’è¿‡ç¨‹ï¼Œåœ¨éœ€è¦äº¤äº’çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡æˆ‘ä»¬çš„æ£€æµ‹ç»™è¾“å…¥æå‰å‡†å¤‡å¥½çš„å€¼å³å¯ ç¤ºä¾‹ï¼šè§‚çœ‹é…ç½®SSHå…å¯†ç™»å½•çš„è¿‡ç¨‹ å®žçŽ°è„šæœ¬ï¼š 123456789101112131415161718vi testExpect.sh## å®šä¹‰ä¸€ä¸ªå‡½æ•°sshcopyid()&#123; expect -c " spawn ssh-copy-id $1 expect &#123; \"(yes/no)?\" &#123;send \"yes\r\";exp_continue&#125; \"password:\" &#123;send \"$2\r\";exp_continue&#125; &#125; "&#125;## è°ƒç”¨å‡½æ•°æ‰§è¡Œsshcopyid $1 $2# æ³¨æ„ï¼šå¦‚æžœæœºå™¨æ²¡æœ‰expectï¼Œåˆ™è¯·å…ˆå®‰è£…expectyum install -y expect 4ã€ è„šæœ¬å®žçŽ° å¯åŠ¨è„šæœ¬initInstallJDK.sh 12345678910111213141516171819202122232425262728293031#!/bin/bashSERVERS="192.168.123.201"PASSWORD=hadoopBASE_SERVER=192.168.123.202auto_ssh_copy_id() &#123; expect -c "set timeout -1; spawn ssh-copy-id $1; expect &#123; *(yes/no)* &#123;send -- yes\r;exp_continue;&#125; *password:* &#123;send -- $2\r;exp_continue;&#125; eof &#123;exit 0;&#125; &#125;";&#125;ssh_copy_id_to_all() &#123; for SERVER in $SERVERS do auto_ssh_copy_id $SERVER $PASSWORD done&#125;ssh_copy_id_to_allfor SERVER in $SERVERSdo scp installJDK.sh root@$SERVER:/root ssh root@$SERVER chmod 755 installJDK.sh ssh root@$SERVER /root/installJDK.shdone å®‰è£…è„šæœ¬installJDK.sh 1234567891011#!/bin/bashBASE_SERVER=192.168.123.202yum install -y wgetwget $BASE_SERVER/soft/jdk-8u73-linux-x64.tar.gztar -zxvf jdk-8u73-linux-x64.tar.gz -C /usr/localcat &gt;&gt; /etc/profile &lt;&lt;EOFexport JAVA_HOME=/usr/local/jdk1.8.0_73export PATH=\$PATH:\$JAVA_HOME/binEOF 4ã€æ€»ç»“å†™è„šæœ¬æ³¨æ„äº‹é¡¹ï¼š 1ã€å¼€å¤´åŠ è§£é‡Šå™¨ï¼š #!/bin/bashï¼Œå’Œæ³¨é‡Šè¯´æ˜Žã€‚ 2ã€å‘½åå»ºè®®è§„åˆ™ï¼šå˜é‡åå¤§å†™ã€å±€éƒ¨å˜é‡å°å†™ï¼Œå‡½æ•°åå°å†™ï¼Œåå­—ä½“çŽ°å‡ºå®žé™…ä½œç”¨ã€‚ 3ã€é»˜è®¤å˜é‡æ˜¯å…¨å±€çš„ï¼Œåœ¨å‡½æ•°ä¸­å˜é‡ local æŒ‡å®šä¸ºå±€éƒ¨å˜é‡ï¼Œé¿å…æ±¡æŸ“å…¶ä»–ä½œç”¨åŸŸã€‚ 4ã€set -e é‡åˆ°æ‰§è¡Œéž 0 æ—¶é€€å‡ºè„šæœ¬ï¼Œ set -x æ‰“å°æ‰§è¡Œè¿‡ç¨‹ã€‚ 5ã€å†™è„šæœ¬ä¸€å®šå…ˆæµ‹è¯•å†åˆ°ç”Ÿäº§ä¸Šã€‚]]></content>
      <categories>
        <category>Linux</category>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå­¦ä¹ ç¬”è®°-2]]></title>
    <url>%2F2018%2F05%2F27%2FLinux%2FLinux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-2%2F</url>
    <content type="text"><![CDATA[1. VIæ–‡æœ¬ç¼–è¾‘å™¨å­¦ä¼šä½¿ç”¨viç¼–è¾‘å™¨æ˜¯å­¦ä¹ Linuxç³»ç»Ÿçš„å¿…å¤‡æŠ€æœ¯ä¹‹ä¸€ï¼Œå› ä¸ºä¸€èˆ¬çš„LinuxæœåŠ¡å™¨æ˜¯æ²¡æœ‰GUIç•Œé¢çš„ï¼ŒLinuxè¿ç»´åŠå¼€å‘äººå‘˜åŸºæœ¬ä¸Šéƒ½æ˜¯é€šè¿‡å‘½ä»¤è¡Œçš„æ–¹å¼è¿›è¡Œæ–‡æœ¬ç¼–è¾‘æˆ–ç¨‹åºç¼–å†™çš„ã€‚viç¼–è¾‘å™¨æ˜¯Linuxå†…ç½®çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå‡ ä¹Žæ‰€æœ‰çš„ç±»unixç³»ç»Ÿä¸­éƒ½å†…ç½®äº†viç¼–è¾‘å™¨ï¼Œè€Œå…¶å®ƒç¼–è¾‘å™¨åˆ™ä¸ä¸€å®šï¼Œå¦å¤–å¾ˆå¤šè½¯ä»¶ä¼šè°ƒç”¨viç¼–è¾‘è¿›è¡Œå†…å®¹ç¼–å†™ï¼Œä¾‹å¦‚crontabå®šæ—¶ä»»åŠ¡ã€‚è¾ƒä¹‹äºŽå…¶å®ƒç¼–è¾‘å™¨æˆ–GUIç¼–è¾‘å™¨ï¼Œviç¼–è¾‘é€Ÿåº¦æ˜¯æœ€å¿«çš„ã€‚VIMæ˜¯å®ƒçš„å¢žå¼ºç‰ˆæœ¬ï¼ŒVIæœ‰ä¸‰ç§åŸºæœ¬å·¥ä½œæ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯ï¼š å‘½ä»¤æ¨¡å¼ï¼ˆcommand modeï¼‰ã€æˆ–è€…å«ä¸€èˆ¬æ¨¡å¼ æ’å…¥æ¨¡å¼ï¼ˆinsert modeï¼‰ã€æˆ–è€…å«ç¼–è¾‘æ¨¡å¼ åº•è¡Œæ¨¡å¼ï¼ˆlast line modeï¼‰ã€æˆ–è€…å«å‘½ä»¤è¡Œæ¨¡å¼ 1. æœ€åŸºæœ¬ç”¨æ³• 1ã€é¦–å…ˆä¼šè¿›å…¥â€œä¸€èˆ¬æ¨¡å¼â€ï¼Œæ­¤æ¨¡å¼åªæŽ¥å—å„ç§å‘½ä»¤å¿«æ·é”®ï¼Œä¸èƒ½ç¼–è¾‘æ–‡ä»¶å†…å®¹ 2ã€æŒ‰ié”®ï¼Œå°±ä¼šä»Žä¸€èˆ¬æ¨¡å¼è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œæ­¤æ¨¡å¼ä¸‹ï¼Œæ•²å…¥çš„éƒ½æ˜¯æ–‡ä»¶å†…å®¹ 3ã€ç¼–è¾‘å®Œæˆä¹‹åŽï¼ŒæŒ‰Escé”®é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œå›žåˆ°ä¸€èˆ¬æ¨¡å¼ 4ã€å†æŒ‰ï¼šï¼Œè¿›å…¥â€œåº•è¡Œå‘½ä»¤æ¨¡å¼â€ï¼Œè¾“å…¥wqå‘½ä»¤ï¼Œå›žè½¦å³å¯ä¿å­˜é€€å‡º 2. ç§»åŠ¨å…‰æ ‡ (ä¸€èˆ¬æ¨¡å¼) 1ã€ ä½¿ç”¨ä¸Šä¸‹å·¦å³é”®å¯ä»¥ç§»åŠ¨å…‰æ ‡ 2ã€ ä½¿ç”¨h,j,k,lï¼Œä¾æ¬¡æ˜¯å‘å·¦ï¼Œä¸‹ï¼Œä¸Šï¼Œå³ç§»åŠ¨ 3ã€ wï¼šå°†å…‰æ ‡ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå•è¯çš„é¦–å­—æ¯å¤„ 4ã€ Wï¼šåˆ©ç”¨ç©ºæ ¼å‘åŽç§»åŠ¨å…‰æ ‡ï¼Œå°±æ˜¯å¿½ç•¥æ ‡ç‚¹ 5ã€ bï¼šåˆ©ç”¨wordåŒ…æ‹¬æ ‡ç‚¹å‘å‰ç§»åŠ¨å…‰æ ‡, ä¸Žwç›¸å¯¹åº” 6ã€ Bï¼šåˆ©ç”¨ç©ºæ ¼å‘å‰ç§»åŠ¨å…‰æ ‡ï¼Œå¿½ç•¥æ ‡ç‚¹ 7ã€ eï¼šå°†å…‰æ ‡ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªwordçš„å°¾éƒ¨ï¼ŒåŒ…æ‹¬ç¬¦å· 8ã€ E: å°†å…‰æ ‡ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç©ºæ ¼åˆ†éš”å­—çš„å°¾éƒ¨ 9ã€ (ï¼šç§»åŠ¨åˆ°å¥å­å¼€å§‹ 10ã€ )ï¼šç§»åŠ¨åˆ°å¥å­ç»“æŸ 11ã€ 0ï¼šç§»åŠ¨å…‰æ ‡åˆ°æœ¬å¥å¥é¦– 12ã€ $ï¼šç§»åŠ¨å…‰æ ‡åˆ°æœ¬è¡Œè¡Œå°¾ 13ã€ {ï¼šç§»åŠ¨åˆ°æ®µè½å¼€å§‹ 14ã€ }ï¼šç§»åŠ¨åˆ°æ®µè½ç»“æŸ 15ã€ Hï¼šå±å¹•é¡¶ç«¯ 16ã€ Lï¼šå±å¹•åº•ç«¯ 17ã€ Mï¼šç§»åŠ¨åˆ°å±å¹•ä¸­å¤®ä½ç½® 18ã€ ggï¼šç›´æŽ¥è·³åˆ°æ–‡ä»¶çš„é¦–è¡Œè¡Œé¦– 19ã€ Gï¼šç›´æŽ¥è·³åˆ°æ–‡ä»¶çš„æœ«è¡Œè¡Œé¦– 20ã€ æœ€å¼ºå…‰æ ‡ç§»åŠ¨ï¼š % : åŒ¹é…æ‹¬å·ç§»åŠ¨ï¼ŒåŒ…æ‹¬(, {, [.ï¼ˆä½ éœ€è¦æŠŠå…‰æ ‡å…ˆç§»åˆ°æ‹¬å·ä¸Šï¼‰ *: åŒ¹é…å…‰æ ‡å½“å‰æ‰€åœ¨çš„å•è¯ï¼Œç§»åŠ¨å…‰æ ‡åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…å•è¯ #: åŒ¹é…å…‰æ ‡å½“å‰æ‰€åœ¨çš„å•è¯ï¼Œç§»åŠ¨å…‰æ ‡åˆ°ä¸Šä¸€ä¸ªåŒ¹é…å•è¯ é‡ç‚¹æ€»ç»“: h l : å·¦å³, j k : ä¸‹ä¸Š. w: ä¸‹ä¸€ä¸ªå•è¯ , b: ä¸Šä¸€ä¸ªå•è¯. 0: æœ¬è¡Œè¡Œé¦–, $: æœ¬è¡Œè¡Œå°¾ (: å¥å­å¼€å§‹, ): å¥å­ç»“æŸ {: æ®µè½å¼€å§‹ }: æ®µè½ç»“æŸ gg: æ–‡ä»¶è¡Œé¦– G: æ–‡ä»¶è¡Œå°¾ %: ä¸‹ä¸€ä¸ªæ‹¬å· *: ä¸‹ä¸€ä¸ªå•è¯ #: ä¸Šä¸€ä¸ªå•è¯ 3. å¸¸ç”¨æ“ä½œ(ä¸€èˆ¬æ¨¡å¼ &gt;&gt; æ’å…¥æ¨¡å¼) å•ä½ æŒ‡ä»¤1 æŒ‡ä»¤2 å½“å‰ä½ å‰ä¸€ä½/åŽä¸€ä½ i: åœ¨å…‰æ ‡å‰ä¸€ä½å¼€å§‹æ’å…¥ a: å…‰æ ‡åŽä¸€ä½å¼€å§‹æ’å…¥ å½“å‰è¡Œ æœ€å‰/æœ€åŽ I: åœ¨è¯¥è¡Œçš„æœ€å‰é¢æ’å…¥ A: åœ¨è¯¥è¡Œçš„æœ€åŽæ’å…¥ å½“å‰è¡Œ ä¸Šä¸€è¡Œ/ä¸‹ä¸€è¡Œ o: å°o, å½“å‰è¡Œçš„ä¸‹ä¸€è¡Œæ’å…¥ç©ºè¡Œ O: å¤§o, å½“å‰å†…å®¹ä¸‹ç§»ä¸€è¡Œ, å½“å‰è¡Œæ’å…¥ç©ºè¡Œ å½“å‰è¡Œ åˆ é™¤ dd: åˆ é™¤å½“å‰è¡Œ 3dd: ndd, åˆ é™¤ä»Žå½“å‰è¡Œå¼€å§‹çš„ nè¡Œ å½“å‰è¡Œ å¤åˆ¶ yy: å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œ 3yy: å¤åˆ¶ä»Žå½“å‰è¡Œå¼€å§‹çš„3è¡Œ ç²˜è´´ p: ç²˜è´´åˆ°å…‰æ ‡æ‰€åœ¨è¡Œçš„ä¸‹ä¸€è¡Œ æ’¤é”€ u: undo æ’¤é”€æ“ä½œ, å¯ä¸€ç›´æ’¤é”€åˆ°æœ€å‰é¢ é‡ç‚¹æ€»ç»“: i : å½“å‰å…‰æ ‡å‰å¼€å§‹æ’å…¥; a: å…‰æ ‡åŽä¸€ä½å¼€å§‹æ’å…¥ I: åœ¨è¯¥è¡Œçš„æœ€å‰é¢æ’å…¥; A: åœ¨è¯¥è¡Œçš„æœ€åŽæ’å…¥ o: å°o, å½“å‰è¡Œçš„ä¸‹ä¸€è¡Œæ’å…¥ç©ºè¡Œ O: å¤§o, å½“å‰å†…å®¹ä¸‹ç§»ä¸€è¡Œ, å½“å‰è¡Œæ’å…¥ç©ºè¡Œ dd: åˆ é™¤å½“å‰è¡Œ 3dd: ndd, åˆ é™¤ä»Žå½“å‰è¡Œå¼€å§‹çš„ nè¡Œ yy: å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œ 3yy: å¤åˆ¶ä»Žå½“å‰è¡Œå¼€å§‹çš„3è¡Œ p: ç²˜è´´åˆ°å…‰æ ‡æ‰€åœ¨è¡Œçš„ä¸‹ä¸€è¡Œ u: undo æ’¤é”€æ“ä½œ, å¯ä¸€ç›´æ’¤é”€åˆ°æœ€å‰é¢ 4. æŸ¥æ‰¾å¹¶æ›¿æ¢ åœ¨åº•è¡Œå‘½ä»¤æ¨¡å¼ä¸­è¾“å…¥ 1. æ˜¾ç¤ºè¡Œå· :set nu 2. éšè—è¡Œå· :set nonu 3 .æŸ¥æ‰¾å…³é”®å­— :/you ## æ•ˆæžœï¼šæŸ¥æ‰¾æ–‡ä»¶ä¸­å‡ºçŽ°çš„youï¼Œå¹¶å®šä½åˆ°ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„åœ°æ–¹ï¼ŒæŒ‰ nå¯ä»¥å®šä½åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…ä½ç½®ï¼ˆæŒ‰Nå®šä½åˆ°ä¸Šä¸€ä¸ªï¼‰ æŸ¥è¯¢çš„æ—¶å€™è¢«åŒ¹é…ä¸Šçš„å­—ç¬¦ä¸²ä¼šè¢«é«˜äº®ï¼Œå¯ä»¥åœ¨å‘½ä»¤æ¨¡å¼ä¸‹ä½¿ç”¨:nohå–æ¶ˆé«˜äº® 4. ç›´æŽ¥è·³è½¬åˆ° 3è¡Œ : 3 5. æ›¿æ¢æ“ä½œ :1 s/sad/bbb å°†ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªsadæ›¿æ¢ä¸ºbbb :1,5 s/sad/bbb å°†ç¬¬ä¸€è¡Œåˆ°ç¬¬äº”è¡Œçš„ç¬¬ä¸€ä¸ªsadæ›¿æ¢ä¸ºbbb :1,. s/sad/bbb å°†ç¬¬ä¸€è¡Œåˆ°å…‰æ ‡è¡Œçš„ç¬¬ä¸€ä¸ªsadæ›¿æ¢ä¸ºbbb :.,$ s/sad/bbb å°†å…‰æ ‡è¡Œåˆ°ç¼“å†²åŒºæœ€åŽä¸€è¡Œçš„sadæ›¿æ¢ä¸ºbbb :s/sad/bbb æŸ¥æ‰¾å…‰æ ‡æ‰€åœ¨è¡Œçš„ç¬¬ä¸€ä¸ªsadï¼Œæ›¿æ¢ä¸ºbbb :s/sad/bbb/g æŸ¥æ‰¾å…‰æ ‡æ‰€åœ¨è¡Œçš„æ‰€æœ‰sadï¼Œæ›¿æ¢ä¸ºbbb :%s/sad/bbb æŸ¥æ‰¾æ–‡ä»¶ä¸­æ‰€æœ‰è¡Œç¬¬ä¸€æ¬¡å‡ºçŽ°çš„sadï¼Œæ›¿æ¢ä¸ºbbb :%s/sad/bbb/g æŸ¥æ‰¾æ–‡ä»¶ä¸­æ‰€æœ‰çš„sadï¼Œæ›¿æ¢ä¸ºbbb 6. å±å¹•ç¿»æ»šç±»å‘½ä»¤ Ctrl + uï¼šå‘æ–‡ä»¶é¦–ç¿»åŠå± Ctrl + dï¼šå‘æ–‡ä»¶å°¾ç¿»åŠå± Ctrl + fï¼šå‘æ–‡ä»¶å°¾ç¿»ä¸€å± Ctrlï¼‹bï¼šå‘æ–‡ä»¶é¦–ç¿»ä¸€å± nzï¼šå°†ç¬¬nè¡Œæ»šè‡³å±å¹•é¡¶éƒ¨ï¼Œä¸æŒ‡å®šnæ—¶å°†å½“å‰è¡Œæ»šè‡³å±å¹•é¡¶éƒ¨ 7. å…¶å®ƒçš„å°æŠ€å·§ r æ›¿æ¢å…‰æ ‡å¤„ä¸€ä¸ªå­—ç¬¦ R è¿›å…¥æ›¿æ¢æ¨¡å¼ï¼Œä»Žå…‰æ ‡å¤„è¿žç»­æ›¿æ¢ s åˆ é™¤å½“å‰å­—ç¬¦ï¼Œè¿›å…¥æ’å…¥æ¨¡å¼ S åˆ é™¤å½“å‰è¡Œï¼Œè¿›å…¥æ’å…¥æ¨¡å¼ â‰ˆ dd, ddä¹Ÿä¼šåˆ é™¤å½“å‰è¡Œ, ä½†æ˜¯ä¸ä¼šè¿›å…¥æ’å…¥æ¨¡å¼ f s å…‰æ ‡è¡Œå†…å‘åŽæŸ¥æ‰¾ç¬¬ä¸€ä¸ªå‡ºçŽ°çš„å­—ç¬¦s (å…ˆè¾“f , å†è¾“ s, å‘åŽæ‰¾ s) F s å…‰æ ‡è¡Œå†…å‘å‰æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå‡ºçŽ°çš„å­—ç¬¦s (å…ˆè¾“F , å†è¾“ s, å‘å‰æ‰¾ s) ~ å¤§å°å†™è½¬æ¢ï¼Œåªè½¬æ¢å…‰æ ‡å¤„å­—ç¬¦ 8. é€ŸæŸ¥ç½‘å€ vimè¯¦è§£ 2. ç½‘ç»œç®¡ç†ifconfigå‘½ä»¤ifconfigå‘½ä»¤ä¸»è¦ç”¨äºŽé…ç½®ç½‘ç»œæŽ¥å£ï¼Œå¦‚æžœä¸åŠ ä»»ä½•å‚æ•°ï¼Œåˆ™ifconfigå‘½ä»¤ç”¨äºŽæŸ¥çœ‹å½“å‰æ‰€æœ‰æ´»åŠ¨ç½‘ç»œæŽ¥å£çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ï¼š eth0 è¡¨ç¤ºç¬¬ä¸€å—ç½‘å¡ï¼Œå…¶ä¸­HWaddrè¡¨ç¤ºç½‘å¡çš„ç‰©ç†åœ°å€ï¼Œå¯ä»¥çœ‹åˆ°ç›®å‰è¿™ä¸ªç½‘å¡çš„ç‰©ç†åœ°å€(MACåœ°å€ï¼‰æ˜¯00:0C:29:D6:C7:0Eã€‚ inet addr ç”¨æ¥è¡¨ç¤ºç½‘å¡çš„IPåœ°å€ï¼Œæ­¤ç½‘å¡çš„IPåœ°å€æ˜¯192.168.179.6ï¼Œå¹¿æ’­åœ°å€192.168.170.255ï¼ŒæŽ©ç åœ°å€Mask:255.255.255.0ã€‚ lo æ˜¯è¡¨ç¤ºä¸»æœºçš„å›žååœ°å€ï¼Œè¿™ä¸ªä¸€èˆ¬æ˜¯ç”¨æ¥æµ‹è¯•ä¸€ä¸ªç½‘ç»œç¨‹åºï¼Œä½†åˆä¸æƒ³è®©å±€åŸŸç½‘æˆ–å¤–ç½‘çš„ç”¨æˆ·èƒ½å¤ŸæŸ¥çœ‹ï¼Œåªèƒ½åœ¨æ­¤å°ä¸»æœºä¸Šè¿è¡Œå’ŒæŸ¥çœ‹æ‰€ç”¨çš„ç½‘ç»œæŽ¥å£ã€‚æ¯”å¦‚æŠŠ httpdæœåŠ¡å™¨çš„æŒ‡å®šåˆ°å›žååœ°å€ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥127.0.0.1å°±èƒ½çœ‹åˆ°ä½ æ‰€æž¶WEBç½‘ç«™äº†ã€‚ä½†åªæ˜¯æ‚¨èƒ½çœ‹å¾—åˆ°ï¼Œå±€åŸŸç½‘çš„å…¶å®ƒä¸»æœºæˆ–ç”¨æˆ·æ— ä»ŽçŸ¥é“ã€‚ ifconfigå…¶ä»–å¸¸ç”¨ä½¿ç”¨ -a æ˜¾ç¤ºæ‰€æœ‰ç½‘ç»œæŽ¥å£ï¼ŒåŒ…æ‹¬åœç”¨çš„ -s çŸ­æ ¼å¼æ˜¾ç¤ºç½‘ç»œä¿¡æ¯ï¼ŒåŒnetstat -i -v æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œåœ¨ç½‘ç»œå‡ºé”™çš„æƒ…å†µä¸‹é€‚ç”¨ interface æŒ‡å®šç½‘ç»œæŽ¥å£ up å¯ç”¨ç½‘ç»œæŽ¥å£ down å…³é—­ç½‘ç»œæŽ¥å£ å¯åŠ¨å…³é—­æŒ‡å®šç½‘å¡&amp; å¸¸ç”¨æ“ä½œï¼š 12345ifconfig eth0 up #å¯åŠ¨ç½‘å¡ifconfig eth0 down #å…³é—­ç½‘å¡ ifconfig #å¤„äºŽæ¿€æ´»çŠ¶æ€çš„ç½‘ç»œæŽ¥å£ifconfig -a #æ‰€æœ‰é…ç½®çš„ç½‘ç»œæŽ¥å£ï¼Œä¸è®ºå…¶æ˜¯å¦æ¿€æ´»ifconfig eth0 #æ˜¾ç¤ºeth0çš„ç½‘å¡ä¿¡æ¯ ç½‘ç»œé…ç½®1. ä¸‰ç§é€šä¿¡æ¨¡å¼Vmwareä¸­çš„è™šæ‹Ÿæœºå’Œå®¿ä¸»æœºè¿›è¡Œé€šä¿¡æœ‰ä¸‰ç§ç½‘ç»œæ–¹å¼ ä¸€ã€Brigdeâ€•â€•æ¡¥æŽ¥ï¼šé»˜è®¤ä½¿ç”¨VMnet0 åŽŸç†: Bridge æ¡¥â€å°±æ˜¯ä¸€ä¸ªä¸»æœºï¼Œè¿™ä¸ªæœºå™¨æ‹¥æœ‰ä¸¤å—ç½‘å¡ï¼Œåˆ†åˆ«å¤„äºŽä¸¤ä¸ªå±€åŸŸç½‘ä¸­ï¼ŒåŒæ—¶åœ¨â€æ¡¥â€ä¸Šï¼Œè¿è¡Œç€ç¨‹åºï¼Œè®©å±€åŸŸç½‘Aä¸­çš„æ‰€æœ‰æ•°æ®åŒ…åŽŸå°ä¸åŠ¨çš„æµå…¥Bï¼Œåä¹‹äº¦ç„¶ã€‚è¿™æ ·ï¼Œå±€åŸŸç½‘Aå’ŒBå°±æ— ç¼çš„åœ¨é“¾è·¯å±‚è¿žæŽ¥èµ·æ¥äº†ï¼Œåœ¨æ¡¥æŽ¥æ—¶ï¼ŒVMWareç½‘å¡å’Œç‰©ç†ç½‘å¡åº”è¯¥å¤„äºŽåŒä¸€IPç½‘æ®µ å½“ç„¶è¦ä¿è¯ä¸¤ä¸ªå±€åŸŸç½‘æ²¡æœ‰å†²çªçš„IP. VMWare çš„æ¡¥ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œåªä¸è¿‡ï¼Œæœ¬æ¥ä½œä¸ºç¡¬ä»¶çš„ä¸€å—ç½‘å¡ï¼ŒçŽ°åœ¨ç”±VMWareè½¯ä»¶è™šæ‹Ÿäº†ï¼å½“é‡‡ç”¨æ¡¥æŽ¥æ—¶ï¼ŒVMWareä¼šè™šæ‹Ÿä¸€å—ç½‘å¡å’ŒçœŸæ­£çš„ç‰©ç†ç½‘å¡å°±è¡Œæ¡¥æŽ¥ï¼Œè¿™æ ·ï¼Œå‘åˆ°ç‰©ç†ç½‘å¡çš„æ‰€æœ‰æ•°æ®åŒ…å°±åˆ°äº†VMWareè™šæ‹Ÿæœºï¼Œè€Œç”±VMWareå‘å‡ºçš„æ•°æ®åŒ…ä¹Ÿä¼šé€šè¿‡æ¡¥ä»Žç‰©ç†ç½‘å¡çš„é‚£ç«¯å‘å‡ºã€‚ æ‰€ä»¥ï¼Œå¦‚æžœç‰©ç†ç½‘å¡å¯ä»¥ä¸Šç½‘ï¼Œé‚£ä¹ˆæ¡¥æŽ¥çš„è½¯ç½‘å¡ä¹Ÿæ²¡æœ‰é—®é¢˜äº†ï¼Œè¿™å°±æ˜¯æ¡¥æŽ¥ä¸Šç½‘çš„åŽŸç†äº†ã€‚ è”ç½‘æ–¹å¼ï¼š è¿™ä¸€ç§è”ç½‘æ–¹å¼æœ€ç®€å•ï¼Œåœ¨å±€åŸŸç½‘å†…ï¼Œä½ çš„ä¸»æœºæ˜¯æ€Žä¹ˆè”ç½‘çš„ï¼Œä½ åœ¨è™šæ‹Ÿæœºé‡Œå°±æ€Žä¹ˆè¿žç½‘ã€‚æŠŠè™šæ‹Ÿæœºçœ‹æˆå±€åŸŸç½‘å†…çš„å¦ä¸€å°ç”µè„‘å°±è¡Œäº†ï¼ æç¤ºï¼šä¸»æœºç½‘å¡å¤„åœ¨ä¸€ä¸ªå¯ä»¥è®¿é—®Internetçš„å±€åŸŸç½‘ä¸­ï¼Œè™šæ‹Ÿæœºæ‰èƒ½é€šè¿‡Bridgeè®¿é—®Internetã€‚ äºŒã€NATâ€•â€•ç½‘ç»œåœ°å€è½¬æ¢ ï¼šé»˜è®¤ä½¿ç”¨VMnet8 åŽŸç†ï¼š NAT æ˜¯ Network address translateçš„ç®€ç§°ã€‚NATæŠ€æœ¯åº”ç”¨åœ¨internetç½‘å…³å’Œè·¯ç”±å™¨ä¸Šï¼Œæ¯”å¦‚192.168.0.123è¿™ä¸ªåœ°å€è¦è®¿é—®internetï¼Œå®ƒçš„æ•°æ®åŒ…å°±è¦é€šè¿‡ä¸€ä¸ªç½‘å…³æˆ–è€…è·¯ç”±å™¨ï¼Œè€Œç½‘å…³æˆ–è€…è·¯ç”±å™¨æ‹¥æœ‰ä¸€ä¸ªèƒ½è®¿é—®internetçš„ipåœ°å€ï¼Œè¿™æ ·çš„ç½‘å…³å’Œè·¯ç”±å™¨å°±è¦åœ¨æ”¶å‘æ•°æ®åŒ…æ—¶ï¼Œå¯¹æ•°æ®åŒ…çš„IPåè®®å±‚æ•°æ®è¿›è¡Œæ›´æ”¹ï¼ˆå³ NATï¼‰ï¼Œä»¥ä½¿ç§æœ‰ç½‘æ®µçš„ä¸»æœºèƒ½å¤Ÿé¡ºåˆ©è®¿é—®internetã€‚æ­¤æŠ€æœ¯è§£å†³äº†IPåœ°å€ç¨€ç¼ºçš„é—®é¢˜ã€‚åŒæ ·çš„ç§æœ‰IPå¯ä»¥ç½‘å…³NAT ä¸Šç½‘ã€‚ VMWareçš„NATä¸Šç½‘ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œå®ƒåœ¨ä¸»æœºå’Œè™šæ‹Ÿæœºä¹‹é—´ç”¨è½¯ä»¶ä¼ªé€ å‡ºä¸€å—ç½‘å¡ï¼Œè¿™å—ç½‘å¡å’Œè™šæ‹Ÿæœºçš„ipå¤„äºŽä¸€ä¸ªåœ°å€æ®µã€‚åŒæ—¶ï¼Œåœ¨è¿™å—ç½‘å¡å’Œä¸»æœºçš„ç½‘ç»œæŽ¥å£ä¹‹é—´è¿›è¡ŒNATã€‚è™šæ‹Ÿæœºå‘å‡ºçš„æ¯ä¸€å—æ•°æ®åŒ…éƒ½ä¼šç»è¿‡è™šæ‹Ÿç½‘å¡ï¼Œç„¶åŽNATï¼Œç„¶åŽç”±ä¸»æœºçš„æŽ¥å£å‘å‡ºã€‚ è™šæ‹Ÿç½‘å¡å’Œè™šæ‹Ÿæœºå¤„äºŽä¸€ä¸ªåœ°å€æ®µï¼Œè™šæ‹Ÿæœºå’Œä¸»æœºä¸åŒä¸€ä¸ªåœ°å€æ®µï¼Œä¸»æœºç›¸å½“äºŽè™šæ‹Ÿæœºçš„ç½‘å…³ï¼Œæ‰€ä»¥è™šæ‹Ÿæœºèƒ½pingåˆ°ä¸»æœºçš„IPï¼Œä½†æ˜¯ä¸»æœºpingä¸åˆ°è™šæ‹Ÿæœºçš„IPã€‚ è”ç½‘æ–¹å¼ï¼š æ–¹æ³•1ã€åŠ¨æ€IPåœ°å€ã€‚ ä¸»æœºæ˜¯é™æ€IPæˆ–åŠ¨æ€IPï¼Œéƒ½æ— æ‰€è°“ï¼Œå°†è™šæ‹Ÿæœºè®¾ç½®æˆä½¿ç”¨DHCPæ–¹å¼ä¸Šç½‘,Windowsä¸‹é€‰æ‹©â€œè‡ªåŠ¨èŽ·å–IPâ€œï¼Œlinuxä¸‹å¼€å¯DHCPæœåŠ¡å³å¯ã€‚ï¼ˆè¿™ç§æ–¹æ³•æœ€ç®€å•ï¼Œä¸ç”¨è¿‡å¤šçš„è®¾ç½®ï¼Œä½†è¦åœ¨VMwareä¸­è¿›è¡Œâ€œç¼–è¾‘â†’è™šæ‹Ÿç½‘ç»œè®¾ç½®â€ï¼Œå°†NATå’ŒDHCPéƒ½å¼€å¯äº†ã€‚ä¸€èˆ¬NATé»˜è®¤å¼€å¯ï¼ŒDHCPé»˜è®¤å…³é—­ï¼‰ æ–¹æ³•2ã€é™æ€IPåœ°å€ã€‚ å¦‚æžœä¸æƒ³ä½¿ç”¨DHCPï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨è®¾ç½®ï¼š IPè®¾ç½®ä¸Žvmnet1åŒç½‘æ®µ,ç½‘å…³è®¾ç½®æˆvmnet8çš„ç½‘å…³ï¼ˆåœ¨â€œè™šæ‹Ÿç½‘ç»œè®¾ç½®â€é‡Œçš„Neté€‰é¡¹å¡é‡Œèƒ½æ‰¾åˆ°Gatewayï¼‰é€šå¸¸æ˜¯xxx.xxx.xxx.2ã€‚å­ç½‘æŽ©ç è®¾ç½®ä¸ŽVMnet8ç›¸åŒï¼ˆè®¾ç½®å¥½IPåœ°å€åŽï¼Œå­ç½‘æŽ©ç è‡ªåŠ¨ç”Ÿæˆï¼‰DNSè®¾ç½®ä¸Žä¸»æœºç›¸åŒã€‚ ä¾‹å¦‚ï¼šä¸»æœºIPæ˜¯10.70.54.31,è®¾ç½®è™šæ‹ŸæœºIPä¸º10.70.54.22ã€‚Netmask,Gateway,DNSéƒ½ä¸Žä¸»æœºç›¸åŒå³å¯å®žçŽ° è™šæ‹Ÿæœº â€”ä¸»æœº è™šæ‹Ÿæœºäº’è”ç½‘ é€šä¿¡ã€‚ æç¤ºï¼šä½¿ç”¨NATæŠ€æœ¯ï¼Œä¸»æœºèƒ½ä¸Šç½‘ï¼Œè™šæ‹Ÿæœºå°±å¯ä»¥è®¿é—®Internetï¼Œä½†æ˜¯ä¸»æœºä¸èƒ½è®¿é—®è™šæ‹Ÿæœºã€‚ ä¸‰ã€Host-Onlyâ€•â€•ç§æœ‰ç½‘ç»œå…±äº«ä¸»æœºï¼šé»˜è®¤ä½¿ç”¨VMnet1 è”ç½‘æ–¹æ³•ï¼š æ–¹æ³•1ã€åŠ¨æ€IPåœ°å€ã€‚åƒä¸Šé¢é‚£æ ·å¼€å¯DHCPåŽï¼Œè™šæ‹Ÿæœºç›´æŽ¥è‡ªåŠ¨èŽ·å–IPåœ°å€å’ŒDNSã€‚å°±å¯ä»¥å’Œä¸»æœºç›¸è¿žäº†ã€‚å½“ç„¶ï¼Œè¿˜è¦è¿›è¡Œä¸€äº›å±€åŸŸç½‘å…±äº«çš„æ“ä½œï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚ æ–¹æ³•2ã€é™æ€IPåœ°å€ã€‚ ä¹Ÿå¯ä»¥æ‰‹åŠ¨è®¾ç½®ï¼Œå°†è™šæ‹ŸæœºIPè®¾ç½®ä¸ŽVMnet1åŒç½‘æ®µ,ç½‘å…³è®¾ç½®æˆVMnet1çš„ç½‘å…³ç›¸åŒ,å…¶ä½™è®¾ç½®ä¸ŽVMnet1ç›¸åŒ,DNSè®¾ç½®ä¸Žä¸»æœºç›¸åŒã€‚ ä¾‹å¦‚ï¼šVMnet1 IP:172.16.249.1 Gateway :172.16.249.2 é‚£ä¹ˆè™šæ‹Ÿæœº IP:172.16.249.100 Gateway: 172.16.249.2 è¿™æ ·ã€ è™šæ‹Ÿæœºä¸»æœº å¯ä»¥é€šä¿¡ä½†æ˜¯ã€ è™šæ‹Ÿæœºäº’è”ç½‘ æ— æ³•é€šä¿¡ æç¤ºï¼šHost-onlyæŠ€æœ¯åªç”¨äºŽä¸»æœºå’Œè™šæ‹Ÿæœºäº’è®¿ï¼ŒäºŽè®¿é—®internetæ— å…³ã€‚ 2. NATç½‘ç»œæ¨¡å¼çš„é…ç½®è§Linuxå­¦ä¹ ç¬”è®°3, ç¬¬8æ¡: Linuxè™šæ‹Ÿä¸»æœºé›†ç¾¤æµ‹è¯•çŽ¯å¢ƒåŸºæœ¬æ­å»º 3. å…¶å®ƒçš„å¸¸ç”¨ç½‘ç»œç®¡ç†å‘½ä»¤ pingå‘½ä»¤: å¸¸ç”¨æ¥æµ‹è¯•ç½‘ç»œè¿žæŽ¥æ˜¯å¦æ­£å¸¸ å…ˆç¡®å®šèƒ½pingé€š ping www.baidu.com hostå‘½ä»¤: hostå‘½ä»¤ç”¨æ¥è¿›è¡ŒDNSæŸ¥è¯¢ ç„¶åŽç”¨hostå‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ° host www.baidu.com ç„¶åŽé€šè¿‡æµè§ˆå™¨è®¿é—®è¯¥åœ°å€ï¼š119.75.213.61 netstatå‘½ä»¤: netstatå‘½ä»¤å¯ä»¥æ˜¾ç¤ºç½‘ç»œæŽ¥å£çš„å¾ˆå¤šç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰“å¼€çš„socketå’Œè·¯ç”±è¡¨ ä»¥ä¸‹æ˜¯å¸¸ç”¨å‘½ä»¤é€‰é¡¹ 123456789101112-a (all)æ˜¾ç¤ºæ‰€æœ‰é€‰é¡¹ï¼Œé»˜è®¤ä¸æ˜¾ç¤ºLISTENç›¸å…³-t (tcp)ä»…æ˜¾ç¤ºtcpç›¸å…³é€‰é¡¹-u (udp)ä»…æ˜¾ç¤ºudpç›¸å…³é€‰é¡¹-n æ‹’ç»æ˜¾ç¤ºåˆ«åï¼Œèƒ½æ˜¾ç¤ºæ•°å­—çš„å…¨éƒ¨è½¬åŒ–æˆæ•°å­—-l ä»…åˆ—å‡ºæœ‰åœ¨ Listen (ç›‘å¬) çš„æœå‹™çŠ¶æ€-p æ˜¾ç¤ºå»ºç«‹ç›¸å…³é“¾æŽ¥çš„ç¨‹åºå-r æ˜¾ç¤ºè·¯ç”±ä¿¡æ¯ï¼Œè·¯ç”±è¡¨-e æ˜¾ç¤ºæ‰©å±•ä¿¡æ¯ï¼Œä¾‹å¦‚uidç­‰-s æŒ‰å„ä¸ªåè®®è¿›è¡Œç»Ÿè®¡-c æ¯éš”ä¸€ä¸ªå›ºå®šæ—¶é—´ï¼Œæ‰§è¡Œè¯¥netstatå‘½ä»¤ ä¾‹å­ 1ã€åˆ—å‡ºæ‰€æœ‰ç«¯å£ï¼ŒåŒ…æ‹¬ç›‘å¬å’Œæœªç›‘å¬çš„ï¼šnetstat -a 2ã€åˆ—å‡ºæ‰€æœ‰TCPç«¯å£ï¼šnetstat -at 3ã€åˆ—å‡ºæ‰€æœ‰UDPç«¯å£ï¼šnetstat -au 4ã€åˆ—å‡ºæ‰€æœ‰ç›‘å¬çŠ¶æ€çš„TCPç«¯å£ï¼šè¯¥å‘½ä»¤æœ€é‡è¦ç”¨æ¥æŸ¥çœ‹å“ªä¸ªç¨‹åºå ç”¨äº†å“ªä¸ªç½‘ç»œç«¯å£å· 123# æ¯”å¦‚æŸ¥çœ‹è°å ç”¨äº† tcp çš„80 ç«¯å£netstat -nltp | grep 80 [23:04:54]tcp 0 0 :::80 :::* LISTEN 3890/httpd 4. é˜²ç«å¢™é˜²ç«å¢™æ ¹æ®é…ç½®æ–‡ä»¶/etc/sysconfig/iptablesæ¥æŽ§åˆ¶æœ¬æœºçš„â€œå‡ºã€å…¥â€ç½‘ç»œè®¿é—®è¡Œä¸º å…¶å¯¹è¡Œä¸ºçš„é…ç½®ç­–ç•¥æœ‰å››ä¸ªç­–ç•¥è¡¨ åŸºç¡€å¿…å¤‡æŠ€èƒ½ | æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ | service iptables status || â€”â€”â€”â€”â€”â€”â€”- | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ || å¼€å¯é˜²ç«å¢™ | service iptables start || å…³é—­é˜²ç«å¢™ | service iptables stop || å…³é—­é˜²ç«å¢™å¼€æœºè‡ªå¯ | chkconfig iptables off || è®¾ç½®é˜²ç«å¢™å¼€æœºè‡ªå¯ | chkconfig iptables on || æŸ¥çœ‹é˜²ç«å¢™å¼€æœºå¯åŠ¨çŠ¶æ€ | chkconfig iptables â€“list | æ‰©å±•çŸ¥è¯† 1234567891011121314151617181920212223242526# 1ã€åˆ—å‡ºiptablesè§„åˆ™iptables -L -n# åˆ—å‡ºiptablesè§„åˆ™å¹¶æ˜¾ç¤ºè§„åˆ™ç¼–å·iptables -L -n --line-numbers# 2ã€åˆ—å‡ºiptables natè¡¨è§„åˆ™ï¼ˆé»˜è®¤æ˜¯filterè¡¨ï¼‰iptables -L -n -t nat# 3ã€æ¸…é™¤é»˜è®¤è§„åˆ™ï¼ˆæ³¨æ„é»˜è®¤æ˜¯filterè¡¨ï¼Œå¦‚æžœå¯¹natè¡¨æ“ä½œè¦åŠ -t natï¼‰#æ¸…é™¤æ‰€æœ‰è§„åˆ™iptables -F#é‡å¯iptableså‘çŽ°è§„åˆ™ä¾ç„¶å­˜åœ¨ï¼Œå› ä¸ºæ²¡æœ‰ä¿å­˜service iptables restart#ä¿å­˜é…ç½®service iptables save# 4ã€ç¦æ­¢SSHç™»é™†ï¼ˆå¦‚æžœæœåŠ¡å™¨åœ¨æœºæˆ¿ï¼Œä¸€å®šè¦å°å¿ƒï¼‰iptables -A INPUT -p tcp --dport 22 -j DROP# 5ã€åˆ é™¤è§„åˆ™iptables -D INPUT -p tcp --dport 22 -j DROP # 6ã€åŠ å…¥ä¸€æ¡INPUTè§„åˆ™å¼€æ”¾80ç«¯å£ iptables -I INPUT -p tcp --dport 80 -j ACCEPT 3. Linuxç³»ç»Ÿå¯åŠ¨çº§åˆ«ç®¡ç†ä½¿ç”¨runlevelå‘½ä»¤å¯ä»¥æŸ¥çœ‹ç³»ç»Ÿè¿è¡Œçš„çº§åˆ« 12runlevel [23:12:37]N 3 ä¿®æ”¹ç³»ç»Ÿé»˜è®¤å¯åŠ¨çº§åˆ« 1234567891011121314# å¯åŠ¨çº§åˆ«åœ¨è¿™ä¸ªè·¯å¾„æŸ¥çœ‹vi /etc/inittab-------------------# Default runlevel. The runlevels used are:# 0 - halt (Do NOT set initdefault to this)# 1 - Single user mode# 2 - Multiuser, without NFS (The same as 3, if you do not have networking)# 3 - Full multiuser mode# 4 - unused# 5 - X11# 6 - reboot (Do NOT set initdefault to this)#id:3:initdefault: id:3:initdefault: ## é…ç½®é»˜è®¤å¯åŠ¨çº§åˆ« ## é€šå¸¸å°†é»˜è®¤å¯åŠ¨çº§åˆ«è®¾ç½®ä¸ºï¼š3 4. ç”¨æˆ·å’Œç»„1. ç”¨æˆ·å’Œç»„çš„æ¦‚å¿µLinuxæ˜¯ä¸€ä¸ªå¤šä»»åŠ¡å¤šç”¨æˆ·çš„æ“ä½œç³»ç»Ÿï¼Œå½“æˆ‘ä»¬åœ¨ä½¿ç”¨ls -lå‘½ä»¤çš„æ—¶å€™æˆ‘ä»¬çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š 123drwxrwxr-x. 2 root root 4096 5æœˆ 24 00:15 test-rw-r--r--. 1 root root 58 5æœˆ 25 11:00 test.sh-rwxr-xr-x. 1 root root 35 5æœˆ 23 23:55 test.txt testï¼šè¡¨ç¤ºæ–‡ä»¶æˆ–è€…ç›®å½•ï¼Œå…·ä½“çš„æ–‡ä»¶ç±»åž‹æ˜¯ç”±è¯¥è¡Œæœ€å‰é¢çš„é‚£ä¸ªç¬¦å·è¡¨ç¤º 12345- å½“ä¸º[ *d* ]åˆ™æ˜¯ç›®å½•- å½“ä¸º[ *-* ]åˆ™æ˜¯æ–‡ä»¶ï¼›- è‹¥æ˜¯[ *l* ]åˆ™è¡¨ç¤ºä¸ºé“¾æŽ¥æ–‡æ¡£(link file)ï¼›- è‹¥æ˜¯[ *b* ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„å¯ä¾›å‚¨å­˜çš„æŽ¥å£è®¾å¤‡(å¯éšæœºå­˜å–è£…ç½®)ï¼›- è‹¥æ˜¯[ *c* ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„ä¸²è¡Œç«¯å£è®¾å¤‡ï¼Œä¾‹å¦‚é”®ç›˜ã€é¼ æ ‡(ä¸€æ¬¡æ€§è¯»å–è£…ç½®); drwxrwxr-x ï¼šè¯¥æ–‡ä»¶çš„ç±»åž‹å’Œæƒé™ä¿¡æ¯ 2 ï¼šé“¾æŽ¥æ•°ï¼Œå¦‚æžœæ˜¯æ–‡ä»¶åˆ™æ˜¯1 ï¼Œ å¦‚æžœæ˜¯æ–‡ä»¶å¤¹åˆ™è¡¨ç¤ºè¯¥æ–‡ä»¶å¤¹ä¸‹çš„å­æ–‡ä»¶å¤¹ä¸ªæ•° ç¬¬ä¸€ä¸ªroot ï¼šæ–‡ä»¶æˆ–è€…ç›®å½•çš„æ‰€å±žè€…** ç¬¬äºŒä¸ªroot ï¼šæ‰€å±žç”¨æˆ·ç»„** 4096 ï¼šæ–‡ä»¶æˆ–è€…ç›®å½•çš„å¤§å°ï¼Œæ˜¯ç›®å½•çš„è¯ä¸€èˆ¬éƒ½æ˜¯4096 5æœˆ 24 00:15ï¼šæ–‡ä»¶çš„æœ€åŽç¼–è¾‘æ—¶é—´ é€šè¿‡ä»¥ä¸Šä¿¡æ¯å¾—çŸ¥ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½è®¾è®¡åˆ°ç”¨æˆ·å’Œç»„çš„æƒé™é—®é¢˜ åœ¨Linuxä¸­ï¼Œç”¨æˆ·æ˜¯èƒ½å¤ŸèŽ·å–ç³»ç»Ÿèµ„æºçš„æƒé™çš„é›†åˆï¼Œç»„æ˜¯æƒé™çš„å®¹å™¨ Linux ç”¨æˆ·ç±»åž‹ ç”¨æˆ·ç±»åž‹ æè¿° ç®¡ç†å‘˜root å…·æœ‰ä½¿ç”¨ç³»ç»Ÿæ‰€æœ‰æƒé™çš„ç”¨æˆ·,å…¶UID ä¸º0 ç³»ç»Ÿç”¨æˆ· ä¿éšœç³»ç»Ÿè¿è¡Œçš„ç”¨æˆ·,ä¸€èˆ¬ä¸æä¾›å¯†ç ç™»å½•ç³»ç»Ÿ,å…¶UIDä¸º1-499ä¹‹é—´ æ™®é€šç”¨æˆ· å³ä¸€èˆ¬ç”¨æˆ·,å…¶ä½¿ç”¨ç³»ç»Ÿçš„æƒé™å—é™,å…¶UIDä¸º500-60000ä¹‹é—´. ä¸ŽLinuxç”¨æˆ·ä¿¡æ¯ç›¸å…³çš„æ–‡ä»¶æœ‰ä¸¤ä¸ªï¼šåˆ†åˆ«æ˜¯/etc/passwdå’Œ /etc/shadow 123456789101112# æŸ¥çœ‹æ–‡ä»¶/etc/passwdæ–‡ä»¶çš„å†…å®¹ï¼Œé€‰å–ç¬¬ä¸€è¡Œï¼šroot:x:0:0:root:/root:/bin/bashroot:ç”¨æˆ·åx:å¯†ç å ä½ç¬¦ï¼Œå¯†ç ä¿å­˜åœ¨shadowæ–‡ä»¶å†…0:ç”¨æˆ·idï¼ŒUID0:ç»„idï¼ŒGIDroot:æ³¨é‡Šä¿¡æ¯/root:ç”¨æˆ·å®¶ç›®å½•/bin/bash:ç”¨æˆ·é»˜è®¤ä½¿ç”¨shellç™»å½•å:åŠ å¯†å£ä»¤:æœ€åŽä¸€æ¬¡ä¿®æ”¹æ—¶é—´:æœ€å°æ—¶é—´é—´éš”:æœ€å¤§æ—¶é—´é—´éš”:è­¦å‘Šæ—¶é—´:ä¸æ´»åŠ¨æ—¶é—´:å¤±æ•ˆæ—¶é—´:æ ‡å¿— Linuxç”¨æˆ·ç»„ç±»åž‹ ç”¨æˆ·ç»„ç±»åž‹ æè¿° ç³»ç»Ÿç»„ ä¸€èˆ¬åŠ å…¥ä¸€äº›ç³»ç»Ÿç”¨æˆ· æ™®é€šç”¨æˆ·ç»„ å¯ä»¥åŠ å…¥å¤šä¸ªç”¨æˆ· ç§æœ‰ç»„/åŸºæœ¬ç»„ å½“åˆ›å»ºç”¨æˆ·æ—¶,å¦‚æžœæ²¡æœ‰ä¸ºå…¶æŒ‡æ˜Žæ‰€å±žç»„ï¼Œåˆ™å°±ä¸ºå…¶å®šä¹‰ä¸€ä¸ªç§æœ‰çš„ç”¨æˆ·ç»„ï¼Œèµ·åç§°ä¸Žç”¨æˆ·ååŒåï¼Œå½“æŠŠå…¶ä»–ç”¨æˆ·åŠ å…¥åˆ°è¯¥ç»„ä¸­ï¼Œåˆ™å…¶å°±å˜æˆäº†æ™®é€šç»„ ä¸ŽLinuxç”¨æˆ·ç»„ä¿¡æ¯ç›¸å…³çš„æ–‡ä»¶æœ‰ä¸¤ä¸ªï¼šåˆ†åˆ«æ˜¯/etc/groupå’Œ /etc/gshadow 12345# æŸ¥çœ‹æ–‡ä»¶/etc/groupæ–‡ä»¶å†…å®¹ï¼Œé€‰å–ä¸€ä¸ªæ™®é€šç»„è¡Œï¼šhadoop:x:500:hadoop:ç»„åx:ç»„å¯†ç å ä½ç¬¦500:ç»„id 2. ç”¨æˆ·æ“ä½œLinuxä¸­çš„ç”¨æˆ·ç®¡ç†ä¸»è¦æ¶‰åŠåˆ°ç”¨æˆ·è´¦å·çš„æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹ã€‚æ‰€æœ‰æ“ä½œéƒ½å½±å“/etc/passwdä¸­çš„æ–‡ä»¶å†…å®¹ é€‰é¡¹12345678910111213-c&lt;å¤‡æ³¨&gt;ï¼šä¿®æ”¹ç”¨æˆ·å¸å·çš„å¤‡æ³¨æ–‡å­—ï¼›-d&lt;ç™»å…¥ç›®å½•&gt;ï¼šä¿®æ”¹ç”¨æˆ·ç™»å…¥æ—¶çš„ç›®å½•ï¼›-e&lt;æœ‰æ•ˆæœŸé™&gt;ï¼šä¿®æ”¹å¸å·çš„æœ‰æ•ˆæœŸé™ï¼›-f&lt;ç¼“å†²å¤©æ•°&gt;ï¼šä¿®æ”¹åœ¨å¯†ç è¿‡æœŸåŽå¤šå°‘å¤©å³å…³é—­è¯¥å¸å·ï¼›-g&lt;ç¾¤ç»„&gt;ï¼šä¿®æ”¹ç”¨æˆ·æ‰€å±žçš„ç¾¤ç»„ï¼›-G&lt;ç¾¤ç»„&gt;ï¼›ä¿®æ”¹ç”¨æˆ·æ‰€å±žçš„é™„åŠ ç¾¤ç»„ï¼›-l&lt;å¸å·åç§°&gt;ï¼šä¿®æ”¹ç”¨æˆ·å¸å·åç§°ï¼›-Lï¼šé”å®šç”¨æˆ·å¯†ç ï¼Œä½¿å¯†ç æ— æ•ˆï¼›-U:è§£é™¤å¯†ç é”å®šã€‚-s&lt;shell&gt;ï¼šä¿®æ”¹ç”¨æˆ·ç™»å…¥åŽæ‰€ä½¿ç”¨çš„shellï¼›-u&lt;uid&gt;ï¼šä¿®æ”¹ç”¨æˆ·IDï¼› å‚æ•° ç™»å½•åï¼šæŒ‡å®šè¦ä¿®æ”¹ä¿¡æ¯çš„ç”¨æˆ·ç™»å½•åã€‚ æ·»åŠ ç”¨æˆ· useradd spark usermod -G bigdata spark ## è®¾ç½®ç»„, sparkç”¨æˆ·æ·»åŠ åˆ°bigdataç»„ä¸­ usermod -c â€œmylove sparkâ€ spark ## -c: æ·»åŠ å¤‡æ³¨ä¿¡æ¯ ä¸€æ­¥å®Œæˆï¼šuseradd -G bigdata -c â€œmyloveâ€ spark # sparkç”¨æˆ·æ·»åŠ åˆ°bigdataç»„ä¸­, å¹¶è®¾ç½®å¤‡æ³¨ä¸º mylover useradd -u 508 -g 514 -G 1001 user3 æ·»åŠ ç”¨æˆ·user3æ—¶, æŒ‡å®šç”¨æˆ·uid å’Œ ä¸»ç»„-g, é™„å±žç»„-G, ç»„å¿…é¡»è¦å…ˆå­˜åœ¨ useradd -u(æ·»åŠ çš„æ—¶å€™ä¿®æ”¹ç”¨æˆ·id) 508 -g 514(-gæ˜¯æ·»åŠ ç»„, æ­¤ç»„å·ç å¿…é¡»å­˜åœ¨) æŒ‡å®šuser4 çš„å®¶ç›®å½• useradd -u 520 -g 1000 -d /home/user44 user4 1234567891011121314151617&gt; &gt; ä¸åˆ›å»ºuser4çš„å®¶ç›®å½•, user5åˆšåˆ›å»ºçš„æ—¶å€™, å®¶å°±è¢«æ¯äº†&gt; &gt; `useradd -u 508 -g 1000 -M user6&gt; &gt; &gt; &gt; å½“user6æ²¡æœ‰å®¶çš„æ—¶å€™, è¿™æ ·æ˜¾ç¤º&gt; &gt; `bash-4.1$ ....&gt; &gt; æ­¤æ—¶åº”è¯¥è¿™æ ·æ“ä½œ&gt; &gt; cp -v /etc/skel/.b* /home/user6&gt; &gt; "/etc/skel/.bash_logout" -&gt; "/home/user6/.bash_logout"&gt; &gt; "/etc/skel/.bash_profile" -&gt; "/home/user6/.bash_profile"&gt; &gt; "/etc/skel/.bashrc" -&gt; "/home/user6/.bashrc"&gt; &gt; su user6&gt; &gt; [user6@cts1 shixuanji]$ &gt; &gt; &gt; &gt; --------&gt; &gt; æŸ¥çœ‹è¿›ç¨‹ ps -au | grep xxx&gt; &gt; æ€æ­»è¿›ç¨‹ kill -9 xxx&gt; &gt; 123456&gt; &gt; # ä¸å…è®¸ç”¨æˆ·ç™»å½•&gt; &gt; useradd -u 523 -g 1000 -s /sbin/nologin user7&gt; &gt; &gt; &gt; # ä¿®æ”¹æ­¤ç”¨æˆ·ç™»å½•æƒé™ä¸º /bin/bash&gt; &gt; usermod -s /bin/bash user7&gt; &gt; è®¾ç½®å¯†ç  passwd spark æ ¹æ®æç¤ºè®¾ç½®å¯†ç å³å¯ åˆ›å»ºå¯†ç å·¥å…· mkpasswd ä¸‹è½½ï¼š yum -y install expect mkpasswd -l 14 åˆ›å»ºä¸€ä¸ª14ä½æ•°çš„å¯†ç  mkpasswd -l 15 -s 0: -sæ˜¯è®¾ç½®ç‰¹æ®Šç¬¦å·çš„é•¿åº¦, è¿™é‡Œæ˜¯ä¸è¦ç‰¹æ®Šç¬¦å· 123456789101112131415161718192021222324&gt; ### ä¿®æ”¹å¯†ç &gt; # æ­¤æ—¶åªéœ€è¦è¾“å…¥ä¸€éå¯†ç &gt; passwd --stdin user4 &gt; &gt; # é€šè¿‡ç®¡é“å¯ä»¥ç›´æŽ¥æ›´æ”¹&gt; echo "123" | passwd --stdin user4&gt; &gt; # é€šè¿‡æ‰‹åŠ¨è¾“å…¥å›žè½¦ç¬¦ `\n` æ¥å®žçŽ°2éç¡®è®¤ -eï¼šæ¿€æ´»è½¬ä¹‰å­—ç¬¦ã€‚&gt; echo -e "123\n123\n" | passwd user4&gt; &gt; =======#é¢å¤–çŸ¥è¯†ç‚¹&gt; # ä½¿ç”¨echo -eé€‰é¡¹æ—¶ï¼Œè‹¥å­—ç¬¦ä¸²ä¸­å‡ºçŽ°ä»¥ä¸‹å­—ç¬¦ï¼Œåˆ™ç‰¹åˆ«åŠ ä»¥å¤„ç†ï¼Œè€Œä¸ä¼šå°†å®ƒå½“æˆä¸€èˆ¬æ–‡å­—è¾“å‡ºï¼š&gt; \a å‘å‡ºè­¦å‘Šå£°ï¼›&gt; \b åˆ é™¤å‰ä¸€ä¸ªå­—ç¬¦ï¼›&gt; \c æœ€åŽä¸åŠ ä¸Šæ¢è¡Œç¬¦å·ï¼›&gt; \f æ¢è¡Œä½†å…‰æ ‡ä»æ—§åœç•™åœ¨åŽŸæ¥çš„ä½ç½®ï¼›&gt; \n æ¢è¡Œä¸”å…‰æ ‡ç§»è‡³è¡Œé¦–ï¼›&gt; \r å…‰æ ‡ç§»è‡³è¡Œé¦–ï¼Œä½†ä¸æ¢è¡Œï¼›&gt; \t æ’å…¥tabï¼›&gt; \v ä¸Ž\fç›¸åŒï¼›&gt; \ æ’å…¥\å­—ç¬¦ï¼›&gt; \nnn æ’å…¥nnnï¼ˆå…«è¿›åˆ¶ï¼‰æ‰€ä»£è¡¨çš„ASCIIå­—ç¬¦ï¼›&gt; &gt; ä¿®æ”¹ç”¨æˆ· ä¿®æ”¹sparkç™»å½•åä¸ºstormï¼šusermod -l spark storm å°†sparkæ·»åŠ åˆ°bigdataå’Œrootç»„ï¼šusermod -G root,bigdata spark æŸ¥çœ‹sparkçš„ç»„ä¿¡æ¯ï¼šgroups spark 1234567891011121314&gt; # usermod : usermodify&gt; # ä½¿ç”¨çš„å‚æ•°è·Ÿuseradd å‡ ä¹Žä¸€æ ·&gt; &gt; chfn user4 : ä¿®æ”¹ç”¨æˆ·çš„finger, ç”µè¯, åŠžå…¬å®¤ç­‰...&gt; # ä¿®æ”¹åŽ, å…¶å®žè¿™é‡Œå°±æ˜¯ä¿®æ”¹çš„å¤‡æ³¨é€‰é¡¹&gt; $ â˜ž grep shixuanji /etc/passwd&gt; shixuanji:x:500:500:airpoet,sh,110,110:/home/shixuanji:/bin/bash&gt; &gt; # ä¿®æ”¹å¤‡æ³¨, è¿™é‡ŒåˆæŠŠä¹‹å‰æ”¹chfnåˆæ”¹äº†&gt; $ â˜ž usermod -c "å“Žå‘€æˆ‘åŽ»" shixuanji&gt; $ â˜ž grep shixuanji /etc/passwd &gt; shixuanji:x:500:500:å“Žå‘€æˆ‘åŽ»:/home/shixuanji:/bin/bash&gt; &gt; åˆ é™¤ç”¨æˆ· userdel -r spark åŠ ä¸€ä¸ª-rå°±è¡¨ç¤ºæŠŠç”¨æˆ·åŠç”¨æˆ·çš„å®¶ç›®å½•, ä¿¡ç®±åœ°å€ç­‰éƒ½åˆ é™¤ æŸ¥çœ‹ç”¨æˆ·çš„ä¿¡æ¯ id ç”¨æˆ·å rootç”¨æˆ·ä»¥å…¶ä»–ç”¨æˆ·çš„æƒé™æ‰§è¡ŒæŸæ¡å‘½ä»¤ 123[~] su -c "touch /tmp/shixuanji.txt" - shixuanji 22:32:02[~] ls -l /tmp/shixuanji.txt 22:32:25-rw-rw-r--. 1 shixuanji shixuanji 0 5æœˆ 29 22:32 /tmp/shixuanji.txt 3. ç»„æ“ä½œå‰é¢æˆ‘ä»¬çŸ¥é“ï¼Œç»„æ˜¯æƒé™çš„é›†åˆã€‚åœ¨linuxç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªç”¨æˆ·ç»„ï¼Œæ²¡æœ‰æŒ‡å®šæ—¶éƒ½é»˜è®¤ä¸ºç§æœ‰ç»„ï¼Œç§æœ‰ç»„ååŒç”¨æˆ·åä¸€è‡´ï¼Œå»ºç«‹ç”¨æˆ·ç»„çš„å¥½å¤„æ˜¯ç³»ç»Ÿèƒ½å¯¹ä¸€ä¸ªç”¨æˆ·ç»„ä¸­çš„æ‰€æœ‰ç”¨æˆ·çš„æ“ä½œæƒé™è¿›è¡Œé›†ä¸­ç®¡ç†ã€‚ç»„ç®¡ç†æ¶‰åŠç»„çš„æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹ã€‚ç»„çš„å¢žåŠ ã€åˆ é™¤å’Œä¿®æ”¹å®žé™…ä¸Šå°±å¯¹/etc/groupæ–‡ä»¶çš„æ›´æ–° æ·»åŠ ä¸€ä¸ªå«bigdataçš„ç»„ groupadd bigdata æŸ¥çœ‹ç³»ç»Ÿå½“å‰æœ‰é‚£äº›ç»„ cat /etc/group å°†sparkç”¨æˆ·æ·»åŠ åˆ°bigdataç»„ä¸­ usermod -G bigdata spark æˆ–è€… gpasswd -a spark bigdata è¿™ä¸¤ä¸ªå‘½ä»¤çš„åŒºåˆ†è®°å¿†æŠ€å·§ï¼š å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Œå°±è¯æ˜Žå¯¹ä»€ä¹ˆåšæ“ä½œï¼Œæ‰€ä»¥æœ€åŽçš„å‚æ•°å°±æ˜¯å‘½ä»¤çš„æ“ä½œå¯¹è±¡ï¼Œä¸­é—´çš„å¯é€‰é¡¹è¡¨ç¤ºè¦å¹²å˜› å°†sparkç”¨æˆ·ä»Žbigdataç»„åˆ é™¤ gpasswd -d spark bigdata å°†bigdataç»„åä¿®æ”¹ä¸ºbigspark groupmod -n bigspark bigdata åˆ é™¤ç»„ groupdel bigdata 4. ä¸ºç”¨æˆ·é…ç½®sudoeræƒé™æ™®é€šæƒ…å†µä¸‹ï¼Œä½¿ç”¨æ™®é€šç”¨æˆ·è¿›è¡Œä¸€äº›ç®€å•çš„æ“ä½œå°±OKï¼Œä½†æ˜¯æ™®é€šç”¨æˆ·å’Œrootç”¨æˆ·çš„åŒºåˆ«å°±åœ¨äºŽrootç”¨æˆ·èƒ½å¯¹ç³»ç»Ÿåšä»»ä½•äº‹ï¼Œä½†æ˜¯æ™®é€šç”¨æˆ·å°±ä¸è¡Œã€‚å¤„å¤„å—é™ã€‚é‚£ä¹ˆå‡å¦‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ™®é€šç”¨æˆ·æƒ³æ‹¥æœ‰æ›´å¤§çš„æƒé™åšæ›´å¤šçš„äº‹æƒ…ï¼Œè™½ç„¶æœ‰æƒé™é™åˆ¶ï¼Œä½†ä¹Ÿä¸æ˜¯ä¸å¯ä»¥ã€‚éƒ¨åˆ†æ“ä½œè¿˜æ˜¯å¯ä»¥èµ‹äºˆæ›´é«˜çš„æƒé™è®©æ™®é€šç”¨æˆ·åšä¸€æ¬¡ã€‚è¿™å°±éœ€è¦ç»™æ™®é€šç”¨æˆ·é…ç½®rootæƒé™äº†ã€‚æ„æ€å°±æ˜¯è®©æ™®é€šç”¨æˆ·ä½¿ç”¨rootæƒé™åŽ»åšä¸€äº›æ“ä½œï¼Œè¿™å½“ç„¶æ˜¯éœ€è¦é…ç½®çš„ã€‚ ç”¨rootç¼–è¾‘ vi /etc/sudoers ç›´æŽ¥ç”¨å‘½ä»¤ visudoä¹Ÿå¯ä»¥ç›´æŽ¥ç¼–è¾‘æ­¤æ–‡ä»¶ åœ¨æ–‡ä»¶çš„å¦‚ä¸‹ä½ç½®ï¼Œä¸ºhadoopæ·»åŠ ä¸€è¡Œå³å¯ root ALL=(ALL) ALL hadoop ALL=(ALL) ALL spark ALL=(ALL) ALL ç„¶åŽï¼Œhadoopç”¨æˆ·å’Œsparkç”¨æˆ·å°±å¯ä»¥ç”¨sudoæ¥æ‰§è¡Œç³»ç»Ÿçº§åˆ«çš„æŒ‡ä»¤ [hadoop\@hadoop01 ~]\$ sudo useradd huangxiaoming 123456789&gt; ~ âž¤ su shixuanji # ä¿®æ”¹äº†é…ç½®æ–‡ä»¶ä¹‹åŽ, ç”¨sudoå¯ä»¥è®¿é—®root&gt; [shixuanji@cts1 root]$ sudo /bin/ls /root&gt; [sudo] password for shixuanji:&gt; anaconda-ks.cfg date.txt Documents git-2018-05-22 install.log.syslog Music Public Videos&gt; autojump Desktop Downloads install.log k-vim Pictures Templates wget-log&gt; [shixuanji@cts1 root]$ ls /root&gt; ls: æ— æ³•æ‰“å¼€ç›®å½•/root: æƒé™ä¸å¤Ÿ&gt; [shixuanji@cts1 root]$&gt; è®©ä¸€ä¸ªæ™®é€šç”¨æˆ·å¯ä»¥æ— å¯†ç ç™»å½•åˆ°rootç”¨æˆ·, è¿˜æ˜¯ä¿®æ”¹é…ç½®æ–‡ä»¶ /etc/sudoers` ç¦æ­¢è¿œç¨‹ç™»å½• ä¿®æ”¹ vi /etc/ssh/sshd_config æ­¤æ–‡ä»¶ä¸­çš„ #PermitRootLogin yes ä¸º no è¿™æ ·å°±ä¸èƒ½è¿œç¨‹ ssh ç™»å½•äº† æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿— æŸ¥çœ‹ç™»å½•é”™è¯¯ä¹‹ç±»çš„æ—¥å¿— tail /var log/secure æœ‰æ—¶å€™, ç™»å½•æ—¶, è¦è¿‡å‡ ç§’æ‰è®©è¾“å…¥ç™»å½•å¯†ç  ä¿®æ”¹ /etc/ssh/sshd_configä¸­çš„UseDNS=no, å°±ä¸ä¼šåŽ»æ‰¾DNSäº† æ™®é€šç”¨æˆ·å…å¯†ä½¿ç”¨sudo &amp; å…å¯†ç™»å½•ä¸ºroot12345678vi /ect/sudoers# è®¾ç½®ä¸éœ€è¦ä½¿ç”¨å¯†ç ä½¿ç”¨sudoap ALL=(ALL) NOPASSWD: ALL # ä½¿ç”¨ sudo su - å…å¯†ç™»å½•åˆ°rootè´¦æˆ·User_Alias USER_SU=apCmnd_Alias SU=/bin/suUSER_SU ALL=(ALL) NOPASSWD: SU 5. åˆ‡æ¢ç”¨æˆ·åœ¨linuxçš„ç³»ç»Ÿä½¿ç”¨è¿‡ç¨‹å½“ä¸­ï¼Œå…ä¸äº†ä¼šæœ‰å¤šä¸ªç”¨æˆ·æ¥å›žåˆ‡æ¢ä½¿ç”¨ã€‚ æ‰€ä»¥åœ¨æ­¤æä¾›åˆ‡æ¢ç”¨æˆ·çš„ä½¿ç”¨æ“ä½œï¼šåˆ‡æ¢ç”¨æˆ·ä½¿ç”¨çš„å‘½ä»¤æ˜¯ suï¼ˆswitch userï¼‰ ä»Žæ™®é€šç”¨æˆ·åˆ‡æ¢åˆ°rootç”¨æˆ· , éœ€è¦è¾“å¯†ç  su root æˆ– su ä»Žrootç”¨æˆ·åˆ‡æ¢åˆ°æ™®é€šç”¨æˆ·, ä¸éœ€è¦è¾“å¯†ç  su xxx 5. æ–‡ä»¶æƒé™1ã€linuxæ–‡ä»¶æƒé™çš„æè¿°æ ¼å¼è§£è¯»Linuxç”¨ æˆ·åˆ†ä¸ºï¼šæ‹¥æœ‰è€…ã€ç»„ç¾¤(Group)ã€å…¶ä»–ï¼ˆotherï¼‰ï¼ŒLinuxç³»ç»Ÿä¸­ï¼Œé¢„è®¾çš„æƒ…æ³ä¸‹ï¼Œç³»ç»Ÿä¸­æ‰€æœ‰çš„å¸å·ä¸Žä¸€èˆ¬èº«ä»½ä½¿ç”¨è€…ï¼Œä»¥åŠrootçš„ç›¸å…³ä¿¡ æ¯ï¼Œ éƒ½æ˜¯è®°å½•åœ¨/etc/passwdæ–‡ä»¶ä¸­ã€‚æ¯ä¸ªäººçš„å¯†ç åˆ™æ˜¯è®°å½•åœ¨/etc/shadowæ–‡ä»¶ä¸‹ã€‚ æ­¤å¤–ï¼Œæ‰€æœ‰çš„ç»„ç¾¤åç§°è®°å½•åœ¨/etc/groupå…§ linuxæ–‡ä»¶çš„ç”¨æˆ·æƒé™çš„åˆ†æžå›¾ 123456 -rw-r--r-- 1 user staff 651 Oct 12 12:53 .gitmodules# â†‘â•°â”¬â•¯â•°â”¬â•¯â•°â”¬â•¯# â”† â”† â”† â•°â”ˆ 0 å…¶ä»–äºº# â”† â”† â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ g å±žç»„# â”† â•°â”ˆâ”ˆâ”ˆâ”ˆ u å±žä¸»# â•°â”ˆâ”ˆ ç¬¬ä¸€ä¸ªå­—æ¯ `d` ä»£è¡¨ç›®å½•ï¼Œ`-` ä»£è¡¨æ™®é€šæ–‡ä»¶ dï¼šæ ‡è¯†èŠ‚ç‚¹ç±»åž‹ï¼ˆdï¼šæ–‡ä»¶å¤¹ -ï¼šæ–‡ä»¶ lï¼šé“¾æŽ¥ï¼‰ rï¼šå¯è¯» wï¼šå¯å†™ xï¼šå¯æ‰§è¡Œ æ–‡ä»¶ æ–‡ä»¶å¤¹ r å¯è¯»å–å†…å®¹ å¯ä»¥ls w å¯ä¿®æ”¹æ–‡ä»¶çš„å†…å®¹ å¯ä»¥åœ¨å…¶ä¸­åˆ›å»ºæˆ–è€…åˆ é™¤å­èŠ‚ç‚¹ x èƒ½å¦è¿è¡Œè¿™ä¸ªæ–‡ä»¶ èƒ½å¦cd**è¿›å…¥è¿™ä¸ªç›®å½•** 2ã€ ä¿®æ”¹æ–‡ä»¶æƒé™chmodå‘½ä»¤ ç”¨æ¥å˜æ›´æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚åœ¨UNIXç³»ç»Ÿå®¶æ—é‡Œï¼Œæ–‡ä»¶æˆ–ç›®å½•æƒé™çš„æŽ§åˆ¶åˆ†åˆ«ä»¥è¯»å–ã€å†™å…¥ã€æ‰§è¡Œ3ç§ä¸€èˆ¬æƒé™æ¥åŒºåˆ†ï¼Œå¦æœ‰3ç§ç‰¹æ®Šæƒé™å¯ä¾›è¿ç”¨ã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨chmodæŒ‡ä»¤åŽ»å˜æ›´æ–‡ä»¶ä¸Žç›®å½•çš„æƒé™ï¼Œè®¾ç½®æ–¹å¼é‡‡ç”¨æ–‡å­—æˆ–æ•°å­—ä»£å·çš†å¯ã€‚ç¬¦å·è¿žæŽ¥çš„æƒé™æ— æ³•å˜æ›´ï¼Œå¦‚æžœç”¨æˆ·å¯¹ç¬¦å·è¿žæŽ¥ä¿®æ”¹æƒé™ï¼Œå…¶æ”¹å˜ä¼šä½œç”¨åœ¨è¢«è¿žæŽ¥çš„åŽŸå§‹æ–‡ä»¶ã€‚ è¯­æ³•12345chmod(é€‰é¡¹)(å‚æ•°)r=è¯»å–å±žæ€§ //å€¼ï¼4 w=å†™å…¥å±žæ€§ //å€¼ï¼2 x=æ‰§è¡Œå±žæ€§ //å€¼ï¼1 é€‰é¡¹ï¼š u Userï¼Œå³æ–‡ä»¶æˆ–ç›®å½•çš„æ‹¥æœ‰è€…ï¼›g Groupï¼Œå³æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±žç¾¤ç»„ï¼›o Otherï¼Œé™¤äº†æ–‡ä»¶æˆ–ç›®å½•æ‹¥æœ‰è€…æˆ–æ‰€å±žç¾¤ç»„ä¹‹å¤–ï¼Œå…¶ä»–ç”¨æˆ·çš†å±žäºŽè¿™ä¸ªèŒƒå›´ï¼›a Allï¼Œå³å…¨éƒ¨çš„ç”¨æˆ·ï¼ŒåŒ…å«æ‹¥æœ‰è€…ï¼Œæ‰€å±žç¾¤ç»„ä»¥åŠå…¶ä»–ç”¨æˆ·ï¼›r è¯»å–æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ4â€;w å†™å…¥æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ2â€ï¼›x æ‰§è¡Œæˆ–åˆ‡æ¢æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ1â€ï¼›- ä¸å…·ä»»ä½•æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ0â€ï¼›s ç‰¹æ®ŠåŠŸèƒ½è¯´æ˜Žï¼šå˜æ›´æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚ å‚æ•°: æƒé™æ¨¡å¼ï¼šæŒ‡å®šæ–‡ä»¶çš„æƒé™æ¨¡å¼ï¼›æ–‡ä»¶ï¼šè¦æ”¹å˜æƒé™çš„æ–‡ä»¶ã€‚ ç¤ºä¾‹å˜æ›´ æ–‡ä»¶/ç›®å½• çš„æƒé™ 1234567891011# ç›´æŽ¥ä¿®æ”¹chmod g-rw haha.dat ## è¡¨ç¤ºå°†haha.datå¯¹æ‰€å±žç»„çš„rwæƒé™å–æ¶ˆchmod o-rw haha.dat ## è¡¨ç¤ºå°†haha.datå¯¹å…¶ä»–äººçš„rwæƒé™å–æ¶ˆchmod u+x haha.dat ## è¡¨ç¤ºå°†haha.datå¯¹æ‰€å±žç”¨æˆ·çš„æƒé™å¢žåŠ xchmod a-x haha.dat ## è¡¨ç¤ºå°†haha.datå¯¹æ‰€ç”¨æˆ·å–æ¶ˆxæƒé™# ä¹Ÿå¯ä»¥ç”¨æ•°å­—çš„æ–¹å¼æ¥ä¿®æ”¹æƒé™(å¸¸ç”¨)chmod 664 haha.datå°±ä¼šä¿®æ”¹æˆ rw-rw-r--å¦‚æžœè¦å°†ä¸€ä¸ªæ–‡ä»¶å¤¹çš„æ‰€æœ‰å†…å®¹æƒé™ç»Ÿä¸€ä¿®æ”¹ï¼Œåˆ™å¯ä»¥-Rå‚æ•°chmod -R 770 aaa/ å˜æ›´ æ–‡ä»¶/ç›®å½• çš„æ‹¥æœ‰è€… æˆ– æ‰€å±žç»„ 1234# &lt;åªæœ‰rootæƒé™èƒ½æ‰§è¡Œ&gt;chown angela aaa ## æ”¹å˜æ‰€å±žç”¨æˆ·chown :angela aaa ## æ”¹å˜æ‰€å±žç»„chown angela:angela aaa/ ## åŒæ—¶ä¿®æ”¹æ‰€å±žç”¨æˆ·å’Œæ‰€å±žç»„ 6. åŽ‹ç¼©æ‰“åŒ…gzipgzipæ˜¯åœ¨Linuxç³»ç»Ÿä¸­ç»å¸¸ä½¿ç”¨çš„ä¸€ä¸ªå¯¹æ–‡ä»¶è¿›è¡ŒåŽ‹ç¼©å’Œè§£åŽ‹ç¼©çš„å‘½ä»¤ï¼Œæ—¢æ–¹ä¾¿åˆå¥½ç”¨ã€‚ gzipæ˜¯ä¸ªä½¿ç”¨å¹¿æ³›çš„åŽ‹ç¼©ç¨‹åºï¼Œæ–‡ä»¶ç»å®ƒåŽ‹ç¼©è¿‡åŽï¼Œå…¶åç§°åŽé¢ä¼šå¤šå¤„â€œ.gzâ€æ‰©å±•åã€‚ è¯­æ³• gzip (é€‰é¡¹) (å‚æ•°) é€‰é¡¹ 123456789101112131415161718-aæˆ–â€”â€”asciiï¼šä½¿ç”¨ASCIIæ–‡å­—æ¨¡å¼ï¼›-dæˆ–--decompressæˆ–----uncompressï¼šè§£å¼€åŽ‹ç¼©æ–‡ä»¶ï¼›-fæˆ–â€”â€”forceï¼šå¼ºè¡ŒåŽ‹ç¼©æ–‡ä»¶ã€‚ä¸ç†ä¼šæ–‡ä»¶åç§°æˆ–ç¡¬è¿žæŽ¥æ˜¯å¦å­˜åœ¨ä»¥åŠè¯¥æ–‡ä»¶æ˜¯å¦ä¸ºç¬¦å·è¿žæŽ¥ï¼›-hæˆ–â€”â€”helpï¼šåœ¨çº¿å¸®åŠ©ï¼›-læˆ–â€”â€”listï¼šåˆ—å‡ºåŽ‹ç¼©æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ï¼›-Læˆ–â€”â€”licenseï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¸Žç‰ˆæƒä¿¡æ¯ï¼›-næˆ–--no-nameï¼šåŽ‹ç¼©æ–‡ä»¶æ—¶ï¼Œä¸ä¿å­˜åŽŸæ¥çš„æ–‡ä»¶åç§°åŠæ—¶é—´æˆ³è®°ï¼›-Næˆ–â€”â€”nameï¼šåŽ‹ç¼©æ–‡ä»¶æ—¶ï¼Œä¿å­˜åŽŸæ¥çš„æ–‡ä»¶åç§°åŠæ—¶é—´æˆ³è®°ï¼›-qæˆ–â€”â€”quietï¼šä¸æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ï¼›-ræˆ–â€”â€”recursiveï¼šé€’å½’å¤„ç†ï¼Œå°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠå­ç›®å½•ä¸€å¹¶å¤„ç†ï¼›-Sæˆ–&lt;åŽ‹ç¼©å­—å°¾å­—ç¬¦ä¸²&gt;æˆ–----suffix&lt;åŽ‹ç¼©å­—å°¾å­—ç¬¦ä¸²&gt;ï¼šæ›´æ”¹åŽ‹ç¼©å­—å°¾å­—ç¬¦ä¸²ï¼›-tæˆ–â€”â€”testï¼šæµ‹è¯•åŽ‹ç¼©æ–‡ä»¶æ˜¯å¦æ­£ç¡®æ— è¯¯ï¼›-væˆ–â€”â€”verboseï¼šæ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ï¼›-Væˆ–â€”â€”versionï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼›-&lt;åŽ‹ç¼©æ•ˆçŽ‡&gt;ï¼šåŽ‹ç¼©æ•ˆçŽ‡æ˜¯ä¸€ä¸ªä»‹äºŽ1~9çš„æ•°å€¼ï¼Œé¢„è®¾å€¼ä¸ºâ€œ6â€ï¼ŒæŒ‡å®šæ„ˆå¤§çš„æ•°å€¼ï¼ŒåŽ‹ç¼©æ•ˆçŽ‡å°±ä¼šæ„ˆé«˜ï¼›--bestï¼šæ­¤å‚æ•°çš„æ•ˆæžœå’ŒæŒ‡å®šâ€œ-9â€å‚æ•°ç›¸åŒï¼›--fastï¼šæ­¤å‚æ•°çš„æ•ˆæžœå’ŒæŒ‡å®šâ€œ-1â€å‚æ•°ç›¸åŒã€‚-num ç”¨æŒ‡å®šçš„æ•°å­—numè°ƒæ•´åŽ‹ç¼©çš„é€Ÿåº¦ï¼Œ-1æˆ–--fastè¡¨ç¤ºæœ€å¿«åŽ‹ç¼©æ–¹æ³•ï¼ˆä½ŽåŽ‹ç¼©æ¯”ï¼‰ï¼Œ-9æˆ–--bestè¡¨ç¤ºæœ€æ…¢åŽ‹ç¼©æ–¹æ³•ï¼ˆé«˜åŽ‹ç¼©æ¯”ï¼‰ã€‚ç³»ç»Ÿç¼ºçœå€¼ä¸º6ã€‚ å‚æ•° æ–‡ä»¶åˆ—è¡¨ï¼šæŒ‡å®šè¦åŽ‹ç¼©çš„æ–‡ä»¶åˆ—è¡¨ã€‚ ç¤ºä¾‹ 12345678910111213# æŠŠtest6ç›®å½•ä¸‹çš„æ¯ä¸ªæ–‡ä»¶åŽ‹ç¼©æˆ.gzæ–‡ä»¶gzip *# æŠŠä¸Šä¾‹ä¸­æ¯ä¸ªåŽ‹ç¼©çš„æ–‡ä»¶è§£åŽ‹ï¼Œå¹¶åˆ—å‡ºè¯¦ç»†çš„ä¿¡æ¯gzip -dv *# è¯¦ç»†æ˜¾ç¤ºä¾‹1ä¸­æ¯ä¸ªåŽ‹ç¼©çš„æ–‡ä»¶çš„ä¿¡æ¯ï¼Œå¹¶ä¸è§£åŽ‹gzip -l *# åŽ‹ç¼©ä¸€ä¸ªtarå¤‡ä»½æ–‡ä»¶ï¼Œæ­¤æ—¶åŽ‹ç¼©æ–‡ä»¶çš„æ‰©å±•åä¸º.tar.gzgzip -r log.tar# é€’å½’çš„åŽ‹ç¼©ç›®å½•gzip -rv test6# è¿™æ ·ï¼Œæ‰€æœ‰testä¸‹é¢çš„æ–‡ä»¶éƒ½å˜æˆäº†.gzï¼Œç›®å½•ä¾ç„¶å­˜åœ¨åªæ˜¯ç›®å½•é‡Œé¢çš„æ–‡ä»¶ç›¸åº”å˜æˆäº†.gz.è¿™å°±æ˜¯åŽ‹ç¼©ï¼Œå’Œæ‰“åŒ…ä¸åŒã€‚å› ä¸ºæ˜¯å¯¹ç›®å½•æ“ä½œï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸Š-ré€‰é¡¹ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥å¯¹å­ç›®å½•è¿›è¡Œé€’å½’äº†ã€‚# é€’å½’åœ°è§£åŽ‹ç›®å½•gzip -dr test6 bzipbzip2å‘½ä»¤ ç”¨äºŽåˆ›å»ºå’Œç®¡ç†ï¼ˆåŒ…æ‹¬è§£åŽ‹ç¼©ï¼‰â€œ.bz2â€æ ¼å¼çš„åŽ‹ç¼©åŒ…ã€‚ è¯­æ³• bzip2 (é€‰é¡¹) (å‚æ•°) é€‰é¡¹ 123456789101112-cæˆ–â€”â€”stdoutï¼šå°†åŽ‹ç¼©ä¸Žè§£åŽ‹ç¼©çš„ç»“æžœé€åˆ°æ ‡å‡†è¾“å‡ºï¼›-dæˆ–â€”â€”decompressï¼šæ‰§è¡Œè§£åŽ‹ç¼©ï¼›-fæˆ–-forceï¼šbzip2åœ¨åŽ‹ç¼©æˆ–è§£åŽ‹ç¼©æ—¶ï¼Œè‹¥è¾“å‡ºæ–‡ä»¶ä¸ŽçŽ°æœ‰æ–‡ä»¶åŒåï¼Œé¢„è®¾ä¸ä¼šè¦†ç›–çŽ°æœ‰æ–‡ä»¶ã€‚è‹¥è¦è¦†ç›–ã€‚è¯·ä½¿ç”¨æ­¤å‚æ•°ï¼›-hæˆ–â€”â€”helpï¼šåœ¨çº¿å¸®åŠ©ï¼›-kæˆ–â€”â€”keepï¼šbzip2åœ¨åŽ‹ç¼©æˆ–è§£åŽ‹ç¼©åŽï¼Œä¼šåˆ é™¤åŽŸå§‹æ–‡ä»¶ã€‚è‹¥è¦ä¿ç•™åŽŸå§‹æ–‡ä»¶ï¼Œè¯·ä½¿ç”¨æ­¤å‚æ•°ï¼›-sæˆ–â€”â€”smallï¼šé™ä½Žç¨‹åºæ‰§è¡Œæ—¶å†…å­˜çš„ä½¿ç”¨é‡ï¼›-tæˆ–â€”â€”testï¼šæµ‹è¯•.bz2åŽ‹ç¼©æ–‡ä»¶çš„å®Œæ•´æ€§ï¼›-væˆ–â€”â€”verboseï¼šåŽ‹ç¼©æˆ–è§£åŽ‹ç¼©æ–‡ä»¶æ—¶ï¼Œæ˜¾ç¤ºè¯¦ç»†çš„ä¿¡æ¯ï¼›-zæˆ–â€”â€”compressï¼šå¼ºåˆ¶æ‰§è¡ŒåŽ‹ç¼©ï¼›-Væˆ–â€”â€”versionï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼›--repetitive-bestï¼šè‹¥æ–‡ä»¶ä¸­æœ‰é‡å¤å‡ºçŽ°çš„èµ„æ–™æ—¶ï¼Œå¯åˆ©ç”¨æ­¤å‚æ•°æé«˜åŽ‹ç¼©æ•ˆæžœï¼›--repetitive-fastï¼šè‹¥æ–‡ä»¶ä¸­æœ‰é‡å¤å‡ºçŽ°çš„èµ„æ–™æ—¶ï¼Œå¯åˆ©ç”¨æ­¤å‚æ•°åŠ å¿«æ‰§è¡Œæ•ˆæžœã€‚ å‚æ•° æ–‡ä»¶ï¼šæŒ‡å®šè¦åŽ‹ç¼©çš„æ–‡ä»¶ã€‚ ç¤ºä¾‹ 1234567891011## åŽ‹ç¼©æŒ‡å®šæ–‡ä»¶filename:bzip2 filename æˆ– bzip2 -z filename## è§£åŽ‹æŒ‡å®šçš„æ–‡ä»¶filename.bz2:bzip2 -d filename.bz2 æˆ– bunzip2 filename.bz2# åŽ‹ç¼©è§£åŽ‹çš„æ—¶å€™å°†ç»“æžœä¹Ÿè¾“å‡ºï¼šbzip2 -v filename filename: 0.119:1, 67.200 bits/byte, -740.00% saved, 5 in, 42 out.# åŽ‹ç¼©è§£åŽ‹çš„æ—¶å€™ï¼Œé™¤äº†ç”Ÿæˆç»“æžœæ–‡ä»¶ï¼Œå°†åŽŸæ¥çš„æ–‡ä»¶ä¹Ÿä¿å­˜: bzip2 -k filename# è§£åŽ‹åˆ°æ ‡å‡†è¾“å‡º, è¾“å‡ºæ–‡ä»¶çš„å†…å®¹bzip2 -dc filename.bz2 tarLinuxä¸‹çš„å½’æ¡£ä½¿ç”¨å·¥å…·ï¼Œç”¨æ¥æ‰“åŒ…å’Œå¤‡ä»½ã€‚ é¦–å…ˆè¦å¼„æ¸…ä¸¤ä¸ªæ¦‚å¿µï¼šæ‰“åŒ…å’ŒåŽ‹ç¼©ã€‚æ‰“åŒ…æ˜¯æŒ‡å°†ä¸€å¤§å †æ–‡ä»¶æˆ–ç›®å½•å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼›åŽ‹ç¼©åˆ™æ˜¯å°†ä¸€ä¸ªå¤§çš„æ–‡ä»¶é€šè¿‡ä¸€äº›åŽ‹ç¼©ç®—æ³•å˜æˆä¸€ä¸ªå°æ–‡ä»¶ã€‚ ä¸ºä»€ä¹ˆè¦åŒºåˆ†è¿™ä¸¤ä¸ªæ¦‚å¿µå‘¢ï¼Ÿè¿™æºäºŽLinuxä¸­å¾ˆå¤šåŽ‹ç¼©ç¨‹åºåªèƒ½é’ˆå¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡ŒåŽ‹ç¼©ï¼Œè¿™æ ·å½“ä½ æƒ³è¦åŽ‹ç¼©ä¸€å¤§å †æ–‡ä»¶æ—¶ï¼Œä½ å¾—å…ˆå°†è¿™ä¸€å¤§å †æ–‡ä»¶å…ˆæ‰“æˆä¸€ä¸ªåŒ…ï¼ˆtarå‘½ä»¤ï¼‰ï¼Œç„¶åŽå†ç”¨åŽ‹ç¼©ç¨‹åºè¿›è¡ŒåŽ‹ç¼©ï¼ˆgzip bzip2å‘½ä»¤ï¼‰ã€‚ å…¶å®žæœ€ç®€å•çš„ä½¿ç”¨ tar å°±åªè¦è®°å¿†åº•ä¸‹çš„æ–¹å¼å³å¯ï¼š tar.gz æ ¼å¼: 1234# ä¸€æ¬¡æ€§æ‰“åŒ…å¹¶åŽ‹ç¼©ã€è§£åŽ‹å¹¶è§£åŒ…æ‰“åŒ…å¹¶åŽ‹ç¼©ï¼š tar -zcvf [ç›®æ ‡æ–‡ä»¶å].tar.gz [åŽŸæ–‡ä»¶å/ç›®å½•å]è§£åŽ‹å¹¶è§£åŒ…ï¼š tar -zxvf [åŽŸæ–‡ä»¶å].tar.gz -C [ç›®æ ‡ç›®å½•]æ³¨ï¼šzä»£è¡¨ç”¨gzipç®—æ³•æ¥åŽ‹ç¼©/è§£åŽ‹ã€‚ tar.bz2æ ¼å¼: 1234# ä¸€æ¬¡æ€§æ‰“åŒ…å¹¶åŽ‹ç¼©ã€è§£åŽ‹å¹¶è§£åŒ…æ‰“åŒ…å¹¶åŽ‹ç¼©ï¼š tar -jcvf [ç›®æ ‡æ–‡ä»¶å].tar.bz2 [åŽŸæ–‡ä»¶å/ç›®å½•å]è§£åŽ‹å¹¶è§£åŒ…ï¼š tar -jxvf [åŽŸæ–‡ä»¶å].tar.bz2æ³¨ï¼šå°å†™jä»£è¡¨ç”¨bzip2ç®—æ³•æ¥åŽ‹ç¼©/è§£åŽ‹ã€‚ å…¶å®žç”¨ä¸åˆ°çš„è¯å°±ä¸ç”¨çœ‹äº†, ä¸‹é¢çš„. è¯­æ³• tar(é€‰é¡¹)(å‚æ•°) é€‰é¡¹ 1234567891011121314151617181920212223-Aæˆ–--catenateï¼šæ–°å¢žæ–‡ä»¶åˆ°ä»¥å­˜åœ¨çš„å¤‡ä»½æ–‡ä»¶ï¼›-Bï¼šè®¾ç½®åŒºå—å¤§å°ï¼›-cæˆ–--createï¼šå»ºç«‹æ–°çš„å¤‡ä»½æ–‡ä»¶ï¼›-C &lt;ç›®å½•&gt;ï¼šè¿™ä¸ªé€‰é¡¹ç”¨åœ¨è§£åŽ‹ç¼©ï¼Œè‹¥è¦åœ¨ç‰¹å®šç›®å½•è§£åŽ‹ç¼©ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ã€‚-dï¼šè®°å½•æ–‡ä»¶çš„å·®åˆ«ï¼›-xæˆ–--extractæˆ–--getï¼šä»Žå¤‡ä»½æ–‡ä»¶ä¸­è¿˜åŽŸæ–‡ä»¶ï¼›-tæˆ–--listï¼šåˆ—å‡ºå¤‡ä»½æ–‡ä»¶çš„å†…å®¹ï¼›-zæˆ–--gzipæˆ–--ungzipï¼šé€šè¿‡gzipæŒ‡ä»¤å¤„ç†å¤‡ä»½æ–‡ä»¶ï¼›-Zæˆ–--compressæˆ–--uncompressï¼šé€šè¿‡compressæŒ‡ä»¤å¤„ç†å¤‡ä»½æ–‡ä»¶ï¼›-f&lt;å¤‡ä»½æ–‡ä»¶&gt;æˆ–--file=&lt;å¤‡ä»½æ–‡ä»¶&gt;ï¼šæŒ‡å®šå¤‡ä»½æ–‡ä»¶ï¼›-væˆ–--verboseï¼šæ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ï¼›-rï¼šæ·»åŠ æ–‡ä»¶åˆ°å·²ç»åŽ‹ç¼©çš„æ–‡ä»¶ï¼›-uï¼šæ·»åŠ æ”¹å˜äº†å’ŒçŽ°æœ‰çš„æ–‡ä»¶åˆ°å·²ç»å­˜åœ¨çš„åŽ‹ç¼©æ–‡ä»¶ï¼›-jï¼šæ”¯æŒbzip2è§£åŽ‹æ–‡ä»¶ï¼›-vï¼šæ˜¾ç¤ºæ“ä½œè¿‡ç¨‹ï¼›-lï¼šæ–‡ä»¶ç³»ç»Ÿè¾¹ç•Œè®¾ç½®ï¼›-kï¼šä¿ç•™åŽŸæœ‰æ–‡ä»¶ä¸è¦†ç›–ï¼›-mï¼šä¿ç•™æ–‡ä»¶ä¸è¢«è¦†ç›–ï¼›-wï¼šç¡®è®¤åŽ‹ç¼©æ–‡ä»¶çš„æ­£ç¡®æ€§ï¼›-pæˆ–--same-permissionsï¼šç”¨åŽŸæ¥çš„æ–‡ä»¶æƒé™è¿˜åŽŸæ–‡ä»¶ï¼›-Pæˆ–--absolute-namesï¼šæ–‡ä»¶åä½¿ç”¨ç»å¯¹åç§°ï¼Œä¸ç§»é™¤æ–‡ä»¶åç§°å‰çš„â€œ/â€å·ï¼›-N &lt;æ—¥æœŸæ ¼å¼&gt; æˆ– --newer=&lt;æ—¥æœŸæ—¶é—´&gt;ï¼šåªå°†è¾ƒæŒ‡å®šæ—¥æœŸæ›´æ–°çš„æ–‡ä»¶ä¿å­˜åˆ°å¤‡ä»½æ–‡ä»¶é‡Œï¼›--exclude=&lt;èŒƒæœ¬æ ·å¼&gt;ï¼šæŽ’é™¤ç¬¦åˆèŒƒæœ¬æ ·å¼çš„æ–‡ä»¶ã€‚ å‚æ•° æ–‡ä»¶æˆ–ç›®å½•ï¼šæŒ‡å®šè¦æ‰“åŒ…çš„æ–‡ä»¶æˆ–ç›®å½•åˆ—è¡¨ã€‚ -f: ä½¿ç”¨æ¡£æ¡ˆåå­—ï¼Œåˆ‡è®°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯æœ€åŽä¸€ä¸ªå‚æ•°ï¼ŒåŽé¢åªèƒ½æŽ¥æ¡£æ¡ˆåã€‚ 12345- zï¼šæœ‰gzipå±žæ€§çš„- jï¼šæœ‰bz2å±žæ€§çš„- Zï¼šæœ‰compresså±žæ€§çš„- vï¼šæ˜¾ç¤ºæ‰€æœ‰è¿‡ç¨‹- Oï¼šå°†æ–‡ä»¶è§£å¼€åˆ°æ ‡å‡†è¾“å‡º å®žä¾‹ zipæ ¼å¼ 123åŽ‹ç¼©ï¼š zip -r [ç›®æ ‡æ–‡ä»¶å].zip [åŽŸæ–‡ä»¶/ç›®å½•å]è§£åŽ‹ï¼š unzip [åŽŸæ–‡ä»¶å].zipæ³¨ï¼š -rå‚æ•°ä»£è¡¨é€’å½’ taræ ¼å¼ï¼ˆè¯¥æ ¼å¼ä»…ä»…æ‰“åŒ…ï¼Œä¸åŽ‹ç¼©ï¼‰ 123æ‰“åŒ…ï¼štar -cvf [ç›®æ ‡æ–‡ä»¶å].tar [åŽŸæ–‡ä»¶å/ç›®å½•å]è§£åŒ…ï¼štar -xvf [åŽŸæ–‡ä»¶å].taræ³¨ï¼šcå‚æ•°ä»£è¡¨createï¼ˆåˆ›å»ºï¼‰ï¼Œxå‚æ•°ä»£è¡¨extractï¼ˆè§£åŒ…ï¼‰ï¼Œvå‚æ•°ä»£è¡¨verboseï¼ˆè¯¦ç»†ä¿¡æ¯ï¼‰ï¼Œfå‚æ•°ä»£è¡¨filenameï¼ˆæ–‡ä»¶åï¼‰ï¼Œæ‰€ä»¥fåŽå¿…é¡»æŽ¥æ–‡ä»¶åã€‚ tar.gzæ ¼å¼(æ–¹å¼äºŒå¸¸ç”¨) 12345678# æ–¹å¼ä¸€ï¼šåˆ©ç”¨å‰é¢å·²ç»æ‰“åŒ…å¥½çš„taræ–‡ä»¶ï¼Œç›´æŽ¥ç”¨åŽ‹ç¼©å‘½ä»¤ã€‚åŽ‹ç¼©ï¼šgzip [åŽŸæ–‡ä»¶å].tarè§£åŽ‹ï¼šgunzip [åŽŸæ–‡ä»¶å].tar.gz# æ–¹å¼äºŒï¼šä¸€æ¬¡æ€§æ‰“åŒ…å¹¶åŽ‹ç¼©ã€è§£åŽ‹å¹¶è§£åŒ…æ‰“åŒ…å¹¶åŽ‹ç¼©ï¼š tar -zcvf [ç›®æ ‡æ–‡ä»¶å].tar.gz [åŽŸæ–‡ä»¶å/ç›®å½•å]è§£åŽ‹å¹¶è§£åŒ…ï¼š tar -zxvf [åŽŸæ–‡ä»¶å].tar.gzæ³¨ï¼šzä»£è¡¨ç”¨gzipç®—æ³•æ¥åŽ‹ç¼©/è§£åŽ‹ã€‚ tar.bz2æ ¼å¼ 12345678æ–¹å¼ä¸€ï¼šåˆ©ç”¨å·²ç»æ‰“åŒ…å¥½çš„taræ–‡ä»¶ï¼Œç›´æŽ¥æ‰§è¡ŒåŽ‹ç¼©å‘½ä»¤ï¼šåŽ‹ç¼©ï¼šbzip2 [åŽŸæ–‡ä»¶å].tarè§£åŽ‹ï¼šbunzip2 [åŽŸæ–‡ä»¶å].tar.bz2æ–¹å¼äºŒï¼šä¸€æ¬¡æ€§æ‰“åŒ…å¹¶åŽ‹ç¼©ã€è§£åŽ‹å¹¶è§£åŒ…æ‰“åŒ…å¹¶åŽ‹ç¼©ï¼š tar -jcvf [ç›®æ ‡æ–‡ä»¶å].tar.bz2 [åŽŸæ–‡ä»¶å/ç›®å½•å]è§£åŽ‹å¹¶è§£åŒ…ï¼š tar -jxvf [åŽŸæ–‡ä»¶å].tar.bz2æ³¨ï¼šå°å†™jä»£è¡¨ç”¨bzip2ç®—æ³•æ¥åŽ‹ç¼©/è§£åŽ‹ã€‚ jaræ ¼å¼ 12345678910åŽ‹ç¼©ï¼šjar -cvf [ç›®æ ‡æ–‡ä»¶å].jar [åŽŸæ–‡ä»¶å/ç›®å½•å]è§£åŽ‹ï¼šjar -xvf [åŽŸæ–‡ä»¶å].jar# æ³¨ï¼šå¦‚æžœæ˜¯æ‰“åŒ…çš„æ˜¯Javaç±»åº“ï¼Œå¹¶ä¸”è¯¥ç±»åº“ä¸­å­˜åœ¨ä¸»ç±»ï¼Œé‚£ä¹ˆéœ€è¦å†™ä¸€ä¸ªMETA-INF/MANIFEST.MFé…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼šManifest-Version: 1.0Created-By: 1.6.0_27 (Sun Microsystems Inc.)Main-class: the_name_of_the_main_class_should_be_put_here# ç„¶åŽç”¨å¦‚ä¸‹å‘½ä»¤æ‰“åŒ…ï¼šjar -cvfm [ç›®æ ‡æ–‡ä»¶å].jar META-INF/MANIFEST.MF [åŽŸæ–‡ä»¶å/ç›®å½•å] è¿™æ ·ä»¥åŽå°±èƒ½ç”¨â€œjava -jar [æ–‡ä»¶å].jarâ€å‘½ä»¤ç›´æŽ¥è¿è¡Œä¸»ç±»ä¸­çš„public static void mainæ–¹æ³•äº†ã€‚ 7zæ ¼å¼ 12345åŽ‹ç¼©ï¼š7z a [ç›®æ ‡æ–‡ä»¶å].7z [åŽŸæ–‡ä»¶å/ç›®å½•å]è§£åŽ‹ï¼š7z x [åŽŸæ–‡ä»¶å].7zæ³¨ï¼šè¿™ä¸ª7zè§£åŽ‹å‘½ä»¤æ”¯æŒraræ ¼å¼ï¼Œå³ï¼š7z x [åŽŸæ–‡ä»¶å].rar å…¶å®ƒä¾‹å­ å‚è€ƒç½‘å€ 7. Linuxå¼€å…³æœºå’Œé‡å¯ å¼€æœºï¼šå¼€æœºé”® å…³æœºï¼šshutdownï¼Œhaltï¼Œinit 0ï¼Œpoweroff é‡å¯ï¼šrebootï¼Œinit 6 Shutdownå‘½ä»¤è¯¦è§£ï¼š shutdown -h now ## ç«‹åˆ»å…³æœº shutdown -h +10 ## 10åˆ†é’Ÿä»¥åŽå…³æœº shutdown -h 12:00:00 ##12ç‚¹æ•´çš„æ—¶å€™å…³æœº]]></content>
      <categories>
        <category>Linux</category>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå­¦ä¹ ç¬”è®°-1]]></title>
    <url>%2F2018%2F05%2F26%2FLinux%2FLinux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-1%2F</url>
    <content type="text"><![CDATA[1&gt; åˆè¯†Linux1. Linuxä»‹ç»Linuxç³»ç»Ÿæ˜¯ä¸€å¥—å…è´¹ä½¿ç”¨å’Œè‡ªç”±ä¼ æ’­çš„ç±»UNIXæ“ä½œç³»ç»Ÿï¼ˆä¸»è¦ç”¨åœ¨æœåŠ¡å™¨ä¸Šï¼‰ï¼Œæ˜¯ä¸€ä¸ªåŸºäºŽPOSIXå’ŒUNIXçš„å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€æ”¯æŒå¤šçº¿ç¨‹å’Œå¤šCPUçš„æ“ä½œç³»ç»Ÿã€‚å®ƒèƒ½è¿è¡Œä¸»è¦çš„UNIXå·¥å…·è½¯ä»¶ã€åº”ç”¨ç¨‹åºå’Œç½‘ç»œåè®®ã€‚å®ƒæ”¯æŒ32ä½å’Œ64ä½ç¡¬ä»¶ã€‚Linuxç»§æ‰¿äº†UNIXä»¥ç½‘ç»œä¸ºæ ¸å¿ƒçš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯ä¸€ä¸ªæ€§èƒ½ç¨³å®šçš„å¤šç”¨æˆ·ç½‘ç»œæ“ä½œç³»ç»Ÿã€‚ UNIXï¼šæ“ä½œç³»ç»Ÿï¼Œæ˜¯ç¾Žå›½AT&amp;Tå…¬å¸è´å°”å®žéªŒå®¤äºŽ1969å¹´å®Œæˆçš„æ“ä½œç³»ç»Ÿï¼Œæœ€æ—©ç”±è‚¯Â·æ±¤æ™®é€Šï¼ˆKen Thompsonï¼‰ï¼Œä¸¹å°¼æ–¯Â·é‡Œå¥‡ï¼ˆDennis Ritchieï¼‰å¼€å‘ã€‚åœ¨1971å¹´é¦–æ¬¡å¯¹å¤–å‘å¸ƒï¼Œåˆšå¥½åœ¨1971ï¼Œä¸¹å°¼æ–¯Â·é‡Œå¥‡ï¼ˆDennis Ritchieï¼‰å‘æ˜Žäº†Cè¯­è¨€ï¼ŒåŽæ¥åœ¨1973ï¼ŒUnixè¢«ä»–ç”¨Cè¯­è¨€é‡æ–°ç¼–å†™ã€‚Unixå‰èº«æºè‡ªäºŽMultiCSï¼Œå«UniCSï¼ŒåŽæ¥æ”¹åå«Unixã€‚ POSIXï¼šå¯ç§»æ¤æ“ä½œç³»ç»ŸæŽ¥å£ï¼ˆè‹±è¯­ï¼šPortable Operating System Interface of UNIXï¼Œç¼©å†™ä¸ºPOSIXï¼‰ï¼Œæ˜¯IEEEï¼ˆç”µæ°”å’Œç”µå­å·¥ç¨‹å¸ˆåä¼šï¼‰ä¸ºè¦åœ¨å„ç§UNIXæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œè½¯ä»¶ï¼Œè€Œå®šä¹‰APIçš„ä¸€ç³»åˆ—äº’ç›¸å…³è”çš„æ ‡å‡†çš„æ€»ç§°ã€‚ GNUï¼š1983å¹´ï¼ŒRichard Stallmanï¼ˆç†æŸ¥å¾·Â·é©¬ä¿®Â·æ–¯æ‰˜æ›¼ï¼‰åˆ›ç«‹GNUè®¡åˆ’ã€‚ä¸€å¥—å®Œå…¨è‡ªç”±çš„æ“ä½œç³»ç»Ÿï¼Œå…¶å†…å®¹è½¯ä»¶å®Œå…¨ä»¥GPLæ–¹å¼å‘å¸ƒã€‚è¿™ä¸ªæ“ä½œç³»ç»Ÿæ˜¯GNUè®¡åˆ’çš„ä¸»è¦ç›®æ ‡ï¼ˆå‘å±•å‡ºä¸€å¥—å®Œæ•´çš„å¼€æ”¾æºä»£ç æ“ä½œç³»ç»Ÿæ¥å–ä»£Unixï¼‰ï¼Œåç§°æ¥è‡ªGNU\â€™s Not Unix!çš„é€’å½’ç¼©å†™ã€‚ GPLï¼šä¸€ç§GNUé€šç”¨å…¬å…±è®¸å¯åè®®ï¼Œä¸ºä¿è¯GNUè½¯ä»¶å¯ä»¥è‡ªç”±çš„ä½¿ç”¨ã€å¤åˆ¶ã€ä¿®æ”¹å’Œå‘å¸ƒï¼Œæ‰€æœ‰çš„GNUè½¯ä»¶éƒ½æœ‰ä¸€ä»½åœ¨ç¦æ­¢å…¶ä»–äººæ·»åŠ ä»»ä½•é™åˆ¶çš„æƒ…å†µä¸‹æŽˆæƒæ‰€æœ‰æƒåˆ©ç»™ä»»ä½•äººçš„åè®®æ¡æ¬¾ï¼Œæ˜¯ä¸€ä¸ªè¢«å¹¿æ³›ä½¿ç”¨çš„è‡ªç”±è½¯ä»¶è®¸å¯åè®®æ¡æ¬¾ï¼Œä¿è¯ç»ˆç«¯ç”¨æˆ·è¿è¡Œã€å­¦ä¹ ã€åˆ†äº«ï¼ˆå¤åˆ¶ï¼‰åŠç¼–è¾‘è½¯ä»¶ä¹‹è‡ªç”±ï¼ŒGPLæ˜¯è‡ªç”±è½¯ä»¶å’Œå¼€æºè½¯ä»¶çš„æœ€æµè¡Œè®¸å¯è¯ï¼Œç‰¹è‰²è¡¨çŽ°ï¼š â€¢å–å¾—è½¯ä»¶ä¸ŽåŽŸå§‹ç ï¼šæ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥æ‰§è¡Œè¿™ä¸ªè‡ªç”±è½¯ä»¶ â€¢å¤åˆ¶ï¼šæ‚¨å¯ä»¥è‡ªç”±çš„å¤åˆ¶è¯¥è½¯ä»¶ â€¢ä¿®æ”¹ï¼šæ‚¨å¯ä»¥å°†å–å¾—çš„åŽŸå§‹ç è¿›è¡Œç¨‹åºä¿®æ”¹å·¥ä½œï¼Œä½¿ä¹‹é€‚åˆæ‚¨çš„å·¥ä½œ â€¢å†å‘è¡Œï¼šæ‚¨å¯ä»¥å°†æ‚¨ä¿®æ”¹è¿‡çš„ç¨‹åºï¼Œå†åº¦çš„è‡ªç”±å‘è¡Œï¼Œè€Œä¸ä¼šä¸ŽåŽŸå…ˆçš„æ’°å†™è€…å†²çª â€¢å›žé¦ˆï¼šæ‚¨åº”è¯¥å°†æ‚¨ä¿®æ”¹è¿‡çš„ç¨‹åºä»£ç å›žé¦ˆäºŽç¤¾ç¾¤ ==ä¸åŒè®¸å¯è¯çš„åŒºåˆ«== 1985å¹´ï¼ŒRichard Stallmanåˆåˆ›ç«‹äº†è‡ªç”±è½¯ä»¶åŸºé‡‘ä¼šï¼ˆFree Software Foundationï¼ŒFSFï¼‰æ¥ä¸ºGNUè®¡åˆ’æä¾›æŠ€æœ¯ã€æ³•å¾‹ä»¥åŠè´¢æ”¿æ”¯æŒã€‚ 1990å¹´ï¼ŒGNUè®¡åˆ’å¼€å‘ä¸»è¦é¡¹ç›®æœ‰Emacsï¼ˆæ–‡æœ¬ç¼–è¾‘å™¨ï¼‰ã€GCCï¼ˆGUN Compiler Collectionï¼ŒGNUç¼–è¯‘å™¨é›†åˆï¼‰ã€Bashç­‰ï¼ŒGCCæ˜¯ä¸€å¥—GNUå¼€å‘çš„ç¼–ç¨‹è¯­è¨€ç¼–è¯‘å™¨ã€‚è¿˜æœ‰å¼€å‘ä¸€äº›UNIXç³»ç»Ÿçš„ç¨‹åºåº“å’Œå·¥å…·ã€‚ Linuxæ“ä½œç³»ç»Ÿè¯žç”ŸäºŽ1991å¹´10æœˆ5æ—¥ï¼ˆè¿™æ˜¯ç¬¬ä¸€æ¬¡æ­£å¼å‘å¤–å…¬å¸ƒæ—¶é—´ï¼‰ï¼Œä¸ŽUNIXå…¼å®¹ï¼Œå¹¶åœ¨GPLæ¡æ¬¾ä¸‹å‘å¸ƒã€‚çŽ°åœ¨ï¼ŒLinuxäº§ç”Ÿäº†è®¸å¤šä¸åŒçš„Linuxå‘è¡Œç‰ˆæœ¬ï¼Œä½†å®ƒä»¬éƒ½ä½¿ç”¨äº†Linuxå†…æ ¸ã€‚Linuxå¯å®‰è£…åœ¨å„ç§è®¡ç®—æœºç¡¬ä»¶è®¾å¤‡ä¸­ï¼Œæ¯”å¦‚æ‰‹æœºã€å¹³æ¿ç”µè„‘ã€è·¯ç”±å™¨ã€è§†é¢‘æ¸¸æˆæŽ§åˆ¶å°ã€å°å¼è®¡ç®—æœºã€å¤§åž‹æœºå’Œè¶…çº§è®¡ç®—æœºã€‚ 1992å¹´ï¼ŒLinuxä¸Žå…¶ä»–GUNè½¯ä»¶ç»“åˆï¼Œå®Œå…¨è‡ªç”±çš„GNU/Linuxæ“ä½œç³»ç»Ÿæ­£å¼è¯žç”Ÿï¼Œç®€ç§°Linux ==Linuxçš„åŸºæœ¬æ€æƒ³æœ‰ä¸¤ç‚¹== ç¬¬ä¸€ï¼Œä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶ ç¬¬äºŒï¼Œæ¯ä¸ªè½¯ä»¶éƒ½æœ‰ç¡®å®šçš„ç”¨é€” ä¸ŽUnixæ€æƒ³ååˆ†ç›¸è¿‘ã€‚ 2. Linuxç‰¹ç‚¹1ã€åˆ†æ—¶çš„å¤šç”¨æˆ·ã€å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿ 2ã€å¤šæ•°ç½‘ç»œåè®®æ”¯æŒã€æ–¹ä¾¿çš„è¿œç¨‹ç®¡ç† 3ã€å¼ºå¤§çš„å†…å­˜ç®¡ç†å’Œæ–‡ä»¶ç³»ç»Ÿç®¡ç† 4ã€å¤§é‡çš„å¯ç”¨çš„è½¯ä»¶å’Œå…è´¹çš„è½¯ä»¶ 5ã€ä¼˜è‰¯çš„ç¨³å®šæ€§å’Œå®‰å…¨æ€§ 6ã€è‰¯å¥½çš„å¯ç§»æ¤æ€§å’Œçµæ´»æ€§ 7ã€å¯ä¾›é€‰æ‹©çš„åŽ‚å•†å¤š 3. Linuxæ“ä½œç³»ç»Ÿæž¶æž„ è¡¥å……ï¼šlinuxå†…æ ¸å¿…é¡»åŠ ä¸Šä¸€ä¸ªâ€ç•Œé¢â€è½¯ä»¶ï¼Œæ‰èƒ½è®©ç”¨æˆ·åŽ»ä½¿ç”¨ï¼Œâ€ç•Œé¢â€åˆ†ä¸¤ç±»ï¼š aã€å‘½ä»¤è¡Œç•Œé¢CLI SHELLï¼ˆæœ‰å¾ˆå¤šç§ï¼Œæœ€æµè¡Œçš„ä¸€ç§æ˜¯bash shellï¼‰ bã€å›¾å½¢ç•Œé¢GUI SHELLï¼ˆä¹Ÿæœ‰å¾ˆå¤šç§ï¼Œç›®å‰æœ€æµè¡Œçš„æœ‰ä¸¤ç§ï¼šgnomeå’Œkdeï¼‰ 4. Linuxå†…æ ¸ä¸¥æ ¼æ¥è®²ï¼ŒLinuxä¸æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼ŒLinuxåªæ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸­çš„å†…æ ¸ã€‚ å†…æ ¸å»ºç«‹äº†è®¡ç®—æœºè½¯ä»¶ä¸Žç¡¬ä»¶ä¹‹é—´é€šè®¯çš„å¹³å°ï¼Œå†…æ ¸æä¾›ç³»ç»ŸæœåŠ¡ï¼Œæ¯”å¦‚æ–‡ä»¶ç®¡ç†ã€è™šæ‹Ÿå†…å­˜ã€è®¾å¤‡I/Oã€è¿›ç¨‹ç®¡ç†ç­‰ã€‚ å†…æ ¸å®˜ç½‘ï¼š[http://www.kernel.org/]{.underline}ã€‚ç›®å‰æœ€æ–°çš„å†…æ ¸ç‰ˆæœ¬ï¼š4.13.5 è¦æ³¨æ„åŒºåˆ†linuxå‘åž‹ç‰ˆæœ¬å’Œlinuxå†…æ ¸ç‰ˆæœ¬ã€‚ä¸¤è€…ä¸æ˜¯åŒä¸€ä¸ªäº‹ç‰© ä¸‹é¢è¿™ä½æ˜¯Linuxå†…æ ¸çš„ä½œè€…ï¼š è¿™æ˜¯Linuxçš„logo 5. å¸¸è§å‘è¡Œç‰ˆçº¢å¸½ä¼ä¸šç³»ç»Ÿï¼ˆRedHat Enterprise Linux, RHELï¼‰ å…¨çƒæœ€å¤§çš„å¼€æºæŠ€æœ¯åŽ‚å•†ï¼Œå…¨ä¸–ç•Œå†…ä½¿ç”¨æœ€å¹¿æ³›çš„Linuxå‘å¸ƒå¥—ä»¶ï¼Œ æä¾›æ€§èƒ½ä¸Žç¨³å®šæ€§æžå¼ºçš„Linuxå¥—ä»¶ç³»ç»Ÿå¹¶æ‹¥æœ‰å®Œå–„çš„å…¨çƒæŠ€æœ¯æ”¯æŒã€‚ å®˜ç½‘ï¼š[http://www.redhat.com]{.underline} ç¤¾åŒºä¼ä¸šæ“ä½œç³»ç»Ÿï¼ˆCentOSï¼‰ æœ€åˆæ˜¯å°†çº¢å¸½ä¼ä¸šç³»ç»Ÿâ€é‡æ–°ç¼–è¯‘/å‘å¸ƒâ€ç»™ç”¨æˆ·å…è´¹ä½¿ç”¨è€Œå¹¿æ³›ä½¿ç”¨ï¼Œ å½“å‰å·²æ­£å¼åŠ å…¥çº¢å¸½å…¬å¸å¹¶ç»§ç»­ä¿æŒå…è´¹ï¼ˆéšRHELæ›´æ–°è€Œæ›´æ–°ï¼‰ã€‚ å®˜ç½‘ï¼š[http://www.centos.org/]{.underline} çº¢å¸½ç”¨æˆ·æ¡Œé¢ç‰ˆï¼ˆFedora [Linux]ï¼‰ æœ€åˆç”±çº¢å¸½å…¬å¸å‘èµ·çš„æ¡Œé¢ç‰ˆç³»ç»Ÿå¥—ä»¶ï¼ˆç›®å‰å·²ç»ä¸é™äºŽæ¡Œé¢ç‰ˆï¼‰ï¼Œ ç”¨æˆ·å¯å…è´¹ä½“éªŒåˆ°æœ€æ–°çš„æŠ€æœ¯æˆ–å·¥å…·ï¼Œè€ŒåŠŸèƒ½æˆç†ŸåŽåŠ å…¥åˆ°RHELä¸­ã€‚ å®˜ç½‘ï¼š[http://fedora.redhat.com]{.underline} å›½é™…åŒ–ç»„ç»‡çš„å¼€æºæ“ä½œç³»ç»Ÿï¼ˆDebianï¼‰ æä¾›è¶…è¿‡37500ç§ä¸åŒçš„è‡ªç”±è½¯ä»¶ä¸”æ‹¥æœ‰å¾ˆé«˜çš„è®¤å¯åº¦ï¼Œ å¯¹äºŽå„ç±»å†…æ ¸æž¶æž„æ”¯æŒæ€§è‰¯å¥½ï¼Œç¨³å®šæ€§ã€å®‰å…¨æ€§å¼ºæ›´æœ‰å…è´¹çš„æŠ€æœ¯æ”¯æŒã€‚ å®˜ç½‘ï¼š[http://www.debian.org/]{.underline} åŸºäºŽDebiançš„æ¡Œé¢ç‰ˆï¼ˆUbuntuï¼‰ Ubuntuæ˜¯ä¸€æ¬¾åŸºäºŽDebianæ´¾ç”Ÿçš„äº§å“ï¼Œå¯¹æ–°æ¬¾ç¡¬ä»¶å…·æœ‰æžå¼ºçš„å…¼å®¹èƒ½åŠ›ã€‚ æ™®éè®¤ä¸ºUbuntuä¸ŽFedoraéƒ½æ˜¯æžå…¶å‡ºè‰²çš„LINUXæ¡Œé¢ç³»ç»Ÿã€‚ å®˜ç½‘ï¼š[http://www.ubuntulinux.org/]{.underline} å½“ç„¶è¿˜æœ‰å›½å†…çš„å›½é˜²ç§‘æŠ€å¤§å­¦å‘è¡Œéº’éºŸkylinå’Œä¸­ç§‘é™¢å‘è¡Œçº¢æ——RedFlag 2&gt; Linuxæ–‡ä»¶ç³»ç»Ÿ1. CentOSçš„ç›®å½•ç»“æž„ 2. æ ¹ç›®å½•ä¸‹æ¯ä¸ªç›®å½•çš„ç®€å•è§£é‡Š /**ï¼š**æ ¹ç›®å½•ï¼Œä¸€èˆ¬æ ¹ç›®å½•ä¸‹åªå­˜æ”¾ç›®å½•ï¼Œä¸è¦å­˜æ”¾æ–‡ä»¶ï¼Œ/etcã€/binã€/devã€/libã€/sbinåº”è¯¥å’Œæ ¹ç›®å½•æ”¾ç½®åœ¨ä¸€ä¸ªåˆ†åŒºä¸­ /bin:/usr/bin: å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç›®å½•ï¼Œå¦‚å¸¸ç”¨çš„å‘½ä»¤lsã€tarã€mvã€catç­‰ /boot**ï¼š**æ”¾ç½®linuxç³»ç»Ÿå¯åŠ¨æ—¶ç”¨åˆ°çš„ä¸€äº›æ–‡ä»¶ã€‚/boot/vmlinuzä¸ºlinuxçš„å†…æ ¸æ–‡ä»¶ï¼Œä»¥åŠ/boot/gurbã€‚å»ºè®®å•ç‹¬åˆ†åŒºï¼Œåˆ†åŒºå¤§å°100Må³å¯ /dev**ï¼š**å­˜æ”¾linuxç³»ç»Ÿä¸‹çš„è®¾å¤‡æ–‡ä»¶ï¼Œè®¿é—®è¯¥ç›®å½•ä¸‹æŸä¸ªæ–‡ä»¶ï¼Œç›¸å½“äºŽè®¿é—®æŸä¸ªè®¾å¤‡ï¼Œå¸¸ç”¨çš„æ˜¯æŒ‚è½½å…‰é©±mount /dev/cdrom /mnt /etc**ï¼š**ç³»ç»Ÿé…ç½®æ–‡ä»¶å­˜æ”¾çš„ç›®å½•ï¼Œä¸å»ºè®®åœ¨æ­¤ç›®å½•ä¸‹å­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‡è¦çš„é…ç½®æ–‡ä»¶æœ‰/etc/inittabã€/etc/gatewaysã€/etc/resolv.confã€/etc/fstabã€/etc/init.dã€/etc/X11ã€/etc/sysconfigã€/etc/xinetd.dä¿®æ”¹é…ç½®æ–‡ä»¶ä¹‹å‰è®°å¾—å¤‡ä»½ã€‚æ³¨ï¼š/etc/X11å­˜æ”¾ä¸Žx windowsæœ‰å…³çš„è®¾ç½® /home**ï¼š**ç³»ç»Ÿé»˜è®¤çš„ç”¨æˆ·å®¶ç›®å½•ï¼Œæ–°å¢žç”¨æˆ·è´¦å·æ—¶ï¼Œç”¨æˆ·çš„å®¶ç›®å½•éƒ½å­˜æ”¾åœ¨æ­¤ç›®å½•ä¸‹ï¼Œè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œtestè¡¨ç¤ºç”¨æˆ·testçš„å®¶ç›®å½•ã€‚å»ºè®®å•ç‹¬åˆ†åŒºï¼Œå¹¶è®¾ç½®è¾ƒå¤§çš„ç£ç›˜ç©ºé—´ï¼Œæ–¹ä¾¿ç”¨æˆ·å­˜æ”¾æ•°æ® /lib:/lib64:/usr/lib:/usr/local/lib**ï¼š**ç³»ç»Ÿä½¿ç”¨çš„å‡½æ•°åº“çš„ç›®å½•ï¼Œç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéœ€è¦è°ƒç”¨ä¸€äº›é¢å¤–çš„å‚æ•°æ—¶éœ€è¦å‡½æ•°åº“çš„ååŠ©ï¼Œæ¯”è¾ƒé‡è¦çš„ç›®å½•ä¸º/lib/modules /lost+fount**ï¼š**ç³»ç»Ÿå¼‚å¸¸äº§ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šå°†ä¸€äº›é—å¤±çš„ç‰‡æ®µæ”¾ç½®äºŽæ­¤ç›®å½•ä¸‹ï¼Œé€šå¸¸è¿™ä¸ªç›®å½•ä¼šè‡ªåŠ¨å‡ºçŽ°åœ¨è£…ç½®ç›®å½•ä¸‹ã€‚å¦‚åŠ è½½ç¡¬ç›˜äºŽ/disk ä¸­ï¼Œæ­¤ç›®å½•ä¸‹å°±ä¼šè‡ªåŠ¨äº§ç”Ÿç›®å½•/disk/lost+found /mnt:/media**ï¼š**å…‰ç›˜é»˜è®¤æŒ‚è½½ç‚¹ï¼Œé€šå¸¸å…‰ç›˜æŒ‚è½½äºŽ/mnt/cdromä¸‹ï¼Œä¹Ÿä¸ä¸€å®šï¼Œå¯ä»¥é€‰æ‹©ä»»æ„ä½ç½®è¿›è¡ŒæŒ‚è½½ /opt**ï¼š**ç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½•ã€‚å¦‚ï¼šFC4ä½¿ç”¨çš„Fedora ç¤¾ç¾¤å¼€å‘è½¯ä»¶ï¼Œå¦‚æžœæƒ³è¦è‡ªè¡Œå®‰è£…æ–°çš„KDEæ¡Œé¢è½¯ä»¶ï¼Œå¯ä»¥å°†è¯¥è½¯ä»¶å®‰è£…åœ¨è¯¥ç›®å½•ä¸‹ã€‚ä»¥å‰çš„Linuxç³»ç»Ÿä¸­ï¼Œä¹ æƒ¯æ”¾ç½®åœ¨ /usr/localç›®å½•ä¸‹option /proc**ï¼š*æ­¤ç›®å½•çš„æ•°æ®éƒ½åœ¨å†…å­˜ä¸­ï¼Œå¦‚ç³»ç»Ÿæ ¸å¿ƒï¼Œå¤–éƒ¨è®¾å¤‡ï¼Œç½‘ç»œçŠ¶æ€ï¼Œç”±äºŽæ•°æ®éƒ½å­˜æ”¾äºŽå†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œæ¯”è¾ƒé‡è¦çš„ç›®å½•æœ‰/proc/cpuinfoã€/proc/interruptsã€/proc/dmaã€/proc/ioportsã€/proc/net/ç­‰process /root**ï¼š**ç³»ç»Ÿç®¡ç†å‘˜rootçš„å®¶ç›®å½•ï¼Œç³»ç»Ÿç¬¬ä¸€ä¸ªå¯åŠ¨çš„åˆ†åŒºä¸º/ï¼Œæ‰€ä»¥æœ€å¥½å°†/rootå’Œ/æ”¾ç½®åœ¨ä¸€ä¸ªåˆ†åŒºä¸‹ /sbin:/usr/sbin:/usr/local/sbin**ï¼š**æ”¾ç½®ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„å¯æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚fdiskã€shutdownã€mountç­‰ã€‚ä¸Ž/binä¸åŒçš„æ˜¯ï¼Œè¿™å‡ ä¸ªç›®å½•æ˜¯ç»™ç³»ç»Ÿç®¡ç†å‘˜rootä½¿ç”¨çš„å‘½ä»¤ï¼Œä¸€èˆ¬ç”¨æˆ·åªèƒ½â€æŸ¥çœ‹â€è€Œä¸èƒ½è®¾ç½®å’Œä½¿ç”¨ã€‚ /selinux**ï¼š**selinuxè½¯ä»¶ç›®å½•ï¼Œç”¨äºŽä¿è¯ç³»ç»Ÿå®‰å…¨ /srv**ï¼š**æœåŠ¡å¯åŠ¨ä¹‹åŽéœ€è¦è®¿é—®çš„æ•°æ®ç›®å½•ï¼Œå¦‚wwwæœåŠ¡éœ€è¦è®¿é—®çš„ç½‘é¡µæ•°æ®å­˜æ”¾åœ¨/srv/wwwå†…service /sys**ï¼š**ç±»ä¼¼äºŽ/procçš„ç‰¹æ®Šæ–‡ä»¶ç³»ç»Ÿï¼Œå­˜æ”¾å†…æ ¸æ•°æ®ä¿¡æ¯ /tmp**ï¼š**ä¸€èˆ¬ç”¨æˆ·æˆ–æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºä¸´æ—¶å­˜æ”¾æ–‡ä»¶çš„ç›®å½•,ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®,é‡è¦æ•°æ®ä¸å¯æ”¾ç½®åœ¨æ­¤ç›®å½•ä¸‹ /usr**ï¼šåº”ç”¨ç¨‹åºå­˜æ”¾ç›®å½•ï¼Œ /usr/bin å­˜æ”¾åº”ç”¨ç¨‹åº /usr/share å­˜æ”¾å…±äº«æ•°æ® /usr/lib å­˜æ”¾ä¸èƒ½ç›´æŽ¥è¿è¡Œçš„ï¼Œå´æ˜¯è®¸å¤šç¨‹åºè¿è¡Œæ‰€å¿…éœ€çš„ä¸€äº›å‡½æ•°åº“æ–‡ä»¶ /usr/local:å­˜æ”¾è½¯ä»¶å‡çº§åŒ… /usr/share/doc: ç³»ç»Ÿè¯´æ˜Žæ–‡ä»¶å­˜æ”¾ç›®å½• /usr/share/man: ç¨‹åºè¯´æ˜Žæ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œä½¿ç”¨man lsæ—¶ä¼šæŸ¥è¯¢/usr/share/man/man1/ls.1.gzçš„å†…å®¹å»ºè®®å•ç‹¬åˆ†åŒºï¼Œè®¾ç½®è¾ƒå¤§çš„ç£ç›˜ç©ºé—´ usr**ï¼šuser share resources/unix share resouces /var**ï¼š**æ”¾ç½®ç³»ç»Ÿæ‰§è¡Œè¿‡ç¨‹ä¸­ç»å¸¸å˜åŒ–çš„æ–‡ä»¶ï¼Œå¦‚ï¼š /var/logï¼šéšæ—¶æ›´æ”¹çš„æ—¥å¿—æ–‡ä»¶ /var/log/messageï¼šæ‰€æœ‰çš„ç™»å½•æ–‡ä»¶å­˜æ”¾ç›®å½• /var/spool/mailï¼šé‚®ä»¶å­˜æ”¾çš„ç›®å½• /var/runï¼šç¨‹åºæˆ–æœåŠ¡å¯åŠ¨ ä½¿ç”¨å»ºè®®ï¼š ç”¨æˆ·åº”è¯¥å°†æ–‡ä»¶å­˜å‚¨åœ¨è‡ªå·±çš„ä¸»ç›®å½•åŠå…¶å­ç›®å½•ä¸‹ ç³»ç»Ÿç»å¤§å¤šæ•°è®¾ç½®éƒ½åœ¨/etcç›®å½•ä¸‹ ä¸è¦ä¿®æ”¹/æˆ–è€…/usrç›®å½•ä¸‹çš„ä»»ä½•å†…å®¹ï¼Œé™¤éžä½ çœŸçš„æ¸…æ¥šä½ åœ¨åšä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯è¯´/ç›®å½•æœ€å¥½å’Œå®‰è£…å¥½ç³»ç»Ÿä¹‹åˆä¿æŒä¸€è‡´ å¤§å¤šæ•°å·¥å…·å’Œåº”ç”¨è½¯ä»¶ç¨‹åºéƒ½å®‰è£…åœ¨/binï¼Œ/sbinï¼Œ/usr/binï¼Œ/usr/sbinï¼Œ/usr/local/bin æ–‡ä»¶æˆ–è€…ç›®å½•éƒ½æœ‰å”¯ä¸€çš„ç»å¯¹è·¯å¾„ï¼Œæ²¡æœ‰ç›˜ç¬¦çš„æ¦‚å¿µ 3&gt; Linuxå‘½ä»¤ç»ˆç«¯1. Linux çš„å‘½ä»¤æ ¼å¼ï¼šå‘½ä»¤é€‰é¡¹ å‘½ä»¤å‚æ•°æ³¨æ„ï¼šä¸‰è€…ä¹‹é—´è¦ç©ºæ ¼éš”å¼€ï¼Œå…¶ä¸­å‘½ä»¤é€‰é¡¹åˆ†ä¸ºé•¿æ ¼å¼å’ŒçŸ­æ ¼å¼ã€‚ çŸ­æ ¼å¼ç”¨â€™-â€˜è¡¨ç¤ºï¼Œæ¯”å¦‚ï¼š-lï¼Œ é•¿æ ¼å¼ç”¨â€â€“â€è¡¨ç¤ºï¼Œæ¯”å¦‚ï¼šâ€“helpï¼Œ ä¹Ÿå¯ä»¥ä½¿ç”¨ç»„åˆæ ¼å¼ï¼Œæ¯”å¦‚ï¼š-a -l ç­‰ä»·äºŽ-laæˆ–è€…-al 2. Linuxçš„é»˜è®¤å‘½ä»¤æç¤ºç¬¦ï¼š#ï¼šç®¡ç†å‘˜ç”¨æˆ· $ï¼šæ™®é€šç”¨æˆ· PS: Linuxä»¥å›žè½¦é”®è¡¨ç¤ºå‘½ä»¤ç»“æŸï¼Œå¦‚æžœ linuxå‘½ä»¤éœ€è¦æŠ˜è¡Œè¾“å…¥ï¼Œé‚£ä¹ˆå¯ä»¥ä»¥ \è¡¨ç¤ºæ¯è¡Œç»“æŸ 4&gt; å¸¸ç”¨å‘½ä»¤å½’çº³åˆ†ç±»åŸºæœ¬å‘½ä»¤ æ–‡ä»¶ç®¡ç† mkdir, rmdir, mv, rm, cp, touch, cat, tac, echo, more, less, head, tail, file, find, rename, ln, pwd, scp, alias ç£ç›˜ç®¡ç† ls, cd, du, df, mount, unmounts, fdisk æ–‡æ¡£å¤„ç† wc, sort, uniq, cut, sed, awk, grep, vi, diff ç”¨æˆ·å’Œç»„ useradd, usermod, passwd, userdel, groupadd, groupdel, chgrp, su æ–‡ä»¶ä¼ è¾“ get, put, wget ç½‘ç»œé€šä¿¡ telnet, nc, ifconfig, ping, netstat, ip, host å¤‡ä»½åŽ‹ç¼© gzip, bzip2, bunzip2, tar, zip ç³»ç»Ÿç®¡ç† exit, kill, last, ps, top, free, pstree, reboot, halt, shutdown, sudo, who, w, whoami, whereis, which, last, whatis ç³»ç»Ÿè®¾ç½® clear, set, unset, hwclock, time, date, å…¶ä»– history, hostname, nohup, service, init, rpm, ssh, cal, yum ç½‘ç«™é€ŸæŸ¥http://man.linuxde.net/ http://www.jb51.net/linux/ https://jaywcjlove.github.io/linux-command ps: ç›´æŽ¥åœ¨å‘½ä»¤è¡Œä¸­, ç”¨ man xx, ä¹Ÿå¯ä»¥æŸ¥çœ‹å‘½ä»¤ä¿¡æ¯ 5&gt; å¸¸ç”¨æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤è¯¦è§£ç£ç›˜ç®¡ç† cd change directory å¸¸ä½¿ç”¨æ–¹å¼ï¼š cd sourcedir è¿›å…¥ç”¨æˆ·ä¸»ç›®å½• cd ~ è¿›å…¥ç”¨æˆ·ä¸»ç›®å½• cd - è¿”å›žè¿›å…¥æ­¤ç›®å½•ä¹‹å‰æ‰€åœ¨çš„ç›®å½• cd .. è¿”å›žä¸Šçº§ç›®å½•ï¼ˆè‹¥å½“å‰ç›®å½•ä¸ºâ€/â€œï¼Œåˆ™æ‰§è¡Œå®ŒåŽè¿˜åœ¨â€/â€œï¼›â€..â€ä¸ºä¸Šçº§ç›®å½•çš„æ„æ€ï¼‰ cd ../.. è¿”å›žä¸Šä¸¤çº§ç›®å½• pwd print working directory pwd æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½• ls listï¼šæ˜¾ç¤ºç›®å½•å†…å®¹åˆ—è¡¨ ä½¿ç”¨æ ¼å¼ï¼šls é€‰é¡¹ ç›®å½•æˆ–æ–‡ä»¶å å¸¸ç”¨é€‰é¡¹ -lï¼šè¯¦ç»†ä¿¡æ¯æ˜¾ç¤º -aï¼šæ˜¾ç¤ºæ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ -Aï¼šç±»ä¼¼äºŽâ€œ-aâ€ï¼Œä½†ä¸æ˜¾ç¤ºâ€œ.â€å’Œâ€œ..â€ç›®å½•çš„ä¿¡æ¯ -Rï¼šé€’å½’æ˜¾ç¤ºå†…å®¹ -hï¼šä»¥å‹å¥½æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å° ä¾‹å­ï¼š ls -l ## åˆ—å‡ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯ï¼Œ ä¹Ÿå¯ä»¥å†™ä½œ ll ls -lah ## ä»¥å‹å¥½æ–¹å¼æ˜¾ç¤ºåŒ…æ‹¬éšè—æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ du disk usageï¼šæ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶å’Œç›®å½•çš„ç£ç›˜ä½¿ç”¨ç©ºé—´ ä½¿ç”¨æ ¼å¼ï¼šdu é€‰é¡¹ ç›®å½•æˆ–æ–‡ä»¶å å¸¸ç”¨é€‰é¡¹ï¼š -aï¼šç»Ÿè®¡æ—¶åŒ…æ‹¬æ‰€æœ‰çš„æ–‡ä»¶ï¼Œè€Œä¸ä»…ä»…åªç»Ÿè®¡ç›®å½• -hï¼šä»¥æ›´æ˜“è¯»çš„å­—èŠ‚å•ä½ï¼ˆKã€Mç­‰ï¼‰æ˜¾ç¤ºä¿¡æ¯ -sï¼šåªç»Ÿè®¡æ¯ä¸ªå‚æ•°æ‰€å ç”¨ç©ºé—´æ€»çš„å¤§å° ä¾‹å­ï¼š du -ah ## df disk freeï¼šæ˜¾ç¤ºç£ç›˜ç›¸å…³ä¿¡æ¯ å¸¸ç”¨é€‰é¡¹ï¼š -hï¼šä»¥æ›´æ˜“è¯»çš„å­—èŠ‚å•ä½ï¼ˆKã€Mç­‰ï¼‰æ˜¾ç¤ºä¿¡æ¯ -Tï¼šæ˜¾ç¤ºåˆ†åŒºæ ¼å¼ ä¾‹å­ï¼š df -h ## æ˜¾ç¤ºç£ç›˜ä¿¡æ¯ï¼Œä»¥å‹å¥½æ–¹å¼ df -T -h ## ä»¥å‹å¥½æ ¼å¼æ˜¾ç¤ºç£ç›˜ä¿¡æ¯ï¼Œå¹¶ä¸”é™„åŠ ç£ç›˜æ ¼å¼ æ–‡ä»¶ç®¡ç† touch åˆ›å»ºç©ºæ–‡ä»¶ æˆ–æ›´æ–°æ–‡ä»¶æ—¶é—´æ ‡è®° ä½¿ç”¨æ ¼å¼ï¼š touch æ–‡ä»¶å file æŸ¥çœ‹æ–‡ä»¶ç±»åž‹ ä½¿ç”¨æ ¼å¼ï¼š file æ–‡ä»¶å æ ¹æ®æ–‡ä»¶å†…å®¹æ ¼å¼åˆ¤æ–­æ–‡ä»¶ç±»åž‹ã€‚è€Œä¸æ˜¯æ ¹æ®åŽç¼€å mkdir åˆ›å»ºæ–‡ä»¶å¤¹ make directory ä½¿ç”¨æ ¼å¼ï¼šmkdir é€‰é¡¹ å‚æ•° å¸¸ç”¨é€‰é¡¹ï¼š -pï¼šå·²çº§è”çš„æ–¹å¼åˆ›å»ºæ–‡ä»¶å¤¹ ä¾‹å­ï¼š mkdir -p /root/ma/niu/zhu/dagou ## ä¸Šçº§ç›®å½•ä¸å­˜åœ¨è‡ªåŠ¨åˆ›å»ºä¸Šä¸€çº§ç›®å½•ï¼Œå¸¸ç”¨ cp å¤åˆ¶æ–‡ä»¶ ä½¿ç”¨æ ¼å¼ï¼š cp é€‰é¡¹ æºæ–‡ä»¶æˆ–ç›®å½•â€¦ ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½• å¸¸ç”¨é€‰é¡¹ï¼š -rï¼šé€’å½’å¤åˆ¶æ•´ä¸ªç›®å½•æ ‘ -pï¼šä¿æŒæºæ–‡ä»¶çš„å±žæ€§ä¸å˜ -iï¼šéœ€è¦è¦†ç›–æ–‡ä»¶æˆ–ç›®å½•æ—¶è¿›è¡Œæé†’ rm åˆ é™¤æ–‡ä»¶æˆ–ç›®å½• ä½¿ç”¨æ ¼å¼ï¼šrm [é€‰é¡¹] æ–‡ä»¶æˆ–ç›®å½• å¸¸ç”¨é€‰é¡¹ï¼š -fï¼šå¼ºè¡Œåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸è¿›è¡Œæé†’ -iï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•æ—¶æé†’ç”¨æˆ·ç¡®è®¤ -rï¼šé€’å½’åˆ é™¤æ•´ä¸ªç›®å½•æ ‘ ä¾‹å­ï¼š rm -rf /root/ma/ ## ä¸æé†’é€’å½’åˆ é™¤æ•´ä¸ªç›®å½•ï¼Œæ…Žç”¨æ…Žç”¨æ…Žç”¨ mv ç§»åŠ¨æ–‡ä»¶ å¦‚æžœä¸Žæºæ–‡ä»¶ä½ç½®ä¸€æ ·ï¼Œåˆ™ç›¸å½“äºŽé‡å‘½å ä½¿ç”¨æ ¼å¼ï¼š mv [é€‰é¡¹]â€¦ æºæ–‡ä»¶æˆ–ç›®å½•â€¦ ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½• å¸¸ç”¨é€‰é¡¹ï¼š -fï¼šè‹¥ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•ä¸ŽçŽ°æœ‰çš„æ–‡ä»¶æˆ–ç›®å½•é‡å¤ï¼Œåˆ™ç›´æŽ¥è¦†ç›–çŽ°æœ‰çš„æ–‡ä»¶æˆ–ç›®å½• -uï¼šå½“æºæ–‡ä»¶æ¯”ç›®æ ‡æ–‡ä»¶æ–°æˆ–è€…ç›®æ ‡æ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼Œæ‰æ‰§è¡Œç§»åŠ¨æ“ä½œ rmdir åˆ é™¤ç©ºæ–‡ä»¶å¤¹ å¸¸ç”¨é€‰é¡¹ï¼š -pæˆ–â€“parentsï¼šåˆ é™¤æŒ‡å®šç›®å½•åŽï¼Œè‹¥è¯¥ç›®å½•çš„ä¸Šå±‚ç›®å½•å·²å˜æˆç©ºç›®å½•ï¼Œåˆ™å°†å…¶ä¸€å¹¶åˆ é™¤ï¼› rmdir -p /root/aa/bb/cc/dd/ee åˆ é™¤æ–‡ä»¶å¤¹eeï¼Œå¦‚æžœåˆ é™¤eeåŽï¼Œddå˜ä¸ºç©ºï¼Œåˆ™åˆ é™¤ddï¼Œä¾æ¬¡ç±»æŽ¨ cat è¿žæŽ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Š å¸¸ç”¨é€‰é¡¹ï¼š -næˆ–â€“numberï¼šç”±1å¼€å§‹å¯¹æ‰€æœ‰è¾“å‡ºçš„è¡Œæ•°ç¼–å· cat /home/hadoop/data.txt ## æŸ¥çœ‹æ–‡ä»¶å†…å®¹ tac å€’åºè¾“å‡ºæ–‡ä»¶å†…å®¹ tac /home/hadoop/data.txt echo è¾“å‡ºæŒ‡å®šçš„å­—ç¬¦ä¸²æˆ–è€…å˜é‡ å¸¸ç”¨é€‰é¡¹ï¼š -eï¼šè‹¥å­—ç¬¦ä¸²ä¸­å‡ºçŽ°ä»¥ä¸‹å­—ç¬¦ï¼Œåˆ™ç‰¹åˆ«åŠ ä»¥å¤„ç†ï¼Œè€Œä¸ä¼šå°†å®ƒå½“æˆä¸€èˆ¬æ–‡å­—è¾“å‡ºï¼š \a å‘å‡ºè­¦å‘Šå£°ï¼› \b åˆ é™¤å‰ä¸€ä¸ªå­—ç¬¦ï¼› \c æœ€åŽä¸åŠ ä¸Šæ¢è¡Œç¬¦å·ï¼› \f æ¢è¡Œä½†å…‰æ ‡ä»æ—§åœç•™åœ¨åŽŸæ¥çš„ä½ç½®ï¼› \n æ¢è¡Œä¸”å…‰æ ‡ç§»è‡³è¡Œé¦–ï¼› \r å…‰æ ‡ç§»è‡³è¡Œé¦–ï¼Œä½†ä¸æ¢è¡Œï¼› \t æ’å…¥tabï¼› \v ä¸Ž\fç›¸åŒï¼› \ æ’å…¥\å­—ç¬¦ï¼› \nnn æ’å…¥nnnï¼ˆå…«è¿›åˆ¶ï¼‰æ‰€ä»£è¡¨çš„ASCIIå­—ç¬¦ï¼› ä¾‹å­ï¼š echo â€˜maâ€™ ## è¾“å‡ºma echo -e â€˜ma\nâ€™ ## æ‰“å°maä¹‹åŽæ¢è¡Œ echo -ne â€˜maâ€™ â€˜zhonghuaâ€™ ## æ‰“å°å®Œä¸æ¢è¡Œ echo â€˜maâ€™ &gt; ma.dat ## è¦†ç›– echo â€˜maâ€™ &gt;&gt; ma.dat ## è¿½åŠ  echo $PWD ## è¾“å‡ºå˜é‡å†…å®¹ head åœ¨å±å¹•ä¸Šæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å¼€å¤´è‹¥å¹²è¡Œ é»˜è®¤æ˜¾ç¤º10è¡Œ å¸¸ç”¨é€‰é¡¹ï¼š -n&lt;æ•°å­—&gt;ï¼šæŒ‡å®šæ˜¾ç¤ºå¤´éƒ¨å†…å®¹çš„è¡Œæ•°ï¼› ä¾‹å­ï¼š head -n 5 install.log ## æ˜¾ç¤ºè¯¥æ–‡ä»¶å‰äº”è¡Œå†…å®¹ tail åœ¨å±å¹•ä¸Šæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„æœ«å°¾è‹¥å¹²è¡Œ å¸¸ç”¨é€‰é¡¹ï¼š -fï¼šæ˜¾ç¤ºæ–‡ä»¶æœ€æ–°è¿½åŠ çš„å†…å®¹ tail -f install.log ## æ˜¾ç¤ºæœ€æ–°è¿½åŠ çš„å†…å®¹ ## æ˜¾ç¤ºæ–‡ä»¶fileçš„æœ€åŽ10è¡Œ tail -1 file ## æ˜¾ç¤ºæ–‡ä»¶fileæœ€åŽä¸€è¡Œçš„å†…å®¹ tail -c 10 file ## æ˜¾ç¤ºæ–‡ä»¶fileçš„æœ€åŽ10ä¸ªå­—ç¬¦ more æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼Œæ¯æ¬¡æ˜¾ç¤ºä¸€å± ä½¿ç”¨æ–¹å¼ï¼š æŒ‰Spaceé”®ï¼šæ˜¾ç¤ºæ–‡æœ¬çš„ä¸‹ä¸€å±å†…å®¹ã€‚ æŒ‰Enteré”®ï¼šåªæ˜¾ç¤ºæ–‡æœ¬çš„ä¸‹ä¸€è¡Œå†…å®¹ã€‚ æŒ‰hé”®ï¼šæ˜¾ç¤ºå¸®åŠ©å±ï¼Œè¯¥å±ä¸Šæœ‰ç›¸å…³çš„å¸®åŠ©ä¿¡æ¯ã€‚ æŒ‰bé”®ï¼šæ˜¾ç¤ºä¸Šä¸€å±å†…å®¹ã€‚ æŒ‰qé”®ï¼šé€€å‡ºmoreå‘½ä»¤ã€‚ less åˆ†å±ä¸Šä¸‹ç¿»é¡µæµè§ˆæ–‡ä»¶å†…å®¹ å’Œmoreä½¿ç”¨æ–¹å¼åŸºæœ¬ç±»ä¼¼ æŒ‰eé”®ï¼šå‘ä¸Šæ»šåŠ¨ä¸€è¡Œ æŒ‰yé”®ï¼šå‘ä¸‹æ»šåŠ¨ä¸€è¡Œ Gï¼šè·³åˆ°æ–‡ä»¶æœ«å°¾ ggï¼šè·³åˆ°æ–‡ä»¶é¦–è¡Œ ln ç”¨æ¥ä¸ºæ–‡ä»¶åˆ›ä»¶è¿žæŽ¥ è½¯é“¾æŽ¥ -s å’Œ ç¡¬é“¾æŽ¥ ln /mnt/cdrom1 /var/www/html/centos/ â€”&gt;ç¡¬é“¾æŽ¥ ln -s /mnt/cdrom2 /var/www/html/centos/ â€“&gt;è½¯é“¾æŽ¥-ç¬¦å·é“¾æŽ¥ alias åˆ«å æŸ¥çœ‹åˆ«åï¼šalias å®šä¹‰åˆ«åï¼šalias la=&#39;ll -a å–æ¶ˆåˆ«åï¼šunalias la è½¯/ç¡¬ é“¾æŽ¥ç›¸å…³è½¯é“¾æŽ¥, ln -s æ–‡ä»¶/æ–‡ä»¶å¤¹ äº§ç”Ÿçš„é“¾æŽ¥ åˆ›å»ºæ–‡ä»¶çš„è½¯é“¾æŽ¥ 1ln -s /tmp/yum.log /root/yuntest åˆ›å»ºæ–‡ä»¶å¤¹çš„è½¯é“¾æŽ¥ 1234# åŽé¢çš„é“¾æŽ¥ä¸æŒ‡å®šåå­—, å°±é»˜è®¤ç”¨å‰é¢çš„æºæ–‡ä»¶/æ–‡ä»¶å¤¹åå­—ln -s /tmp /root ---lrwxrwxrwx. 1 root root 4 5æœˆ 29 20:53 tmp -&gt; /tmp å¦‚æžœè½¯é“¾æŽ¥æ˜¯æŒ‡å‘ç›®å½•çš„è¯, æ˜¯å¯ä»¥ç›´æŽ¥cdè¿›åŽ»çš„, cdè¿›åŽ»çš„æ˜¯çœŸå®žçš„ç›®å½•! 12pwd -P: æŸ¥çœ‹è½¯é“¾æŽ¥çš„çœŸå®žæŒ‡å‘æŸç›®å½•(ç‰©ç†ç›®å½•)pwd -L: é€»è¾‘ç›®å½• ç¡¬é“¾æŽ¥, ln ä¸åŠ s, ä¸€èˆ¬ä¸ä¼šç”¨ ä¸èƒ½é“¾æŽ¥ç›®å½• ä¸èƒ½è·¨åˆ†åŒºåšç¡¬é“¾æŽ¥ å…¶å®ƒæœ‰ç”¨çš„å‘½ä»¤123456789101112131415161718manï¼šæ˜¾ç¤ºå‘½ä»¤å¸®åŠ©ä¿¡æ¯clearï¼šæ¸…å±ï¼Œæˆ–è€…æŒ‰ctrl + lä¹Ÿè¡Œctrl + cï¼šé€€å‡ºå½“å‰è¿›ç¨‹ctrl + zï¼šæŒ‚èµ·å½“å‰å‰å°è¿›ç¨‹whatisï¼šå‘½ä»¤æ˜¯ä»€ä¹ˆwhereisï¼šåœ¨æ ‡å‡†è·¯å¾„ä¸‹æœç´¢ä¸Žåç§°ç›¸å…³çš„æ–‡ä»¶ï¼Œwhereiså°†æ‰€æœ‰æœç´¢åˆ°çš„æ–‡ä»¶éƒ½æ˜¾ç¤ºwhichï¼šwhichåœ¨è®¾å®šçš„æœç´¢è·¯å¾„ä¸‹è¿›è¡Œç›®å½•æœç´¢ï¼Œåªæ˜¾ç¤ºæœç´¢åˆ°çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶suï¼šåˆ‡æ¢ç”¨æˆ·historyï¼šæ˜¾ç¤ºåŽ†å²å‘½ä»¤hostnameï¼šæ˜¾ç¤ºä¸»æœºåsetï¼šæŸ¥çœ‹ç³»ç»Ÿå˜é‡getï¼šä¸‹è½½æ–‡ä»¶putï¼šä¸Šä¼ æ–‡ä»¶sudoï¼šä»¥rootç”¨æˆ·æƒé™æ‰§è¡Œä¸€æ¬¡å‘½ä»¤exitï¼šé€€å‡ºç™»å½•çŠ¶æ€wï¼šæ˜¾ç¤ºå½“å‰è¿žæŽ¥çš„ç”¨æˆ·whoï¼šæ˜¾ç¤ºå½“å‰ä¼šè¯ä¿¡æ¯uptimeï¼šæŸ¥çœ‹ç³»ç»Ÿè¿è¡Œæ—¶é—´ ä½¿ç”¨å°æŠ€å·§(é‡ç‚¹)12345678910111213141516ctrl + uï¼šæ¸…é™¤å…‰æ ‡å‰çš„å‘½ä»¤ï¼Œç›¸å½“äºŽå‰ªåˆ‡ # !ctrl + kï¼šæ¸…é™¤å…‰æ ‡åŽçš„å‘½ä»¤ï¼Œç›¸å½“äºŽå‰ªåˆ‡ # !ctrl + yï¼šç²˜è´´ # !ctrl + tï¼šæŠŠå…‰æ ‡å‰é¢çš„é‚£ä¸ªå­—ç¬¦å¾€åŽæŒªåŠ¨ä¸€ä½ctrl + lï¼šæ¸…å±ctrl + a: ç§»åˆ°å‘½ä»¤è¡Œé¦– # !ctrl + e: ç§»åˆ°å‘½ä»¤è¡Œå°¾ # !ctrl + â† â†’: å…‰æ ‡ç§»åŠ¨ä¸€ä¸ªå•è¯ # !!!ï¼šæ‰§è¡Œä¸Šä¸€æ¬¡å‘½ä»¤ # !!$ï¼šä¸Šä¸ªå‘½ä»¤çš„æœ€åŽä¸€ä¸ªå•è¯ctrl + wï¼šåˆ é™¤å…‰æ ‡å‰ä¸€ä¸ªå•è¯cd data; cat sed.txtï¼šè¡¨ç¤ºå…ˆæ‰§è¡Œcdï¼Œç„¶åŽæ‰§è¡Œcatï¼Œå·¥ä½œç›®å½•ä¼šåˆ‡æ¢(cd data; cat sed.txt)ï¼šè·Ÿä¸Šä¸ªå‘½ä»¤ç›¸æ¯”ï¼Œä¸åˆ‡æ¢å·¥ä½œç›®å½•|ï¼šç®¡é“ç¬¦ï¼Œè¡¨ç¤ºæŠŠå‰é¢å‘½ä»¤å†…å®¹çš„è¾“å‡ºå½“åšåŽé¢å‘½ä»¤çš„è¾“å…¥&gt;ï¼šè¡¨ç¤ºå†…å®¹è¦†ç›–&gt;&gt;ï¼šè¡¨ç¤ºå†…å®¹è¿½åŠ ]]></content>
      <categories>
        <category>Linux</category>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå­¦ä¹ ç¬”è®°-3]]></title>
    <url>%2F2018%2F05%2F25%2FLinux%2FLinux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-3%2F</url>
    <content type="text"><![CDATA[1. ç³»ç»ŸæœåŠ¡ç®¡ç† æ£€æŸ¥æœ¬æœºhttpdæœåŠ¡æ˜¯å¦å¼€å¯, ä½¿ç”¨å‘½ä»¤service httpd status å¼€å¯/å…³é—­/é‡å¯ httpdæœåŠ¡ service httpd start/stop/restart æŸ¥çœ‹æ‰€æœ‰çš„æœåŠ¡çŠ¶æ€ service --status-all è¿‡æ»¤å‡ºæŸä¸ªæœåŠ¡service â€“status-all | grep httpd` é˜²ç«å¢™æœåŠ¡ sevice iptables status/stop/start/restart é…ç½®åŽå°æœåŠ¡è¿›ç¨‹å¼€æœºè‡ªå¯ 12345# å¼€å¯å¼€æœºè‡ªå¯httpè¿›ç¨‹-&gt; chkconfig httpd on# æŸ¥çœ‹httpdçš„å¼€æœºè‡ªå¯çŠ¶æ€-&gt; chkconfig --list | grep httpdhttpd 0:å…³é—­ 1:å…³é—­ 2:å¯ç”¨ 3:å¯ç”¨ 4:å¯ç”¨ 5:å¯ç”¨ 6:å…³é—­ ç¼ºçœç³»ç»Ÿè¿è¡Œçº§åˆ« 0 ä¸ºåœæœºï¼Œæœºå™¨å…³é—­ã€‚ 1 ä¸ºå•ç”¨æˆ·æ¨¡å¼ï¼Œå°±åƒWin9xä¸‹çš„å®‰å…¨æ¨¡å¼ç±»ä¼¼ã€‚ 2 ä¸ºå¤šç”¨æˆ·æ¨¡å¼ï¼Œä½†æ˜¯æ²¡æœ‰NFSæ”¯æŒã€‚ 3 ä¸ºå®Œæ•´çš„å¤šç”¨æˆ·æ¨¡å¼ï¼Œæ˜¯æ ‡å‡†çš„è¿è¡Œçº§ã€‚ 4 ä¸€èˆ¬ä¸ç”¨ï¼Œåœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹å¯ä»¥ç”¨å®ƒæ¥åšä¸€äº›äº‹æƒ…ã€‚ä¾‹å¦‚åœ¨ç¬”è®°æœ¬ ç”µè„‘çš„ç”µæ± ç”¨å°½æ—¶ï¼Œå¯ä»¥åˆ‡æ¢åˆ°è¿™ä¸ªæ¨¡å¼æ¥åšä¸€äº›è®¾ç½®ã€‚ 5 å°±æ˜¯X11ï¼Œè¿›åˆ°X Windowç³»ç»Ÿäº†ã€‚ 6 ä¸ºé‡å¯ï¼Œè¿è¡Œinit 6æœºå™¨å°±ä¼šé‡å¯ã€‚ Centosä¸­æ—¶åŒº å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ—¶dåŒºæ–‡ä»¶ä½äºŽ /etc/localtime å…¶ä»–æ—¶åŒºæ–‡ä»¶åˆ™ä½äºŽ /usr/share/zoneinfo ä¸­å›½æ—¶åŒºä½¿ç”¨ /usr/share/zoneinfo/Asia/Shanghai æ›´æ”¹æ—¶åŒº cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime å¦‚æžœæ²¡æœ‰ Asia/Shanghai æ—¶åŒºæ–‡ä»¶ï¼Œè¯·ä½¿ç”¨tzselectå‘½ä»¤åŽ»ç”Ÿæˆæ—¶åŒºæ–‡ä»¶ï¼Œç”Ÿæˆå¥½çš„æ—¶åŒºæ–‡ä»¶å°±åœ¨ /usr/share/zoneinfoç›®å½•ä¸‹ ä¿®æ”¹ç³»ç»Ÿæ—¶é—´ date : ç›´æŽ¥æŸ¥çœ‹æ—¶é—´ date -s : æ‰‹åŠ¨è®¾ç½®æ—¶é—´ sudo ntpdate ntp1.aliyun.com : åŒæ­¥æ—¶é—´æœåŠ¡å™¨æ—¶é—´ 2. ç®€å•ç£ç›˜ç®¡ç† dfï¼šåˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ç£ç›˜ä½¿ç”¨é‡ -h äººæ€§åŒ–çš„åˆ—å‡ºæ–‡ä»¶çš„å¤§å°ç­‰ 123-&gt; # df -h /dev/sr0Filesystem Size Used Avail Use% Mounted on/dev/sr0 3.7G 3.7G 0 100% /media/cdrom duï¼šæ£€æŸ¥ç£ç›˜ç©ºé—´ä½¿ç”¨é‡ fdiskï¼šç”¨äºŽç£ç›˜åˆ†åŒº 3. æ–‡ä»¶çš„åŸºæœ¬å±žæ€§å‰ç¼€çš„å«ä¹‰ 1234567# æŸ¥çœ‹ç›®å½•çš„æƒé™-&gt; # ll -d /var/www/html/localyum ls -ld ä¹Ÿæ˜¯ä¸€æ ·, æŸ¥çœ‹ç›®å½•çš„æƒé™drwxr-xr-x. 7 root root 4096 5æœˆ 25 07:50 autojump-rw-r--r--. 1 root root 50434 5æœˆ 23 10:11 install.loglrwxrwxrwx. 1 root root 13 5æœˆ 25 21:04 localyum -&gt; /media/cdrom/ å½“ä¸º[ d ]åˆ™æ˜¯ç›®å½• å½“ä¸º[ - ]åˆ™æ˜¯æ–‡ä»¶ï¼› è‹¥æ˜¯[ l ]åˆ™è¡¨ç¤ºä¸ºé“¾æŽ¥æ–‡æ¡£(link file)ï¼› è‹¥æ˜¯[ b ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„å¯ä¾›å‚¨å­˜çš„æŽ¥å£è®¾å¤‡(å¯éšæœºå­˜å–è£…ç½®)ï¼› è‹¥æ˜¯[ c ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„ä¸²è¡Œç«¯å£è®¾å¤‡ï¼Œä¾‹å¦‚é”®ç›˜ã€é¼ æ ‡(ä¸€æ¬¡æ€§è¯»å–è£…ç½®); rã€wã€x å¯¹äºŽæ–‡ä»¶å’Œç›®å½•çš„å«ä¹‰ æƒé™ å¯¹æ–‡ä»¶çš„å«ä¹‰ å¯¹ç›®å½•çš„å«ä¹‰ r è¯»æƒé™ å¯ä»¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹ å¯ä»¥åˆ—å‡ºç›®å½•ä¸­çš„å†…å®¹ w å†™æƒé™ å¯ä»¥ä¿®æ”¹æ–‡ä»¶å†…å®¹ å¯ä»¥å†ç›®å½•ä¸­åˆ›å»ºã€åˆ é™¤æ–‡ä»¶ x æ‰§è¡Œæƒé™ å¯ä»¥æ‰§è¡Œæ–‡ä»¶ å¯ä»¥è¿›å…¥ç›®å½• 4. è½¯ä»¶å®‰è£… TODO1. äºŒè¿›åˆ¶å‘å¸ƒåŒ…å®‰è£… TODO:è½¯ä»¶å·²ç»é’ˆå¯¹å…·ä½“å¹³å°ç¼–è¯‘æ‰“åŒ…å‘å¸ƒï¼Œåªè¦è§£åŽ‹ï¼Œä¿®æ”¹é…ç½®å³å¯ å®‰è£…jdk , å®‰è£…tomcatä¹Ÿä¸€æ · TODO: é€šè¿‡ ftpå·¥å…·æŠŠ jdkä¼ åˆ° linuxæœåŠ¡å™¨ åˆ›å»ºä¸€ä¸ª /var/www/html/soft/jdk8 çš„è½¯é“¾æŽ¥, æŒ‡å‘æœåŠ¡å™¨ä¸­çš„å®‰è£…åŒ… â€”â€” è¿™ä¸€æ­¥å¤±è´¥äº†, å…ˆæç½®æŠŠ, å…ˆcopyè¿‡åŽ». 2. æºç ç¼–è¯‘å®‰è£… TODO:è½¯ä»¶ä»¥æºç å·¥ç¨‹çš„å½¢å¼å‘å¸ƒï¼Œéœ€è¦èŽ·å–åˆ°æºç å·¥ç¨‹åŽç”¨ç›¸åº”å¼€å‘å·¥å…·è¿›è¡Œç¼–è¯‘æ‰“åŒ…éƒ¨ç½² å®‰è£…/å¸è½½ redis å¸è½½: é¦–å…ˆæŸ¥çœ‹redis-serveræ˜¯å¦å¯åŠ¨ ps aux | grep redis æœ‰çš„è¯, å…³é—­è¿™äº›è¿›ç¨‹ kill -9 è¿›ç¨‹pid åˆ é™¤redisç›¸åº”çš„æ–‡ä»¶å¤¹å°±å¯ä»¥äº†ã€‚ find / -name redis å®‰è£…: æ‹·è´åˆ°/usr/local, è§£åŽ‹, åˆ æŽ‰åŽŸå®‰è£…åŒ… 12tar -zxvf redis-3.0.0.tar.gz rm redis-3.0.0.tar.gz æ£€æŸ¥è¿è¡ŒçŽ¯å¢ƒ 123# æ£€æµ‹ä¸€ä¸‹æ˜¯å¦å¯ä»¥å®‰è£…makemake test å®‰è£…åˆ°æŒ‡å®šç›®å½• 1make PREFIX=/root/apps/redis install æ‹·è´é…ç½®ä¿¡æ¯ 1cp /usr/local/redis-3.0.0/redis.conf /usr/local/redis/bin å¯åŠ¨ å‰ç«¯æ¨¡å¼ bin/redis-server åŽç«¯æ¨¡å¼å¯åŠ¨ ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶ï¼Œdaemonize yes` ä»¥åŽç«¯æ¨¡å¼å¯åŠ¨ : TODO 3. RPMå‘å¸ƒåŒ…è½¯ä»¶å·²ç»æŒ‰ç…§RedHatï¼ˆRedhat Package Managerï¼‰çš„åŒ…ç®¡ç†å·¥å…·è§„èŒƒRPMè¿›è¡Œæ‰“åŒ…å‘å¸ƒï¼Œéœ€è¦èŽ·å–åˆ°ç›¸åº”çš„è½¯ä»¶RPMå‘å¸ƒåŒ…ï¼Œç„¶åŽç”¨rpmå‘½ä»¤è¿›è¡Œå®‰è£… Mysqlå®‰è£… 1234567891011121314151617181920# rpmå®‰è£…å‘½ä»¤1ã€å®‰è£…åŒ…ï¼šrpm -ivh åŒ…åå‚æ•°ï¼š-i ï¼šå®‰è£…çš„æ„æ€-v ï¼šå¯è§†åŒ–-h ï¼šæ˜¾ç¤ºå®‰è£…è¿›åº¦å¦å¤–åœ¨å®‰è£…ä¸€ä¸ªrpmåŒ…æ—¶å¸¸ç”¨çš„é™„å¸¦å‚æ•°æœ‰ï¼š--force å¼ºåˆ¶å®‰è£…ï¼Œå³ä½¿è¦†ç›–å±žäºŽå…¶ä»–åŒ…çš„æ–‡ä»¶ä¹Ÿè¦å®‰è£…--nodeps å½“è¦å®‰è£…çš„rpmåŒ…ä¾èµ–å…¶ä»–åŒ…æ—¶ï¼Œå³ä½¿å…¶ä»–åŒ…æ²¡æœ‰å®‰è£…ï¼Œä¹Ÿè¦å®‰è£…è¿™ä¸ªåŒ…2ã€å‡çº§åŒ…ï¼šrpm -Uvh filename-U å‡çº§3ã€å¸è½½åŒ…rpm -e filename ï¼ˆè¿™é‡Œçš„filenameæ˜¯é€šè¿‡rpmçš„æŸ¥è¯¢åŠŸèƒ½æ‰€æŸ¥è¯¢åˆ°çš„ï¼‰4ã€æŸ¥è¯¢ä¸€ä¸ªåŒ…æ˜¯å¦å®‰è£…ï¼šrpm -q åŒ…åï¼ˆè¿™é‡Œçš„åŒ…åï¼Œæ˜¯ä¸å¸¦æœ‰å¹³å°ä¿¡æ¯ä»¥åŠåŽç¼€åçš„ï¼‰5.æŸ¥è¯¢å½“å‰å®‰è£…çš„æ‰€æœ‰rpmåŒ…ï¼šrpm -qaæŸ¥è¯¢å½“å‰å®‰è£…çš„å’Œsqlç›¸å…³çš„åŒ…ï¼šrpm -qa | grep 'sql'æŸ¥è¯¢sqliteå®‰è£…è·¯å¾„ï¼šrpm -ql sqlite 5. è®¾ç½®æœ¬åœ°/ç½‘ç»œyumæº é¦–å…ˆæ£€æŸ¥è™šæ‹Ÿæœºçš„ CD/DVDé©±åŠ¨å™¨æ˜¯å¦æœ‰æŒ‚è½½isoé•œåƒæ–‡ä»¶ æ‰¾åˆ°æŒ‚è½½æºçš„ä½ç½® åœ¨ /dev/sr0ä¸‹, å°†å…¶æŒ‚è½½åˆ°/mntä¸‹åˆ›å»ºçš„cdromæ–‡ä»¶å¤¹ä¸‹ mount -t iso9660 -o ro /dev/sr0 /media/cdrom é…ç½®å¼€æœºæŒ‚è½½ , vi /etc/fstab, å¢žåŠ ä¸€è¡Œ /dev/cdrom /media/cdrom iso9660 defaults 0 0 åˆ›å»ºè½¯è¿žæŽ¥, è®¾ç½®å¯ä»¥é€šè¿‡webè®¿é—® ln -s /mnt/cdrom/ /var/www/html/yumsorurce ä¿®æ”¹etc/yum.repos.dä¸­çš„æ–‡ä»¶entOS-Media.repoä¸­çš„enabled=1, å¼€å¯ä»Žæœ¬åœ°å¯»æ‰¾, å› ä¸ºæ–‡ä»¶ä¸­, åŽŸæœ¬å°±é…ç½®äº†baseurl: file:///media/cdrom/, è€Œæˆ‘ä»¬è‡ªå·±åˆ›å»ºäº†media/cdromè¿™ä¸ªç›®å½•, æ‰€ä»¥å°±å¯ä»¥ä»Žè¿™é‡Œé¢è¯»å–äº† æ‰§è¡Œyum repolist, å‘çŽ°å·²ç»èƒ½è¯»å–å‡ºmediaä¸­çš„repoäº†, å¤§åŠŸå‘Šæˆ c6-media CentOS-6 - Media 6,575 tips: ä¸ªäººè§‰å¾—è¿˜æ˜¯é…ç½®ä¸ªç½‘ç»œæºæ¯”è¾ƒå¥½, æ¯”å¦‚163/é˜¿é‡Œçš„. 12345678910111213141516171819# æ“ä½œæ­¥éª¤# 1.å¤‡ä»½åŽŸæ¥çš„Baseæºcd /etc/yum.repos.d/mv CentOS-Base.repo CentOS-Base.repo_bak# 2. ä¸‹è½½ç½‘æ˜“/é˜¿é‡Œæº åˆ°/etc/yum.repos.dä¸‹, æ›¿æ¢æŽ‰åŽŸæœ¬çš„# ç½‘æ˜“æºwget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.163.com/.help/CentOS6-Base-163.repo# é˜¿é‡Œæºwget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repoyum clean allyum makecache# yumä½¿ç”¨yum update ô»¦ô»§ô·‰ô·Šå‡çº§ç³»ç»Ÿyum install -y xxx ç›´æŽ¥å®‰è£…, ä¸ç”¨ç¡®è®¤ô»ˆyum update ~ ô»¦ô»§ô¸»ô¹ºô·œ å‡çº§æŒ‡å®šè½¯ä»¶åŒ…yum remove ~ ôºŒô·Žô¸»ô¹ºô·œô·• å¸è½½æŒ‡å®šè½¯ä»¶ æŒ‚è½½, é…ç½®æºçš„å…¶ä»–è¯´æ˜Ž 12345678910111213141516171819202122232425# å…³äºŽæŒ‚è½½# lrwxrwxrwx. 1 root root 3 5æœˆ 25 16:47 cdrom -&gt; sr0cdromå…¶å®žæ˜¯sr0çš„è½¯é“¾æŽ¥, å› æ­¤ç›´æŽ¥æ‰¾sr0å³å¯# æŒ‚è½½çš„åŸºæœ¬è¯­æ³•mont -t iso9660 -o ro(åªè¯») /dev/sr0 /mnt/cdrom (æŒ‚è½½ç±»åž‹) (æŒ‚è½½æ–¹å¼) (æŒ‚è½½æº) (æŒ‚è½½ç‚¹)# å¸è½½çš„è¯­æ³•umount /mnt/cdrom å¦‚æžœå¸è½½æ—¶é‡åˆ° umount: /mnt/cdrom: device is busy.è§£å†³æ–¹å¼: 1. æŸ¥æ‰¾å“ªä¸ªè¿›ç¨‹åœ¨ç”¨: fuser /mnt/cdrom 2. æŸ¥æ‰¾è¿›ç¨‹: ps -ef | grep è¿›ç¨‹å· 3. æ’æ­»è¿›ç¨‹: kill -9 è¿›ç¨‹å·, å¦‚æžœæ˜¯rootç”¨æˆ·, å¯èƒ½ä¼šæ–­å¼€è¿žæŽ¥, éœ€è¦é‡è¿ž 4. ç„¶åŽç»§ç»­ umount, å¦‚æžœä¸è¡Œ, å°±å¼ºåˆ¶å¸è½½ umount -f /mnt/cdrom# å…³äºŽetc/yum.repos.d ä¸­æ–‡ä»¶çš„è¯´æ˜Ž CentOS-Base.repoï¼šæœ‰ç½‘çš„çŽ¯å¢ƒä¸‹é»˜è®¤ä½¿ç”¨è¿™ä¸ªï¼Œè¿™ä¸ªæ˜¯ç¬¬ä¸€ä¼˜å…ˆçº§ã€‚å› ä¸ºæ²¡ç½‘ï¼Œæ‰€ä»¥ä¿®æ”¹æ–‡ä»¶åï¼Œè®¾ç½®æˆå¤‡ä»½æ–‡ä»¶ã€‚è¿™æ ·ç³»ç»Ÿå°±ä¼šä½¿ç”¨ç¬¬äºŒä¼˜å…ˆçº§çš„æ–‡ä»¶ã€‚ CentOS-Media.repoï¼šæ²¡ç½‘çš„çŽ¯å¢ƒä¸‹ä½¿ç”¨è¿™ä¸ªï¼Œåœ¨ä¸Šå›¾ä¸­ä¼šå‘çŽ°ä»–é»˜è®¤é…ç½®äº†4ä¸ªè·¯å¾„ï¼Œç¬¬4ä¸ªyumsourceæ˜¯æˆ‘è‡ªå·±åŠ çš„ã€‚æ„æ€æ˜¯è¯´ï¼Œå¦‚æžœç³»ç»Ÿæ£€æµ‹yumä½¿ç”¨äº†ç¦»çº¿å®‰è£…ï¼Œé‚£ä¹ˆä¼šä»Žä¸Šåˆ°ä¸‹ä»Žè¿™4ä¸ªè·¯å¾„ä¸­æŸ¥æ‰¾å®‰è£…è½¯ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦æŠŠå…‰ç›˜æŒ‚è½½åœ¨è¿™å››ä¸ªç›®å½•ä¸‹çš„ä»»æ„ä¸€ä¸ªç›®å½•å³å¯ã€‚åŒæ—¶ï¼Œè¯¥é…ç½®æ–‡ä»¶é»˜è®¤æ˜¯ä¸å¯ç”¨çš„ï¼Œå¦‚æžœæƒ³ä½¿ç”¨éœ€è¦ä¿®æ”¹å€’æ•°ç¬¬äºŒè¡Œçš„enabledä¸º1ï¼Œå¦åˆ™è¯¥æ–‡ä»¶æ— æ•ˆã€‚ # /mnt &amp; /media ç›®å½•çš„åŒºåˆ«mediaï¼šæŒ‚è½½ä¸€äº›ç§»åŠ¨è®¾å¤‡ï¼Œä¾‹å¦‚å…‰ç›˜ï¼ŒUç›˜ç­‰ã€‚mntï¼š æŒ‚è½½ä¸€äº›ç¡¬ç›˜ç­‰è®¾å¤‡ã€‚æ‰€ä»¥æˆ‘ä»¬çš„å…‰ç›˜åº”è¯¥æŒ‚è½½åœ¨mediaç›®å½•ä¸‹ï¼Œä»Žyumç»™çš„é»˜è®¤é…ç½®æ–‡ä»¶ä¹Ÿèƒ½çœ‹å‡ºã€‚ 6. è¿›ç¨‹ç›¸å…³1. pså‘½ä»¤pså‘½ä»¤ç”¨äºŽæŠ¥å‘Šå½“å‰ç³»ç»Ÿçš„è¿›ç¨‹çŠ¶æ€ã€‚å¯ä»¥æ­é…killæŒ‡ä»¤éšæ—¶ä¸­æ–­ã€åˆ é™¤ä¸å¿…è¦çš„ç¨‹åºã€‚ å¸¸ç”¨é€‰é¡¹åŒ…æ‹¬ï¼š 123456ps -1ã€-aæ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„è¿›ç¨‹2ã€-uæ˜¾ç¤ºç”¨æˆ·åå’Œå¯åŠ¨æ—¶é—´3ã€-xæ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼ŒåŒ…æ‹¬æ²¡æœ‰æŽ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹4ã€-eæ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼ŒåŒ…æ‹¬æ²¡æœ‰æŽ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹ï¼Œè¾ƒxé€‰é¡¹ï¼Œä¿¡æ¯æ›´ä¸ºç®€ç•¥5ã€-læ˜¾ç¤ºè¿›ç¨‹è¯¦ç»†ä¿¡æ¯ï¼ŒæŒ‰é•¿æ ¼å¼æ˜¾ç¤º å¸¸ç”¨ç»„åˆ ps -au æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·è¿›ç¨‹ï¼Œå¹¶ç»™å‡ºç”¨æˆ·åå’Œå¯åŠ¨æ—¶é—´ç­‰è¯¦ç»†ä¿¡æ¯ ps -aux æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·è¿›ç¨‹ï¼ŒåŒ…æ‹¬æ²¡æœ‰æŽ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹ï¼Œå¹¶ç»™å‡ºç”¨æˆ·å’Œå’Œå¯åŠ¨åŸ‹å•ç­‰è¯¦ç»†ä¿¡æ¯ ps -el æŒ‰é•¿æ ¼å¼æ˜¾ç¤ºè¿›ç¨‹è¯¦ç»†ä¿¡æ¯ 1234567891011121314151617181920212223242526272829303132# ä¸Šè¿°å‘½ä»¤å¯èƒ½å‡ºçŽ°çš„å­—æ®µå«ä¹‰USER: è¿›ç¨‹æ‰€æœ‰è€…PID: è¿›ç¨‹å·PPID: è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ID%CPU: CPUå ç”¨çŽ‡C: è¿›ç¨‹çš„CPUå ç”¨çŽ‡%MEM: å†…å­˜å ç”¨çŽ‡VSZ: è¡¨ç¤ºå¦‚æžœä¸€ä¸ªç¨‹åºå®Œå…¨é©»ç•™åœ¨å†…å­˜çš„è¯éœ€è¦å ç”¨å¤šå°‘å†…å­˜ç©ºé—´;RSS: æŒ‡æ˜Žäº†å½“å‰å®žé™…å ç”¨äº†å¤šå°‘å†…å­˜;TTY: ç»ˆç«¯çš„æ¬¡è¦è£…ç½®å·ç  (minor device number of tty)Fï¼šè¿›ç¨‹çš„æ ‡å¿—Sï¼šè¿›ç¨‹çš„çŠ¶æ€STAT: è¯¥è¿›ç¨‹ç¨‹çš„çŠ¶æ€ï¼Œæœ‰ä»¥ä¸‹å€¼D: ä¸å¯ä¸­æ–­çš„é™æ­¢R: æ­£åœ¨æ‰§è¡Œä¸­S: é™æ­¢çŠ¶æ€T: æš‚åœæ‰§è¡ŒZ: ä¸å­˜åœ¨ä½†æš‚æ—¶æ— æ³•æ¶ˆé™¤W: æ²¡æœ‰è¶³å¤Ÿçš„è®°å¿†ä½“åˆ†é¡µå¯åˆ†é…&lt;: é«˜ä¼˜å…ˆåºçš„è¿›ç¨‹N: ä½Žä¼˜å…ˆåºçš„è¿›ç¨‹L: æœ‰è®°å¿†ä½“åˆ†é¡µåˆ†é…å¹¶é”åœ¨è®°å¿†ä½“å†…PRIï¼šè¿›ç¨‹çš„ä¼˜å…ˆæƒNIï¼šè¿›ç¨‹çš„Niceå€¼ADDRï¼šè¿›ç¨‹çš„åœ°å€ç©ºé—´SZï¼šè¿›ç¨‹å ç”¨å†…å­˜çš„å¤§å°WCHANï¼šè¿›ç¨‹å½“å‰æ˜¯å¦åœ¨è¿è¡ŒTTYï¼šè¿›ç¨‹æ‰€å±žç»ˆç«¯START: è¿›ç¨‹å¼€å§‹æ—¶é—´TIME: æ‰§è¡Œçš„è¿è¡Œæ—¶é—´COMMANDï¼šæ‰€æ‰§è¡Œçš„æŒ‡ä»¤CMDï¼šè¿›ç¨‹çš„å‘½ä»¤ 2. kill / pidof / pkill å‘½ä»¤æœ‰æ—¶å€™æŸä¸ªè¿›ç¨‹å¯èƒ½ä¼šé•¿æœŸå ç”¨CPUèµ„æºæˆ–æ— æ³•æ­£å¸¸æ‰§è¡Œæˆ–è¶…å‡ºè¿è¡Œæ—¶é—´ç­‰ï¼Œæ­¤æ—¶å¯èƒ½å¸Œæœ›äººå·¥å¹²é¢„ç›´æŽ¥å°†è¿›ç¨‹æ€æ­»ï¼Œè¿™æ—¶å€™killå‘½ä»¤å¯ä»¥æ´¾ä¸Šç”¨åœº 12341ã€kill pid ç›´æŽ¥æ€æ­»è¿›ç¨‹ï¼Œä½†ä¸èƒ½ä¿è¯ä¸€å®šèƒ½æ€æ­»2ã€kill -9 pid å¼ºåˆ¶æ€æ­»è¿›ç¨‹3ã€pidofå‘½ä»¤ç”¨äºŽæŸ¥çœ‹æŸä¸ªè¿›ç¨‹çš„è¿›ç¨‹å·ï¼ˆä¾‹å¦‚ï¼špidof mysqldï¼‰4ã€pkillå‘½ä»¤å¯ä»¥æŒ‰ç…§è¿›ç¨‹åæ€æ­»è¿›ç¨‹ã€‚pkillå’Œkillallåº”ç”¨æ–¹æ³•å·®ä¸å¤šï¼Œä¹Ÿæ˜¯ç›´æŽ¥æ€æ­»è¿è¡Œä¸­çš„ç¨‹åºï¼›å¦‚æžœæ‚¨æƒ³æ€æŽ‰å•ä¸ªè¿›ç¨‹ï¼Œè¯·ç”¨killæ¥æ€æŽ‰ 3. è¿›ç¨‹åˆ‡æ¢å‰å°è¿›ç¨‹æŒ‡çš„æ˜¯è¿›ç¨‹åœ¨æ‰§è¡Œæ—¶ä¼šå°†å‘½ä»¤è¡Œé˜»å¡žï¼Œç›´åˆ°è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ï¼›åŽå°è¿›ç¨‹æŒ‡çš„æ˜¯è¿›ç¨‹åœ¨æ‰§è¡Œæ—¶ä¸ä¼šé˜»å¡žå½“å‰å‘½ä»¤è¡Œï¼Œè€Œæ˜¯åœ¨ç³»ç»ŸåŽå°æ‰§è¡Œ 123451ã€ctrl + c ç»ˆæ­¢è¿›ç¨‹2ã€ctrl + z æŒ‚èµ·è¿›ç¨‹3ã€fgå‘½ä»¤å°†è¿›ç¨‹è½¬æ¢åˆ°å‰å°æ‰§è¡Œ4ã€bgå‘½ä»¤å°†è¿›ç¨‹è½¬æ¢åˆ°åŽå°æ‰§è¡Œ5ã€jobså‘½ä»¤æŸ¥çœ‹ä»»åŠ¡ 4. topå‘½ä»¤top å‘½ä»¤å¯ä»¥å®šæœŸæ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨è¿è¡Œå’Œå®žé™…è¿è¡Œå¹¶ä¸”æ›´æ–°åˆ°åˆ—è¡¨ä¸­ï¼Œå®ƒæ˜¾ç¤ºå‡º CPU çš„ä½¿ç”¨ã€å†…å­˜çš„ä½¿ç”¨ã€äº¤æ¢å†…å­˜ã€ç¼“å­˜å¤§å°ã€ç¼“å†²åŒºå¤§å°ã€è¿‡ç¨‹æŽ§åˆ¶ã€ç”¨æˆ·å’Œæ›´å¤šå‘½ä»¤ã€‚å®ƒä¹Ÿä¼šæ˜¾ç¤ºå†…å­˜å’Œ CPU ä½¿ç”¨çŽ‡è¿‡é«˜çš„æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚ æŒ‰qé”®é€€å‡ºæŸ¥çœ‹. 5. pstreeå‘½ä»¤å°†è¿›ç¨‹é—´çš„å…³ç³»ä»¥æ ‘ç»“æž„çš„å½¢å¼å±•ç¤ºï¼Œèƒ½æ¸…æ¥šçœ‹å„è¿›ç¨‹ä¹‹é—´çš„çˆ¶å­å…³ç³» 12pstree ï¼šä»¥æ ‘çŠ¶å½¢å¼æ˜¾ç¤ºè¿›ç¨‹pstree -p ï¼š ä»¥æ ‘çŠ¶å½¢å¼æ˜¾ç¤ºè¿›ç¨‹ï¼Œå¹¶ä¸”æ˜¾ç¤ºè¿›ç¨‹å· 6. JPSå‘½ä»¤JPSå‘½ä»¤æ˜¯JDKæä¾›çš„ä¸€ä¸ªæ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å¯åŠ¨äº†JVMè¿›ç¨‹çš„ä¸€ä¸ªè¿›ç¨‹ã€‚ä¸æ˜¯linuxç³»ç»Ÿè‡ªå¸¦çš„ã€‚ä¸»è¦ä»»åŠ¡å°±æ˜¯ç”¨æ¥æ£€æŸ¥javaè¿›ç¨‹çš„ã€‚ 7. è®¡åˆ’ä»»åŠ¡æ¦‚å¿µè®¡åˆ’ä»»åŠ¡åœ¨Linuxçš„ä½“çŽ°ä¸»è¦åˆ†ä¸ºatå’Œcrontabï¼Œå…¶ä¸­ï¼š atï¼šé€šè¿‡atå‘½ä»¤å®‰æŽ’ä»»åŠ¡åœ¨æŸä¸€æ—¶åˆ»æ‰§è¡Œä¸€æ¬¡ crontabï¼šé€šè¿‡crontab å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å›ºå®šçš„é—´éš”æ—¶é—´æ‰§è¡ŒæŒ‡å®šçš„ç³»ç»ŸæŒ‡ä»¤æˆ– shell scriptè„šæœ¬ã€‚æ—¶é—´é—´éš”çš„å•ä½å¯ä»¥æ˜¯åˆ†é’Ÿã€å°æ—¶ã€æ—¥ã€æœˆã€å‘¨åŠä»¥ä¸Šçš„ä»»æ„ç»„åˆã€‚è¿™ä¸ªå‘½ä»¤éžå¸¸é€‚åˆå‘¨æœŸæ€§çš„æ—¥å¿—åˆ†æžæˆ–æ•°æ®å¤‡ä»½ç­‰å·¥ä½œã€‚ å‘½ä»¤æœåŠ¡ç®¡ç†crontabåœ¨CentOSç³»ç»Ÿä¸Šï¼ŒcrontabæœåŠ¡çš„åç§°å«åšcrond å®‰è£… yum -y install crontabs æœåŠ¡æ“ä½œè¯´æ˜Ž 1234567891011service crond start #å¯åŠ¨æœåŠ¡service crond stop #å…³é—­æœåŠ¡service crond restart #é‡å¯æœåŠ¡service crond reload #é‡æ–°è½½å…¥é…ç½®service crond status #æœåŠ¡çŠ¶æ€#æŸ¥çœ‹crontabæœåŠ¡æ˜¯å¦å·²è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨ï¼Œæ‰§è¡Œå‘½ä»¤ï¼šchkconfig --list#åŠ å…¥å¼€æœºè‡ªåŠ¨å¯åŠ¨ï¼šchkconfig --level 35 crond on crontabåŠŸèƒ½ä½¿ç”¨ å‘½ä»¤æ ¼å¼ 123456789101112131415161718192021222324252627282930313233crontab [-u user] filecrontab [-u user] [ -e | -l | -r ]# crontab å‚æ•°è¯´æ˜Žï¼š-u userï¼šç”¨æ¥è®¾å®šæŸä¸ªç”¨æˆ·çš„crontabæœåŠ¡ï¼Œä¾‹å¦‚ï¼Œâ€-u ixdbaâ€è¡¨ç¤ºè®¾å®šixdbaç”¨æˆ·çš„crontabæœåŠ¡ï¼Œæ­¤å‚æ•°ä¸€èˆ¬æœ‰rootç”¨æˆ·æ¥è¿è¡Œã€‚fileï¼šfileæ˜¯å‘½ä»¤æ–‡ä»¶çš„åå­—,è¡¨ç¤ºå°†fileåšä¸ºcrontabçš„ä»»åŠ¡åˆ—è¡¨æ–‡ä»¶å¹¶è½½å…¥crontabã€‚-eï¼šç¼–è¾‘æŸä¸ªç”¨æˆ·çš„crontabæ–‡ä»¶å†…å®¹ã€‚å¦‚æžœä¸æŒ‡å®šç”¨æˆ·ï¼Œåˆ™è¡¨ç¤ºç¼–è¾‘å½“å‰ç”¨æˆ·çš„crontabæ–‡ä»¶ã€‚-lï¼šæ˜¾ç¤ºæŸä¸ªç”¨æˆ·çš„crontabæ–‡ä»¶å†…å®¹ï¼Œå¦‚æžœä¸æŒ‡å®šç”¨æˆ·ï¼Œåˆ™è¡¨ç¤ºæ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„crontabæ–‡ä»¶å†…å®¹ã€‚-rï¼šåˆ é™¤å®šæ—¶ä»»åŠ¡é…ç½®ï¼Œä»Ž/var/spool/cronç›®å½•ä¸­åˆ é™¤æŸä¸ªç”¨æˆ·çš„crontabæ–‡ä»¶ï¼Œå¦‚æžœä¸æŒ‡å®šç”¨æˆ·ï¼Œåˆ™é»˜è®¤åˆ é™¤å½“å‰ç”¨æˆ·çš„crontabæ–‡ä»¶ã€‚-iï¼šåœ¨åˆ é™¤ç”¨æˆ·çš„crontabæ–‡ä»¶æ—¶ç»™ç¡®è®¤æç¤ºã€‚# å‘½ä»¤ç¤ºä¾‹ï¼šcrontab file [-u user] ## ç”¨æŒ‡å®šçš„æ–‡ä»¶æ›¿ä»£ç›®å‰çš„crontabã€‚ # å¿…é¡»æŽŒæ¡ï¼šcrontab -l [-u user] ## åˆ—å‡ºç”¨æˆ·ç›®å‰çš„crontab. crontab -e [-u user] ## ç¼–è¾‘ç”¨æˆ·ç›®å‰çš„crontab.# é€šè¿‡crontabæ·»åŠ çš„è®¡åˆ’ä»»åŠ¡éƒ½ä¼šå­˜å‚¨åœ¨/var/spool/cron/ç›®å½•é‡Œ# æŸ¥çœ‹å½“å‰æœåŠ¡çŠ¶æ€service crond status# æ“ä½œæœåŠ¡/sbin/service crond start //å¯åŠ¨æœåŠ¡/sbin/service crond stop //å…³é—­æœåŠ¡/sbin/service crond restart //é‡å¯æœåŠ¡/sbin/service crond reload //é‡æ–°è½½å…¥é…ç½®# æŸ¥çœ‹å¼€æœºå¯åŠ¨æœåŠ¡ntsysv # é€€å‡ºæ—¶, æŒ‰tabåˆ‡æ¢# åŠ å…¥å¼€æœºè‡ªåŠ¨å¯åŠ¨chkconfig â€“level 35 crond on é…ç½®è¯´æ˜Ž 123456789101112131415161718# åŸºæœ¬æ ¼å¼ : * * * * * command åˆ† æ—¶ æ—¥ æœˆ å‘¨ å‘½ä»¤ # æ¯ä¸ªå°æ—¶çš„ç¬¬å‡ åˆ†é’Ÿæ‰§è¡Œè¯¥ä»»åŠ¡. å…¶å®ƒçš„ç±»ä¼¼ç¬¬1åˆ—è¡¨ç¤ºåˆ†é’Ÿ1ï½ž59 æ¯åˆ†é’Ÿç”¨*æˆ–è€… */1è¡¨ç¤º ç¬¬2åˆ—è¡¨ç¤ºå°æ—¶0ï½ž23ï¼ˆ0è¡¨ç¤º0ç‚¹ï¼‰ 7-9è¡¨ç¤ºï¼š8ç‚¹åˆ°10ç‚¹ä¹‹é—´ç¬¬3åˆ—è¡¨ç¤ºæ—¥æœŸ1ï½ž31 ç¬¬4åˆ—è¡¨ç¤ºæœˆä»½1ï½ž12 ç¬¬5åˆ—æ ‡è¯†å·æ˜ŸæœŸ0ï½ž6ï¼ˆ0è¡¨ç¤ºæ˜ŸæœŸå¤©ï¼‰ ç¬¬6åˆ—è¦è¿è¡Œçš„å‘½ä»¤# è®°ä½å‡ ä¸ªç‰¹æ®Šç¬¦å·çš„å«ä¹‰:â€œ*â€ä»£è¡¨å–å€¼èŒƒå›´å†…çš„æ•°å­—,â€œ/â€ä»£è¡¨â€æ¯â€,â€œ-â€ä»£è¡¨ä»ŽæŸä¸ªæ•°å­—åˆ°æŸä¸ªæ•°å­—,â€œ,â€åˆ†å¼€å‡ ä¸ªç¦»æ•£çš„æ•°å­— é…ç½®ç¤ºä¾‹ 123456789101112131415161718192021222324252627282930313233# * * * * * command # åˆ† æ—¶ æ—¥ æœˆ å‘¨ å‘½ä»¤ */1 * * * * date &gt;&gt; /root/date.txtä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡dateå‘½ä»¤å¯ç”¨ tail -fæŸ¥çœ‹30 21 * * * /usr/local/etc/rc.d/httpd restartä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºæ¯æ™šçš„21:30é‡å¯apache45 4 1,10,22 * * /usr/local/etc/rc.d/httpd restartä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºæ¯æœˆ1ã€10ã€22æ—¥çš„4 : 45é‡å¯apache10 1 * * 6,0 /usr/local/etc/rc.d/httpd restart ä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºæ¯å‘¨å…­ã€å‘¨æ—¥çš„1 : 10é‡å¯apache0,30 18-23 * * * /usr/local/etc/rc.d/httpd restartä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºåœ¨æ¯å¤©18 : 00è‡³23 : 00ä¹‹é—´æ¯éš”30åˆ†é’Ÿé‡å¯apache0 23 * * 6 /usr/local/etc/rc.d/httpd restartä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºæ¯æ˜ŸæœŸå…­çš„11 : 00 pmé‡å¯apache* */1 * * * /usr/local/etc/rc.d/httpd restartä¸Šé¢çš„ä¾‹å­æ¯ä¸€å°æ—¶é‡å¯apache* 23-7/1 * * * /usr/local/etc/rc.d/httpd restartä¸Šé¢çš„ä¾‹å­æ™šä¸Š11ç‚¹åˆ°æ—©ä¸Š7ç‚¹ä¹‹é—´ï¼Œæ¯éš”ä¸€å°æ—¶é‡å¯apache0 11 4 * mon-wed /usr/local/etc/rc.d/httpd restartä¸Šé¢çš„ä¾‹å­æ¯æœˆçš„4å·ä¸Žæ¯å‘¨ä¸€åˆ°å‘¨ä¸‰çš„11ç‚¹é‡å¯apache0 4 1 jan * /usr/local/etc/rc.d/httpd restart ä¸Šé¢çš„ä¾‹å­ä¸€æœˆä¸€å·çš„4ç‚¹é‡å¯apache æ›´è¯¦ç»†çš„è§è¿™é‡Œ 8. Linuxè™šæ‹Ÿä¸»æœºé›†ç¾¤æµ‹è¯•çŽ¯å¢ƒåŸºæœ¬æ­å»º æ³¨æ„ç‚¹: é¦–æ¬¡ä½¿ç”¨ NAT æ¨¡å¼è£…å¥½CentOSä¹‹åŽ, ä½¿ç”¨ifconfigæŸ¥çœ‹ip, è™šæ‹Ÿæœºæ˜¯æ²¡æœ‰ipçš„, éœ€è¦æ‰‹åŠ¨å¼€å¯ipæœåŠ¡, å‘½ä»¤æ˜¯ dhclient, å¦‚æžœå·²å¼€å¯å°±ä¸èƒ½å†æ¬¡å¼€å¯ 1. ç¬¬ä¸€å°è™šæ‹Ÿä¸»æœºçš„é™æ€ipé…ç½®(é’ˆå¯¹äºŽmacçŽ¯å¢ƒ) æ‰§è¡Œifconfigå‘½ä»¤, å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667shixuanji@x:~|â‡’ ifconfiglo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 16384 options=1203&lt;RXCSUM,TXCSUM,TXSTATUS,SW_TIMESTAMP&gt; inet 127.0.0.1 netmask 0xff000000 inet6 ::1 prefixlen 128 inet6 fe80::1%lo0 prefixlen 64 scopeid 0x1 nd6 options=201&lt;PERFORMNUD,DAD&gt;gif0: flags=8010&lt;POINTOPOINT,MULTICAST&gt; mtu 1280stf0: flags=0&lt;&gt; mtu 1280EHC29: flags=0&lt;&gt; mtu 0EHC26: flags=0&lt;&gt; mtu 0XHC20: flags=0&lt;&gt; mtu 0en0: flags=8823&lt;UP,BROADCAST,SMART,SIMPLEX,MULTICAST&gt; mtu 1500 ether 60:03:08:a1:ac:ee nd6 options=201&lt;PERFORMNUD,DAD&gt; media: autoselect (&lt;unknown type&gt;) status: inactivep2p0: flags=8802&lt;BROADCAST,SIMPLEX,MULTICAST&gt; mtu 2304 ether 02:03:08:a1:ac:ee media: autoselect status: inactiveawdl0: flags=8902&lt;BROADCAST,PROMISC,SIMPLEX,MULTICAST&gt; mtu 1484 ether 72:25:b2:c8:2a:03 nd6 options=201&lt;PERFORMNUD,DAD&gt; media: autoselect status: inactiveen1: flags=8963&lt;UP,BROADCAST,SMART,RUNNING,PROMISC,SIMPLEX,MULTICAST&gt; mtu 1500 options=60&lt;TSO4,TSO6&gt; ether 32:00:1a:0d:12:00 media: autoselect &lt;full-duplex&gt; status: inactiveen2: flags=8963&lt;UP,BROADCAST,SMART,RUNNING,PROMISC,SIMPLEX,MULTICAST&gt; mtu 1500 options=60&lt;TSO4,TSO6&gt; ether 32:00:1a:0d:12:01 media: autoselect &lt;full-duplex&gt; status: inactivebridge0: flags=8822&lt;BROADCAST,SMART,SIMPLEX,MULTICAST&gt; mtu 1500 options=63&lt;RXCSUM,TXCSUM,TSO4,TSO6&gt; ether 32:00:1a:0d:12:00 Configuration: id 0:0:0:0:0:0 priority 0 hellotime 0 fwddelay 0 maxage 0 holdcnt 0 proto stp maxaddr 100 timeout 1200 root id 0:0:0:0:0:0 priority 0 ifcost 0 port 0 ipfilter disabled flags 0x2 member: en1 flags=3&lt;LEARNING,DISCOVER&gt; ifmaxaddr 0 port 10 priority 0 path cost 0 member: en2 flags=3&lt;LEARNING,DISCOVER&gt; ifmaxaddr 0 port 11 priority 0 path cost 0 media: &lt;unknown type&gt; status: inactiveutun0: flags=8051&lt;UP,POINTOPOINT,RUNNING,MULTICAST&gt; mtu 2000 inet6 fe80::2ed8:c28:27b2:f5d2%utun0 prefixlen 64 scopeid 0xd nd6 options=201&lt;PERFORMNUD,DAD&gt;vmnet1: flags=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500 ether 00:50:56:c0:00:01 inet 172.16.63.1 netmask 0xffffff00 broadcast 172.16.63.255vmnet8: flags=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500 ether 00:50:56:c0:00:08 inet 192.168.170.1 netmask 0xffffff00 broadcast 192.168.170.255en4: flags=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500 options=3&lt;RXCSUM,TXCSUM&gt; ether 00:0e:c6:cc:ae:d7 inet6 fe80::1c60:7fe2:3947:4ec0%en4 prefixlen 64 secured scopeid 0x11 inet 192.168.63.148 netmask 0xffffff00 broadcast 192.168.63.255 nd6 options=201&lt;PERFORMNUD,DAD&gt; media: autoselect (100baseTX &lt;full-duplex,flow-control&gt;) status: active æ‰¾åˆ°æœ€åŽçš„vmnet8, å…¶ä¸­çš„ inet å°±æ˜¯è™šæ‹Ÿä¸»æœºçš„ç½‘æ®µ, é…ç½®è™šæ‹Ÿä¸»æœºçš„é™æ€ipçš„æ—¶å€™, å°±é…ç½®æ­¤ç½‘æ®µå†…çš„. å¹¿æ’­åœ°å€ broadcastä¹Ÿæ˜¯è™šæ‹Ÿä¸»æœºNATçš„å¹¿æ’­åœ°å€, é…ç½®æ—¶å¯ä»¥ä¸å¡« 123vmnet8: flags=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500 ether 00:50:56:c0:00:08 inet 192.168.170.1 netmask 0xffffff00 broadcast 192.168.170.255 ä¿®æ”¹è™šæ‹Ÿæœºç½‘å¡é…ç½®vi /etc/sysconfig/network-scripts/ifcfg-eth0, åšå¦‚ä¸‹é…ç½® 123456789101112DEVICE=eth0HWADDR=00:0C:29:D6:C7:0ETYPE=EthernetUUID=bebc1b63-4f20-405a-860a-32d0d8211582ONBOOT=yesNM_CONTROLLED=yesBOOTPROTO=static # ipç±»åž‹IPADDR=192.168.170.6 # ipåœ°å€, ä¸Ž vmnet8 åœ¨åŒä¸€ç½‘æ®µNETMASK=255.255.255.0 # å­ç½‘æŽ©ç GATEWAY=192.168.170.2 # ç½‘å…³, è·Ÿ ipåœ¨åŒä¸€ç½‘æ®µDNS1=192.168.170.2 # ä¸Ž ip åŒä¸€ç½‘æ®µ DNS2=8.8.8.8 # googleçš„ dns é‡å¯ç½‘ç»œæœåŠ¡(è¿™é‡Œé‡å¯ä¹Ÿæ²¡å•¥ç”¨ï¼Œç­‰åŽé¢hostnameæ”¹å®Œäº†ï¼Œé‡å¯ä¸€ä¸‹) service network restart 2. å¤åˆ¶åŽŸæœ¬çš„è™šæ‹Ÿä¸»æœº å¤åˆ¶è™šæ‹Ÿä¸»æœº1åˆ°2 æŒ‰ç…§åŽŸè™šæ‹Ÿä¸»æœºçš„rootç”¨æˆ·å&amp;å¯†ç ç™»å½•2 3. ä¿®æ”¹æ–°æœºç½‘å¡ ä¿®æ”¹ç½‘å¡vi /etc/udev/rules.d/70-persistent-net.rules, åˆ é™¤eth0æ‰€åœ¨çš„æ•´ä¸ªæ®µè½, æŠŠä¸‹é¢çš„eth1æ”¹ä¸ºeth0, ä¿å­˜é€€å‡º ä¿®æ”¹ç½‘å¡é…ç½®vi /etc/sysconfig/network-scripts/ifcfg-eth0, å¦‚æžœæœ‰UUID, HARDDR, åˆ æŽ‰, IPADDRæ”¹ä¸ºä¸ŽåŽŸè™šæ‹Ÿä¸»æœºä¸åŒçš„åœ°å€, ä½†è¦åœ¨åŒä¸€ç½‘æ®µ, BOOTPROTOæ”¹ä¸ºstatic4. ä¿®æ”¹æ–°æœºhostname â€‹ ä¿®æ”¹hostname, vi /etc/sysconfig/network, æŠŠHOSTNAMEæ”¹ä¸ºè¦ä¿®æ”¹çš„åå­— 5.åˆ°è¿™é‡Œé…ç½®å®Œäº†ï¼Œé‡å¯ä¸€ä¸‹reboot 6. SSHå…å¯†ç™»å½•åŽŸç† æ³¨æ„ç‚¹ï¼šå¦‚æžœé‡åˆ°éœ€è¦æ·»åŠ æ–°æœºå™¨ä¹‹ç±»çš„ï¼Œæœ€å¥½æ˜¯å…ˆæŠŠ .sshæ–‡ä»¶åˆ æŽ‰ï¼Œç„¶åŽæ‰€æœ‰çš„æœºå™¨ä¸€èµ·æ“ä½œçœ‹ï¼Œå…¨éƒ¨éƒ½é‡æ–°ç”Ÿæˆssh-keygenï¼Œ å…¨éƒ¨é‡æ–°å‘é€ ssh-copy-id ï¼Œè¿™æ ·æœ€ç®€å•ï¼Œä¸æ˜“å‡ºé”™ åœ¨macç«¯ï¼Œä¼ ssh-copy-idæ—¶å€™ï¼Œè¦åˆ¶å®šç”¨æˆ·å ssh-copy-id ap@cs1ï¼›ç±»ä¼¼è¿™æ · æ–°æœºç”Ÿæˆè‡ªå·±å…¬é’¥ ssh-keygen, æ³¨æ„: å¦‚æžœåŽŸæœ¬ä¸»æœºä¸­å·²ç»ç”Ÿæˆ, æ­¤å¤„åœ¨æç¤ºverwrite (y/n)?çš„æ—¶å€™è¦é€‰æ‹©y, æ‰ä¼šé‡æ–°ç”Ÿæˆè¦†ç›– æŠŠæ–°ä¸»æœºå…¬é’¥å‘é€ç»™å…¶å®ƒæœºå™¨ ssh-copy-id root@xxx(å…¶å®ƒä¸»æœºip), æ­¤å‘½ä»¤ç›¸å½“äºŽ ä¸‹é¢2æ¡å‘½ä»¤çš„æ•ˆæžœ 12cat id_rsa.pub &gt; authorized_keysscp -r authorized_keys root@192.168.123.202:/root/.ssh/ å…¶ä»–ä¸»æœºä¹ŸæŠŠå…¬é’¥å‘ç»™æ–°ä¸»æœº, æ­¤æ—¶å°±å¯ä»¥å®žçŽ°ä¸»æœºé—´çš„å…å¯†ç™»å½•äº†. 7. åŠŸèƒ½å¢žå¼º(å¯é€‰) å¯ä»¥åœ¨ æ¯å°æœºå™¨ä¸­è®¾ç½®hoståˆ«å, vi /etc/hosts, åŠ ä¸Šxxx.xxx.xx.xxx cts1/2/3..., è¿™æ ·åœ¨è®¿é—®å…¶ä»–ä¸»æœºæ—¶, å¯ä»¥ç›´æŽ¥ç”¨åˆ«åæ›¿ä»£åŸŸå å¦‚æžœæ˜¯ç”¨çš„zshçš„shell, å¯ä»¥åœ¨æ‰€æœ‰ä¸»æœºçš„ &lt;sub&gt;.zshrcä¸­, æ·»åŠ alias login1=&#39;ssh root@cts1&#39; &gt;&gt; &lt;/sub&gt;/.zshrc, è¿™æ ·å¯ä»¥ç›´æŽ¥ ç”¨ login1ç™»å½•åˆ°å¯¹åº”çš„ä¸»æœº. 9. å®‰è£…, ä½¿ç”¨ zsh &amp; oh-my-zsh &amp;ç›¸å…³æ’ä»¶ä¸»éª¨æž¶å®‰è£…&amp;ä»‹ç» å®‰è£…zshå¥—ä»¶ 1yum install zsh -y å®‰è£… oh-my-zshå¥—ä»¶ 1sh -c "$(wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)" zsh çš„ä¸€äº›åŸºæœ¬é…ç½®æ“ä½œ, å¸¸ç”¨æ’ä»¶å®‰è£…è§è¿™é‡Œ! 12345678910111213141516171819202122# æŸ¥çœ‹oh-my-zsh çš„ä¸»é¢˜ls ~/.oh-my-zsh/themes------#è¿™é‡Œéƒ½æ˜¯ .zshrcä¸­çš„é…ç½®------# å¯ä»¥æ›´æ”¹ä¸ºrandom, è¿™æ ·ä¼šéšæœºæ˜¾ç¤º, å¾ˆæœ‰ä¹è¶£, ç›´æŽ¥è¾“å…¥zshä¹Ÿä¼šåˆ‡æ¢vi ~/.zshrcZSH_THEME="random"# æ·»åŠ plugin, æŒ‰ç…§å¯¹åº”æ–¹å¼å®‰è£…plugins=(git ... ... )# æ·»åŠ alias åˆ° ~/.zshrcalias vi='vim'alias zshconfig='vi ~/.zshrc'alias vimconfig='vi ~/.vimrc'-----------------------# è®¾ç½®å½“å‰ç”¨æˆ·ä½¿ç”¨zshä¸ºé»˜è®¤çš„shellchsh -s /bin/zsh# å¸è½½ oh-my-zshuninstall_oh_my_zsh zsh zsh çš„ä¸€äº›éªšæ°”æ“ä½œ 12345671. å…¼å®¹ bash, è¿™ä¸ªå°±ä¸ç”¨è¯´äº†2. è¾“å…¥æŸæ¡å‘½ä»¤, æ¯”å¦‚ cat, ç„¶åŽç”¨ä¸Šä¸‹é”®, å¯ä»¥ç¿»é˜…æ‰€æœ‰æ‰§è¡Œè¿‡çš„å‘½ä»¤3. å„ç§è¡¥å…¨, è¾“å…¥ä»»ä½•å‘½ä»¤, æŒ‰ 2ä¸‹ tabé”®, ä¸‹é¢ä¼šå‡ºçŽ°æ‰€æœ‰å¯èƒ½çš„è¡¥å…¨, å¯ä»¥ tab, æˆ– ä¸Šä¸‹å·¦å³åˆ‡æ¢.4. æ¯”å¦‚è¦æ€æŽ‰è¿›ç¨‹java, åŽŸæ¥æ˜¯éœ€è¦ ps aux | grep java, æŸ¥è¿›ç¨‹çš„ PIDï¼Œç„¶åŽ kill PID; çŽ°åœ¨åªéœ€è¦ kill java, ç„¶åŽæŒ‰ä¸‹ tab, javaä¼šè¢«æ›¿æ¢ä¸º å¯¹åº”çš„ PID, ç‚¹å›žè½¦, kill !5. ç›®å½•æµè§ˆå’Œè·³è½¬, è¾“å…¥ d, å¯ä»¥åˆ—å‡ºåœ¨è¿™ä¸ªå›žè¯ä¸­è®¿é—®è¿‡çš„ç›®å½•åˆ—è¡¨, å†è¾“å…¥åˆ—è¡¨å‰çš„åºå·, å³å¯ç›´æŽ¥è·³è½¬.6. åœ¨å½“å‰ç›®å½•ä¸‹è¾“å…¥ .. æˆ– ... , æˆ–è€…ç›´æŽ¥è¾“å…¥ç›®å½•å, éƒ½å¯ä»¥ç›´æŽ¥è·³è½¬, ç”šè‡³éƒ½ä¸éœ€è¦ä½¿ç”¨ cdå‘½ä»¤äº†.7. é€šé…ç¬¦æœç´¢ï¼šls -l */.shï¼Œå¯ä»¥é€’å½’æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹çš„ shell æ–‡ä»¶ï¼Œæ–‡ä»¶å°‘æ—¶å¯ä»¥ä»£æ›¿ findï¼Œæ–‡ä»¶å¤ªå¤šå°±æ­‡èœäº†. zshä¸»é¢˜ä»‹ç», zshæ’ä»¶ä»‹ç» zshå¸¸ç”¨æ’ä»¶å®‰è£…å®‰è£… zsh-autosuggestions1234567891011121314151617181920æ–¹å¼1: # ä¸‹è½½åˆ°æœ¬åœ°git clone git://github.com/zsh-users/zsh-autosuggestions ~/.zsh/zsh-autosuggestions# æ·»åŠ åˆ°.zshrc, è¿™æ ·å°±ä¸ç”¨æ¯æ¬¡sourceäº†æ·»åŠ  source ~/.zsh/zsh-autosuggestions/zsh-autosuggestions.zsh åˆ° .zshrc å°¾éƒ¨plugins=() ä¸­æ·»åŠ ä¸Š zsh-autosuggestions, ç”¨ç©ºæ ¼éš”å¼€å³å¯======================æ–¹å¼2: å®˜æ–¹å»ºè®®# å°‘äº†æ·»åŠ sourceåˆ° ~/.zshrcè¿™ä¸€æ­¥, çŒœæƒ³æ˜¯ä¼šæŒ‰ç…§é»˜è®¤çš„è·¯å¾„åŠ è½½? ==&gt; æ˜¯çš„, æ˜¯å¯è¡Œçš„, å»ºè®®è¿™ä¸ª# çŒœæƒ³, oh-my-zshä¼šè‡ªåŠ¨å¯¹å®‰è£…åˆ° &lt;sub&gt;/.oh-my-zsh/custom&#125;/plugins/ æ­¤è·¯å¾„ä¸‹çš„æ’ä»¶source, å°±ä¸éœ€è¦æ‰‹åŠ¨åœ¨ &lt;/sub&gt;/.zshrcä¸­æ·»åŠ sourceäº†, å…¶å®ƒçš„æ’ä»¶å°±å…ˆä¸æŠ˜è…¾äº†, ä»¥åŽæœ‰æœºä¼šå†è¯•è¯•# 1.Clone this repository into $ZSH_CUSTOM/plugins (by default ~/.oh-my-zsh/custom/plugins)git clone https://github.com/zsh-users/zsh-autosuggestions $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-autosuggestions# 2.Add the plugin to the list of plugins for Oh My Zsh to load:plugins=(zsh-autosuggestions)# 3.Start a new terminal session. å®‰è£… autojump123456789101112131415161718# ä¸‹è½½åˆ°æœ¬åœ°git clone git://github.com/joelthelion/autojump.git# æ‰§è¡Œå®‰è£…è„šæœ¬cd autojump./install.py# å®‰è£…å®Œæˆåœ¨~/ä¸‹é¢æœ‰.autojumpç›®å½•, åœ¨.zshrcä¸­åŠ ä¸€å¥[[ -s &lt;sub&gt;/.autojump/etc/profile.d/autojump.sh ]] &amp;&amp; . &lt;/sub&gt;/.autojump/etc/profile.d/autojump.sh# åœ¨plugins=(git zsh-autosuggestions autojump) åŠ ä¸Šautojump, ä¸Žå‰è€…ç”¨ç©ºæ ¼éš”å¼€PS: æ·»åŠ ä¸€æ¡å¿«æ·é”®ï¼šj -a s '/Users/XXX/Desktop/code/sharkâ€™è¿™å¥ä»£ç çš„å«ä¹‰ï¼šj -a ä½ å®šä¹‰çš„å¿«æ·å‘½ä»¤ â€˜éœ€è¦è·³è½¬çš„ç›®å½•ä½ç½®â€™æ­¤åŽè¦æ˜¯æƒ³è¿›å…¥sharkç›®å½•ï¼Œé™¤äº†ä¼ ç»Ÿçš„cdä¸€çº§ä¸€çº§çš„è¿›å…¥ï¼Œè¿˜å¯ä»¥ç›´æŽ¥ä½¿ç”¨å‘½ä»¤ï¼šj s # æŽ¥ä¸‹æ¥å¯ä»¥æ„‰æ‚¦çš„ä½¿ç”¨ j äº† å®‰è£… zsh-syntax-highlighting 123456789101112131415# åˆ° ~/.zshrc ç›®å½•, å…‹éš†ä»“åº“# è¿™é‡Œé»˜è®¤çš„æ˜¯ä¸»ç›®å½•, å½“ç„¶å¯ä»¥ä¸‹è½½åˆ°å…¶å®ƒç›®å½•# ps: åœ¨é‚£ä¸ªç›®å½•, git cloneå°±ä¼šä¸‹è½½åˆ°å“ªä¸ªç›®å½•git clone https://github.com/zsh-users/zsh-syntax-highlighting.git# source the script åˆ° ~/.zshrc# è¿™ä¸ªåœ¨å“ªä¸ªç›®å½•ä¸‹echoçš„, å°±ä¼šæŠŠå½“å‰ç›®å½•æ‹¼åˆ°å‰é¢?? ç»“æžœå¥½åƒæ˜¯è¿™æ ·echo "source $&#123;(q-)PWD&#125;/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" &gt;&gt; $&#123;ZDOTDIR:-$HOME&#125;/.zshrc# åœ¨plugins=(git zsh-autosuggestions autojump zsh-syntax-highlighting) zsh-syntax-highlighting, ä¸Žå‰è€…ç”¨ç©ºæ ¼éš”å¼€# å…¶å®žè¿™é‡Œä¸åŠ å¥½åƒä¹Ÿæ²¡äº‹, è¿˜æ˜¯åŠ ä¸Šä¸ºå¥½# åœ¨å½“å‰ shellç”Ÿæ•ˆ# çœ‹è¿™ä¸ªæ–‡ä»¶åœ¨å“ªä¸ªç›®å½•, åœ¨å“ªä¸ªç›®å½•å°±source å“ªä¸ªç›®å½•, ç«‹å³ç”Ÿæ•ˆsource ./zsh-syntax-highlighting/zsh-syntax-highlighting.zsh]]></content>
      <categories>
        <category>Linux</category>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iTerm2ä¸Šä½¿ç”¨ lrzszé»‘ç§‘æŠ€ ä¸Šä¼ ä¸‹è½½æ–‡ä»¶åˆ°è¿œç«¯]]></title>
    <url>%2F2018%2F05%2F23%2FTools%2FiTerm2%2FiTerm2%E4%B8%8A%E4%BD%BF%E7%94%A8lrzsz%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[ZModem integration for iTerm 2This script can be used to automate ZModem transfers from your OSX desktop to a server that can run lrzsz (in theory, any machinethat supports SSH), and vice-versa. The minimum supported iTerm2 version is 1.0.0.20120108 Troubleshooting Sending a directory may fail: this is a known issue If you are using tmux or some other terminal multiplexer (ie: screen), try using the -e option to sz and/or rz on your server to force escaping of more characters during transmission. This tool may also fail if you are using expect or rlogin as it expects a mostly-clean 8-bit connection between the two parties. Setup Install lrzsz on OSX: brew install lrzsz Save the iterm2-send-zmodem.sh and iterm2-recv-zmodem.sh scripts in /usr/local/bin/ Set up Triggers in iTerm 2 like so: Regular expression: rz waiting to receive.\*\*B0100 Action: Run Silent Coprocess Parameters: /usr/local/bin/iterm2-send-zmodem.sh Instant: checked Regular expression: \*\*B00000000000000 Action: Run Silent Coprocess Parameters: /usr/local/bin/iterm2-recv-zmodem.sh Instant: checked To send a file to a remote machine: Type rz on the remote machine Select the file(s) on the local machine to send Wait for the coprocess indicator to disappear The receive a file from a remote machine Type sz filename1 filename2 â€¦ filenameN on the remote machine Select the folder to receive to on the local machine Wait for the coprocess indicator to disappear Future plans (patches welcome) Visual progress bar indicator]]></content>
      <categories>
        <category>å·¥å…·</category>
        <category>iTerm2</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>å·¥å…·</tag>
        <tag>iTerm2</tag>
      </tags>
  </entry>
</search>
